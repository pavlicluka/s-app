var tN=Object.defineProperty;var rN=(s,t,r)=>t in s?tN(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r;var ft=(s,t,r)=>rN(s,typeof t!="symbol"?t+"":t,r);function sN(s,t){for(var r=0;r<t.length;r++){const a=t[r];if(typeof a!="string"&&!Array.isArray(a)){for(const n in a)if(n!=="default"&&!(n in s)){const i=Object.getOwnPropertyDescriptor(a,n);i&&Object.defineProperty(s,n,i.get?i:{enumerable:!0,get:()=>a[n]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();var $E=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xb(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function aN(s){if(Object.prototype.hasOwnProperty.call(s,"__esModule"))return s;var t=s.default;if(typeof t=="function"){var r=function a(){return this instanceof a?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(s).forEach(function(a){var n=Object.getOwnPropertyDescriptor(s,a);Object.defineProperty(r,a,n.get?n:{enumerable:!0,get:function(){return s[a]}})}),r}var rf={exports:{}},Qu={},sf={exports:{}},fr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mv;function nN(){if(Mv)return fr;Mv=1;var s=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),x=Symbol.iterator;function b(J){return J===null||typeof J!="object"?null:(J=x&&J[x]||J["@@iterator"],typeof J=="function"?J:null)}var h={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},j=Object.assign,g={};function v(J,$,Q){this.props=J,this.context=$,this.refs=g,this.updater=Q||h}v.prototype.isReactComponent={},v.prototype.setState=function(J,$){if(typeof J!="object"&&typeof J!="function"&&J!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,J,$,"setState")},v.prototype.forceUpdate=function(J){this.updater.enqueueForceUpdate(this,J,"forceUpdate")};function _(){}_.prototype=v.prototype;function k(J,$,Q){this.props=J,this.context=$,this.refs=g,this.updater=Q||h}var P=k.prototype=new _;P.constructor=k,j(P,v.prototype),P.isPureReactComponent=!0;var L=Array.isArray,F=Object.prototype.hasOwnProperty,W={current:null},R={key:!0,ref:!0,__self:!0,__source:!0};function B(J,$,Q){var q,I={},Y=null,H=null;if($!=null)for(q in $.ref!==void 0&&(H=$.ref),$.key!==void 0&&(Y=""+$.key),$)F.call($,q)&&!R.hasOwnProperty(q)&&(I[q]=$[q]);var he=arguments.length-2;if(he===1)I.children=Q;else if(1<he){for(var ge=Array(he),K=0;K<he;K++)ge[K]=arguments[K+2];I.children=ge}if(J&&J.defaultProps)for(q in he=J.defaultProps,he)I[q]===void 0&&(I[q]=he[q]);return{$$typeof:s,type:J,key:Y,ref:H,props:I,_owner:W.current}}function A(J,$){return{$$typeof:s,type:J.type,key:$,ref:J.ref,props:J.props,_owner:J._owner}}function S(J){return typeof J=="object"&&J!==null&&J.$$typeof===s}function C(J){var $={"=":"=0",":":"=2"};return"$"+J.replace(/[=:]/g,function(Q){return $[Q]})}var O=/\/+/g;function Z(J,$){return typeof J=="object"&&J!==null&&J.key!=null?C(""+J.key):$.toString(36)}function te(J,$,Q,q,I){var Y=typeof J;(Y==="undefined"||Y==="boolean")&&(J=null);var H=!1;if(J===null)H=!0;else switch(Y){case"string":case"number":H=!0;break;case"object":switch(J.$$typeof){case s:case t:H=!0}}if(H)return H=J,I=I(H),J=q===""?"."+Z(H,0):q,L(I)?(Q="",J!=null&&(Q=J.replace(O,"$&/")+"/"),te(I,$,Q,"",function(K){return K})):I!=null&&(S(I)&&(I=A(I,Q+(!I.key||H&&H.key===I.key?"":(""+I.key).replace(O,"$&/")+"/")+J)),$.push(I)),1;if(H=0,q=q===""?".":q+":",L(J))for(var he=0;he<J.length;he++){Y=J[he];var ge=q+Z(Y,he);H+=te(Y,$,Q,ge,I)}else if(ge=b(J),typeof ge=="function")for(J=ge.call(J),he=0;!(Y=J.next()).done;)Y=Y.value,ge=q+Z(Y,he++),H+=te(Y,$,Q,ge,I);else if(Y==="object")throw $=String(J),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(J).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.");return H}function ce(J,$,Q){if(J==null)return J;var q=[],I=0;return te(J,q,"","",function(Y){return $.call(Q,Y,I++)}),q}function re(J){if(J._status===-1){var $=J._result;$=$(),$.then(function(Q){(J._status===0||J._status===-1)&&(J._status=1,J._result=Q)},function(Q){(J._status===0||J._status===-1)&&(J._status=2,J._result=Q)}),J._status===-1&&(J._status=0,J._result=$)}if(J._status===1)return J._result.default;throw J._result}var X={current:null},U={transition:null},oe={ReactCurrentDispatcher:X,ReactCurrentBatchConfig:U,ReactCurrentOwner:W};function xe(){throw Error("act(...) is not supported in production builds of React.")}return fr.Children={map:ce,forEach:function(J,$,Q){ce(J,function(){$.apply(this,arguments)},Q)},count:function(J){var $=0;return ce(J,function(){$++}),$},toArray:function(J){return ce(J,function($){return $})||[]},only:function(J){if(!S(J))throw Error("React.Children.only expected to receive a single React element child.");return J}},fr.Component=v,fr.Fragment=r,fr.Profiler=n,fr.PureComponent=k,fr.StrictMode=a,fr.Suspense=d,fr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=oe,fr.act=xe,fr.cloneElement=function(J,$,Q){if(J==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+J+".");var q=j({},J.props),I=J.key,Y=J.ref,H=J._owner;if($!=null){if($.ref!==void 0&&(Y=$.ref,H=W.current),$.key!==void 0&&(I=""+$.key),J.type&&J.type.defaultProps)var he=J.type.defaultProps;for(ge in $)F.call($,ge)&&!R.hasOwnProperty(ge)&&(q[ge]=$[ge]===void 0&&he!==void 0?he[ge]:$[ge])}var ge=arguments.length-2;if(ge===1)q.children=Q;else if(1<ge){he=Array(ge);for(var K=0;K<ge;K++)he[K]=arguments[K+2];q.children=he}return{$$typeof:s,type:J.type,key:I,ref:Y,props:q,_owner:H}},fr.createContext=function(J){return J={$$typeof:o,_currentValue:J,_currentValue2:J,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},J.Provider={$$typeof:i,_context:J},J.Consumer=J},fr.createElement=B,fr.createFactory=function(J){var $=B.bind(null,J);return $.type=J,$},fr.createRef=function(){return{current:null}},fr.forwardRef=function(J){return{$$typeof:c,render:J}},fr.isValidElement=S,fr.lazy=function(J){return{$$typeof:m,_payload:{_status:-1,_result:J},_init:re}},fr.memo=function(J,$){return{$$typeof:p,type:J,compare:$===void 0?null:$}},fr.startTransition=function(J){var $=U.transition;U.transition={};try{J()}finally{U.transition=$}},fr.unstable_act=xe,fr.useCallback=function(J,$){return X.current.useCallback(J,$)},fr.useContext=function(J){return X.current.useContext(J)},fr.useDebugValue=function(){},fr.useDeferredValue=function(J){return X.current.useDeferredValue(J)},fr.useEffect=function(J,$){return X.current.useEffect(J,$)},fr.useId=function(){return X.current.useId()},fr.useImperativeHandle=function(J,$,Q){return X.current.useImperativeHandle(J,$,Q)},fr.useInsertionEffect=function(J,$){return X.current.useInsertionEffect(J,$)},fr.useLayoutEffect=function(J,$){return X.current.useLayoutEffect(J,$)},fr.useMemo=function(J,$){return X.current.useMemo(J,$)},fr.useReducer=function(J,$,Q){return X.current.useReducer(J,$,Q)},fr.useRef=function(J){return X.current.useRef(J)},fr.useState=function(J){return X.current.useState(J)},fr.useSyncExternalStore=function(J,$,Q){return X.current.useSyncExternalStore(J,$,Q)},fr.useTransition=function(){return X.current.useTransition()},fr.version="18.3.1",fr}var Fv;function Xh(){return Fv||(Fv=1,sf.exports=nN()),sf.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uv;function iN(){if(Uv)return Qu;Uv=1;var s=Xh(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,n=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function o(c,d,p){var m,x={},b=null,h=null;p!==void 0&&(b=""+p),d.key!==void 0&&(b=""+d.key),d.ref!==void 0&&(h=d.ref);for(m in d)a.call(d,m)&&!i.hasOwnProperty(m)&&(x[m]=d[m]);if(c&&c.defaultProps)for(m in d=c.defaultProps,d)x[m]===void 0&&(x[m]=d[m]);return{$$typeof:t,type:c,key:b,ref:h,props:x,_owner:n.current}}return Qu.Fragment=r,Qu.jsx=o,Qu.jsxs=o,Qu}var qv;function oN(){return qv||(qv=1,rf.exports=iN()),rf.exports}var e=oN(),z=Xh();const lt=Xb(z);var Dm={},af={exports:{}},gn={},nf={exports:{}},of={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $v;function lN(){return $v||($v=1,(function(s){function t(U,oe){var xe=U.length;U.push(oe);e:for(;0<xe;){var J=xe-1>>>1,$=U[J];if(0<n($,oe))U[J]=oe,U[xe]=$,xe=J;else break e}}function r(U){return U.length===0?null:U[0]}function a(U){if(U.length===0)return null;var oe=U[0],xe=U.pop();if(xe!==oe){U[0]=xe;e:for(var J=0,$=U.length,Q=$>>>1;J<Q;){var q=2*(J+1)-1,I=U[q],Y=q+1,H=U[Y];if(0>n(I,xe))Y<$&&0>n(H,I)?(U[J]=H,U[Y]=xe,J=Y):(U[J]=I,U[q]=xe,J=q);else if(Y<$&&0>n(H,xe))U[J]=H,U[Y]=xe,J=Y;else break e}}return oe}function n(U,oe){var xe=U.sortIndex-oe.sortIndex;return xe!==0?xe:U.id-oe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;s.unstable_now=function(){return i.now()}}else{var o=Date,c=o.now();s.unstable_now=function(){return o.now()-c}}var d=[],p=[],m=1,x=null,b=3,h=!1,j=!1,g=!1,v=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function P(U){for(var oe=r(p);oe!==null;){if(oe.callback===null)a(p);else if(oe.startTime<=U)a(p),oe.sortIndex=oe.expirationTime,t(d,oe);else break;oe=r(p)}}function L(U){if(g=!1,P(U),!j)if(r(d)!==null)j=!0,re(F);else{var oe=r(p);oe!==null&&X(L,oe.startTime-U)}}function F(U,oe){j=!1,g&&(g=!1,_(B),B=-1),h=!0;var xe=b;try{for(P(oe),x=r(d);x!==null&&(!(x.expirationTime>oe)||U&&!C());){var J=x.callback;if(typeof J=="function"){x.callback=null,b=x.priorityLevel;var $=J(x.expirationTime<=oe);oe=s.unstable_now(),typeof $=="function"?x.callback=$:x===r(d)&&a(d),P(oe)}else a(d);x=r(d)}if(x!==null)var Q=!0;else{var q=r(p);q!==null&&X(L,q.startTime-oe),Q=!1}return Q}finally{x=null,b=xe,h=!1}}var W=!1,R=null,B=-1,A=5,S=-1;function C(){return!(s.unstable_now()-S<A)}function O(){if(R!==null){var U=s.unstable_now();S=U;var oe=!0;try{oe=R(!0,U)}finally{oe?Z():(W=!1,R=null)}}else W=!1}var Z;if(typeof k=="function")Z=function(){k(O)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,ce=te.port2;te.port1.onmessage=O,Z=function(){ce.postMessage(null)}}else Z=function(){v(O,0)};function re(U){R=U,W||(W=!0,Z())}function X(U,oe){B=v(function(){U(s.unstable_now())},oe)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(U){U.callback=null},s.unstable_continueExecution=function(){j||h||(j=!0,re(F))},s.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<U?Math.floor(1e3/U):5},s.unstable_getCurrentPriorityLevel=function(){return b},s.unstable_getFirstCallbackNode=function(){return r(d)},s.unstable_next=function(U){switch(b){case 1:case 2:case 3:var oe=3;break;default:oe=b}var xe=b;b=oe;try{return U()}finally{b=xe}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(U,oe){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var xe=b;b=U;try{return oe()}finally{b=xe}},s.unstable_scheduleCallback=function(U,oe,xe){var J=s.unstable_now();switch(typeof xe=="object"&&xe!==null?(xe=xe.delay,xe=typeof xe=="number"&&0<xe?J+xe:J):xe=J,U){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=xe+$,U={id:m++,callback:oe,priorityLevel:U,startTime:xe,expirationTime:$,sortIndex:-1},xe>J?(U.sortIndex=xe,t(p,U),r(d)===null&&U===r(p)&&(g?(_(B),B=-1):g=!0,X(L,xe-J))):(U.sortIndex=$,t(d,U),j||h||(j=!0,re(F))),U},s.unstable_shouldYield=C,s.unstable_wrapCallback=function(U){var oe=b;return function(){var xe=b;b=oe;try{return U.apply(this,arguments)}finally{b=xe}}}})(of)),of}var Bv;function cN(){return Bv||(Bv=1,nf.exports=lN()),nf.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vv;function dN(){if(Vv)return gn;Vv=1;var s=Xh(),t=cN();function r(l){for(var u="https://reactjs.org/docs/error-decoder.html?invariant="+l,f=1;f<arguments.length;f++)u+="&args[]="+encodeURIComponent(arguments[f]);return"Minified React error #"+l+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,n={};function i(l,u){o(l,u),o(l+"Capture",u)}function o(l,u){for(n[l]=u,l=0;l<u.length;l++)a.add(u[l])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},x={};function b(l){return d.call(x,l)?!0:d.call(m,l)?!1:p.test(l)?x[l]=!0:(m[l]=!0,!1)}function h(l,u,f,N){if(f!==null&&f.type===0)return!1;switch(typeof u){case"function":case"symbol":return!0;case"boolean":return N?!1:f!==null?!f.acceptsBooleans:(l=l.toLowerCase().slice(0,5),l!=="data-"&&l!=="aria-");default:return!1}}function j(l,u,f,N){if(u===null||typeof u>"u"||h(l,u,f,N))return!0;if(N)return!1;if(f!==null)switch(f.type){case 3:return!u;case 4:return u===!1;case 5:return isNaN(u);case 6:return isNaN(u)||1>u}return!1}function g(l,u,f,N,E,V,ie){this.acceptsBooleans=u===2||u===3||u===4,this.attributeName=N,this.attributeNamespace=E,this.mustUseProperty=f,this.propertyName=l,this.type=u,this.sanitizeURL=V,this.removeEmptyString=ie}var v={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(l){v[l]=new g(l,0,!1,l,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(l){var u=l[0];v[u]=new g(u,1,!1,l[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(l){v[l]=new g(l,2,!1,l.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(l){v[l]=new g(l,2,!1,l,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(l){v[l]=new g(l,3,!1,l.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(l){v[l]=new g(l,3,!0,l,null,!1,!1)}),["capture","download"].forEach(function(l){v[l]=new g(l,4,!1,l,null,!1,!1)}),["cols","rows","size","span"].forEach(function(l){v[l]=new g(l,6,!1,l,null,!1,!1)}),["rowSpan","start"].forEach(function(l){v[l]=new g(l,5,!1,l.toLowerCase(),null,!1,!1)});var _=/[\-:]([a-z])/g;function k(l){return l[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(l){var u=l.replace(_,k);v[u]=new g(u,1,!1,l,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(l){var u=l.replace(_,k);v[u]=new g(u,1,!1,l,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(l){var u=l.replace(_,k);v[u]=new g(u,1,!1,l,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(l){v[l]=new g(l,1,!1,l.toLowerCase(),null,!1,!1)}),v.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(l){v[l]=new g(l,1,!1,l.toLowerCase(),null,!0,!0)});function P(l,u,f,N){var E=v.hasOwnProperty(u)?v[u]:null;(E!==null?E.type!==0:N||!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(j(u,f,E,N)&&(f=null),N||E===null?b(u)&&(f===null?l.removeAttribute(u):l.setAttribute(u,""+f)):E.mustUseProperty?l[E.propertyName]=f===null?E.type===3?!1:"":f:(u=E.attributeName,N=E.attributeNamespace,f===null?l.removeAttribute(u):(E=E.type,f=E===3||E===4&&f===!0?"":""+f,N?l.setAttributeNS(N,u,f):l.setAttribute(u,f))))}var L=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,F=Symbol.for("react.element"),W=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),B=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),C=Symbol.for("react.context"),O=Symbol.for("react.forward_ref"),Z=Symbol.for("react.suspense"),te=Symbol.for("react.suspense_list"),ce=Symbol.for("react.memo"),re=Symbol.for("react.lazy"),X=Symbol.for("react.offscreen"),U=Symbol.iterator;function oe(l){return l===null||typeof l!="object"?null:(l=U&&l[U]||l["@@iterator"],typeof l=="function"?l:null)}var xe=Object.assign,J;function $(l){if(J===void 0)try{throw Error()}catch(f){var u=f.stack.trim().match(/\n( *(at )?)/);J=u&&u[1]||""}return`
`+J+l}var Q=!1;function q(l,u){if(!l||Q)return"";Q=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(u)if(u=function(){throw Error()},Object.defineProperty(u.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(u,[])}catch(Fe){var N=Fe}Reflect.construct(l,[],u)}else{try{u.call()}catch(Fe){N=Fe}l.call(u.prototype)}else{try{throw Error()}catch(Fe){N=Fe}l()}}catch(Fe){if(Fe&&N&&typeof Fe.stack=="string"){for(var E=Fe.stack.split(`
`),V=N.stack.split(`
`),ie=E.length-1,ye=V.length-1;1<=ie&&0<=ye&&E[ie]!==V[ye];)ye--;for(;1<=ie&&0<=ye;ie--,ye--)if(E[ie]!==V[ye]){if(ie!==1||ye!==1)do if(ie--,ye--,0>ye||E[ie]!==V[ye]){var ze=`
`+E[ie].replace(" at new "," at ");return l.displayName&&ze.includes("<anonymous>")&&(ze=ze.replace("<anonymous>",l.displayName)),ze}while(1<=ie&&0<=ye);break}}}finally{Q=!1,Error.prepareStackTrace=f}return(l=l?l.displayName||l.name:"")?$(l):""}function I(l){switch(l.tag){case 5:return $(l.type);case 16:return $("Lazy");case 13:return $("Suspense");case 19:return $("SuspenseList");case 0:case 2:case 15:return l=q(l.type,!1),l;case 11:return l=q(l.type.render,!1),l;case 1:return l=q(l.type,!0),l;default:return""}}function Y(l){if(l==null)return null;if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case R:return"Fragment";case W:return"Portal";case A:return"Profiler";case B:return"StrictMode";case Z:return"Suspense";case te:return"SuspenseList"}if(typeof l=="object")switch(l.$$typeof){case C:return(l.displayName||"Context")+".Consumer";case S:return(l._context.displayName||"Context")+".Provider";case O:var u=l.render;return l=l.displayName,l||(l=u.displayName||u.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case ce:return u=l.displayName||null,u!==null?u:Y(l.type)||"Memo";case re:u=l._payload,l=l._init;try{return Y(l(u))}catch{}}return null}function H(l){var u=l.type;switch(l.tag){case 24:return"Cache";case 9:return(u.displayName||"Context")+".Consumer";case 10:return(u._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return l=u.render,l=l.displayName||l.name||"",u.displayName||(l!==""?"ForwardRef("+l+")":"ForwardRef");case 7:return"Fragment";case 5:return u;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Y(u);case 8:return u===B?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u}return null}function he(l){switch(typeof l){case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function ge(l){var u=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function K(l){var u=ge(l)?"checked":"value",f=Object.getOwnPropertyDescriptor(l.constructor.prototype,u),N=""+l[u];if(!l.hasOwnProperty(u)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var E=f.get,V=f.set;return Object.defineProperty(l,u,{configurable:!0,get:function(){return E.call(this)},set:function(ie){N=""+ie,V.call(this,ie)}}),Object.defineProperty(l,u,{enumerable:f.enumerable}),{getValue:function(){return N},setValue:function(ie){N=""+ie},stopTracking:function(){l._valueTracker=null,delete l[u]}}}}function T(l){l._valueTracker||(l._valueTracker=K(l))}function ee(l){if(!l)return!1;var u=l._valueTracker;if(!u)return!0;var f=u.getValue(),N="";return l&&(N=ge(l)?l.checked?"true":"false":l.value),l=N,l!==f?(u.setValue(l),!0):!1}function _e(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}function ke(l,u){var f=u.checked;return xe({},u,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:f??l._wrapperState.initialChecked})}function ue(l,u){var f=u.defaultValue==null?"":u.defaultValue,N=u.checked!=null?u.checked:u.defaultChecked;f=he(u.value!=null?u.value:f),l._wrapperState={initialChecked:N,initialValue:f,controlled:u.type==="checkbox"||u.type==="radio"?u.checked!=null:u.value!=null}}function je(l,u){u=u.checked,u!=null&&P(l,"checked",u,!1)}function ne(l,u){je(l,u);var f=he(u.value),N=u.type;if(f!=null)N==="number"?(f===0&&l.value===""||l.value!=f)&&(l.value=""+f):l.value!==""+f&&(l.value=""+f);else if(N==="submit"||N==="reset"){l.removeAttribute("value");return}u.hasOwnProperty("value")?Oe(l,u.type,f):u.hasOwnProperty("defaultValue")&&Oe(l,u.type,he(u.defaultValue)),u.checked==null&&u.defaultChecked!=null&&(l.defaultChecked=!!u.defaultChecked)}function Re(l,u,f){if(u.hasOwnProperty("value")||u.hasOwnProperty("defaultValue")){var N=u.type;if(!(N!=="submit"&&N!=="reset"||u.value!==void 0&&u.value!==null))return;u=""+l._wrapperState.initialValue,f||u===l.value||(l.value=u),l.defaultValue=u}f=l.name,f!==""&&(l.name=""),l.defaultChecked=!!l._wrapperState.initialChecked,f!==""&&(l.name=f)}function Oe(l,u,f){(u!=="number"||_e(l.ownerDocument)!==l)&&(f==null?l.defaultValue=""+l._wrapperState.initialValue:l.defaultValue!==""+f&&(l.defaultValue=""+f))}var Je=Array.isArray;function Be(l,u,f,N){if(l=l.options,u){u={};for(var E=0;E<f.length;E++)u["$"+f[E]]=!0;for(f=0;f<l.length;f++)E=u.hasOwnProperty("$"+l[f].value),l[f].selected!==E&&(l[f].selected=E),E&&N&&(l[f].defaultSelected=!0)}else{for(f=""+he(f),u=null,E=0;E<l.length;E++){if(l[E].value===f){l[E].selected=!0,N&&(l[E].defaultSelected=!0);return}u!==null||l[E].disabled||(u=l[E])}u!==null&&(u.selected=!0)}}function kt(l,u){if(u.dangerouslySetInnerHTML!=null)throw Error(r(91));return xe({},u,{value:void 0,defaultValue:void 0,children:""+l._wrapperState.initialValue})}function it(l,u){var f=u.value;if(f==null){if(f=u.children,u=u.defaultValue,f!=null){if(u!=null)throw Error(r(92));if(Je(f)){if(1<f.length)throw Error(r(93));f=f[0]}u=f}u==null&&(u=""),f=u}l._wrapperState={initialValue:he(f)}}function Ft(l,u){var f=he(u.value),N=he(u.defaultValue);f!=null&&(f=""+f,f!==l.value&&(l.value=f),u.defaultValue==null&&l.defaultValue!==f&&(l.defaultValue=f)),N!=null&&(l.defaultValue=""+N)}function Tt(l){var u=l.textContent;u===l._wrapperState.initialValue&&u!==""&&u!==null&&(l.value=u)}function ot(l){switch(l){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Jt(l,u){return l==null||l==="http://www.w3.org/1999/xhtml"?ot(u):l==="http://www.w3.org/2000/svg"&&u==="foreignObject"?"http://www.w3.org/1999/xhtml":l}var Vt,wt=(function(l){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(u,f,N,E){MSApp.execUnsafeLocalFunction(function(){return l(u,f,N,E)})}:l})(function(l,u){if(l.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in l)l.innerHTML=u;else{for(Vt=Vt||document.createElement("div"),Vt.innerHTML="<svg>"+u.valueOf().toString()+"</svg>",u=Vt.firstChild;l.firstChild;)l.removeChild(l.firstChild);for(;u.firstChild;)l.appendChild(u.firstChild)}});function Nt(l,u){if(u){var f=l.firstChild;if(f&&f===l.lastChild&&f.nodeType===3){f.nodeValue=u;return}}l.textContent=u}var bt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},jr=["Webkit","ms","Moz","O"];Object.keys(bt).forEach(function(l){jr.forEach(function(u){u=u+l.charAt(0).toUpperCase()+l.substring(1),bt[u]=bt[l]})});function Zt(l,u,f){return u==null||typeof u=="boolean"||u===""?"":f||typeof u!="number"||u===0||bt.hasOwnProperty(l)&&bt[l]?(""+u).trim():u+"px"}function ct(l,u){l=l.style;for(var f in u)if(u.hasOwnProperty(f)){var N=f.indexOf("--")===0,E=Zt(f,u[f],N);f==="float"&&(f="cssFloat"),N?l.setProperty(f,E):l[f]=E}}var Ut=xe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function dr(l,u){if(u){if(Ut[l]&&(u.children!=null||u.dangerouslySetInnerHTML!=null))throw Error(r(137,l));if(u.dangerouslySetInnerHTML!=null){if(u.children!=null)throw Error(r(60));if(typeof u.dangerouslySetInnerHTML!="object"||!("__html"in u.dangerouslySetInnerHTML))throw Error(r(61))}if(u.style!=null&&typeof u.style!="object")throw Error(r(62))}}function Et(l,u){if(l.indexOf("-")===-1)return typeof u.is=="string";switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var or=null;function qt(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var Lr=null,Tr=null,ur=null;function De(l){if(l=El(l)){if(typeof Lr!="function")throw Error(r(280));var u=l.stateNode;u&&(u=zc(u),Lr(l.stateNode,l.type,u))}}function Qe(l){Tr?ur?ur.push(l):ur=[l]:Tr=l}function st(){if(Tr){var l=Tr,u=ur;if(ur=Tr=null,De(l),u)for(l=0;l<u.length;l++)De(u[l])}}function zt(l,u){return l(u)}function rr(){}var _r=!1;function dt(l,u,f){if(_r)return l(u,f);_r=!0;try{return zt(l,u,f)}finally{_r=!1,(Tr!==null||ur!==null)&&(rr(),st())}}function kr(l,u){var f=l.stateNode;if(f===null)return null;var N=zc(f);if(N===null)return null;f=N[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(N=!N.disabled)||(l=l.type,N=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!N;break e;default:l=!1}if(l)return null;if(f&&typeof f!="function")throw Error(r(231,u,typeof f));return f}var Ke=!1;if(c)try{var nt={};Object.defineProperty(nt,"passive",{get:function(){Ke=!0}}),window.addEventListener("test",nt,nt),window.removeEventListener("test",nt,nt)}catch{Ke=!1}function Nr(l,u,f,N,E,V,ie,ye,ze){var Fe=Array.prototype.slice.call(arguments,3);try{u.apply(f,Fe)}catch(Ye){this.onError(Ye)}}var gr=!1,Gr=null,mr=!1,tn=null,Ki={onError:function(l){gr=!0,Gr=l}};function zn(l,u,f,N,E,V,ie,ye,ze){gr=!1,Gr=null,Nr.apply(Ki,arguments)}function Wn(l,u,f,N,E,V,ie,ye,ze){if(zn.apply(this,arguments),gr){if(gr){var Fe=Gr;gr=!1,Gr=null}else throw Error(r(198));mr||(mr=!0,tn=Fe)}}function Ys(l){var u=l,f=l;if(l.alternate)for(;u.return;)u=u.return;else{l=u;do u=l,(u.flags&4098)!==0&&(f=u.return),l=u.return;while(l)}return u.tag===3?f:null}function rn(l){if(l.tag===13){var u=l.memoizedState;if(u===null&&(l=l.alternate,l!==null&&(u=l.memoizedState)),u!==null)return u.dehydrated}return null}function qa(l){if(Ys(l)!==l)throw Error(r(188))}function _o(l){var u=l.alternate;if(!u){if(u=Ys(l),u===null)throw Error(r(188));return u!==l?null:l}for(var f=l,N=u;;){var E=f.return;if(E===null)break;var V=E.alternate;if(V===null){if(N=E.return,N!==null){f=N;continue}break}if(E.child===V.child){for(V=E.child;V;){if(V===f)return qa(E),l;if(V===N)return qa(E),u;V=V.sibling}throw Error(r(188))}if(f.return!==N.return)f=E,N=V;else{for(var ie=!1,ye=E.child;ye;){if(ye===f){ie=!0,f=E,N=V;break}if(ye===N){ie=!0,N=E,f=V;break}ye=ye.sibling}if(!ie){for(ye=V.child;ye;){if(ye===f){ie=!0,f=V,N=E;break}if(ye===N){ie=!0,N=V,f=E;break}ye=ye.sibling}if(!ie)throw Error(r(189))}}if(f.alternate!==N)throw Error(r(190))}if(f.tag!==3)throw Error(r(188));return f.stateNode.current===f?l:u}function Cn(l){return l=_o(l),l!==null?Gi(l):null}function Gi(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){var u=Gi(l);if(u!==null)return u;l=l.sibling}return null}var ko=t.unstable_scheduleCallback,No=t.unstable_cancelCallback,hl=t.unstable_shouldYield,Su=t.unstable_requestPaint,Yr=t.unstable_now,dd=t.unstable_getCurrentPriorityLevel,xl=t.unstable_ImmediatePriority,$a=t.unstable_UserBlockingPriority,Yi=t.unstable_NormalPriority,ud=t.unstable_LowPriority,fl=t.unstable_IdlePriority,wo=null,Ba=null;function pd(l){if(Ba&&typeof Ba.onCommitFiberRoot=="function")try{Ba.onCommitFiberRoot(wo,l,void 0,(l.current.flags&128)===128)}catch{}}var sa=Math.clz32?Math.clz32:md,zu=Math.log,Cs=Math.LN2;function md(l){return l>>>=0,l===0?32:31-(zu(l)/Cs|0)|0}var So=64,sn=4194304;function Pn(l){switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return l&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return l}}function ka(l,u){var f=l.pendingLanes;if(f===0)return 0;var N=0,E=l.suspendedLanes,V=l.pingedLanes,ie=f&268435455;if(ie!==0){var ye=ie&~E;ye!==0?N=Pn(ye):(V&=ie,V!==0&&(N=Pn(V)))}else ie=f&~E,ie!==0?N=Pn(ie):V!==0&&(N=Pn(V));if(N===0)return 0;if(u!==0&&u!==N&&(u&E)===0&&(E=N&-N,V=u&-u,E>=V||E===16&&(V&4194240)!==0))return u;if((N&4)!==0&&(N|=f&16),u=l.entangledLanes,u!==0)for(l=l.entanglements,u&=N;0<u;)f=31-sa(u),E=1<<f,N|=l[f],u&=~E;return N}function zo(l,u){switch(l){case 1:case 2:case 4:return u+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function bs(l,u){for(var f=l.suspendedLanes,N=l.pingedLanes,E=l.expirationTimes,V=l.pendingLanes;0<V;){var ie=31-sa(V),ye=1<<ie,ze=E[ie];ze===-1?((ye&f)===0||(ye&N)!==0)&&(E[ie]=zo(ye,u)):ze<=u&&(l.expiredLanes|=ye),V&=~ye}}function Co(l){return l=l.pendingLanes&-1073741825,l!==0?l:l&1073741824?1073741824:0}function hd(){var l=So;return So<<=1,(So&4194240)===0&&(So=64),l}function cc(l){for(var u=[],f=0;31>f;f++)u.push(l);return u}function Po(l,u,f){l.pendingLanes|=u,u!==536870912&&(l.suspendedLanes=0,l.pingedLanes=0),l=l.eventTimes,u=31-sa(u),l[u]=f}function Kn(l,u){var f=l.pendingLanes&~u;l.pendingLanes=u,l.suspendedLanes=0,l.pingedLanes=0,l.expiredLanes&=u,l.mutableReadLanes&=u,l.entangledLanes&=u,u=l.entanglements;var N=l.eventTimes;for(l=l.expirationTimes;0<f;){var E=31-sa(f),V=1<<E;u[E]=0,N[E]=-1,l[E]=-1,f&=~V}}function bl(l,u){var f=l.entangledLanes|=u;for(l=l.entanglements;f;){var N=31-sa(f),E=1<<N;E&u|l[N]&u&&(l[N]|=u),f&=~E}}var yr=0;function vi(l){return l&=-l,1<l?4<l?(l&268435455)!==0?16:536870912:4:1}var gl,dc,xd,fd,vl,yi=!1,An=[],Gn=null,Na=null,an=null,Ht=new Map,Ao=new Map,Yn=[],Cu="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function bd(l,u){switch(l){case"focusin":case"focusout":Gn=null;break;case"dragenter":case"dragleave":Na=null;break;case"mouseover":case"mouseout":an=null;break;case"pointerover":case"pointerout":Ht.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ao.delete(u.pointerId)}}function Va(l,u,f,N,E,V){return l===null||l.nativeEvent!==V?(l={blockedOn:u,domEventName:f,eventSystemFlags:N,nativeEvent:V,targetContainers:[E]},u!==null&&(u=El(u),u!==null&&dc(u)),l):(l.eventSystemFlags|=N,u=l.targetContainers,E!==null&&u.indexOf(E)===-1&&u.push(E),l)}function ji(l,u,f,N,E){switch(u){case"focusin":return Gn=Va(Gn,l,u,f,N,E),!0;case"dragenter":return Na=Va(Na,l,u,f,N,E),!0;case"mouseover":return an=Va(an,l,u,f,N,E),!0;case"pointerover":var V=E.pointerId;return Ht.set(V,Va(Ht.get(V)||null,l,u,f,N,E)),!0;case"gotpointercapture":return V=E.pointerId,Ao.set(V,Va(Ao.get(V)||null,l,u,f,N,E)),!0}return!1}function gd(l){var u=io(l.target);if(u!==null){var f=Ys(u);if(f!==null){if(u=f.tag,u===13){if(u=rn(f),u!==null){l.blockedOn=u,vl(l.priority,function(){xd(f)});return}}else if(u===3&&f.stateNode.current.memoizedState.isDehydrated){l.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}l.blockedOn=null}function yl(l){if(l.blockedOn!==null)return!1;for(var u=l.targetContainers;0<u.length;){var f=Do(l.domEventName,l.eventSystemFlags,u[0],l.nativeEvent);if(f===null){f=l.nativeEvent;var N=new f.constructor(f.type,f);or=N,f.target.dispatchEvent(N),or=null}else return u=El(f),u!==null&&dc(u),l.blockedOn=f,!1;u.shift()}return!0}function Oo(l,u,f){yl(l)&&f.delete(u)}function uc(){yi=!1,Gn!==null&&yl(Gn)&&(Gn=null),Na!==null&&yl(Na)&&(Na=null),an!==null&&yl(an)&&(an=null),Ht.forEach(Oo),Ao.forEach(Oo)}function On(l,u){l.blockedOn===u&&(l.blockedOn=null,yi||(yi=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,uc)))}function Jn(l){function u(E){return On(E,l)}if(0<An.length){On(An[0],l);for(var f=1;f<An.length;f++){var N=An[f];N.blockedOn===l&&(N.blockedOn=null)}}for(Gn!==null&&On(Gn,l),Na!==null&&On(Na,l),an!==null&&On(an,l),Ht.forEach(u),Ao.forEach(u),f=0;f<Yn.length;f++)N=Yn[f],N.blockedOn===l&&(N.blockedOn=null);for(;0<Yn.length&&(f=Yn[0],f.blockedOn===null);)gd(f),f.blockedOn===null&&Yn.shift()}var Dn=L.ReactCurrentBatchConfig,jl=!0;function pc(l,u,f,N){var E=yr,V=Dn.transition;Dn.transition=null;try{yr=1,_i(l,u,f,N)}finally{yr=E,Dn.transition=V}}function mc(l,u,f,N){var E=yr,V=Dn.transition;Dn.transition=null;try{yr=4,_i(l,u,f,N)}finally{yr=E,Dn.transition=V}}function _i(l,u,f,N){if(jl){var E=Do(l,u,f,N);if(E===null)Nc(l,u,N,Xn,f),bd(l,N);else if(ji(E,l,u,f,N))N.stopPropagation();else if(bd(l,N),u&4&&-1<Cu.indexOf(l)){for(;E!==null;){var V=El(E);if(V!==null&&gl(V),V=Do(l,u,f,N),V===null&&Nc(l,u,N,Xn,f),V===E)break;E=V}E!==null&&N.stopPropagation()}else Nc(l,u,N,null,f)}}var Xn=null;function Do(l,u,f,N){if(Xn=null,l=qt(N),l=io(l),l!==null)if(u=Ys(l),u===null)l=null;else if(f=u.tag,f===13){if(l=rn(u),l!==null)return l;l=null}else if(f===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;l=null}else u!==l&&(l=null);return Xn=l,null}function Eo(l){switch(l){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(dd()){case xl:return 1;case $a:return 4;case Yi:case ud:return 16;case fl:return 536870912;default:return 16}default:return 16}}var nn=null,ki=null,Io=null;function hc(){if(Io)return Io;var l,u=ki,f=u.length,N,E="value"in nn?nn.value:nn.textContent,V=E.length;for(l=0;l<f&&u[l]===E[l];l++);var ie=f-l;for(N=1;N<=ie&&u[f-N]===E[V-N];N++);return Io=E.slice(l,1<N?1-N:void 0)}function on(l){var u=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&u===13&&(l=13)):l=u,l===10&&(l=13),32<=l||l===13?l:0}function ln(){return!0}function xc(){return!1}function aa(l){function u(f,N,E,V,ie){this._reactName=f,this._targetInst=E,this.type=N,this.nativeEvent=V,this.target=ie,this.currentTarget=null;for(var ye in l)l.hasOwnProperty(ye)&&(f=l[ye],this[ye]=f?f(V):V[ye]);return this.isDefaultPrevented=(V.defaultPrevented!=null?V.defaultPrevented:V.returnValue===!1)?ln:xc,this.isPropagationStopped=xc,this}return xe(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=ln)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=ln)},persist:function(){},isPersistent:ln}),u}var cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_l=aa(cn),D=xe({},cn,{view:0,detail:0}),ae=aa(D),ve,we,Ae,Ve=xe({},D,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ji,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==Ae&&(Ae&&l.type==="mousemove"?(ve=l.screenX-Ae.screenX,we=l.screenY-Ae.screenY):we=ve=0,Ae=l),ve)},movementY:function(l){return"movementY"in l?l.movementY:we}}),We=aa(Ve),vt=xe({},Ve,{dataTransfer:0}),Ct=aa(vt),Kt=xe({},D,{relatedTarget:0}),Gt=aa(Kt),wr=xe({},cn,{animationName:0,elapsedTime:0,pseudoElement:0}),as=aa(wr),Ps=xe({},cn,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),Wr=aa(Ps),Ts=xe({},cn,{data:0}),gs=aa(Ts),Js={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wa={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function vd(l){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(l):(l=wa[l])?!!u[l]:!1}function Ji(){return vd}var Lo=xe({},D,{key:function(l){if(l.key){var u=Js[l.key]||l.key;if(u!=="Unidentified")return u}return l.type==="keypress"?(l=on(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?dn[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ji,charCode:function(l){return l.type==="keypress"?on(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?on(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),Xi=aa(Lo),To=xe({},Ve,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qi=aa(To),Ro=xe({},D,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ji}),na=aa(Ro),Mo=xe({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Fo=aa(Mo),fc=xe({},Ve,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),bc=aa(fc),ds=[9,13,27,32],En=c&&"CompositionEvent"in window,Qn=null;c&&"documentMode"in document&&(Qn=document.documentMode);var yd=c&&"TextEvent"in window&&!Qn,Ha=c&&(!En||Qn&&8<Qn&&11>=Qn),eo=" ",kl=!1;function Nl(l,u){switch(l){case"keyup":return ds.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ni(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var un=!1;function Za(l,u){switch(l){case"compositionend":return Ni(u);case"keypress":return u.which!==32?null:(kl=!0,eo);case"textInput":return l=u.data,l===eo&&kl?null:l;default:return null}}function Wa(l,u){if(un)return l==="compositionend"||!En&&Nl(l,u)?(l=hc(),Io=ki=nn=null,un=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return Ha&&u.locale!=="ko"?null:u.data;default:return null}}var to={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ei(l){var u=l&&l.nodeName&&l.nodeName.toLowerCase();return u==="input"?!!to[l.type]:u==="textarea"}function wi(l,u,f,N){Qe(N),u=wd(u,"onChange"),0<u.length&&(f=new _l("onChange","change",null,f,N),l.push({event:f,listeners:u}))}var Si=null,ti=null;function vs(l){_c(l,0)}function Uo(l){var u=Yo(l);if(ee(u))return l}function ri(l,u){if(l==="change")return u}var In=!1;if(c){var qo;if(c){var $o="oninput"in document;if(!$o){var wl=document.createElement("div");wl.setAttribute("oninput","return;"),$o=typeof wl.oninput=="function"}qo=$o}else qo=!1;In=qo&&(!document.documentMode||9<document.documentMode)}function Sl(){Si&&(Si.detachEvent("onpropertychange",zi),ti=Si=null)}function zi(l){if(l.propertyName==="value"&&Uo(ti)){var u=[];wi(u,ti,l,qt(l)),dt(vs,u)}}function ro(l,u,f){l==="focusin"?(Sl(),Si=u,ti=f,Si.attachEvent("onpropertychange",zi)):l==="focusout"&&Sl()}function so(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return Uo(ti)}function Bo(l,u){if(l==="click")return Uo(u)}function ao(l,u){if(l==="input"||l==="change")return Uo(u)}function Vo(l,u){return l===u&&(l!==0||1/l===1/u)||l!==l&&u!==u}var us=typeof Object.is=="function"?Object.is:Vo;function Sa(l,u){if(us(l,u))return!0;if(typeof l!="object"||l===null||typeof u!="object"||u===null)return!1;var f=Object.keys(l),N=Object.keys(u);if(f.length!==N.length)return!1;for(N=0;N<f.length;N++){var E=f[N];if(!d.call(u,E)||!us(l[E],u[E]))return!1}return!0}function Sr(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function Rr(l,u){var f=Sr(l);l=0;for(var N;f;){if(f.nodeType===3){if(N=l+f.textContent.length,l<=u&&N>=u)return{node:f,offset:u-l};l=N}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=Sr(f)}}function ps(l,u){return l&&u?l===u?!0:l&&l.nodeType===3?!1:u&&u.nodeType===3?ps(l,u.parentNode):"contains"in l?l.contains(u):l.compareDocumentPosition?!!(l.compareDocumentPosition(u)&16):!1:!1}function As(){for(var l=window,u=_e();u instanceof l.HTMLIFrameElement;){try{var f=typeof u.contentWindow.location.href=="string"}catch{f=!1}if(f)l=u.contentWindow;else break;u=_e(l.document)}return u}function Ln(l){var u=l&&l.nodeName&&l.nodeName.toLowerCase();return u&&(u==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||u==="textarea"||l.contentEditable==="true")}function gc(l){var u=As(),f=l.focusedElem,N=l.selectionRange;if(u!==f&&f&&f.ownerDocument&&ps(f.ownerDocument.documentElement,f)){if(N!==null&&Ln(f)){if(u=N.start,l=N.end,l===void 0&&(l=u),"selectionStart"in f)f.selectionStart=u,f.selectionEnd=Math.min(l,f.value.length);else if(l=(u=f.ownerDocument||document)&&u.defaultView||window,l.getSelection){l=l.getSelection();var E=f.textContent.length,V=Math.min(N.start,E);N=N.end===void 0?V:Math.min(N.end,E),!l.extend&&V>N&&(E=N,N=V,V=E),E=Rr(f,V);var ie=Rr(f,N);E&&ie&&(l.rangeCount!==1||l.anchorNode!==E.node||l.anchorOffset!==E.offset||l.focusNode!==ie.node||l.focusOffset!==ie.offset)&&(u=u.createRange(),u.setStart(E.node,E.offset),l.removeAllRanges(),V>N?(l.addRange(u),l.extend(ie.node,ie.offset)):(u.setEnd(ie.node,ie.offset),l.addRange(u)))}}for(u=[],l=f;l=l.parentNode;)l.nodeType===1&&u.push({element:l,left:l.scrollLeft,top:l.scrollTop});for(typeof f.focus=="function"&&f.focus(),f=0;f<u.length;f++)l=u[f],l.element.scrollLeft=l.left,l.element.scrollTop=l.top}}var zl=c&&"documentMode"in document&&11>=document.documentMode,Ci=null,jd=null,Cl=null,_d=!1;function Pu(l,u,f){var N=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;_d||Ci==null||Ci!==_e(N)||(N=Ci,"selectionStart"in N&&Ln(N)?N={start:N.selectionStart,end:N.selectionEnd}:(N=(N.ownerDocument&&N.ownerDocument.defaultView||window).getSelection(),N={anchorNode:N.anchorNode,anchorOffset:N.anchorOffset,focusNode:N.focusNode,focusOffset:N.focusOffset}),Cl&&Sa(Cl,N)||(Cl=N,N=wd(jd,"onSelect"),0<N.length&&(u=new _l("onSelect","select",null,u,f),l.push({event:u,listeners:N}),u.target=Ci)))}function vc(l,u){var f={};return f[l.toLowerCase()]=u.toLowerCase(),f["Webkit"+l]="webkit"+u,f["Moz"+l]="moz"+u,f}var Ho={animationend:vc("Animation","AnimationEnd"),animationiteration:vc("Animation","AnimationIteration"),animationstart:vc("Animation","AnimationStart"),transitionend:vc("Transition","TransitionEnd")},Zo={},Au={};c&&(Au=document.createElement("div").style,"AnimationEvent"in window||(delete Ho.animationend.animation,delete Ho.animationiteration.animation,delete Ho.animationstart.animation),"TransitionEvent"in window||delete Ho.transitionend.transition);function yc(l){if(Zo[l])return Zo[l];if(!Ho[l])return l;var u=Ho[l],f;for(f in u)if(u.hasOwnProperty(f)&&f in Au)return Zo[l]=u[f];return l}var Ou=yc("animationend"),Du=yc("animationiteration"),Eu=yc("animationstart"),Iu=yc("transitionend"),Lu=new Map,Tu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function si(l,u){Lu.set(l,u),i(u,[l])}for(var Pl=0;Pl<Tu.length;Pl++){var xa=Tu[Pl],pn=xa.toLowerCase(),kd=xa[0].toUpperCase()+xa.slice(1);si(pn,"on"+kd)}si(Ou,"onAnimationEnd"),si(Du,"onAnimationIteration"),si(Eu,"onAnimationStart"),si("dblclick","onDoubleClick"),si("focusin","onFocus"),si("focusout","onBlur"),si(Iu,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var no="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Xp=new Set("cancel close invalid load scroll toggle".split(" ").concat(no));function jc(l,u,f){var N=l.type||"unknown-event";l.currentTarget=f,Wn(N,u,void 0,l),l.currentTarget=null}function _c(l,u){u=(u&4)!==0;for(var f=0;f<l.length;f++){var N=l[f],E=N.event;N=N.listeners;e:{var V=void 0;if(u)for(var ie=N.length-1;0<=ie;ie--){var ye=N[ie],ze=ye.instance,Fe=ye.currentTarget;if(ye=ye.listener,ze!==V&&E.isPropagationStopped())break e;jc(E,ye,Fe),V=ze}else for(ie=0;ie<N.length;ie++){if(ye=N[ie],ze=ye.instance,Fe=ye.currentTarget,ye=ye.listener,ze!==V&&E.isPropagationStopped())break e;jc(E,ye,Fe),V=ze}}}if(mr)throw l=tn,mr=!1,tn=null,l}function Ur(l,u){var f=u[Ca];f===void 0&&(f=u[Ca]=new Set);var N=l+"__bubble";f.has(N)||(kc(u,l,2,!1),f.add(N))}function Nd(l,u,f){var N=0;u&&(N|=4),kc(f,l,N,u)}var Al="_reactListening"+Math.random().toString(36).slice(2);function Wo(l){if(!l[Al]){l[Al]=!0,a.forEach(function(f){f!=="selectionchange"&&(Xp.has(f)||Nd(f,!1,l),Nd(f,!0,l))});var u=l.nodeType===9?l:l.ownerDocument;u===null||u[Al]||(u[Al]=!0,Nd("selectionchange",!1,u))}}function kc(l,u,f,N){switch(Eo(u)){case 1:var E=pc;break;case 4:E=mc;break;default:E=_i}f=E.bind(null,u,f,l),E=void 0,!Ke||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(E=!0),N?E!==void 0?l.addEventListener(u,f,{capture:!0,passive:E}):l.addEventListener(u,f,!0):E!==void 0?l.addEventListener(u,f,{passive:E}):l.addEventListener(u,f,!1)}function Nc(l,u,f,N,E){var V=N;if((u&1)===0&&(u&2)===0&&N!==null)e:for(;;){if(N===null)return;var ie=N.tag;if(ie===3||ie===4){var ye=N.stateNode.containerInfo;if(ye===E||ye.nodeType===8&&ye.parentNode===E)break;if(ie===4)for(ie=N.return;ie!==null;){var ze=ie.tag;if((ze===3||ze===4)&&(ze=ie.stateNode.containerInfo,ze===E||ze.nodeType===8&&ze.parentNode===E))return;ie=ie.return}for(;ye!==null;){if(ie=io(ye),ie===null)return;if(ze=ie.tag,ze===5||ze===6){N=V=ie;continue e}ye=ye.parentNode}}N=N.return}dt(function(){var Fe=V,Ye=qt(f),Xe=[];e:{var Ge=Lu.get(l);if(Ge!==void 0){var mt=_l,jt=l;switch(l){case"keypress":if(on(f)===0)break e;case"keydown":case"keyup":mt=Xi;break;case"focusin":jt="focus",mt=Gt;break;case"focusout":jt="blur",mt=Gt;break;case"beforeblur":case"afterblur":mt=Gt;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":mt=We;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":mt=Ct;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":mt=na;break;case Ou:case Du:case Eu:mt=as;break;case Iu:mt=Fo;break;case"scroll":mt=ae;break;case"wheel":mt=bc;break;case"copy":case"cut":case"paste":mt=Wr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":mt=Qi}var St=(u&4)!==0,Fs=!St&&l==="scroll",Le=St?Ge!==null?Ge+"Capture":null:Ge;St=[];for(var Pe=Fe,Me;Pe!==null;){Me=Pe;var tt=Me.stateNode;if(Me.tag===5&&tt!==null&&(Me=tt,Le!==null&&(tt=kr(Pe,Le),tt!=null&&St.push(wc(Pe,tt,Me)))),Fs)break;Pe=Pe.return}0<St.length&&(Ge=new mt(Ge,jt,null,f,Ye),Xe.push({event:Ge,listeners:St}))}}if((u&7)===0){e:{if(Ge=l==="mouseover"||l==="pointerover",mt=l==="mouseout"||l==="pointerout",Ge&&f!==or&&(jt=f.relatedTarget||f.fromElement)&&(io(jt)||jt[ia]))break e;if((mt||Ge)&&(Ge=Ye.window===Ye?Ye:(Ge=Ye.ownerDocument)?Ge.defaultView||Ge.parentWindow:window,mt?(jt=f.relatedTarget||f.toElement,mt=Fe,jt=jt?io(jt):null,jt!==null&&(Fs=Ys(jt),jt!==Fs||jt.tag!==5&&jt.tag!==6)&&(jt=null)):(mt=null,jt=Fe),mt!==jt)){if(St=We,tt="onMouseLeave",Le="onMouseEnter",Pe="mouse",(l==="pointerout"||l==="pointerover")&&(St=Qi,tt="onPointerLeave",Le="onPointerEnter",Pe="pointer"),Fs=mt==null?Ge:Yo(mt),Me=jt==null?Ge:Yo(jt),Ge=new St(tt,Pe+"leave",mt,f,Ye),Ge.target=Fs,Ge.relatedTarget=Me,tt=null,io(Ye)===Fe&&(St=new St(Le,Pe+"enter",jt,f,Ye),St.target=Me,St.relatedTarget=Fs,tt=St),Fs=tt,mt&&jt)t:{for(St=mt,Le=jt,Pe=0,Me=St;Me;Me=Ko(Me))Pe++;for(Me=0,tt=Le;tt;tt=Ko(tt))Me++;for(;0<Pe-Me;)St=Ko(St),Pe--;for(;0<Me-Pe;)Le=Ko(Le),Me--;for(;Pe--;){if(St===Le||Le!==null&&St===Le.alternate)break t;St=Ko(St),Le=Ko(Le)}St=null}else St=null;mt!==null&&Qp(Xe,Ge,mt,St,!1),jt!==null&&Fs!==null&&Qp(Xe,Fs,jt,St,!0)}}e:{if(Ge=Fe?Yo(Fe):window,mt=Ge.nodeName&&Ge.nodeName.toLowerCase(),mt==="select"||mt==="input"&&Ge.type==="file")var At=ri;else if(ei(Ge))if(In)At=ao;else{At=so;var $t=ro}else(mt=Ge.nodeName)&&mt.toLowerCase()==="input"&&(Ge.type==="checkbox"||Ge.type==="radio")&&(At=Bo);if(At&&(At=At(l,Fe))){wi(Xe,At,f,Ye);break e}$t&&$t(l,Ge,Fe),l==="focusout"&&($t=Ge._wrapperState)&&$t.controlled&&Ge.type==="number"&&Oe(Ge,"number",Ge.value)}switch($t=Fe?Yo(Fe):window,l){case"focusin":(ei($t)||$t.contentEditable==="true")&&(Ci=$t,jd=Fe,Cl=null);break;case"focusout":Cl=jd=Ci=null;break;case"mousedown":_d=!0;break;case"contextmenu":case"mouseup":case"dragend":_d=!1,Pu(Xe,f,Ye);break;case"selectionchange":if(zl)break;case"keydown":case"keyup":Pu(Xe,f,Ye)}var Bt;if(En)e:{switch(l){case"compositionstart":var Xt="onCompositionStart";break e;case"compositionend":Xt="onCompositionEnd";break e;case"compositionupdate":Xt="onCompositionUpdate";break e}Xt=void 0}else un?Nl(l,f)&&(Xt="onCompositionEnd"):l==="keydown"&&f.keyCode===229&&(Xt="onCompositionStart");Xt&&(Ha&&f.locale!=="ko"&&(un||Xt!=="onCompositionStart"?Xt==="onCompositionEnd"&&un&&(Bt=hc()):(nn=Ye,ki="value"in nn?nn.value:nn.textContent,un=!0)),$t=wd(Fe,Xt),0<$t.length&&(Xt=new gs(Xt,l,null,f,Ye),Xe.push({event:Xt,listeners:$t}),Bt?Xt.data=Bt:(Bt=Ni(f),Bt!==null&&(Xt.data=Bt)))),(Bt=yd?Za(l,f):Wa(l,f))&&(Fe=wd(Fe,"onBeforeInput"),0<Fe.length&&(Ye=new gs("onBeforeInput","beforeinput",null,f,Ye),Xe.push({event:Ye,listeners:Fe}),Ye.data=Bt))}_c(Xe,u)})}function wc(l,u,f){return{instance:l,listener:u,currentTarget:f}}function wd(l,u){for(var f=u+"Capture",N=[];l!==null;){var E=l,V=E.stateNode;E.tag===5&&V!==null&&(E=V,V=kr(l,f),V!=null&&N.unshift(wc(l,V,E)),V=kr(l,u),V!=null&&N.push(wc(l,V,E))),l=l.return}return N}function Ko(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5);return l||null}function Qp(l,u,f,N,E){for(var V=u._reactName,ie=[];f!==null&&f!==N;){var ye=f,ze=ye.alternate,Fe=ye.stateNode;if(ze!==null&&ze===N)break;ye.tag===5&&Fe!==null&&(ye=Fe,E?(ze=kr(f,V),ze!=null&&ie.unshift(wc(f,ze,ye))):E||(ze=kr(f,V),ze!=null&&ie.push(wc(f,ze,ye)))),f=f.return}ie.length!==0&&l.push({event:u,listeners:ie})}var fx=/\r\n?/g,bx=/\u0000|\uFFFD/g;function em(l){return(typeof l=="string"?l:""+l).replace(fx,`
`).replace(bx,"")}function Sd(l,u,f){if(u=em(u),em(l)!==u&&f)throw Error(r(425))}function Ol(){}var Sc=null,Go=null;function Ru(l,u){return l==="textarea"||l==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var Mu=typeof setTimeout=="function"?setTimeout:void 0,tm=typeof clearTimeout=="function"?clearTimeout:void 0,rm=typeof Promise=="function"?Promise:void 0,gx=typeof queueMicrotask=="function"?queueMicrotask:typeof rm<"u"?function(l){return rm.resolve(null).then(l).catch(vx)}:Mu;function vx(l){setTimeout(function(){throw l})}function Fu(l,u){var f=u,N=0;do{var E=f.nextSibling;if(l.removeChild(f),E&&E.nodeType===8)if(f=E.data,f==="/$"){if(N===0){l.removeChild(E),Jn(u);return}N--}else f!=="$"&&f!=="$?"&&f!=="$!"||N++;f=E}while(f);Jn(u)}function fa(l){for(;l!=null;l=l.nextSibling){var u=l.nodeType;if(u===1||u===3)break;if(u===8){if(u=l.data,u==="$"||u==="$!"||u==="$?")break;if(u==="/$")return null}}return l}function mn(l){l=l.previousSibling;for(var u=0;l;){if(l.nodeType===8){var f=l.data;if(f==="$"||f==="$!"||f==="$?"){if(u===0)return l;u--}else f==="/$"&&u++}l=l.previousSibling}return null}var za=Math.random().toString(36).slice(2),ai="__reactFiber$"+za,Dl="__reactProps$"+za,ia="__reactContainer$"+za,Ca="__reactEvents$"+za,yx="__reactListeners$"+za,jx="__reactHandles$"+za;function io(l){var u=l[ai];if(u)return u;for(var f=l.parentNode;f;){if(u=f[ia]||f[ai]){if(f=u.alternate,u.child!==null||f!==null&&f.child!==null)for(l=mn(l);l!==null;){if(f=l[ai])return f;l=mn(l)}return u}l=f,f=l.parentNode}return null}function El(l){return l=l[ai]||l[ia],!l||l.tag!==5&&l.tag!==6&&l.tag!==13&&l.tag!==3?null:l}function Yo(l){if(l.tag===5||l.tag===6)return l.stateNode;throw Error(r(33))}function zc(l){return l[Dl]||null}var Uu=[],Pi=-1;function Tn(l){return{current:l}}function Er(l){0>Pi||(l.current=Uu[Pi],Uu[Pi]=null,Pi--)}function Mr(l,u){Pi++,Uu[Pi]=l.current,l.current=u}var oo={},Xs=Tn(oo),Pa=Tn(!1),Jo=oo;function Il(l,u){var f=l.type.contextTypes;if(!f)return oo;var N=l.stateNode;if(N&&N.__reactInternalMemoizedUnmaskedChildContext===u)return N.__reactInternalMemoizedMaskedChildContext;var E={},V;for(V in f)E[V]=u[V];return N&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=u,l.__reactInternalMemoizedMaskedChildContext=E),E}function Aa(l){return l=l.childContextTypes,l!=null}function zd(){Er(Pa),Er(Xs)}function sm(l,u,f){if(Xs.current!==oo)throw Error(r(168));Mr(Xs,u),Mr(Pa,f)}function qu(l,u,f){var N=l.stateNode;if(u=u.childContextTypes,typeof N.getChildContext!="function")return f;N=N.getChildContext();for(var E in N)if(!(E in u))throw Error(r(108,H(l)||"Unknown",E));return xe({},f,N)}function Xo(l){return l=(l=l.stateNode)&&l.__reactInternalMemoizedMergedChildContext||oo,Jo=Xs.current,Mr(Xs,l),Mr(Pa,Pa.current),!0}function am(l,u,f){var N=l.stateNode;if(!N)throw Error(r(169));f?(l=qu(l,u,Jo),N.__reactInternalMemoizedMergedChildContext=l,Er(Pa),Er(Xs),Mr(Xs,l)):Er(Pa),Mr(Pa,f)}var Ai=null,Cc=!1,y=!1;function w(l){Ai===null?Ai=[l]:Ai.push(l)}function M(l){Cc=!0,w(l)}function G(){if(!y&&Ai!==null){y=!0;var l=0,u=yr;try{var f=Ai;for(yr=1;l<f.length;l++){var N=f[l];do N=N(!0);while(N!==null)}Ai=null,Cc=!1}catch(E){throw Ai!==null&&(Ai=Ai.slice(l+1)),ko(xl,G),E}finally{yr=u,y=!1}}return null}var se=[],le=0,de=null,pe=0,me=[],fe=0,Se=null,Ie=1,be="";function Ce(l,u){se[le++]=pe,se[le++]=de,de=l,pe=u}function Ee(l,u,f){me[fe++]=Ie,me[fe++]=be,me[fe++]=Se,Se=l;var N=Ie;l=be;var E=32-sa(N)-1;N&=~(1<<E),f+=1;var V=32-sa(u)+E;if(30<V){var ie=E-E%5;V=(N&(1<<ie)-1).toString(32),N>>=ie,E-=ie,Ie=1<<32-sa(u)+E|f<<E|N,be=V+l}else Ie=1<<V|f<<E|N,be=l}function $e(l){l.return!==null&&(Ce(l,1),Ee(l,1,0))}function Te(l){for(;l===de;)de=se[--le],se[le]=null,pe=se[--le],se[le]=null;for(;l===Se;)Se=me[--fe],me[fe]=null,be=me[--fe],me[fe]=null,Ie=me[--fe],me[fe]=null}var Ue=null,qe=null,He=!1,Ze=null;function Pt(l,u){var f=ci(5,null,null,0);f.elementType="DELETED",f.stateNode=u,f.return=l,u=l.deletions,u===null?(l.deletions=[f],l.flags|=16):u.push(f)}function ht(l,u){switch(l.tag){case 5:var f=l.type;return u=u.nodeType!==1||f.toLowerCase()!==u.nodeName.toLowerCase()?null:u,u!==null?(l.stateNode=u,Ue=l,qe=fa(u.firstChild),!0):!1;case 6:return u=l.pendingProps===""||u.nodeType!==3?null:u,u!==null?(l.stateNode=u,Ue=l,qe=null,!0):!1;case 13:return u=u.nodeType!==8?null:u,u!==null?(f=Se!==null?{id:Ie,overflow:be}:null,l.memoizedState={dehydrated:u,treeContext:f,retryLane:1073741824},f=ci(18,null,null,0),f.stateNode=u,f.return=l,l.child=f,Ue=l,qe=null,!0):!1;default:return!1}}function sr(l){return(l.mode&1)!==0&&(l.flags&128)===0}function yt(l){if(He){var u=qe;if(u){var f=u;if(!ht(l,u)){if(sr(l))throw Error(r(418));u=fa(f.nextSibling);var N=Ue;u&&ht(l,u)?Pt(N,f):(l.flags=l.flags&-4097|2,He=!1,Ue=l)}}else{if(sr(l))throw Error(r(418));l.flags=l.flags&-4097|2,He=!1,Ue=l}}}function xr(l){for(l=l.return;l!==null&&l.tag!==5&&l.tag!==3&&l.tag!==13;)l=l.return;Ue=l}function ms(l){if(l!==Ue)return!1;if(!He)return xr(l),He=!0,!1;var u;if((u=l.tag!==3)&&!(u=l.tag!==5)&&(u=l.type,u=u!=="head"&&u!=="body"&&!Ru(l.type,l.memoizedProps)),u&&(u=qe)){if(sr(l))throw nr(),Error(r(418));for(;u;)Pt(l,u),u=fa(u.nextSibling)}if(xr(l),l.tag===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(r(317));e:{for(l=l.nextSibling,u=0;l;){if(l.nodeType===8){var f=l.data;if(f==="/$"){if(u===0){qe=fa(l.nextSibling);break e}u--}else f!=="$"&&f!=="$!"&&f!=="$?"||u++}l=l.nextSibling}qe=null}}else qe=Ue?fa(l.stateNode.nextSibling):null;return!0}function nr(){for(var l=qe;l;)l=fa(l.nextSibling)}function xt(){qe=Ue=null,He=!1}function at(l){Ze===null?Ze=[l]:Ze.push(l)}var ys=L.ReactCurrentBatchConfig;function Wt(l,u,f){if(l=f.ref,l!==null&&typeof l!="function"&&typeof l!="object"){if(f._owner){if(f=f._owner,f){if(f.tag!==1)throw Error(r(309));var N=f.stateNode}if(!N)throw Error(r(147,l));var E=N,V=""+l;return u!==null&&u.ref!==null&&typeof u.ref=="function"&&u.ref._stringRef===V?u.ref:(u=function(ie){var ye=E.refs;ie===null?delete ye[V]:ye[V]=ie},u._stringRef=V,u)}if(typeof l!="string")throw Error(r(284));if(!f._owner)throw Error(r(290,l))}return l}function hr(l,u){throw l=Object.prototype.toString.call(u),Error(r(31,l==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":l))}function Kr(l){var u=l._init;return u(l._payload)}function Vs(l){function u(Le,Pe){if(l){var Me=Le.deletions;Me===null?(Le.deletions=[Pe],Le.flags|=16):Me.push(Pe)}}function f(Le,Pe){if(!l)return null;for(;Pe!==null;)u(Le,Pe),Pe=Pe.sibling;return null}function N(Le,Pe){for(Le=new Map;Pe!==null;)Pe.key!==null?Le.set(Pe.key,Pe):Le.set(Pe.index,Pe),Pe=Pe.sibling;return Le}function E(Le,Pe){return Le=Vl(Le,Pe),Le.index=0,Le.sibling=null,Le}function V(Le,Pe,Me){return Le.index=Me,l?(Me=Le.alternate,Me!==null?(Me=Me.index,Me<Pe?(Le.flags|=2,Pe):Me):(Le.flags|=2,Pe)):(Le.flags|=1048576,Pe)}function ie(Le){return l&&Le.alternate===null&&(Le.flags|=2),Le}function ye(Le,Pe,Me,tt){return Pe===null||Pe.tag!==6?(Pe=Yx(Me,Le.mode,tt),Pe.return=Le,Pe):(Pe=E(Pe,Me),Pe.return=Le,Pe)}function ze(Le,Pe,Me,tt){var At=Me.type;return At===R?Ye(Le,Pe,Me.props.children,tt,Me.key):Pe!==null&&(Pe.elementType===At||typeof At=="object"&&At!==null&&At.$$typeof===re&&Kr(At)===Pe.type)?(tt=E(Pe,Me.props),tt.ref=Wt(Le,Pe,Me),tt.return=Le,tt):(tt=Nm(Me.type,Me.key,Me.props,null,Le.mode,tt),tt.ref=Wt(Le,Pe,Me),tt.return=Le,tt)}function Fe(Le,Pe,Me,tt){return Pe===null||Pe.tag!==4||Pe.stateNode.containerInfo!==Me.containerInfo||Pe.stateNode.implementation!==Me.implementation?(Pe=Jx(Me,Le.mode,tt),Pe.return=Le,Pe):(Pe=E(Pe,Me.children||[]),Pe.return=Le,Pe)}function Ye(Le,Pe,Me,tt,At){return Pe===null||Pe.tag!==7?(Pe=Tc(Me,Le.mode,tt,At),Pe.return=Le,Pe):(Pe=E(Pe,Me),Pe.return=Le,Pe)}function Xe(Le,Pe,Me){if(typeof Pe=="string"&&Pe!==""||typeof Pe=="number")return Pe=Yx(""+Pe,Le.mode,Me),Pe.return=Le,Pe;if(typeof Pe=="object"&&Pe!==null){switch(Pe.$$typeof){case F:return Me=Nm(Pe.type,Pe.key,Pe.props,null,Le.mode,Me),Me.ref=Wt(Le,null,Pe),Me.return=Le,Me;case W:return Pe=Jx(Pe,Le.mode,Me),Pe.return=Le,Pe;case re:var tt=Pe._init;return Xe(Le,tt(Pe._payload),Me)}if(Je(Pe)||oe(Pe))return Pe=Tc(Pe,Le.mode,Me,null),Pe.return=Le,Pe;hr(Le,Pe)}return null}function Ge(Le,Pe,Me,tt){var At=Pe!==null?Pe.key:null;if(typeof Me=="string"&&Me!==""||typeof Me=="number")return At!==null?null:ye(Le,Pe,""+Me,tt);if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case F:return Me.key===At?ze(Le,Pe,Me,tt):null;case W:return Me.key===At?Fe(Le,Pe,Me,tt):null;case re:return At=Me._init,Ge(Le,Pe,At(Me._payload),tt)}if(Je(Me)||oe(Me))return At!==null?null:Ye(Le,Pe,Me,tt,null);hr(Le,Me)}return null}function mt(Le,Pe,Me,tt,At){if(typeof tt=="string"&&tt!==""||typeof tt=="number")return Le=Le.get(Me)||null,ye(Pe,Le,""+tt,At);if(typeof tt=="object"&&tt!==null){switch(tt.$$typeof){case F:return Le=Le.get(tt.key===null?Me:tt.key)||null,ze(Pe,Le,tt,At);case W:return Le=Le.get(tt.key===null?Me:tt.key)||null,Fe(Pe,Le,tt,At);case re:var $t=tt._init;return mt(Le,Pe,Me,$t(tt._payload),At)}if(Je(tt)||oe(tt))return Le=Le.get(Me)||null,Ye(Pe,Le,tt,At,null);hr(Pe,tt)}return null}function jt(Le,Pe,Me,tt){for(var At=null,$t=null,Bt=Pe,Xt=Pe=0,ua=null;Bt!==null&&Xt<Me.length;Xt++){Bt.index>Xt?(ua=Bt,Bt=null):ua=Bt.sibling;var Or=Ge(Le,Bt,Me[Xt],tt);if(Or===null){Bt===null&&(Bt=ua);break}l&&Bt&&Or.alternate===null&&u(Le,Bt),Pe=V(Or,Pe,Xt),$t===null?At=Or:$t.sibling=Or,$t=Or,Bt=ua}if(Xt===Me.length)return f(Le,Bt),He&&Ce(Le,Xt),At;if(Bt===null){for(;Xt<Me.length;Xt++)Bt=Xe(Le,Me[Xt],tt),Bt!==null&&(Pe=V(Bt,Pe,Xt),$t===null?At=Bt:$t.sibling=Bt,$t=Bt);return He&&Ce(Le,Xt),At}for(Bt=N(Le,Bt);Xt<Me.length;Xt++)ua=mt(Bt,Le,Xt,Me[Xt],tt),ua!==null&&(l&&ua.alternate!==null&&Bt.delete(ua.key===null?Xt:ua.key),Pe=V(ua,Pe,Xt),$t===null?At=ua:$t.sibling=ua,$t=ua);return l&&Bt.forEach(function(Hl){return u(Le,Hl)}),He&&Ce(Le,Xt),At}function St(Le,Pe,Me,tt){var At=oe(Me);if(typeof At!="function")throw Error(r(150));if(Me=At.call(Me),Me==null)throw Error(r(151));for(var $t=At=null,Bt=Pe,Xt=Pe=0,ua=null,Or=Me.next();Bt!==null&&!Or.done;Xt++,Or=Me.next()){Bt.index>Xt?(ua=Bt,Bt=null):ua=Bt.sibling;var Hl=Ge(Le,Bt,Or.value,tt);if(Hl===null){Bt===null&&(Bt=ua);break}l&&Bt&&Hl.alternate===null&&u(Le,Bt),Pe=V(Hl,Pe,Xt),$t===null?At=Hl:$t.sibling=Hl,$t=Hl,Bt=ua}if(Or.done)return f(Le,Bt),He&&Ce(Le,Xt),At;if(Bt===null){for(;!Or.done;Xt++,Or=Me.next())Or=Xe(Le,Or.value,tt),Or!==null&&(Pe=V(Or,Pe,Xt),$t===null?At=Or:$t.sibling=Or,$t=Or);return He&&Ce(Le,Xt),At}for(Bt=N(Le,Bt);!Or.done;Xt++,Or=Me.next())Or=mt(Bt,Le,Xt,Or.value,tt),Or!==null&&(l&&Or.alternate!==null&&Bt.delete(Or.key===null?Xt:Or.key),Pe=V(Or,Pe,Xt),$t===null?At=Or:$t.sibling=Or,$t=Or);return l&&Bt.forEach(function(eN){return u(Le,eN)}),He&&Ce(Le,Xt),At}function Fs(Le,Pe,Me,tt){if(typeof Me=="object"&&Me!==null&&Me.type===R&&Me.key===null&&(Me=Me.props.children),typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case F:e:{for(var At=Me.key,$t=Pe;$t!==null;){if($t.key===At){if(At=Me.type,At===R){if($t.tag===7){f(Le,$t.sibling),Pe=E($t,Me.props.children),Pe.return=Le,Le=Pe;break e}}else if($t.elementType===At||typeof At=="object"&&At!==null&&At.$$typeof===re&&Kr(At)===$t.type){f(Le,$t.sibling),Pe=E($t,Me.props),Pe.ref=Wt(Le,$t,Me),Pe.return=Le,Le=Pe;break e}f(Le,$t);break}else u(Le,$t);$t=$t.sibling}Me.type===R?(Pe=Tc(Me.props.children,Le.mode,tt,Me.key),Pe.return=Le,Le=Pe):(tt=Nm(Me.type,Me.key,Me.props,null,Le.mode,tt),tt.ref=Wt(Le,Pe,Me),tt.return=Le,Le=tt)}return ie(Le);case W:e:{for($t=Me.key;Pe!==null;){if(Pe.key===$t)if(Pe.tag===4&&Pe.stateNode.containerInfo===Me.containerInfo&&Pe.stateNode.implementation===Me.implementation){f(Le,Pe.sibling),Pe=E(Pe,Me.children||[]),Pe.return=Le,Le=Pe;break e}else{f(Le,Pe);break}else u(Le,Pe);Pe=Pe.sibling}Pe=Jx(Me,Le.mode,tt),Pe.return=Le,Le=Pe}return ie(Le);case re:return $t=Me._init,Fs(Le,Pe,$t(Me._payload),tt)}if(Je(Me))return jt(Le,Pe,Me,tt);if(oe(Me))return St(Le,Pe,Me,tt);hr(Le,Me)}return typeof Me=="string"&&Me!==""||typeof Me=="number"?(Me=""+Me,Pe!==null&&Pe.tag===6?(f(Le,Pe.sibling),Pe=E(Pe,Me),Pe.return=Le,Le=Pe):(f(Le,Pe),Pe=Yx(Me,Le.mode,tt),Pe.return=Le,Le=Pe),ie(Le)):f(Le,Pe)}return Fs}var Os=Vs(!0),ns=Vs(!1),Rs=Tn(null),Hs=null,Qr=null,br=null;function zr(){br=Qr=Hs=null}function es(l){var u=Rs.current;Er(Rs),l._currentValue=u}function Cr(l,u,f){for(;l!==null;){var N=l.alternate;if((l.childLanes&u)!==u?(l.childLanes|=u,N!==null&&(N.childLanes|=u)):N!==null&&(N.childLanes&u)!==u&&(N.childLanes|=u),l===f)break;l=l.return}}function hs(l,u){Hs=l,br=Qr=null,l=l.dependencies,l!==null&&l.firstContext!==null&&((l.lanes&u)!==0&&(xn=!0),l.firstContext=null)}function xs(l){var u=l._currentValue;if(br!==l)if(l={context:l,memoizedValue:u,next:null},Qr===null){if(Hs===null)throw Error(r(308));Qr=l,Hs.dependencies={lanes:0,firstContext:l}}else Qr=Qr.next=l;return u}var qr=null;function oa(l){qr===null?qr=[l]:qr.push(l)}function Fr(l,u,f,N){var E=u.interleaved;return E===null?(f.next=f,oa(u)):(f.next=E.next,E.next=f),u.interleaved=f,$r(l,N)}function $r(l,u){l.lanes|=u;var f=l.alternate;for(f!==null&&(f.lanes|=u),f=l,l=l.return;l!==null;)l.childLanes|=u,f=l.alternate,f!==null&&(f.childLanes|=u),f=l,l=l.return;return f.tag===3?f.stateNode:null}var Ds=!1;function Qs(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Oa(l,u){l=l.updateQueue,u.updateQueue===l&&(u.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,effects:l.effects})}function js(l,u){return{eventTime:l,lane:u,tag:0,payload:null,callback:null,next:null}}function _s(l,u,f){var N=l.updateQueue;if(N===null)return null;if(N=N.shared,(Pr&2)!==0){var E=N.pending;return E===null?u.next=u:(u.next=E.next,E.next=u),N.pending=u,$r(l,f)}return E=N.interleaved,E===null?(u.next=u,oa(N)):(u.next=E.next,E.next=u),N.interleaved=u,$r(l,f)}function la(l,u,f){if(u=u.updateQueue,u!==null&&(u=u.shared,(f&4194240)!==0)){var N=u.lanes;N&=l.pendingLanes,f|=N,u.lanes=f,bl(l,f)}}function Br(l,u){var f=l.updateQueue,N=l.alternate;if(N!==null&&(N=N.updateQueue,f===N)){var E=null,V=null;if(f=f.firstBaseUpdate,f!==null){do{var ie={eventTime:f.eventTime,lane:f.lane,tag:f.tag,payload:f.payload,callback:f.callback,next:null};V===null?E=V=ie:V=V.next=ie,f=f.next}while(f!==null);V===null?E=V=u:V=V.next=u}else E=V=u;f={baseState:N.baseState,firstBaseUpdate:E,lastBaseUpdate:V,shared:N.shared,effects:N.effects},l.updateQueue=f;return}l=f.lastBaseUpdate,l===null?f.firstBaseUpdate=u:l.next=u,f.lastBaseUpdate=u}function ca(l,u,f,N){var E=l.updateQueue;Ds=!1;var V=E.firstBaseUpdate,ie=E.lastBaseUpdate,ye=E.shared.pending;if(ye!==null){E.shared.pending=null;var ze=ye,Fe=ze.next;ze.next=null,ie===null?V=Fe:ie.next=Fe,ie=ze;var Ye=l.alternate;Ye!==null&&(Ye=Ye.updateQueue,ye=Ye.lastBaseUpdate,ye!==ie&&(ye===null?Ye.firstBaseUpdate=Fe:ye.next=Fe,Ye.lastBaseUpdate=ze))}if(V!==null){var Xe=E.baseState;ie=0,Ye=Fe=ze=null,ye=V;do{var Ge=ye.lane,mt=ye.eventTime;if((N&Ge)===Ge){Ye!==null&&(Ye=Ye.next={eventTime:mt,lane:0,tag:ye.tag,payload:ye.payload,callback:ye.callback,next:null});e:{var jt=l,St=ye;switch(Ge=u,mt=f,St.tag){case 1:if(jt=St.payload,typeof jt=="function"){Xe=jt.call(mt,Xe,Ge);break e}Xe=jt;break e;case 3:jt.flags=jt.flags&-65537|128;case 0:if(jt=St.payload,Ge=typeof jt=="function"?jt.call(mt,Xe,Ge):jt,Ge==null)break e;Xe=xe({},Xe,Ge);break e;case 2:Ds=!0}}ye.callback!==null&&ye.lane!==0&&(l.flags|=64,Ge=E.effects,Ge===null?E.effects=[ye]:Ge.push(ye))}else mt={eventTime:mt,lane:Ge,tag:ye.tag,payload:ye.payload,callback:ye.callback,next:null},Ye===null?(Fe=Ye=mt,ze=Xe):Ye=Ye.next=mt,ie|=Ge;if(ye=ye.next,ye===null){if(ye=E.shared.pending,ye===null)break;Ge=ye,ye=Ge.next,Ge.next=null,E.lastBaseUpdate=Ge,E.shared.pending=null}}while(!0);if(Ye===null&&(ze=Xe),E.baseState=ze,E.firstBaseUpdate=Fe,E.lastBaseUpdate=Ye,u=E.shared.interleaved,u!==null){E=u;do ie|=E.lane,E=E.next;while(E!==u)}else V===null&&(E.shared.lanes=0);Dc|=ie,l.lanes=ie,l.memoizedState=Xe}}function hn(l,u,f){if(l=u.effects,u.effects=null,l!==null)for(u=0;u<l.length;u++){var N=l[u],E=N.callback;if(E!==null){if(N.callback=null,N=f,typeof E!="function")throw Error(r(191,E));E.call(N)}}}var Rn={},Zs=Tn(Rn),ks=Tn(Rn),lo=Tn(Rn);function Oi(l){if(l===Rn)throw Error(r(174));return l}function Ll(l,u){switch(Mr(lo,u),Mr(ks,l),Mr(Zs,Rn),l=u.nodeType,l){case 9:case 11:u=(u=u.documentElement)?u.namespaceURI:Jt(null,"");break;default:l=l===8?u.parentNode:u,u=l.namespaceURI||null,l=l.tagName,u=Jt(u,l)}Er(Zs),Mr(Zs,u)}function ni(){Er(Zs),Er(ks),Er(lo)}function nm(l){Oi(lo.current);var u=Oi(Zs.current),f=Jt(u,l.type);u!==f&&(Mr(ks,l),Mr(Zs,f))}function $u(l){ks.current===l&&(Er(Zs),Er(ks))}var Jr=Tn(0);function Mn(l){for(var u=l;u!==null;){if(u.tag===13){var f=u.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||f.data==="$?"||f.data==="$!"))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var Bu=[];function Vu(){for(var l=0;l<Bu.length;l++)Bu[l]._workInProgressVersionPrimary=null;Bu.length=0}var Cd=L.ReactCurrentDispatcher,Pd=L.ReactCurrentBatchConfig,ii=0,ts=null,Es=null,Ns=null,Tl=!1,Di=!1,Rl=0,_x=0;function Ms(){throw Error(r(321))}function Ad(l,u){if(u===null)return!1;for(var f=0;f<u.length&&f<l.length;f++)if(!us(l[f],u[f]))return!1;return!0}function Pc(l,u,f,N,E,V){if(ii=V,ts=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,Cd.current=l===null||l.memoizedState===null?Sk:zk,l=f(N,E),Di){V=0;do{if(Di=!1,Rl=0,25<=V)throw Error(r(301));V+=1,Ns=Es=null,u.updateQueue=null,Cd.current=Ck,l=f(N,E)}while(Di)}if(Cd.current=dm,u=Es!==null&&Es.next!==null,ii=0,Ns=Es=ts=null,Tl=!1,u)throw Error(r(300));return l}function oi(){var l=Rl!==0;return Rl=0,l}function Fn(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ns===null?ts.memoizedState=Ns=l:Ns=Ns.next=l,Ns}function Ka(){if(Es===null){var l=ts.alternate;l=l!==null?l.memoizedState:null}else l=Es.next;var u=Ns===null?ts.memoizedState:Ns.next;if(u!==null)Ns=u,Es=l;else{if(l===null)throw Error(r(310));Es=l,l={memoizedState:Es.memoizedState,baseState:Es.baseState,baseQueue:Es.baseQueue,queue:Es.queue,next:null},Ns===null?ts.memoizedState=Ns=l:Ns=Ns.next=l}return Ns}function Ac(l,u){return typeof u=="function"?u(l):u}function Od(l){var u=Ka(),f=u.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=l;var N=Es,E=N.baseQueue,V=f.pending;if(V!==null){if(E!==null){var ie=E.next;E.next=V.next,V.next=ie}N.baseQueue=E=V,f.pending=null}if(E!==null){V=E.next,N=N.baseState;var ye=ie=null,ze=null,Fe=V;do{var Ye=Fe.lane;if((ii&Ye)===Ye)ze!==null&&(ze=ze.next={lane:0,action:Fe.action,hasEagerState:Fe.hasEagerState,eagerState:Fe.eagerState,next:null}),N=Fe.hasEagerState?Fe.eagerState:l(N,Fe.action);else{var Xe={lane:Ye,action:Fe.action,hasEagerState:Fe.hasEagerState,eagerState:Fe.eagerState,next:null};ze===null?(ye=ze=Xe,ie=N):ze=ze.next=Xe,ts.lanes|=Ye,Dc|=Ye}Fe=Fe.next}while(Fe!==null&&Fe!==V);ze===null?ie=N:ze.next=ye,us(N,u.memoizedState)||(xn=!0),u.memoizedState=N,u.baseState=ie,u.baseQueue=ze,f.lastRenderedState=N}if(l=f.interleaved,l!==null){E=l;do V=E.lane,ts.lanes|=V,Dc|=V,E=E.next;while(E!==l)}else E===null&&(f.lanes=0);return[u.memoizedState,f.dispatch]}function co(l){var u=Ka(),f=u.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=l;var N=f.dispatch,E=f.pending,V=u.memoizedState;if(E!==null){f.pending=null;var ie=E=E.next;do V=l(V,ie.action),ie=ie.next;while(ie!==E);us(V,u.memoizedState)||(xn=!0),u.memoizedState=V,u.baseQueue===null&&(u.baseState=V),f.lastRenderedState=V}return[V,N]}function im(){}function Hu(l,u){var f=ts,N=Ka(),E=u(),V=!us(N.memoizedState,E);if(V&&(N.memoizedState=E,xn=!0),N=N.queue,Id(lm.bind(null,f,N,l),[l]),N.getSnapshot!==u||V||Ns!==null&&Ns.memoizedState.tag&1){if(f.flags|=2048,Ga(9,Zu.bind(null,f,N,E,u),void 0,null),da===null)throw Error(r(349));(ii&30)!==0||om(f,u,E)}return E}function om(l,u,f){l.flags|=16384,l={getSnapshot:u,value:f},u=ts.updateQueue,u===null?(u={lastEffect:null,stores:null},ts.updateQueue=u,u.stores=[l]):(f=u.stores,f===null?u.stores=[l]:f.push(l))}function Zu(l,u,f,N){u.value=f,u.getSnapshot=N,Ml(u)&&Dd(l)}function lm(l,u,f){return f(function(){Ml(u)&&Dd(l)})}function Ml(l){var u=l.getSnapshot;l=l.value;try{var f=u();return!us(l,f)}catch{return!0}}function Dd(l){var u=$r(l,1);u!==null&&Ri(u,l,1,-1)}function Oc(l){var u=Fn();return typeof l=="function"&&(l=l()),u.memoizedState=u.baseState=l,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ac,lastRenderedState:l},u.queue=l,l=l.dispatch=wk.bind(null,ts,l),[u.memoizedState,l]}function Ga(l,u,f,N){return l={tag:l,create:u,destroy:f,deps:N,next:null},u=ts.updateQueue,u===null?(u={lastEffect:null,stores:null},ts.updateQueue=u,u.lastEffect=l.next=l):(f=u.lastEffect,f===null?u.lastEffect=l.next=l:(N=f.next,f.next=l,l.next=N,u.lastEffect=l)),l}function Ei(){return Ka().memoizedState}function Un(l,u,f,N){var E=Fn();ts.flags|=l,E.memoizedState=Ga(1|u,f,void 0,N===void 0?null:N)}function Qo(l,u,f,N){var E=Ka();N=N===void 0?null:N;var V=void 0;if(Es!==null){var ie=Es.memoizedState;if(V=ie.destroy,N!==null&&Ad(N,ie.deps)){E.memoizedState=Ga(u,f,V,N);return}}ts.flags|=l,E.memoizedState=Ga(1|u,f,V,N)}function Ed(l,u){return Un(8390656,8,l,u)}function Id(l,u){return Qo(2048,8,l,u)}function cm(l,u){return Qo(4,2,l,u)}function Ld(l,u){return Qo(4,4,l,u)}function Td(l,u){if(typeof u=="function")return l=l(),u(l),function(){u(null)};if(u!=null)return l=l(),u.current=l,function(){u.current=null}}function Tg(l,u,f){return f=f!=null?f.concat([l]):null,Qo(4,4,Td.bind(null,u,l),f)}function kx(){}function Rg(l,u){var f=Ka();u=u===void 0?null:u;var N=f.memoizedState;return N!==null&&u!==null&&Ad(u,N[1])?N[0]:(f.memoizedState=[l,u],l)}function Mg(l,u){var f=Ka();u=u===void 0?null:u;var N=f.memoizedState;return N!==null&&u!==null&&Ad(u,N[1])?N[0]:(l=l(),f.memoizedState=[l,u],l)}function Fg(l,u,f){return(ii&21)===0?(l.baseState&&(l.baseState=!1,xn=!0),l.memoizedState=f):(us(f,u)||(f=hd(),ts.lanes|=f,Dc|=f,l.baseState=!0),u)}function kk(l,u){var f=yr;yr=f!==0&&4>f?f:4,l(!0);var N=Pd.transition;Pd.transition={};try{l(!1),u()}finally{yr=f,Pd.transition=N}}function Ug(){return Ka().memoizedState}function Nk(l,u,f){var N=$l(l);if(f={lane:N,action:f,hasEagerState:!1,eagerState:null,next:null},qg(l))$g(u,f);else if(f=Fr(l,u,f,N),f!==null){var E=Ja();Ri(f,l,N,E),Bg(f,u,N)}}function wk(l,u,f){var N=$l(l),E={lane:N,action:f,hasEagerState:!1,eagerState:null,next:null};if(qg(l))$g(u,E);else{var V=l.alternate;if(l.lanes===0&&(V===null||V.lanes===0)&&(V=u.lastRenderedReducer,V!==null))try{var ie=u.lastRenderedState,ye=V(ie,f);if(E.hasEagerState=!0,E.eagerState=ye,us(ye,ie)){var ze=u.interleaved;ze===null?(E.next=E,oa(u)):(E.next=ze.next,ze.next=E),u.interleaved=E;return}}catch{}finally{}f=Fr(l,u,E,N),f!==null&&(E=Ja(),Ri(f,l,N,E),Bg(f,u,N))}}function qg(l){var u=l.alternate;return l===ts||u!==null&&u===ts}function $g(l,u){Di=Tl=!0;var f=l.pending;f===null?u.next=u:(u.next=f.next,f.next=u),l.pending=u}function Bg(l,u,f){if((f&4194240)!==0){var N=u.lanes;N&=l.pendingLanes,f|=N,u.lanes=f,bl(l,f)}}var dm={readContext:xs,useCallback:Ms,useContext:Ms,useEffect:Ms,useImperativeHandle:Ms,useInsertionEffect:Ms,useLayoutEffect:Ms,useMemo:Ms,useReducer:Ms,useRef:Ms,useState:Ms,useDebugValue:Ms,useDeferredValue:Ms,useTransition:Ms,useMutableSource:Ms,useSyncExternalStore:Ms,useId:Ms,unstable_isNewReconciler:!1},Sk={readContext:xs,useCallback:function(l,u){return Fn().memoizedState=[l,u===void 0?null:u],l},useContext:xs,useEffect:Ed,useImperativeHandle:function(l,u,f){return f=f!=null?f.concat([l]):null,Un(4194308,4,Td.bind(null,u,l),f)},useLayoutEffect:function(l,u){return Un(4194308,4,l,u)},useInsertionEffect:function(l,u){return Un(4,2,l,u)},useMemo:function(l,u){var f=Fn();return u=u===void 0?null:u,l=l(),f.memoizedState=[l,u],l},useReducer:function(l,u,f){var N=Fn();return u=f!==void 0?f(u):u,N.memoizedState=N.baseState=u,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:u},N.queue=l,l=l.dispatch=Nk.bind(null,ts,l),[N.memoizedState,l]},useRef:function(l){var u=Fn();return l={current:l},u.memoizedState=l},useState:Oc,useDebugValue:kx,useDeferredValue:function(l){return Fn().memoizedState=l},useTransition:function(){var l=Oc(!1),u=l[0];return l=kk.bind(null,l[1]),Fn().memoizedState=l,[u,l]},useMutableSource:function(){},useSyncExternalStore:function(l,u,f){var N=ts,E=Fn();if(He){if(f===void 0)throw Error(r(407));f=f()}else{if(f=u(),da===null)throw Error(r(349));(ii&30)!==0||om(N,u,f)}E.memoizedState=f;var V={value:f,getSnapshot:u};return E.queue=V,Ed(lm.bind(null,N,V,l),[l]),N.flags|=2048,Ga(9,Zu.bind(null,N,V,f,u),void 0,null),f},useId:function(){var l=Fn(),u=da.identifierPrefix;if(He){var f=be,N=Ie;f=(N&~(1<<32-sa(N)-1)).toString(32)+f,u=":"+u+"R"+f,f=Rl++,0<f&&(u+="H"+f.toString(32)),u+=":"}else f=_x++,u=":"+u+"r"+f.toString(32)+":";return l.memoizedState=u},unstable_isNewReconciler:!1},zk={readContext:xs,useCallback:Rg,useContext:xs,useEffect:Id,useImperativeHandle:Tg,useInsertionEffect:cm,useLayoutEffect:Ld,useMemo:Mg,useReducer:Od,useRef:Ei,useState:function(){return Od(Ac)},useDebugValue:kx,useDeferredValue:function(l){var u=Ka();return Fg(u,Es.memoizedState,l)},useTransition:function(){var l=Od(Ac)[0],u=Ka().memoizedState;return[l,u]},useMutableSource:im,useSyncExternalStore:Hu,useId:Ug,unstable_isNewReconciler:!1},Ck={readContext:xs,useCallback:Rg,useContext:xs,useEffect:Id,useImperativeHandle:Tg,useInsertionEffect:cm,useLayoutEffect:Ld,useMemo:Mg,useReducer:co,useRef:Ei,useState:function(){return co(Ac)},useDebugValue:kx,useDeferredValue:function(l){var u=Ka();return Es===null?u.memoizedState=l:Fg(u,Es.memoizedState,l)},useTransition:function(){var l=co(Ac)[0],u=Ka().memoizedState;return[l,u]},useMutableSource:im,useSyncExternalStore:Hu,useId:Ug,unstable_isNewReconciler:!1};function Ii(l,u){if(l&&l.defaultProps){u=xe({},u),l=l.defaultProps;for(var f in l)u[f]===void 0&&(u[f]=l[f]);return u}return u}function Nx(l,u,f,N){u=l.memoizedState,f=f(N,u),f=f==null?u:xe({},u,f),l.memoizedState=f,l.lanes===0&&(l.updateQueue.baseState=f)}var um={isMounted:function(l){return(l=l._reactInternals)?Ys(l)===l:!1},enqueueSetState:function(l,u,f){l=l._reactInternals;var N=Ja(),E=$l(l),V=js(N,E);V.payload=u,f!=null&&(V.callback=f),u=_s(l,V,E),u!==null&&(Ri(u,l,E,N),la(u,l,E))},enqueueReplaceState:function(l,u,f){l=l._reactInternals;var N=Ja(),E=$l(l),V=js(N,E);V.tag=1,V.payload=u,f!=null&&(V.callback=f),u=_s(l,V,E),u!==null&&(Ri(u,l,E,N),la(u,l,E))},enqueueForceUpdate:function(l,u){l=l._reactInternals;var f=Ja(),N=$l(l),E=js(f,N);E.tag=2,u!=null&&(E.callback=u),u=_s(l,E,N),u!==null&&(Ri(u,l,N,f),la(u,l,N))}};function Vg(l,u,f,N,E,V,ie){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(N,V,ie):u.prototype&&u.prototype.isPureReactComponent?!Sa(f,N)||!Sa(E,V):!0}function Hg(l,u,f){var N=!1,E=oo,V=u.contextType;return typeof V=="object"&&V!==null?V=xs(V):(E=Aa(u)?Jo:Xs.current,N=u.contextTypes,V=(N=N!=null)?Il(l,E):oo),u=new u(f,V),l.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,u.updater=um,l.stateNode=u,u._reactInternals=l,N&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=E,l.__reactInternalMemoizedMaskedChildContext=V),u}function Zg(l,u,f,N){l=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(f,N),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(f,N),u.state!==l&&um.enqueueReplaceState(u,u.state,null)}function wx(l,u,f,N){var E=l.stateNode;E.props=f,E.state=l.memoizedState,E.refs={},Qs(l);var V=u.contextType;typeof V=="object"&&V!==null?E.context=xs(V):(V=Aa(u)?Jo:Xs.current,E.context=Il(l,V)),E.state=l.memoizedState,V=u.getDerivedStateFromProps,typeof V=="function"&&(Nx(l,u,V,f),E.state=l.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(u=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),u!==E.state&&um.enqueueReplaceState(E,E.state,null),ca(l,f,E,N),E.state=l.memoizedState),typeof E.componentDidMount=="function"&&(l.flags|=4194308)}function Rd(l,u){try{var f="",N=u;do f+=I(N),N=N.return;while(N);var E=f}catch(V){E=`
Error generating stack: `+V.message+`
`+V.stack}return{value:l,source:u,stack:E,digest:null}}function Sx(l,u,f){return{value:l,source:null,stack:f??null,digest:u??null}}function zx(l,u){try{console.error(u.value)}catch(f){setTimeout(function(){throw f})}}var Pk=typeof WeakMap=="function"?WeakMap:Map;function Wg(l,u,f){f=js(-1,f),f.tag=3,f.payload={element:null};var N=u.value;return f.callback=function(){gm||(gm=!0,$x=N),zx(l,u)},f}function Kg(l,u,f){f=js(-1,f),f.tag=3;var N=l.type.getDerivedStateFromError;if(typeof N=="function"){var E=u.value;f.payload=function(){return N(E)},f.callback=function(){zx(l,u)}}var V=l.stateNode;return V!==null&&typeof V.componentDidCatch=="function"&&(f.callback=function(){zx(l,u),typeof N!="function"&&(Ul===null?Ul=new Set([this]):Ul.add(this));var ie=u.stack;this.componentDidCatch(u.value,{componentStack:ie!==null?ie:""})}),f}function Gg(l,u,f){var N=l.pingCache;if(N===null){N=l.pingCache=new Pk;var E=new Set;N.set(u,E)}else E=N.get(u),E===void 0&&(E=new Set,N.set(u,E));E.has(f)||(E.add(f),l=Bk.bind(null,l,u,f),u.then(l,l))}function Yg(l){do{var u;if((u=l.tag===13)&&(u=l.memoizedState,u=u!==null?u.dehydrated!==null:!0),u)return l;l=l.return}while(l!==null);return null}function Jg(l,u,f,N,E){return(l.mode&1)===0?(l===u?l.flags|=65536:(l.flags|=128,f.flags|=131072,f.flags&=-52805,f.tag===1&&(f.alternate===null?f.tag=17:(u=js(-1,1),u.tag=2,_s(f,u,1))),f.lanes|=1),l):(l.flags|=65536,l.lanes=E,l)}var Ak=L.ReactCurrentOwner,xn=!1;function Ya(l,u,f,N){u.child=l===null?ns(u,null,f,N):Os(u,l.child,f,N)}function Xg(l,u,f,N,E){f=f.render;var V=u.ref;return hs(u,E),N=Pc(l,u,f,N,V,E),f=oi(),l!==null&&!xn?(u.updateQueue=l.updateQueue,u.flags&=-2053,l.lanes&=~E,el(l,u,E)):(He&&f&&$e(u),u.flags|=1,Ya(l,u,N,E),u.child)}function Qg(l,u,f,N,E){if(l===null){var V=f.type;return typeof V=="function"&&!Gx(V)&&V.defaultProps===void 0&&f.compare===null&&f.defaultProps===void 0?(u.tag=15,u.type=V,ev(l,u,V,N,E)):(l=Nm(f.type,null,N,u,u.mode,E),l.ref=u.ref,l.return=u,u.child=l)}if(V=l.child,(l.lanes&E)===0){var ie=V.memoizedProps;if(f=f.compare,f=f!==null?f:Sa,f(ie,N)&&l.ref===u.ref)return el(l,u,E)}return u.flags|=1,l=Vl(V,N),l.ref=u.ref,l.return=u,u.child=l}function ev(l,u,f,N,E){if(l!==null){var V=l.memoizedProps;if(Sa(V,N)&&l.ref===u.ref)if(xn=!1,u.pendingProps=N=V,(l.lanes&E)!==0)(l.flags&131072)!==0&&(xn=!0);else return u.lanes=l.lanes,el(l,u,E)}return Cx(l,u,f,N,E)}function tv(l,u,f){var N=u.pendingProps,E=N.children,V=l!==null?l.memoizedState:null;if(N.mode==="hidden")if((u.mode&1)===0)u.memoizedState={baseLanes:0,cachePool:null,transitions:null},Mr(Fd,qn),qn|=f;else{if((f&1073741824)===0)return l=V!==null?V.baseLanes|f:f,u.lanes=u.childLanes=1073741824,u.memoizedState={baseLanes:l,cachePool:null,transitions:null},u.updateQueue=null,Mr(Fd,qn),qn|=l,null;u.memoizedState={baseLanes:0,cachePool:null,transitions:null},N=V!==null?V.baseLanes:f,Mr(Fd,qn),qn|=N}else V!==null?(N=V.baseLanes|f,u.memoizedState=null):N=f,Mr(Fd,qn),qn|=N;return Ya(l,u,E,f),u.child}function rv(l,u){var f=u.ref;(l===null&&f!==null||l!==null&&l.ref!==f)&&(u.flags|=512,u.flags|=2097152)}function Cx(l,u,f,N,E){var V=Aa(f)?Jo:Xs.current;return V=Il(u,V),hs(u,E),f=Pc(l,u,f,N,V,E),N=oi(),l!==null&&!xn?(u.updateQueue=l.updateQueue,u.flags&=-2053,l.lanes&=~E,el(l,u,E)):(He&&N&&$e(u),u.flags|=1,Ya(l,u,f,E),u.child)}function sv(l,u,f,N,E){if(Aa(f)){var V=!0;Xo(u)}else V=!1;if(hs(u,E),u.stateNode===null)mm(l,u),Hg(u,f,N),wx(u,f,N,E),N=!0;else if(l===null){var ie=u.stateNode,ye=u.memoizedProps;ie.props=ye;var ze=ie.context,Fe=f.contextType;typeof Fe=="object"&&Fe!==null?Fe=xs(Fe):(Fe=Aa(f)?Jo:Xs.current,Fe=Il(u,Fe));var Ye=f.getDerivedStateFromProps,Xe=typeof Ye=="function"||typeof ie.getSnapshotBeforeUpdate=="function";Xe||typeof ie.UNSAFE_componentWillReceiveProps!="function"&&typeof ie.componentWillReceiveProps!="function"||(ye!==N||ze!==Fe)&&Zg(u,ie,N,Fe),Ds=!1;var Ge=u.memoizedState;ie.state=Ge,ca(u,N,ie,E),ze=u.memoizedState,ye!==N||Ge!==ze||Pa.current||Ds?(typeof Ye=="function"&&(Nx(u,f,Ye,N),ze=u.memoizedState),(ye=Ds||Vg(u,f,ye,N,Ge,ze,Fe))?(Xe||typeof ie.UNSAFE_componentWillMount!="function"&&typeof ie.componentWillMount!="function"||(typeof ie.componentWillMount=="function"&&ie.componentWillMount(),typeof ie.UNSAFE_componentWillMount=="function"&&ie.UNSAFE_componentWillMount()),typeof ie.componentDidMount=="function"&&(u.flags|=4194308)):(typeof ie.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=N,u.memoizedState=ze),ie.props=N,ie.state=ze,ie.context=Fe,N=ye):(typeof ie.componentDidMount=="function"&&(u.flags|=4194308),N=!1)}else{ie=u.stateNode,Oa(l,u),ye=u.memoizedProps,Fe=u.type===u.elementType?ye:Ii(u.type,ye),ie.props=Fe,Xe=u.pendingProps,Ge=ie.context,ze=f.contextType,typeof ze=="object"&&ze!==null?ze=xs(ze):(ze=Aa(f)?Jo:Xs.current,ze=Il(u,ze));var mt=f.getDerivedStateFromProps;(Ye=typeof mt=="function"||typeof ie.getSnapshotBeforeUpdate=="function")||typeof ie.UNSAFE_componentWillReceiveProps!="function"&&typeof ie.componentWillReceiveProps!="function"||(ye!==Xe||Ge!==ze)&&Zg(u,ie,N,ze),Ds=!1,Ge=u.memoizedState,ie.state=Ge,ca(u,N,ie,E);var jt=u.memoizedState;ye!==Xe||Ge!==jt||Pa.current||Ds?(typeof mt=="function"&&(Nx(u,f,mt,N),jt=u.memoizedState),(Fe=Ds||Vg(u,f,Fe,N,Ge,jt,ze)||!1)?(Ye||typeof ie.UNSAFE_componentWillUpdate!="function"&&typeof ie.componentWillUpdate!="function"||(typeof ie.componentWillUpdate=="function"&&ie.componentWillUpdate(N,jt,ze),typeof ie.UNSAFE_componentWillUpdate=="function"&&ie.UNSAFE_componentWillUpdate(N,jt,ze)),typeof ie.componentDidUpdate=="function"&&(u.flags|=4),typeof ie.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof ie.componentDidUpdate!="function"||ye===l.memoizedProps&&Ge===l.memoizedState||(u.flags|=4),typeof ie.getSnapshotBeforeUpdate!="function"||ye===l.memoizedProps&&Ge===l.memoizedState||(u.flags|=1024),u.memoizedProps=N,u.memoizedState=jt),ie.props=N,ie.state=jt,ie.context=ze,N=Fe):(typeof ie.componentDidUpdate!="function"||ye===l.memoizedProps&&Ge===l.memoizedState||(u.flags|=4),typeof ie.getSnapshotBeforeUpdate!="function"||ye===l.memoizedProps&&Ge===l.memoizedState||(u.flags|=1024),N=!1)}return Px(l,u,f,N,V,E)}function Px(l,u,f,N,E,V){rv(l,u);var ie=(u.flags&128)!==0;if(!N&&!ie)return E&&am(u,f,!1),el(l,u,V);N=u.stateNode,Ak.current=u;var ye=ie&&typeof f.getDerivedStateFromError!="function"?null:N.render();return u.flags|=1,l!==null&&ie?(u.child=Os(u,l.child,null,V),u.child=Os(u,null,ye,V)):Ya(l,u,ye,V),u.memoizedState=N.state,E&&am(u,f,!0),u.child}function av(l){var u=l.stateNode;u.pendingContext?sm(l,u.pendingContext,u.pendingContext!==u.context):u.context&&sm(l,u.context,!1),Ll(l,u.containerInfo)}function nv(l,u,f,N,E){return xt(),at(E),u.flags|=256,Ya(l,u,f,N),u.child}var Ax={dehydrated:null,treeContext:null,retryLane:0};function Ox(l){return{baseLanes:l,cachePool:null,transitions:null}}function iv(l,u,f){var N=u.pendingProps,E=Jr.current,V=!1,ie=(u.flags&128)!==0,ye;if((ye=ie)||(ye=l!==null&&l.memoizedState===null?!1:(E&2)!==0),ye?(V=!0,u.flags&=-129):(l===null||l.memoizedState!==null)&&(E|=1),Mr(Jr,E&1),l===null)return yt(u),l=u.memoizedState,l!==null&&(l=l.dehydrated,l!==null)?((u.mode&1)===0?u.lanes=1:l.data==="$!"?u.lanes=8:u.lanes=1073741824,null):(ie=N.children,l=N.fallback,V?(N=u.mode,V=u.child,ie={mode:"hidden",children:ie},(N&1)===0&&V!==null?(V.childLanes=0,V.pendingProps=ie):V=wm(ie,N,0,null),l=Tc(l,N,f,null),V.return=u,l.return=u,V.sibling=l,u.child=V,u.child.memoizedState=Ox(f),u.memoizedState=Ax,l):Dx(u,ie));if(E=l.memoizedState,E!==null&&(ye=E.dehydrated,ye!==null))return Ok(l,u,ie,N,ye,E,f);if(V){V=N.fallback,ie=u.mode,E=l.child,ye=E.sibling;var ze={mode:"hidden",children:N.children};return(ie&1)===0&&u.child!==E?(N=u.child,N.childLanes=0,N.pendingProps=ze,u.deletions=null):(N=Vl(E,ze),N.subtreeFlags=E.subtreeFlags&14680064),ye!==null?V=Vl(ye,V):(V=Tc(V,ie,f,null),V.flags|=2),V.return=u,N.return=u,N.sibling=V,u.child=N,N=V,V=u.child,ie=l.child.memoizedState,ie=ie===null?Ox(f):{baseLanes:ie.baseLanes|f,cachePool:null,transitions:ie.transitions},V.memoizedState=ie,V.childLanes=l.childLanes&~f,u.memoizedState=Ax,N}return V=l.child,l=V.sibling,N=Vl(V,{mode:"visible",children:N.children}),(u.mode&1)===0&&(N.lanes=f),N.return=u,N.sibling=null,l!==null&&(f=u.deletions,f===null?(u.deletions=[l],u.flags|=16):f.push(l)),u.child=N,u.memoizedState=null,N}function Dx(l,u){return u=wm({mode:"visible",children:u},l.mode,0,null),u.return=l,l.child=u}function pm(l,u,f,N){return N!==null&&at(N),Os(u,l.child,null,f),l=Dx(u,u.pendingProps.children),l.flags|=2,u.memoizedState=null,l}function Ok(l,u,f,N,E,V,ie){if(f)return u.flags&256?(u.flags&=-257,N=Sx(Error(r(422))),pm(l,u,ie,N)):u.memoizedState!==null?(u.child=l.child,u.flags|=128,null):(V=N.fallback,E=u.mode,N=wm({mode:"visible",children:N.children},E,0,null),V=Tc(V,E,ie,null),V.flags|=2,N.return=u,V.return=u,N.sibling=V,u.child=N,(u.mode&1)!==0&&Os(u,l.child,null,ie),u.child.memoizedState=Ox(ie),u.memoizedState=Ax,V);if((u.mode&1)===0)return pm(l,u,ie,null);if(E.data==="$!"){if(N=E.nextSibling&&E.nextSibling.dataset,N)var ye=N.dgst;return N=ye,V=Error(r(419)),N=Sx(V,N,void 0),pm(l,u,ie,N)}if(ye=(ie&l.childLanes)!==0,xn||ye){if(N=da,N!==null){switch(ie&-ie){case 4:E=2;break;case 16:E=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:E=32;break;case 536870912:E=268435456;break;default:E=0}E=(E&(N.suspendedLanes|ie))!==0?0:E,E!==0&&E!==V.retryLane&&(V.retryLane=E,$r(l,E),Ri(N,l,E,-1))}return Kx(),N=Sx(Error(r(421))),pm(l,u,ie,N)}return E.data==="$?"?(u.flags|=128,u.child=l.child,u=Vk.bind(null,l),E._reactRetry=u,null):(l=V.treeContext,qe=fa(E.nextSibling),Ue=u,He=!0,Ze=null,l!==null&&(me[fe++]=Ie,me[fe++]=be,me[fe++]=Se,Ie=l.id,be=l.overflow,Se=u),u=Dx(u,N.children),u.flags|=4096,u)}function ov(l,u,f){l.lanes|=u;var N=l.alternate;N!==null&&(N.lanes|=u),Cr(l.return,u,f)}function Ex(l,u,f,N,E){var V=l.memoizedState;V===null?l.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:N,tail:f,tailMode:E}:(V.isBackwards=u,V.rendering=null,V.renderingStartTime=0,V.last=N,V.tail=f,V.tailMode=E)}function lv(l,u,f){var N=u.pendingProps,E=N.revealOrder,V=N.tail;if(Ya(l,u,N.children,f),N=Jr.current,(N&2)!==0)N=N&1|2,u.flags|=128;else{if(l!==null&&(l.flags&128)!==0)e:for(l=u.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&ov(l,f,u);else if(l.tag===19)ov(l,f,u);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===u)break e;for(;l.sibling===null;){if(l.return===null||l.return===u)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}N&=1}if(Mr(Jr,N),(u.mode&1)===0)u.memoizedState=null;else switch(E){case"forwards":for(f=u.child,E=null;f!==null;)l=f.alternate,l!==null&&Mn(l)===null&&(E=f),f=f.sibling;f=E,f===null?(E=u.child,u.child=null):(E=f.sibling,f.sibling=null),Ex(u,!1,E,f,V);break;case"backwards":for(f=null,E=u.child,u.child=null;E!==null;){if(l=E.alternate,l!==null&&Mn(l)===null){u.child=E;break}l=E.sibling,E.sibling=f,f=E,E=l}Ex(u,!0,f,null,V);break;case"together":Ex(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function mm(l,u){(u.mode&1)===0&&l!==null&&(l.alternate=null,u.alternate=null,u.flags|=2)}function el(l,u,f){if(l!==null&&(u.dependencies=l.dependencies),Dc|=u.lanes,(f&u.childLanes)===0)return null;if(l!==null&&u.child!==l.child)throw Error(r(153));if(u.child!==null){for(l=u.child,f=Vl(l,l.pendingProps),u.child=f,f.return=u;l.sibling!==null;)l=l.sibling,f=f.sibling=Vl(l,l.pendingProps),f.return=u;f.sibling=null}return u.child}function Dk(l,u,f){switch(u.tag){case 3:av(u),xt();break;case 5:nm(u);break;case 1:Aa(u.type)&&Xo(u);break;case 4:Ll(u,u.stateNode.containerInfo);break;case 10:var N=u.type._context,E=u.memoizedProps.value;Mr(Rs,N._currentValue),N._currentValue=E;break;case 13:if(N=u.memoizedState,N!==null)return N.dehydrated!==null?(Mr(Jr,Jr.current&1),u.flags|=128,null):(f&u.child.childLanes)!==0?iv(l,u,f):(Mr(Jr,Jr.current&1),l=el(l,u,f),l!==null?l.sibling:null);Mr(Jr,Jr.current&1);break;case 19:if(N=(f&u.childLanes)!==0,(l.flags&128)!==0){if(N)return lv(l,u,f);u.flags|=128}if(E=u.memoizedState,E!==null&&(E.rendering=null,E.tail=null,E.lastEffect=null),Mr(Jr,Jr.current),N)break;return null;case 22:case 23:return u.lanes=0,tv(l,u,f)}return el(l,u,f)}var cv,Ix,dv,uv;cv=function(l,u){for(var f=u.child;f!==null;){if(f.tag===5||f.tag===6)l.appendChild(f.stateNode);else if(f.tag!==4&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===u)break;for(;f.sibling===null;){if(f.return===null||f.return===u)return;f=f.return}f.sibling.return=f.return,f=f.sibling}},Ix=function(){},dv=function(l,u,f,N){var E=l.memoizedProps;if(E!==N){l=u.stateNode,Oi(Zs.current);var V=null;switch(f){case"input":E=ke(l,E),N=ke(l,N),V=[];break;case"select":E=xe({},E,{value:void 0}),N=xe({},N,{value:void 0}),V=[];break;case"textarea":E=kt(l,E),N=kt(l,N),V=[];break;default:typeof E.onClick!="function"&&typeof N.onClick=="function"&&(l.onclick=Ol)}dr(f,N);var ie;f=null;for(Fe in E)if(!N.hasOwnProperty(Fe)&&E.hasOwnProperty(Fe)&&E[Fe]!=null)if(Fe==="style"){var ye=E[Fe];for(ie in ye)ye.hasOwnProperty(ie)&&(f||(f={}),f[ie]="")}else Fe!=="dangerouslySetInnerHTML"&&Fe!=="children"&&Fe!=="suppressContentEditableWarning"&&Fe!=="suppressHydrationWarning"&&Fe!=="autoFocus"&&(n.hasOwnProperty(Fe)?V||(V=[]):(V=V||[]).push(Fe,null));for(Fe in N){var ze=N[Fe];if(ye=E!=null?E[Fe]:void 0,N.hasOwnProperty(Fe)&&ze!==ye&&(ze!=null||ye!=null))if(Fe==="style")if(ye){for(ie in ye)!ye.hasOwnProperty(ie)||ze&&ze.hasOwnProperty(ie)||(f||(f={}),f[ie]="");for(ie in ze)ze.hasOwnProperty(ie)&&ye[ie]!==ze[ie]&&(f||(f={}),f[ie]=ze[ie])}else f||(V||(V=[]),V.push(Fe,f)),f=ze;else Fe==="dangerouslySetInnerHTML"?(ze=ze?ze.__html:void 0,ye=ye?ye.__html:void 0,ze!=null&&ye!==ze&&(V=V||[]).push(Fe,ze)):Fe==="children"?typeof ze!="string"&&typeof ze!="number"||(V=V||[]).push(Fe,""+ze):Fe!=="suppressContentEditableWarning"&&Fe!=="suppressHydrationWarning"&&(n.hasOwnProperty(Fe)?(ze!=null&&Fe==="onScroll"&&Ur("scroll",l),V||ye===ze||(V=[])):(V=V||[]).push(Fe,ze))}f&&(V=V||[]).push("style",f);var Fe=V;(u.updateQueue=Fe)&&(u.flags|=4)}},uv=function(l,u,f,N){f!==N&&(u.flags|=4)};function Wu(l,u){if(!He)switch(l.tailMode){case"hidden":u=l.tail;for(var f=null;u!==null;)u.alternate!==null&&(f=u),u=u.sibling;f===null?l.tail=null:f.sibling=null;break;case"collapsed":f=l.tail;for(var N=null;f!==null;)f.alternate!==null&&(N=f),f=f.sibling;N===null?u||l.tail===null?l.tail=null:l.tail.sibling=null:N.sibling=null}}function Da(l){var u=l.alternate!==null&&l.alternate.child===l.child,f=0,N=0;if(u)for(var E=l.child;E!==null;)f|=E.lanes|E.childLanes,N|=E.subtreeFlags&14680064,N|=E.flags&14680064,E.return=l,E=E.sibling;else for(E=l.child;E!==null;)f|=E.lanes|E.childLanes,N|=E.subtreeFlags,N|=E.flags,E.return=l,E=E.sibling;return l.subtreeFlags|=N,l.childLanes=f,u}function Ek(l,u,f){var N=u.pendingProps;switch(Te(u),u.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Da(u),null;case 1:return Aa(u.type)&&zd(),Da(u),null;case 3:return N=u.stateNode,ni(),Er(Pa),Er(Xs),Vu(),N.pendingContext&&(N.context=N.pendingContext,N.pendingContext=null),(l===null||l.child===null)&&(ms(u)?u.flags|=4:l===null||l.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,Ze!==null&&(Hx(Ze),Ze=null))),Ix(l,u),Da(u),null;case 5:$u(u);var E=Oi(lo.current);if(f=u.type,l!==null&&u.stateNode!=null)dv(l,u,f,N,E),l.ref!==u.ref&&(u.flags|=512,u.flags|=2097152);else{if(!N){if(u.stateNode===null)throw Error(r(166));return Da(u),null}if(l=Oi(Zs.current),ms(u)){N=u.stateNode,f=u.type;var V=u.memoizedProps;switch(N[ai]=u,N[Dl]=V,l=(u.mode&1)!==0,f){case"dialog":Ur("cancel",N),Ur("close",N);break;case"iframe":case"object":case"embed":Ur("load",N);break;case"video":case"audio":for(E=0;E<no.length;E++)Ur(no[E],N);break;case"source":Ur("error",N);break;case"img":case"image":case"link":Ur("error",N),Ur("load",N);break;case"details":Ur("toggle",N);break;case"input":ue(N,V),Ur("invalid",N);break;case"select":N._wrapperState={wasMultiple:!!V.multiple},Ur("invalid",N);break;case"textarea":it(N,V),Ur("invalid",N)}dr(f,V),E=null;for(var ie in V)if(V.hasOwnProperty(ie)){var ye=V[ie];ie==="children"?typeof ye=="string"?N.textContent!==ye&&(V.suppressHydrationWarning!==!0&&Sd(N.textContent,ye,l),E=["children",ye]):typeof ye=="number"&&N.textContent!==""+ye&&(V.suppressHydrationWarning!==!0&&Sd(N.textContent,ye,l),E=["children",""+ye]):n.hasOwnProperty(ie)&&ye!=null&&ie==="onScroll"&&Ur("scroll",N)}switch(f){case"input":T(N),Re(N,V,!0);break;case"textarea":T(N),Tt(N);break;case"select":case"option":break;default:typeof V.onClick=="function"&&(N.onclick=Ol)}N=E,u.updateQueue=N,N!==null&&(u.flags|=4)}else{ie=E.nodeType===9?E:E.ownerDocument,l==="http://www.w3.org/1999/xhtml"&&(l=ot(f)),l==="http://www.w3.org/1999/xhtml"?f==="script"?(l=ie.createElement("div"),l.innerHTML="<script><\/script>",l=l.removeChild(l.firstChild)):typeof N.is=="string"?l=ie.createElement(f,{is:N.is}):(l=ie.createElement(f),f==="select"&&(ie=l,N.multiple?ie.multiple=!0:N.size&&(ie.size=N.size))):l=ie.createElementNS(l,f),l[ai]=u,l[Dl]=N,cv(l,u,!1,!1),u.stateNode=l;e:{switch(ie=Et(f,N),f){case"dialog":Ur("cancel",l),Ur("close",l),E=N;break;case"iframe":case"object":case"embed":Ur("load",l),E=N;break;case"video":case"audio":for(E=0;E<no.length;E++)Ur(no[E],l);E=N;break;case"source":Ur("error",l),E=N;break;case"img":case"image":case"link":Ur("error",l),Ur("load",l),E=N;break;case"details":Ur("toggle",l),E=N;break;case"input":ue(l,N),E=ke(l,N),Ur("invalid",l);break;case"option":E=N;break;case"select":l._wrapperState={wasMultiple:!!N.multiple},E=xe({},N,{value:void 0}),Ur("invalid",l);break;case"textarea":it(l,N),E=kt(l,N),Ur("invalid",l);break;default:E=N}dr(f,E),ye=E;for(V in ye)if(ye.hasOwnProperty(V)){var ze=ye[V];V==="style"?ct(l,ze):V==="dangerouslySetInnerHTML"?(ze=ze?ze.__html:void 0,ze!=null&&wt(l,ze)):V==="children"?typeof ze=="string"?(f!=="textarea"||ze!=="")&&Nt(l,ze):typeof ze=="number"&&Nt(l,""+ze):V!=="suppressContentEditableWarning"&&V!=="suppressHydrationWarning"&&V!=="autoFocus"&&(n.hasOwnProperty(V)?ze!=null&&V==="onScroll"&&Ur("scroll",l):ze!=null&&P(l,V,ze,ie))}switch(f){case"input":T(l),Re(l,N,!1);break;case"textarea":T(l),Tt(l);break;case"option":N.value!=null&&l.setAttribute("value",""+he(N.value));break;case"select":l.multiple=!!N.multiple,V=N.value,V!=null?Be(l,!!N.multiple,V,!1):N.defaultValue!=null&&Be(l,!!N.multiple,N.defaultValue,!0);break;default:typeof E.onClick=="function"&&(l.onclick=Ol)}switch(f){case"button":case"input":case"select":case"textarea":N=!!N.autoFocus;break e;case"img":N=!0;break e;default:N=!1}}N&&(u.flags|=4)}u.ref!==null&&(u.flags|=512,u.flags|=2097152)}return Da(u),null;case 6:if(l&&u.stateNode!=null)uv(l,u,l.memoizedProps,N);else{if(typeof N!="string"&&u.stateNode===null)throw Error(r(166));if(f=Oi(lo.current),Oi(Zs.current),ms(u)){if(N=u.stateNode,f=u.memoizedProps,N[ai]=u,(V=N.nodeValue!==f)&&(l=Ue,l!==null))switch(l.tag){case 3:Sd(N.nodeValue,f,(l.mode&1)!==0);break;case 5:l.memoizedProps.suppressHydrationWarning!==!0&&Sd(N.nodeValue,f,(l.mode&1)!==0)}V&&(u.flags|=4)}else N=(f.nodeType===9?f:f.ownerDocument).createTextNode(N),N[ai]=u,u.stateNode=N}return Da(u),null;case 13:if(Er(Jr),N=u.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(He&&qe!==null&&(u.mode&1)!==0&&(u.flags&128)===0)nr(),xt(),u.flags|=98560,V=!1;else if(V=ms(u),N!==null&&N.dehydrated!==null){if(l===null){if(!V)throw Error(r(318));if(V=u.memoizedState,V=V!==null?V.dehydrated:null,!V)throw Error(r(317));V[ai]=u}else xt(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;Da(u),V=!1}else Ze!==null&&(Hx(Ze),Ze=null),V=!0;if(!V)return u.flags&65536?u:null}return(u.flags&128)!==0?(u.lanes=f,u):(N=N!==null,N!==(l!==null&&l.memoizedState!==null)&&N&&(u.child.flags|=8192,(u.mode&1)!==0&&(l===null||(Jr.current&1)!==0?ea===0&&(ea=3):Kx())),u.updateQueue!==null&&(u.flags|=4),Da(u),null);case 4:return ni(),Ix(l,u),l===null&&Wo(u.stateNode.containerInfo),Da(u),null;case 10:return es(u.type._context),Da(u),null;case 17:return Aa(u.type)&&zd(),Da(u),null;case 19:if(Er(Jr),V=u.memoizedState,V===null)return Da(u),null;if(N=(u.flags&128)!==0,ie=V.rendering,ie===null)if(N)Wu(V,!1);else{if(ea!==0||l!==null&&(l.flags&128)!==0)for(l=u.child;l!==null;){if(ie=Mn(l),ie!==null){for(u.flags|=128,Wu(V,!1),N=ie.updateQueue,N!==null&&(u.updateQueue=N,u.flags|=4),u.subtreeFlags=0,N=f,f=u.child;f!==null;)V=f,l=N,V.flags&=14680066,ie=V.alternate,ie===null?(V.childLanes=0,V.lanes=l,V.child=null,V.subtreeFlags=0,V.memoizedProps=null,V.memoizedState=null,V.updateQueue=null,V.dependencies=null,V.stateNode=null):(V.childLanes=ie.childLanes,V.lanes=ie.lanes,V.child=ie.child,V.subtreeFlags=0,V.deletions=null,V.memoizedProps=ie.memoizedProps,V.memoizedState=ie.memoizedState,V.updateQueue=ie.updateQueue,V.type=ie.type,l=ie.dependencies,V.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),f=f.sibling;return Mr(Jr,Jr.current&1|2),u.child}l=l.sibling}V.tail!==null&&Yr()>Ud&&(u.flags|=128,N=!0,Wu(V,!1),u.lanes=4194304)}else{if(!N)if(l=Mn(ie),l!==null){if(u.flags|=128,N=!0,f=l.updateQueue,f!==null&&(u.updateQueue=f,u.flags|=4),Wu(V,!0),V.tail===null&&V.tailMode==="hidden"&&!ie.alternate&&!He)return Da(u),null}else 2*Yr()-V.renderingStartTime>Ud&&f!==1073741824&&(u.flags|=128,N=!0,Wu(V,!1),u.lanes=4194304);V.isBackwards?(ie.sibling=u.child,u.child=ie):(f=V.last,f!==null?f.sibling=ie:u.child=ie,V.last=ie)}return V.tail!==null?(u=V.tail,V.rendering=u,V.tail=u.sibling,V.renderingStartTime=Yr(),u.sibling=null,f=Jr.current,Mr(Jr,N?f&1|2:f&1),u):(Da(u),null);case 22:case 23:return Wx(),N=u.memoizedState!==null,l!==null&&l.memoizedState!==null!==N&&(u.flags|=8192),N&&(u.mode&1)!==0?(qn&1073741824)!==0&&(Da(u),u.subtreeFlags&6&&(u.flags|=8192)):Da(u),null;case 24:return null;case 25:return null}throw Error(r(156,u.tag))}function Ik(l,u){switch(Te(u),u.tag){case 1:return Aa(u.type)&&zd(),l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 3:return ni(),Er(Pa),Er(Xs),Vu(),l=u.flags,(l&65536)!==0&&(l&128)===0?(u.flags=l&-65537|128,u):null;case 5:return $u(u),null;case 13:if(Er(Jr),l=u.memoizedState,l!==null&&l.dehydrated!==null){if(u.alternate===null)throw Error(r(340));xt()}return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 19:return Er(Jr),null;case 4:return ni(),null;case 10:return es(u.type._context),null;case 22:case 23:return Wx(),null;case 24:return null;default:return null}}var hm=!1,Ea=!1,Lk=typeof WeakSet=="function"?WeakSet:Set,gt=null;function Md(l,u){var f=l.ref;if(f!==null)if(typeof f=="function")try{f(null)}catch(N){Is(l,u,N)}else f.current=null}function Lx(l,u,f){try{f()}catch(N){Is(l,u,N)}}var pv=!1;function Tk(l,u){if(Sc=jl,l=As(),Ln(l)){if("selectionStart"in l)var f={start:l.selectionStart,end:l.selectionEnd};else e:{f=(f=l.ownerDocument)&&f.defaultView||window;var N=f.getSelection&&f.getSelection();if(N&&N.rangeCount!==0){f=N.anchorNode;var E=N.anchorOffset,V=N.focusNode;N=N.focusOffset;try{f.nodeType,V.nodeType}catch{f=null;break e}var ie=0,ye=-1,ze=-1,Fe=0,Ye=0,Xe=l,Ge=null;t:for(;;){for(var mt;Xe!==f||E!==0&&Xe.nodeType!==3||(ye=ie+E),Xe!==V||N!==0&&Xe.nodeType!==3||(ze=ie+N),Xe.nodeType===3&&(ie+=Xe.nodeValue.length),(mt=Xe.firstChild)!==null;)Ge=Xe,Xe=mt;for(;;){if(Xe===l)break t;if(Ge===f&&++Fe===E&&(ye=ie),Ge===V&&++Ye===N&&(ze=ie),(mt=Xe.nextSibling)!==null)break;Xe=Ge,Ge=Xe.parentNode}Xe=mt}f=ye===-1||ze===-1?null:{start:ye,end:ze}}else f=null}f=f||{start:0,end:0}}else f=null;for(Go={focusedElem:l,selectionRange:f},jl=!1,gt=u;gt!==null;)if(u=gt,l=u.child,(u.subtreeFlags&1028)!==0&&l!==null)l.return=u,gt=l;else for(;gt!==null;){u=gt;try{var jt=u.alternate;if((u.flags&1024)!==0)switch(u.tag){case 0:case 11:case 15:break;case 1:if(jt!==null){var St=jt.memoizedProps,Fs=jt.memoizedState,Le=u.stateNode,Pe=Le.getSnapshotBeforeUpdate(u.elementType===u.type?St:Ii(u.type,St),Fs);Le.__reactInternalSnapshotBeforeUpdate=Pe}break;case 3:var Me=u.stateNode.containerInfo;Me.nodeType===1?Me.textContent="":Me.nodeType===9&&Me.documentElement&&Me.removeChild(Me.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(tt){Is(u,u.return,tt)}if(l=u.sibling,l!==null){l.return=u.return,gt=l;break}gt=u.return}return jt=pv,pv=!1,jt}function Ku(l,u,f){var N=u.updateQueue;if(N=N!==null?N.lastEffect:null,N!==null){var E=N=N.next;do{if((E.tag&l)===l){var V=E.destroy;E.destroy=void 0,V!==void 0&&Lx(u,f,V)}E=E.next}while(E!==N)}}function xm(l,u){if(u=u.updateQueue,u=u!==null?u.lastEffect:null,u!==null){var f=u=u.next;do{if((f.tag&l)===l){var N=f.create;f.destroy=N()}f=f.next}while(f!==u)}}function Tx(l){var u=l.ref;if(u!==null){var f=l.stateNode;switch(l.tag){case 5:l=f;break;default:l=f}typeof u=="function"?u(l):u.current=l}}function mv(l){var u=l.alternate;u!==null&&(l.alternate=null,mv(u)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(u=l.stateNode,u!==null&&(delete u[ai],delete u[Dl],delete u[Ca],delete u[yx],delete u[jx])),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function hv(l){return l.tag===5||l.tag===3||l.tag===4}function xv(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||hv(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function Rx(l,u,f){var N=l.tag;if(N===5||N===6)l=l.stateNode,u?f.nodeType===8?f.parentNode.insertBefore(l,u):f.insertBefore(l,u):(f.nodeType===8?(u=f.parentNode,u.insertBefore(l,f)):(u=f,u.appendChild(l)),f=f._reactRootContainer,f!=null||u.onclick!==null||(u.onclick=Ol));else if(N!==4&&(l=l.child,l!==null))for(Rx(l,u,f),l=l.sibling;l!==null;)Rx(l,u,f),l=l.sibling}function Mx(l,u,f){var N=l.tag;if(N===5||N===6)l=l.stateNode,u?f.insertBefore(l,u):f.appendChild(l);else if(N!==4&&(l=l.child,l!==null))for(Mx(l,u,f),l=l.sibling;l!==null;)Mx(l,u,f),l=l.sibling}var ba=null,Li=!1;function Fl(l,u,f){for(f=f.child;f!==null;)fv(l,u,f),f=f.sibling}function fv(l,u,f){if(Ba&&typeof Ba.onCommitFiberUnmount=="function")try{Ba.onCommitFiberUnmount(wo,f)}catch{}switch(f.tag){case 5:Ea||Md(f,u);case 6:var N=ba,E=Li;ba=null,Fl(l,u,f),ba=N,Li=E,ba!==null&&(Li?(l=ba,f=f.stateNode,l.nodeType===8?l.parentNode.removeChild(f):l.removeChild(f)):ba.removeChild(f.stateNode));break;case 18:ba!==null&&(Li?(l=ba,f=f.stateNode,l.nodeType===8?Fu(l.parentNode,f):l.nodeType===1&&Fu(l,f),Jn(l)):Fu(ba,f.stateNode));break;case 4:N=ba,E=Li,ba=f.stateNode.containerInfo,Li=!0,Fl(l,u,f),ba=N,Li=E;break;case 0:case 11:case 14:case 15:if(!Ea&&(N=f.updateQueue,N!==null&&(N=N.lastEffect,N!==null))){E=N=N.next;do{var V=E,ie=V.destroy;V=V.tag,ie!==void 0&&((V&2)!==0||(V&4)!==0)&&Lx(f,u,ie),E=E.next}while(E!==N)}Fl(l,u,f);break;case 1:if(!Ea&&(Md(f,u),N=f.stateNode,typeof N.componentWillUnmount=="function"))try{N.props=f.memoizedProps,N.state=f.memoizedState,N.componentWillUnmount()}catch(ye){Is(f,u,ye)}Fl(l,u,f);break;case 21:Fl(l,u,f);break;case 22:f.mode&1?(Ea=(N=Ea)||f.memoizedState!==null,Fl(l,u,f),Ea=N):Fl(l,u,f);break;default:Fl(l,u,f)}}function bv(l){var u=l.updateQueue;if(u!==null){l.updateQueue=null;var f=l.stateNode;f===null&&(f=l.stateNode=new Lk),u.forEach(function(N){var E=Hk.bind(null,l,N);f.has(N)||(f.add(N),N.then(E,E))})}}function Ti(l,u){var f=u.deletions;if(f!==null)for(var N=0;N<f.length;N++){var E=f[N];try{var V=l,ie=u,ye=ie;e:for(;ye!==null;){switch(ye.tag){case 5:ba=ye.stateNode,Li=!1;break e;case 3:ba=ye.stateNode.containerInfo,Li=!0;break e;case 4:ba=ye.stateNode.containerInfo,Li=!0;break e}ye=ye.return}if(ba===null)throw Error(r(160));fv(V,ie,E),ba=null,Li=!1;var ze=E.alternate;ze!==null&&(ze.return=null),E.return=null}catch(Fe){Is(E,u,Fe)}}if(u.subtreeFlags&12854)for(u=u.child;u!==null;)gv(u,l),u=u.sibling}function gv(l,u){var f=l.alternate,N=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:if(Ti(u,l),uo(l),N&4){try{Ku(3,l,l.return),xm(3,l)}catch(St){Is(l,l.return,St)}try{Ku(5,l,l.return)}catch(St){Is(l,l.return,St)}}break;case 1:Ti(u,l),uo(l),N&512&&f!==null&&Md(f,f.return);break;case 5:if(Ti(u,l),uo(l),N&512&&f!==null&&Md(f,f.return),l.flags&32){var E=l.stateNode;try{Nt(E,"")}catch(St){Is(l,l.return,St)}}if(N&4&&(E=l.stateNode,E!=null)){var V=l.memoizedProps,ie=f!==null?f.memoizedProps:V,ye=l.type,ze=l.updateQueue;if(l.updateQueue=null,ze!==null)try{ye==="input"&&V.type==="radio"&&V.name!=null&&je(E,V),Et(ye,ie);var Fe=Et(ye,V);for(ie=0;ie<ze.length;ie+=2){var Ye=ze[ie],Xe=ze[ie+1];Ye==="style"?ct(E,Xe):Ye==="dangerouslySetInnerHTML"?wt(E,Xe):Ye==="children"?Nt(E,Xe):P(E,Ye,Xe,Fe)}switch(ye){case"input":ne(E,V);break;case"textarea":Ft(E,V);break;case"select":var Ge=E._wrapperState.wasMultiple;E._wrapperState.wasMultiple=!!V.multiple;var mt=V.value;mt!=null?Be(E,!!V.multiple,mt,!1):Ge!==!!V.multiple&&(V.defaultValue!=null?Be(E,!!V.multiple,V.defaultValue,!0):Be(E,!!V.multiple,V.multiple?[]:"",!1))}E[Dl]=V}catch(St){Is(l,l.return,St)}}break;case 6:if(Ti(u,l),uo(l),N&4){if(l.stateNode===null)throw Error(r(162));E=l.stateNode,V=l.memoizedProps;try{E.nodeValue=V}catch(St){Is(l,l.return,St)}}break;case 3:if(Ti(u,l),uo(l),N&4&&f!==null&&f.memoizedState.isDehydrated)try{Jn(u.containerInfo)}catch(St){Is(l,l.return,St)}break;case 4:Ti(u,l),uo(l);break;case 13:Ti(u,l),uo(l),E=l.child,E.flags&8192&&(V=E.memoizedState!==null,E.stateNode.isHidden=V,!V||E.alternate!==null&&E.alternate.memoizedState!==null||(qx=Yr())),N&4&&bv(l);break;case 22:if(Ye=f!==null&&f.memoizedState!==null,l.mode&1?(Ea=(Fe=Ea)||Ye,Ti(u,l),Ea=Fe):Ti(u,l),uo(l),N&8192){if(Fe=l.memoizedState!==null,(l.stateNode.isHidden=Fe)&&!Ye&&(l.mode&1)!==0)for(gt=l,Ye=l.child;Ye!==null;){for(Xe=gt=Ye;gt!==null;){switch(Ge=gt,mt=Ge.child,Ge.tag){case 0:case 11:case 14:case 15:Ku(4,Ge,Ge.return);break;case 1:Md(Ge,Ge.return);var jt=Ge.stateNode;if(typeof jt.componentWillUnmount=="function"){N=Ge,f=Ge.return;try{u=N,jt.props=u.memoizedProps,jt.state=u.memoizedState,jt.componentWillUnmount()}catch(St){Is(N,f,St)}}break;case 5:Md(Ge,Ge.return);break;case 22:if(Ge.memoizedState!==null){jv(Xe);continue}}mt!==null?(mt.return=Ge,gt=mt):jv(Xe)}Ye=Ye.sibling}e:for(Ye=null,Xe=l;;){if(Xe.tag===5){if(Ye===null){Ye=Xe;try{E=Xe.stateNode,Fe?(V=E.style,typeof V.setProperty=="function"?V.setProperty("display","none","important"):V.display="none"):(ye=Xe.stateNode,ze=Xe.memoizedProps.style,ie=ze!=null&&ze.hasOwnProperty("display")?ze.display:null,ye.style.display=Zt("display",ie))}catch(St){Is(l,l.return,St)}}}else if(Xe.tag===6){if(Ye===null)try{Xe.stateNode.nodeValue=Fe?"":Xe.memoizedProps}catch(St){Is(l,l.return,St)}}else if((Xe.tag!==22&&Xe.tag!==23||Xe.memoizedState===null||Xe===l)&&Xe.child!==null){Xe.child.return=Xe,Xe=Xe.child;continue}if(Xe===l)break e;for(;Xe.sibling===null;){if(Xe.return===null||Xe.return===l)break e;Ye===Xe&&(Ye=null),Xe=Xe.return}Ye===Xe&&(Ye=null),Xe.sibling.return=Xe.return,Xe=Xe.sibling}}break;case 19:Ti(u,l),uo(l),N&4&&bv(l);break;case 21:break;default:Ti(u,l),uo(l)}}function uo(l){var u=l.flags;if(u&2){try{e:{for(var f=l.return;f!==null;){if(hv(f)){var N=f;break e}f=f.return}throw Error(r(160))}switch(N.tag){case 5:var E=N.stateNode;N.flags&32&&(Nt(E,""),N.flags&=-33);var V=xv(l);Mx(l,V,E);break;case 3:case 4:var ie=N.stateNode.containerInfo,ye=xv(l);Rx(l,ye,ie);break;default:throw Error(r(161))}}catch(ze){Is(l,l.return,ze)}l.flags&=-3}u&4096&&(l.flags&=-4097)}function Rk(l,u,f){gt=l,vv(l)}function vv(l,u,f){for(var N=(l.mode&1)!==0;gt!==null;){var E=gt,V=E.child;if(E.tag===22&&N){var ie=E.memoizedState!==null||hm;if(!ie){var ye=E.alternate,ze=ye!==null&&ye.memoizedState!==null||Ea;ye=hm;var Fe=Ea;if(hm=ie,(Ea=ze)&&!Fe)for(gt=E;gt!==null;)ie=gt,ze=ie.child,ie.tag===22&&ie.memoizedState!==null?_v(E):ze!==null?(ze.return=ie,gt=ze):_v(E);for(;V!==null;)gt=V,vv(V),V=V.sibling;gt=E,hm=ye,Ea=Fe}yv(l)}else(E.subtreeFlags&8772)!==0&&V!==null?(V.return=E,gt=V):yv(l)}}function yv(l){for(;gt!==null;){var u=gt;if((u.flags&8772)!==0){var f=u.alternate;try{if((u.flags&8772)!==0)switch(u.tag){case 0:case 11:case 15:Ea||xm(5,u);break;case 1:var N=u.stateNode;if(u.flags&4&&!Ea)if(f===null)N.componentDidMount();else{var E=u.elementType===u.type?f.memoizedProps:Ii(u.type,f.memoizedProps);N.componentDidUpdate(E,f.memoizedState,N.__reactInternalSnapshotBeforeUpdate)}var V=u.updateQueue;V!==null&&hn(u,V,N);break;case 3:var ie=u.updateQueue;if(ie!==null){if(f=null,u.child!==null)switch(u.child.tag){case 5:f=u.child.stateNode;break;case 1:f=u.child.stateNode}hn(u,ie,f)}break;case 5:var ye=u.stateNode;if(f===null&&u.flags&4){f=ye;var ze=u.memoizedProps;switch(u.type){case"button":case"input":case"select":case"textarea":ze.autoFocus&&f.focus();break;case"img":ze.src&&(f.src=ze.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(u.memoizedState===null){var Fe=u.alternate;if(Fe!==null){var Ye=Fe.memoizedState;if(Ye!==null){var Xe=Ye.dehydrated;Xe!==null&&Jn(Xe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Ea||u.flags&512&&Tx(u)}catch(Ge){Is(u,u.return,Ge)}}if(u===l){gt=null;break}if(f=u.sibling,f!==null){f.return=u.return,gt=f;break}gt=u.return}}function jv(l){for(;gt!==null;){var u=gt;if(u===l){gt=null;break}var f=u.sibling;if(f!==null){f.return=u.return,gt=f;break}gt=u.return}}function _v(l){for(;gt!==null;){var u=gt;try{switch(u.tag){case 0:case 11:case 15:var f=u.return;try{xm(4,u)}catch(ze){Is(u,f,ze)}break;case 1:var N=u.stateNode;if(typeof N.componentDidMount=="function"){var E=u.return;try{N.componentDidMount()}catch(ze){Is(u,E,ze)}}var V=u.return;try{Tx(u)}catch(ze){Is(u,V,ze)}break;case 5:var ie=u.return;try{Tx(u)}catch(ze){Is(u,ie,ze)}}}catch(ze){Is(u,u.return,ze)}if(u===l){gt=null;break}var ye=u.sibling;if(ye!==null){ye.return=u.return,gt=ye;break}gt=u.return}}var Mk=Math.ceil,fm=L.ReactCurrentDispatcher,Fx=L.ReactCurrentOwner,li=L.ReactCurrentBatchConfig,Pr=0,da=null,Ws=null,ga=0,qn=0,Fd=Tn(0),ea=0,Gu=null,Dc=0,bm=0,Ux=0,Yu=null,fn=null,qx=0,Ud=1/0,tl=null,gm=!1,$x=null,Ul=null,vm=!1,ql=null,ym=0,Ju=0,Bx=null,jm=-1,_m=0;function Ja(){return(Pr&6)!==0?Yr():jm!==-1?jm:jm=Yr()}function $l(l){return(l.mode&1)===0?1:(Pr&2)!==0&&ga!==0?ga&-ga:ys.transition!==null?(_m===0&&(_m=hd()),_m):(l=yr,l!==0||(l=window.event,l=l===void 0?16:Eo(l.type)),l)}function Ri(l,u,f,N){if(50<Ju)throw Ju=0,Bx=null,Error(r(185));Po(l,f,N),((Pr&2)===0||l!==da)&&(l===da&&((Pr&2)===0&&(bm|=f),ea===4&&Bl(l,ga)),bn(l,N),f===1&&Pr===0&&(u.mode&1)===0&&(Ud=Yr()+500,Cc&&G()))}function bn(l,u){var f=l.callbackNode;bs(l,u);var N=ka(l,l===da?ga:0);if(N===0)f!==null&&No(f),l.callbackNode=null,l.callbackPriority=0;else if(u=N&-N,l.callbackPriority!==u){if(f!=null&&No(f),u===1)l.tag===0?M(Nv.bind(null,l)):w(Nv.bind(null,l)),gx(function(){(Pr&6)===0&&G()}),f=null;else{switch(vi(N)){case 1:f=xl;break;case 4:f=$a;break;case 16:f=Yi;break;case 536870912:f=fl;break;default:f=Yi}f=Dv(f,kv.bind(null,l))}l.callbackPriority=u,l.callbackNode=f}}function kv(l,u){if(jm=-1,_m=0,(Pr&6)!==0)throw Error(r(327));var f=l.callbackNode;if(qd()&&l.callbackNode!==f)return null;var N=ka(l,l===da?ga:0);if(N===0)return null;if((N&30)!==0||(N&l.expiredLanes)!==0||u)u=km(l,N);else{u=N;var E=Pr;Pr|=2;var V=Sv();(da!==l||ga!==u)&&(tl=null,Ud=Yr()+500,Ic(l,u));do try{qk();break}catch(ye){wv(l,ye)}while(!0);zr(),fm.current=V,Pr=E,Ws!==null?u=0:(da=null,ga=0,u=ea)}if(u!==0){if(u===2&&(E=Co(l),E!==0&&(N=E,u=Vx(l,E))),u===1)throw f=Gu,Ic(l,0),Bl(l,N),bn(l,Yr()),f;if(u===6)Bl(l,N);else{if(E=l.current.alternate,(N&30)===0&&!Fk(E)&&(u=km(l,N),u===2&&(V=Co(l),V!==0&&(N=V,u=Vx(l,V))),u===1))throw f=Gu,Ic(l,0),Bl(l,N),bn(l,Yr()),f;switch(l.finishedWork=E,l.finishedLanes=N,u){case 0:case 1:throw Error(r(345));case 2:Lc(l,fn,tl);break;case 3:if(Bl(l,N),(N&130023424)===N&&(u=qx+500-Yr(),10<u)){if(ka(l,0)!==0)break;if(E=l.suspendedLanes,(E&N)!==N){Ja(),l.pingedLanes|=l.suspendedLanes&E;break}l.timeoutHandle=Mu(Lc.bind(null,l,fn,tl),u);break}Lc(l,fn,tl);break;case 4:if(Bl(l,N),(N&4194240)===N)break;for(u=l.eventTimes,E=-1;0<N;){var ie=31-sa(N);V=1<<ie,ie=u[ie],ie>E&&(E=ie),N&=~V}if(N=E,N=Yr()-N,N=(120>N?120:480>N?480:1080>N?1080:1920>N?1920:3e3>N?3e3:4320>N?4320:1960*Mk(N/1960))-N,10<N){l.timeoutHandle=Mu(Lc.bind(null,l,fn,tl),N);break}Lc(l,fn,tl);break;case 5:Lc(l,fn,tl);break;default:throw Error(r(329))}}}return bn(l,Yr()),l.callbackNode===f?kv.bind(null,l):null}function Vx(l,u){var f=Yu;return l.current.memoizedState.isDehydrated&&(Ic(l,u).flags|=256),l=km(l,u),l!==2&&(u=fn,fn=f,u!==null&&Hx(u)),l}function Hx(l){fn===null?fn=l:fn.push.apply(fn,l)}function Fk(l){for(var u=l;;){if(u.flags&16384){var f=u.updateQueue;if(f!==null&&(f=f.stores,f!==null))for(var N=0;N<f.length;N++){var E=f[N],V=E.getSnapshot;E=E.value;try{if(!us(V(),E))return!1}catch{return!1}}}if(f=u.child,u.subtreeFlags&16384&&f!==null)f.return=u,u=f;else{if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function Bl(l,u){for(u&=~Ux,u&=~bm,l.suspendedLanes|=u,l.pingedLanes&=~u,l=l.expirationTimes;0<u;){var f=31-sa(u),N=1<<f;l[f]=-1,u&=~N}}function Nv(l){if((Pr&6)!==0)throw Error(r(327));qd();var u=ka(l,0);if((u&1)===0)return bn(l,Yr()),null;var f=km(l,u);if(l.tag!==0&&f===2){var N=Co(l);N!==0&&(u=N,f=Vx(l,N))}if(f===1)throw f=Gu,Ic(l,0),Bl(l,u),bn(l,Yr()),f;if(f===6)throw Error(r(345));return l.finishedWork=l.current.alternate,l.finishedLanes=u,Lc(l,fn,tl),bn(l,Yr()),null}function Zx(l,u){var f=Pr;Pr|=1;try{return l(u)}finally{Pr=f,Pr===0&&(Ud=Yr()+500,Cc&&G())}}function Ec(l){ql!==null&&ql.tag===0&&(Pr&6)===0&&qd();var u=Pr;Pr|=1;var f=li.transition,N=yr;try{if(li.transition=null,yr=1,l)return l()}finally{yr=N,li.transition=f,Pr=u,(Pr&6)===0&&G()}}function Wx(){qn=Fd.current,Er(Fd)}function Ic(l,u){l.finishedWork=null,l.finishedLanes=0;var f=l.timeoutHandle;if(f!==-1&&(l.timeoutHandle=-1,tm(f)),Ws!==null)for(f=Ws.return;f!==null;){var N=f;switch(Te(N),N.tag){case 1:N=N.type.childContextTypes,N!=null&&zd();break;case 3:ni(),Er(Pa),Er(Xs),Vu();break;case 5:$u(N);break;case 4:ni();break;case 13:Er(Jr);break;case 19:Er(Jr);break;case 10:es(N.type._context);break;case 22:case 23:Wx()}f=f.return}if(da=l,Ws=l=Vl(l.current,null),ga=qn=u,ea=0,Gu=null,Ux=bm=Dc=0,fn=Yu=null,qr!==null){for(u=0;u<qr.length;u++)if(f=qr[u],N=f.interleaved,N!==null){f.interleaved=null;var E=N.next,V=f.pending;if(V!==null){var ie=V.next;V.next=E,N.next=ie}f.pending=N}qr=null}return l}function wv(l,u){do{var f=Ws;try{if(zr(),Cd.current=dm,Tl){for(var N=ts.memoizedState;N!==null;){var E=N.queue;E!==null&&(E.pending=null),N=N.next}Tl=!1}if(ii=0,Ns=Es=ts=null,Di=!1,Rl=0,Fx.current=null,f===null||f.return===null){ea=1,Gu=u,Ws=null;break}e:{var V=l,ie=f.return,ye=f,ze=u;if(u=ga,ye.flags|=32768,ze!==null&&typeof ze=="object"&&typeof ze.then=="function"){var Fe=ze,Ye=ye,Xe=Ye.tag;if((Ye.mode&1)===0&&(Xe===0||Xe===11||Xe===15)){var Ge=Ye.alternate;Ge?(Ye.updateQueue=Ge.updateQueue,Ye.memoizedState=Ge.memoizedState,Ye.lanes=Ge.lanes):(Ye.updateQueue=null,Ye.memoizedState=null)}var mt=Yg(ie);if(mt!==null){mt.flags&=-257,Jg(mt,ie,ye,V,u),mt.mode&1&&Gg(V,Fe,u),u=mt,ze=Fe;var jt=u.updateQueue;if(jt===null){var St=new Set;St.add(ze),u.updateQueue=St}else jt.add(ze);break e}else{if((u&1)===0){Gg(V,Fe,u),Kx();break e}ze=Error(r(426))}}else if(He&&ye.mode&1){var Fs=Yg(ie);if(Fs!==null){(Fs.flags&65536)===0&&(Fs.flags|=256),Jg(Fs,ie,ye,V,u),at(Rd(ze,ye));break e}}V=ze=Rd(ze,ye),ea!==4&&(ea=2),Yu===null?Yu=[V]:Yu.push(V),V=ie;do{switch(V.tag){case 3:V.flags|=65536,u&=-u,V.lanes|=u;var Le=Wg(V,ze,u);Br(V,Le);break e;case 1:ye=ze;var Pe=V.type,Me=V.stateNode;if((V.flags&128)===0&&(typeof Pe.getDerivedStateFromError=="function"||Me!==null&&typeof Me.componentDidCatch=="function"&&(Ul===null||!Ul.has(Me)))){V.flags|=65536,u&=-u,V.lanes|=u;var tt=Kg(V,ye,u);Br(V,tt);break e}}V=V.return}while(V!==null)}Cv(f)}catch(At){u=At,Ws===f&&f!==null&&(Ws=f=f.return);continue}break}while(!0)}function Sv(){var l=fm.current;return fm.current=dm,l===null?dm:l}function Kx(){(ea===0||ea===3||ea===2)&&(ea=4),da===null||(Dc&268435455)===0&&(bm&268435455)===0||Bl(da,ga)}function km(l,u){var f=Pr;Pr|=2;var N=Sv();(da!==l||ga!==u)&&(tl=null,Ic(l,u));do try{Uk();break}catch(E){wv(l,E)}while(!0);if(zr(),Pr=f,fm.current=N,Ws!==null)throw Error(r(261));return da=null,ga=0,ea}function Uk(){for(;Ws!==null;)zv(Ws)}function qk(){for(;Ws!==null&&!hl();)zv(Ws)}function zv(l){var u=Ov(l.alternate,l,qn);l.memoizedProps=l.pendingProps,u===null?Cv(l):Ws=u,Fx.current=null}function Cv(l){var u=l;do{var f=u.alternate;if(l=u.return,(u.flags&32768)===0){if(f=Ek(f,u,qn),f!==null){Ws=f;return}}else{if(f=Ik(f,u),f!==null){f.flags&=32767,Ws=f;return}if(l!==null)l.flags|=32768,l.subtreeFlags=0,l.deletions=null;else{ea=6,Ws=null;return}}if(u=u.sibling,u!==null){Ws=u;return}Ws=u=l}while(u!==null);ea===0&&(ea=5)}function Lc(l,u,f){var N=yr,E=li.transition;try{li.transition=null,yr=1,$k(l,u,f,N)}finally{li.transition=E,yr=N}return null}function $k(l,u,f,N){do qd();while(ql!==null);if((Pr&6)!==0)throw Error(r(327));f=l.finishedWork;var E=l.finishedLanes;if(f===null)return null;if(l.finishedWork=null,l.finishedLanes=0,f===l.current)throw Error(r(177));l.callbackNode=null,l.callbackPriority=0;var V=f.lanes|f.childLanes;if(Kn(l,V),l===da&&(Ws=da=null,ga=0),(f.subtreeFlags&2064)===0&&(f.flags&2064)===0||vm||(vm=!0,Dv(Yi,function(){return qd(),null})),V=(f.flags&15990)!==0,(f.subtreeFlags&15990)!==0||V){V=li.transition,li.transition=null;var ie=yr;yr=1;var ye=Pr;Pr|=4,Fx.current=null,Tk(l,f),gv(f,l),gc(Go),jl=!!Sc,Go=Sc=null,l.current=f,Rk(f),Su(),Pr=ye,yr=ie,li.transition=V}else l.current=f;if(vm&&(vm=!1,ql=l,ym=E),V=l.pendingLanes,V===0&&(Ul=null),pd(f.stateNode),bn(l,Yr()),u!==null)for(N=l.onRecoverableError,f=0;f<u.length;f++)E=u[f],N(E.value,{componentStack:E.stack,digest:E.digest});if(gm)throw gm=!1,l=$x,$x=null,l;return(ym&1)!==0&&l.tag!==0&&qd(),V=l.pendingLanes,(V&1)!==0?l===Bx?Ju++:(Ju=0,Bx=l):Ju=0,G(),null}function qd(){if(ql!==null){var l=vi(ym),u=li.transition,f=yr;try{if(li.transition=null,yr=16>l?16:l,ql===null)var N=!1;else{if(l=ql,ql=null,ym=0,(Pr&6)!==0)throw Error(r(331));var E=Pr;for(Pr|=4,gt=l.current;gt!==null;){var V=gt,ie=V.child;if((gt.flags&16)!==0){var ye=V.deletions;if(ye!==null){for(var ze=0;ze<ye.length;ze++){var Fe=ye[ze];for(gt=Fe;gt!==null;){var Ye=gt;switch(Ye.tag){case 0:case 11:case 15:Ku(8,Ye,V)}var Xe=Ye.child;if(Xe!==null)Xe.return=Ye,gt=Xe;else for(;gt!==null;){Ye=gt;var Ge=Ye.sibling,mt=Ye.return;if(mv(Ye),Ye===Fe){gt=null;break}if(Ge!==null){Ge.return=mt,gt=Ge;break}gt=mt}}}var jt=V.alternate;if(jt!==null){var St=jt.child;if(St!==null){jt.child=null;do{var Fs=St.sibling;St.sibling=null,St=Fs}while(St!==null)}}gt=V}}if((V.subtreeFlags&2064)!==0&&ie!==null)ie.return=V,gt=ie;else e:for(;gt!==null;){if(V=gt,(V.flags&2048)!==0)switch(V.tag){case 0:case 11:case 15:Ku(9,V,V.return)}var Le=V.sibling;if(Le!==null){Le.return=V.return,gt=Le;break e}gt=V.return}}var Pe=l.current;for(gt=Pe;gt!==null;){ie=gt;var Me=ie.child;if((ie.subtreeFlags&2064)!==0&&Me!==null)Me.return=ie,gt=Me;else e:for(ie=Pe;gt!==null;){if(ye=gt,(ye.flags&2048)!==0)try{switch(ye.tag){case 0:case 11:case 15:xm(9,ye)}}catch(At){Is(ye,ye.return,At)}if(ye===ie){gt=null;break e}var tt=ye.sibling;if(tt!==null){tt.return=ye.return,gt=tt;break e}gt=ye.return}}if(Pr=E,G(),Ba&&typeof Ba.onPostCommitFiberRoot=="function")try{Ba.onPostCommitFiberRoot(wo,l)}catch{}N=!0}return N}finally{yr=f,li.transition=u}}return!1}function Pv(l,u,f){u=Rd(f,u),u=Wg(l,u,1),l=_s(l,u,1),u=Ja(),l!==null&&(Po(l,1,u),bn(l,u))}function Is(l,u,f){if(l.tag===3)Pv(l,l,f);else for(;u!==null;){if(u.tag===3){Pv(u,l,f);break}else if(u.tag===1){var N=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof N.componentDidCatch=="function"&&(Ul===null||!Ul.has(N))){l=Rd(f,l),l=Kg(u,l,1),u=_s(u,l,1),l=Ja(),u!==null&&(Po(u,1,l),bn(u,l));break}}u=u.return}}function Bk(l,u,f){var N=l.pingCache;N!==null&&N.delete(u),u=Ja(),l.pingedLanes|=l.suspendedLanes&f,da===l&&(ga&f)===f&&(ea===4||ea===3&&(ga&130023424)===ga&&500>Yr()-qx?Ic(l,0):Ux|=f),bn(l,u)}function Av(l,u){u===0&&((l.mode&1)===0?u=1:(u=sn,sn<<=1,(sn&130023424)===0&&(sn=4194304)));var f=Ja();l=$r(l,u),l!==null&&(Po(l,u,f),bn(l,f))}function Vk(l){var u=l.memoizedState,f=0;u!==null&&(f=u.retryLane),Av(l,f)}function Hk(l,u){var f=0;switch(l.tag){case 13:var N=l.stateNode,E=l.memoizedState;E!==null&&(f=E.retryLane);break;case 19:N=l.stateNode;break;default:throw Error(r(314))}N!==null&&N.delete(u),Av(l,f)}var Ov;Ov=function(l,u,f){if(l!==null)if(l.memoizedProps!==u.pendingProps||Pa.current)xn=!0;else{if((l.lanes&f)===0&&(u.flags&128)===0)return xn=!1,Dk(l,u,f);xn=(l.flags&131072)!==0}else xn=!1,He&&(u.flags&1048576)!==0&&Ee(u,pe,u.index);switch(u.lanes=0,u.tag){case 2:var N=u.type;mm(l,u),l=u.pendingProps;var E=Il(u,Xs.current);hs(u,f),E=Pc(null,u,N,l,E,f);var V=oi();return u.flags|=1,typeof E=="object"&&E!==null&&typeof E.render=="function"&&E.$$typeof===void 0?(u.tag=1,u.memoizedState=null,u.updateQueue=null,Aa(N)?(V=!0,Xo(u)):V=!1,u.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,Qs(u),E.updater=um,u.stateNode=E,E._reactInternals=u,wx(u,N,l,f),u=Px(null,u,N,!0,V,f)):(u.tag=0,He&&V&&$e(u),Ya(null,u,E,f),u=u.child),u;case 16:N=u.elementType;e:{switch(mm(l,u),l=u.pendingProps,E=N._init,N=E(N._payload),u.type=N,E=u.tag=Wk(N),l=Ii(N,l),E){case 0:u=Cx(null,u,N,l,f);break e;case 1:u=sv(null,u,N,l,f);break e;case 11:u=Xg(null,u,N,l,f);break e;case 14:u=Qg(null,u,N,Ii(N.type,l),f);break e}throw Error(r(306,N,""))}return u;case 0:return N=u.type,E=u.pendingProps,E=u.elementType===N?E:Ii(N,E),Cx(l,u,N,E,f);case 1:return N=u.type,E=u.pendingProps,E=u.elementType===N?E:Ii(N,E),sv(l,u,N,E,f);case 3:e:{if(av(u),l===null)throw Error(r(387));N=u.pendingProps,V=u.memoizedState,E=V.element,Oa(l,u),ca(u,N,null,f);var ie=u.memoizedState;if(N=ie.element,V.isDehydrated)if(V={element:N,isDehydrated:!1,cache:ie.cache,pendingSuspenseBoundaries:ie.pendingSuspenseBoundaries,transitions:ie.transitions},u.updateQueue.baseState=V,u.memoizedState=V,u.flags&256){E=Rd(Error(r(423)),u),u=nv(l,u,N,f,E);break e}else if(N!==E){E=Rd(Error(r(424)),u),u=nv(l,u,N,f,E);break e}else for(qe=fa(u.stateNode.containerInfo.firstChild),Ue=u,He=!0,Ze=null,f=ns(u,null,N,f),u.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(xt(),N===E){u=el(l,u,f);break e}Ya(l,u,N,f)}u=u.child}return u;case 5:return nm(u),l===null&&yt(u),N=u.type,E=u.pendingProps,V=l!==null?l.memoizedProps:null,ie=E.children,Ru(N,E)?ie=null:V!==null&&Ru(N,V)&&(u.flags|=32),rv(l,u),Ya(l,u,ie,f),u.child;case 6:return l===null&&yt(u),null;case 13:return iv(l,u,f);case 4:return Ll(u,u.stateNode.containerInfo),N=u.pendingProps,l===null?u.child=Os(u,null,N,f):Ya(l,u,N,f),u.child;case 11:return N=u.type,E=u.pendingProps,E=u.elementType===N?E:Ii(N,E),Xg(l,u,N,E,f);case 7:return Ya(l,u,u.pendingProps,f),u.child;case 8:return Ya(l,u,u.pendingProps.children,f),u.child;case 12:return Ya(l,u,u.pendingProps.children,f),u.child;case 10:e:{if(N=u.type._context,E=u.pendingProps,V=u.memoizedProps,ie=E.value,Mr(Rs,N._currentValue),N._currentValue=ie,V!==null)if(us(V.value,ie)){if(V.children===E.children&&!Pa.current){u=el(l,u,f);break e}}else for(V=u.child,V!==null&&(V.return=u);V!==null;){var ye=V.dependencies;if(ye!==null){ie=V.child;for(var ze=ye.firstContext;ze!==null;){if(ze.context===N){if(V.tag===1){ze=js(-1,f&-f),ze.tag=2;var Fe=V.updateQueue;if(Fe!==null){Fe=Fe.shared;var Ye=Fe.pending;Ye===null?ze.next=ze:(ze.next=Ye.next,Ye.next=ze),Fe.pending=ze}}V.lanes|=f,ze=V.alternate,ze!==null&&(ze.lanes|=f),Cr(V.return,f,u),ye.lanes|=f;break}ze=ze.next}}else if(V.tag===10)ie=V.type===u.type?null:V.child;else if(V.tag===18){if(ie=V.return,ie===null)throw Error(r(341));ie.lanes|=f,ye=ie.alternate,ye!==null&&(ye.lanes|=f),Cr(ie,f,u),ie=V.sibling}else ie=V.child;if(ie!==null)ie.return=V;else for(ie=V;ie!==null;){if(ie===u){ie=null;break}if(V=ie.sibling,V!==null){V.return=ie.return,ie=V;break}ie=ie.return}V=ie}Ya(l,u,E.children,f),u=u.child}return u;case 9:return E=u.type,N=u.pendingProps.children,hs(u,f),E=xs(E),N=N(E),u.flags|=1,Ya(l,u,N,f),u.child;case 14:return N=u.type,E=Ii(N,u.pendingProps),E=Ii(N.type,E),Qg(l,u,N,E,f);case 15:return ev(l,u,u.type,u.pendingProps,f);case 17:return N=u.type,E=u.pendingProps,E=u.elementType===N?E:Ii(N,E),mm(l,u),u.tag=1,Aa(N)?(l=!0,Xo(u)):l=!1,hs(u,f),Hg(u,N,E),wx(u,N,E,f),Px(null,u,N,!0,l,f);case 19:return lv(l,u,f);case 22:return tv(l,u,f)}throw Error(r(156,u.tag))};function Dv(l,u){return ko(l,u)}function Zk(l,u,f,N){this.tag=l,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=N,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ci(l,u,f,N){return new Zk(l,u,f,N)}function Gx(l){return l=l.prototype,!(!l||!l.isReactComponent)}function Wk(l){if(typeof l=="function")return Gx(l)?1:0;if(l!=null){if(l=l.$$typeof,l===O)return 11;if(l===ce)return 14}return 2}function Vl(l,u){var f=l.alternate;return f===null?(f=ci(l.tag,u,l.key,l.mode),f.elementType=l.elementType,f.type=l.type,f.stateNode=l.stateNode,f.alternate=l,l.alternate=f):(f.pendingProps=u,f.type=l.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=l.flags&14680064,f.childLanes=l.childLanes,f.lanes=l.lanes,f.child=l.child,f.memoizedProps=l.memoizedProps,f.memoizedState=l.memoizedState,f.updateQueue=l.updateQueue,u=l.dependencies,f.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},f.sibling=l.sibling,f.index=l.index,f.ref=l.ref,f}function Nm(l,u,f,N,E,V){var ie=2;if(N=l,typeof l=="function")Gx(l)&&(ie=1);else if(typeof l=="string")ie=5;else e:switch(l){case R:return Tc(f.children,E,V,u);case B:ie=8,E|=8;break;case A:return l=ci(12,f,u,E|2),l.elementType=A,l.lanes=V,l;case Z:return l=ci(13,f,u,E),l.elementType=Z,l.lanes=V,l;case te:return l=ci(19,f,u,E),l.elementType=te,l.lanes=V,l;case X:return wm(f,E,V,u);default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case S:ie=10;break e;case C:ie=9;break e;case O:ie=11;break e;case ce:ie=14;break e;case re:ie=16,N=null;break e}throw Error(r(130,l==null?l:typeof l,""))}return u=ci(ie,f,u,E),u.elementType=l,u.type=N,u.lanes=V,u}function Tc(l,u,f,N){return l=ci(7,l,N,u),l.lanes=f,l}function wm(l,u,f,N){return l=ci(22,l,N,u),l.elementType=X,l.lanes=f,l.stateNode={isHidden:!1},l}function Yx(l,u,f){return l=ci(6,l,null,u),l.lanes=f,l}function Jx(l,u,f){return u=ci(4,l.children!==null?l.children:[],l.key,u),u.lanes=f,u.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},u}function Kk(l,u,f,N,E){this.tag=u,this.containerInfo=l,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=cc(0),this.expirationTimes=cc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=cc(0),this.identifierPrefix=N,this.onRecoverableError=E,this.mutableSourceEagerHydrationData=null}function Xx(l,u,f,N,E,V,ie,ye,ze){return l=new Kk(l,u,f,ye,ze),u===1?(u=1,V===!0&&(u|=8)):u=0,V=ci(3,null,null,u),l.current=V,V.stateNode=l,V.memoizedState={element:N,isDehydrated:f,cache:null,transitions:null,pendingSuspenseBoundaries:null},Qs(V),l}function Gk(l,u,f){var N=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:W,key:N==null?null:""+N,children:l,containerInfo:u,implementation:f}}function Ev(l){if(!l)return oo;l=l._reactInternals;e:{if(Ys(l)!==l||l.tag!==1)throw Error(r(170));var u=l;do{switch(u.tag){case 3:u=u.stateNode.context;break e;case 1:if(Aa(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break e}}u=u.return}while(u!==null);throw Error(r(171))}if(l.tag===1){var f=l.type;if(Aa(f))return qu(l,f,u)}return u}function Iv(l,u,f,N,E,V,ie,ye,ze){return l=Xx(f,N,!0,l,E,V,ie,ye,ze),l.context=Ev(null),f=l.current,N=Ja(),E=$l(f),V=js(N,E),V.callback=u??null,_s(f,V,E),l.current.lanes=E,Po(l,E,N),bn(l,N),l}function Sm(l,u,f,N){var E=u.current,V=Ja(),ie=$l(E);return f=Ev(f),u.context===null?u.context=f:u.pendingContext=f,u=js(V,ie),u.payload={element:l},N=N===void 0?null:N,N!==null&&(u.callback=N),l=_s(E,u,ie),l!==null&&(Ri(l,E,ie,V),la(l,E,ie)),ie}function zm(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 5:return l.child.stateNode;default:return l.child.stateNode}}function Lv(l,u){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var f=l.retryLane;l.retryLane=f!==0&&f<u?f:u}}function Qx(l,u){Lv(l,u),(l=l.alternate)&&Lv(l,u)}function Yk(){return null}var Tv=typeof reportError=="function"?reportError:function(l){console.error(l)};function ef(l){this._internalRoot=l}Cm.prototype.render=ef.prototype.render=function(l){var u=this._internalRoot;if(u===null)throw Error(r(409));Sm(l,u,null,null)},Cm.prototype.unmount=ef.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var u=l.containerInfo;Ec(function(){Sm(null,l,null,null)}),u[ia]=null}};function Cm(l){this._internalRoot=l}Cm.prototype.unstable_scheduleHydration=function(l){if(l){var u=fd();l={blockedOn:null,target:l,priority:u};for(var f=0;f<Yn.length&&u!==0&&u<Yn[f].priority;f++);Yn.splice(f,0,l),f===0&&gd(l)}};function tf(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function Pm(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11&&(l.nodeType!==8||l.nodeValue!==" react-mount-point-unstable "))}function Rv(){}function Jk(l,u,f,N,E){if(E){if(typeof N=="function"){var V=N;N=function(){var Fe=zm(ie);V.call(Fe)}}var ie=Iv(u,N,l,0,null,!1,!1,"",Rv);return l._reactRootContainer=ie,l[ia]=ie.current,Wo(l.nodeType===8?l.parentNode:l),Ec(),ie}for(;E=l.lastChild;)l.removeChild(E);if(typeof N=="function"){var ye=N;N=function(){var Fe=zm(ze);ye.call(Fe)}}var ze=Xx(l,0,!1,null,null,!1,!1,"",Rv);return l._reactRootContainer=ze,l[ia]=ze.current,Wo(l.nodeType===8?l.parentNode:l),Ec(function(){Sm(u,ze,f,N)}),ze}function Am(l,u,f,N,E){var V=f._reactRootContainer;if(V){var ie=V;if(typeof E=="function"){var ye=E;E=function(){var ze=zm(ie);ye.call(ze)}}Sm(u,ie,l,E)}else ie=Jk(f,u,l,E,N);return zm(ie)}gl=function(l){switch(l.tag){case 3:var u=l.stateNode;if(u.current.memoizedState.isDehydrated){var f=Pn(u.pendingLanes);f!==0&&(bl(u,f|1),bn(u,Yr()),(Pr&6)===0&&(Ud=Yr()+500,G()))}break;case 13:Ec(function(){var N=$r(l,1);if(N!==null){var E=Ja();Ri(N,l,1,E)}}),Qx(l,1)}},dc=function(l){if(l.tag===13){var u=$r(l,134217728);if(u!==null){var f=Ja();Ri(u,l,134217728,f)}Qx(l,134217728)}},xd=function(l){if(l.tag===13){var u=$l(l),f=$r(l,u);if(f!==null){var N=Ja();Ri(f,l,u,N)}Qx(l,u)}},fd=function(){return yr},vl=function(l,u){var f=yr;try{return yr=l,u()}finally{yr=f}},Lr=function(l,u,f){switch(u){case"input":if(ne(l,f),u=f.name,f.type==="radio"&&u!=null){for(f=l;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll("input[name="+JSON.stringify(""+u)+'][type="radio"]'),u=0;u<f.length;u++){var N=f[u];if(N!==l&&N.form===l.form){var E=zc(N);if(!E)throw Error(r(90));ee(N),ne(N,E)}}}break;case"textarea":Ft(l,f);break;case"select":u=f.value,u!=null&&Be(l,!!f.multiple,u,!1)}},zt=Zx,rr=Ec;var Xk={usingClientEntryPoint:!1,Events:[El,Yo,zc,Qe,st,Zx]},Xu={findFiberByHostInstance:io,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Qk={bundleType:Xu.bundleType,version:Xu.version,rendererPackageName:Xu.rendererPackageName,rendererConfig:Xu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:L.ReactCurrentDispatcher,findHostInstanceByFiber:function(l){return l=Cn(l),l===null?null:l.stateNode},findFiberByHostInstance:Xu.findFiberByHostInstance||Yk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Om=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Om.isDisabled&&Om.supportsFiber)try{wo=Om.inject(Qk),Ba=Om}catch{}}return gn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Xk,gn.createPortal=function(l,u){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!tf(u))throw Error(r(200));return Gk(l,u,null,f)},gn.createRoot=function(l,u){if(!tf(l))throw Error(r(299));var f=!1,N="",E=Tv;return u!=null&&(u.unstable_strictMode===!0&&(f=!0),u.identifierPrefix!==void 0&&(N=u.identifierPrefix),u.onRecoverableError!==void 0&&(E=u.onRecoverableError)),u=Xx(l,1,!1,null,null,f,!1,N,E),l[ia]=u.current,Wo(l.nodeType===8?l.parentNode:l),new ef(u)},gn.findDOMNode=function(l){if(l==null)return null;if(l.nodeType===1)return l;var u=l._reactInternals;if(u===void 0)throw typeof l.render=="function"?Error(r(188)):(l=Object.keys(l).join(","),Error(r(268,l)));return l=Cn(u),l=l===null?null:l.stateNode,l},gn.flushSync=function(l){return Ec(l)},gn.hydrate=function(l,u,f){if(!Pm(u))throw Error(r(200));return Am(null,l,u,!0,f)},gn.hydrateRoot=function(l,u,f){if(!tf(l))throw Error(r(405));var N=f!=null&&f.hydratedSources||null,E=!1,V="",ie=Tv;if(f!=null&&(f.unstable_strictMode===!0&&(E=!0),f.identifierPrefix!==void 0&&(V=f.identifierPrefix),f.onRecoverableError!==void 0&&(ie=f.onRecoverableError)),u=Iv(u,null,l,1,f??null,E,!1,V,ie),l[ia]=u.current,Wo(l),N)for(l=0;l<N.length;l++)f=N[l],E=f._getVersion,E=E(f._source),u.mutableSourceEagerHydrationData==null?u.mutableSourceEagerHydrationData=[f,E]:u.mutableSourceEagerHydrationData.push(f,E);return new Cm(u)},gn.render=function(l,u,f){if(!Pm(u))throw Error(r(200));return Am(null,l,u,!1,f)},gn.unmountComponentAtNode=function(l){if(!Pm(l))throw Error(r(40));return l._reactRootContainer?(Ec(function(){Am(null,null,l,!1,function(){l._reactRootContainer=null,l[ia]=null})}),!0):!1},gn.unstable_batchedUpdates=Zx,gn.unstable_renderSubtreeIntoContainer=function(l,u,f,N){if(!Pm(f))throw Error(r(200));if(l==null||l._reactInternals===void 0)throw Error(r(38));return Am(l,u,f,!1,N)},gn.version="18.3.1-next-f1338f8080-20240426",gn}var Hv;function M_(){if(Hv)return af.exports;Hv=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(t){console.error(t)}}return s(),af.exports=dN(),af.exports}var Zv;function uN(){if(Zv)return Dm;Zv=1;var s=M_();return Dm.createRoot=s.createRoot,Dm.hydrateRoot=s.hydrateRoot,Dm}var pN=uN();const mN=s=>s instanceof Error?s.message+`
`+s.stack:JSON.stringify(s,null,2);class hN extends lt.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}render(){return this.state.hasError?e.jsxs("div",{className:"p-4 border border-red-500 rounded",children:[e.jsx("h2",{className:"text-red-500",children:"Something went wrong."}),e.jsx("pre",{className:"mt-2 text-sm",children:mN(this.state.error)})]}):this.props.children}}const tr=s=>typeof s=="string",ep=()=>{let s,t;const r=new Promise((a,n)=>{s=a,t=n});return r.resolve=s,r.reject=t,r},Wv=s=>s==null?"":""+s,xN=(s,t,r)=>{s.forEach(a=>{t[a]&&(r[a]=t[a])})},fN=/###/g,Kv=s=>s&&s.indexOf("###")>-1?s.replace(fN,"."):s,Gv=s=>!s||tr(s),fp=(s,t,r)=>{const a=tr(t)?t.split("."):t;let n=0;for(;n<a.length-1;){if(Gv(s))return{};const i=Kv(a[n]);!s[i]&&r&&(s[i]=new r),Object.prototype.hasOwnProperty.call(s,i)?s=s[i]:s={},++n}return Gv(s)?{}:{obj:s,k:Kv(a[n])}},Yv=(s,t,r)=>{const{obj:a,k:n}=fp(s,t,Object);if(a!==void 0||t.length===1){a[n]=r;return}let i=t[t.length-1],o=t.slice(0,t.length-1),c=fp(s,o,Object);for(;c.obj===void 0&&o.length;)i=`${o[o.length-1]}.${i}`,o=o.slice(0,o.length-1),c=fp(s,o,Object),c!=null&&c.obj&&typeof c.obj[`${c.k}.${i}`]<"u"&&(c.obj=void 0);c.obj[`${c.k}.${i}`]=r},bN=(s,t,r,a)=>{const{obj:n,k:i}=fp(s,t,Object);n[i]=n[i]||[],n[i].push(r)},Nh=(s,t)=>{const{obj:r,k:a}=fp(s,t);if(r&&Object.prototype.hasOwnProperty.call(r,a))return r[a]},gN=(s,t,r)=>{const a=Nh(s,r);return a!==void 0?a:Nh(t,r)},F_=(s,t,r)=>{for(const a in t)a!=="__proto__"&&a!=="constructor"&&(a in s?tr(s[a])||s[a]instanceof String||tr(t[a])||t[a]instanceof String?r&&(s[a]=t[a]):F_(s[a],t[a],r):s[a]=t[a]);return s},$d=s=>s.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var vN={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const yN=s=>tr(s)?s.replace(/[&<>"'\/]/g,t=>vN[t]):s;class jN{constructor(t){this.capacity=t,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(t){const r=this.regExpMap.get(t);if(r!==void 0)return r;const a=new RegExp(t);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(t,a),this.regExpQueue.push(t),a}}const _N=[" ",",","?","!",";"],kN=new jN(20),NN=(s,t,r)=>{t=t||"",r=r||"";const a=_N.filter(o=>t.indexOf(o)<0&&r.indexOf(o)<0);if(a.length===0)return!0;const n=kN.getRegExp(`(${a.map(o=>o==="?"?"\\?":o).join("|")})`);let i=!n.test(s);if(!i){const o=s.indexOf(r);o>0&&!n.test(s.substring(0,o))&&(i=!0)}return i},lb=(s,t,r=".")=>{if(!s)return;if(s[t])return Object.prototype.hasOwnProperty.call(s,t)?s[t]:void 0;const a=t.split(r);let n=s;for(let i=0;i<a.length;){if(!n||typeof n!="object")return;let o,c="";for(let d=i;d<a.length;++d)if(d!==i&&(c+=r),c+=a[d],o=n[c],o!==void 0){if(["string","number","boolean"].indexOf(typeof o)>-1&&d<a.length-1)continue;i+=d-i+1;break}n=o}return n},Pp=s=>s==null?void 0:s.replace("_","-"),wN={type:"logger",log(s){this.output("log",s)},warn(s){this.output("warn",s)},error(s){this.output("error",s)},output(s,t){var r,a;(a=(r=console==null?void 0:console[s])==null?void 0:r.apply)==null||a.call(r,console,t)}};class wh{constructor(t,r={}){this.init(t,r)}init(t,r={}){this.prefix=r.prefix||"i18next:",this.logger=t||wN,this.options=r,this.debug=r.debug}log(...t){return this.forward(t,"log","",!0)}warn(...t){return this.forward(t,"warn","",!0)}error(...t){return this.forward(t,"error","")}deprecate(...t){return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}forward(t,r,a,n){return n&&!this.debug?null:(tr(t[0])&&(t[0]=`${a}${this.prefix} ${t[0]}`),this.logger[r](t))}create(t){return new wh(this.logger,{prefix:`${this.prefix}:${t}:`,...this.options})}clone(t){return t=t||this.options,t.prefix=t.prefix||this.prefix,new wh(this.logger,t)}}var vo=new wh;class Qh{constructor(){this.observers={}}on(t,r){return t.split(" ").forEach(a=>{this.observers[a]||(this.observers[a]=new Map);const n=this.observers[a].get(r)||0;this.observers[a].set(r,n+1)}),this}off(t,r){if(this.observers[t]){if(!r){delete this.observers[t];return}this.observers[t].delete(r)}}emit(t,...r){this.observers[t]&&Array.from(this.observers[t].entries()).forEach(([n,i])=>{for(let o=0;o<i;o++)n(...r)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([n,i])=>{for(let o=0;o<i;o++)n.apply(n,[t,...r])})}}class Jv extends Qh{constructor(t,r={ns:["translation"],defaultNS:"translation"}){super(),this.data=t||{},this.options=r,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}removeNamespaces(t){const r=this.options.ns.indexOf(t);r>-1&&this.options.ns.splice(r,1)}getResource(t,r,a,n={}){var p,m;const i=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator,o=n.ignoreJSONStructure!==void 0?n.ignoreJSONStructure:this.options.ignoreJSONStructure;let c;t.indexOf(".")>-1?c=t.split("."):(c=[t,r],a&&(Array.isArray(a)?c.push(...a):tr(a)&&i?c.push(...a.split(i)):c.push(a)));const d=Nh(this.data,c);return!d&&!r&&!a&&t.indexOf(".")>-1&&(t=c[0],r=c[1],a=c.slice(2).join(".")),d||!o||!tr(a)?d:lb((m=(p=this.data)==null?void 0:p[t])==null?void 0:m[r],a,i)}addResource(t,r,a,n,i={silent:!1}){const o=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator;let c=[t,r];a&&(c=c.concat(o?a.split(o):a)),t.indexOf(".")>-1&&(c=t.split("."),n=r,r=c[1]),this.addNamespaces(r),Yv(this.data,c,n),i.silent||this.emit("added",t,r,a,n)}addResources(t,r,a,n={silent:!1}){for(const i in a)(tr(a[i])||Array.isArray(a[i]))&&this.addResource(t,r,i,a[i],{silent:!0});n.silent||this.emit("added",t,r,a)}addResourceBundle(t,r,a,n,i,o={silent:!1,skipCopy:!1}){let c=[t,r];t.indexOf(".")>-1&&(c=t.split("."),n=a,a=r,r=c[1]),this.addNamespaces(r);let d=Nh(this.data,c)||{};o.skipCopy||(a=JSON.parse(JSON.stringify(a))),n?F_(d,a,i):d={...d,...a},Yv(this.data,c,d),o.silent||this.emit("added",t,r,a)}removeResourceBundle(t,r){this.hasResourceBundle(t,r)&&delete this.data[t][r],this.removeNamespaces(r),this.emit("removed",t,r)}hasResourceBundle(t,r){return this.getResource(t,r)!==void 0}getResourceBundle(t,r){return r||(r=this.options.defaultNS),this.getResource(t,r)}getDataByLanguage(t){return this.data[t]}hasLanguageSomeTranslations(t){const r=this.getDataByLanguage(t);return!!(r&&Object.keys(r)||[]).find(n=>r[n]&&Object.keys(r[n]).length>0)}toJSON(){return this.data}}var U_={processors:{},addPostProcessor(s){this.processors[s.name]=s},handle(s,t,r,a,n){return s.forEach(i=>{var o;t=((o=this.processors[i])==null?void 0:o.process(t,r,a,n))??t}),t}};const q_=Symbol("i18next/PATH_KEY");function SN(){const s=[],t=Object.create(null);let r;return t.get=(a,n)=>{var i;return(i=r==null?void 0:r.revoke)==null||i.call(r),n===q_?s:(s.push(n),r=Proxy.revocable(a,t),r.proxy)},Proxy.revocable(Object.create(null),t).proxy}function cb(s,t){const{[q_]:r}=s(SN());return r.join((t==null?void 0:t.keySeparator)??".")}const Xv={},lf=s=>!tr(s)&&typeof s!="boolean"&&typeof s!="number";class Sh extends Qh{constructor(t,r={}){super(),xN(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],t,this),this.options=r,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=vo.create("translator")}changeLanguage(t){t&&(this.language=t)}exists(t,r={interpolation:{}}){const a={...r};if(t==null)return!1;const n=this.resolve(t,a);if((n==null?void 0:n.res)===void 0)return!1;const i=lf(n.res);return!(a.returnObjects===!1&&i)}extractFromKey(t,r){let a=r.nsSeparator!==void 0?r.nsSeparator:this.options.nsSeparator;a===void 0&&(a=":");const n=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator;let i=r.ns||this.options.defaultNS||[];const o=a&&t.indexOf(a)>-1,c=!this.options.userDefinedKeySeparator&&!r.keySeparator&&!this.options.userDefinedNsSeparator&&!r.nsSeparator&&!NN(t,a,n);if(o&&!c){const d=t.match(this.interpolator.nestingRegexp);if(d&&d.length>0)return{key:t,namespaces:tr(i)?[i]:i};const p=t.split(a);(a!==n||a===n&&this.options.ns.indexOf(p[0])>-1)&&(i=p.shift()),t=p.join(n)}return{key:t,namespaces:tr(i)?[i]:i}}translate(t,r,a){let n=typeof r=="object"?{...r}:r;if(typeof n!="object"&&this.options.overloadTranslationOptionHandler&&(n=this.options.overloadTranslationOptionHandler(arguments)),typeof n=="object"&&(n={...n}),n||(n={}),t==null)return"";typeof t=="function"&&(t=cb(t,{...this.options,...n})),Array.isArray(t)||(t=[String(t)]);const i=n.returnDetails!==void 0?n.returnDetails:this.options.returnDetails,o=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator,{key:c,namespaces:d}=this.extractFromKey(t[t.length-1],n),p=d[d.length-1];let m=n.nsSeparator!==void 0?n.nsSeparator:this.options.nsSeparator;m===void 0&&(m=":");const x=n.lng||this.language,b=n.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((x==null?void 0:x.toLowerCase())==="cimode")return b?i?{res:`${p}${m}${c}`,usedKey:c,exactUsedKey:c,usedLng:x,usedNS:p,usedParams:this.getUsedParamsDetails(n)}:`${p}${m}${c}`:i?{res:c,usedKey:c,exactUsedKey:c,usedLng:x,usedNS:p,usedParams:this.getUsedParamsDetails(n)}:c;const h=this.resolve(t,n);let j=h==null?void 0:h.res;const g=(h==null?void 0:h.usedKey)||c,v=(h==null?void 0:h.exactUsedKey)||c,_=["[object Number]","[object Function]","[object RegExp]"],k=n.joinArrays!==void 0?n.joinArrays:this.options.joinArrays,P=!this.i18nFormat||this.i18nFormat.handleAsObject,L=n.count!==void 0&&!tr(n.count),F=Sh.hasDefaultValue(n),W=L?this.pluralResolver.getSuffix(x,n.count,n):"",R=n.ordinal&&L?this.pluralResolver.getSuffix(x,n.count,{ordinal:!1}):"",B=L&&!n.ordinal&&n.count===0,A=B&&n[`defaultValue${this.options.pluralSeparator}zero`]||n[`defaultValue${W}`]||n[`defaultValue${R}`]||n.defaultValue;let S=j;P&&!j&&F&&(S=A);const C=lf(S),O=Object.prototype.toString.apply(S);if(P&&S&&C&&_.indexOf(O)<0&&!(tr(k)&&Array.isArray(S))){if(!n.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const Z=this.options.returnedObjectHandler?this.options.returnedObjectHandler(g,S,{...n,ns:d}):`key '${c} (${this.language})' returned an object instead of string.`;return i?(h.res=Z,h.usedParams=this.getUsedParamsDetails(n),h):Z}if(o){const Z=Array.isArray(S),te=Z?[]:{},ce=Z?v:g;for(const re in S)if(Object.prototype.hasOwnProperty.call(S,re)){const X=`${ce}${o}${re}`;F&&!j?te[re]=this.translate(X,{...n,defaultValue:lf(A)?A[re]:void 0,joinArrays:!1,ns:d}):te[re]=this.translate(X,{...n,joinArrays:!1,ns:d}),te[re]===X&&(te[re]=S[re])}j=te}}else if(P&&tr(k)&&Array.isArray(j))j=j.join(k),j&&(j=this.extendTranslation(j,t,n,a));else{let Z=!1,te=!1;!this.isValidLookup(j)&&F&&(Z=!0,j=A),this.isValidLookup(j)||(te=!0,j=c);const re=(n.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&te?void 0:j,X=F&&A!==j&&this.options.updateMissing;if(te||Z||X){if(this.logger.log(X?"updateKey":"missingKey",x,p,c,X?A:j),o){const J=this.resolve(c,{...n,keySeparator:!1});J&&J.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let U=[];const oe=this.languageUtils.getFallbackCodes(this.options.fallbackLng,n.lng||this.language);if(this.options.saveMissingTo==="fallback"&&oe&&oe[0])for(let J=0;J<oe.length;J++)U.push(oe[J]);else this.options.saveMissingTo==="all"?U=this.languageUtils.toResolveHierarchy(n.lng||this.language):U.push(n.lng||this.language);const xe=(J,$,Q)=>{var I;const q=F&&Q!==j?Q:re;this.options.missingKeyHandler?this.options.missingKeyHandler(J,p,$,q,X,n):(I=this.backendConnector)!=null&&I.saveMissing&&this.backendConnector.saveMissing(J,p,$,q,X,n),this.emit("missingKey",J,p,$,j)};this.options.saveMissing&&(this.options.saveMissingPlurals&&L?U.forEach(J=>{const $=this.pluralResolver.getSuffixes(J,n);B&&n[`defaultValue${this.options.pluralSeparator}zero`]&&$.indexOf(`${this.options.pluralSeparator}zero`)<0&&$.push(`${this.options.pluralSeparator}zero`),$.forEach(Q=>{xe([J],c+Q,n[`defaultValue${Q}`]||A)})}):xe(U,c,A))}j=this.extendTranslation(j,t,n,h,a),te&&j===c&&this.options.appendNamespaceToMissingKey&&(j=`${p}${m}${c}`),(te||Z)&&this.options.parseMissingKeyHandler&&(j=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${p}${m}${c}`:c,Z?j:void 0,n))}return i?(h.res=j,h.usedParams=this.getUsedParamsDetails(n),h):j}extendTranslation(t,r,a,n,i){var d,p;if((d=this.i18nFormat)!=null&&d.parse)t=this.i18nFormat.parse(t,{...this.options.interpolation.defaultVariables,...a},a.lng||this.language||n.usedLng,n.usedNS,n.usedKey,{resolved:n});else if(!a.skipInterpolation){a.interpolation&&this.interpolator.init({...a,interpolation:{...this.options.interpolation,...a.interpolation}});const m=tr(t)&&(((p=a==null?void 0:a.interpolation)==null?void 0:p.skipOnVariables)!==void 0?a.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let x;if(m){const h=t.match(this.interpolator.nestingRegexp);x=h&&h.length}let b=a.replace&&!tr(a.replace)?a.replace:a;if(this.options.interpolation.defaultVariables&&(b={...this.options.interpolation.defaultVariables,...b}),t=this.interpolator.interpolate(t,b,a.lng||this.language||n.usedLng,a),m){const h=t.match(this.interpolator.nestingRegexp),j=h&&h.length;x<j&&(a.nest=!1)}!a.lng&&n&&n.res&&(a.lng=this.language||n.usedLng),a.nest!==!1&&(t=this.interpolator.nest(t,(...h)=>(i==null?void 0:i[0])===h[0]&&!a.context?(this.logger.warn(`It seems you are nesting recursively key: ${h[0]} in key: ${r[0]}`),null):this.translate(...h,r),a)),a.interpolation&&this.interpolator.reset()}const o=a.postProcess||this.options.postProcess,c=tr(o)?[o]:o;return t!=null&&(c!=null&&c.length)&&a.applyPostProcessor!==!1&&(t=U_.handle(c,t,r,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...n,usedParams:this.getUsedParamsDetails(a)},...a}:a,this)),t}resolve(t,r={}){let a,n,i,o,c;return tr(t)&&(t=[t]),t.forEach(d=>{if(this.isValidLookup(a))return;const p=this.extractFromKey(d,r),m=p.key;n=m;let x=p.namespaces;this.options.fallbackNS&&(x=x.concat(this.options.fallbackNS));const b=r.count!==void 0&&!tr(r.count),h=b&&!r.ordinal&&r.count===0,j=r.context!==void 0&&(tr(r.context)||typeof r.context=="number")&&r.context!=="",g=r.lngs?r.lngs:this.languageUtils.toResolveHierarchy(r.lng||this.language,r.fallbackLng);x.forEach(v=>{var _,k;this.isValidLookup(a)||(c=v,!Xv[`${g[0]}-${v}`]&&((_=this.utils)!=null&&_.hasLoadedNamespace)&&!((k=this.utils)!=null&&k.hasLoadedNamespace(c))&&(Xv[`${g[0]}-${v}`]=!0,this.logger.warn(`key "${n}" for languages "${g.join(", ")}" won't get resolved as namespace "${c}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),g.forEach(P=>{var W;if(this.isValidLookup(a))return;o=P;const L=[m];if((W=this.i18nFormat)!=null&&W.addLookupKeys)this.i18nFormat.addLookupKeys(L,m,P,v,r);else{let R;b&&(R=this.pluralResolver.getSuffix(P,r.count,r));const B=`${this.options.pluralSeparator}zero`,A=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(b&&(r.ordinal&&R.indexOf(A)===0&&L.push(m+R.replace(A,this.options.pluralSeparator)),L.push(m+R),h&&L.push(m+B)),j){const S=`${m}${this.options.contextSeparator||"_"}${r.context}`;L.push(S),b&&(r.ordinal&&R.indexOf(A)===0&&L.push(S+R.replace(A,this.options.pluralSeparator)),L.push(S+R),h&&L.push(S+B))}}let F;for(;F=L.pop();)this.isValidLookup(a)||(i=F,a=this.getResource(P,v,F,r))}))})}),{res:a,usedKey:n,exactUsedKey:i,usedLng:o,usedNS:c}}isValidLookup(t){return t!==void 0&&!(!this.options.returnNull&&t===null)&&!(!this.options.returnEmptyString&&t==="")}getResource(t,r,a,n={}){var i;return(i=this.i18nFormat)!=null&&i.getResource?this.i18nFormat.getResource(t,r,a,n):this.resourceStore.getResource(t,r,a,n)}getUsedParamsDetails(t={}){const r=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],a=t.replace&&!tr(t.replace);let n=a?t.replace:t;if(a&&typeof t.count<"u"&&(n.count=t.count),this.options.interpolation.defaultVariables&&(n={...this.options.interpolation.defaultVariables,...n}),!a){n={...n};for(const i of r)delete n[i]}return n}static hasDefaultValue(t){const r="defaultValue";for(const a in t)if(Object.prototype.hasOwnProperty.call(t,a)&&r===a.substring(0,r.length)&&t[a]!==void 0)return!0;return!1}}class Qv{constructor(t){this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=vo.create("languageUtils")}getScriptPartFromCode(t){if(t=Pp(t),!t||t.indexOf("-")<0)return null;const r=t.split("-");return r.length===2||(r.pop(),r[r.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(r.join("-"))}getLanguagePartFromCode(t){if(t=Pp(t),!t||t.indexOf("-")<0)return t;const r=t.split("-");return this.formatLanguageCode(r[0])}formatLanguageCode(t){if(tr(t)&&t.indexOf("-")>-1){let r;try{r=Intl.getCanonicalLocales(t)[0]}catch{}return r&&this.options.lowerCaseLng&&(r=r.toLowerCase()),r||(this.options.lowerCaseLng?t.toLowerCase():t)}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}isSupportedCode(t){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(t)>-1}getBestMatchFromCodes(t){if(!t)return null;let r;return t.forEach(a=>{if(r)return;const n=this.formatLanguageCode(a);(!this.options.supportedLngs||this.isSupportedCode(n))&&(r=n)}),!r&&this.options.supportedLngs&&t.forEach(a=>{if(r)return;const n=this.getScriptPartFromCode(a);if(this.isSupportedCode(n))return r=n;const i=this.getLanguagePartFromCode(a);if(this.isSupportedCode(i))return r=i;r=this.options.supportedLngs.find(o=>{if(o===i)return o;if(!(o.indexOf("-")<0&&i.indexOf("-")<0)&&(o.indexOf("-")>0&&i.indexOf("-")<0&&o.substring(0,o.indexOf("-"))===i||o.indexOf(i)===0&&i.length>1))return o})}),r||(r=this.getFallbackCodes(this.options.fallbackLng)[0]),r}getFallbackCodes(t,r){if(!t)return[];if(typeof t=="function"&&(t=t(r)),tr(t)&&(t=[t]),Array.isArray(t))return t;if(!r)return t.default||[];let a=t[r];return a||(a=t[this.getScriptPartFromCode(r)]),a||(a=t[this.formatLanguageCode(r)]),a||(a=t[this.getLanguagePartFromCode(r)]),a||(a=t.default),a||[]}toResolveHierarchy(t,r){const a=this.getFallbackCodes((r===!1?[]:r)||this.options.fallbackLng||[],t),n=[],i=o=>{o&&(this.isSupportedCode(o)?n.push(o):this.logger.warn(`rejecting language code not found in supportedLngs: ${o}`))};return tr(t)&&(t.indexOf("-")>-1||t.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&i(this.formatLanguageCode(t)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&i(this.getScriptPartFromCode(t)),this.options.load!=="currentOnly"&&i(this.getLanguagePartFromCode(t))):tr(t)&&i(this.formatLanguageCode(t)),a.forEach(o=>{n.indexOf(o)<0&&i(this.formatLanguageCode(o))}),n}}const ey={zero:0,one:1,two:2,few:3,many:4,other:5},ty={select:s=>s===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class zN{constructor(t,r={}){this.languageUtils=t,this.options=r,this.logger=vo.create("pluralResolver"),this.pluralRulesCache={}}addRule(t,r){this.rules[t]=r}clearCache(){this.pluralRulesCache={}}getRule(t,r={}){const a=Pp(t==="dev"?"en":t),n=r.ordinal?"ordinal":"cardinal",i=JSON.stringify({cleanedCode:a,type:n});if(i in this.pluralRulesCache)return this.pluralRulesCache[i];let o;try{o=new Intl.PluralRules(a,{type:n})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),ty;if(!t.match(/-|_/))return ty;const d=this.languageUtils.getLanguagePartFromCode(t);o=this.getRule(d,r)}return this.pluralRulesCache[i]=o,o}needsPlural(t,r={}){let a=this.getRule(t,r);return a||(a=this.getRule("dev",r)),(a==null?void 0:a.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(t,r,a={}){return this.getSuffixes(t,a).map(n=>`${r}${n}`)}getSuffixes(t,r={}){let a=this.getRule(t,r);return a||(a=this.getRule("dev",r)),a?a.resolvedOptions().pluralCategories.sort((n,i)=>ey[n]-ey[i]).map(n=>`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${n}`):[]}getSuffix(t,r,a={}){const n=this.getRule(t,a);return n?`${this.options.prepend}${a.ordinal?`ordinal${this.options.prepend}`:""}${n.select(r)}`:(this.logger.warn(`no plural rule found for: ${t}`),this.getSuffix("dev",r,a))}}const ry=(s,t,r,a=".",n=!0)=>{let i=gN(s,t,r);return!i&&n&&tr(r)&&(i=lb(s,r,a),i===void 0&&(i=lb(t,r,a))),i},cf=s=>s.replace(/\$/g,"$$$$");class CN{constructor(t={}){var r;this.logger=vo.create("interpolator"),this.options=t,this.format=((r=t==null?void 0:t.interpolation)==null?void 0:r.format)||(a=>a),this.init(t)}init(t={}){t.interpolation||(t.interpolation={escapeValue:!0});const{escape:r,escapeValue:a,useRawValueToEscape:n,prefix:i,prefixEscaped:o,suffix:c,suffixEscaped:d,formatSeparator:p,unescapeSuffix:m,unescapePrefix:x,nestingPrefix:b,nestingPrefixEscaped:h,nestingSuffix:j,nestingSuffixEscaped:g,nestingOptionsSeparator:v,maxReplaces:_,alwaysFormat:k}=t.interpolation;this.escape=r!==void 0?r:yN,this.escapeValue=a!==void 0?a:!0,this.useRawValueToEscape=n!==void 0?n:!1,this.prefix=i?$d(i):o||"{{",this.suffix=c?$d(c):d||"}}",this.formatSeparator=p||",",this.unescapePrefix=m?"":x||"-",this.unescapeSuffix=this.unescapePrefix?"":m||"",this.nestingPrefix=b?$d(b):h||$d("$t("),this.nestingSuffix=j?$d(j):g||$d(")"),this.nestingOptionsSeparator=v||",",this.maxReplaces=_||1e3,this.alwaysFormat=k!==void 0?k:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const t=(r,a)=>(r==null?void 0:r.source)===a?(r.lastIndex=0,r):new RegExp(a,"g");this.regexp=t(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=t(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=t(this.nestingRegexp,`${this.nestingPrefix}((?:[^()"']+|"[^"]*"|'[^']*'|\\((?:[^()]|"[^"]*"|'[^']*')*\\))*?)${this.nestingSuffix}`)}interpolate(t,r,a,n){var h;let i,o,c;const d=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},p=j=>{if(j.indexOf(this.formatSeparator)<0){const k=ry(r,d,j,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(k,void 0,a,{...n,...r,interpolationkey:j}):k}const g=j.split(this.formatSeparator),v=g.shift().trim(),_=g.join(this.formatSeparator).trim();return this.format(ry(r,d,v,this.options.keySeparator,this.options.ignoreJSONStructure),_,a,{...n,...r,interpolationkey:v})};this.resetRegExp();const m=(n==null?void 0:n.missingInterpolationHandler)||this.options.missingInterpolationHandler,x=((h=n==null?void 0:n.interpolation)==null?void 0:h.skipOnVariables)!==void 0?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:j=>cf(j)},{regex:this.regexp,safeValue:j=>this.escapeValue?cf(this.escape(j)):cf(j)}].forEach(j=>{for(c=0;i=j.regex.exec(t);){const g=i[1].trim();if(o=p(g),o===void 0)if(typeof m=="function"){const _=m(t,i,n);o=tr(_)?_:""}else if(n&&Object.prototype.hasOwnProperty.call(n,g))o="";else if(x){o=i[0];continue}else this.logger.warn(`missed to pass in variable ${g} for interpolating ${t}`),o="";else!tr(o)&&!this.useRawValueToEscape&&(o=Wv(o));const v=j.safeValue(o);if(t=t.replace(i[0],v),x?(j.regex.lastIndex+=o.length,j.regex.lastIndex-=i[0].length):j.regex.lastIndex=0,c++,c>=this.maxReplaces)break}}),t}nest(t,r,a={}){let n,i,o;const c=(d,p)=>{const m=this.nestingOptionsSeparator;if(d.indexOf(m)<0)return d;const x=d.split(new RegExp(`${m}[ ]*{`));let b=`{${x[1]}`;d=x[0],b=this.interpolate(b,o);const h=b.match(/'/g),j=b.match(/"/g);(((h==null?void 0:h.length)??0)%2===0&&!j||j.length%2!==0)&&(b=b.replace(/'/g,'"'));try{o=JSON.parse(b),p&&(o={...p,...o})}catch(g){return this.logger.warn(`failed parsing options string in nesting for key ${d}`,g),`${d}${m}${b}`}return o.defaultValue&&o.defaultValue.indexOf(this.prefix)>-1&&delete o.defaultValue,d};for(;n=this.nestingRegexp.exec(t);){let d=[];o={...a},o=o.replace&&!tr(o.replace)?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;const p=/{.*}/.test(n[1])?n[1].lastIndexOf("}")+1:n[1].indexOf(this.formatSeparator);if(p!==-1&&(d=n[1].slice(p).split(this.formatSeparator).map(m=>m.trim()).filter(Boolean),n[1]=n[1].slice(0,p)),i=r(c.call(this,n[1].trim(),o),o),i&&n[0]===t&&!tr(i))return i;tr(i)||(i=Wv(i)),i||(this.logger.warn(`missed to resolve ${n[1]} for nesting ${t}`),i=""),d.length&&(i=d.reduce((m,x)=>this.format(m,x,a.lng,{...a,interpolationkey:n[1].trim()}),i.trim())),t=t.replace(n[0],i),this.regexp.lastIndex=0}return t}}const PN=s=>{let t=s.toLowerCase().trim();const r={};if(s.indexOf("(")>-1){const a=s.split("(");t=a[0].toLowerCase().trim();const n=a[1].substring(0,a[1].length-1);t==="currency"&&n.indexOf(":")<0?r.currency||(r.currency=n.trim()):t==="relativetime"&&n.indexOf(":")<0?r.range||(r.range=n.trim()):n.split(";").forEach(o=>{if(o){const[c,...d]=o.split(":"),p=d.join(":").trim().replace(/^'+|'+$/g,""),m=c.trim();r[m]||(r[m]=p),p==="false"&&(r[m]=!1),p==="true"&&(r[m]=!0),isNaN(p)||(r[m]=parseInt(p,10))}})}return{formatName:t,formatOptions:r}},sy=s=>{const t={};return(r,a,n)=>{let i=n;n&&n.interpolationkey&&n.formatParams&&n.formatParams[n.interpolationkey]&&n[n.interpolationkey]&&(i={...i,[n.interpolationkey]:void 0});const o=a+JSON.stringify(i);let c=t[o];return c||(c=s(Pp(a),n),t[o]=c),c(r)}},AN=s=>(t,r,a)=>s(Pp(r),a)(t);class ON{constructor(t={}){this.logger=vo.create("formatter"),this.options=t,this.init(t)}init(t,r={interpolation:{}}){this.formatSeparator=r.interpolation.formatSeparator||",";const a=r.cacheInBuiltFormats?sy:AN;this.formats={number:a((n,i)=>{const o=new Intl.NumberFormat(n,{...i});return c=>o.format(c)}),currency:a((n,i)=>{const o=new Intl.NumberFormat(n,{...i,style:"currency"});return c=>o.format(c)}),datetime:a((n,i)=>{const o=new Intl.DateTimeFormat(n,{...i});return c=>o.format(c)}),relativetime:a((n,i)=>{const o=new Intl.RelativeTimeFormat(n,{...i});return c=>o.format(c,i.range||"day")}),list:a((n,i)=>{const o=new Intl.ListFormat(n,{...i});return c=>o.format(c)})}}add(t,r){this.formats[t.toLowerCase().trim()]=r}addCached(t,r){this.formats[t.toLowerCase().trim()]=sy(r)}format(t,r,a,n={}){const i=r.split(this.formatSeparator);if(i.length>1&&i[0].indexOf("(")>1&&i[0].indexOf(")")<0&&i.find(c=>c.indexOf(")")>-1)){const c=i.findIndex(d=>d.indexOf(")")>-1);i[0]=[i[0],...i.splice(1,c)].join(this.formatSeparator)}return i.reduce((c,d)=>{var x;const{formatName:p,formatOptions:m}=PN(d);if(this.formats[p]){let b=c;try{const h=((x=n==null?void 0:n.formatParams)==null?void 0:x[n.interpolationkey])||{},j=h.locale||h.lng||n.locale||n.lng||a;b=this.formats[p](c,j,{...m,...n,...h})}catch(h){this.logger.warn(h)}return b}else this.logger.warn(`there was no format function for ${p}`);return c},t)}}const DN=(s,t)=>{s.pending[t]!==void 0&&(delete s.pending[t],s.pendingCount--)};class EN extends Qh{constructor(t,r,a,n={}){var i,o;super(),this.backend=t,this.store=r,this.services=a,this.languageUtils=a.languageUtils,this.options=n,this.logger=vo.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=n.maxParallelReads||10,this.readingCalls=0,this.maxRetries=n.maxRetries>=0?n.maxRetries:5,this.retryTimeout=n.retryTimeout>=1?n.retryTimeout:350,this.state={},this.queue=[],(o=(i=this.backend)==null?void 0:i.init)==null||o.call(i,a,n.backend,n)}queueLoad(t,r,a,n){const i={},o={},c={},d={};return t.forEach(p=>{let m=!0;r.forEach(x=>{const b=`${p}|${x}`;!a.reload&&this.store.hasResourceBundle(p,x)?this.state[b]=2:this.state[b]<0||(this.state[b]===1?o[b]===void 0&&(o[b]=!0):(this.state[b]=1,m=!1,o[b]===void 0&&(o[b]=!0),i[b]===void 0&&(i[b]=!0),d[x]===void 0&&(d[x]=!0)))}),m||(c[p]=!0)}),(Object.keys(i).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:n}),{toLoad:Object.keys(i),pending:Object.keys(o),toLoadLanguages:Object.keys(c),toLoadNamespaces:Object.keys(d)}}loaded(t,r,a){const n=t.split("|"),i=n[0],o=n[1];r&&this.emit("failedLoading",i,o,r),!r&&a&&this.store.addResourceBundle(i,o,a,void 0,void 0,{skipCopy:!0}),this.state[t]=r?-1:2,r&&a&&(this.state[t]=0);const c={};this.queue.forEach(d=>{bN(d.loaded,[i],o),DN(d,t),r&&d.errors.push(r),d.pendingCount===0&&!d.done&&(Object.keys(d.loaded).forEach(p=>{c[p]||(c[p]={});const m=d.loaded[p];m.length&&m.forEach(x=>{c[p][x]===void 0&&(c[p][x]=!0)})}),d.done=!0,d.errors.length?d.callback(d.errors):d.callback())}),this.emit("loaded",c),this.queue=this.queue.filter(d=>!d.done)}read(t,r,a,n=0,i=this.retryTimeout,o){if(!t.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:t,ns:r,fcName:a,tried:n,wait:i,callback:o});return}this.readingCalls++;const c=(p,m)=>{if(this.readingCalls--,this.waitingReads.length>0){const x=this.waitingReads.shift();this.read(x.lng,x.ns,x.fcName,x.tried,x.wait,x.callback)}if(p&&m&&n<this.maxRetries){setTimeout(()=>{this.read.call(this,t,r,a,n+1,i*2,o)},i);return}o(p,m)},d=this.backend[a].bind(this.backend);if(d.length===2){try{const p=d(t,r);p&&typeof p.then=="function"?p.then(m=>c(null,m)).catch(c):c(null,p)}catch(p){c(p)}return}return d(t,r,c)}prepareLoading(t,r,a={},n){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),n&&n();tr(t)&&(t=this.languageUtils.toResolveHierarchy(t)),tr(r)&&(r=[r]);const i=this.queueLoad(t,r,a,n);if(!i.toLoad.length)return i.pending.length||n(),null;i.toLoad.forEach(o=>{this.loadOne(o)})}load(t,r,a){this.prepareLoading(t,r,{},a)}reload(t,r,a){this.prepareLoading(t,r,{reload:!0},a)}loadOne(t,r=""){const a=t.split("|"),n=a[0],i=a[1];this.read(n,i,"read",void 0,void 0,(o,c)=>{o&&this.logger.warn(`${r}loading namespace ${i} for language ${n} failed`,o),!o&&c&&this.logger.log(`${r}loaded namespace ${i} for language ${n}`,c),this.loaded(t,o,c)})}saveMissing(t,r,a,n,i,o={},c=()=>{}){var d,p,m,x,b;if((p=(d=this.services)==null?void 0:d.utils)!=null&&p.hasLoadedNamespace&&!((x=(m=this.services)==null?void 0:m.utils)!=null&&x.hasLoadedNamespace(r))){this.logger.warn(`did not save key "${a}" as the namespace "${r}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(a==null||a==="")){if((b=this.backend)!=null&&b.create){const h={...o,isUpdate:i},j=this.backend.create.bind(this.backend);if(j.length<6)try{let g;j.length===5?g=j(t,r,a,n,h):g=j(t,r,a,n),g&&typeof g.then=="function"?g.then(v=>c(null,v)).catch(c):c(null,g)}catch(g){c(g)}else j(t,r,a,n,c,h)}!t||!t[0]||this.store.addResource(t[0],r,a,n)}}}const ay=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:s=>{let t={};if(typeof s[1]=="object"&&(t=s[1]),tr(s[1])&&(t.defaultValue=s[1]),tr(s[2])&&(t.tDescription=s[2]),typeof s[2]=="object"||typeof s[3]=="object"){const r=s[3]||s[2];Object.keys(r).forEach(a=>{t[a]=r[a]})}return t},interpolation:{escapeValue:!0,format:s=>s,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),ny=s=>{var t,r;return tr(s.ns)&&(s.ns=[s.ns]),tr(s.fallbackLng)&&(s.fallbackLng=[s.fallbackLng]),tr(s.fallbackNS)&&(s.fallbackNS=[s.fallbackNS]),((r=(t=s.supportedLngs)==null?void 0:t.indexOf)==null?void 0:r.call(t,"cimode"))<0&&(s.supportedLngs=s.supportedLngs.concat(["cimode"])),typeof s.initImmediate=="boolean"&&(s.initAsync=s.initImmediate),s},Em=()=>{},IN=s=>{Object.getOwnPropertyNames(Object.getPrototypeOf(s)).forEach(r=>{typeof s[r]=="function"&&(s[r]=s[r].bind(s))})};class bp extends Qh{constructor(t={},r){if(super(),this.options=ny(t),this.services={},this.logger=vo,this.modules={external:[]},IN(this),r&&!this.isInitialized&&!t.isClone){if(!this.options.initAsync)return this.init(t,r),this;setTimeout(()=>{this.init(t,r)},0)}}init(t={},r){this.isInitializing=!0,typeof t=="function"&&(r=t,t={}),t.defaultNS==null&&t.ns&&(tr(t.ns)?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));const a=ay();this.options={...a,...this.options,...ny(t)},this.options.interpolation={...a.interpolation,...this.options.interpolation},t.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=t.keySeparator),t.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=t.nsSeparator);const n=p=>p?typeof p=="function"?new p:p:null;if(!this.options.isClone){this.modules.logger?vo.init(n(this.modules.logger),this.options):vo.init(null,this.options);let p;this.modules.formatter?p=this.modules.formatter:p=ON;const m=new Qv(this.options);this.store=new Jv(this.options.resources,this.options);const x=this.services;x.logger=vo,x.resourceStore=this.store,x.languageUtils=m,x.pluralResolver=new zN(m,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==a.interpolation.format&&this.logger.deprecate("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),p&&(!this.options.interpolation.format||this.options.interpolation.format===a.interpolation.format)&&(x.formatter=n(p),x.formatter.init&&x.formatter.init(x,this.options),this.options.interpolation.format=x.formatter.format.bind(x.formatter)),x.interpolator=new CN(this.options),x.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},x.backendConnector=new EN(n(this.modules.backend),x.resourceStore,x,this.options),x.backendConnector.on("*",(h,...j)=>{this.emit(h,...j)}),this.modules.languageDetector&&(x.languageDetector=n(this.modules.languageDetector),x.languageDetector.init&&x.languageDetector.init(x,this.options.detection,this.options)),this.modules.i18nFormat&&(x.i18nFormat=n(this.modules.i18nFormat),x.i18nFormat.init&&x.i18nFormat.init(this)),this.translator=new Sh(this.services,this.options),this.translator.on("*",(h,...j)=>{this.emit(h,...j)}),this.modules.external.forEach(h=>{h.init&&h.init(this)})}if(this.format=this.options.interpolation.format,r||(r=Em),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const p=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);p.length>0&&p[0]!=="dev"&&(this.options.lng=p[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(p=>{this[p]=(...m)=>this.store[p](...m)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(p=>{this[p]=(...m)=>(this.store[p](...m),this)});const c=ep(),d=()=>{const p=(m,x)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),c.resolve(x),r(m,x)};if(this.languages&&!this.isInitialized)return p(null,this.t.bind(this));this.changeLanguage(this.options.lng,p)};return this.options.resources||!this.options.initAsync?d():setTimeout(d,0),c}loadResources(t,r=Em){var i,o;let a=r;const n=tr(t)?t:this.language;if(typeof t=="function"&&(a=t),!this.options.resources||this.options.partialBundledLanguages){if((n==null?void 0:n.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return a();const c=[],d=p=>{if(!p||p==="cimode")return;this.services.languageUtils.toResolveHierarchy(p).forEach(x=>{x!=="cimode"&&c.indexOf(x)<0&&c.push(x)})};n?d(n):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(m=>d(m)),(o=(i=this.options.preload)==null?void 0:i.forEach)==null||o.call(i,p=>d(p)),this.services.backendConnector.load(c,this.options.ns,p=>{!p&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),a(p)})}else a(null)}reloadResources(t,r,a){const n=ep();return typeof t=="function"&&(a=t,t=void 0),typeof r=="function"&&(a=r,r=void 0),t||(t=this.languages),r||(r=this.options.ns),a||(a=Em),this.services.backendConnector.reload(t,r,i=>{n.resolve(),a(i)}),n}use(t){if(!t)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return t.type==="backend"&&(this.modules.backend=t),(t.type==="logger"||t.log&&t.warn&&t.error)&&(this.modules.logger=t),t.type==="languageDetector"&&(this.modules.languageDetector=t),t.type==="i18nFormat"&&(this.modules.i18nFormat=t),t.type==="postProcessor"&&U_.addPostProcessor(t),t.type==="formatter"&&(this.modules.formatter=t),t.type==="3rdParty"&&this.modules.external.push(t),this}setResolvedLanguage(t){if(!(!t||!this.languages)&&!(["cimode","dev"].indexOf(t)>-1)){for(let r=0;r<this.languages.length;r++){const a=this.languages[r];if(!(["cimode","dev"].indexOf(a)>-1)&&this.store.hasLanguageSomeTranslations(a)){this.resolvedLanguage=a;break}}!this.resolvedLanguage&&this.languages.indexOf(t)<0&&this.store.hasLanguageSomeTranslations(t)&&(this.resolvedLanguage=t,this.languages.unshift(t))}}changeLanguage(t,r){this.isLanguageChangingTo=t;const a=ep();this.emit("languageChanging",t);const n=c=>{this.language=c,this.languages=this.services.languageUtils.toResolveHierarchy(c),this.resolvedLanguage=void 0,this.setResolvedLanguage(c)},i=(c,d)=>{d?this.isLanguageChangingTo===t&&(n(d),this.translator.changeLanguage(d),this.isLanguageChangingTo=void 0,this.emit("languageChanged",d),this.logger.log("languageChanged",d)):this.isLanguageChangingTo=void 0,a.resolve((...p)=>this.t(...p)),r&&r(c,(...p)=>this.t(...p))},o=c=>{var m,x;!t&&!c&&this.services.languageDetector&&(c=[]);const d=tr(c)?c:c&&c[0],p=this.store.hasLanguageSomeTranslations(d)?d:this.services.languageUtils.getBestMatchFromCodes(tr(c)?[c]:c);p&&(this.language||n(p),this.translator.language||this.translator.changeLanguage(p),(x=(m=this.services.languageDetector)==null?void 0:m.cacheUserLanguage)==null||x.call(m,p)),this.loadResources(p,b=>{i(b,p)})};return!t&&this.services.languageDetector&&!this.services.languageDetector.async?o(this.services.languageDetector.detect()):!t&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(o):this.services.languageDetector.detect(o):o(t),a}getFixedT(t,r,a){const n=(i,o,...c)=>{let d;typeof o!="object"?d=this.options.overloadTranslationOptionHandler([i,o].concat(c)):d={...o},d.lng=d.lng||n.lng,d.lngs=d.lngs||n.lngs,d.ns=d.ns||n.ns,d.keyPrefix!==""&&(d.keyPrefix=d.keyPrefix||a||n.keyPrefix);const p=this.options.keySeparator||".";let m;return d.keyPrefix&&Array.isArray(i)?m=i.map(x=>(typeof x=="function"&&(x=cb(x,{...this.options,...o})),`${d.keyPrefix}${p}${x}`)):(typeof i=="function"&&(i=cb(i,{...this.options,...o})),m=d.keyPrefix?`${d.keyPrefix}${p}${i}`:i),this.t(m,d)};return tr(t)?n.lng=t:n.lngs=t,n.ns=r,n.keyPrefix=a,n}t(...t){var r;return(r=this.translator)==null?void 0:r.translate(...t)}exists(...t){var r;return(r=this.translator)==null?void 0:r.exists(...t)}setDefaultNamespace(t){this.options.defaultNS=t}hasLoadedNamespace(t,r={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const a=r.lng||this.resolvedLanguage||this.languages[0],n=this.options?this.options.fallbackLng:!1,i=this.languages[this.languages.length-1];if(a.toLowerCase()==="cimode")return!0;const o=(c,d)=>{const p=this.services.backendConnector.state[`${c}|${d}`];return p===-1||p===0||p===2};if(r.precheck){const c=r.precheck(this,o);if(c!==void 0)return c}return!!(this.hasResourceBundle(a,t)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||o(a,t)&&(!n||o(i,t)))}loadNamespaces(t,r){const a=ep();return this.options.ns?(tr(t)&&(t=[t]),t.forEach(n=>{this.options.ns.indexOf(n)<0&&this.options.ns.push(n)}),this.loadResources(n=>{a.resolve(),r&&r(n)}),a):(r&&r(),Promise.resolve())}loadLanguages(t,r){const a=ep();tr(t)&&(t=[t]);const n=this.options.preload||[],i=t.filter(o=>n.indexOf(o)<0&&this.services.languageUtils.isSupportedCode(o));return i.length?(this.options.preload=n.concat(i),this.loadResources(o=>{a.resolve(),r&&r(o)}),a):(r&&r(),Promise.resolve())}dir(t){var n,i;if(t||(t=this.resolvedLanguage||(((n=this.languages)==null?void 0:n.length)>0?this.languages[0]:this.language)),!t)return"rtl";try{const o=new Intl.Locale(t);if(o&&o.getTextInfo){const c=o.getTextInfo();if(c&&c.direction)return c.direction}}catch{}const r=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],a=((i=this.services)==null?void 0:i.languageUtils)||new Qv(ay());return t.toLowerCase().indexOf("-latn")>1?"ltr":r.indexOf(a.getLanguagePartFromCode(t))>-1||t.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(t={},r){const a=new bp(t,r);return a.createInstance=bp.createInstance,a}cloneInstance(t={},r=Em){const a=t.forkResourceStore;a&&delete t.forkResourceStore;const n={...this.options,...t,isClone:!0},i=new bp(n);if((t.debug!==void 0||t.prefix!==void 0)&&(i.logger=i.logger.clone(t)),["store","services","language"].forEach(c=>{i[c]=this[c]}),i.services={...this.services},i.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},a){const c=Object.keys(this.store.data).reduce((d,p)=>(d[p]={...this.store.data[p]},d[p]=Object.keys(d[p]).reduce((m,x)=>(m[x]={...d[p][x]},m),d[p]),d),{});i.store=new Jv(c,n),i.services.resourceStore=i.store}return i.translator=new Sh(i.services,n),i.translator.on("*",(c,...d)=>{i.emit(c,...d)}),i.init(n,r),i.translator.options=n,i.translator.backendConnector.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const ma=bp.createInstance();ma.createInstance;ma.dir;ma.init;ma.loadResources;ma.reloadResources;ma.use;ma.changeLanguage;ma.getFixedT;ma.t;ma.exists;ma.setDefaultNamespace;ma.hasLoadedNamespace;ma.loadNamespaces;ma.loadLanguages;const LN=(s,t,r,a)=>{var i,o,c,d;const n=[r,{code:t,...a||{}}];if((o=(i=s==null?void 0:s.services)==null?void 0:i.logger)!=null&&o.forward)return s.services.logger.forward(n,"warn","react-i18next::",!0);ed(n[0])&&(n[0]=`react-i18next:: ${n[0]}`),(d=(c=s==null?void 0:s.services)==null?void 0:c.logger)!=null&&d.warn?s.services.logger.warn(...n):console!=null&&console.warn&&console.warn(...n)},iy={},$_=(s,t,r,a)=>{ed(r)&&iy[r]||(ed(r)&&(iy[r]=new Date),LN(s,t,r,a))},B_=(s,t)=>()=>{if(s.isInitialized)t();else{const r=()=>{setTimeout(()=>{s.off("initialized",r)},0),t()};s.on("initialized",r)}},db=(s,t,r)=>{s.loadNamespaces(t,B_(s,r))},oy=(s,t,r,a)=>{if(ed(r)&&(r=[r]),s.options.preload&&s.options.preload.indexOf(t)>-1)return db(s,r,a);r.forEach(n=>{s.options.ns.indexOf(n)<0&&s.options.ns.push(n)}),s.loadLanguages(t,B_(s,a))},TN=(s,t,r={})=>!t.languages||!t.languages.length?($_(t,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:t.languages}),!0):t.hasLoadedNamespace(s,{lng:r.lng,precheck:(a,n)=>{if(r.bindI18n&&r.bindI18n.indexOf("languageChanging")>-1&&a.services.backendConnector.backend&&a.isLanguageChangingTo&&!n(a.isLanguageChangingTo,s))return!1}}),ed=s=>typeof s=="string",RN=s=>typeof s=="object"&&s!==null,MN=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,FN={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},UN=s=>FN[s],qN=s=>s.replace(MN,UN);let ub={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:qN};const $N=(s={})=>{ub={...ub,...s}},BN=()=>ub;let V_;const VN=s=>{V_=s},HN=()=>V_,ZN={type:"3rdParty",init(s){$N(s.options.react),VN(s)}},WN=z.createContext();class KN{constructor(){this.usedNamespaces={}}addUsedNamespaces(t){t.forEach(r=>{this.usedNamespaces[r]||(this.usedNamespaces[r]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}var df={exports:{}},uf={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ly;function GN(){if(ly)return uf;ly=1;var s=Xh();function t(x,b){return x===b&&(x!==0||1/x===1/b)||x!==x&&b!==b}var r=typeof Object.is=="function"?Object.is:t,a=s.useState,n=s.useEffect,i=s.useLayoutEffect,o=s.useDebugValue;function c(x,b){var h=b(),j=a({inst:{value:h,getSnapshot:b}}),g=j[0].inst,v=j[1];return i(function(){g.value=h,g.getSnapshot=b,d(g)&&v({inst:g})},[x,h,b]),n(function(){return d(g)&&v({inst:g}),x(function(){d(g)&&v({inst:g})})},[x]),o(h),h}function d(x){var b=x.getSnapshot;x=x.value;try{var h=b();return!r(x,h)}catch{return!0}}function p(x,b){return b()}var m=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?p:c;return uf.useSyncExternalStore=s.useSyncExternalStore!==void 0?s.useSyncExternalStore:m,uf}var cy;function YN(){return cy||(cy=1,df.exports=GN()),df.exports}var JN=YN();const XN=(s,t)=>ed(t)?t:RN(t)&&ed(t.defaultValue)?t.defaultValue:Array.isArray(s)?s[s.length-1]:s,QN={t:XN,ready:!1},ew=()=>()=>{},et=(s,t={})=>{var R,B;const{i18n:r}=t,{i18n:a,defaultNS:n}=z.useContext(WN)||{},i=r||a||HN();i&&!i.reportNamespaces&&(i.reportNamespaces=new KN),i||$_(i,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const o=z.useMemo(()=>{var A;return{...BN(),...(A=i==null?void 0:i.options)==null?void 0:A.react,...t}},[i,t]),{useSuspense:c,keyPrefix:d}=o,p=z.useMemo(()=>{var S;const A=n||((S=i==null?void 0:i.options)==null?void 0:S.defaultNS);return ed(A)?[A]:A||["translation"]},[s,n,i]);(B=(R=i==null?void 0:i.reportNamespaces)==null?void 0:R.addUsedNamespaces)==null||B.call(R,p);const m=z.useRef(0),x=z.useCallback(A=>{if(!i)return ew;const{bindI18n:S,bindI18nStore:C}=o,O=()=>{m.current+=1,A()};return S&&i.on(S,O),C&&i.store.on(C,O),()=>{S&&S.split(" ").forEach(Z=>i.off(Z,O)),C&&C.split(" ").forEach(Z=>i.store.off(Z,O))}},[i,o]),b=z.useRef(),h=z.useCallback(()=>{if(!i)return QN;const A=!!(i.isInitialized||i.initializedStoreOnce)&&p.every(ce=>TN(ce,i,o)),S=t.lng||i.language,C=m.current,O=b.current;if(O&&O.ready===A&&O.lng===S&&O.keyPrefix===d&&O.revision===C)return O;const te={t:i.getFixedT(S,o.nsMode==="fallback"?p:p[0],d),ready:A,lng:S,keyPrefix:d,revision:C};return b.current=te,te},[i,p,d,o,t.lng]),[j,g]=z.useState(0),{t:v,ready:_}=JN.useSyncExternalStore(x,h,h);z.useEffect(()=>{if(i&&!_&&!c){const A=()=>g(S=>S+1);t.lng?oy(i,t.lng,p,A):db(i,p,A)}},[i,t.lng,p,_,c,j]);const k=i||{},P=z.useRef(null),L=z.useRef(),F=A=>{const S=Object.getOwnPropertyDescriptors(A);S.__original&&delete S.__original;const C=Object.create(Object.getPrototypeOf(A),S);if(!Object.prototype.hasOwnProperty.call(C,"__original"))try{Object.defineProperty(C,"__original",{value:A,writable:!1,enumerable:!1,configurable:!1})}catch{}return C},W=z.useMemo(()=>{const A=k,S=A==null?void 0:A.language;let C=A;A&&(P.current&&P.current.__original===A?L.current!==S?(C=F(A),P.current=C,L.current=S):C=P.current:(C=F(A),P.current=C,L.current=S));const O=[v,C,_];return O.t=v,O.i18n=C,O.ready=_,O},[v,k,_,k.resolvedLanguage,k.language,k.languages]);if(i&&c&&!_)throw new Promise(A=>{const S=()=>A();t.lng?oy(i,t.lng,p,S):db(i,p,S)});return W};function pb(s){"@babel/helpers - typeof";return pb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pb(s)}function H_(){return typeof XMLHttpRequest=="function"||(typeof XMLHttpRequest>"u"?"undefined":pb(XMLHttpRequest))==="object"}function tw(s){return!!s&&typeof s.then=="function"}function rw(s){return tw(s)?s:Promise.resolve(s)}const sw="modulepreload",aw=function(s){return"/"+s},dy={},gp=function(t,r,a){let n=Promise.resolve();if(r&&r.length>0){let o=function(p){return Promise.all(p.map(m=>Promise.resolve(m).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),d=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));n=o(r.map(p=>{if(p=aw(p),p in dy)return;dy[p]=!0;const m=p.endsWith(".css"),x=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${x}`))return;const b=document.createElement("link");if(b.rel=m?"stylesheet":sw,m||(b.as="script"),b.crossOrigin="",b.href=p,d&&b.setAttribute("nonce",d),document.head.appendChild(b),m)return new Promise((h,j)=>{b.addEventListener("load",h),b.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${p}`)))})}))}function i(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return n.then(o=>{for(const c of o||[])c.status==="rejected"&&i(c.reason);return t().catch(i)})};function uy(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(s);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(s,n).enumerable})),r.push.apply(r,a)}return r}function py(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uy(Object(r),!0).forEach(function(a){nw(s,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):uy(Object(r)).forEach(function(a){Object.defineProperty(s,a,Object.getOwnPropertyDescriptor(r,a))})}return s}function nw(s,t,r){return(t=iw(t))in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function iw(s){var t=ow(s,"string");return td(t)=="symbol"?t:t+""}function ow(s,t){if(td(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var a=r.call(s,t);if(td(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}function td(s){"@babel/helpers - typeof";return td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},td(s)}var nc=typeof fetch=="function"?fetch:void 0;typeof global<"u"&&global.fetch?nc=global.fetch:typeof window<"u"&&window.fetch&&(nc=window.fetch);var Ap;H_()&&(typeof global<"u"&&global.XMLHttpRequest?Ap=global.XMLHttpRequest:typeof window<"u"&&window.XMLHttpRequest&&(Ap=window.XMLHttpRequest));var zh;typeof ActiveXObject=="function"&&(typeof global<"u"&&global.ActiveXObject?zh=global.ActiveXObject:typeof window<"u"&&window.ActiveXObject&&(zh=window.ActiveXObject));typeof nc!="function"&&(nc=void 0);if(!nc&&!Ap&&!zh)try{gp(()=>import("./browser-ponyfill-UkdipAkQ.js").then(s=>s.b),[]).then(function(s){nc=s.default}).catch(function(){})}catch{}var mb=function(t,r){if(r&&td(r)==="object"){var a="";for(var n in r)a+="&"+encodeURIComponent(n)+"="+encodeURIComponent(r[n]);if(!a)return t;t=t+(t.indexOf("?")!==-1?"&":"?")+a.slice(1)}return t},my=function(t,r,a,n){var i=function(d){if(!d.ok)return a(d.statusText||"Error",{status:d.status});d.text().then(function(p){a(null,{status:d.status,data:p})}).catch(a)};if(n){var o=n(t,r);if(o instanceof Promise){o.then(i).catch(a);return}}typeof fetch=="function"?fetch(t,r).then(i).catch(a):nc(t,r).then(i).catch(a)},hy=!1,lw=function(t,r,a,n){t.queryStringParams&&(r=mb(r,t.queryStringParams));var i=py({},typeof t.customHeaders=="function"?t.customHeaders():t.customHeaders);typeof window>"u"&&typeof global<"u"&&typeof global.process<"u"&&global.process.versions&&global.process.versions.node&&(i["User-Agent"]="i18next-http-backend (node/".concat(global.process.version,"; ").concat(global.process.platform," ").concat(global.process.arch,")")),a&&(i["Content-Type"]="application/json");var o=typeof t.requestOptions=="function"?t.requestOptions(a):t.requestOptions,c=py({method:a?"POST":"GET",body:a?t.stringify(a):void 0,headers:i},hy?{}:o),d=typeof t.alternateFetch=="function"&&t.alternateFetch.length>=1?t.alternateFetch:void 0;try{my(r,c,n,d)}catch(p){if(!o||Object.keys(o).length===0||!p.message||p.message.indexOf("not implemented")<0)return n(p);try{Object.keys(o).forEach(function(m){delete c[m]}),my(r,c,n,d),hy=!0}catch(m){n(m)}}},cw=function(t,r,a,n){a&&td(a)==="object"&&(a=mb("",a).slice(1)),t.queryStringParams&&(r=mb(r,t.queryStringParams));try{var i=Ap?new Ap:new zh("MSXML2.XMLHTTP.3.0");i.open(a?"POST":"GET",r,1),t.crossDomain||i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.withCredentials=!!t.withCredentials,a&&i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.overrideMimeType&&i.overrideMimeType("application/json");var o=t.customHeaders;if(o=typeof o=="function"?o():o,o)for(var c in o)i.setRequestHeader(c,o[c]);i.onreadystatechange=function(){i.readyState>3&&n(i.status>=400?i.statusText:null,{status:i.status,data:i.responseText})},i.send(a)}catch(d){console&&console.log(d)}},dw=function(t,r,a,n){if(typeof a=="function"&&(n=a,a=void 0),n=n||function(){},nc&&r.indexOf("file:")!==0)return lw(t,r,a,n);if(H_()||typeof ActiveXObject=="function")return cw(t,r,a,n);n(new Error("No fetch and no xhr implementation found!"))};function xu(s){"@babel/helpers - typeof";return xu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xu(s)}function xy(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(s);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(s,n).enumerable})),r.push.apply(r,a)}return r}function pf(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xy(Object(r),!0).forEach(function(a){Z_(s,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):xy(Object(r)).forEach(function(a){Object.defineProperty(s,a,Object.getOwnPropertyDescriptor(r,a))})}return s}function uw(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function pw(s,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(s,W_(a.key),a)}}function mw(s,t,r){return t&&pw(s.prototype,t),Object.defineProperty(s,"prototype",{writable:!1}),s}function Z_(s,t,r){return(t=W_(t))in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function W_(s){var t=hw(s,"string");return xu(t)=="symbol"?t:t+""}function hw(s,t){if(xu(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var a=r.call(s,t);if(xu(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(s)}var xw=function(){return{loadPath:"/locales/{{lng}}/{{ns}}.json",addPath:"/locales/add/{{lng}}/{{ns}}",parse:function(r){return JSON.parse(r)},stringify:JSON.stringify,parsePayload:function(r,a,n){return Z_({},a,n||"")},parseLoadPayload:function(r,a){},request:dw,reloadInterval:typeof window<"u"?!1:3600*1e3,customHeaders:{},queryStringParams:{},crossDomain:!1,withCredentials:!1,overrideMimeType:!1,requestOptions:{mode:"cors",credentials:"same-origin",cache:"default"}}},K_=(function(){function s(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};uw(this,s),this.services=t,this.options=r,this.allOptions=a,this.type="backend",this.init(t,r,a)}return mw(s,[{key:"init",value:function(r){var a=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this.services=r,this.options=pf(pf(pf({},xw()),this.options||{}),n),this.allOptions=i,this.services&&this.options.reloadInterval){var o=setInterval(function(){return a.reload()},this.options.reloadInterval);xu(o)==="object"&&typeof o.unref=="function"&&o.unref()}}},{key:"readMulti",value:function(r,a,n){this._readAny(r,r,a,a,n)}},{key:"read",value:function(r,a,n){this._readAny([r],r,[a],a,n)}},{key:"_readAny",value:function(r,a,n,i,o){var c=this,d=this.options.loadPath;typeof this.options.loadPath=="function"&&(d=this.options.loadPath(r,n)),d=rw(d),d.then(function(p){if(!p)return o(null,{});var m=c.services.interpolator.interpolate(p,{lng:r.join("+"),ns:n.join("+")});c.loadUrl(m,o,a,i)})}},{key:"loadUrl",value:function(r,a,n,i){var o=this,c=typeof n=="string"?[n]:n,d=typeof i=="string"?[i]:i,p=this.options.parseLoadPayload(c,d);this.options.request(this.options,r,p,function(m,x){if(x&&(x.status>=500&&x.status<600||!x.status))return a("failed loading "+r+"; status code: "+x.status,!0);if(x&&x.status>=400&&x.status<500)return a("failed loading "+r+"; status code: "+x.status,!1);if(!x&&m&&m.message){var b=m.message.toLowerCase(),h=["failed","fetch","network","load"].find(function(v){return b.indexOf(v)>-1});if(h)return a("failed loading "+r+": "+m.message,!0)}if(m)return a(m,!1);var j,g;try{typeof x.data=="string"?j=o.options.parse(x.data,n,i):j=x.data}catch{g="failed parsing "+r+" to json"}if(g)return a(g,!1);a(null,j)})}},{key:"create",value:function(r,a,n,i,o){var c=this;if(this.options.addPath){typeof r=="string"&&(r=[r]);var d=this.options.parsePayload(a,n,i),p=0,m=[],x=[];r.forEach(function(b){var h=c.options.addPath;typeof c.options.addPath=="function"&&(h=c.options.addPath(b,a));var j=c.services.interpolator.interpolate(h,{lng:b,ns:a});c.options.request(c.options,j,d,function(g,v){p+=1,m.push(g),x.push(v),p===r.length&&typeof o=="function"&&o(m,x)})})}}},{key:"reload",value:function(){var r=this,a=this.services,n=a.backendConnector,i=a.languageUtils,o=a.logger,c=n.language;if(!(c&&c.toLowerCase()==="cimode")){var d=[],p=function(x){var b=i.toResolveHierarchy(x);b.forEach(function(h){d.indexOf(h)<0&&d.push(h)})};p(c),this.allOptions.preload&&this.allOptions.preload.forEach(function(m){return p(m)}),d.forEach(function(m){r.allOptions.ns.forEach(function(x){n.read(m,x,"read",null,null,function(b,h){b&&o.warn("loading namespace ".concat(x," for language ").concat(m," failed"),b),!b&&h&&o.log("loaded namespace ".concat(x," for language ").concat(m),h),n.loaded("".concat(m,"|").concat(x),b,h)})})})}}}])})();K_.type="backend";const{slice:fw,forEach:bw}=[];function gw(s){return bw.call(fw.call(arguments,1),t=>{if(t)for(const r in t)s[r]===void 0&&(s[r]=t[r])}),s}function vw(s){return typeof s!="string"?!1:[/<\s*script.*?>/i,/<\s*\/\s*script\s*>/i,/<\s*img.*?on\w+\s*=/i,/<\s*\w+\s*on\w+\s*=.*?>/i,/javascript\s*:/i,/vbscript\s*:/i,/expression\s*\(/i,/eval\s*\(/i,/alert\s*\(/i,/document\.cookie/i,/document\.write\s*\(/i,/window\.location/i,/innerHTML/i].some(r=>r.test(s))}const fy=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,yw=function(s,t){const a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{path:"/"},n=encodeURIComponent(t);let i=`${s}=${n}`;if(a.maxAge>0){const o=a.maxAge-0;if(Number.isNaN(o))throw new Error("maxAge should be a Number");i+=`; Max-Age=${Math.floor(o)}`}if(a.domain){if(!fy.test(a.domain))throw new TypeError("option domain is invalid");i+=`; Domain=${a.domain}`}if(a.path){if(!fy.test(a.path))throw new TypeError("option path is invalid");i+=`; Path=${a.path}`}if(a.expires){if(typeof a.expires.toUTCString!="function")throw new TypeError("option expires is invalid");i+=`; Expires=${a.expires.toUTCString()}`}if(a.httpOnly&&(i+="; HttpOnly"),a.secure&&(i+="; Secure"),a.sameSite)switch(typeof a.sameSite=="string"?a.sameSite.toLowerCase():a.sameSite){case!0:i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"strict":i+="; SameSite=Strict";break;case"none":i+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return a.partitioned&&(i+="; Partitioned"),i},by={create(s,t,r,a){let n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};r&&(n.expires=new Date,n.expires.setTime(n.expires.getTime()+r*60*1e3)),a&&(n.domain=a),document.cookie=yw(s,t,n)},read(s){const t=`${s}=`,r=document.cookie.split(";");for(let a=0;a<r.length;a++){let n=r[a];for(;n.charAt(0)===" ";)n=n.substring(1,n.length);if(n.indexOf(t)===0)return n.substring(t.length,n.length)}return null},remove(s,t){this.create(s,"",-1,t)}};var jw={name:"cookie",lookup(s){let{lookupCookie:t}=s;if(t&&typeof document<"u")return by.read(t)||void 0},cacheUserLanguage(s,t){let{lookupCookie:r,cookieMinutes:a,cookieDomain:n,cookieOptions:i}=t;r&&typeof document<"u"&&by.create(r,s,a,n,i)}},_w={name:"querystring",lookup(s){var a;let{lookupQuerystring:t}=s,r;if(typeof window<"u"){let{search:n}=window.location;!window.location.search&&((a=window.location.hash)==null?void 0:a.indexOf("?"))>-1&&(n=window.location.hash.substring(window.location.hash.indexOf("?")));const o=n.substring(1).split("&");for(let c=0;c<o.length;c++){const d=o[c].indexOf("=");d>0&&o[c].substring(0,d)===t&&(r=o[c].substring(d+1))}}return r}},kw={name:"hash",lookup(s){var n;let{lookupHash:t,lookupFromHashIndex:r}=s,a;if(typeof window<"u"){const{hash:i}=window.location;if(i&&i.length>2){const o=i.substring(1);if(t){const c=o.split("&");for(let d=0;d<c.length;d++){const p=c[d].indexOf("=");p>0&&c[d].substring(0,p)===t&&(a=c[d].substring(p+1))}}if(a)return a;if(!a&&r>-1){const c=i.match(/\/([a-zA-Z-]*)/g);return Array.isArray(c)?(n=c[typeof r=="number"?r:0])==null?void 0:n.replace("/",""):void 0}}}return a}};let Bd=null;const gy=()=>{if(Bd!==null)return Bd;try{if(Bd=typeof window<"u"&&window.localStorage!==null,!Bd)return!1;const s="i18next.translate.boo";window.localStorage.setItem(s,"foo"),window.localStorage.removeItem(s)}catch{Bd=!1}return Bd};var Nw={name:"localStorage",lookup(s){let{lookupLocalStorage:t}=s;if(t&&gy())return window.localStorage.getItem(t)||void 0},cacheUserLanguage(s,t){let{lookupLocalStorage:r}=t;r&&gy()&&window.localStorage.setItem(r,s)}};let Vd=null;const vy=()=>{if(Vd!==null)return Vd;try{if(Vd=typeof window<"u"&&window.sessionStorage!==null,!Vd)return!1;const s="i18next.translate.boo";window.sessionStorage.setItem(s,"foo"),window.sessionStorage.removeItem(s)}catch{Vd=!1}return Vd};var ww={name:"sessionStorage",lookup(s){let{lookupSessionStorage:t}=s;if(t&&vy())return window.sessionStorage.getItem(t)||void 0},cacheUserLanguage(s,t){let{lookupSessionStorage:r}=t;r&&vy()&&window.sessionStorage.setItem(r,s)}},Sw={name:"navigator",lookup(s){const t=[];if(typeof navigator<"u"){const{languages:r,userLanguage:a,language:n}=navigator;if(r)for(let i=0;i<r.length;i++)t.push(r[i]);a&&t.push(a),n&&t.push(n)}return t.length>0?t:void 0}},zw={name:"htmlTag",lookup(s){let{htmlTag:t}=s,r;const a=t||(typeof document<"u"?document.documentElement:null);return a&&typeof a.getAttribute=="function"&&(r=a.getAttribute("lang")),r}},Cw={name:"path",lookup(s){var n;let{lookupFromPathIndex:t}=s;if(typeof window>"u")return;const r=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(r)?(n=r[typeof t=="number"?t:0])==null?void 0:n.replace("/",""):void 0}},Pw={name:"subdomain",lookup(s){var n,i;let{lookupFromSubdomainIndex:t}=s;const r=typeof t=="number"?t+1:1,a=typeof window<"u"&&((i=(n=window.location)==null?void 0:n.hostname)==null?void 0:i.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i));if(a)return a[r]}};let G_=!1;try{document.cookie,G_=!0}catch{}const Y_=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];G_||Y_.splice(1,1);const Aw=()=>({order:Y_,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:s=>s});class J_{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(t,r)}init(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{languageUtils:{}},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=t,this.options=gw(r,this.options||{},Aw()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=n=>n.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=a,this.addDetector(jw),this.addDetector(_w),this.addDetector(Nw),this.addDetector(ww),this.addDetector(Sw),this.addDetector(zw),this.addDetector(Cw),this.addDetector(Pw),this.addDetector(kw)}addDetector(t){return this.detectors[t.name]=t,this}detect(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.order,r=[];return t.forEach(a=>{if(this.detectors[a]){let n=this.detectors[a].lookup(this.options);n&&typeof n=="string"&&(n=[n]),n&&(r=r.concat(n))}}),r=r.filter(a=>a!=null&&!vw(a)).map(a=>this.options.convertDetectedLanguage(a)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?r:r.length>0?r[0]:null}cacheUserLanguage(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.caches;r&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(t)>-1||r.forEach(a=>{this.detectors[a]&&this.detectors[a].cacheUserLanguage(t,this.options)}))}}J_.type="languageDetector";ma.use(K_).use(J_).use(ZN).init({fallbackLng:"sl",debug:!1,ns:["translation"],defaultNS:"translation",backend:{loadPath:"/locales/{{lng}}/{{ns}}.json",addPath:"/locales/add/{{lng}}/{{ns}}"},detection:{order:["localStorage","navigator","htmlTag"],caches:["localStorage"]},interpolation:{escapeValue:!1},load:"languageOnly",react:{useSuspense:!1}});ma.on("languageChanged",s=>{console.log(" i18n: Language changed to:",s)});console.log(" i18n: Initialized with dynamic translation loading from files");var hb=function(s,t){return hb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(r[n]=a[n])},hb(s,t)};function X_(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");hb(s,t);function r(){this.constructor=s}s.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Ch=function(){return Ch=Object.assign||function(t){for(var r,a=1,n=arguments.length;a<n;a++){r=arguments[a];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},Ch.apply(this,arguments)};function vu(s,t){var r={};for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&t.indexOf(a)<0&&(r[a]=s[a]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,a=Object.getOwnPropertySymbols(s);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(s,a[n])&&(r[a[n]]=s[a[n]]);return r}function Q_(s,t,r,a){var n=arguments.length,i=n<3?t:a===null?a=Object.getOwnPropertyDescriptor(t,r):a,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(s,t,r,a);else for(var c=s.length-1;c>=0;c--)(o=s[c])&&(i=(n<3?o(i):n>3?o(t,r,i):o(t,r))||i);return n>3&&i&&Object.defineProperty(t,r,i),i}function e2(s,t){return function(r,a){t(r,a,s)}}function t2(s,t,r,a,n,i){function o(_){if(_!==void 0&&typeof _!="function")throw new TypeError("Function expected");return _}for(var c=a.kind,d=c==="getter"?"get":c==="setter"?"set":"value",p=!t&&s?a.static?s:s.prototype:null,m=t||(p?Object.getOwnPropertyDescriptor(p,a.name):{}),x,b=!1,h=r.length-1;h>=0;h--){var j={};for(var g in a)j[g]=g==="access"?{}:a[g];for(var g in a.access)j.access[g]=a.access[g];j.addInitializer=function(_){if(b)throw new TypeError("Cannot add initializers after decoration has completed");i.push(o(_||null))};var v=(0,r[h])(c==="accessor"?{get:m.get,set:m.set}:m[d],j);if(c==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(x=o(v.get))&&(m.get=x),(x=o(v.set))&&(m.set=x),(x=o(v.init))&&n.unshift(x)}else(x=o(v))&&(c==="field"?n.unshift(x):m[d]=x)}p&&Object.defineProperty(p,a.name,m),b=!0}function r2(s,t,r){for(var a=arguments.length>2,n=0;n<t.length;n++)r=a?t[n].call(s,r):t[n].call(s);return a?r:void 0}function s2(s){return typeof s=="symbol"?s:"".concat(s)}function a2(s,t,r){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(s,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function n2(s,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,t)}function Ot(s,t,r,a){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function c(m){try{p(a.next(m))}catch(x){o(x)}}function d(m){try{p(a.throw(m))}catch(x){o(x)}}function p(m){m.done?i(m.value):n(m.value).then(c,d)}p((a=a.apply(s,t||[])).next())})}function i2(s,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},a,n,i,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=c(0),o.throw=c(1),o.return=c(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(p){return function(m){return d([p,m])}}function d(p){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,p[0]&&(r=0)),r;)try{if(a=1,n&&(i=p[0]&2?n.return:p[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,p[1])).done)return i;switch(n=0,i&&(p=[p[0]&2,i.value]),p[0]){case 0:case 1:i=p;break;case 4:return r.label++,{value:p[1],done:!1};case 5:r.label++,n=p[1],p=[0];continue;case 7:p=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(p[0]===6||p[0]===2)){r=0;continue}if(p[0]===3&&(!i||p[1]>i[0]&&p[1]<i[3])){r.label=p[1];break}if(p[0]===6&&r.label<i[1]){r.label=i[1],i=p;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(p);break}i[2]&&r.ops.pop(),r.trys.pop();continue}p=t.call(s,r)}catch(m){p=[6,m],n=0}finally{a=i=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}var ex=Object.create?(function(s,t,r,a){a===void 0&&(a=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(s,a,n)}):(function(s,t,r,a){a===void 0&&(a=r),s[a]=t[r]});function o2(s,t){for(var r in s)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&ex(t,s,r)}function Ph(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],a=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&a>=s.length&&(s=void 0),{value:s&&s[a++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Qb(s,t){var r=typeof Symbol=="function"&&s[Symbol.iterator];if(!r)return s;var a=r.call(s),n,i=[],o;try{for(;(t===void 0||t-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(c){o={error:c}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}function l2(){for(var s=[],t=0;t<arguments.length;t++)s=s.concat(Qb(arguments[t]));return s}function c2(){for(var s=0,t=0,r=arguments.length;t<r;t++)s+=arguments[t].length;for(var a=Array(s),n=0,t=0;t<r;t++)for(var i=arguments[t],o=0,c=i.length;o<c;o++,n++)a[n]=i[o];return a}function d2(s,t,r){if(r||arguments.length===2)for(var a=0,n=t.length,i;a<n;a++)(i||!(a in t))&&(i||(i=Array.prototype.slice.call(t,0,a)),i[a]=t[a]);return s.concat(i||Array.prototype.slice.call(t))}function fu(s){return this instanceof fu?(this.v=s,this):new fu(s)}function u2(s,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=r.apply(s,t||[]),n,i=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",o),n[Symbol.asyncIterator]=function(){return this},n;function o(h){return function(j){return Promise.resolve(j).then(h,x)}}function c(h,j){a[h]&&(n[h]=function(g){return new Promise(function(v,_){i.push([h,g,v,_])>1||d(h,g)})},j&&(n[h]=j(n[h])))}function d(h,j){try{p(a[h](j))}catch(g){b(i[0][3],g)}}function p(h){h.value instanceof fu?Promise.resolve(h.value.v).then(m,x):b(i[0][2],h)}function m(h){d("next",h)}function x(h){d("throw",h)}function b(h,j){h(j),i.shift(),i.length&&d(i[0][0],i[0][1])}}function p2(s){var t,r;return t={},a("next"),a("throw",function(n){throw n}),a("return"),t[Symbol.iterator]=function(){return this},t;function a(n,i){t[n]=s[n]?function(o){return(r=!r)?{value:fu(s[n](o)),done:!1}:i?i(o):o}:i}}function m2(s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=s[Symbol.asyncIterator],r;return t?t.call(s):(s=typeof Ph=="function"?Ph(s):s[Symbol.iterator](),r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r);function a(i){r[i]=s[i]&&function(o){return new Promise(function(c,d){o=s[i](o),n(c,d,o.done,o.value)})}}function n(i,o,c,d){Promise.resolve(d).then(function(p){i({value:p,done:c})},o)}}function h2(s,t){return Object.defineProperty?Object.defineProperty(s,"raw",{value:t}):s.raw=t,s}var Ow=Object.create?(function(s,t){Object.defineProperty(s,"default",{enumerable:!0,value:t})}):function(s,t){s.default=t},xb=function(s){return xb=Object.getOwnPropertyNames||function(t){var r=[];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(r[r.length]=a);return r},xb(s)};function x2(s){if(s&&s.__esModule)return s;var t={};if(s!=null)for(var r=xb(s),a=0;a<r.length;a++)r[a]!=="default"&&ex(t,s,r[a]);return Ow(t,s),t}function f2(s){return s&&s.__esModule?s:{default:s}}function b2(s,t,r,a){if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?s!==t||!a:!t.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?a:r==="a"?a.call(s):a?a.value:t.get(s)}function g2(s,t,r,a,n){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?s!==t||!n:!t.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?n.call(s,r):n?n.value=r:t.set(s,r),r}function v2(s,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof s=="function"?t===s:s.has(t)}function y2(s,t,r){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var a,n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");a=t[Symbol.asyncDispose]}if(a===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");a=t[Symbol.dispose],r&&(n=a)}if(typeof a!="function")throw new TypeError("Object not disposable.");n&&(a=function(){try{n.call(this)}catch(i){return Promise.reject(i)}}),s.stack.push({value:t,dispose:a,async:r})}else r&&s.stack.push({async:!0});return t}var Dw=typeof SuppressedError=="function"?SuppressedError:function(s,t,r){var a=new Error(r);return a.name="SuppressedError",a.error=s,a.suppressed=t,a};function j2(s){function t(i){s.error=s.hasError?new Dw(i,s.error,"An error was suppressed during disposal."):i,s.hasError=!0}var r,a=0;function n(){for(;r=s.stack.pop();)try{if(!r.async&&a===1)return a=0,s.stack.push(r),Promise.resolve().then(n);if(r.dispose){var i=r.dispose.call(r.value);if(r.async)return a|=2,Promise.resolve(i).then(n,function(o){return t(o),n()})}else a|=1}catch(o){t(o)}if(a===1)return s.hasError?Promise.reject(s.error):Promise.resolve();if(s.hasError)throw s.error}return n()}function _2(s,t){return typeof s=="string"&&/^\.\.?\//.test(s)?s.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,a,n,i,o){return a?t?".jsx":".js":n&&(!i||!o)?r:n+i+"."+o.toLowerCase()+"js"}):s}const Ew={__extends:X_,__assign:Ch,__rest:vu,__decorate:Q_,__param:e2,__esDecorate:t2,__runInitializers:r2,__propKey:s2,__setFunctionName:a2,__metadata:n2,__awaiter:Ot,__generator:i2,__createBinding:ex,__exportStar:o2,__values:Ph,__read:Qb,__spread:l2,__spreadArrays:c2,__spreadArray:d2,__await:fu,__asyncGenerator:u2,__asyncDelegator:p2,__asyncValues:m2,__makeTemplateObject:h2,__importStar:x2,__importDefault:f2,__classPrivateFieldGet:b2,__classPrivateFieldSet:g2,__classPrivateFieldIn:v2,__addDisposableResource:y2,__disposeResources:j2,__rewriteRelativeImportExtension:_2},Iw=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:y2,get __assign(){return Ch},__asyncDelegator:p2,__asyncGenerator:u2,__asyncValues:m2,__await:fu,__awaiter:Ot,__classPrivateFieldGet:b2,__classPrivateFieldIn:v2,__classPrivateFieldSet:g2,__createBinding:ex,__decorate:Q_,__disposeResources:j2,__esDecorate:t2,__exportStar:o2,__extends:X_,__generator:i2,__importDefault:f2,__importStar:x2,__makeTemplateObject:h2,__metadata:n2,__param:e2,__propKey:s2,__read:Qb,__rest:vu,__rewriteRelativeImportExtension:_2,__runInitializers:r2,__setFunctionName:a2,__spread:l2,__spreadArray:d2,__spreadArrays:c2,__values:Ph,default:Ew},Symbol.toStringTag,{value:"Module"})),Lw=s=>s?(...t)=>s(...t):(...t)=>fetch(...t);class eg extends Error{constructor(t,r="FunctionsError",a){super(t),this.name=r,this.context=a}}class Tw extends eg{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class yy extends eg{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class jy extends eg{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var fb;(function(s){s.Any="any",s.ApNortheast1="ap-northeast-1",s.ApNortheast2="ap-northeast-2",s.ApSouth1="ap-south-1",s.ApSoutheast1="ap-southeast-1",s.ApSoutheast2="ap-southeast-2",s.CaCentral1="ca-central-1",s.EuCentral1="eu-central-1",s.EuWest1="eu-west-1",s.EuWest2="eu-west-2",s.EuWest3="eu-west-3",s.SaEast1="sa-east-1",s.UsEast1="us-east-1",s.UsWest1="us-west-1",s.UsWest2="us-west-2"})(fb||(fb={}));class Rw{constructor(t,{headers:r={},customFetch:a,region:n=fb.Any}={}){this.url=t,this.headers=r,this.region=n,this.fetch=Lw(a)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return Ot(this,arguments,void 0,function*(r,a={}){var n;let i,o;try{const{headers:c,method:d,body:p,signal:m,timeout:x}=a;let b={},{region:h}=a;h||(h=this.region);const j=new URL(`${this.url}/${r}`);h&&h!=="any"&&(b["x-region"]=h,j.searchParams.set("forceFunctionRegion",h));let g;p&&(c&&!Object.prototype.hasOwnProperty.call(c,"Content-Type")||!c)?typeof Blob<"u"&&p instanceof Blob||p instanceof ArrayBuffer?(b["Content-Type"]="application/octet-stream",g=p):typeof p=="string"?(b["Content-Type"]="text/plain",g=p):typeof FormData<"u"&&p instanceof FormData?g=p:(b["Content-Type"]="application/json",g=JSON.stringify(p)):g=p;let v=m;x&&(o=new AbortController,i=setTimeout(()=>o.abort(),x),m?(v=o.signal,m.addEventListener("abort",()=>o.abort())):v=o.signal);const _=yield this.fetch(j.toString(),{method:d||"POST",headers:Object.assign(Object.assign(Object.assign({},b),this.headers),c),body:g,signal:v}).catch(F=>{throw new Tw(F)}),k=_.headers.get("x-relay-error");if(k&&k==="true")throw new yy(_);if(!_.ok)throw new jy(_);let P=((n=_.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),L;return P==="application/json"?L=yield _.json():P==="application/octet-stream"||P==="application/pdf"?L=yield _.blob():P==="text/event-stream"?L=_:P==="multipart/form-data"?L=yield _.formData():L=yield _.text(),{data:L,error:null,response:_}}catch(c){return{data:null,error:c,response:c instanceof jy||c instanceof yy?c.context:void 0}}finally{i&&clearTimeout(i)}})}}var Ia={};const yu=aN(Iw);var Im={},Lm={},Tm={},Rm={},Mm={},Fm={},_y;function k2(){if(_y)return Fm;_y=1,Object.defineProperty(Fm,"__esModule",{value:!0});class s extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return Fm.default=s,Fm}var ky;function N2(){if(ky)return Mm;ky=1,Object.defineProperty(Mm,"__esModule",{value:!0});const t=yu.__importDefault(k2());class r{constructor(n){var i,o;this.shouldThrowOnError=!1,this.method=n.method,this.url=n.url,this.headers=new Headers(n.headers),this.schema=n.schema,this.body=n.body,this.shouldThrowOnError=(i=n.shouldThrowOnError)!==null&&i!==void 0?i:!1,this.signal=n.signal,this.isMaybeSingle=(o=n.isMaybeSingle)!==null&&o!==void 0?o:!1,n.fetch?this.fetch=n.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(n,i){return this.headers=new Headers(this.headers),this.headers.set(n,i),this}then(n,i){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const o=this.fetch;let c=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async d=>{var p,m,x,b;let h=null,j=null,g=null,v=d.status,_=d.statusText;if(d.ok){if(this.method!=="HEAD"){const F=await d.text();F===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((p=this.headers.get("Accept"))===null||p===void 0)&&p.includes("application/vnd.pgrst.plan+text"))?j=F:j=JSON.parse(F))}const P=(m=this.headers.get("Prefer"))===null||m===void 0?void 0:m.match(/count=(exact|planned|estimated)/),L=(x=d.headers.get("content-range"))===null||x===void 0?void 0:x.split("/");P&&L&&L.length>1&&(g=parseInt(L[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(j)&&(j.length>1?(h={code:"PGRST116",details:`Results contain ${j.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},j=null,g=null,v=406,_="Not Acceptable"):j.length===1?j=j[0]:j=null)}else{const P=await d.text();try{h=JSON.parse(P),Array.isArray(h)&&d.status===404&&(j=[],h=null,v=200,_="OK")}catch{d.status===404&&P===""?(v=204,_="No Content"):h={message:P}}if(h&&this.isMaybeSingle&&(!((b=h==null?void 0:h.details)===null||b===void 0)&&b.includes("0 rows"))&&(h=null,v=200,_="OK"),h&&this.shouldThrowOnError)throw new t.default(h)}return{error:h,data:j,count:g,status:v,statusText:_}});return this.shouldThrowOnError||(c=c.catch(d=>{var p,m,x;return{error:{message:`${(p=d==null?void 0:d.name)!==null&&p!==void 0?p:"FetchError"}: ${d==null?void 0:d.message}`,details:`${(m=d==null?void 0:d.stack)!==null&&m!==void 0?m:""}`,hint:"",code:`${(x=d==null?void 0:d.code)!==null&&x!==void 0?x:""}`},data:null,count:null,status:0,statusText:""}})),c.then(n,i)}returns(){return this}overrideTypes(){return this}}return Mm.default=r,Mm}var Ny;function w2(){if(Ny)return Rm;Ny=1,Object.defineProperty(Rm,"__esModule",{value:!0});const t=yu.__importDefault(N2());class r extends t.default{select(n){let i=!1;const o=(n??"*").split("").map(c=>/\s/.test(c)&&!i?"":(c==='"'&&(i=!i),c)).join("");return this.url.searchParams.set("select",o),this.headers.append("Prefer","return=representation"),this}order(n,{ascending:i=!0,nullsFirst:o,foreignTable:c,referencedTable:d=c}={}){const p=d?`${d}.order`:"order",m=this.url.searchParams.get(p);return this.url.searchParams.set(p,`${m?`${m},`:""}${n}.${i?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:i,referencedTable:o=i}={}){const c=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(c,`${n}`),this}range(n,i,{foreignTable:o,referencedTable:c=o}={}){const d=typeof c>"u"?"offset":`${c}.offset`,p=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(d,`${n}`),this.url.searchParams.set(p,`${i-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:n=!1,verbose:i=!1,settings:o=!1,buffers:c=!1,wal:d=!1,format:p="text"}={}){var m;const x=[n?"analyze":null,i?"verbose":null,o?"settings":null,c?"buffers":null,d?"wal":null].filter(Boolean).join("|"),b=(m=this.headers.get("Accept"))!==null&&m!==void 0?m:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${p}; for="${b}"; options=${x};`),p==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(n){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${n}`),this}}return Rm.default=r,Rm}var wy;function tg(){if(wy)return Tm;wy=1,Object.defineProperty(Tm,"__esModule",{value:!0});const t=yu.__importDefault(w2()),r=new RegExp("[,()]");class a extends t.default{eq(i,o){return this.url.searchParams.append(i,`eq.${o}`),this}neq(i,o){return this.url.searchParams.append(i,`neq.${o}`),this}gt(i,o){return this.url.searchParams.append(i,`gt.${o}`),this}gte(i,o){return this.url.searchParams.append(i,`gte.${o}`),this}lt(i,o){return this.url.searchParams.append(i,`lt.${o}`),this}lte(i,o){return this.url.searchParams.append(i,`lte.${o}`),this}like(i,o){return this.url.searchParams.append(i,`like.${o}`),this}likeAllOf(i,o){return this.url.searchParams.append(i,`like(all).{${o.join(",")}}`),this}likeAnyOf(i,o){return this.url.searchParams.append(i,`like(any).{${o.join(",")}}`),this}ilike(i,o){return this.url.searchParams.append(i,`ilike.${o}`),this}ilikeAllOf(i,o){return this.url.searchParams.append(i,`ilike(all).{${o.join(",")}}`),this}ilikeAnyOf(i,o){return this.url.searchParams.append(i,`ilike(any).{${o.join(",")}}`),this}is(i,o){return this.url.searchParams.append(i,`is.${o}`),this}in(i,o){const c=Array.from(new Set(o)).map(d=>typeof d=="string"&&r.test(d)?`"${d}"`:`${d}`).join(",");return this.url.searchParams.append(i,`in.(${c})`),this}contains(i,o){return typeof o=="string"?this.url.searchParams.append(i,`cs.${o}`):Array.isArray(o)?this.url.searchParams.append(i,`cs.{${o.join(",")}}`):this.url.searchParams.append(i,`cs.${JSON.stringify(o)}`),this}containedBy(i,o){return typeof o=="string"?this.url.searchParams.append(i,`cd.${o}`):Array.isArray(o)?this.url.searchParams.append(i,`cd.{${o.join(",")}}`):this.url.searchParams.append(i,`cd.${JSON.stringify(o)}`),this}rangeGt(i,o){return this.url.searchParams.append(i,`sr.${o}`),this}rangeGte(i,o){return this.url.searchParams.append(i,`nxl.${o}`),this}rangeLt(i,o){return this.url.searchParams.append(i,`sl.${o}`),this}rangeLte(i,o){return this.url.searchParams.append(i,`nxr.${o}`),this}rangeAdjacent(i,o){return this.url.searchParams.append(i,`adj.${o}`),this}overlaps(i,o){return typeof o=="string"?this.url.searchParams.append(i,`ov.${o}`):this.url.searchParams.append(i,`ov.{${o.join(",")}}`),this}textSearch(i,o,{config:c,type:d}={}){let p="";d==="plain"?p="pl":d==="phrase"?p="ph":d==="websearch"&&(p="w");const m=c===void 0?"":`(${c})`;return this.url.searchParams.append(i,`${p}fts${m}.${o}`),this}match(i){return Object.entries(i).forEach(([o,c])=>{this.url.searchParams.append(o,`eq.${c}`)}),this}not(i,o,c){return this.url.searchParams.append(i,`not.${o}.${c}`),this}or(i,{foreignTable:o,referencedTable:c=o}={}){const d=c?`${c}.or`:"or";return this.url.searchParams.append(d,`(${i})`),this}filter(i,o,c){return this.url.searchParams.append(i,`${o}.${c}`),this}}return Tm.default=a,Tm}var Sy;function S2(){if(Sy)return Lm;Sy=1,Object.defineProperty(Lm,"__esModule",{value:!0});const t=yu.__importDefault(tg());class r{constructor(n,{headers:i={},schema:o,fetch:c}){this.url=n,this.headers=new Headers(i),this.schema=o,this.fetch=c}select(n,i){const{head:o=!1,count:c}=i??{},d=o?"HEAD":"GET";let p=!1;const m=(n??"*").split("").map(x=>/\s/.test(x)&&!p?"":(x==='"'&&(p=!p),x)).join("");return this.url.searchParams.set("select",m),c&&this.headers.append("Prefer",`count=${c}`),new t.default({method:d,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(n,{count:i,defaultToNull:o=!0}={}){var c;const d="POST";if(i&&this.headers.append("Prefer",`count=${i}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(n)){const p=n.reduce((m,x)=>m.concat(Object.keys(x)),[]);if(p.length>0){const m=[...new Set(p)].map(x=>`"${x}"`);this.url.searchParams.set("columns",m.join(","))}}return new t.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}upsert(n,{onConflict:i,ignoreDuplicates:o=!1,count:c,defaultToNull:d=!0}={}){var p;const m="POST";if(this.headers.append("Prefer",`resolution=${o?"ignore":"merge"}-duplicates`),i!==void 0&&this.url.searchParams.set("on_conflict",i),c&&this.headers.append("Prefer",`count=${c}`),d||this.headers.append("Prefer","missing=default"),Array.isArray(n)){const x=n.reduce((b,h)=>b.concat(Object.keys(h)),[]);if(x.length>0){const b=[...new Set(x)].map(h=>`"${h}"`);this.url.searchParams.set("columns",b.join(","))}}return new t.default({method:m,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(p=this.fetch)!==null&&p!==void 0?p:fetch})}update(n,{count:i}={}){var o;const c="PATCH";return i&&this.headers.append("Prefer",`count=${i}`),new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}delete({count:n}={}){var i;const o="DELETE";return n&&this.headers.append("Prefer",`count=${n}`),new t.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}}return Lm.default=r,Lm}var zy;function Mw(){if(zy)return Im;zy=1,Object.defineProperty(Im,"__esModule",{value:!0});const s=yu,t=s.__importDefault(S2()),r=s.__importDefault(tg());class a{constructor(i,{headers:o={},schema:c,fetch:d}={}){this.url=i,this.headers=new Headers(o),this.schemaName=c,this.fetch=d}from(i){const o=new URL(`${this.url}/${i}`);return new t.default(o,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(i){return new a(this.url,{headers:this.headers,schema:i,fetch:this.fetch})}rpc(i,o={},{head:c=!1,get:d=!1,count:p}={}){var m;let x;const b=new URL(`${this.url}/rpc/${i}`);let h;c||d?(x=c?"HEAD":"GET",Object.entries(o).filter(([g,v])=>v!==void 0).map(([g,v])=>[g,Array.isArray(v)?`{${v.join(",")}}`:`${v}`]).forEach(([g,v])=>{b.searchParams.append(g,v)})):(x="POST",h=o);const j=new Headers(this.headers);return p&&j.set("Prefer",`count=${p}`),new r.default({method:x,url:b,headers:j,schema:this.schemaName,body:h,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}}return Im.default=a,Im}var Cy;function Fw(){if(Cy)return Ia;Cy=1,Object.defineProperty(Ia,"__esModule",{value:!0}),Ia.PostgrestError=Ia.PostgrestBuilder=Ia.PostgrestTransformBuilder=Ia.PostgrestFilterBuilder=Ia.PostgrestQueryBuilder=Ia.PostgrestClient=void 0;const s=yu,t=s.__importDefault(Mw());Ia.PostgrestClient=t.default;const r=s.__importDefault(S2());Ia.PostgrestQueryBuilder=r.default;const a=s.__importDefault(tg());Ia.PostgrestFilterBuilder=a.default;const n=s.__importDefault(w2());Ia.PostgrestTransformBuilder=n.default;const i=s.__importDefault(N2());Ia.PostgrestBuilder=i.default;const o=s.__importDefault(k2());return Ia.PostgrestError=o.default,Ia.default={PostgrestClient:t.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:a.default,PostgrestTransformBuilder:n.default,PostgrestBuilder:i.default,PostgrestError:o.default},Ia}var z2=Fw();const C2=Xb(z2),Uw=sN({__proto__:null,default:C2},[z2]),{PostgrestClient:qw,PostgrestQueryBuilder:BE,PostgrestFilterBuilder:VE,PostgrestTransformBuilder:HE,PostgrestBuilder:ZE,PostgrestError:WE}=C2||Uw;class $w{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const a=r.node,n=parseInt(a.replace(/^v/,"").split(".")[0]);return n>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${n} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const a=this.getWebSocketConstructor();return new a(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const Bw="2.81.1",Vw=`realtime-js/${Bw}`,P2="1.0.0",Hw="2.0.0",Py=P2,bb=1e4,Zw=1e3,Ww=100;var Hc;(function(s){s[s.connecting=0]="connecting",s[s.open=1]="open",s[s.closing=2]="closing",s[s.closed=3]="closed"})(Hc||(Hc={}));var ta;(function(s){s.closed="closed",s.errored="errored",s.joined="joined",s.joining="joining",s.leaving="leaving"})(ta||(ta={}));var pi;(function(s){s.close="phx_close",s.error="phx_error",s.join="phx_join",s.reply="phx_reply",s.leave="phx_leave",s.access_token="access_token"})(pi||(pi={}));var gb;(function(s){s.websocket="websocket"})(gb||(gb={}));var Zc;(function(s){s.Connecting="connecting",s.Open="open",s.Closing="closing",s.Closed="closed"})(Zc||(Zc={}));class Kw{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={push:0,reply:1,broadcast:2,userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST="broadcast"}encode(t,r){if(this._isArrayBuffer(t.payload))return r(this._binaryEncodePush(t));if(t.event===this.BROADCAST&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let a=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(a))}_binaryEncodePush(t){const{join_ref:r,ref:a,event:n,topic:i,payload:o}=t,c=this.META_LENGTH+r.length+a.length+i.length+n.length,d=new ArrayBuffer(this.HEADER_LENGTH+c);let p=new DataView(d),m=0;p.setUint8(m++,this.KINDS.push),p.setUint8(m++,r.length),p.setUint8(m++,a.length),p.setUint8(m++,i.length),p.setUint8(m++,n.length),Array.from(r,b=>p.setUint8(m++,b.charCodeAt(0))),Array.from(a,b=>p.setUint8(m++,b.charCodeAt(0))),Array.from(i,b=>p.setUint8(m++,b.charCodeAt(0))),Array.from(n,b=>p.setUint8(m++,b.charCodeAt(0)));var x=new Uint8Array(d.byteLength+o.byteLength);return x.set(new Uint8Array(d),0),x.set(new Uint8Array(o),d.byteLength),x.buffer}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,a;const{join_ref:n,ref:i,topic:o}=t,c=t.payload.event,d=(a=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:new ArrayBuffer(0),p=this.USER_BROADCAST_PUSH_META_LENGTH+n.length+i.length+o.length+c.length,m=new ArrayBuffer(this.HEADER_LENGTH+p);let x=new DataView(m),b=0;x.setUint8(b++,this.KINDS.userBroadcastPush),x.setUint8(b++,n.length),x.setUint8(b++,i.length),x.setUint8(b++,o.length),x.setUint8(b++,c.length),x.setUint8(b++,this.BINARY_ENCODING),Array.from(n,j=>x.setUint8(b++,j.charCodeAt(0))),Array.from(i,j=>x.setUint8(b++,j.charCodeAt(0))),Array.from(o,j=>x.setUint8(b++,j.charCodeAt(0))),Array.from(c,j=>x.setUint8(b++,j.charCodeAt(0)));var h=new Uint8Array(m.byteLength+d.byteLength);return h.set(new Uint8Array(m),0),h.set(new Uint8Array(d),m.byteLength),h.buffer}_encodeJsonUserBroadcastPush(t){var r,a;const{join_ref:n,ref:i,topic:o}=t,c=t.payload.event,d=(a=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:{},m=new TextEncoder().encode(JSON.stringify(d)).buffer,x=this.USER_BROADCAST_PUSH_META_LENGTH+n.length+i.length+o.length+c.length,b=new ArrayBuffer(this.HEADER_LENGTH+x);let h=new DataView(b),j=0;h.setUint8(j++,this.KINDS.userBroadcastPush),h.setUint8(j++,n.length),h.setUint8(j++,i.length),h.setUint8(j++,o.length),h.setUint8(j++,c.length),h.setUint8(j++,this.JSON_ENCODING),Array.from(n,v=>h.setUint8(j++,v.charCodeAt(0))),Array.from(i,v=>h.setUint8(j++,v.charCodeAt(0))),Array.from(o,v=>h.setUint8(j++,v.charCodeAt(0))),Array.from(c,v=>h.setUint8(j++,v.charCodeAt(0)));var g=new Uint8Array(b.byteLength+m.byteLength);return g.set(new Uint8Array(b),0),g.set(new Uint8Array(m),b.byteLength),g.buffer}decode(t,r){if(this._isArrayBuffer(t)){let a=this._binaryDecode(t);return r(a)}if(typeof t=="string"){const a=JSON.parse(t),[n,i,o,c,d]=a;return r({join_ref:n,ref:i,topic:o,event:c,payload:d})}return r({})}_binaryDecode(t){const r=new DataView(t),a=r.getUint8(0),n=new TextDecoder;switch(a){case this.KINDS.push:return this._decodePush(t,r,n);case this.KINDS.reply:return this._decodeReply(t,r,n);case this.KINDS.broadcast:return this._decodeBroadcast(t,r,n);case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,n)}}_decodePush(t,r,a){const n=r.getUint8(1),i=r.getUint8(2),o=r.getUint8(3);let c=this.HEADER_LENGTH+this.META_LENGTH-1;const d=a.decode(t.slice(c,c+n));c=c+n;const p=a.decode(t.slice(c,c+i));c=c+i;const m=a.decode(t.slice(c,c+o));c=c+o;const x=JSON.parse(a.decode(t.slice(c,t.byteLength)));return{join_ref:d,ref:null,topic:p,event:m,payload:x}}_decodeReply(t,r,a){const n=r.getUint8(1),i=r.getUint8(2),o=r.getUint8(3),c=r.getUint8(4);let d=this.HEADER_LENGTH+this.META_LENGTH;const p=a.decode(t.slice(d,d+n));d=d+n;const m=a.decode(t.slice(d,d+i));d=d+i;const x=a.decode(t.slice(d,d+o));d=d+o;const b=a.decode(t.slice(d,d+c));d=d+c;const h=JSON.parse(a.decode(t.slice(d,t.byteLength))),j={status:b,response:h};return{join_ref:p,ref:m,topic:x,event:pi.reply,payload:j}}_decodeBroadcast(t,r,a){const n=r.getUint8(1),i=r.getUint8(2);let o=this.HEADER_LENGTH+2;const c=a.decode(t.slice(o,o+n));o=o+n;const d=a.decode(t.slice(o,o+i));o=o+i;const p=JSON.parse(a.decode(t.slice(o,t.byteLength)));return{join_ref:null,ref:null,topic:c,event:d,payload:p}}_decodeUserBroadcast(t,r,a){const n=r.getUint8(1),i=r.getUint8(2),o=r.getUint8(3),c=r.getUint8(4);let d=this.HEADER_LENGTH+4;const p=a.decode(t.slice(d,d+n));d=d+n;const m=a.decode(t.slice(d,d+i));d=d+i;const x=a.decode(t.slice(d,d+o));d=d+o;const b=t.slice(d,t.byteLength),h=c===this.JSON_ENCODING?JSON.parse(a.decode(b)):b,j={type:this.BROADCAST,event:m,payload:h};return o>0&&(j.meta=JSON.parse(x)),{join_ref:null,ref:null,topic:p,event:this.BROADCAST,payload:j}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}}class A2{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var rs;(function(s){s.abstime="abstime",s.bool="bool",s.date="date",s.daterange="daterange",s.float4="float4",s.float8="float8",s.int2="int2",s.int4="int4",s.int4range="int4range",s.int8="int8",s.int8range="int8range",s.json="json",s.jsonb="jsonb",s.money="money",s.numeric="numeric",s.oid="oid",s.reltime="reltime",s.text="text",s.time="time",s.timestamp="timestamp",s.timestamptz="timestamptz",s.timetz="timetz",s.tsrange="tsrange",s.tstzrange="tstzrange"})(rs||(rs={}));const Ay=(s,t,r={})=>{var a;const n=(a=r.skipTypes)!==null&&a!==void 0?a:[];return t?Object.keys(t).reduce((i,o)=>(i[o]=Gw(o,s,t,n),i),{}):{}},Gw=(s,t,r,a)=>{const n=t.find(c=>c.name===s),i=n==null?void 0:n.type,o=r[s];return i&&!a.includes(i)?O2(i,o):vb(o)},O2=(s,t)=>{if(s.charAt(0)==="_"){const r=s.slice(1,s.length);return Qw(t,r)}switch(s){case rs.bool:return Yw(t);case rs.float4:case rs.float8:case rs.int2:case rs.int4:case rs.int8:case rs.numeric:case rs.oid:return Jw(t);case rs.json:case rs.jsonb:return Xw(t);case rs.timestamp:return e5(t);case rs.abstime:case rs.date:case rs.daterange:case rs.int4range:case rs.int8range:case rs.money:case rs.reltime:case rs.text:case rs.time:case rs.timestamptz:case rs.timetz:case rs.tsrange:case rs.tstzrange:return vb(t);default:return vb(t)}},vb=s=>s,Yw=s=>{switch(s){case"t":return!0;case"f":return!1;default:return s}},Jw=s=>{if(typeof s=="string"){const t=parseFloat(s);if(!Number.isNaN(t))return t}return s},Xw=s=>{if(typeof s=="string")try{return JSON.parse(s)}catch(t){return console.log(`JSON parse error: ${t}`),s}return s},Qw=(s,t)=>{if(typeof s!="string")return s;const r=s.length-1,a=s[r];if(s[0]==="{"&&a==="}"){let i;const o=s.slice(1,r);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(c=>O2(t,c))}return s},e5=s=>typeof s=="string"?s.replace(" ","T"):s,D2=s=>{const t=new URL(s);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class mf{constructor(t,r,a={},n=bb){this.channel=t,this.event=r,this.payload=a,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var a;return this._hasReceived(t)&&r((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(a=>a.status===t).forEach(a=>a.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Oy;(function(s){s.SYNC="sync",s.JOIN="join",s.LEAVE="leave"})(Oy||(Oy={}));class vp{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},n=>{const{onJoin:i,onLeave:o,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=vp.syncState(this.state,n,i,o),this.pendingDiffs.forEach(d=>{this.state=vp.syncDiff(this.state,d,i,o)}),this.pendingDiffs=[],c()}),this.channel._on(a.diff,{},n=>{const{onJoin:i,onLeave:o,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=vp.syncDiff(this.state,n,i,o),c())}),this.onJoin((n,i,o)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:i,newPresences:o})}),this.onLeave((n,i,o)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,a,n){const i=this.cloneDeep(t),o=this.transformState(r),c={},d={};return this.map(i,(p,m)=>{o[p]||(d[p]=m)}),this.map(o,(p,m)=>{const x=i[p];if(x){const b=m.map(v=>v.presence_ref),h=x.map(v=>v.presence_ref),j=m.filter(v=>h.indexOf(v.presence_ref)<0),g=x.filter(v=>b.indexOf(v.presence_ref)<0);j.length>0&&(c[p]=j),g.length>0&&(d[p]=g)}else c[p]=m}),this.syncDiff(i,{joins:c,leaves:d},a,n)}static syncDiff(t,r,a,n){const{joins:i,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return a||(a=()=>{}),n||(n=()=>{}),this.map(i,(c,d)=>{var p;const m=(p=t[c])!==null&&p!==void 0?p:[];if(t[c]=this.cloneDeep(d),m.length>0){const x=t[c].map(h=>h.presence_ref),b=m.filter(h=>x.indexOf(h.presence_ref)<0);t[c].unshift(...b)}a(c,m,d)}),this.map(o,(c,d)=>{let p=t[c];if(!p)return;const m=d.map(x=>x.presence_ref);p=p.filter(x=>m.indexOf(x.presence_ref)<0),t[c]=p,n(c,p,d),p.length===0&&delete t[c]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(a=>r(a,t[a]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,a)=>{const n=t[a];return"metas"in n?r[a]=n.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[a]=n,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Dy;(function(s){s.ALL="*",s.INSERT="INSERT",s.UPDATE="UPDATE",s.DELETE="DELETE"})(Dy||(Dy={}));var yp;(function(s){s.BROADCAST="broadcast",s.PRESENCE="presence",s.POSTGRES_CHANGES="postgres_changes",s.SYSTEM="system"})(yp||(yp={}));var ol;(function(s){s.SUBSCRIBED="SUBSCRIBED",s.TIMED_OUT="TIMED_OUT",s.CLOSED="CLOSED",s.CHANNEL_ERROR="CHANNEL_ERROR"})(ol||(ol={}));class rg{constructor(t,r={config:{}},a){var n,i;if(this.topic=t,this.params=r,this.socket=a,this.bindings={},this.state=ta.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new mf(this,pi.join,this.params,this.timeout),this.rejoinTimer=new A2(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ta.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ta.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=ta.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ta.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=ta.errored,this.rejoinTimer.scheduleTimeout())}),this._on(pi.reply,{},(o,c)=>{this._trigger(this._replyEventName(c),o)}),this.presence=new vp(this),this.broadcastEndpointURL=D2(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(n=this.params.config)===null||n===void 0?void 0:n.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var a,n,i;if(this.socket.isConnected()||this.socket.connect(),this.state==ta.closed){const{config:{broadcast:o,presence:c,private:d}}=this.params,p=(n=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(h=>h.filter))!==null&&n!==void 0?n:[],m=!!this.bindings[yp.PRESENCE]&&this.bindings[yp.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,x={},b={broadcast:o,presence:Object.assign(Object.assign({},c),{enabled:m}),postgres_changes:p,private:d};this.socket.accessTokenValue&&(x.access_token=this.socket.accessTokenValue),this._onError(h=>t==null?void 0:t(ol.CHANNEL_ERROR,h)),this._onClose(()=>t==null?void 0:t(ol.CLOSED)),this.updateJoinPayload(Object.assign({config:b},x)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:h})=>{var j;if(this.socket.setAuth(),h===void 0){t==null||t(ol.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,v=(j=g==null?void 0:g.length)!==null&&j!==void 0?j:0,_=[];for(let k=0;k<v;k++){const P=g[k],{filter:{event:L,schema:F,table:W,filter:R}}=P,B=h&&h[k];if(B&&B.event===L&&B.schema===F&&B.table===W&&B.filter===R)_.push(Object.assign(Object.assign({},P),{id:B.id}));else{this.unsubscribe(),this.state=ta.errored,t==null||t(ol.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=_,t&&t(ol.SUBSCRIBED);return}}).receive("error",h=>{this.state=ta.errored,t==null||t(ol.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(h).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(ol.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,a){return this.state===ta.joined&&t===yp.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,a)}async httpSend(t,r,a={}){var n;const i=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const o={method:"POST",headers:{Authorization:i,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},c=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(n=a.timeout)!==null&&n!==void 0?n:this.timeout);if(c.status===202)return{success:!0};let d=c.statusText;try{const p=await c.json();d=p.error||p.message||d}catch{}return Promise.reject(new Error(d))}async send(t,r={}){var a,n;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:o}=t,d={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const p=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(a=r.timeout)!==null&&a!==void 0?a:this.timeout);return await((n=p.body)===null||n===void 0?void 0:n.cancel()),p.ok?"ok":"error"}catch(p){return p.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,c,d;const p=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((d=(c=(o=this.params)===null||o===void 0?void 0:o.config)===null||c===void 0?void 0:c.broadcast)===null||d===void 0)&&d.ack)&&i("ok"),p.receive("ok",()=>i("ok")),p.receive("error",()=>i("error")),p.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=ta.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(pi.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(n=>{a=new mf(this,pi.leave,{},t),a.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a==null||a.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=ta.closed,this.bindings={}}async _fetchWithTimeout(t,r,a){const n=new AbortController,i=setTimeout(()=>n.abort(),a),o=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(i),o}_push(t,r,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new mf(this,t,r,a);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>Ww){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,a){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,a){var n,i;const o=t.toLocaleLowerCase(),{close:c,error:d,leave:p,join:m}=pi;if(a&&[c,d,p,m].indexOf(o)>=0&&a!==this._joinRef())return;let b=this._onMessage(o,r,a);if(r&&!b)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(h=>{var j,g,v;return((j=h.filter)===null||j===void 0?void 0:j.event)==="*"||((v=(g=h.filter)===null||g===void 0?void 0:g.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===o}).map(h=>h.callback(b,a)):(i=this.bindings[o])===null||i===void 0||i.filter(h=>{var j,g,v,_,k,P;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in h){const L=h.id,F=(j=h.filter)===null||j===void 0?void 0:j.event;return L&&((g=r.ids)===null||g===void 0?void 0:g.includes(L))&&(F==="*"||(F==null?void 0:F.toLocaleLowerCase())===((v=r.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const L=(k=(_=h==null?void 0:h.filter)===null||_===void 0?void 0:_.event)===null||k===void 0?void 0:k.toLocaleLowerCase();return L==="*"||L===((P=r==null?void 0:r.event)===null||P===void 0?void 0:P.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===o}).map(h=>{if(typeof b=="object"&&"ids"in b){const j=b.data,{schema:g,table:v,commit_timestamp:_,type:k,errors:P}=j;b=Object.assign(Object.assign({},{schema:g,table:v,commit_timestamp:_,eventType:k,new:{},old:{},errors:P}),this._getPayloadRecords(j))}h.callback(b,a)})}_isClosed(){return this.state===ta.closed}_isJoined(){return this.state===ta.joined}_isJoining(){return this.state===ta.joining}_isLeaving(){return this.state===ta.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,a){const n=t.toLocaleLowerCase(),i={type:n,filter:r,callback:a};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(t,r){const a=t.toLocaleLowerCase();return this.bindings[a]&&(this.bindings[a]=this.bindings[a].filter(n=>{var i;return!(((i=n.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===a&&rg.isEqual(n.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const a in t)if(t[a]!==r[a])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(pi.close,{},t)}_onError(t){this._on(pi.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ta.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Ay(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Ay(t.columns,t.old_record)),r}}const hf=()=>{},Um={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},t5=[1e3,2e3,5e3,1e4],r5=1e4,s5=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class a5{constructor(t,r){var a;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=bb,this.transport=null,this.heartbeatIntervalMs=Um.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=hf,this.ref=0,this.reconnectTimer=null,this.vsn=Py,this.logger=hf,this.conn=null,this.sendBuffer=[],this.serializer=new Kw,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=n=>n?(...i)=>n(...i):(...i)=>fetch(...i),!(!((a=r==null?void 0:r.params)===null||a===void 0)&&a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${gb.websocket}`,this.httpEndpoint=D2(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=$w.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const a=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(a),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,a){this.logger(t,r,a)}connectionState(){switch(this.conn&&this.conn.readyState){case Hc.connecting:return Zc.Connecting;case Hc.open:return Zc.Open;case Hc.closing:return Zc.Closing;default:return Zc.Closed}}isConnected(){return this.connectionState()===Zc.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const a=`realtime:${t}`,n=this.getChannels().find(i=>i.topic===a);if(n)return n;{const i=new rg(`realtime:${t}`,r,this);return this.channels.push(i),i}}push(t){const{topic:r,event:a,payload:n,ref:i}=t,o=()=>{this.encode(t,c=>{var d;(d=this.conn)===null||d===void 0||d.send(c)})};this.log("push",`${r} ${a} (${i})`,n),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(Zw,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Um.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(a=>a.topic===t&&(a._isJoined()||a._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(p){this.log("error","error in heartbeat callback",p)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:a,event:n,payload:i,ref:o}=r,c=o?`(${o})`:"",d=i.status||"";this.log("receive",`${d} ${a} ${n} ${c}`.trim(),i),this.channels.filter(p=>p._isMember(a)).forEach(p=>p._trigger(n,i,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){if(this.conn){if(this.conn.readyState===Hc.open||this.conn.readyState===Hc.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(pi.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const a=t.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${t}${a}${n}`}_workerObjectUrl(t){let r;if(t)r=t;else{const a=new Blob([s5],{type:"application/javascript"});r=URL.createObjectURL(a)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(a=>{const n={access_token:r,version:Vw};r&&a.updateJoinPayload(n),a.joinedOnce&&a._isJoined()&&a._push(pi.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(a=>{try{a(r)}catch(n){this.log("error",`error in ${t} callback`,n)}})}catch(a){this.log("error",`error triggering ${t} callbacks`,a)}}_setupReconnectionTimer(){this.reconnectTimer=new A2(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Um.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,a,n,i,o,c,d,p,m,x,b,h;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(a=t==null?void 0:t.timeout)!==null&&a!==void 0?a:bb,this.heartbeatIntervalMs=(n=t==null?void 0:t.heartbeatIntervalMs)!==null&&n!==void 0?n:Um.HEARTBEAT_INTERVAL,this.worker=(i=t==null?void 0:t.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=t==null?void 0:t.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(c=t==null?void 0:t.heartbeatCallback)!==null&&c!==void 0?c:hf,this.vsn=(d=t==null?void 0:t.vsn)!==null&&d!==void 0?d:Py,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(p=t==null?void 0:t.reconnectAfterMs)!==null&&p!==void 0?p:(j=>t5[j-1]||r5),this.vsn){case P2:this.encode=(m=t==null?void 0:t.encode)!==null&&m!==void 0?m:((j,g)=>g(JSON.stringify(j))),this.decode=(x=t==null?void 0:t.decode)!==null&&x!==void 0?x:((j,g)=>g(JSON.parse(j)));break;case Hw:this.encode=(b=t==null?void 0:t.encode)!==null&&b!==void 0?b:this.serializer.encode.bind(this.serializer),this.decode=(h=t==null?void 0:t.decode)!==null&&h!==void 0?h:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class sg extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function ws(s){return typeof s=="object"&&s!==null&&"__isStorageError"in s}class n5 extends sg{constructor(t,r,a){super(t),this.name="StorageApiError",this.status=r,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class yb extends sg{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}const ag=s=>s?(...t)=>s(...t):(...t)=>fetch(...t),i5=()=>Response,jb=s=>{if(Array.isArray(s))return s.map(r=>jb(r));if(typeof s=="function"||s!==Object(s))return s;const t={};return Object.entries(s).forEach(([r,a])=>{const n=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[n]=jb(a)}),t},o5=s=>{if(typeof s!="object"||s===null)return!1;const t=Object.getPrototypeOf(s);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in s)&&!(Symbol.iterator in s)},xf=s=>{var t;return s.msg||s.message||s.error_description||(typeof s.error=="string"?s.error:(t=s.error)===null||t===void 0?void 0:t.message)||JSON.stringify(s)},l5=(s,t,r)=>Ot(void 0,void 0,void 0,function*(){const a=yield i5();s instanceof a&&!(r!=null&&r.noResolveJson)?s.json().then(n=>{const i=s.status||500,o=(n==null?void 0:n.statusCode)||i+"";t(new n5(xf(n),i,o))}).catch(n=>{t(new yb(xf(n),n))}):t(new yb(xf(s),s))}),c5=(s,t,r,a)=>{const n={method:s,headers:(t==null?void 0:t.headers)||{}};return s==="GET"||!a?n:(o5(a)?(n.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n.body=JSON.stringify(a)):n.body=a,t!=null&&t.duplex&&(n.duplex=t.duplex),Object.assign(Object.assign({},n),r))};function Zp(s,t,r,a,n,i){return Ot(this,void 0,void 0,function*(){return new Promise((o,c)=>{s(r,c5(t,a,n,i)).then(d=>{if(!d.ok)throw d;return a!=null&&a.noResolveJson?d:d.json()}).then(d=>o(d)).catch(d=>l5(d,c,a))})})}function Op(s,t,r,a){return Ot(this,void 0,void 0,function*(){return Zp(s,"GET",t,r,a)})}function $i(s,t,r,a,n){return Ot(this,void 0,void 0,function*(){return Zp(s,"POST",t,a,n,r)})}function _b(s,t,r,a,n){return Ot(this,void 0,void 0,function*(){return Zp(s,"PUT",t,a,n,r)})}function d5(s,t,r,a){return Ot(this,void 0,void 0,function*(){return Zp(s,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),a)})}function ng(s,t,r,a,n){return Ot(this,void 0,void 0,function*(){return Zp(s,"DELETE",t,a,n,r)})}class u5{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}execute(){return Ot(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ws(t))return{data:null,error:t};throw t}})}}var E2;class p5{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r,this[E2]="BlobDownloadBuilder",this.promise=null}asStream(){return new u5(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.getPromise().then(t,r)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return Ot(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ws(t))return{data:null,error:t};throw t}})}}E2=Symbol.toStringTag;const m5={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ey={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class h5{constructor(t,r={},a,n){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=a,this.fetch=ag(n)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,a,n){return Ot(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},Ey),n);let c=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const d=o.metadata;typeof Blob<"u"&&a instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),d&&i.append("metadata",this.encodeMetadata(d)),i.append("",a)):typeof FormData<"u"&&a instanceof FormData?(i=a,i.has("cacheControl")||i.append("cacheControl",o.cacheControl),d&&!i.has("metadata")&&i.append("metadata",this.encodeMetadata(d))):(i=a,c["cache-control"]=`max-age=${o.cacheControl}`,c["content-type"]=o.contentType,d&&(c["x-metadata"]=this.toBase64(this.encodeMetadata(d))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!o.duplex&&(o.duplex="half")),n!=null&&n.headers&&(c=Object.assign(Object.assign({},c),n.headers));const p=this._removeEmptyFolders(r),m=this._getFinalPath(p),x=yield(t=="PUT"?_b:$i)(this.fetch,`${this.url}/object/${m}`,i,Object.assign({headers:c},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:p,id:x.Id,fullPath:x.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(ws(i))return{data:null,error:i};throw i}})}upload(t,r,a){return Ot(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,a)})}uploadToSignedUrl(t,r,a,n){return Ot(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),o=this._getFinalPath(i),c=new URL(this.url+`/object/upload/sign/${o}`);c.searchParams.set("token",r);try{let d;const p=Object.assign({upsert:Ey.upsert},n),m=Object.assign(Object.assign({},this.headers),{"x-upsert":String(p.upsert)});typeof Blob<"u"&&a instanceof Blob?(d=new FormData,d.append("cacheControl",p.cacheControl),d.append("",a)):typeof FormData<"u"&&a instanceof FormData?(d=a,d.append("cacheControl",p.cacheControl)):(d=a,m["cache-control"]=`max-age=${p.cacheControl}`,m["content-type"]=p.contentType);const x=yield _b(this.fetch,c.toString(),d,{headers:m});return{data:{path:i,fullPath:x.Key},error:null}}catch(d){if(this.shouldThrowOnError)throw d;if(ws(d))return{data:null,error:d};throw d}})}createSignedUploadUrl(t,r){return Ot(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t);const n=Object.assign({},this.headers);r!=null&&r.upsert&&(n["x-upsert"]="true");const i=yield $i(this.fetch,`${this.url}/object/upload/sign/${a}`,{},{headers:n}),o=new URL(this.url+i.url),c=o.searchParams.get("token");if(!c)throw new sg("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:c},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ws(a))return{data:null,error:a};throw a}})}update(t,r,a){return Ot(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,a)})}move(t,r,a){return Ot(this,void 0,void 0,function*(){try{return{data:yield $i(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:a==null?void 0:a.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ws(n))return{data:null,error:n};throw n}})}copy(t,r,a){return Ot(this,void 0,void 0,function*(){try{return{data:{path:(yield $i(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:a==null?void 0:a.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ws(n))return{data:null,error:n};throw n}})}createSignedUrl(t,r,a){return Ot(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t),i=yield $i(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:r},a!=null&&a.transform?{transform:a.transform}:{}),{headers:this.headers});const o=a!=null&&a.download?`&download=${a.download===!0?"":a.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ws(n))return{data:null,error:n};throw n}})}createSignedUrls(t,r,a){return Ot(this,void 0,void 0,function*(){try{const n=yield $i(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),i=a!=null&&a.download?`&download=${a.download===!0?"":a.download}`:"";return{data:n.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ws(n))return{data:null,error:n};throw n}})}download(t,r){const n=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),o=i?`?${i}`:"",c=this._getFinalPath(t),d=()=>Op(this.fetch,`${this.url}/${n}/${c}${o}`,{headers:this.headers,noResolveJson:!0});return new p5(d,this.shouldThrowOnError)}info(t){return Ot(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const a=yield Op(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:jb(a),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ws(a))return{data:null,error:a};throw a}})}exists(t){return Ot(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield d5(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ws(a)&&a instanceof yb){const n=a.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:a}}throw a}})}getPublicUrl(t,r){const a=this._getFinalPath(t),n=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&n.push(i);const c=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",d=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});d!==""&&n.push(d);let p=n.join("&");return p!==""&&(p=`?${p}`),{data:{publicUrl:encodeURI(`${this.url}/${c}/public/${a}${p}`)}}}remove(t){return Ot(this,void 0,void 0,function*(){try{return{data:yield ng(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ws(r))return{data:null,error:r};throw r}})}list(t,r,a){return Ot(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},m5),r),{prefix:t||""});return{data:yield $i(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},a),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ws(n))return{data:null,error:n};throw n}})}listV2(t,r){return Ot(this,void 0,void 0,function*(){try{const a=Object.assign({},t);return{data:yield $i(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ws(a))return{data:null,error:a};throw a}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const I2="2.81.1",L2={"X-Client-Info":`storage-js/${I2}`};class x5{constructor(t,r={},a,n){this.shouldThrowOnError=!1;const i=new URL(t);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},L2),r),this.fetch=ag(a)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(t){return Ot(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(t);return{data:yield Op(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ws(r))return{data:null,error:r};throw r}})}getBucket(t){return Ot(this,void 0,void 0,function*(){try{return{data:yield Op(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ws(r))return{data:null,error:r};throw r}})}createBucket(t){return Ot(this,arguments,void 0,function*(r,a={public:!1}){try{return{data:yield $i(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:a.type,public:a.public,file_size_limit:a.fileSizeLimit,allowed_mime_types:a.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ws(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return Ot(this,void 0,void 0,function*(){try{return{data:yield _b(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ws(a))return{data:null,error:a};throw a}})}emptyBucket(t){return Ot(this,void 0,void 0,function*(){try{return{data:yield $i(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ws(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Ot(this,void 0,void 0,function*(){try{return{data:yield ng(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ws(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(t){const r={};return t&&("limit"in t&&(r.limit=String(t.limit)),"offset"in t&&(r.offset=String(t.offset)),t.search&&(r.search=t.search),t.sortColumn&&(r.sortColumn=t.sortColumn),t.sortOrder&&(r.sortOrder=t.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}class f5{constructor(t,r={},a){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},L2),r),this.fetch=ag(a)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return Ot(this,void 0,void 0,function*(){try{return{data:yield $i(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ws(r))return{data:null,error:r};throw r}})}listBuckets(t){return Ot(this,void 0,void 0,function*(){try{const r=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&r.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&r.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&r.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&r.set("sortOrder",t.sortOrder),t!=null&&t.search&&r.set("search",t.search);const a=r.toString(),n=a?`${this.url}/bucket?${a}`:`${this.url}/bucket`;return{data:yield Op(this.fetch,n,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ws(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Ot(this,void 0,void 0,function*(){try{return{data:yield ng(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ws(r))return{data:null,error:r};throw r}})}}const ig={"X-Client-Info":`storage-js/${I2}`,"Content-Type":"application/json"};class T2 extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Vn(s){return typeof s=="object"&&s!==null&&"__isStorageVectorsError"in s}class ff extends T2{constructor(t,r,a){super(t),this.name="StorageVectorsApiError",this.status=r,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class b5 extends T2{constructor(t,r){super(t),this.name="StorageVectorsUnknownError",this.originalError=r}}var Iy;(function(s){s.InternalError="InternalError",s.S3VectorConflictException="S3VectorConflictException",s.S3VectorNotFoundException="S3VectorNotFoundException",s.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",s.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",s.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(Iy||(Iy={}));const og=s=>s?(...t)=>s(...t):(...t)=>fetch(...t),g5=s=>{if(typeof s!="object"||s===null)return!1;const t=Object.getPrototypeOf(s);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in s)&&!(Symbol.iterator in s)},Ly=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),v5=(s,t,r)=>Ot(void 0,void 0,void 0,function*(){if(s&&typeof s=="object"&&"status"in s&&"ok"in s&&typeof s.status=="number"&&!(r!=null&&r.noResolveJson)){const n=s.status||500,i=s;if(typeof i.json=="function")i.json().then(o=>{const c=(o==null?void 0:o.statusCode)||(o==null?void 0:o.code)||n+"";t(new ff(Ly(o),n,c))}).catch(()=>{const o=n+"",c=i.statusText||`HTTP ${n} error`;t(new ff(c,n,o))});else{const o=n+"",c=i.statusText||`HTTP ${n} error`;t(new ff(c,n,o))}}else t(new b5(Ly(s),s))}),y5=(s,t,r,a)=>{const n={method:s,headers:(t==null?void 0:t.headers)||{}};return a?(g5(a)?(n.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n.body=JSON.stringify(a)):n.body=a,Object.assign(Object.assign({},n),r)):n};function j5(s,t,r,a,n,i){return Ot(this,void 0,void 0,function*(){return new Promise((o,c)=>{s(r,y5(t,a,n,i)).then(d=>{if(!d.ok)throw d;if(a!=null&&a.noResolveJson)return d;const p=d.headers.get("content-type");return!p||!p.includes("application/json")?{}:d.json()}).then(d=>o(d)).catch(d=>v5(d,c,a))})})}function Hn(s,t,r,a,n){return Ot(this,void 0,void 0,function*(){return j5(s,"POST",t,a,n,r)})}class _5{constructor(t,r={},a){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},ig),r),this.fetch=og(a)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return Ot(this,void 0,void 0,function*(){try{return{data:(yield Hn(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Vn(r))return{data:null,error:r};throw r}})}getIndex(t,r){return Ot(this,void 0,void 0,function*(){try{return{data:yield Hn(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Vn(a))return{data:null,error:a};throw a}})}listIndexes(t){return Ot(this,void 0,void 0,function*(){try{return{data:yield Hn(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Vn(r))return{data:null,error:r};throw r}})}deleteIndex(t,r){return Ot(this,void 0,void 0,function*(){try{return{data:(yield Hn(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}))||{},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Vn(a))return{data:null,error:a};throw a}})}}class k5{constructor(t,r={},a){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},ig),r),this.fetch=og(a)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return Ot(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield Hn(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Vn(r))return{data:null,error:r};throw r}})}getVectors(t){return Ot(this,void 0,void 0,function*(){try{return{data:yield Hn(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Vn(r))return{data:null,error:r};throw r}})}listVectors(t){return Ot(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield Hn(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Vn(r))return{data:null,error:r};throw r}})}queryVectors(t){return Ot(this,void 0,void 0,function*(){try{return{data:yield Hn(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Vn(r))return{data:null,error:r};throw r}})}deleteVectors(t){return Ot(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield Hn(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Vn(r))return{data:null,error:r};throw r}})}}class N5{constructor(t,r={},a){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},ig),r),this.fetch=og(a)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return Ot(this,void 0,void 0,function*(){try{return{data:(yield Hn(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Vn(r))return{data:null,error:r};throw r}})}getBucket(t){return Ot(this,void 0,void 0,function*(){try{return{data:yield Hn(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Vn(r))return{data:null,error:r};throw r}})}listBuckets(){return Ot(this,arguments,void 0,function*(t={}){try{return{data:yield Hn(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Vn(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Ot(this,void 0,void 0,function*(){try{return{data:(yield Hn(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Vn(r))return{data:null,error:r};throw r}})}}class w5 extends N5{constructor(t,r={}){super(t,r.headers||{},r.fetch)}from(t){return new S5(this.url,this.headers,t,this.fetch)}}class S5 extends _5{constructor(t,r,a,n){super(t,r,n),this.vectorBucketName=a}createIndex(t){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return Ot(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return Ot(this,arguments,void 0,function*(r={}){return t.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return Ot(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return Ot(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new z5(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class z5 extends k5{constructor(t,r,a,n,i){super(t,r,i),this.vectorBucketName=a,this.indexName=n}putVectors(t){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return Ot(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return Ot(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return Ot(this,arguments,void 0,function*(r={}){return t.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return Ot(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return Ot(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class C5 extends x5{constructor(t,r={},a,n){super(t,r,a,n)}from(t){return new h5(this.url,this.headers,t,this.fetch)}get vectors(){return new w5(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new f5(this.url+"/iceberg",this.headers,this.fetch)}}const P5="2.81.1";let cp="";typeof Deno<"u"?cp="deno":typeof document<"u"?cp="web":typeof navigator<"u"&&navigator.product==="ReactNative"?cp="react-native":cp="node";const A5={"X-Client-Info":`supabase-js-${cp}/${P5}`},O5={headers:A5},D5={schema:"public"},E5={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},I5={},L5=s=>s?(...t)=>s(...t):(...t)=>fetch(...t),T5=()=>Headers,R5=(s,t,r)=>{const a=L5(r),n=T5();return async(i,o)=>{var c;const d=(c=await t())!==null&&c!==void 0?c:s;let p=new n(o==null?void 0:o.headers);return p.has("apikey")||p.set("apikey",s),p.has("Authorization")||p.set("Authorization",`Bearer ${d}`),a(i,Object.assign(Object.assign({},o),{headers:p}))}};function M5(s){return s.endsWith("/")?s:s+"/"}function F5(s,t){var r,a;const{db:n,auth:i,realtime:o,global:c}=s,{db:d,auth:p,realtime:m,global:x}=t,b={db:Object.assign(Object.assign({},d),n),auth:Object.assign(Object.assign({},p),i),realtime:Object.assign(Object.assign({},m),o),storage:{},global:Object.assign(Object.assign(Object.assign({},x),c),{headers:Object.assign(Object.assign({},(r=x==null?void 0:x.headers)!==null&&r!==void 0?r:{}),(a=c==null?void 0:c.headers)!==null&&a!==void 0?a:{})}),accessToken:async()=>""};return s.accessToken?b.accessToken=s.accessToken:delete b.accessToken,b}function U5(s){const t=s==null?void 0:s.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(M5(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const R2="2.81.1",ru=30*1e3,kb=3,bf=kb*ru,q5="http://localhost:9999",$5="supabase.auth.token",B5={"X-Client-Info":`gotrue-js/${R2}`},Nb="X-Supabase-Api-Version",M2={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},V5=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,H5=600*1e3;class Dp extends Error{constructor(t,r,a){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=a}}function Lt(s){return typeof s=="object"&&s!==null&&"__isAuthError"in s}class Z5 extends Dp{constructor(t,r,a){super(t,r,a),this.name="AuthApiError",this.status=r,this.code=a}}function W5(s){return Lt(s)&&s.name==="AuthApiError"}class Wc extends Dp{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class lc extends Dp{constructor(t,r,a,n){super(t,a,n),this.name=r,this.status=a}}class Ui extends lc{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function K5(s){return Lt(s)&&s.name==="AuthSessionMissingError"}class Hd extends lc{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class qm extends lc{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class $m extends lc{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function G5(s){return Lt(s)&&s.name==="AuthImplicitGrantRedirectError"}class Ty extends lc{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class wb extends lc{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function gf(s){return Lt(s)&&s.name==="AuthRetryableFetchError"}class Ry extends lc{constructor(t,r,a){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=a}}class Sb extends lc{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ah="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),My=` 	
\r=`.split(""),Y5=(()=>{const s=new Array(128);for(let t=0;t<s.length;t+=1)s[t]=-1;for(let t=0;t<My.length;t+=1)s[My[t].charCodeAt(0)]=-2;for(let t=0;t<Ah.length;t+=1)s[Ah[t].charCodeAt(0)]=t;return s})();function Fy(s,t,r){if(s!==null)for(t.queue=t.queue<<8|s,t.queuedBits+=8;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;r(Ah[a]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;r(Ah[a]),t.queuedBits-=6}}function F2(s,t,r){const a=Y5[s];if(a>-1)for(t.queue=t.queue<<6|a,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(s)}"`)}}function Uy(s){const t=[],r=o=>{t.push(String.fromCodePoint(o))},a={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},i=o=>{Q5(o,a,r)};for(let o=0;o<s.length;o+=1)F2(s.charCodeAt(o),n,i);return t.join("")}function J5(s,t){if(s<=127){t(s);return}else if(s<=2047){t(192|s>>6),t(128|s&63);return}else if(s<=65535){t(224|s>>12),t(128|s>>6&63),t(128|s&63);return}else if(s<=1114111){t(240|s>>18),t(128|s>>12&63),t(128|s>>6&63),t(128|s&63);return}throw new Error(`Unrecognized Unicode codepoint: ${s.toString(16)}`)}function X5(s,t){for(let r=0;r<s.length;r+=1){let a=s.charCodeAt(r);if(a>55295&&a<=56319){const n=(a-55296)*1024&65535;a=(s.charCodeAt(r+1)-56320&65535|n)+65536,r+=1}J5(a,t)}}function Q5(s,t,r){if(t.utf8seq===0){if(s<=127){r(s);return}for(let a=1;a<6;a+=1)if((s>>7-a&1)===0){t.utf8seq=a;break}if(t.utf8seq===2)t.codepoint=s&31;else if(t.utf8seq===3)t.codepoint=s&15;else if(t.utf8seq===4)t.codepoint=s&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(s<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|s&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function ou(s){const t=[],r={queue:0,queuedBits:0},a=n=>{t.push(n)};for(let n=0;n<s.length;n+=1)F2(s.charCodeAt(n),r,a);return new Uint8Array(t)}function e4(s){const t=[];return X5(s,r=>t.push(r)),new Uint8Array(t)}function Gc(s){const t=[],r={queue:0,queuedBits:0},a=n=>{t.push(n)};return s.forEach(n=>Fy(n,r,a)),Fy(null,r,a),t.join("")}function t4(s){return Math.round(Date.now()/1e3)+s}function r4(){return Symbol("auth-callback")}const ya=()=>typeof window<"u"&&typeof document<"u",Rc={tested:!1,writable:!1},U2=()=>{if(!ya())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Rc.tested)return Rc.writable;const s=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(s,s),globalThis.localStorage.removeItem(s),Rc.tested=!0,Rc.writable=!0}catch{Rc.tested=!0,Rc.writable=!1}return Rc.writable};function s4(s){const t={},r=new URL(s);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,i)=>{t[i]=n})}catch{}return r.searchParams.forEach((a,n)=>{t[n]=a}),t}const q2=s=>s?(...t)=>s(...t):(...t)=>fetch(...t),a4=s=>typeof s=="object"&&s!==null&&"status"in s&&"ok"in s&&"json"in s&&typeof s.json=="function",su=async(s,t,r)=>{await s.setItem(t,JSON.stringify(r))},Mc=async(s,t)=>{const r=await s.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Zl=async(s,t)=>{await s.removeItem(t)};class tx{constructor(){this.promise=new tx.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}tx.promiseConstructor=Promise;function vf(s){const t=s.split(".");if(t.length!==3)throw new Sb("Invalid JWT structure");for(let a=0;a<t.length;a++)if(!V5.test(t[a]))throw new Sb("JWT not in base64url format");return{header:JSON.parse(Uy(t[0])),payload:JSON.parse(Uy(t[1])),signature:ou(t[2]),raw:{header:t[0],payload:t[1]}}}async function n4(s){return await new Promise(t=>{setTimeout(()=>t(null),s)})}function i4(s,t){return new Promise((a,n)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await s(i);if(!t(i,null,o)){a(o);return}}catch(o){if(!t(i,o)){n(o);return}}})()})}function o4(s){return("0"+s.toString(16)).substr(-2)}function l4(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=r.length;let n="";for(let i=0;i<56;i++)n+=r.charAt(Math.floor(Math.random()*a));return n}return crypto.getRandomValues(t),Array.from(t,o4).join("")}async function c4(s){const r=new TextEncoder().encode(s),a=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(a);return Array.from(n).map(i=>String.fromCharCode(i)).join("")}async function d4(s){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),s;const r=await c4(s);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Zd(s,t,r=!1){const a=l4();let n=a;r&&(n+="/PASSWORD_RECOVERY"),await su(s,`${t}-code-verifier`,n);const i=await d4(a);return[i,a===i?"plain":"s256"]}const u4=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function p4(s){const t=s.headers.get(Nb);if(!t||!t.match(u4))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function m4(s){if(!s)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(s<=t)throw new Error("JWT has expired")}function h4(s){switch(s){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const x4=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Wd(s){if(!x4.test(s))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function yf(){const s={};return new Proxy(s,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const a=r.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function f4(s,t){return new Proxy(s,{get:(r,a,n)=>{if(a==="__isInsecureUserWarningProxy")return!0;if(typeof a=="symbol"){const i=a.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,a,n)}return!t.value&&typeof a=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,a,n)}})}function qy(s){return JSON.parse(JSON.stringify(s))}const $c=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),b4=[502,503,504];async function $y(s){var t;if(!a4(s))throw new wb($c(s),0);if(b4.includes(s.status))throw new wb($c(s),s.status);let r;try{r=await s.json()}catch(i){throw new Wc($c(i),i)}let a;const n=p4(s);if(n&&n.getTime()>=M2["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?a=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(a=r.error_code),a){if(a==="weak_password")throw new Ry($c(r),s.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(a==="session_not_found")throw new Ui}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new Ry($c(r),s.status,r.weak_password.reasons);throw new Z5($c(r),s.status||500,a)}const g4=(s,t,r,a)=>{const n={method:s,headers:(t==null?void 0:t.headers)||{}};return s==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),n.body=JSON.stringify(a),Object.assign(Object.assign({},n),r))};async function Yt(s,t,r,a){var n;const i=Object.assign({},a==null?void 0:a.headers);i[Nb]||(i[Nb]=M2["2024-01-01"].name),a!=null&&a.jwt&&(i.Authorization=`Bearer ${a.jwt}`);const o=(n=a==null?void 0:a.query)!==null&&n!==void 0?n:{};a!=null&&a.redirectTo&&(o.redirect_to=a.redirectTo);const c=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",d=await v4(s,t,r+c,{headers:i,noResolveJson:a==null?void 0:a.noResolveJson},{},a==null?void 0:a.body);return a!=null&&a.xform?a==null?void 0:a.xform(d):{data:Object.assign({},d),error:null}}async function v4(s,t,r,a,n,i){const o=g4(t,a,n,i);let c;try{c=await s(r,Object.assign({},o))}catch(d){throw console.error(d),new wb($c(d),0)}if(c.ok||await $y(c),a!=null&&a.noResolveJson)return c;try{return await c.json()}catch(d){await $y(d)}}function qi(s){var t;let r=null;_4(s)&&(r=Object.assign({},s),s.expires_at||(r.expires_at=t4(s.expires_in)));const a=(t=s.user)!==null&&t!==void 0?t:s;return{data:{session:r,user:a},error:null}}function By(s){const t=qi(s);return!t.error&&s.weak_password&&typeof s.weak_password=="object"&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.message&&typeof s.weak_password.message=="string"&&s.weak_password.reasons.reduce((r,a)=>r&&typeof a=="string",!0)&&(t.data.weak_password=s.weak_password),t}function Xl(s){var t;return{data:{user:(t=s.user)!==null&&t!==void 0?t:s},error:null}}function y4(s){return{data:s,error:null}}function j4(s){const{action_link:t,email_otp:r,hashed_token:a,redirect_to:n,verification_type:i}=s,o=vu(s,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:t,email_otp:r,hashed_token:a,redirect_to:n,verification_type:i},d=Object.assign({},o);return{data:{properties:c,user:d},error:null}}function Vy(s){return s}function _4(s){return s.access_token&&s.refresh_token&&s.expires_in}const jf=["global","local","others"];class k4{constructor({url:t="",headers:r={},fetch:a}){this.url=t,this.headers=r,this.fetch=q2(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=jf[0]){if(jf.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${jf.join(", ")}`);try{return await Yt(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(a){if(Lt(a))return{data:null,error:a};throw a}}async inviteUserByEmail(t,r={}){try{return await Yt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Xl})}catch(a){if(Lt(a))return{data:{user:null},error:a};throw a}}async generateLink(t){try{const{options:r}=t,a=vu(t,["options"]),n=Object.assign(Object.assign({},a),r);return"newEmail"in a&&(n.new_email=a==null?void 0:a.newEmail,delete n.newEmail),await Yt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:j4,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Lt(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Yt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Xl})}catch(r){if(Lt(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,a,n,i,o,c,d;try{const p={nextPage:null,lastPage:0,total:0},m=await Yt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(i=(n=t==null?void 0:t.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:Vy});if(m.error)throw m.error;const x=await m.json(),b=(o=m.headers.get("x-total-count"))!==null&&o!==void 0?o:0,h=(d=(c=m.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&d!==void 0?d:[];return h.length>0&&(h.forEach(j=>{const g=parseInt(j.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(j.split(";")[1].split("=")[1]);p[`${v}Page`]=g}),p.total=parseInt(b)),{data:Object.assign(Object.assign({},x),p),error:null}}catch(p){if(Lt(p))return{data:{users:[]},error:p};throw p}}async getUserById(t){Wd(t);try{return await Yt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Xl})}catch(r){if(Lt(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Wd(t);try{return await Yt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Xl})}catch(a){if(Lt(a))return{data:{user:null},error:a};throw a}}async deleteUser(t,r=!1){Wd(t);try{return await Yt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Xl})}catch(a){if(Lt(a))return{data:{user:null},error:a};throw a}}async _listFactors(t){Wd(t.userId);try{const{data:r,error:a}=await Yt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:a}}catch(r){if(Lt(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Wd(t.userId),Wd(t.id);try{return{data:await Yt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Lt(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,a,n,i,o,c,d;try{const p={nextPage:null,lastPage:0,total:0},m=await Yt(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(i=(n=t==null?void 0:t.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:Vy});if(m.error)throw m.error;const x=await m.json(),b=(o=m.headers.get("x-total-count"))!==null&&o!==void 0?o:0,h=(d=(c=m.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&d!==void 0?d:[];return h.length>0&&(h.forEach(j=>{const g=parseInt(j.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(j.split(";")[1].split("=")[1]);p[`${v}Page`]=g}),p.total=parseInt(b)),{data:Object.assign(Object.assign({},x),p),error:null}}catch(p){if(Lt(p))return{data:{clients:[]},error:p};throw p}}async _createOAuthClient(t){try{return await Yt(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Lt(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await Yt(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Lt(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await Yt(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(Lt(a))return{data:null,error:a};throw a}}async _deleteOAuthClient(t){try{return await Yt(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Lt(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await Yt(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Lt(r))return{data:null,error:r};throw r}}}function Hy(s={}){return{getItem:t=>s[t]||null,setItem:(t,r)=>{s[t]=r},removeItem:t=>{delete s[t]}}}const Kd={debug:!!(globalThis&&U2()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class $2 extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class N4 extends $2{}async function w4(s,t,r){Kd.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",s,t);const a=new globalThis.AbortController;return t>0&&setTimeout(()=>{a.abort(),Kd.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",s)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(s,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async n=>{if(n){Kd.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",s,n.name);try{return await r()}finally{Kd.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",s,n.name)}}else{if(t===0)throw Kd.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",s),new N4(`Acquiring an exclusive Navigator LockManager lock "${s}" immediately failed`);if(Kd.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function S4(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function B2(s){if(!/^0x[a-fA-F0-9]{40}$/.test(s))throw new Error(`@supabase/auth-js: Address "${s}" is invalid.`);return s.toLowerCase()}function z4(s){return parseInt(s,16)}function C4(s){const t=new TextEncoder().encode(s);return"0x"+Array.from(t,a=>a.toString(16).padStart(2,"0")).join("")}function P4(s){var t;const{chainId:r,domain:a,expirationTime:n,issuedAt:i=new Date,nonce:o,notBefore:c,requestId:d,resources:p,scheme:m,uri:x,version:b}=s;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!a)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!x)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(b!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${b}`);if(!((t=s.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${s.statement}`)}const h=B2(s.address),j=m?`${m}://${a}`:a,g=s.statement?`${s.statement}
`:"",v=`${j} wants you to sign in with your Ethereum account:
${h}

${g}`;let _=`URI: ${x}
Version: ${b}
Chain ID: ${r}${o?`
Nonce: ${o}`:""}
Issued At: ${i.toISOString()}`;if(n&&(_+=`
Expiration Time: ${n.toISOString()}`),c&&(_+=`
Not Before: ${c.toISOString()}`),d&&(_+=`
Request ID: ${d}`),p){let k=`
Resources:`;for(const P of p){if(!P||typeof P!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${P}`);k+=`
- ${P}`}_+=k}return`${v}
${_}`}class Ks extends Error{constructor({message:t,code:r,cause:a,name:n}){var i;super(t,{cause:a}),this.__isWebAuthnError=!0,this.name=(i=n??(a instanceof Error?a.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=r}}class Oh extends Ks{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function A4({error:s,options:t}){var r,a,n;const{publicKey:i}=t;if(!i)throw Error("options was missing required publicKey property");if(s.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Ks({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:s})}else if(s.name==="ConstraintError"){if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Ks({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:s});if(t.mediation==="conditional"&&((a=i.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Ks({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:s});if(((n=i.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Ks({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:s})}else{if(s.name==="InvalidStateError")return new Ks({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:s});if(s.name==="NotAllowedError")return new Ks({message:s.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s});if(s.name==="NotSupportedError")return i.pubKeyCredParams.filter(c=>c.type==="public-key").length===0?new Ks({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:s}):new Ks({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:s});if(s.name==="SecurityError"){const o=window.location.hostname;if(V2(o)){if(i.rp.id!==o)return new Ks({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:s})}else return new Ks({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:s})}else if(s.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new Ks({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:s})}else if(s.name==="UnknownError")return new Ks({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:s})}return new Ks({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s})}function O4({error:s,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(s.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Ks({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:s})}else{if(s.name==="NotAllowedError")return new Ks({message:s.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s});if(s.name==="SecurityError"){const a=window.location.hostname;if(V2(a)){if(r.rpId!==a)return new Ks({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:s})}else return new Ks({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:s})}else if(s.name==="UnknownError")return new Ks({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:s})}return new Ks({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s})}class D4{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const E4=new D4;function I4(s){if(!s)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(s);const{challenge:t,user:r,excludeCredentials:a}=s,n=vu(s,["challenge","user","excludeCredentials"]),i=ou(t).buffer,o=Object.assign(Object.assign({},r),{id:ou(r.id).buffer}),c=Object.assign(Object.assign({},n),{challenge:i,user:o});if(a&&a.length>0){c.excludeCredentials=new Array(a.length);for(let d=0;d<a.length;d++){const p=a[d];c.excludeCredentials[d]=Object.assign(Object.assign({},p),{id:ou(p.id).buffer,type:p.type||"public-key",transports:p.transports})}}return c}function L4(s){if(!s)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(s);const{challenge:t,allowCredentials:r}=s,a=vu(s,["challenge","allowCredentials"]),n=ou(t).buffer,i=Object.assign(Object.assign({},a),{challenge:n});if(r&&r.length>0){i.allowCredentials=new Array(r.length);for(let o=0;o<r.length;o++){const c=r[o];i.allowCredentials[o]=Object.assign(Object.assign({},c),{id:ou(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return i}function T4(s){var t;if("toJSON"in s&&typeof s.toJSON=="function")return s.toJSON();const r=s;return{id:s.id,rawId:s.id,response:{attestationObject:Gc(new Uint8Array(s.response.attestationObject)),clientDataJSON:Gc(new Uint8Array(s.response.clientDataJSON))},type:"public-key",clientExtensionResults:s.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function R4(s){var t;if("toJSON"in s&&typeof s.toJSON=="function")return s.toJSON();const r=s,a=s.getClientExtensionResults(),n=s.response;return{id:s.id,rawId:s.id,response:{authenticatorData:Gc(new Uint8Array(n.authenticatorData)),clientDataJSON:Gc(new Uint8Array(n.clientDataJSON)),signature:Gc(new Uint8Array(n.signature)),userHandle:n.userHandle?Gc(new Uint8Array(n.userHandle)):void 0},type:"public-key",clientExtensionResults:a,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function V2(s){return s==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(s)}function Zy(){var s,t;return!!(ya()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((s=navigator==null?void 0:navigator.credentials)===null||s===void 0?void 0:s.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function M4(s){try{const t=await navigator.credentials.create(s);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Oh("Browser returned unexpected credential type",t)}:{data:null,error:new Oh("Empty credential response",t)}}catch(t){return{data:null,error:A4({error:t,options:s})}}}async function F4(s){try{const t=await navigator.credentials.get(s);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Oh("Browser returned unexpected credential type",t)}:{data:null,error:new Oh("Empty credential response",t)}}catch(t){return{data:null,error:O4({error:t,options:s})}}}const U4={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},q4={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Dh(...s){const t=n=>n!==null&&typeof n=="object"&&!Array.isArray(n),r=n=>n instanceof ArrayBuffer||ArrayBuffer.isView(n),a={};for(const n of s)if(n)for(const i in n){const o=n[i];if(o!==void 0)if(Array.isArray(o))a[i]=o;else if(r(o))a[i]=o;else if(t(o)){const c=a[i];t(c)?a[i]=Dh(c,o):a[i]=Dh(o)}else a[i]=o}return a}function $4(s,t){return Dh(U4,s,t||{})}function B4(s,t){return Dh(q4,s,t||{})}class V4{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:a,signal:n},i){try{const{data:o,error:c}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!o)return{data:null,error:c};const d=n??E4.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:p}=o.webauthn.credential_options.publicKey;p.name||(p.name=`${p.id}:${a}`),p.displayName||(p.displayName=p.name)}switch(o.webauthn.type){case"create":{const p=$4(o.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:m,error:x}=await M4({publicKey:p,signal:d});return m?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:m}},error:null}:{data:null,error:x}}case"request":{const p=B4(o.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:m,error:x}=await F4(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:p,signal:d}));return m?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:m}},error:null}:{data:null,error:x}}}}catch(o){return Lt(o)?{data:null,error:o}:{data:null,error:new Wc("Unexpected error in challenge",o)}}}async _verify({challengeId:t,factorId:r,webauthn:a}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:a})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},i){if(!r)return{data:null,error:new Dp("rpId is required for WebAuthn authentication")};try{if(!Zy())return{data:null,error:new Wc("Browser does not support WebAuthn",null)};const{data:o,error:c}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:a},signal:n},{request:i});if(!o)return{data:null,error:c};const{webauthn:d}=o;return this._verify({factorId:t,challengeId:o.challengeId,webauthn:{type:d.type,rpId:r,rpOrigins:a,credential_response:d.credential_response}})}catch(o){return Lt(o)?{data:null,error:o}:{data:null,error:new Wc("Unexpected error in authenticate",o)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},i){if(!r)return{data:null,error:new Dp("rpId is required for WebAuthn registration")};try{if(!Zy())return{data:null,error:new Wc("Browser does not support WebAuthn",null)};const{data:o,error:c}=await this._enroll({friendlyName:t});if(!o)return await this.client.mfa.listFactors().then(m=>{var x;return(x=m.data)===null||x===void 0?void 0:x.all.find(b=>b.factor_type==="webauthn"&&b.friendly_name===t&&b.status!=="unverified")}).then(m=>m?this.client.mfa.unenroll({factorId:m==null?void 0:m.id}):void 0),{data:null,error:c};const{data:d,error:p}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:r,rpOrigins:a},signal:n},{create:i});return d?this._verify({factorId:o.id,challengeId:d.challengeId,webauthn:{rpId:r,rpOrigins:a,type:d.webauthn.type,credential_response:d.webauthn.credential_response}}):{data:null,error:p}}catch(o){return Lt(o)?{data:null,error:o}:{data:null,error:new Wc("Unexpected error in register",o)}}}}S4();const H4={url:q5,storageKey:$5,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:B5,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function Wy(s,t,r){return await r()}const Gd={};class Ep{get jwks(){var t,r;return(r=(t=Gd[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Gd[this.storageKey]=Object.assign(Object.assign({},Gd[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Gd[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Gd[this.storageKey]=Object.assign(Object.assign({},Gd[this.storageKey]),{cachedAt:t})}constructor(t){var r,a,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},H4),t);if(this.storageKey=i.storageKey,this.instanceID=(r=Ep.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,Ep.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&ya()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new k4({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=q2(i.fetch),this.lock=i.lock||Wy,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,i.lock?this.lock=i.lock:ya()&&(!((a=globalThis==null?void 0:globalThis.navigator)===null||a===void 0)&&a.locks)?this.lock=w4:this.lock=Wy,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new V4(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:U2()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Hy(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=Hy(this.memoryStorage)),ya()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${R2}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},a="none";if(ya()&&(r=s4(window.location.href),this._isImplicitGrantCallback(r)?a="implicit":await this._isPKCECallback(r)&&(a="pkce")),ya()&&this.detectSessionInUrl&&a!=="none"){const{data:n,error:i}=await this._getSessionFromURL(r,a);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),G5(i)){const d=(t=i.details)===null||t===void 0?void 0:t.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:c}=n;return this._debug("#_initialize()","detected session in URL",o,"redirect type",c),await this._saveSession(o),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Lt(r)?this._returnResult({error:r}):this._returnResult({error:new Wc("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,a,n;try{const i=await Yt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.captchaToken}},xform:qi}),{data:o,error:c}=i;if(c||!o)return this._returnResult({data:{user:null,session:null},error:c});const d=o.session,p=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:p,session:d},error:null})}catch(i){if(Lt(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(t){var r,a,n;try{let i;if("email"in t){const{email:m,password:x,options:b}=t;let h=null,j=null;this.flowType==="pkce"&&([h,j]=await Zd(this.storage,this.storageKey)),i=await Yt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:b==null?void 0:b.emailRedirectTo,body:{email:m,password:x,data:(r=b==null?void 0:b.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:b==null?void 0:b.captchaToken},code_challenge:h,code_challenge_method:j},xform:qi})}else if("phone"in t){const{phone:m,password:x,options:b}=t;i=await Yt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:m,password:x,data:(a=b==null?void 0:b.data)!==null&&a!==void 0?a:{},channel:(n=b==null?void 0:b.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:b==null?void 0:b.captchaToken}},xform:qi})}else throw new qm("You must provide either an email or phone number and a password");const{data:o,error:c}=i;if(c||!o)return this._returnResult({data:{user:null,session:null},error:c});const d=o.session,p=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:p,session:d},error:null})}catch(i){if(Lt(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:o,options:c}=t;r=await Yt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:By})}else if("phone"in t){const{phone:i,password:o,options:c}=t;r=await Yt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:By})}else throw new qm("You must provide either an email or phone number and a password");const{data:a,error:n}=r;if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!a||!a.session||!a.user){const i=new Hd;return this._returnResult({data:{user:null,session:null},error:i})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:n})}catch(r){if(Lt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,a,n,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(a=t.options)===null||a===void 0?void 0:a.scopes,queryParams:(n=t.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,a,n,i,o,c,d,p,m,x,b;let h,j;if("message"in t)h=t.message,j=t.signature;else{const{chain:g,wallet:v,statement:_,options:k}=t;let P;if(ya())if(typeof v=="object")P=v;else{const A=window;if("ethereum"in A&&typeof A.ethereum=="object"&&"request"in A.ethereum&&typeof A.ethereum.request=="function")P=A.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(k!=null&&k.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");P=v}const L=new URL((r=k==null?void 0:k.url)!==null&&r!==void 0?r:window.location.href),F=await P.request({method:"eth_requestAccounts"}).then(A=>A).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!F||F.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const W=B2(F[0]);let R=(a=k==null?void 0:k.signInWithEthereum)===null||a===void 0?void 0:a.chainId;if(!R){const A=await P.request({method:"eth_chainId"});R=z4(A)}const B={domain:L.host,address:W,statement:_,uri:L.href,version:"1",chainId:R,nonce:(n=k==null?void 0:k.signInWithEthereum)===null||n===void 0?void 0:n.nonce,issuedAt:(o=(i=k==null?void 0:k.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(c=k==null?void 0:k.signInWithEthereum)===null||c===void 0?void 0:c.expirationTime,notBefore:(d=k==null?void 0:k.signInWithEthereum)===null||d===void 0?void 0:d.notBefore,requestId:(p=k==null?void 0:k.signInWithEthereum)===null||p===void 0?void 0:p.requestId,resources:(m=k==null?void 0:k.signInWithEthereum)===null||m===void 0?void 0:m.resources};h=P4(B),j=await P.request({method:"personal_sign",params:[C4(h),W]})}try{const{data:g,error:v}=await Yt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:h,signature:j},!((x=t.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(b=t.options)===null||b===void 0?void 0:b.captchaToken}}:null),xform:qi});if(v)throw v;if(!g||!g.session||!g.user){const _=new Hd;return this._returnResult({data:{user:null,session:null},error:_})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:v})}catch(g){if(Lt(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async signInWithSolana(t){var r,a,n,i,o,c,d,p,m,x,b,h;let j,g;if("message"in t)j=t.message,g=t.signature;else{const{chain:v,wallet:_,statement:k,options:P}=t;let L;if(ya())if(typeof _=="object")L=_;else{const W=window;if("solana"in W&&typeof W.solana=="object"&&("signIn"in W.solana&&typeof W.solana.signIn=="function"||"signMessage"in W.solana&&typeof W.solana.signMessage=="function"))L=W.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof _!="object"||!(P!=null&&P.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");L=_}const F=new URL((r=P==null?void 0:P.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in L&&L.signIn){const W=await L.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},P==null?void 0:P.signInWithSolana),{version:"1",domain:F.host,uri:F.href}),k?{statement:k}:null));let R;if(Array.isArray(W)&&W[0]&&typeof W[0]=="object")R=W[0];else if(W&&typeof W=="object"&&"signedMessage"in W&&"signature"in W)R=W;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in R&&"signature"in R&&(typeof R.signedMessage=="string"||R.signedMessage instanceof Uint8Array)&&R.signature instanceof Uint8Array)j=typeof R.signedMessage=="string"?R.signedMessage:new TextDecoder().decode(R.signedMessage),g=R.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in L)||typeof L.signMessage!="function"||!("publicKey"in L)||typeof L!="object"||!L.publicKey||!("toBase58"in L.publicKey)||typeof L.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");j=[`${F.host} wants you to sign in with your Solana account:`,L.publicKey.toBase58(),...k?["",k,""]:[""],"Version: 1",`URI: ${F.href}`,`Issued At: ${(n=(a=P==null?void 0:P.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((i=P==null?void 0:P.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${P.signInWithSolana.notBefore}`]:[],...!((o=P==null?void 0:P.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${P.signInWithSolana.expirationTime}`]:[],...!((c=P==null?void 0:P.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${P.signInWithSolana.chainId}`]:[],...!((d=P==null?void 0:P.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${P.signInWithSolana.nonce}`]:[],...!((p=P==null?void 0:P.signInWithSolana)===null||p===void 0)&&p.requestId?[`Request ID: ${P.signInWithSolana.requestId}`]:[],...!((x=(m=P==null?void 0:P.signInWithSolana)===null||m===void 0?void 0:m.resources)===null||x===void 0)&&x.length?["Resources",...P.signInWithSolana.resources.map(R=>`- ${R}`)]:[]].join(`
`);const W=await L.signMessage(new TextEncoder().encode(j),"utf8");if(!W||!(W instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=W}}try{const{data:v,error:_}=await Yt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:j,signature:Gc(g)},!((b=t.options)===null||b===void 0)&&b.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:qi});if(_)throw _;if(!v||!v.session||!v.user){const k=new Hd;return this._returnResult({data:{user:null,session:null},error:k})}return v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),this._returnResult({data:Object.assign({},v),error:_})}catch(v){if(Lt(v))return this._returnResult({data:{user:null,session:null},error:v});throw v}}async _exchangeCodeForSession(t){const r=await Mc(this.storage,`${this.storageKey}-code-verifier`),[a,n]=(r??"").split("/");try{const{data:i,error:o}=await Yt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:a},xform:qi});if(await Zl(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!i||!i.session||!i.user){const c=new Hd;return this._returnResult({data:{user:null,session:null,redirectType:null},error:c})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:n??null}),error:o})}catch(i){if(Lt(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(t){try{const{options:r,provider:a,token:n,access_token:i,nonce:o}=t,c=await Yt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:n,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:qi}),{data:d,error:p}=c;if(p)return this._returnResult({data:{user:null,session:null},error:p});if(!d||!d.session||!d.user){const m=new Hd;return this._returnResult({data:{user:null,session:null},error:m})}return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),this._returnResult({data:d,error:p})}catch(r){if(Lt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,a,n,i,o;try{if("email"in t){const{email:c,options:d}=t;let p=null,m=null;this.flowType==="pkce"&&([p,m]=await Zd(this.storage,this.storageKey));const{error:x}=await Yt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(r=d==null?void 0:d.data)!==null&&r!==void 0?r:{},create_user:(a=d==null?void 0:d.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:p,code_challenge_method:m},redirectTo:d==null?void 0:d.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:x})}if("phone"in t){const{phone:c,options:d}=t,{data:p,error:m}=await Yt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(n=d==null?void 0:d.data)!==null&&n!==void 0?n:{},create_user:(i=d==null?void 0:d.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},channel:(o=d==null?void 0:d.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:p==null?void 0:p.message_id},error:m})}throw new qm("You must provide either an email or phone number.")}catch(c){if(Lt(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}}async verifyOtp(t){var r,a;try{let n,i;"options"in t&&(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(a=t.options)===null||a===void 0?void 0:a.captchaToken);const{data:o,error:c}=await Yt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:qi});if(c)throw c;if(!o)throw new Error("An error occurred on token verification.");const d=o.session,p=o.user;return d!=null&&d.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),this._returnResult({data:{user:p,session:d},error:null})}catch(n){if(Lt(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithSSO(t){var r,a,n,i,o;try{let c=null,d=null;this.flowType==="pkce"&&([c,d]=await Zd(this.storage,this.storageKey));const p=await Yt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&a!==void 0?a:void 0}),!((n=t==null?void 0:t.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:c,code_challenge_method:d}),headers:this.headers,xform:y4});return!((i=p.data)===null||i===void 0)&&i.url&&ya()&&!(!((o=t.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(p.data.url),this._returnResult(p)}catch(c){if(Lt(c))return this._returnResult({data:null,error:c});throw c}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:a}=t;if(a)throw a;if(!r)throw new Ui;const{error:n}=await Yt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:n})})}catch(t){if(Lt(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:a,type:n,options:i}=t,{error:o}=await Yt(this.fetch,"POST",r,{headers:this.headers,body:{email:a,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in t){const{phone:a,type:n,options:i}=t,{data:o,error:c}=await Yt(this.fetch,"POST",r,{headers:this.headers,body:{phone:a,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:c})}throw new qm("You must provide either an email or phone number and a type")}catch(r){if(Lt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await a,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=r();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Mc(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const a=t.expires_at?t.expires_at*1e3-Date.now()<bf:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",t.expires_at),!a){if(this.userStorage){const o=await Mc(this.userStorage,this.storageKey+"-user");o!=null&&o.user?t.user=o.user:t.user=yf()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};t.user=f4(t.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:n,error:i}=await this._callRefreshToken(t.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:n},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Yt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Xl}):await this._useSession(async r=>{var a,n,i;const{data:o,error:c}=r;if(c)throw c;return!(!((a=o.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ui}:await Yt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0,xform:Xl})})}catch(r){if(Lt(r))return K5(r)&&(await this._removeSession(),await Zl(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async a=>{const{data:n,error:i}=a;if(i)throw i;if(!n.session)throw new Ui;const o=n.session;let c=null,d=null;this.flowType==="pkce"&&t.email!=null&&([c,d]=await Zd(this.storage,this.storageKey));const{data:p,error:m}=await Yt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:c,code_challenge_method:d}),jwt:o.access_token,xform:Xl});if(m)throw m;return o.user=p.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(a){if(Lt(a))return this._returnResult({data:{user:null},error:a});throw a}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Ui;const r=Date.now()/1e3;let a=r,n=!0,i=null;const{payload:o}=vf(t.access_token);if(o.exp&&(a=o.exp,n=a<=r),n){const{data:c,error:d}=await this._callRefreshToken(t.refresh_token);if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!c)return{data:{user:null,session:null},error:null};i=c}else{const{data:c,error:d}=await this._getUser(t.access_token);if(d)throw d;i={access_token:t.access_token,refresh_token:t.refresh_token,user:c.user,token_type:"bearer",expires_in:a-r,expires_at:a},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(r){if(Lt(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var a;if(!t){const{data:o,error:c}=r;if(c)throw c;t=(a=o.session)!==null&&a!==void 0?a:void 0}if(!(t!=null&&t.refresh_token))throw new Ui;const{data:n,error:i}=await this._callRefreshToken(t.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):n?this._returnResult({data:{user:n.user,session:n},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Lt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!ya())throw new $m("No browser detected.");if(t.error||t.error_description||t.error_code)throw new $m(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Ty("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new $m("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Ty("No code detected.");const{data:k,error:P}=await this._exchangeCodeForSession(t.code);if(P)throw P;const L=new URL(window.location.href);return L.searchParams.delete("code"),window.history.replaceState(window.history.state,"",L.toString()),{data:{session:k.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:n,access_token:i,refresh_token:o,expires_in:c,expires_at:d,token_type:p}=t;if(!i||!c||!o||!p)throw new $m("No session defined in URL");const m=Math.round(Date.now()/1e3),x=parseInt(c);let b=m+x;d&&(b=parseInt(d));const h=b-m;h*1e3<=ru&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${x}s`);const j=b-x;m-j>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",j,b,m):m-j<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",j,b,m);const{data:g,error:v}=await this._getUser(i);if(v)throw v;const _={provider_token:a,provider_refresh_token:n,access_token:i,expires_in:x,expires_at:b,refresh_token:o,token_type:p,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:_,redirectType:t.type},error:null})}catch(a){if(Lt(a))return this._returnResult({data:{session:null,redirectType:null},error:a});throw a}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Mc(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var a;const{data:n,error:i}=r;if(i)return this._returnResult({error:i});const o=(a=n.session)===null||a===void 0?void 0:a.access_token;if(o){const{error:c}=await this.admin.signOut(o,t);if(c&&!(W5(c)&&(c.status===404||c.status===401||c.status===403)))return this._returnResult({error:c})}return t!=="others"&&(await this._removeSession(),await Zl(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=r4(),a={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,a),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:a}}}async _emitInitialSession(t){return await this._useSession(async r=>{var a,n;try{const{data:{session:i},error:o}=r;if(o)throw o;await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let a=null,n=null;this.flowType==="pkce"&&([a,n]=await Zd(this.storage,this.storageKey,!0));try{return await Yt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:a,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(Lt(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var t;try{const{data:r,error:a}=await this.getUser();if(a)throw a;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(Lt(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:a,error:n}=await this._useSession(async i=>{var o,c,d,p,m;const{data:x,error:b}=i;if(b)throw b;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(c=t.options)===null||c===void 0?void 0:c.scopes,queryParams:(d=t.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await Yt(this.fetch,"GET",h,{headers:this.headers,jwt:(m=(p=x.session)===null||p===void 0?void 0:p.access_token)!==null&&m!==void 0?m:void 0})});if(n)throw n;return ya()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(a==null?void 0:a.url),this._returnResult({data:{provider:t.provider,url:a==null?void 0:a.url},error:null})}catch(a){if(Lt(a))return this._returnResult({data:{provider:t.provider,url:null},error:a});throw a}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var a;try{const{error:n,data:{session:i}}=r;if(n)throw n;const{options:o,provider:c,token:d,access_token:p,nonce:m}=t,x=await Yt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(a=i==null?void 0:i.access_token)!==null&&a!==void 0?a:void 0,body:{provider:c,id_token:d,access_token:p,nonce:m,link_identity:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:qi}),{data:b,error:h}=x;return h?this._returnResult({data:{user:null,session:null},error:h}):!b||!b.session||!b.user?this._returnResult({data:{user:null,session:null},error:new Hd}):(b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("USER_UPDATED",b.session)),this._returnResult({data:b,error:h}))}catch(n){if(Lt(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var a,n;const{data:i,error:o}=r;if(o)throw o;return await Yt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(n=(a=i.session)===null||a===void 0?void 0:a.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(Lt(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const a=Date.now();return await i4(async n=>(n>0&&await n4(200*Math.pow(2,n-1)),this._debug(r,"refreshing attempt",n),await Yt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:qi})),(n,i)=>{const o=200*Math.pow(2,n);return i&&gf(i)&&Date.now()+o-a<ru})}catch(a){if(this._debug(r,"error",a),Lt(a))return this._returnResult({data:{session:null,user:null},error:a});throw a}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const a=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",a),ya()&&!r.skipBrowserRedirect&&window.location.assign(a),{data:{provider:t,url:a},error:null}}async _recoverAndRefresh(){var t,r;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const n=await Mc(this.storage,this.storageKey);if(n&&this.userStorage){let o=await Mc(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:n.user},await su(this.userStorage,this.storageKey+"-user",o)),n.user=(t=o==null?void 0:o.user)!==null&&t!==void 0?t:yf()}else if(n&&!n.user&&!n.user){const o=await Mc(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(n.user=o.user,await Zl(this.storage,this.storageKey+"-user"),await su(this.storage,this.storageKey,n)):n.user=yf()}if(this._debug(a,"session from storage",n),!this._isValidSession(n)){this._debug(a,"session is not valid"),n!==null&&await this._removeSession();return}const i=((r=n.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<bf;if(this._debug(a,`session has${i?"":" not"} expired with margin of ${bf}s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:o}=await this._callRefreshToken(n.refresh_token);o&&(console.error(o),gf(o)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:c}=await this._getUser(n.access_token);!c&&(o!=null&&o.user)?(n.user=o.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(a,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(a,"error",n),console.error(n);return}finally{this._debug(a,"end")}}async _callRefreshToken(t){var r,a;if(!t)throw new Ui;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new tx;const{data:i,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!i.session)throw new Ui;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const c={data:i.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(i){if(this._debug(n,"error",i),Lt(i)){const o={data:null,error:i};return gf(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(t,r,a=!0){const n=`#_notifyAllSubscribers(${t})`;this._debug(n,"begin",r,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(t,r)}catch(d){i.push(d)}});if(await Promise.all(o),i.length>0){for(let c=0;c<i.length;c+=1)console.error(i[c]);throw i[0]}}finally{this._debug(n,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),a=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!a&&r.user&&await su(this.userStorage,this.storageKey+"-user",{user:r.user});const n=Object.assign({},r);delete n.user;const i=qy(n);await su(this.storage,this.storageKey,i)}else{const n=qy(r);await su(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),await Zl(this.storage,this.storageKey),await Zl(this.storage,this.storageKey+"-code-verifier"),await Zl(this.storage,this.storageKey+"-user"),this.userStorage&&await Zl(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&ya()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),ru);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:a}}=r;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((a.expires_at*1e3-t)/ru);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${ru}ms, refresh threshold is ${kb} ticks`),n<=kb&&await this._callRefreshToken(a.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof $2)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ya()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,a){const n=[`provider=${encodeURIComponent(r)}`];if(a!=null&&a.redirectTo&&n.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a!=null&&a.scopes&&n.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[i,o]=await Zd(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});n.push(c.toString())}if(a!=null&&a.queryParams){const i=new URLSearchParams(a.queryParams);n.push(i.toString())}return a!=null&&a.skipBrowserRedirect&&n.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${t}?${n.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var a;const{data:n,error:i}=r;return i?this._returnResult({data:null,error:i}):await Yt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token})})}catch(r){if(Lt(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var a,n;const{data:i,error:o}=r;if(o)return this._returnResult({data:null,error:o});const c=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:d,error:p}=await Yt(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(a=i==null?void 0:i.session)===null||a===void 0?void 0:a.access_token});return p?this._returnResult({data:null,error:p}):(t.factorType==="totp"&&d.type==="totp"&&(!((n=d==null?void 0:d.totp)===null||n===void 0)&&n.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),this._returnResult({data:d,error:null}))})}catch(r){if(Lt(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:n,error:i}=r;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?T4(t.webauthn.credential_response):R4(t.webauthn.credential_response)})}:{code:t.code}),{data:c,error:d}=await Yt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:o,headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token});return d?this._returnResult({data:null,error:d}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),this._returnResult({data:c,error:d}))})}catch(r){if(Lt(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:n,error:i}=r;if(i)return this._returnResult({data:null,error:i});const o=await Yt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token});if(o.error)return o;const{data:c}=o;if(c.type!=="webauthn")return{data:c,error:null};switch(c.webauthn.type){case"create":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:I4(c.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:L4(c.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Lt(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:a}=await this._challenge({factorId:t.factorId});return a?this._returnResult({data:null,error:a}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:a}=await this.getUser();if(a)return{data:null,error:a};const n={all:[],phone:[],totp:[],webauthn:[]};for(const i of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])n.all.push(i),i.status==="verified"&&n[i.factor_type].push(i);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:a},error:n}=await this.getSession();if(n)return this._returnResult({data:null,error:n});if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=vf(a.access_token);let o=null;i.aal&&(o=i.aal);let c=o;((r=(t=a.user.factors)===null||t===void 0?void 0:t.filter(m=>m.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(c="aal2");const p=i.amr||[];return{data:{currentLevel:o,nextLevel:c,currentAuthenticationMethods:p},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:a},error:n}=r;return n?this._returnResult({data:null,error:n}):a?await Yt(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:a.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new Ui})})}catch(r){if(Lt(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async a=>{const{data:{session:n},error:i}=a;if(i)return this._returnResult({data:null,error:i});if(!n)return this._returnResult({data:null,error:new Ui});const o=await Yt(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"approve"},xform:c=>({data:c,error:null})});return o.data&&o.data.redirect_url&&ya()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(a){if(Lt(a))return this._returnResult({data:null,error:a});throw a}}async _denyAuthorization(t,r){try{return await this._useSession(async a=>{const{data:{session:n},error:i}=a;if(i)return this._returnResult({data:null,error:i});if(!n)return this._returnResult({data:null,error:new Ui});const o=await Yt(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"deny"},xform:c=>({data:c,error:null})});return o.data&&o.data.redirect_url&&ya()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(a){if(Lt(a))return this._returnResult({data:null,error:a});throw a}}async fetchJwk(t,r={keys:[]}){let a=r.keys.find(c=>c.kid===t);if(a)return a;const n=Date.now();if(a=this.jwks.keys.find(c=>c.kid===t),a&&this.jwks_cached_at+H5>n)return a;const{data:i,error:o}=await Yt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=n,a=i.keys.find(c=>c.kid===t),!a)?null:a}async getClaims(t,r={}){try{let a=t;if(!a){const{data:h,error:j}=await this.getSession();if(j||!h.session)return this._returnResult({data:null,error:j});a=h.session.access_token}const{header:n,payload:i,signature:o,raw:{header:c,payload:d}}=vf(a);r!=null&&r.allowExpired||m4(i.exp);const p=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!p){const{error:h}=await this.getUser(a);if(h)throw h;return{data:{claims:i,header:n,signature:o},error:null}}const m=h4(n.alg),x=await crypto.subtle.importKey("jwk",p,m,!0,["verify"]);if(!await crypto.subtle.verify(m,x,o,e4(`${c}.${d}`)))throw new Sb("Invalid JWT signature");return{data:{claims:i,header:n,signature:o},error:null}}catch(a){if(Lt(a))return this._returnResult({data:null,error:a});throw a}}}Ep.nextInstanceID={};const Z4=Ep;class W4 extends Z4{constructor(t){super(t)}}class K4{constructor(t,r,a){var n,i,o;this.supabaseUrl=t,this.supabaseKey=r;const c=U5(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const d=`sb-${c.hostname.split(".")[0]}-auth-token`,p={db:D5,realtime:I5,auth:Object.assign(Object.assign({},E5),{storageKey:d}),global:O5},m=F5(a??{},p);this.storageKey=(n=m.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=m.global.headers)!==null&&i!==void 0?i:{},m.accessToken?(this.accessToken=m.accessToken,this.auth=new Proxy({},{get:(x,b)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(b)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=m.auth)!==null&&o!==void 0?o:{},this.headers,m.global.fetch),this.fetch=R5(r,this._getAccessToken.bind(this),m.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},m.realtime)),this.accessToken&&this.accessToken().then(x=>this.realtime.setAuth(x)).catch(x=>console.warn("Failed to set initial Realtime auth token:",x)),this.rest=new qw(new URL("rest/v1",c).href,{headers:this.headers,schema:m.db.schema,fetch:this.fetch}),this.storage=new C5(this.storageUrl.href,this.headers,this.fetch,a==null?void 0:a.storage),m.accessToken||this._listenForAuthEvents()}get functions(){return new Rw(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},a={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,r,a)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,r;if(this.accessToken)return await this.accessToken();const{data:a}=await this.auth.getSession();return(r=(t=a.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:a,storage:n,userStorage:i,storageKey:o,flowType:c,lock:d,debug:p,throwOnError:m},x,b){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new W4({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),x),storageKey:o,autoRefreshToken:t,persistSession:r,detectSessionInUrl:a,storage:n,userStorage:i,flowType:c,lock:d,debug:p,throwOnError:m,fetch:b,hasCustomAuthorizationHeader:Object.keys(this.headers).some(j=>j.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new a5(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,a)=>{this._handleTokenChanged(r,"CLIENT",a==null?void 0:a.access_token)})}_handleTokenChanged(t,r,a){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==a?(this.changedAccessToken=a,this.realtime.setAuth(a)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const rd=(s,t,r)=>new K4(s,t,r);function G4(){if(typeof window<"u"||typeof process>"u")return!1;const s=process.version;if(s==null)return!1;const t=s.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}G4()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Ky={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};var _f={UV_INDEX_URL:"http://mirrors.cloud.aliyuncs.com/pypi/simple",UV_DEFAULT_INDEX:"http://mirrors.cloud.aliyuncs.com/pypi/simple",no_proxy:"",LANGUAGE:"Slovenian",USER:"minimax",npm_config_user_agent:"npm/9.2.0 node/v18.19.0 linux x64 workspaces/false",CI:"true",npm_node_execpath:"/usr/bin/node",ENV_NAME:"ali-virginia-agent-01",SHLVL:"1",PYTHON_PIP_VERSION:"24.2",npm_config_noproxy:"",HOME:"/home/minimax",OLDPWD:"/workspace",npm_package_json:"/workspace/package.json",AGENT_TASK_NAME:"Izdelaj mi javni link za testiranje aplikacije",GPG_KEY:"7169605F62C751356D054A26A821E680E5FA6305",PS1:"NEO_SHELL_PS1_MARKER>",npm_config_userconfig:"/home/minimax/.npmrc",npm_config_local_prefix:"/workspace",IDC:"ali_virginia",COLOR:"1",npm_config_metrics_registry:"https://registry.npmjs.org/",https_proxy:"",LOGNAME:"minimax",http_proxy:"",_:"/usr/bin/npm",npm_config_prefix:"/home/minimax/.npm-global",AGENT_TASK_ID:"task_20251114_0618_1a80a878",LLM_GATEWAY_BASE_URL:"http://10.138.255.202:8080",PYTHON_GET_PIP_URL:"https://github.com/pypa/get-pip/raw/def4aec84b261b939137dd1c69eff0aabb4a7bf4/public/get-pip.py",UV_HTTP_TIMEOUT:"1200",npm_config_cache:"/home/minimax/.npm",npm_config_node_gyp:"/usr/share/nodejs/node-gyp/bin/node-gyp.js",PATH:"/workspace/node_modules/.bin:/node_modules/.bin:/usr/share/nodejs/@npmcli/run-script/lib/node-gyp-bin:/tmp/.venv/bin:/app/.venv/bin:/tmp/.venv/bin:/node_modules/.bin:/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin",NODE:"/usr/bin/node",npm_package_name:"user",ftp_proxy:"",AGENT_TASK_WORKSPACE_DIR:"/workspace",DISPLAY:":99",TIKTOKEN_CACHE_DIR:"/app/neo/tiktoken_bundle",LANG:"C.UTF-8",npm_lifecycle_script:"vite build",npm_package_version:"0.0.0",npm_lifecycle_event:"build",NODE_PATH:"/tmp/default/.pnpm/vite@6.4.1_@types+node@22.19.1_jiti@1.21.7_yaml@2.8.1/node_modules/vite/bin/node_modules:/tmp/default/.pnpm/vite@6.4.1_@types+node@22.19.1_jiti@1.21.7_yaml@2.8.1/node_modules/vite/node_modules:/tmp/default/.pnpm/vite@6.4.1_@types+node@22.19.1_jiti@1.21.7_yaml@2.8.1/node_modules:/tmp/default/.pnpm/node_modules",PYTHON_VERSION:"3.12.5",UV_PROJECT_ENVIRONMENT:"/tmp/.venv",proxy:"",INFRA_ENV:"PROD",npm_config_globalconfig:"/etc/npmrc",npm_config_init_module:"/home/minimax/.npm-init.js",PWD:"/workspace",npm_config_globalignorefile:"/etc/npmignore",npm_execpath:"/usr/share/nodejs/npm/bin/npm-cli.js",PYTHON_GET_PIP_SHA256:"bc37786ec99618416cc0a0ca32833da447f4d91ab51d2c138dd15b7af21e8e9a",npm_config_global_prefix:"/home/minimax/.npm-global",PYTHONPATH:"/workspace:/app",npm_command:"run-script",AGENT_NAME:"Coordinator",INIT_CWD:"/workspace",EDITOR:"vi",NODE_ENV:"production"};function Eh(s){if(typeof window<"u"&&window.__ENV__){const t=window.__ENV__[s];if(t&&!t.startsWith("%"))return t}if(Ky[s])return Ky[s];if(typeof process<"u"&&_f&&_f[s])return _f[s]}let lu=Eh("VITE_SUPABASE_URL")||Eh("SUPABASE_URL"),cu=Eh("VITE_SUPABASE_ANON_KEY")||Eh("SUPABASE_ANON_KEY");(!lu||lu.includes("%VITE_SUPABASE"))&&(lu="https://ckxlbiiirfdogobccmjs.supabase.co",console.warn(" Using fallback Supabase URL"));(!cu||cu.includes("%VITE_SUPABASE"))&&(cu="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNreGxiaWlpcmZkb2dvYmNjbWpzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE4NjI5NjIsImV4cCI6MjA3NzQzODk2Mn0.Y8T0bCsL5t_9u71z-yHYxrdyl4rqPN3fUMBg9k-p_TA",console.warn(" Using fallback Supabase anon key"));typeof window<"u"&&lu&&cu&&console.log(" Supabase configuration ready");const di=rd(lu,cu,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,flowType:"implicit"},global:{headers:{"x-client-info":"standario/1.0.0"}}});function Y4(){if(!lu)throw new Error("VITE_SUPABASE_URL environment variable is not set");if(!cu)throw new Error("VITE_SUPABASE_ANON_KEY environment variable is not set");return!0}const Gy={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};var kf={UV_INDEX_URL:"http://mirrors.cloud.aliyuncs.com/pypi/simple",UV_DEFAULT_INDEX:"http://mirrors.cloud.aliyuncs.com/pypi/simple",no_proxy:"",LANGUAGE:"Slovenian",USER:"minimax",npm_config_user_agent:"npm/9.2.0 node/v18.19.0 linux x64 workspaces/false",CI:"true",npm_node_execpath:"/usr/bin/node",ENV_NAME:"ali-virginia-agent-01",SHLVL:"1",PYTHON_PIP_VERSION:"24.2",npm_config_noproxy:"",HOME:"/home/minimax",OLDPWD:"/workspace",npm_package_json:"/workspace/package.json",AGENT_TASK_NAME:"Izdelaj mi javni link za testiranje aplikacije",GPG_KEY:"7169605F62C751356D054A26A821E680E5FA6305",PS1:"NEO_SHELL_PS1_MARKER>",npm_config_userconfig:"/home/minimax/.npmrc",npm_config_local_prefix:"/workspace",IDC:"ali_virginia",COLOR:"1",npm_config_metrics_registry:"https://registry.npmjs.org/",https_proxy:"",LOGNAME:"minimax",http_proxy:"",_:"/usr/bin/npm",npm_config_prefix:"/home/minimax/.npm-global",AGENT_TASK_ID:"task_20251114_0618_1a80a878",LLM_GATEWAY_BASE_URL:"http://10.138.255.202:8080",PYTHON_GET_PIP_URL:"https://github.com/pypa/get-pip/raw/def4aec84b261b939137dd1c69eff0aabb4a7bf4/public/get-pip.py",UV_HTTP_TIMEOUT:"1200",npm_config_cache:"/home/minimax/.npm",npm_config_node_gyp:"/usr/share/nodejs/node-gyp/bin/node-gyp.js",PATH:"/workspace/node_modules/.bin:/node_modules/.bin:/usr/share/nodejs/@npmcli/run-script/lib/node-gyp-bin:/tmp/.venv/bin:/app/.venv/bin:/tmp/.venv/bin:/node_modules/.bin:/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin",NODE:"/usr/bin/node",npm_package_name:"user",ftp_proxy:"",AGENT_TASK_WORKSPACE_DIR:"/workspace",DISPLAY:":99",TIKTOKEN_CACHE_DIR:"/app/neo/tiktoken_bundle",LANG:"C.UTF-8",npm_lifecycle_script:"vite build",npm_package_version:"0.0.0",npm_lifecycle_event:"build",NODE_PATH:"/tmp/default/.pnpm/vite@6.4.1_@types+node@22.19.1_jiti@1.21.7_yaml@2.8.1/node_modules/vite/bin/node_modules:/tmp/default/.pnpm/vite@6.4.1_@types+node@22.19.1_jiti@1.21.7_yaml@2.8.1/node_modules/vite/node_modules:/tmp/default/.pnpm/vite@6.4.1_@types+node@22.19.1_jiti@1.21.7_yaml@2.8.1/node_modules:/tmp/default/.pnpm/node_modules",PYTHON_VERSION:"3.12.5",UV_PROJECT_ENVIRONMENT:"/tmp/.venv",proxy:"",INFRA_ENV:"PROD",npm_config_globalconfig:"/etc/npmrc",npm_config_init_module:"/home/minimax/.npm-init.js",PWD:"/workspace",npm_config_globalignorefile:"/etc/npmignore",npm_execpath:"/usr/share/nodejs/npm/bin/npm-cli.js",PYTHON_GET_PIP_SHA256:"bc37786ec99618416cc0a0ca32833da447f4d91ab51d2c138dd15b7af21e8e9a",npm_config_global_prefix:"/home/minimax/.npm-global",PYTHONPATH:"/workspace:/app",npm_command:"run-script",AGENT_NAME:"Coordinator",INIT_CWD:"/workspace",EDITOR:"vi",NODE_ENV:"production"};function Ih(s){if(typeof window<"u"&&window.__ENV__){const t=window.__ENV__[s];if(t&&!t.startsWith("%"))return t}if(Gy[s])return Gy[s];if(typeof process<"u"&&kf&&kf[s])return kf[s]}let jn=Ih("VITE_SUPABASE_URL")||Ih("SUPABASE_URL"),_n=Ih("VITE_SUPABASE_ANON_KEY")||Ih("SUPABASE_ANON_KEY");(!jn||jn.includes("%VITE_SUPABASE"))&&(jn="https://ckxlbiiirfdogobccmjs.supabase.co",console.warn(" Using fallback Supabase URL - environment variables not properly configured"));(!_n||_n.includes("%VITE_SUPABASE"))&&(_n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNreGxiaWlpcmZkb2dvYmNjbWpzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE4NjI5NjIsImV4cCI6MjA3NzQzODk2Mn0.Y8T0bCsL5t_9u71z-yHYxrdyl4rqPN3fUMBg9k-p_TA",console.warn(" Using fallback Supabase anon key - environment variables not properly configured"));typeof window<"u"&&(!jn||!_n)?console.error(" Supabase environment variables missing:",{urlAvailable:!!jn,keyAvailable:!!_n,urlPreview:jn?`${jn.substring(0,20)}...`:"MISSING",keyPreview:_n?`${_n.substring(0,20)}...`:"MISSING",windowEnvAvailable:!!window.__ENV__,importMetaEnv:!1}):typeof window<"u"&&jn&&_n&&console.log(" Supabase environment variables loaded successfully");let zb=null;try{if(!jn||!_n)throw new Error(`Missing Supabase environment variables:
    - VITE_SUPABASE_URL: ${jn?"":" MISSING"}
    - VITE_SUPABASE_ANON_KEY: ${_n?"":" MISSING"}
    
    Please ensure these are set in your .env file or deployment environment.`);zb=rd(jn,_n),console.log(" Supabase client initialized successfully")}catch(s){if(console.error(" Failed to initialize Supabase:",s.message),jn&&_n)try{zb=rd(jn,_n)}catch(t){console.error(" Fallback Supabase creation also failed:",t)}}const Ne=zb||rd(jn||"https://placeholder.supabase.co",_n||"placeholder-key");async function Ip(s){try{const{data:{user:t}}=await Ne.auth.getUser();if(!t){console.warn("No user found for audit log");return}const{error:r}=await Ne.from("audit_logs").insert({user_id:t.id,action_type:s.action_type,action_description:s.action_description,ip_address:s.ip_address||null,user_agent:s.user_agent||navigator.userAgent});r&&console.error("Failed to log audit action:",r)}catch(t){console.error("Error logging audit action:",t)}}const Lp={LOGIN:"login",LOGOUT:"logout",PROFILE_EDIT:"profile_edit",PASSWORD_CHANGE:"password_change",DATA_EXPORT:"data_export",SETTINGS_CHANGE:"settings_change",VIEW_PAGE:"view_page",ORGANIZATION_SWITCH:"organization_switch"};try{Y4()}catch(s){console.warn(" Supabase config validation warning (non-critical for now):",s.message)}async function Nf(s,t=3,r=1e3){var n,i,o;let a;for(let c=0;c<t;c++)try{return await s()}catch(d){if(a=d,!(((n=d==null?void 0:d.message)==null?void 0:n.includes("Refresh Token"))||((i=d==null?void 0:d.message)==null?void 0:i.includes("refresh_token_not_found"))||(d==null?void 0:d.status)===400||(d==null?void 0:d.status)===401)&&(d.name==="AuthRetryableFetchError"||(o=d.message)!=null&&o.includes("Failed to fetch")||d.name==="NetworkError")&&c<t-1)console.warn(` Auth operation failed (attempt ${c+1}/${t}), retrying...`,d.message),await new Promise(m=>setTimeout(m,r*(c+1)));else throw d}throw a}const H2=z.createContext(void 0);function J4({children:s}){const[t,r]=z.useState(null),[a,n]=z.useState(!0);z.useEffect(()=>{let m=!0;async function x(){var h,j,g,v;if(console.log(" AuthContext: loadUser - zaenjam nalaganje uporabnika"),!m){console.log(" AuthContext: loadUser - component already unmounted, aborting");return}n(!0);try{const{data:{session:_},error:k}=await Nf(()=>di.auth.getSession(),3,1e3);if(!m)return;if(k){if((h=k.message)!=null&&h.includes("Refresh Token")||(j=k.message)!=null&&j.includes("refresh_token_not_found")||k.status===400){console.log(" AuthContext: loadUser - invalid/expired refresh token, clearing session"),await di.auth.signOut(),m&&r(null);return}console.warn(" AuthContext: loadUser - napaka pri pridobivanju seje (priakovano ob prvi obisku):",k.message),m&&r(null);return}if(!_){console.log(" AuthContext: loadUser - ni aktivne seje (uporabnik ni prijavljen)"),m&&r(null);return}if(!m)return;const{data:{user:P},error:L}=await Nf(()=>di.auth.getUser(),3,1e3);if(!m)return;if(L){console.error(" AuthContext: loadUser - napaka pri pridobivanju uporabnika:",L.message),m&&r(null);return}console.log(" AuthContext: loadUser - dobljen uporabnik:",(P==null?void 0:P.id)||"null"),m&&r(P||null)}catch(_){if(!m)return;(g=_==null?void 0:_.message)!=null&&g.includes("Refresh Token")||(v=_==null?void 0:_.message)!=null&&v.includes("refresh_token_not_found")||(_==null?void 0:_.status)===400?(console.log(" AuthContext: loadUser - caught refresh token error, clearing session"),await di.auth.signOut().catch(()=>{typeof window<"u"&&localStorage.removeItem("supabase.auth.token")}),m&&r(null)):(console.error(" AuthContext: loadUser - nepriakovana napaka:",_),m&&r(null))}finally{m&&(n(!1),console.log(" AuthContext: loadUser - nalaganje konano"))}}x();const{data:{subscription:b}}=di.auth.onAuthStateChange((h,j)=>{var g;m&&(console.log(" AuthContext: onAuthStateChange - event:",h,"user:",((g=j==null?void 0:j.user)==null?void 0:g.id)||"null"),r((j==null?void 0:j.user)||null))});return()=>{m=!1,b.unsubscribe()}},[]);async function i(m,x){var b,h,j;console.log(" AuthContext: Poskuam prijavo z email:",m);try{const{data:g,error:v}=await Nf(()=>di.auth.signInWithPassword({email:m,password:x}),3,1e3);if(v)throw console.error(" AuthContext: Prijava neuspena:",v.message),v.name==="AuthRetryableFetchError"||(b=v.message)!=null&&b.includes("NetworkError")?new Error("Napaka pri povezavi. Preverite internetno povezavo in poskusite znova."):v;console.log(" AuthContext: Prijava uspena, user:",(h=g.user)==null?void 0:h.id),g.user&&(console.log(" AuthContext: Nastavljam user state:",g.user.id),r(g.user));try{await Ip({action_type:Lp.LOGIN,action_description:"Uporabnik se je prijavil v sistem"})}catch(_){console.warn(" AuthContext: Audit log neuspeen (ne prekinemo prijave):",_)}}catch(g){throw console.error(" AuthContext: Podrobna napaka pri prijavi:",g),g.name==="AuthRetryableFetchError"||(j=g.message)!=null&&j.includes("NetworkError")?new Error("Napaka pri povezavi. Preverite internetno povezavo in Supabase konfiguracijo."):g}}async function o(m,x,b){var h;try{console.log(" AuthContext: Registracija novega uporabnika:",m);const{data:j,error:g}=await di.auth.signUp({email:m,password:x,options:{data:{full_name:b}}});if(g)throw console.error(" AuthContext: Registracija neuspena:",g.message),g;if(console.log(" AuthContext: Registracija uspena, user:",(h=j.user)==null?void 0:h.id),j.user)try{const{error:v}=await di.from("profiles").insert({id:j.user.id,email:m,full_name:b,role:"user"});if(v)throw console.error(" AuthContext: Ustvarjanje profila neuspeno:",v.message),v;console.log(" AuthContext: Profil uspeno ustvarjen za:",j.user.id),r(j.user)}catch(v){throw console.error(" AuthContext: Napaka pri ustvarjanju profila:",v),v}}catch(j){throw console.error(" AuthContext: Podrobna napaka pri registraciji:",j),j}}async function c(){try{console.log(" AuthContext: Odjavljivam uporabnika");const{error:m}=await di.auth.signOut();if(m)throw console.error(" AuthContext: Odjava neuspena:",m.message),m;console.log(" AuthContext: Odjava uspena"),r(null)}catch(m){throw console.error(" AuthContext: Podrobna napaka pri odjavi:",m),m}}async function d(m){if(!t){const x=new Error("User not authenticated");throw console.error(" AuthContext: Preklop organizacije neuspeen:",x.message),x}try{console.log(" AuthContext: Preklapljam organizacijo na:",m);const{error:x}=await di.from("profiles").update({organization_id:m}).eq("id",t.id);if(x)throw console.error(" AuthContext: Posodobitev profila neuspena:",x.message),x;console.log(" AuthContext: Profil posodobljen na organizacijo:",m);try{await Ip({action_type:Lp.ORGANIZATION_SWITCH,action_description:`Uporabnik je preklopil na organizacijo ${m}`})}catch(b){console.warn(" AuthContext: Audit log za preklop organizacije neuspeen:",b)}console.log(" AuthContext: Ponovno nalagam stran..."),window.location.reload()}catch(x){throw console.error(" AuthContext: Podrobna napaka pri prelopu organizacije:",x),new Error(`Failed to switch organization: ${x.message}`)}}async function p(){if(!t)return console.warn(" AuthContext: Poakujem dostopnih organizacij, a uporabnik ni prijavljen"),[];try{console.log(" AuthContext: Pridobivam dostopne organizacije za:",t.id);const{data:m,error:x}=await di.from("profiles").select("organization_id, role").eq("id",t.id).single();if(x)return console.warn(" AuthContext: Napaka pri pridobivanju profila:",x.message),[];if(!(m!=null&&m.organization_id))return console.warn(" AuthContext: Uporabnik nima dodeljenega organization_id"),[];const{data:b,error:h}=await di.from("organizations").select("id, name, slug, is_active").eq("id",m.organization_id).eq("is_active",!0).single();return h?(console.error(" AuthContext: Napaka pri pridobivanju podatkov organizacije:",h.message),[]):b?(console.log(" AuthContext: Organizacija uspeno pridobljena:",b.name),[{id:b.id,name:b.name,role:m.role||"user",slug:b.slug}]):(console.warn(" AuthContext: Organizacija ni bila najdena"),[])}catch(m){return console.error(" AuthContext: Nepriakovana napaka pri pridobivanju organizacij:",m),[]}}return e.jsx(H2.Provider,{value:{user:t,loading:a,signIn:i,signUp:o,signOut:c,switchOrganization:d,getAvailableOrganizations:p},children:s})}function cr(){const s=z.useContext(H2);if(s===void 0)throw new Error("useAuth must be used within an AuthProvider");return s}const Z2=z.createContext(void 0);function X4({children:s}){const{user:t}=cr(),[r,a]=z.useState(null),[n,i]=z.useState(null),[o,c]=z.useState(null),[d,p]=z.useState(!0),[m,x]=z.useState(!1),[b,h]=z.useState(null),[j,g]=z.useState(null),v=(r==null?void 0:r.organization_id)||null,_=async()=>{var B,A;if(!t){a(null),p(!1);return}p(!0),h(null);try{const{data:S,error:C}=await Ne.from("profiles").select("*").eq("id",t.id).single();if(C)if(C.code==="PGRST116"){const{data:O,error:Z}=await Ne.from("profiles").insert({id:t.id,email:t.email||"",full_name:((B=t.user_metadata)==null?void 0:B.full_name)||((A=t.email)==null?void 0:A.split("@")[0])||"User",status:"active",is_active:!0,language:"sl",dashboard_theme:"dark"}).select().single();if(Z)throw Z;a(O)}else throw C;else a(S);S!=null&&S.organization_id&&await k()}catch(S){console.error("Error fetching profile:",S),h(S.message||"Failed to fetch profile")}finally{p(!1)}},k=async()=>{if(!v||!t){i(null),c(null),x(!1);return}x(!0),g(null);try{const{data:B,error:A}=await Ne.from("organizations").select("*").eq("id",v).single();if(A)throw A;i(B),c(r?{id:r.id,organization_id:v,user_id:t.id,role:r.role||"member",permissions:{},status:"active",created_at:r.created_at,updated_at:r.updated_at}:null)}catch(B){console.error("Error fetching organization:",B),g(B.message||"Failed to fetch organization")}finally{x(!1)}};z.useEffect(()=>{_()},[t]),z.useEffect(()=>{v&&r&&k()},[v,r]);const P=B=>o?!!(o.permissions||{})[B]:!1,L=()=>(o==null?void 0:o.role)==="owner",F=()=>(o==null?void 0:o.role)==="owner"||(o==null?void 0:o.role)==="admin",W=()=>["owner","admin","member"].includes((o==null?void 0:o.role)||""),R=()=>["owner","admin","member","viewer"].includes((o==null?void 0:o.role)||"");return e.jsx(Z2.Provider,{value:{profile:r,currentOrganization:n,currentOrgId:v,currentMember:o,loading:d,loadingOrg:m,error:b,organizationError:j,refreshProfile:_,refreshOrganization:k,hasPermission:P,isOwner:L,isAdmin:F,isMember:W,isViewer:R},children:s})}function Q4(){const s=z.useContext(Z2);if(s===void 0)throw new Error("useProfile must be used within a ProfileProvider");return s}const W2=z.createContext(void 0);function eS({children:s}){const{user:t}=cr(),[r,a]=z.useState(null),[n,i]=z.useState(null),[o,c]=z.useState(!0),[d,p]=z.useState(null),[m,x]=z.useState(!1),b=new URLSearchParams(window.location.search).get("demo")==="true";z.useEffect(()=>{console.log(" useOrganization: Checking auth status for user:",t==null?void 0:t.id),x(!0)},[t==null?void 0:t.id]),z.useEffect(()=>{if(console.log(" useOrganization: Starting to fetch user profile for user:",t==null?void 0:t.id,"authReady:",m,"isDemoMode:",b),b){console.log(" useOrganization: Demo mode detected, providing default organization");const g={id:"demo-user",organization_id:"demo-organization",full_name:"Demo User",email:"demo@example.com"};console.log(" useOrganization: Setting demo userProfile:",g),a("demo-organization"),i(g),c(!1);return}if(!t||!m){console.log(" useOrganization: No user or auth not ready, clearing state"),a(null),i(null),c(!1);return}(async()=>{try{console.log(" useOrganization: Querying profiles with organizations..."),c(!0),p(null);const{data:g,error:v}=await Ne.from("profiles").select("*, organizations(*)").eq("id",t.id).single();if(console.log(" useOrganization: Query result - data:",g,"error:",v),v)throw console.error(" useOrganization: Query error:",v),v;if(g!=null&&g.organization_id){const _=g.organizations||null;if(!_||_&&_.is_active===!1){console.warn(" useOrganization: User organization is missing or inactive. Attempting to find alternative organization...");const{data:k,error:P}=await Ne.from("user_organizations").select("organization_id, role, is_primary").eq("user_id",t.id).order("is_primary",{ascending:!1});if(P)throw console.error(" useOrganization: Error fetching user_organizations:",P),P;if(console.log(" useOrganization: user_organizations result:",k),k&&k.length>0){const L=k.map(R=>R.organization_id),{data:F,error:W}=await Ne.from("organizations").select("id, name, is_active, slug").in("id",L);if(!W&&F){const R=new Map(F.map(A=>[A.id,A])),B=k.find(A=>{const S=R.get(A.organization_id);return S&&S.is_active});if(B){const A=B.organization_id;console.log(" useOrganization: Auto-switching to active organization:",A);const{error:S}=await Ne.from("profiles").update({organization_id:A}).eq("id",t.id);if(S)throw console.error(" useOrganization: Failed to update profile organization_id:",S),S;const{data:C,error:O}=await Ne.from("profiles").select("*, organizations(*)").eq("id",t.id).single();if(O)throw console.error(" useOrganization: Error fetching refreshed profile:",O),O;i(C),a(C.organization_id),c(!1);return}}}throw console.error(" useOrganization: No active organizations available for user"),new Error("Your default organization has been deleted or is inactive. Please contact your administrator.")}}if(!(g!=null&&g.organization_id)){console.warn(" useOrganization: No organization_id found for user. Searching user_organizations...");const{data:_,error:k}=await Ne.from("user_organizations").select("organization_id, role, is_primary").eq("user_id",t.id).order("is_primary",{ascending:!1});if(k)throw console.error(" useOrganization: Error fetching user_organizations:",k),k;if(_&&_.length>0){const P=_.map(W=>W.organization_id),{data:L,error:F}=await Ne.from("organizations").select("id, name, is_active, slug").in("id",P);if(!F&&L){const W=new Map(L.map(B=>[B.id,B])),R=_.find(B=>{const A=W.get(B.organization_id);return A&&A.is_active});if(R){const B=R.organization_id;console.log(" useOrganization: Found active organization, updating profile to:",B);const{error:A}=await Ne.from("profiles").update({organization_id:B}).eq("id",t.id);if(A)throw console.error(" useOrganization: Failed to update profile organization_id:",A),A;const{data:S,error:C}=await Ne.from("profiles").select("*, organizations(*)").eq("id",t.id).single();if(C)throw console.error(" useOrganization: Error fetching refreshed profile:",C),C;i(S),a(S.organization_id),c(!1);return}}}throw console.error(" useOrganization: User has no organizations"),new Error("User is not associated with any active organization")}console.log(" useOrganization: Successfully loaded user profile:",g),i(g),a(g.organization_id)}catch(g){console.error(" useOrganization: Error fetching user profile:",g),p(g.message),a(null),i(null)}finally{c(!1)}})()},[t,m]);const h={organizationId:r,userProfile:n,loading:o,error:d};return e.jsx(W2.Provider,{value:h,children:s})}function ju(){const s=z.useContext(W2);if(s===void 0)throw new Error("useOrganization must be used within an OrganizationProvider");return s}/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var tS={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rS=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=(s,t)=>{const r=z.forwardRef(({color:a="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:c="",children:d,...p},m)=>z.createElement("svg",{ref:m,...tS,width:n,height:n,stroke:a,strokeWidth:o?Number(i)*24/Number(n):i,className:["lucide",`lucide-${rS(s)}`,c].join(" "),...p},[...t.map(([x,b])=>z.createElement(x,b)),...Array.isArray(d)?d:[d]]));return r.displayName=`${s}`,r};/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yy=rt("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sS=rt("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rx=rt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lg=rt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aS=rt("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pl=rt("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bi=rt("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cg=rt("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hi=rt("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lh=rt("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nS=rt("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dg=rt("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iS=rt("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _a=rt("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cb=rt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sx=rt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ug=rt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ax=rt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K2=rt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const er=rt("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=rt("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oS=rt("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pg=rt("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ss=rt("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jy=rt("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ul=rt("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cs=rt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tp=rt("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _u=rt("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ir=rt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lS=rt("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wf=rt("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lr=rt("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xi=rt("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jp=rt("FileSearch",[["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M4.268 21a2 2 0 0 0 1.727 1H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"ms7g94"}],["path",{d:"m9 18-1.5-1.5",key:"1j6qii"}],["circle",{cx:"5",cy:"14",r:"3",key:"ufru5t"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cS=rt("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=rt("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pb=rt("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wp=rt("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dS=rt("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nx=rt("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ab=rt("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uS=rt("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pS=rt("Headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xy=rt("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ix=rt("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mS=rt("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hS=rt("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mg=rt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xS=rt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bu=rt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Th=rt("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fS=rt("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G2=rt("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sc=rt("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sd=rt("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hg=rt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qy=rt("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dt=rt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bS=rt("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yc=rt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kp=rt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ob=rt("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=rt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ku=rt("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fi=rt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mt=rt("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e0=rt("Siren",[["path",{d:"M7 18v-6a5 5 0 1 1 10 0v6",key:"pcx96s"}],["path",{d:"M5 21a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-1a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2z",key:"1b4s83"}],["path",{d:"M21 12h1",key:"jtio3y"}],["path",{d:"M18.5 4.5 18 5",key:"g5sp9y"}],["path",{d:"M2 12h1",key:"1uaihz"}],["path",{d:"M12 2v1",key:"11qlp1"}],["path",{d:"m4.929 4.929.707.707",key:"1i51kw"}],["path",{d:"M12 12v6",key:"3ahymv"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Db=rt("SquareCheckBig",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ar=rt("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gS=rt("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vS=rt("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rp=rt("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pr=rt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mp=rt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=rt("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t0=rt("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xa=rt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xg=rt("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ox=rt("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yS=rt("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const en=rt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fa=rt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sf=rt("Workflow",[["rect",{width:"8",height:"8",x:"3",y:"3",rx:"2",key:"by2w9f"}],["path",{d:"M7 11v4a2 2 0 0 0 2 2h4",key:"xkn7yn"}],["rect",{width:"8",height:"8",x:"13",y:"13",rx:"2",key:"1cgmvn"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ar=rt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fp=rt("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function zs({isOpen:s,onClose:t,title:r,children:a}){return s?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:t}),e.jsxs("div",{className:"relative bg-bg-surface border border-border-subtle rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-border-subtle",children:[e.jsx("h2",{className:"text-h3 text-text-primary",children:r}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",children:e.jsx(Ar,{className:"w-5 h-5 text-text-secondary"})})]}),e.jsx("div",{className:"p-6",children:a})]})]}):null}function vr({type:s,value:t,className:r=""}){const{t:a}=et(),n=()=>{if(s==="risk")return a(`dashboard.${t.toLowerCase()}`);if(s==="status"){const o=t.toLowerCase().replace(/ /g,"_").replace(//g,"c").replace(//g,"s").replace(//g,"z"),c=a(`dashboard.status.${o}`);if(c===`dashboard.status.${o}`){const d=a(`dashboard.status.${t.toLowerCase()}`);if(d!==`dashboard.status.${t.toLowerCase()}`)return d;const p=a(`dashboard.status.${t.toLowerCase().replace(/_/g," ")}`);return p!==`dashboard.status.${t.toLowerCase().replace(/_/g," ")}`?p:t}return c}return t},i=()=>{switch(s){case"risk":switch(t.toLowerCase()){case"critical":case"visoka":return"text-red-500 bg-red-500/10";case"high":return"text-red-500 bg-red-500/10";case"medium":case"srednja":return"text-yellow-500 bg-yellow-500/10";case"low":case"nizka":return"text-green-500 bg-green-500/10";default:return"bg-bg-surface-hover text-text-secondary"}case"priority":switch(t.toLowerCase()){case"visoka":return"bg-risk-high/15 text-risk-high border border-risk-high/30";case"normalna":return"bg-risk-medium/15 text-risk-medium border border-risk-medium/30";case"nizka":return"bg-risk-low/15 text-risk-low border border-risk-low/30";default:return"bg-bg-surface-hover text-text-secondary border border-border-subtle"}case"role":switch(t.toLowerCase()){case"owner":return"bg-purple-900/50 text-purple-300 border border-purple-500/30";case"admin":return"bg-accent-primary/15 text-accent-primary border border-accent-primary/30";case"member":return"bg-green-900/50 text-green-400 border border-green-500/30";case"viewer":return"bg-blue-900/50 text-blue-400 border border-blue-500/30";default:return"bg-bg-surface-hover text-text-secondary border border-border-subtle"}case"status":switch(t.toLowerCase()){case"odprt":case"open":case"in progress":case"investigating":case"v obdelavi":case"v teku":return"text-red-500 bg-red-500/10";case"zaprt":case"resolved":case"closed":return"text-green-500 bg-green-500/10";case"mitigated":case"odpravljeno":return"text-green-500 bg-green-500/10";default:return"text-text-secondary bg-bg-surface-hover"}default:return"bg-bg-surface-hover text-text-secondary"}};return e.jsx("span",{className:`
      inline-flex items-center px-3 py-1 rounded-full
      text-caption font-medium uppercase tracking-wider
      ${i()} ${r}
    `,children:n()})}function jS({setCurrentPage:s}){const{t}=et(),{user:r}=cr(),{organizationId:a,userProfile:n}=ju(),[i,o]=z.useState(null),[c,d]=z.useState(null),[p,m]=z.useState([]),[x,b]=z.useState(!0),[h,j]=z.useState(!1),[g,v]=z.useState(null),[_,k]=z.useState(!1),[P,L]=z.useState(!1),[F,W]=z.useState({}),R=(n==null?void 0:n.role)==="owner",B=["owner","admin"].includes((n==null?void 0:n.role)||"");z.useEffect(()=>{a&&A()},[a]);async function A(){if(a){b(!0),v(null);try{const{data:O,error:Z}=await Ne.from("organizations").select("*").eq("id",a).single();if(Z)throw Z;const{data:te}=await Ne.from("subscriptions").select("*").eq("organization_id",a).single(),{data:ce,error:re}=await Ne.from("profiles").select("id, full_name, email, role, created_at, updated_at").eq("organization_id",a);if(re)throw re;o(O),d(te||null),m(ce||[])}catch(O){console.error("Error loading organization data:",O),v(O.message)}finally{b(!1)}}}async function S(){if(!(!a||!F)){j(!0),v(null);try{const{error:O}=await Ne.from("organizations").update({name:F.name,description:F.description,billing_email:F.billing_email,logo_url:F.logo_url,updated_at:new Date().toISOString()}).eq("id",a);if(O)throw O;await A(),k(!1),W({})}catch(O){console.error("Error saving organization:",O),v(O.message)}finally{j(!1)}}}const C=()=>{i&&(W({name:i.name,description:i.description,billing_email:i.billing_email,logo_url:i.logo_url}),k(!0))};return x?e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})}):g&&!i?e.jsxs("div",{className:"text-center py-12",children:[e.jsxs("div",{className:"text-red-500 mb-4",children:[t("common.error"),": ",g]}),e.jsx("button",{onClick:A,className:"bg-accent-primary hover:bg-accent-primary/80 px-4 py-2 rounded transition-colors",children:t("common.retry")})]}):i?e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:t("organization.settings")}),e.jsx("p",{className:"text-body-lg text-text-secondary mt-1",children:t("organization.settingsDescription")})]}),B&&e.jsx("button",{onClick:C,className:"bg-accent-primary hover:bg-accent-primary/80 px-4 py-2 rounded transition-colors text-white",children:t("common.edit")})]}),e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:[e.jsx("h2",{className:"text-h3 text-text-primary mb-6",children:t("organization.details")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:t("organization.name")}),e.jsx("div",{className:"text-body-lg text-text-primary",children:i.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:t("organization.status")}),e.jsx(vr,{type:"status",value:i.status})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:t("organization.createdAt")}),e.jsx("div",{className:"text-body-lg text-text-primary",children:new Date(i.created_at).toLocaleDateString("sl-SI")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:t("organization.billingEmail")}),e.jsx("div",{className:"text-body-lg text-text-primary",children:i.billing_email||"-"})]}),i.description&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:t("organization.description")}),e.jsx("div",{className:"text-body-lg text-text-primary",children:i.description})]})]})]}),e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-h3 text-text-primary",children:t("organization.subscription")}),R&&e.jsx("button",{onClick:()=>L(!0),className:"bg-accent-primary hover:bg-accent-primary/80 px-4 py-2 rounded transition-colors text-white",children:t("organization.manageBilling")})]}),c?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:t("organization.plan")}),e.jsxs("div",{className:"text-body-lg text-text-primary",children:[c.plan_name," - ",c.currency," ",c.amount,"/month"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:t("organization.status")}),e.jsx(vr,{type:"status",value:c.status})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:t("organization.currentPeriod")}),e.jsxs("div",{className:"text-body-lg text-text-primary",children:[new Date(c.current_period_start).toLocaleDateString("sl-SI")," - "," ",new Date(c.current_period_end).toLocaleDateString("sl-SI")]})]})]}):e.jsx("div",{className:"text-text-secondary",children:t("organization.noSubscription")})]}),e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:[e.jsx("h2",{className:"text-h3 text-text-primary mb-6",children:t("organization.members")}),e.jsx("div",{className:"space-y-4",children:p.map(O=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-bg-near-black rounded",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-10 h-10 bg-accent-primary rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-semibold",children:(O.full_name||O.email)[0].toUpperCase()})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-body-lg text-text-primary",children:O.full_name||O.email}),e.jsx("div",{className:"text-sm text-text-secondary",children:O.email})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx(vr,{type:"role",value:O.role})})]},O.id))}),p.length===0&&e.jsx("div",{className:"text-center py-8 text-text-secondary",children:t("organization.noMembers")})]}),R&&e.jsxs("div",{className:"bg-red-950/20 border border-red-500/30 rounded-lg p-6",children:[e.jsx("h3",{className:"text-h4 text-red-400 mb-4",children:t("organization.dangerZone")}),e.jsx("p",{className:"text-body-lg text-text-secondary mb-4",children:t("organization.dangerZoneDescription")}),e.jsx("button",{className:"bg-red-600 hover:bg-red-700 px-4 py-2 rounded transition-colors text-white",children:t("organization.deleteOrganization")})]}),e.jsx(zs,{isOpen:_,onClose:()=>k(!1),title:t("organization.editOrganization"),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:[t("organization.name")," *"]}),e.jsx("input",{type:"text",value:F.name||"",onChange:O=>W({...F,name:O.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:t("organization.description")}),e.jsx("textarea",{value:F.description||"",onChange:O=>W({...F,description:O.target.value}),rows:3,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:t("organization.billingEmail")}),e.jsx("input",{type:"email",value:F.billing_email||"",onChange:O=>W({...F,billing_email:O.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:t("organization.logoUrl")}),e.jsx("input",{type:"url",value:F.logo_url||"",onChange:O=>W({...F,logo_url:O.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",placeholder:"https://example.com/logo.png"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{onClick:()=>k(!1),className:"px-4 py-2 text-text-secondary hover:text-text-primary transition-colors",disabled:h,children:t("common.cancel")}),e.jsx("button",{onClick:S,disabled:h||!F.name,className:"bg-accent-primary hover:bg-accent-primary/80 px-4 py-2 rounded transition-colors text-white disabled:opacity-50",children:t(h?"common.saving":"common.save")})]})]})}),e.jsx(zs,{isOpen:P,onClose:()=>L(!1),title:t("organization.manageBilling"),children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-text-secondary mb-4",children:t("organization.billingManagementDescription")}),e.jsxs("div",{className:"bg-bg-near-black p-4 rounded-lg",children:[e.jsx("h4",{className:"text-lg font-semibold text-text-primary mb-2",children:(c==null?void 0:c.plan_name)||t("organization.noPlan")}),e.jsx("p",{className:"text-text-secondary",children:(c==null?void 0:c.amount)&&(c==null?void 0:c.currency)&&`${c.currency} ${c.amount}/month`})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>L(!1),className:"px-4 py-2 text-text-secondary hover:text-text-primary transition-colors",children:t("common.close")}),e.jsx("button",{onClick:()=>{alert("Billing management coming soon!")},className:"bg-accent-primary hover:bg-accent-primary/80 px-4 py-2 rounded transition-colors text-white",children:t("organization.manageSubscription")})]})]})})]}):e.jsx("div",{className:"text-center py-12",children:e.jsx("div",{className:"text-text-secondary",children:t("organization.noOrganization")})})}var _S={UV_INDEX_URL:"http://mirrors.cloud.aliyuncs.com/pypi/simple",UV_DEFAULT_INDEX:"http://mirrors.cloud.aliyuncs.com/pypi/simple",no_proxy:"",LANGUAGE:"Slovenian",USER:"minimax",npm_config_user_agent:"npm/9.2.0 node/v18.19.0 linux x64 workspaces/false",CI:"true",npm_node_execpath:"/usr/bin/node",ENV_NAME:"ali-virginia-agent-01",SHLVL:"1",PYTHON_PIP_VERSION:"24.2",npm_config_noproxy:"",HOME:"/home/minimax",OLDPWD:"/workspace",npm_package_json:"/workspace/package.json",AGENT_TASK_NAME:"Izdelaj mi javni link za testiranje aplikacije",GPG_KEY:"7169605F62C751356D054A26A821E680E5FA6305",PS1:"NEO_SHELL_PS1_MARKER>",npm_config_userconfig:"/home/minimax/.npmrc",npm_config_local_prefix:"/workspace",IDC:"ali_virginia",COLOR:"1",npm_config_metrics_registry:"https://registry.npmjs.org/",https_proxy:"",LOGNAME:"minimax",http_proxy:"",_:"/usr/bin/npm",npm_config_prefix:"/home/minimax/.npm-global",AGENT_TASK_ID:"task_20251114_0618_1a80a878",LLM_GATEWAY_BASE_URL:"http://10.138.255.202:8080",PYTHON_GET_PIP_URL:"https://github.com/pypa/get-pip/raw/def4aec84b261b939137dd1c69eff0aabb4a7bf4/public/get-pip.py",UV_HTTP_TIMEOUT:"1200",npm_config_cache:"/home/minimax/.npm",npm_config_node_gyp:"/usr/share/nodejs/node-gyp/bin/node-gyp.js",PATH:"/workspace/node_modules/.bin:/node_modules/.bin:/usr/share/nodejs/@npmcli/run-script/lib/node-gyp-bin:/tmp/.venv/bin:/app/.venv/bin:/tmp/.venv/bin:/node_modules/.bin:/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin",NODE:"/usr/bin/node",npm_package_name:"user",ftp_proxy:"",AGENT_TASK_WORKSPACE_DIR:"/workspace",DISPLAY:":99",TIKTOKEN_CACHE_DIR:"/app/neo/tiktoken_bundle",LANG:"C.UTF-8",npm_lifecycle_script:"vite build",npm_package_version:"0.0.0",npm_lifecycle_event:"build",NODE_PATH:"/tmp/default/.pnpm/vite@6.4.1_@types+node@22.19.1_jiti@1.21.7_yaml@2.8.1/node_modules/vite/bin/node_modules:/tmp/default/.pnpm/vite@6.4.1_@types+node@22.19.1_jiti@1.21.7_yaml@2.8.1/node_modules/vite/node_modules:/tmp/default/.pnpm/vite@6.4.1_@types+node@22.19.1_jiti@1.21.7_yaml@2.8.1/node_modules:/tmp/default/.pnpm/node_modules",PYTHON_VERSION:"3.12.5",UV_PROJECT_ENVIRONMENT:"/tmp/.venv",proxy:"",INFRA_ENV:"PROD",npm_config_globalconfig:"/etc/npmrc",npm_config_init_module:"/home/minimax/.npm-init.js",PWD:"/workspace",npm_config_globalignorefile:"/etc/npmignore",npm_execpath:"/usr/share/nodejs/npm/bin/npm-cli.js",PYTHON_GET_PIP_SHA256:"bc37786ec99618416cc0a0ca32833da447f4d91ab51d2c138dd15b7af21e8e9a",npm_config_global_prefix:"/home/minimax/.npm-global",PYTHONPATH:"/workspace:/app",npm_command:"run-script",AGENT_NAME:"Coordinator",INIT_CWD:"/workspace",EDITOR:"vi",NODE_ENV:"production"};const Bm=[{value:"member",label:"Member",description:"Can access organization data and tools"},{value:"admin",label:"Admin",description:"Can manage organization settings and users"},{value:"viewer",label:"Viewer",description:"Read-only access to organization data"}],kS=["Human Resources","Information Technology","Finance","Legal","Operations","Marketing","Sales","Research & Development","Compliance","Other"];function NS({setCurrentPage:s}){var re;const{t}=et(),{user:r}=cr(),{organizationId:a,userProfile:n}=ju(),[i,o]=z.useState(""),[c,d]=z.useState("member"),[p,m]=z.useState(""),[x,b]=z.useState(""),[h,j]=z.useState(""),[g,v]=z.useState(!1),[_,k]=z.useState(null),[P,L]=z.useState(null),[F,W]=z.useState([]),[R,B]=z.useState([]),[A,S]=z.useState(!1);if(n==null||n.role,!["owner","admin"].includes((n==null?void 0:n.role)||""))return e.jsx("div",{className:"text-center py-12",children:e.jsx("div",{className:"text-text-secondary",children:t("organization.noPermission")})});const O=async()=>{if(a)try{const{data:X}=await Ne.from("organization_invitations").select(`
          id,
          email,
          role,
          status,
          message,
          created_at,
          expires_at,
          invited_by_profile:profiles!organization_invitations_invited_by_fkey (
            full_name,
            email
          )
        `).eq("organization_id",a).eq("status","pending").order("created_at",{ascending:!1}),{data:U}=await Ne.from("organization_invitations").select(`
          id,
          email,
          role,
          status,
          message,
          department,
          job_title,
          created_at,
          invited_by_profile:profiles!organization_invitations_invited_by_fkey (
            full_name,
            email
          )
        `).eq("organization_id",a).in("status",["accepted","declined","expired"]).order("created_at",{ascending:!1}).limit(10);W(X||[]),B(U||[])}catch(X){console.error("Error loading invitations:",X),k(X.message)}},Z=async X=>{var U,oe,xe;if(X.preventDefault(),!(!a||!r)){v(!0),k(null),L(null);try{const{data:J}=await Ne.auth.getSession();if(!((U=J==null?void 0:J.session)!=null&&U.access_token))throw new Error("No valid session found");const $=((oe=window.__ENV__)==null?void 0:oe.VITE_SUPABASE_URL)||void 0||_S.VITE_SUPABASE_URL,Q=await fetch(`${$}/functions/v1/send-organization-invitation`,{method:"POST",headers:{Authorization:`Bearer ${J.session.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({organization_id:a,email:i.trim(),role:c,message:p.trim(),department:x.trim()||null,job_title:h.trim()||null})}),q=await Q.json();if(!Q.ok)throw new Error(((xe=q.error)==null?void 0:xe.message)||"Failed to send invitation");L(t("organization.invitationSent")),o(""),d("member"),m(""),b(""),j(""),await O()}catch(J){console.error("Error sending invitation:",J),k(J.message)}finally{v(!1)}}},te=async X=>{if(!(!a||!r))try{alert("Resend invitation feature coming soon!")}catch(U){console.error("Error resending invitation:",U),k(U.message)}},ce=async X=>{if(!(!a||!r))try{const{error:U}=await Ne.from("organization_invitations").update({status:"cancelled"}).eq("id",X);if(U)throw U;await O(),L(t("organization.invitationCancelled"))}catch(U){console.error("Error cancelling invitation:",U),k(U.message)}};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:t("organization.inviteUsers")}),e.jsx("p",{className:"text-body-lg text-text-secondary mt-1",children:t("organization.inviteUsersDescription")})]}),e.jsx("button",{onClick:()=>S(!0),className:"bg-accent-primary hover:bg-accent-primary/80 px-4 py-2 rounded transition-colors text-white",children:t("organization.inviteUser")})]}),F.length>0&&e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:[e.jsx("h2",{className:"text-h3 text-text-primary mb-6",children:t("organization.pendingInvitations")}),e.jsx("div",{className:"space-y-4",children:F.map(X=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-bg-near-black rounded",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-10 h-10 bg-accent-primary rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-semibold",children:X.email[0].toUpperCase()})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-body-lg text-text-primary",children:X.email}),e.jsxs("div",{className:"text-sm text-text-secondary",children:[t("organization.role"),": ",X.role,"  "," ",t("organization.invitedBy"),": ",X.invited_by_profile.full_name||X.invited_by_profile.email,"  "," ",t("organization.expiresIn"),": ",Math.ceil((new Date(X.expires_at).getTime()-Date.now())/(1e3*60*60*24))," days"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>te(X.id),className:"text-accent-primary hover:text-accent-primary/80 transition-colors",children:t("organization.resend")}),e.jsx("button",{onClick:()=>ce(X.id),className:"text-red-400 hover:text-red-300 transition-colors",children:t("organization.cancel")})]})]},X.id))})]}),R.length>0&&e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:[e.jsx("h2",{className:"text-h3 text-text-primary mb-6",children:t("organization.recentInvitations")}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border-subtle",children:[e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-text-secondary",children:t("common.email")}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-text-secondary",children:t("organization.role")}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-text-secondary",children:t("organization.department")}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-text-secondary",children:t("common.status")}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-text-secondary",children:t("common.date")}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-text-secondary",children:t("organization.invitedBy")})]})}),e.jsx("tbody",{children:R.map(X=>e.jsxs("tr",{className:"border-b border-border-subtle hover:bg-bg-near-black",children:[e.jsx("td",{className:"py-3 px-4 text-text-primary",children:X.email}),e.jsx("td",{className:"py-3 px-4 text-text-primary",children:X.role}),e.jsx("td",{className:"py-3 px-4 text-text-primary",children:X.department||"-"}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${X.status==="accepted"?"bg-green-900/50 text-green-400":X.status==="declined"?"bg-red-900/50 text-red-400":"bg-gray-900/50 text-gray-400"}`,children:X.status})}),e.jsx("td",{className:"py-3 px-4 text-text-secondary",children:new Date(X.created_at).toLocaleDateString("sl-SI")}),e.jsx("td",{className:"py-3 px-4 text-text-secondary",children:X.invited_by_profile.full_name||X.invited_by_profile.email})]},X.id))})]})})]}),e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:[e.jsx("h2",{className:"text-h3 text-text-primary mb-6",children:t("organization.quickInvite")}),_&&e.jsx("div",{className:"mb-4 p-3 bg-red-900/50 border border-red-500/50 rounded text-red-400",children:_}),P&&e.jsx("div",{className:"mb-4 p-3 bg-green-900/50 border border-green-500/50 rounded text-green-400",children:P}),e.jsxs("form",{onSubmit:Z,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:[t("common.email")," *"]}),e.jsx("input",{type:"email",value:i,onChange:X=>o(X.target.value),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",required:!0,placeholder:"user@example.com"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:[t("organization.role")," *"]}),e.jsx("select",{value:c,onChange:X=>d(X.target.value),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",required:!0,children:Bm.map(X=>e.jsx("option",{value:X.value,children:X.label},X.value))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:t("organization.department")}),e.jsxs("select",{value:x,onChange:X=>b(X.target.value),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"",children:t("organization.selectDepartment")}),kS.map(X=>e.jsx("option",{value:X,children:X},X))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:t("organization.jobTitle")}),e.jsx("input",{type:"text",value:h,onChange:X=>j(X.target.value),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",placeholder:"e.g., Software Developer"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:t("organization.message")}),e.jsx("textarea",{value:p,onChange:X=>m(X.target.value),rows:3,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",placeholder:t("organization.messagePlaceholder")})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:g||!i||!c,className:"bg-accent-primary hover:bg-accent-primary/80 px-6 py-2 rounded transition-colors text-white disabled:opacity-50",children:t(g?"common.sending":"organization.sendInvitation")})})]})]}),e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:[e.jsx("h2",{className:"text-h3 text-text-primary mb-6",children:t("organization.roleDescriptions")}),e.jsx("div",{className:"space-y-4",children:Bm.map(X=>e.jsxs("div",{className:"flex items-start space-x-4 p-4 bg-bg-near-black rounded",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-accent-primary rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-sm font-semibold",children:X.label[0]})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-1",children:X.label}),e.jsx("p",{className:"text-text-secondary",children:X.description})]})]},X.value))})]}),e.jsx(zs,{isOpen:A,onClose:()=>S(!1),title:t("organization.inviteUser"),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:[t("common.email")," *"]}),e.jsx("input",{type:"email",value:i,onChange:X=>o(X.target.value),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",required:!0,placeholder:"user@example.com"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:[t("organization.role")," *"]}),e.jsx("select",{value:c,onChange:X=>d(X.target.value),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",required:!0,children:Bm.map(X=>e.jsx("option",{value:X.value,children:X.label},X.value))}),e.jsx("p",{className:"text-sm text-text-secondary mt-1",children:(re=Bm.find(X=>X.value===c))==null?void 0:re.description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:t("organization.message")}),e.jsx("textarea",{value:p,onChange:X=>m(X.target.value),rows:4,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",placeholder:t("organization.messagePlaceholder")})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{onClick:()=>S(!1),className:"px-4 py-2 text-text-secondary hover:text-text-primary transition-colors",disabled:g,children:t("common.cancel")}),e.jsx("button",{onClick:Z,disabled:g||!i||!c,className:"bg-accent-primary hover:bg-accent-primary/80 px-4 py-2 rounded transition-colors text-white disabled:opacity-50",children:t(g?"common.sending":"organization.sendInvitation")})]})]})})]})}function Y2({size:s="md",variant:t="light"}){const a={sm:{icon:"w-5 h-5",text:"text-sm",container:"gap-2"},md:{icon:"w-6 h-6",text:"text-lg",container:"gap-3"},lg:{icon:"w-10 h-10",text:"text-2xl",container:"gap-4"},xl:{icon:"w-13 h-13",text:"text-3xl",container:"gap-5"}}[s];return e.jsxs("div",{className:`flex items-center ${a.container}`,children:[e.jsx("div",{className:"rounded-lg bg-accent-primary flex items-center justify-center",style:{padding:s==="sm"?"4px":s==="md"?"5px":s==="lg"?"8px":"10px"},children:e.jsx(Mt,{className:`${a.icon} text-white`})}),e.jsx("span",{className:`${a.text} font-semibold text-text-primary`,children:"Standario"})]})}function wS({activePage:s,onPageChange:t}){const{t:r}=et(),a=[{id:"dashboard",label:r("navigation.dashboard"),icon:mS,hasSubmenu:!1,submenu:[]},{id:"workspaces",label:r("navigation.workspaces"),icon:sc,hasSubmenu:!1,submenu:[]},{id:"alerts",label:"Opozorila",icon:pt,hasSubmenu:!1,submenu:[]},{id:"nis2",label:r("navigation.nis2"),icon:Mt,hasSubmenu:!0,submenu:[{id:"nis2-risk-register",label:"Evidence tveganj"},{id:"nis2-non-conformities",label:"Evidence neskladnosti"},{id:"evidenca-odgovornih-oseb",label:"Evidence odgovornih oseb"},{id:"nis2-supply-chain",label:"Dobavne verige"},{id:"nis2-controls",label:"Kontrole in ukrepi"},{id:"nis2-documentation",label:"Dokumentacija"},{id:"cyber-incident-report",label:r("navigation.nis2Submenu.cyberReports")||"Poroanje o kibernetskih incidentih"}]},{id:"ai-act-eu",label:"AI Act EU",icon:xi,hasSubmenu:!0,submenu:[{id:"ai-systems",label:"AI sistemi"},{id:"ai-compliance",label:"Dokumenti skladnosti"},{id:"ai-risk-assessment",label:"Ocenjevanje tveganj"},{id:"ai-transparency",label:"Preglednost AI sistemov"}]},{id:"gdpr",label:r("navigation.gdpr"),icon:mg,hasSubmenu:!0,submenu:[{id:"processing-activities",label:r("navigation.gdprSubmenu.processingActivities")},{id:"gdpr-processors",label:r("navigation.gdprSubmenu.processors")},{id:"gdpr-breach",label:r("navigation.gdprSubmenu.breach")},{id:"gdpr-forgotten",label:r("navigation.gdprSubmenu.forgotten")},{id:"gdpr-data-protection",label:r("navigation.gdprSubmenu.dataProtection")},{id:"gdpr-dpia",label:r("navigation.gdprSubmenu.dpia")},{id:"gdpr-audit",label:r("navigation.gdprSubmenu.audit")},{id:"gdpr-usposabljanja",label:r("navigation.gdprSubmenu.usposabljanja")},{id:"zvop-2",label:r("navigation.gdprSubmenu.zvop2")},{id:"gdpr-privacy-policy",label:r("navigation.gdprSubmenu.privacyPolicy")},{id:"gdpr-consent",label:r("navigation.gdprSubmenu.consent")}]},{id:"iso27001",label:r("navigation.iso27001"),icon:xi,hasSubmenu:!0,submenu:[{id:"iso-scope",label:"Obseg ISMS"},{id:"iso-information-security-policy",label:"IT-varnostne politike"},{id:"iso-audit",label:r("navigation.isoSubmenu.audit")},{id:"iso-risk",label:r("navigation.isoSubmenu.risk")},{id:"iso-controls",label:r("navigation.isoSubmenu.controls")},{id:"iso-vloge-odgovornosti",label:r("navigation.isoSubmenu.rolesAndResponsibilities")},{id:"iso-certification",label:r("navigation.isoSubmenu.certification")},{id:"iso-assets",label:r("navigation.isoSubmenu.assets")},{id:"iso-incident",label:r("navigation.isoSubmenu.incident")},{id:"iso-compliance",label:r("navigation.isoSubmenu.compliance")},{id:"iso-soa",label:r("navigation.isoSubmenu.soa")}]},{id:"zzzpri",label:r("navigation.zzzpri")||"ZZPri",icon:G2,hasSubmenu:!0,submenu:[{id:"zzzpri-prijave",label:r("navigation.zzzpriSubmenu.prijave")||"Prijave"},{id:"zzzpri-zaupniki",label:r("navigation.zzzpriSubmenu.zaupniki")||"Zaupniki"},{id:"zzzpri-obrazci",label:r("navigation.zzzpriSubmenu.obrazci")||"Obrazci"},{id:"zzzpri-postopki",label:r("navigation.zzzpriSubmenu.postopki")||"Postopki"},{id:"zzzpri-porocila",label:r("navigation.zzzpriSubmenu.porocila")||"Poroila"},{id:"zzzpri-statistike",label:r("navigation.zzzpriSubmenu.statistike")||"Statistike"},{id:"zzzpri-dokumentacija",label:r("navigation.zzzpriSubmenu.dokumentacija")||"Dokumentacija"},{id:"zzzpri-nastavitve",label:r("navigation.zzzpriSubmenu.nastavitve")||"Nastavitve"}]},{id:"education",label:r("navigation.education"),icon:hi,hasSubmenu:!0,submenu:[{id:"education-modules",label:r("navigation.educationModules")},{id:"video-education",label:r("navigation.videoEducation")}]},{id:"inventory",label:r("navigation.inventory"),icon:sS,hasSubmenu:!0,submenu:[{id:"inventory-devices",label:r("navigation.inventorySubmenu.devices")},{id:"inventory-software",label:r("navigation.inventorySubmenu.software")},{id:"inventory-licenses",label:r("navigation.inventorySubmenu.licenses")}]},{id:"additional-services",label:"Naroilo storitev",icon:fi,hasSubmenu:!0,submenu:[{id:"it-security-tests-order",label:r("Naroilo IT-testov")},{id:"education-order",label:"Naroilo izobraevanja"},{id:"it-services-order",label:"Naroilo IT-storitev"},{id:"services-quote-order",label:"Naroilo ponudbe"}],showOverview:"additional-services"},{id:"procedures",label:r("navigation.procedures"),icon:ut,hasSubmenu:!0,submenu:[{id:"procedures-list",label:r("navigation.proceduresSubmenu.procedures")},{id:"policies-list",label:r("navigation.proceduresSubmenu.policies")},{id:"templates-list",label:r("navigation.proceduresSubmenu.templates")}]},{id:"support",label:r("navigation.support"),icon:pg,hasSubmenu:!0,submenu:[{id:"support-send-message",label:"Poljite sporoilo"},{id:"support-tickets",label:r("support.table.ticketId")}]},{id:"settings",label:r("navigation.settings"),icon:fi,hasSubmenu:!0,submenu:[{id:"settings-basic",label:r("settings.title")},{id:"settings-advanced",label:r("settings.title")+" - Napredno"}]},{id:"soc",label:"SOC",icon:Mt,hasSubmenu:!1,submenu:[]},{id:"misp",label:"MISP",icon:pt,hasSubmenu:!1,submenu:[]}],[n,i]=z.useState(!1),[o,c]=z.useState([]),[d,p]=z.useState(!1),m=h=>{c(j=>j.includes(h)?j.filter(g=>g!==h):[...j,h])},x=h=>{console.log(" Sidebar: handlePageChange called with page:",h),console.log(" Sidebar: onPageChange function:",typeof t),t(h),d&&i(!1)};z.useEffect(()=>{const h=()=>{p(window.innerWidth<768)};return h(),window.addEventListener("resize",h),()=>window.removeEventListener("resize",h)},[]),z.useEffect(()=>{const h=j=>{j.key==="Escape"&&i(!1)};return n&&(document.addEventListener("keydown",h),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",h),document.body.style.overflow="unset"}},[n]);const b=({isMobileDrawer:h=!1})=>e.jsxs("div",{className:`
      flex flex-col h-full bg-bg-pure-black border-border-subtle
      w-[280px]
    `,children:[e.jsx("div",{className:"h-[64px] flex items-center px-6 border-b border-border-subtle",children:e.jsx(Y2,{size:"md"})}),e.jsx("nav",{className:"flex-1 overflow-y-auto scrollbar-thin py-4 px-4",children:e.jsx("ul",{className:"space-y-1",children:a.map(j=>{const g=j.icon,v=s===j.id||j.showOverview&&s===j.showOverview,_=o.includes(j.id);return e.jsxs("li",{children:[e.jsxs("button",{onClick:()=>{const k=j.showOverview||j.id;x(k),j.hasSubmenu&&m(j.id)},className:`
                    w-full flex items-center justify-between h-[44px] px-4 rounded-sm
                    transition-all duration-250 ease-out min-h-[44px]
                    ${v?"bg-bg-surface-hover text-text-primary border-l-3 border-l-accent-primary":"text-text-secondary hover:bg-bg-surface hover:text-text-primary"}
                  `,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(g,{className:`w-5 h-5 transition-colors duration-150 ${v?"text-accent-primary":""}`}),e.jsx("span",{className:"text-body font-medium",children:j.label})]}),j.hasSubmenu&&(_?e.jsx(sx,{className:"w-4 h-4"}):e.jsx(ax,{className:"w-4 h-4"}))]}),j.hasSubmenu&&_&&j.submenu&&e.jsx("ul",{className:"ml-8 mt-1 mb-2 space-y-1",children:j.submenu.map(k=>e.jsx("li",{children:e.jsx("button",{onClick:()=>x(k.id),className:`
                            w-full text-left px-4 py-2 rounded-sm text-body-sm min-h-[44px]
                            transition-all duration-200
                            ${s===k.id?"bg-bg-surface text-accent-primary font-medium":"text-text-tertiary hover:bg-bg-surface hover:text-text-secondary"}
                          `,children:k.label})},k.id))})]},j.id)})})})]});return d?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>i(!n),className:`
          fixed top-4 left-4 z-[60] p-3 rounded-md bg-bg-surface border border-border-subtle
          hover:bg-bg-surface-hover transition-colors duration-200 min-w-[44px] min-h-[44px]
          flex items-center justify-center
        `,"aria-label":"Odpri meni",children:n?e.jsx(Ar,{className:"w-6 h-6 text-text-primary"}):e.jsx(fS,{className:"w-6 h-6 text-text-primary"})}),n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm z-40 transition-opacity duration-300",onClick:()=>i(!1),"aria-hidden":"true"}),e.jsx("div",{className:`
        fixed top-0 left-0 h-full z-50 transform transition-transform duration-300 ease-in-out
        ${n?"translate-x-0":"-translate-x-full"}
      `,children:e.jsx(b,{isMobileDrawer:!0})})]}):e.jsx("div",{className:"fixed left-0 top-0 h-screen w-[280px] bg-bg-pure-black border-r border-border-subtle flex flex-col",children:e.jsx(b,{})})}const SS=()=>{const{i18n:s}=et(),[t,r]=z.useState(!1),a=z.useRef(null),n=[{code:"sl",name:"Slovenina",flag:""},{code:"en",name:"English",flag:""}],i=n.find(c=>c.code===s.language)||n[0],o=c=>{s.changeLanguage(c),r(!1)};return z.useEffect(()=>{const c=d=>{a.current&&d.target&&!a.current.contains(d.target)&&r(!1)};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[]),e.jsxs("div",{className:"relative",ref:a,children:[e.jsxs("button",{onClick:()=>r(!t),className:"flex items-center space-x-2 px-3 py-2 rounded-lg bg-bg-surface border border-border-subtle hover:border-border-hover transition-colors","aria-label":"Change language",children:[e.jsx(nx,{className:"w-4 h-4 text-text-secondary"}),e.jsx("span",{className:"text-sm font-medium text-text-primary",children:i.flag})]}),t&&e.jsx("div",{className:"absolute right-0 mt-2 w-48 rounded-lg bg-bg-surface border border-border-subtle shadow-lg overflow-hidden z-50",children:n.map(c=>e.jsxs("button",{onClick:()=>o(c.code),className:`w-full flex items-center space-x-3 px-4 py-3 text-left transition-colors ${s.language===c.code?"bg-blue-600/20 text-blue-400":"hover:bg-bg-hover text-text-primary"}`,children:[e.jsx("span",{className:"text-xl",children:c.flag}),e.jsx("span",{className:"text-sm font-medium",children:c.name}),s.language===c.code&&e.jsx("span",{className:"ml-auto text-blue-400",children:""})]},c.code))})]})};function zS({onNavigate:s}){const{user:t,signOut:r}=cr(),{t:a}=et(),[n,i]=z.useState(!1),o=z.useRef(null),c=new Date().toLocaleDateString("sl-SI",{weekday:"long",day:"numeric",month:"long",year:"numeric"});z.useEffect(()=>{function m(b){o.current&&b.target&&!o.current.contains(b.target)&&i(!1)}function x(b){b.key==="Escape"&&i(!1)}return n&&(document.addEventListener("mousedown",m),document.addEventListener("keydown",x)),()=>{document.removeEventListener("mousedown",m),document.removeEventListener("keydown",x)}},[n]);const d=async()=>{try{await Ip({action_type:Lp.LOGOUT,action_description:"Uporabnik se je odjavil iz sistema"}),await r()}catch(m){console.error("Napaka pri odjavi:",m)}},p=m=>{i(!1),s&&s(m)};return e.jsx("header",{className:"fixed top-0 md:left-[280px] left-0 right-0 h-[64px] bg-bg-near-black/95 backdrop-blur-[10px] border-b border-border-subtle z-50",children:e.jsxs("div",{className:"h-full flex items-center justify-between px-4 md:px-8",children:[e.jsx("div",{className:"flex items-center gap-6",children:e.jsx("div",{className:"text-body-sm text-text-secondary capitalize",children:c})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(SS,{}),e.jsxs("div",{className:"relative",ref:o,children:[e.jsxs("button",{onClick:()=>i(!n),className:`h-[40px] flex items-center gap-2 md:gap-3 px-3 md:px-4 bg-bg-surface border border-border-subtle rounded-full 
                         hover:bg-bg-surface-hover hover:border-border-moderate transition-all duration-250 min-h-[44px]`,children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-accent-primary flex items-center justify-center border-2 border-accent-primary",children:e.jsx(en,{className:"w-4 h-4 text-white"})}),e.jsx("span",{className:"text-body-sm font-medium text-text-primary hidden md:inline",children:a("header.myProfile")})]}),n&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>i(!1)}),e.jsx("div",{className:"absolute right-0 mt-2 w-[240px] bg-bg-surface border border-border-subtle rounded-lg shadow-lg z-[60] overflow-hidden animate-in fade-in slide-in-from-top-2 duration-200",children:e.jsxs("div",{className:"py-2",children:[e.jsxs("button",{onClick:()=>p("profile-edit"),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-body-sm text-text-primary hover:bg-bg-surface-hover transition-colors",children:[e.jsx(fi,{className:"w-4 h-4 text-text-secondary"}),e.jsx("span",{children:a("header.editProfile")})]}),e.jsxs("button",{onClick:()=>p("change-password"),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-body-sm text-text-primary hover:bg-bg-surface-hover transition-colors",children:[e.jsx(mg,{className:"w-4 h-4 text-text-secondary"}),e.jsx("span",{children:a("header.changePassword")})]}),e.jsxs("button",{onClick:()=>p("audit-trail"),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-body-sm text-text-primary hover:bg-bg-surface-hover transition-colors",children:[e.jsx(ut,{className:"w-4 h-4 text-text-secondary"}),e.jsx("span",{children:a("header.auditTrail")})]}),e.jsxs("button",{onClick:()=>p("super-admin"),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-body-sm text-text-primary hover:bg-bg-surface-hover transition-colors",children:[e.jsx(ox,{className:"w-4 h-4 text-text-secondary"}),e.jsx("span",{children:a("header.superAdmin")})]}),e.jsx("div",{className:"my-2 border-t border-border-subtle"}),e.jsxs("button",{onClick:d,className:"w-full flex items-center gap-3 px-4 py-3 text-left text-body-sm text-status-error hover:bg-status-error/10 transition-colors",children:[e.jsx(xS,{className:"w-4 h-4"}),e.jsx("span",{children:a("header.logout")})]})]})})]})]})]})]})})}/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function Gp(s){return s+.5|0}const Ql=(s,t,r)=>Math.max(Math.min(s,r),t);function dp(s){return Ql(Gp(s*2.55),0,255)}function ac(s){return Ql(Gp(s*255),0,255)}function ll(s){return Ql(Gp(s/2.55)/100,0,1)}function r0(s){return Ql(Gp(s*100),0,100)}const ui={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Eb=[..."0123456789ABCDEF"],CS=s=>Eb[s&15],PS=s=>Eb[(s&240)>>4]+Eb[s&15],Vm=s=>(s&240)>>4===(s&15),AS=s=>Vm(s.r)&&Vm(s.g)&&Vm(s.b)&&Vm(s.a);function OS(s){var t=s.length,r;return s[0]==="#"&&(t===4||t===5?r={r:255&ui[s[1]]*17,g:255&ui[s[2]]*17,b:255&ui[s[3]]*17,a:t===5?ui[s[4]]*17:255}:(t===7||t===9)&&(r={r:ui[s[1]]<<4|ui[s[2]],g:ui[s[3]]<<4|ui[s[4]],b:ui[s[5]]<<4|ui[s[6]],a:t===9?ui[s[7]]<<4|ui[s[8]]:255})),r}const DS=(s,t)=>s<255?t(s):"";function ES(s){var t=AS(s)?CS:PS;return s?"#"+t(s.r)+t(s.g)+t(s.b)+DS(s.a,t):void 0}const IS=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function J2(s,t,r){const a=t*Math.min(r,1-r),n=(i,o=(i+s/30)%12)=>r-a*Math.max(Math.min(o-3,9-o,1),-1);return[n(0),n(8),n(4)]}function LS(s,t,r){const a=(n,i=(n+s/60)%6)=>r-r*t*Math.max(Math.min(i,4-i,1),0);return[a(5),a(3),a(1)]}function TS(s,t,r){const a=J2(s,1,.5);let n;for(t+r>1&&(n=1/(t+r),t*=n,r*=n),n=0;n<3;n++)a[n]*=1-t-r,a[n]+=t;return a}function RS(s,t,r,a,n){return s===n?(t-r)/a+(t<r?6:0):t===n?(r-s)/a+2:(s-t)/a+4}function fg(s){const r=s.r/255,a=s.g/255,n=s.b/255,i=Math.max(r,a,n),o=Math.min(r,a,n),c=(i+o)/2;let d,p,m;return i!==o&&(m=i-o,p=c>.5?m/(2-i-o):m/(i+o),d=RS(r,a,n,m,i),d=d*60+.5),[d|0,p||0,c]}function bg(s,t,r,a){return(Array.isArray(t)?s(t[0],t[1],t[2]):s(t,r,a)).map(ac)}function gg(s,t,r){return bg(J2,s,t,r)}function MS(s,t,r){return bg(TS,s,t,r)}function FS(s,t,r){return bg(LS,s,t,r)}function X2(s){return(s%360+360)%360}function US(s){const t=IS.exec(s);let r=255,a;if(!t)return;t[5]!==a&&(r=t[6]?dp(+t[5]):ac(+t[5]));const n=X2(+t[2]),i=+t[3]/100,o=+t[4]/100;return t[1]==="hwb"?a=MS(n,i,o):t[1]==="hsv"?a=FS(n,i,o):a=gg(n,i,o),{r:a[0],g:a[1],b:a[2],a:r}}function qS(s,t){var r=fg(s);r[0]=X2(r[0]+t),r=gg(r),s.r=r[0],s.g=r[1],s.b=r[2]}function $S(s){if(!s)return;const t=fg(s),r=t[0],a=r0(t[1]),n=r0(t[2]);return s.a<255?`hsla(${r}, ${a}%, ${n}%, ${ll(s.a)})`:`hsl(${r}, ${a}%, ${n}%)`}const s0={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},a0={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function BS(){const s={},t=Object.keys(a0),r=Object.keys(s0);let a,n,i,o,c;for(a=0;a<t.length;a++){for(o=c=t[a],n=0;n<r.length;n++)i=r[n],c=c.replace(i,s0[i]);i=parseInt(a0[o],16),s[c]=[i>>16&255,i>>8&255,i&255]}return s}let Hm;function VS(s){Hm||(Hm=BS(),Hm.transparent=[0,0,0,0]);const t=Hm[s.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const HS=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function ZS(s){const t=HS.exec(s);let r=255,a,n,i;if(t){if(t[7]!==a){const o=+t[7];r=t[8]?dp(o):Ql(o*255,0,255)}return a=+t[1],n=+t[3],i=+t[5],a=255&(t[2]?dp(a):Ql(a,0,255)),n=255&(t[4]?dp(n):Ql(n,0,255)),i=255&(t[6]?dp(i):Ql(i,0,255)),{r:a,g:n,b:i,a:r}}}function WS(s){return s&&(s.a<255?`rgba(${s.r}, ${s.g}, ${s.b}, ${ll(s.a)})`:`rgb(${s.r}, ${s.g}, ${s.b})`)}const zf=s=>s<=.0031308?s*12.92:Math.pow(s,1/2.4)*1.055-.055,Yd=s=>s<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4);function KS(s,t,r){const a=Yd(ll(s.r)),n=Yd(ll(s.g)),i=Yd(ll(s.b));return{r:ac(zf(a+r*(Yd(ll(t.r))-a))),g:ac(zf(n+r*(Yd(ll(t.g))-n))),b:ac(zf(i+r*(Yd(ll(t.b))-i))),a:s.a+r*(t.a-s.a)}}function Zm(s,t,r){if(s){let a=fg(s);a[t]=Math.max(0,Math.min(a[t]+a[t]*r,t===0?360:1)),a=gg(a),s.r=a[0],s.g=a[1],s.b=a[2]}}function Q2(s,t){return s&&Object.assign(t||{},s)}function n0(s){var t={r:0,g:0,b:0,a:255};return Array.isArray(s)?s.length>=3&&(t={r:s[0],g:s[1],b:s[2],a:255},s.length>3&&(t.a=ac(s[3]))):(t=Q2(s,{r:0,g:0,b:0,a:1}),t.a=ac(t.a)),t}function GS(s){return s.charAt(0)==="r"?ZS(s):US(s)}class Up{constructor(t){if(t instanceof Up)return t;const r=typeof t;let a;r==="object"?a=n0(t):r==="string"&&(a=OS(t)||VS(t)||GS(t)),this._rgb=a,this._valid=!!a}get valid(){return this._valid}get rgb(){var t=Q2(this._rgb);return t&&(t.a=ll(t.a)),t}set rgb(t){this._rgb=n0(t)}rgbString(){return this._valid?WS(this._rgb):void 0}hexString(){return this._valid?ES(this._rgb):void 0}hslString(){return this._valid?$S(this._rgb):void 0}mix(t,r){if(t){const a=this.rgb,n=t.rgb;let i;const o=r===i?.5:r,c=2*o-1,d=a.a-n.a,p=((c*d===-1?c:(c+d)/(1+c*d))+1)/2;i=1-p,a.r=255&p*a.r+i*n.r+.5,a.g=255&p*a.g+i*n.g+.5,a.b=255&p*a.b+i*n.b+.5,a.a=o*a.a+(1-o)*n.a,this.rgb=a}return this}interpolate(t,r){return t&&(this._rgb=KS(this._rgb,t._rgb,r)),this}clone(){return new Up(this.rgb)}alpha(t){return this._rgb.a=ac(t),this}clearer(t){const r=this._rgb;return r.a*=1-t,this}greyscale(){const t=this._rgb,r=Gp(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=r,this}opaquer(t){const r=this._rgb;return r.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return Zm(this._rgb,2,t),this}darken(t){return Zm(this._rgb,2,-t),this}saturate(t){return Zm(this._rgb,1,t),this}desaturate(t){return Zm(this._rgb,1,-t),this}rotate(t){return qS(this._rgb,t),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function rl(){}const YS=(()=>{let s=0;return()=>s++})();function Ua(s){return s==null}function ja(s){if(Array.isArray&&Array.isArray(s))return!0;const t=Object.prototype.toString.call(s);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function Dr(s){return s!==null&&Object.prototype.toString.call(s)==="[object Object]"}function ml(s){return(typeof s=="number"||s instanceof Number)&&isFinite(+s)}function po(s,t){return ml(s)?s:t}function Hr(s,t){return typeof s>"u"?t:s}const JS=(s,t)=>typeof s=="string"&&s.endsWith("%")?parseFloat(s)/100:+s/t,e1=(s,t)=>typeof s=="string"&&s.endsWith("%")?parseFloat(s)/100*t:+s;function is(s,t,r){if(s&&typeof s.call=="function")return s.apply(r,t)}function Vr(s,t,r,a){let n,i,o;if(ja(s))for(i=s.length,n=0;n<i;n++)t.call(r,s[n],n);else if(Dr(s))for(o=Object.keys(s),i=o.length,n=0;n<i;n++)t.call(r,s[o[n]],o[n])}function Rh(s,t){let r,a,n,i;if(!s||!t||s.length!==t.length)return!1;for(r=0,a=s.length;r<a;++r)if(n=s[r],i=t[r],n.datasetIndex!==i.datasetIndex||n.index!==i.index)return!1;return!0}function Mh(s){if(ja(s))return s.map(Mh);if(Dr(s)){const t=Object.create(null),r=Object.keys(s),a=r.length;let n=0;for(;n<a;++n)t[r[n]]=Mh(s[r[n]]);return t}return s}function t1(s){return["__proto__","prototype","constructor"].indexOf(s)===-1}function XS(s,t,r,a){if(!t1(s))return;const n=t[s],i=r[s];Dr(n)&&Dr(i)?qp(n,i,a):t[s]=Mh(i)}function qp(s,t,r){const a=ja(t)?t:[t],n=a.length;if(!Dr(s))return s;r=r||{};const i=r.merger||XS;let o;for(let c=0;c<n;++c){if(o=a[c],!Dr(o))continue;const d=Object.keys(o);for(let p=0,m=d.length;p<m;++p)i(d[p],s,o,r)}return s}function _p(s,t){return qp(s,t,{merger:QS})}function QS(s,t,r){if(!t1(s))return;const a=t[s],n=r[s];Dr(a)&&Dr(n)?_p(a,n):Object.prototype.hasOwnProperty.call(t,s)||(t[s]=Mh(n))}const i0={"":s=>s,x:s=>s.x,y:s=>s.y};function e3(s){const t=s.split("."),r=[];let a="";for(const n of t)a+=n,a.endsWith("\\")?a=a.slice(0,-1)+".":(r.push(a),a="");return r}function t3(s){const t=e3(s);return r=>{for(const a of t){if(a==="")break;r=r&&r[a]}return r}}function $p(s,t){return(i0[t]||(i0[t]=t3(t)))(s)}function vg(s){return s.charAt(0).toUpperCase()+s.slice(1)}const Fh=s=>typeof s<"u",ic=s=>typeof s=="function",o0=(s,t)=>{if(s.size!==t.size)return!1;for(const r of s)if(!t.has(r))return!1;return!0};function r3(s){return s.type==="mouseup"||s.type==="click"||s.type==="contextmenu"}const os=Math.PI,Gs=2*os,Uh=Number.POSITIVE_INFINITY,s3=os/180,ra=os/2,Fc=os/4,l0=os*2/3,c0=Math.sign;function a3(s){const t=[],r=Math.sqrt(s);let a;for(a=1;a<r;a++)s%a===0&&(t.push(a),t.push(s/a));return r===(r|0)&&t.push(r),t.sort((n,i)=>n-i).pop(),t}function n3(s){return typeof s=="symbol"||typeof s=="object"&&s!==null&&!(Symbol.toPrimitive in s||"toString"in s||"valueOf"in s)}function qh(s){return!n3(s)&&!isNaN(parseFloat(s))&&isFinite(s)}function Jc(s){return s*(os/180)}function i3(s){return s*(180/os)}function r1(s,t){const r=t.x-s.x,a=t.y-s.y,n=Math.sqrt(r*r+a*a);let i=Math.atan2(a,r);return i<-.5*os&&(i+=Gs),{angle:i,distance:n}}function o3(s,t){return Math.sqrt(Math.pow(t.x-s.x,2)+Math.pow(t.y-s.y,2))}function go(s){return(s%Gs+Gs)%Gs}function $h(s,t,r,a){const n=go(s),i=go(t),o=go(r),c=go(i-n),d=go(o-n),p=go(n-i),m=go(n-o);return n===i||n===o||a&&i===o||c>d&&p<m}function mi(s,t,r){return Math.max(t,Math.min(r,s))}function l3(s){return mi(s,-32768,32767)}function up(s,t,r,a=1e-6){return s>=Math.min(t,r)-a&&s<=Math.max(t,r)+a}function yg(s,t,r){r=r||(o=>s[o]<t);let a=s.length-1,n=0,i;for(;a-n>1;)i=n+a>>1,r(i)?n=i:a=i;return{lo:n,hi:a}}const Ib=(s,t,r,a)=>yg(s,r,a?n=>{const i=s[n][t];return i<r||i===r&&s[n+1][t]===r}:n=>s[n][t]<r),c3=(s,t,r)=>yg(s,r,a=>s[a][t]>=r);function d3(s,t,r){let a=0,n=s.length;for(;a<n&&s[a]<t;)a++;for(;n>a&&s[n-1]>r;)n--;return a>0||n<s.length?s.slice(a,n):s}const s1=["push","pop","shift","splice","unshift"];function u3(s,t){if(s._chartjs){s._chartjs.listeners.push(t);return}Object.defineProperty(s,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),s1.forEach(r=>{const a="_onData"+vg(r),n=s[r];Object.defineProperty(s,r,{configurable:!0,enumerable:!1,value(...i){const o=n.apply(this,i);return s._chartjs.listeners.forEach(c=>{typeof c[a]=="function"&&c[a](...i)}),o}})})}function d0(s,t){const r=s._chartjs;if(!r)return;const a=r.listeners,n=a.indexOf(t);n!==-1&&a.splice(n,1),!(a.length>0)&&(s1.forEach(i=>{delete s[i]}),delete s._chartjs)}function p3(s){const t=new Set(s);return t.size===s.length?s:Array.from(t)}const a1=(function(){return typeof window>"u"?function(s){return s()}:window.requestAnimationFrame})();function n1(s,t){let r=[],a=!1;return function(...n){r=n,a||(a=!0,a1.call(window,()=>{a=!1,s.apply(t,r)}))}}function m3(s,t){let r;return function(...a){return t?(clearTimeout(r),r=setTimeout(s,t,a)):s.apply(this,a),t}}const i1=s=>s==="start"?"left":s==="end"?"right":"center",Bn=(s,t,r)=>s==="start"?t:s==="end"?r:(t+r)/2,h3=(s,t,r,a)=>s===(a?"left":"right")?r:s==="center"?(t+r)/2:t,Wm=s=>s===0||s===1,u0=(s,t,r)=>-(Math.pow(2,10*(s-=1))*Math.sin((s-t)*Gs/r)),p0=(s,t,r)=>Math.pow(2,-10*s)*Math.sin((s-t)*Gs/r)+1,kp={linear:s=>s,easeInQuad:s=>s*s,easeOutQuad:s=>-s*(s-2),easeInOutQuad:s=>(s/=.5)<1?.5*s*s:-.5*(--s*(s-2)-1),easeInCubic:s=>s*s*s,easeOutCubic:s=>(s-=1)*s*s+1,easeInOutCubic:s=>(s/=.5)<1?.5*s*s*s:.5*((s-=2)*s*s+2),easeInQuart:s=>s*s*s*s,easeOutQuart:s=>-((s-=1)*s*s*s-1),easeInOutQuart:s=>(s/=.5)<1?.5*s*s*s*s:-.5*((s-=2)*s*s*s-2),easeInQuint:s=>s*s*s*s*s,easeOutQuint:s=>(s-=1)*s*s*s*s+1,easeInOutQuint:s=>(s/=.5)<1?.5*s*s*s*s*s:.5*((s-=2)*s*s*s*s+2),easeInSine:s=>-Math.cos(s*ra)+1,easeOutSine:s=>Math.sin(s*ra),easeInOutSine:s=>-.5*(Math.cos(os*s)-1),easeInExpo:s=>s===0?0:Math.pow(2,10*(s-1)),easeOutExpo:s=>s===1?1:-Math.pow(2,-10*s)+1,easeInOutExpo:s=>Wm(s)?s:s<.5?.5*Math.pow(2,10*(s*2-1)):.5*(-Math.pow(2,-10*(s*2-1))+2),easeInCirc:s=>s>=1?s:-(Math.sqrt(1-s*s)-1),easeOutCirc:s=>Math.sqrt(1-(s-=1)*s),easeInOutCirc:s=>(s/=.5)<1?-.5*(Math.sqrt(1-s*s)-1):.5*(Math.sqrt(1-(s-=2)*s)+1),easeInElastic:s=>Wm(s)?s:u0(s,.075,.3),easeOutElastic:s=>Wm(s)?s:p0(s,.075,.3),easeInOutElastic(s){return Wm(s)?s:s<.5?.5*u0(s*2,.1125,.45):.5+.5*p0(s*2-1,.1125,.45)},easeInBack(s){return s*s*((1.70158+1)*s-1.70158)},easeOutBack(s){return(s-=1)*s*((1.70158+1)*s+1.70158)+1},easeInOutBack(s){let t=1.70158;return(s/=.5)<1?.5*(s*s*(((t*=1.525)+1)*s-t)):.5*((s-=2)*s*(((t*=1.525)+1)*s+t)+2)},easeInBounce:s=>1-kp.easeOutBounce(1-s),easeOutBounce(s){return s<1/2.75?7.5625*s*s:s<2/2.75?7.5625*(s-=1.5/2.75)*s+.75:s<2.5/2.75?7.5625*(s-=2.25/2.75)*s+.9375:7.5625*(s-=2.625/2.75)*s+.984375},easeInOutBounce:s=>s<.5?kp.easeInBounce(s*2)*.5:kp.easeOutBounce(s*2-1)*.5+.5};function o1(s){if(s&&typeof s=="object"){const t=s.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function m0(s){return o1(s)?s:new Up(s)}function Cf(s){return o1(s)?s:new Up(s).saturate(.5).darken(.1).hexString()}const x3=["x","y","borderWidth","radius","tension"],f3=["color","borderColor","backgroundColor"];function b3(s){s.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),s.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),s.set("animations",{colors:{type:"color",properties:f3},numbers:{type:"number",properties:x3}}),s.describe("animations",{_fallback:"animation"}),s.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function g3(s){s.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const h0=new Map;function v3(s,t){t=t||{};const r=s+JSON.stringify(t);let a=h0.get(r);return a||(a=new Intl.NumberFormat(s,t),h0.set(r,a)),a}function y3(s,t,r){return v3(t,r).format(s)}const j3={values(s){return ja(s)?s:""+s}};var _3={formatters:j3};function k3(s){s.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,r)=>r.lineWidth,tickColor:(t,r)=>r.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:_3.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),s.route("scale.ticks","color","","color"),s.route("scale.grid","color","","borderColor"),s.route("scale.border","color","","borderColor"),s.route("scale.title","color","","color"),s.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),s.describe("scales",{_fallback:"scale"}),s.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const ad=Object.create(null),Lb=Object.create(null);function Np(s,t){if(!t)return s;const r=t.split(".");for(let a=0,n=r.length;a<n;++a){const i=r[a];s=s[i]||(s[i]=Object.create(null))}return s}function Pf(s,t,r){return typeof t=="string"?qp(Np(s,t),r):qp(Np(s,""),t)}class N3{constructor(t,r){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=a=>a.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(a,n)=>Cf(n.backgroundColor),this.hoverBorderColor=(a,n)=>Cf(n.borderColor),this.hoverColor=(a,n)=>Cf(n.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(r)}set(t,r){return Pf(this,t,r)}get(t){return Np(this,t)}describe(t,r){return Pf(Lb,t,r)}override(t,r){return Pf(ad,t,r)}route(t,r,a,n){const i=Np(this,t),o=Np(this,a),c="_"+r;Object.defineProperties(i,{[c]:{value:i[r],writable:!0},[r]:{enumerable:!0,get(){const d=this[c],p=o[n];return Dr(d)?Object.assign({},p,d):Hr(d,p)},set(d){this[c]=d}}})}apply(t){t.forEach(r=>r(this))}}var Bs=new N3({_scriptable:s=>!s.startsWith("on"),_indexable:s=>s!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[b3,g3,k3]);function w3(s){return!s||Ua(s.size)||Ua(s.family)?null:(s.style?s.style+" ":"")+(s.weight?s.weight+" ":"")+s.size+"px "+s.family}function x0(s,t,r,a,n){let i=t[n];return i||(i=t[n]=s.measureText(n).width,r.push(n)),i>a&&(a=i),a}function Uc(s,t,r){const a=s.currentDevicePixelRatio,n=r!==0?Math.max(r/2,.5):0;return Math.round((t-n)*a)/a+n}function f0(s,t){!t&&!s||(t=t||s.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,s.width,s.height),t.restore())}function b0(s,t,r,a){l1(s,t,r,a,null)}function l1(s,t,r,a,n){let i,o,c,d,p,m,x,b;const h=t.pointStyle,j=t.rotation,g=t.radius;let v=(j||0)*s3;if(h&&typeof h=="object"&&(i=h.toString(),i==="[object HTMLImageElement]"||i==="[object HTMLCanvasElement]")){s.save(),s.translate(r,a),s.rotate(v),s.drawImage(h,-h.width/2,-h.height/2,h.width,h.height),s.restore();return}if(!(isNaN(g)||g<=0)){switch(s.beginPath(),h){default:n?s.ellipse(r,a,n/2,g,0,0,Gs):s.arc(r,a,g,0,Gs),s.closePath();break;case"triangle":m=n?n/2:g,s.moveTo(r+Math.sin(v)*m,a-Math.cos(v)*g),v+=l0,s.lineTo(r+Math.sin(v)*m,a-Math.cos(v)*g),v+=l0,s.lineTo(r+Math.sin(v)*m,a-Math.cos(v)*g),s.closePath();break;case"rectRounded":p=g*.516,d=g-p,o=Math.cos(v+Fc)*d,x=Math.cos(v+Fc)*(n?n/2-p:d),c=Math.sin(v+Fc)*d,b=Math.sin(v+Fc)*(n?n/2-p:d),s.arc(r-x,a-c,p,v-os,v-ra),s.arc(r+b,a-o,p,v-ra,v),s.arc(r+x,a+c,p,v,v+ra),s.arc(r-b,a+o,p,v+ra,v+os),s.closePath();break;case"rect":if(!j){d=Math.SQRT1_2*g,m=n?n/2:d,s.rect(r-m,a-d,2*m,2*d);break}v+=Fc;case"rectRot":x=Math.cos(v)*(n?n/2:g),o=Math.cos(v)*g,c=Math.sin(v)*g,b=Math.sin(v)*(n?n/2:g),s.moveTo(r-x,a-c),s.lineTo(r+b,a-o),s.lineTo(r+x,a+c),s.lineTo(r-b,a+o),s.closePath();break;case"crossRot":v+=Fc;case"cross":x=Math.cos(v)*(n?n/2:g),o=Math.cos(v)*g,c=Math.sin(v)*g,b=Math.sin(v)*(n?n/2:g),s.moveTo(r-x,a-c),s.lineTo(r+x,a+c),s.moveTo(r+b,a-o),s.lineTo(r-b,a+o);break;case"star":x=Math.cos(v)*(n?n/2:g),o=Math.cos(v)*g,c=Math.sin(v)*g,b=Math.sin(v)*(n?n/2:g),s.moveTo(r-x,a-c),s.lineTo(r+x,a+c),s.moveTo(r+b,a-o),s.lineTo(r-b,a+o),v+=Fc,x=Math.cos(v)*(n?n/2:g),o=Math.cos(v)*g,c=Math.sin(v)*g,b=Math.sin(v)*(n?n/2:g),s.moveTo(r-x,a-c),s.lineTo(r+x,a+c),s.moveTo(r+b,a-o),s.lineTo(r-b,a+o);break;case"line":o=n?n/2:Math.cos(v)*g,c=Math.sin(v)*g,s.moveTo(r-o,a-c),s.lineTo(r+o,a+c);break;case"dash":s.moveTo(r,a),s.lineTo(r+Math.cos(v)*(n?n/2:g),a+Math.sin(v)*g);break;case!1:s.closePath();break}s.fill(),t.borderWidth>0&&s.stroke()}}function c1(s,t,r){return r=r||.5,!t||s&&s.x>t.left-r&&s.x<t.right+r&&s.y>t.top-r&&s.y<t.bottom+r}function jg(s,t){s.save(),s.beginPath(),s.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),s.clip()}function _g(s){s.restore()}function S3(s,t){t.translation&&s.translate(t.translation[0],t.translation[1]),Ua(t.rotation)||s.rotate(t.rotation),t.color&&(s.fillStyle=t.color),t.textAlign&&(s.textAlign=t.textAlign),t.textBaseline&&(s.textBaseline=t.textBaseline)}function z3(s,t,r,a,n){if(n.strikethrough||n.underline){const i=s.measureText(a),o=t-i.actualBoundingBoxLeft,c=t+i.actualBoundingBoxRight,d=r-i.actualBoundingBoxAscent,p=r+i.actualBoundingBoxDescent,m=n.strikethrough?(d+p)/2:p;s.strokeStyle=s.fillStyle,s.beginPath(),s.lineWidth=n.decorationWidth||2,s.moveTo(o,m),s.lineTo(c,m),s.stroke()}}function C3(s,t){const r=s.fillStyle;s.fillStyle=t.color,s.fillRect(t.left,t.top,t.width,t.height),s.fillStyle=r}function Bh(s,t,r,a,n,i={}){const o=ja(t)?t:[t],c=i.strokeWidth>0&&i.strokeColor!=="";let d,p;for(s.save(),s.font=n.string,S3(s,i),d=0;d<o.length;++d)p=o[d],i.backdrop&&C3(s,i.backdrop),c&&(i.strokeColor&&(s.strokeStyle=i.strokeColor),Ua(i.strokeWidth)||(s.lineWidth=i.strokeWidth),s.strokeText(p,r,a,i.maxWidth)),s.fillText(p,r,a,i.maxWidth),z3(s,r,a,p,i),a+=Number(n.lineHeight);s.restore()}function Tb(s,t){const{x:r,y:a,w:n,h:i,radius:o}=t;s.arc(r+o.topLeft,a+o.topLeft,o.topLeft,1.5*os,os,!0),s.lineTo(r,a+i-o.bottomLeft),s.arc(r+o.bottomLeft,a+i-o.bottomLeft,o.bottomLeft,os,ra,!0),s.lineTo(r+n-o.bottomRight,a+i),s.arc(r+n-o.bottomRight,a+i-o.bottomRight,o.bottomRight,ra,0,!0),s.lineTo(r+n,a+o.topRight),s.arc(r+n-o.topRight,a+o.topRight,o.topRight,0,-ra,!0),s.lineTo(r+o.topLeft,a)}const P3=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,A3=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function O3(s,t){const r=(""+s).match(P3);if(!r||r[1]==="normal")return t*1.2;switch(s=+r[2],r[3]){case"px":return s;case"%":s/=100;break}return t*s}const D3=s=>+s||0;function kg(s,t){const r={},a=Dr(t),n=a?Object.keys(t):t,i=Dr(s)?a?o=>Hr(s[o],s[t[o]]):o=>s[o]:()=>s;for(const o of n)r[o]=D3(i(o));return r}function E3(s){return kg(s,{top:"y",right:"x",bottom:"y",left:"x"})}function wp(s){return kg(s,["topLeft","topRight","bottomLeft","bottomRight"])}function Vi(s){const t=E3(s);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function Nn(s,t){s=s||{},t=t||Bs.font;let r=Hr(s.size,t.size);typeof r=="string"&&(r=parseInt(r,10));let a=Hr(s.style,t.style);a&&!(""+a).match(A3)&&(console.warn('Invalid font style specified: "'+a+'"'),a=void 0);const n={family:Hr(s.family,t.family),lineHeight:O3(Hr(s.lineHeight,t.lineHeight),r),size:r,style:a,weight:Hr(s.weight,t.weight),string:""};return n.string=w3(n),n}function Km(s,t,r,a){let n,i,o;for(n=0,i=s.length;n<i;++n)if(o=s[n],o!==void 0&&o!==void 0)return o}function I3(s,t,r){const{min:a,max:n}=s,i=e1(t,(n-a)/2),o=(c,d)=>r&&c===0?0:c+d;return{min:o(a,-Math.abs(i)),max:o(n,i)}}function Nu(s,t){return Object.assign(Object.create(s),t)}function Ng(s,t=[""],r,a,n=()=>s[0]){const i=r||s;typeof a>"u"&&(a=m1("_fallback",s));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:s,_rootScopes:i,_fallback:a,_getTarget:n,override:c=>Ng([c,...s],t,i,a)};return new Proxy(o,{deleteProperty(c,d){return delete c[d],delete c._keys,delete s[0][d],!0},get(c,d){return u1(c,d,()=>$3(d,t,s,c))},getOwnPropertyDescriptor(c,d){return Reflect.getOwnPropertyDescriptor(c._scopes[0],d)},getPrototypeOf(){return Reflect.getPrototypeOf(s[0])},has(c,d){return v0(c).includes(d)},ownKeys(c){return v0(c)},set(c,d,p){const m=c._storage||(c._storage=n());return c[d]=m[d]=p,delete c._keys,!0}})}function gu(s,t,r,a){const n={_cacheable:!1,_proxy:s,_context:t,_subProxy:r,_stack:new Set,_descriptors:d1(s,a),setContext:i=>gu(s,i,r,a),override:i=>gu(s.override(i),t,r,a)};return new Proxy(n,{deleteProperty(i,o){return delete i[o],delete s[o],!0},get(i,o,c){return u1(i,o,()=>T3(i,o,c))},getOwnPropertyDescriptor(i,o){return i._descriptors.allKeys?Reflect.has(s,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(s,o)},getPrototypeOf(){return Reflect.getPrototypeOf(s)},has(i,o){return Reflect.has(s,o)},ownKeys(){return Reflect.ownKeys(s)},set(i,o,c){return s[o]=c,delete i[o],!0}})}function d1(s,t={scriptable:!0,indexable:!0}){const{_scriptable:r=t.scriptable,_indexable:a=t.indexable,_allKeys:n=t.allKeys}=s;return{allKeys:n,scriptable:r,indexable:a,isScriptable:ic(r)?r:()=>r,isIndexable:ic(a)?a:()=>a}}const L3=(s,t)=>s?s+vg(t):t,wg=(s,t)=>Dr(t)&&s!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function u1(s,t,r){if(Object.prototype.hasOwnProperty.call(s,t)||t==="constructor")return s[t];const a=r();return s[t]=a,a}function T3(s,t,r){const{_proxy:a,_context:n,_subProxy:i,_descriptors:o}=s;let c=a[t];return ic(c)&&o.isScriptable(t)&&(c=R3(t,c,s,r)),ja(c)&&c.length&&(c=M3(t,c,s,o.isIndexable)),wg(t,c)&&(c=gu(c,n,i&&i[t],o)),c}function R3(s,t,r,a){const{_proxy:n,_context:i,_subProxy:o,_stack:c}=r;if(c.has(s))throw new Error("Recursion detected: "+Array.from(c).join("->")+"->"+s);c.add(s);let d=t(i,o||a);return c.delete(s),wg(s,d)&&(d=Sg(n._scopes,n,s,d)),d}function M3(s,t,r,a){const{_proxy:n,_context:i,_subProxy:o,_descriptors:c}=r;if(typeof i.index<"u"&&a(s))return t[i.index%t.length];if(Dr(t[0])){const d=t,p=n._scopes.filter(m=>m!==d);t=[];for(const m of d){const x=Sg(p,n,s,m);t.push(gu(x,i,o&&o[s],c))}}return t}function p1(s,t,r){return ic(s)?s(t,r):s}const F3=(s,t)=>s===!0?t:typeof s=="string"?$p(t,s):void 0;function U3(s,t,r,a,n){for(const i of t){const o=F3(r,i);if(o){s.add(o);const c=p1(o._fallback,r,n);if(typeof c<"u"&&c!==r&&c!==a)return c}else if(o===!1&&typeof a<"u"&&r!==a)return null}return!1}function Sg(s,t,r,a){const n=t._rootScopes,i=p1(t._fallback,r,a),o=[...s,...n],c=new Set;c.add(a);let d=g0(c,o,r,i||r,a);return d===null||typeof i<"u"&&i!==r&&(d=g0(c,o,i,d,a),d===null)?!1:Ng(Array.from(c),[""],n,i,()=>q3(t,r,a))}function g0(s,t,r,a,n){for(;r;)r=U3(s,t,r,a,n);return r}function q3(s,t,r){const a=s._getTarget();t in a||(a[t]={});const n=a[t];return ja(n)&&Dr(r)?r:n||{}}function $3(s,t,r,a){let n;for(const i of t)if(n=m1(L3(i,s),r),typeof n<"u")return wg(s,n)?Sg(r,a,s,n):n}function m1(s,t){for(const r of t){if(!r)continue;const a=r[s];if(typeof a<"u")return a}}function v0(s){let t=s._keys;return t||(t=s._keys=B3(s._scopes)),t}function B3(s){const t=new Set;for(const r of s)for(const a of Object.keys(r).filter(n=>!n.startsWith("_")))t.add(a);return Array.from(t)}function zg(){return typeof window<"u"&&typeof document<"u"}function Cg(s){let t=s.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function Vh(s,t,r){let a;return typeof s=="string"?(a=parseInt(s,10),s.indexOf("%")!==-1&&(a=a/100*t.parentNode[r])):a=s,a}const lx=s=>s.ownerDocument.defaultView.getComputedStyle(s,null);function V3(s,t){return lx(s).getPropertyValue(t)}const H3=["top","right","bottom","left"];function Xc(s,t,r){const a={};r=r?"-"+r:"";for(let n=0;n<4;n++){const i=H3[n];a[i]=parseFloat(s[t+"-"+i+r])||0}return a.width=a.left+a.right,a.height=a.top+a.bottom,a}const Z3=(s,t,r)=>(s>0||t>0)&&(!r||!r.shadowRoot);function W3(s,t){const r=s.touches,a=r&&r.length?r[0]:s,{offsetX:n,offsetY:i}=a;let o=!1,c,d;if(Z3(n,i,s.target))c=n,d=i;else{const p=t.getBoundingClientRect();c=a.clientX-p.left,d=a.clientY-p.top,o=!0}return{x:c,y:d,box:o}}function Bc(s,t){if("native"in s)return s;const{canvas:r,currentDevicePixelRatio:a}=t,n=lx(r),i=n.boxSizing==="border-box",o=Xc(n,"padding"),c=Xc(n,"border","width"),{x:d,y:p,box:m}=W3(s,r),x=o.left+(m&&c.left),b=o.top+(m&&c.top);let{width:h,height:j}=t;return i&&(h-=o.width+c.width,j-=o.height+c.height),{x:Math.round((d-x)/h*r.width/a),y:Math.round((p-b)/j*r.height/a)}}function K3(s,t,r){let a,n;if(t===void 0||r===void 0){const i=s&&Cg(s);if(!i)t=s.clientWidth,r=s.clientHeight;else{const o=i.getBoundingClientRect(),c=lx(i),d=Xc(c,"border","width"),p=Xc(c,"padding");t=o.width-p.width-d.width,r=o.height-p.height-d.height,a=Vh(c.maxWidth,i,"clientWidth"),n=Vh(c.maxHeight,i,"clientHeight")}}return{width:t,height:r,maxWidth:a||Uh,maxHeight:n||Uh}}const ec=s=>Math.round(s*10)/10;function G3(s,t,r,a){const n=lx(s),i=Xc(n,"margin"),o=Vh(n.maxWidth,s,"clientWidth")||Uh,c=Vh(n.maxHeight,s,"clientHeight")||Uh,d=K3(s,t,r);let{width:p,height:m}=d;if(n.boxSizing==="content-box"){const b=Xc(n,"border","width"),h=Xc(n,"padding");p-=h.width+b.width,m-=h.height+b.height}return p=Math.max(0,p-i.width),m=Math.max(0,a?p/a:m-i.height),p=ec(Math.min(p,o,d.maxWidth)),m=ec(Math.min(m,c,d.maxHeight)),p&&!m&&(m=ec(p/2)),(t!==void 0||r!==void 0)&&a&&d.height&&m>d.height&&(m=d.height,p=ec(Math.floor(m*a))),{width:p,height:m}}function y0(s,t,r){const a=t||1,n=ec(s.height*a),i=ec(s.width*a);s.height=ec(s.height),s.width=ec(s.width);const o=s.canvas;return o.style&&(r||!o.style.height&&!o.style.width)&&(o.style.height=`${s.height}px`,o.style.width=`${s.width}px`),s.currentDevicePixelRatio!==a||o.height!==n||o.width!==i?(s.currentDevicePixelRatio=a,o.height=n,o.width=i,s.ctx.setTransform(a,0,0,a,0,0),!0):!1}const Y3=(function(){let s=!1;try{const t={get passive(){return s=!0,!1}};zg()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return s})();function j0(s,t){const r=V3(s,t),a=r&&r.match(/^(\d+)(\.\d+)?px$/);return a?+a[1]:void 0}const J3=function(s,t){return{x(r){return s+s+t-r},setWidth(r){t=r},textAlign(r){return r==="center"?r:r==="right"?"left":"right"},xPlus(r,a){return r-a},leftForLtr(r,a){return r-a}}},X3=function(){return{x(s){return s},setWidth(s){},textAlign(s){return s},xPlus(s,t){return s+t},leftForLtr(s,t){return s}}};function du(s,t,r){return s?J3(t,r):X3()}function h1(s,t){let r,a;(t==="ltr"||t==="rtl")&&(r=s.canvas.style,a=[r.getPropertyValue("direction"),r.getPropertyPriority("direction")],r.setProperty("direction",t,"important"),s.prevTextDirection=a)}function x1(s,t){t!==void 0&&(delete s.prevTextDirection,s.canvas.style.setProperty("direction",t[0],t[1]))}function Gm(s,t,r){return s.options.clip?s[r]:t[r]}function Q3(s,t){const{xScale:r,yScale:a}=s;return r&&a?{left:Gm(r,t,"left"),right:Gm(r,t,"right"),top:Gm(a,t,"top"),bottom:Gm(a,t,"bottom")}:t}function e6(s,t){const r=t._clip;if(r.disabled)return!1;const a=Q3(t,s.chartArea);return{left:r.left===!1?0:a.left-(r.left===!0?0:r.left),right:r.right===!1?s.width:a.right+(r.right===!0?0:r.right),top:r.top===!1?0:a.top-(r.top===!0?0:r.top),bottom:r.bottom===!1?s.height:a.bottom+(r.bottom===!0?0:r.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class t6{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,r,a,n){const i=r.listeners[n],o=r.duration;i.forEach(c=>c({chart:t,initial:r.initial,numSteps:o,currentStep:Math.min(a-r.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=a1.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let r=0;this._charts.forEach((a,n)=>{if(!a.running||!a.items.length)return;const i=a.items;let o=i.length-1,c=!1,d;for(;o>=0;--o)d=i[o],d._active?(d._total>a.duration&&(a.duration=d._total),d.tick(t),c=!0):(i[o]=i[i.length-1],i.pop());c&&(n.draw(),this._notify(n,a,t,"progress")),i.length||(a.running=!1,this._notify(n,a,t,"complete"),a.initial=!1),r+=i.length}),this._lastDate=t,r===0&&(this._running=!1)}_getAnims(t){const r=this._charts;let a=r.get(t);return a||(a={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},r.set(t,a)),a}listen(t,r,a){this._getAnims(t).listeners[r].push(a)}add(t,r){!r||!r.length||this._getAnims(t).items.push(...r)}has(t){return this._getAnims(t).items.length>0}start(t){const r=this._charts.get(t);r&&(r.running=!0,r.start=Date.now(),r.duration=r.items.reduce((a,n)=>Math.max(a,n._duration),0),this._refresh())}running(t){if(!this._running)return!1;const r=this._charts.get(t);return!(!r||!r.running||!r.items.length)}stop(t){const r=this._charts.get(t);if(!r||!r.items.length)return;const a=r.items;let n=a.length-1;for(;n>=0;--n)a[n].cancel();r.items=[],this._notify(t,r,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var nl=new t6;const _0="transparent",r6={boolean(s,t,r){return r>.5?t:s},color(s,t,r){const a=m0(s||_0),n=a.valid&&m0(t||_0);return n&&n.valid?n.mix(a,r).hexString():t},number(s,t,r){return s+(t-s)*r}};class s6{constructor(t,r,a,n){const i=r[a];n=Km([t.to,n,i,t.from]);const o=Km([t.from,i,n]);this._active=!0,this._fn=t.fn||r6[t.type||typeof o],this._easing=kp[t.easing]||kp.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=r,this._prop=a,this._from=o,this._to=n,this._promises=void 0}active(){return this._active}update(t,r,a){if(this._active){this._notify(!1);const n=this._target[this._prop],i=a-this._start,o=this._duration-i;this._start=a,this._duration=Math.floor(Math.max(o,t.duration)),this._total+=i,this._loop=!!t.loop,this._to=Km([t.to,r,n,t.from]),this._from=Km([t.from,n,r])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const r=t-this._start,a=this._duration,n=this._prop,i=this._from,o=this._loop,c=this._to;let d;if(this._active=i!==c&&(o||r<a),!this._active){this._target[n]=c,this._notify(!0);return}if(r<0){this._target[n]=i;return}d=r/a%2,d=o&&d>1?2-d:d,d=this._easing(Math.min(1,Math.max(0,d))),this._target[n]=this._fn(i,c,d)}wait(){const t=this._promises||(this._promises=[]);return new Promise((r,a)=>{t.push({res:r,rej:a})})}_notify(t){const r=t?"res":"rej",a=this._promises||[];for(let n=0;n<a.length;n++)a[n][r]()}}class f1{constructor(t,r){this._chart=t,this._properties=new Map,this.configure(r)}configure(t){if(!Dr(t))return;const r=Object.keys(Bs.animation),a=this._properties;Object.getOwnPropertyNames(t).forEach(n=>{const i=t[n];if(!Dr(i))return;const o={};for(const c of r)o[c]=i[c];(ja(i.properties)&&i.properties||[n]).forEach(c=>{(c===n||!a.has(c))&&a.set(c,o)})})}_animateOptions(t,r){const a=r.options,n=n6(t,a);if(!n)return[];const i=this._createAnimations(n,a);return a.$shared&&a6(t.options.$animations,a).then(()=>{t.options=a},()=>{}),i}_createAnimations(t,r){const a=this._properties,n=[],i=t.$animations||(t.$animations={}),o=Object.keys(r),c=Date.now();let d;for(d=o.length-1;d>=0;--d){const p=o[d];if(p.charAt(0)==="$")continue;if(p==="options"){n.push(...this._animateOptions(t,r));continue}const m=r[p];let x=i[p];const b=a.get(p);if(x)if(b&&x.active()){x.update(b,m,c);continue}else x.cancel();if(!b||!b.duration){t[p]=m;continue}i[p]=x=new s6(b,t,p,m),n.push(x)}return n}update(t,r){if(this._properties.size===0){Object.assign(t,r);return}const a=this._createAnimations(t,r);if(a.length)return nl.add(this._chart,a),!0}}function a6(s,t){const r=[],a=Object.keys(t);for(let n=0;n<a.length;n++){const i=s[a[n]];i&&i.active()&&r.push(i.wait())}return Promise.all(r)}function n6(s,t){if(!t)return;let r=s.options;if(!r){s.options=t;return}return r.$shared&&(s.options=r=Object.assign({},r,{$shared:!1,$animations:{}})),r}function k0(s,t){const r=s&&s.options||{},a=r.reverse,n=r.min===void 0?t:0,i=r.max===void 0?t:0;return{start:a?i:n,end:a?n:i}}function i6(s,t,r){if(r===!1)return!1;const a=k0(s,r),n=k0(t,r);return{top:n.end,right:a.end,bottom:n.start,left:a.start}}function o6(s){let t,r,a,n;return Dr(s)?(t=s.top,r=s.right,a=s.bottom,n=s.left):t=r=a=n=s,{top:t,right:r,bottom:a,left:n,disabled:s===!1}}function b1(s,t){const r=[],a=s._getSortedDatasetMetas(t);let n,i;for(n=0,i=a.length;n<i;++n)r.push(a[n].index);return r}function N0(s,t,r,a={}){const n=s.keys,i=a.mode==="single";let o,c,d,p;if(t===null)return;let m=!1;for(o=0,c=n.length;o<c;++o){if(d=+n[o],d===r){if(m=!0,a.all)continue;break}p=s.values[d],ml(p)&&(i||t===0||c0(t)===c0(p))&&(t+=p)}return!m&&!a.all?0:t}function l6(s,t){const{iScale:r,vScale:a}=t,n=r.axis==="x"?"x":"y",i=a.axis==="x"?"x":"y",o=Object.keys(s),c=new Array(o.length);let d,p,m;for(d=0,p=o.length;d<p;++d)m=o[d],c[d]={[n]:m,[i]:s[m]};return c}function Af(s,t){const r=s&&s.options.stacked;return r||r===void 0&&t.stack!==void 0}function c6(s,t,r){return`${s.id}.${t.id}.${r.stack||r.type}`}function d6(s){const{min:t,max:r,minDefined:a,maxDefined:n}=s.getUserBounds();return{min:a?t:Number.NEGATIVE_INFINITY,max:n?r:Number.POSITIVE_INFINITY}}function u6(s,t,r){const a=s[t]||(s[t]={});return a[r]||(a[r]={})}function w0(s,t,r,a){for(const n of t.getMatchingVisibleMetas(a).reverse()){const i=s[n.index];if(r&&i>0||!r&&i<0)return n.index}return null}function S0(s,t){const{chart:r,_cachedMeta:a}=s,n=r._stacks||(r._stacks={}),{iScale:i,vScale:o,index:c}=a,d=i.axis,p=o.axis,m=c6(i,o,a),x=t.length;let b;for(let h=0;h<x;++h){const j=t[h],{[d]:g,[p]:v}=j,_=j._stacks||(j._stacks={});b=_[p]=u6(n,m,g),b[c]=v,b._top=w0(b,o,!0,a.type),b._bottom=w0(b,o,!1,a.type);const k=b._visualValues||(b._visualValues={});k[c]=v}}function Of(s,t){const r=s.scales;return Object.keys(r).filter(a=>r[a].axis===t).shift()}function p6(s,t){return Nu(s,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function m6(s,t,r){return Nu(s,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:r,index:t,mode:"default",type:"data"})}function tp(s,t){const r=s.controller.index,a=s.vScale&&s.vScale.axis;if(a){t=t||s._parsed;for(const n of t){const i=n._stacks;if(!i||i[a]===void 0||i[a][r]===void 0)return;delete i[a][r],i[a]._visualValues!==void 0&&i[a]._visualValues[r]!==void 0&&delete i[a]._visualValues[r]}}}const Df=s=>s==="reset"||s==="none",z0=(s,t)=>t?s:Object.assign({},s),h6=(s,t,r)=>s&&!t.hidden&&t._stacked&&{keys:b1(r,!0),values:null};class Sp{constructor(t,r){this.chart=t,this._ctx=t.ctx,this.index=r,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=Af(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&tp(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,r=this._cachedMeta,a=this.getDataset(),n=(x,b,h,j)=>x==="x"?b:x==="r"?j:h,i=r.xAxisID=Hr(a.xAxisID,Of(t,"x")),o=r.yAxisID=Hr(a.yAxisID,Of(t,"y")),c=r.rAxisID=Hr(a.rAxisID,Of(t,"r")),d=r.indexAxis,p=r.iAxisID=n(d,i,o,c),m=r.vAxisID=n(d,o,i,c);r.xScale=this.getScaleForId(i),r.yScale=this.getScaleForId(o),r.rScale=this.getScaleForId(c),r.iScale=this.getScaleForId(p),r.vScale=this.getScaleForId(m)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const r=this._cachedMeta;return t===r.iScale?r.vScale:r.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&d0(this._data,this),t._stacked&&tp(t)}_dataCheck(){const t=this.getDataset(),r=t.data||(t.data=[]),a=this._data;if(Dr(r)){const n=this._cachedMeta;this._data=l6(r,n)}else if(a!==r){if(a){d0(a,this);const n=this._cachedMeta;tp(n),n._parsed=[]}r&&Object.isExtensible(r)&&u3(r,this),this._syncList=[],this._data=r}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const r=this._cachedMeta,a=this.getDataset();let n=!1;this._dataCheck();const i=r._stacked;r._stacked=Af(r.vScale,r),r.stack!==a.stack&&(n=!0,tp(r),r.stack=a.stack),this._resyncElements(t),(n||i!==r._stacked)&&(S0(this,r._parsed),r._stacked=Af(r.vScale,r))}configure(){const t=this.chart.config,r=t.datasetScopeKeys(this._type),a=t.getOptionScopes(this.getDataset(),r,!0);this.options=t.createResolver(a,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,r){const{_cachedMeta:a,_data:n}=this,{iScale:i,_stacked:o}=a,c=i.axis;let d=t===0&&r===n.length?!0:a._sorted,p=t>0&&a._parsed[t-1],m,x,b;if(this._parsing===!1)a._parsed=n,a._sorted=!0,b=n;else{ja(n[t])?b=this.parseArrayData(a,n,t,r):Dr(n[t])?b=this.parseObjectData(a,n,t,r):b=this.parsePrimitiveData(a,n,t,r);const h=()=>x[c]===null||p&&x[c]<p[c];for(m=0;m<r;++m)a._parsed[m+t]=x=b[m],d&&(h()&&(d=!1),p=x);a._sorted=d}o&&S0(this,b)}parsePrimitiveData(t,r,a,n){const{iScale:i,vScale:o}=t,c=i.axis,d=o.axis,p=i.getLabels(),m=i===o,x=new Array(n);let b,h,j;for(b=0,h=n;b<h;++b)j=b+a,x[b]={[c]:m||i.parse(p[j],j),[d]:o.parse(r[j],j)};return x}parseArrayData(t,r,a,n){const{xScale:i,yScale:o}=t,c=new Array(n);let d,p,m,x;for(d=0,p=n;d<p;++d)m=d+a,x=r[m],c[d]={x:i.parse(x[0],m),y:o.parse(x[1],m)};return c}parseObjectData(t,r,a,n){const{xScale:i,yScale:o}=t,{xAxisKey:c="x",yAxisKey:d="y"}=this._parsing,p=new Array(n);let m,x,b,h;for(m=0,x=n;m<x;++m)b=m+a,h=r[b],p[m]={x:i.parse($p(h,c),b),y:o.parse($p(h,d),b)};return p}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,r,a){const n=this.chart,i=this._cachedMeta,o=r[t.axis],c={keys:b1(n,!0),values:r._stacks[t.axis]._visualValues};return N0(c,o,i.index,{mode:a})}updateRangeFromParsed(t,r,a,n){const i=a[r.axis];let o=i===null?NaN:i;const c=n&&a._stacks[r.axis];n&&c&&(n.values=c,o=N0(n,i,this._cachedMeta.index)),t.min=Math.min(t.min,o),t.max=Math.max(t.max,o)}getMinMax(t,r){const a=this._cachedMeta,n=a._parsed,i=a._sorted&&t===a.iScale,o=n.length,c=this._getOtherScale(t),d=h6(r,a,this.chart),p={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:m,max:x}=d6(c);let b,h;function j(){h=n[b];const g=h[c.axis];return!ml(h[t.axis])||m>g||x<g}for(b=0;b<o&&!(!j()&&(this.updateRangeFromParsed(p,t,h,d),i));++b);if(i){for(b=o-1;b>=0;--b)if(!j()){this.updateRangeFromParsed(p,t,h,d);break}}return p}getAllParsedValues(t){const r=this._cachedMeta._parsed,a=[];let n,i,o;for(n=0,i=r.length;n<i;++n)o=r[n][t.axis],ml(o)&&a.push(o);return a}getMaxOverflow(){return!1}getLabelAndValue(t){const r=this._cachedMeta,a=r.iScale,n=r.vScale,i=this.getParsed(t);return{label:a?""+a.getLabelForValue(i[a.axis]):"",value:n?""+n.getLabelForValue(i[n.axis]):""}}_update(t){const r=this._cachedMeta;this.update(t||"default"),r._clip=o6(Hr(this.options.clip,i6(r.xScale,r.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,r=this.chart,a=this._cachedMeta,n=a.data||[],i=r.chartArea,o=[],c=this._drawStart||0,d=this._drawCount||n.length-c,p=this.options.drawActiveElementsOnTop;let m;for(a.dataset&&a.dataset.draw(t,i,c,d),m=c;m<c+d;++m){const x=n[m];x.hidden||(x.active&&p?o.push(x):x.draw(t,i))}for(m=0;m<o.length;++m)o[m].draw(t,i)}getStyle(t,r){const a=r?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(a):this.resolveDataElementOptions(t||0,a)}getContext(t,r,a){const n=this.getDataset();let i;if(t>=0&&t<this._cachedMeta.data.length){const o=this._cachedMeta.data[t];i=o.$context||(o.$context=m6(this.getContext(),t,o)),i.parsed=this.getParsed(t),i.raw=n.data[t],i.index=i.dataIndex=t}else i=this.$context||(this.$context=p6(this.chart.getContext(),this.index)),i.dataset=n,i.index=i.datasetIndex=this.index;return i.active=!!r,i.mode=a,i}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,r){return this._resolveElementOptions(this.dataElementType.id,r,t)}_resolveElementOptions(t,r="default",a){const n=r==="active",i=this._cachedDataOpts,o=t+"-"+r,c=i[o],d=this.enableOptionSharing&&Fh(a);if(c)return z0(c,d);const p=this.chart.config,m=p.datasetElementScopeKeys(this._type,t),x=n?[`${t}Hover`,"hover",t,""]:[t,""],b=p.getOptionScopes(this.getDataset(),m),h=Object.keys(Bs.elements[t]),j=()=>this.getContext(a,n,r),g=p.resolveNamedOptions(b,h,j,x);return g.$shared&&(g.$shared=d,i[o]=Object.freeze(z0(g,d))),g}_resolveAnimations(t,r,a){const n=this.chart,i=this._cachedDataOpts,o=`animation-${r}`,c=i[o];if(c)return c;let d;if(n.options.animation!==!1){const m=this.chart.config,x=m.datasetAnimationScopeKeys(this._type,r),b=m.getOptionScopes(this.getDataset(),x);d=m.createResolver(b,this.getContext(t,a,r))}const p=new f1(n,d&&d.animations);return d&&d._cacheable&&(i[o]=Object.freeze(p)),p}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,r){return!r||Df(t)||this.chart._animationsDisabled}_getSharedOptions(t,r){const a=this.resolveDataElementOptions(t,r),n=this._sharedOptions,i=this.getSharedOptions(a),o=this.includeOptions(r,i)||i!==n;return this.updateSharedOptions(i,r,a),{sharedOptions:i,includeOptions:o}}updateElement(t,r,a,n){Df(n)?Object.assign(t,a):this._resolveAnimations(r,n).update(t,a)}updateSharedOptions(t,r,a){t&&!Df(r)&&this._resolveAnimations(void 0,r).update(t,a)}_setStyle(t,r,a,n){t.active=n;const i=this.getStyle(r,n);this._resolveAnimations(r,a,n).update(t,{options:!n&&this.getSharedOptions(i)||i})}removeHoverStyle(t,r,a){this._setStyle(t,a,"active",!1)}setHoverStyle(t,r,a){this._setStyle(t,a,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const r=this._data,a=this._cachedMeta.data;for(const[c,d,p]of this._syncList)this[c](d,p);this._syncList=[];const n=a.length,i=r.length,o=Math.min(i,n);o&&this.parse(0,o),i>n?this._insertElements(n,i-n,t):i<n&&this._removeElements(i,n-i)}_insertElements(t,r,a=!0){const n=this._cachedMeta,i=n.data,o=t+r;let c;const d=p=>{for(p.length+=r,c=p.length-1;c>=o;c--)p[c]=p[c-r]};for(d(i),c=t;c<o;++c)i[c]=new this.dataElementType;this._parsing&&d(n._parsed),this.parse(t,r),a&&this.updateElements(i,t,r,"reset")}updateElements(t,r,a,n){}_removeElements(t,r){const a=this._cachedMeta;if(this._parsing){const n=a._parsed.splice(t,r);a._stacked&&tp(a,n)}a.data.splice(t,r)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[r,a,n]=t;this[r](a,n)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,r){r&&this._sync(["_removeElements",t,r]);const a=arguments.length-2;a&&this._sync(["_insertElements",t,a])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}ft(Sp,"defaults",{}),ft(Sp,"datasetElementType",null),ft(Sp,"dataElementType",null);function x6(s,t,r){let a=1,n=1,i=0,o=0;if(t<Gs){const c=s,d=c+t,p=Math.cos(c),m=Math.sin(c),x=Math.cos(d),b=Math.sin(d),h=(P,L,F)=>$h(P,c,d,!0)?1:Math.max(L,L*r,F,F*r),j=(P,L,F)=>$h(P,c,d,!0)?-1:Math.min(L,L*r,F,F*r),g=h(0,p,x),v=h(ra,m,b),_=j(os,p,x),k=j(os+ra,m,b);a=(g-_)/2,n=(v-k)/2,i=-(g+_)/2,o=-(v+k)/2}return{ratioX:a,ratioY:n,offsetX:i,offsetY:o}}class pp extends Sp{constructor(t,r){super(t,r),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,r){const a=this.getDataset().data,n=this._cachedMeta;if(this._parsing===!1)n._parsed=a;else{let i=d=>+a[d];if(Dr(a[t])){const{key:d="value"}=this._parsing;i=p=>+$p(a[p],d)}let o,c;for(o=t,c=t+r;o<c;++o)n._parsed[o]=i(o)}}_getRotation(){return Jc(this.options.rotation-90)}_getCircumference(){return Jc(this.options.circumference)}_getRotationExtents(){let t=Gs,r=-Gs;for(let a=0;a<this.chart.data.datasets.length;++a)if(this.chart.isDatasetVisible(a)&&this.chart.getDatasetMeta(a).type===this._type){const n=this.chart.getDatasetMeta(a).controller,i=n._getRotation(),o=n._getCircumference();t=Math.min(t,i),r=Math.max(r,i+o)}return{rotation:t,circumference:r-t}}update(t){const r=this.chart,{chartArea:a}=r,n=this._cachedMeta,i=n.data,o=this.getMaxBorderWidth()+this.getMaxOffset(i)+this.options.spacing,c=Math.max((Math.min(a.width,a.height)-o)/2,0),d=Math.min(JS(this.options.cutout,c),1),p=this._getRingWeight(this.index),{circumference:m,rotation:x}=this._getRotationExtents(),{ratioX:b,ratioY:h,offsetX:j,offsetY:g}=x6(x,m,d),v=(a.width-o)/b,_=(a.height-o)/h,k=Math.max(Math.min(v,_)/2,0),P=e1(this.options.radius,k),L=Math.max(P*d,0),F=(P-L)/this._getVisibleDatasetWeightTotal();this.offsetX=j*P,this.offsetY=g*P,n.total=this.calculateTotal(),this.outerRadius=P-F*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-F*p,0),this.updateElements(i,0,i.length,t)}_circumference(t,r){const a=this.options,n=this._cachedMeta,i=this._getCircumference();return r&&a.animation.animateRotate||!this.chart.getDataVisibility(t)||n._parsed[t]===null||n.data[t].hidden?0:this.calculateCircumference(n._parsed[t]*i/Gs)}updateElements(t,r,a,n){const i=n==="reset",o=this.chart,c=o.chartArea,p=o.options.animation,m=(c.left+c.right)/2,x=(c.top+c.bottom)/2,b=i&&p.animateScale,h=b?0:this.innerRadius,j=b?0:this.outerRadius,{sharedOptions:g,includeOptions:v}=this._getSharedOptions(r,n);let _=this._getRotation(),k;for(k=0;k<r;++k)_+=this._circumference(k,i);for(k=r;k<r+a;++k){const P=this._circumference(k,i),L=t[k],F={x:m+this.offsetX,y:x+this.offsetY,startAngle:_,endAngle:_+P,circumference:P,outerRadius:j,innerRadius:h};v&&(F.options=g||this.resolveDataElementOptions(k,L.active?"active":n)),_+=P,this.updateElement(L,k,F,n)}}calculateTotal(){const t=this._cachedMeta,r=t.data;let a=0,n;for(n=0;n<r.length;n++){const i=t._parsed[n];i!==null&&!isNaN(i)&&this.chart.getDataVisibility(n)&&!r[n].hidden&&(a+=Math.abs(i))}return a}calculateCircumference(t){const r=this._cachedMeta.total;return r>0&&!isNaN(t)?Gs*(Math.abs(t)/r):0}getLabelAndValue(t){const r=this._cachedMeta,a=this.chart,n=a.data.labels||[],i=y3(r._parsed[t],a.options.locale);return{label:n[t]||"",value:i}}getMaxBorderWidth(t){let r=0;const a=this.chart;let n,i,o,c,d;if(!t){for(n=0,i=a.data.datasets.length;n<i;++n)if(a.isDatasetVisible(n)){o=a.getDatasetMeta(n),t=o.data,c=o.controller;break}}if(!t)return 0;for(n=0,i=t.length;n<i;++n)d=c.resolveDataElementOptions(n),d.borderAlign!=="inner"&&(r=Math.max(r,d.borderWidth||0,d.hoverBorderWidth||0));return r}getMaxOffset(t){let r=0;for(let a=0,n=t.length;a<n;++a){const i=this.resolveDataElementOptions(a);r=Math.max(r,i.offset||0,i.hoverOffset||0)}return r}_getRingWeightOffset(t){let r=0;for(let a=0;a<t;++a)this.chart.isDatasetVisible(a)&&(r+=this._getRingWeight(a));return r}_getRingWeight(t){return Math.max(Hr(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}ft(pp,"id","doughnut"),ft(pp,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),ft(pp,"descriptors",{_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")}),ft(pp,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const r=t.data,{labels:{pointStyle:a,textAlign:n,color:i,useBorderRadius:o,borderRadius:c}}=t.legend.options;return r.labels.length&&r.datasets.length?r.labels.map((d,p)=>{const x=t.getDatasetMeta(0).controller.getStyle(p);return{text:d,fillStyle:x.backgroundColor,fontColor:i,hidden:!t.getDataVisibility(p),lineDash:x.borderDash,lineDashOffset:x.borderDashOffset,lineJoin:x.borderJoinStyle,lineWidth:x.borderWidth,strokeStyle:x.borderColor,textAlign:n,pointStyle:a,borderRadius:o&&(c||x.borderRadius),index:p}}):[]}},onClick(t,r,a){a.chart.toggleDataVisibility(r.index),a.chart.update()}}}});function qc(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Pg{constructor(t){ft(this,"options");this.options=t||{}}static override(t){Object.assign(Pg.prototype,t)}init(){}formats(){return qc()}parse(){return qc()}format(){return qc()}add(){return qc()}diff(){return qc()}startOf(){return qc()}endOf(){return qc()}}var f6={_date:Pg};function b6(s,t,r,a){const{controller:n,data:i,_sorted:o}=s,c=n._cachedMeta.iScale,d=s.dataset&&s.dataset.options?s.dataset.options.spanGaps:null;if(c&&t===c.axis&&t!=="r"&&o&&i.length){const p=c._reversePixels?c3:Ib;if(a){if(n._sharedOptions){const m=i[0],x=typeof m.getRange=="function"&&m.getRange(t);if(x){const b=p(i,t,r-x),h=p(i,t,r+x);return{lo:b.lo,hi:h.hi}}}}else{const m=p(i,t,r);if(d){const{vScale:x}=n._cachedMeta,{_parsed:b}=s,h=b.slice(0,m.lo+1).reverse().findIndex(g=>!Ua(g[x.axis]));m.lo-=Math.max(0,h);const j=b.slice(m.hi).findIndex(g=>!Ua(g[x.axis]));m.hi+=Math.max(0,j)}return m}}return{lo:0,hi:i.length-1}}function cx(s,t,r,a,n){const i=s.getSortedVisibleDatasetMetas(),o=r[t];for(let c=0,d=i.length;c<d;++c){const{index:p,data:m}=i[c],{lo:x,hi:b}=b6(i[c],t,o,n);for(let h=x;h<=b;++h){const j=m[h];j.skip||a(j,p,h)}}}function g6(s){const t=s.indexOf("x")!==-1,r=s.indexOf("y")!==-1;return function(a,n){const i=t?Math.abs(a.x-n.x):0,o=r?Math.abs(a.y-n.y):0;return Math.sqrt(Math.pow(i,2)+Math.pow(o,2))}}function Ef(s,t,r,a,n){const i=[];return!n&&!s.isPointInArea(t)||cx(s,r,t,function(c,d,p){!n&&!c1(c,s.chartArea,0)||c.inRange(t.x,t.y,a)&&i.push({element:c,datasetIndex:d,index:p})},!0),i}function v6(s,t,r,a){let n=[];function i(o,c,d){const{startAngle:p,endAngle:m}=o.getProps(["startAngle","endAngle"],a),{angle:x}=r1(o,{x:t.x,y:t.y});$h(x,p,m)&&n.push({element:o,datasetIndex:c,index:d})}return cx(s,r,t,i),n}function y6(s,t,r,a,n,i){let o=[];const c=g6(r);let d=Number.POSITIVE_INFINITY;function p(m,x,b){const h=m.inRange(t.x,t.y,n);if(a&&!h)return;const j=m.getCenterPoint(n);if(!(!!i||s.isPointInArea(j))&&!h)return;const v=c(t,j);v<d?(o=[{element:m,datasetIndex:x,index:b}],d=v):v===d&&o.push({element:m,datasetIndex:x,index:b})}return cx(s,r,t,p),o}function If(s,t,r,a,n,i){return!i&&!s.isPointInArea(t)?[]:r==="r"&&!a?v6(s,t,r,n):y6(s,t,r,a,n,i)}function C0(s,t,r,a,n){const i=[],o=r==="x"?"inXRange":"inYRange";let c=!1;return cx(s,r,t,(d,p,m)=>{d[o]&&d[o](t[r],n)&&(i.push({element:d,datasetIndex:p,index:m}),c=c||d.inRange(t.x,t.y,n))}),a&&!c?[]:i}var j6={modes:{index(s,t,r,a){const n=Bc(t,s),i=r.axis||"x",o=r.includeInvisible||!1,c=r.intersect?Ef(s,n,i,a,o):If(s,n,i,!1,a,o),d=[];return c.length?(s.getSortedVisibleDatasetMetas().forEach(p=>{const m=c[0].index,x=p.data[m];x&&!x.skip&&d.push({element:x,datasetIndex:p.index,index:m})}),d):[]},dataset(s,t,r,a){const n=Bc(t,s),i=r.axis||"xy",o=r.includeInvisible||!1;let c=r.intersect?Ef(s,n,i,a,o):If(s,n,i,!1,a,o);if(c.length>0){const d=c[0].datasetIndex,p=s.getDatasetMeta(d).data;c=[];for(let m=0;m<p.length;++m)c.push({element:p[m],datasetIndex:d,index:m})}return c},point(s,t,r,a){const n=Bc(t,s),i=r.axis||"xy",o=r.includeInvisible||!1;return Ef(s,n,i,a,o)},nearest(s,t,r,a){const n=Bc(t,s),i=r.axis||"xy",o=r.includeInvisible||!1;return If(s,n,i,r.intersect,a,o)},x(s,t,r,a){const n=Bc(t,s);return C0(s,n,"x",r.intersect,a)},y(s,t,r,a){const n=Bc(t,s);return C0(s,n,"y",r.intersect,a)}}};const g1=["left","top","right","bottom"];function rp(s,t){return s.filter(r=>r.pos===t)}function P0(s,t){return s.filter(r=>g1.indexOf(r.pos)===-1&&r.box.axis===t)}function sp(s,t){return s.sort((r,a)=>{const n=t?a:r,i=t?r:a;return n.weight===i.weight?n.index-i.index:n.weight-i.weight})}function _6(s){const t=[];let r,a,n,i,o,c;for(r=0,a=(s||[]).length;r<a;++r)n=s[r],{position:i,options:{stack:o,stackWeight:c=1}}=n,t.push({index:r,box:n,pos:i,horizontal:n.isHorizontal(),weight:n.weight,stack:o&&i+o,stackWeight:c});return t}function k6(s){const t={};for(const r of s){const{stack:a,pos:n,stackWeight:i}=r;if(!a||!g1.includes(n))continue;const o=t[a]||(t[a]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=i}return t}function N6(s,t){const r=k6(s),{vBoxMaxWidth:a,hBoxMaxHeight:n}=t;let i,o,c;for(i=0,o=s.length;i<o;++i){c=s[i];const{fullSize:d}=c.box,p=r[c.stack],m=p&&c.stackWeight/p.weight;c.horizontal?(c.width=m?m*a:d&&t.availableWidth,c.height=n):(c.width=a,c.height=m?m*n:d&&t.availableHeight)}return r}function w6(s){const t=_6(s),r=sp(t.filter(p=>p.box.fullSize),!0),a=sp(rp(t,"left"),!0),n=sp(rp(t,"right")),i=sp(rp(t,"top"),!0),o=sp(rp(t,"bottom")),c=P0(t,"x"),d=P0(t,"y");return{fullSize:r,leftAndTop:a.concat(i),rightAndBottom:n.concat(d).concat(o).concat(c),chartArea:rp(t,"chartArea"),vertical:a.concat(n).concat(d),horizontal:i.concat(o).concat(c)}}function A0(s,t,r,a){return Math.max(s[r],t[r])+Math.max(s[a],t[a])}function v1(s,t){s.top=Math.max(s.top,t.top),s.left=Math.max(s.left,t.left),s.bottom=Math.max(s.bottom,t.bottom),s.right=Math.max(s.right,t.right)}function S6(s,t,r,a){const{pos:n,box:i}=r,o=s.maxPadding;if(!Dr(n)){r.size&&(s[n]-=r.size);const x=a[r.stack]||{size:0,count:1};x.size=Math.max(x.size,r.horizontal?i.height:i.width),r.size=x.size/x.count,s[n]+=r.size}i.getPadding&&v1(o,i.getPadding());const c=Math.max(0,t.outerWidth-A0(o,s,"left","right")),d=Math.max(0,t.outerHeight-A0(o,s,"top","bottom")),p=c!==s.w,m=d!==s.h;return s.w=c,s.h=d,r.horizontal?{same:p,other:m}:{same:m,other:p}}function z6(s){const t=s.maxPadding;function r(a){const n=Math.max(t[a]-s[a],0);return s[a]+=n,n}s.y+=r("top"),s.x+=r("left"),r("right"),r("bottom")}function C6(s,t){const r=t.maxPadding;function a(n){const i={left:0,top:0,right:0,bottom:0};return n.forEach(o=>{i[o]=Math.max(t[o],r[o])}),i}return a(s?["left","right"]:["top","bottom"])}function mp(s,t,r,a){const n=[];let i,o,c,d,p,m;for(i=0,o=s.length,p=0;i<o;++i){c=s[i],d=c.box,d.update(c.width||t.w,c.height||t.h,C6(c.horizontal,t));const{same:x,other:b}=S6(t,r,c,a);p|=x&&n.length,m=m||b,d.fullSize||n.push(c)}return p&&mp(n,t,r,a)||m}function Ym(s,t,r,a,n){s.top=r,s.left=t,s.right=t+a,s.bottom=r+n,s.width=a,s.height=n}function O0(s,t,r,a){const n=r.padding;let{x:i,y:o}=t;for(const c of s){const d=c.box,p=a[c.stack]||{placed:0,weight:1},m=c.stackWeight/p.weight||1;if(c.horizontal){const x=t.w*m,b=p.size||d.height;Fh(p.start)&&(o=p.start),d.fullSize?Ym(d,n.left,o,r.outerWidth-n.right-n.left,b):Ym(d,t.left+p.placed,o,x,b),p.start=o,p.placed+=x,o=d.bottom}else{const x=t.h*m,b=p.size||d.width;Fh(p.start)&&(i=p.start),d.fullSize?Ym(d,i,n.top,b,r.outerHeight-n.bottom-n.top):Ym(d,i,t.top+p.placed,b,x),p.start=i,p.placed+=x,i=d.right}}t.x=i,t.y=o}var tc={addBox(s,t){s.boxes||(s.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(r){t.draw(r)}}]},s.boxes.push(t)},removeBox(s,t){const r=s.boxes?s.boxes.indexOf(t):-1;r!==-1&&s.boxes.splice(r,1)},configure(s,t,r){t.fullSize=r.fullSize,t.position=r.position,t.weight=r.weight},update(s,t,r,a){if(!s)return;const n=Vi(s.options.layout.padding),i=Math.max(t-n.width,0),o=Math.max(r-n.height,0),c=w6(s.boxes),d=c.vertical,p=c.horizontal;Vr(s.boxes,g=>{typeof g.beforeLayout=="function"&&g.beforeLayout()});const m=d.reduce((g,v)=>v.box.options&&v.box.options.display===!1?g:g+1,0)||1,x=Object.freeze({outerWidth:t,outerHeight:r,padding:n,availableWidth:i,availableHeight:o,vBoxMaxWidth:i/2/m,hBoxMaxHeight:o/2}),b=Object.assign({},n);v1(b,Vi(a));const h=Object.assign({maxPadding:b,w:i,h:o,x:n.left,y:n.top},n),j=N6(d.concat(p),x);mp(c.fullSize,h,x,j),mp(d,h,x,j),mp(p,h,x,j)&&mp(d,h,x,j),z6(h),O0(c.leftAndTop,h,x,j),h.x+=h.w,h.y+=h.h,O0(c.rightAndBottom,h,x,j),s.chartArea={left:h.left,top:h.top,right:h.left+h.w,bottom:h.top+h.h,height:h.h,width:h.w},Vr(c.chartArea,g=>{const v=g.box;Object.assign(v,s.chartArea),v.update(h.w,h.h,{left:0,top:0,right:0,bottom:0})})}};class y1{acquireContext(t,r){}releaseContext(t){return!1}addEventListener(t,r,a){}removeEventListener(t,r,a){}getDevicePixelRatio(){return 1}getMaximumSize(t,r,a,n){return r=Math.max(0,r||t.width),a=a||t.height,{width:r,height:Math.max(0,n?Math.floor(r/n):a)}}isAttached(t){return!0}updateConfig(t){}}class P6 extends y1{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const fh="$chartjs",A6={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},D0=s=>s===null||s==="";function O6(s,t){const r=s.style,a=s.getAttribute("height"),n=s.getAttribute("width");if(s[fh]={initial:{height:a,width:n,style:{display:r.display,height:r.height,width:r.width}}},r.display=r.display||"block",r.boxSizing=r.boxSizing||"border-box",D0(n)){const i=j0(s,"width");i!==void 0&&(s.width=i)}if(D0(a))if(s.style.height==="")s.height=s.width/(t||2);else{const i=j0(s,"height");i!==void 0&&(s.height=i)}return s}const j1=Y3?{passive:!0}:!1;function D6(s,t,r){s&&s.addEventListener(t,r,j1)}function E6(s,t,r){s&&s.canvas&&s.canvas.removeEventListener(t,r,j1)}function I6(s,t){const r=A6[s.type]||s.type,{x:a,y:n}=Bc(s,t);return{type:r,chart:t,native:s,x:a!==void 0?a:null,y:n!==void 0?n:null}}function Hh(s,t){for(const r of s)if(r===t||r.contains(t))return!0}function L6(s,t,r){const a=s.canvas,n=new MutationObserver(i=>{let o=!1;for(const c of i)o=o||Hh(c.addedNodes,a),o=o&&!Hh(c.removedNodes,a);o&&r()});return n.observe(document,{childList:!0,subtree:!0}),n}function T6(s,t,r){const a=s.canvas,n=new MutationObserver(i=>{let o=!1;for(const c of i)o=o||Hh(c.removedNodes,a),o=o&&!Hh(c.addedNodes,a);o&&r()});return n.observe(document,{childList:!0,subtree:!0}),n}const Bp=new Map;let E0=0;function _1(){const s=window.devicePixelRatio;s!==E0&&(E0=s,Bp.forEach((t,r)=>{r.currentDevicePixelRatio!==s&&t()}))}function R6(s,t){Bp.size||window.addEventListener("resize",_1),Bp.set(s,t)}function M6(s){Bp.delete(s),Bp.size||window.removeEventListener("resize",_1)}function F6(s,t,r){const a=s.canvas,n=a&&Cg(a);if(!n)return;const i=n1((c,d)=>{const p=n.clientWidth;r(c,d),p<n.clientWidth&&r()},window),o=new ResizeObserver(c=>{const d=c[0],p=d.contentRect.width,m=d.contentRect.height;p===0&&m===0||i(p,m)});return o.observe(n),R6(s,i),o}function Lf(s,t,r){r&&r.disconnect(),t==="resize"&&M6(s)}function U6(s,t,r){const a=s.canvas,n=n1(i=>{s.ctx!==null&&r(I6(i,s))},s);return D6(a,t,n),n}class q6 extends y1{acquireContext(t,r){const a=t&&t.getContext&&t.getContext("2d");return a&&a.canvas===t?(O6(t,r),a):null}releaseContext(t){const r=t.canvas;if(!r[fh])return!1;const a=r[fh].initial;["height","width"].forEach(i=>{const o=a[i];Ua(o)?r.removeAttribute(i):r.setAttribute(i,o)});const n=a.style||{};return Object.keys(n).forEach(i=>{r.style[i]=n[i]}),r.width=r.width,delete r[fh],!0}addEventListener(t,r,a){this.removeEventListener(t,r);const n=t.$proxies||(t.$proxies={}),o={attach:L6,detach:T6,resize:F6}[r]||U6;n[r]=o(t,r,a)}removeEventListener(t,r){const a=t.$proxies||(t.$proxies={}),n=a[r];if(!n)return;({attach:Lf,detach:Lf,resize:Lf}[r]||E6)(t,r,n),a[r]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,r,a,n){return G3(t,r,a,n)}isAttached(t){const r=t&&Cg(t);return!!(r&&r.isConnected)}}function $6(s){return!zg()||typeof OffscreenCanvas<"u"&&s instanceof OffscreenCanvas?P6:q6}class nd{constructor(){ft(this,"x");ft(this,"y");ft(this,"active",!1);ft(this,"options");ft(this,"$animations")}tooltipPosition(t){const{x:r,y:a}=this.getProps(["x","y"],t);return{x:r,y:a}}hasValue(){return qh(this.x)&&qh(this.y)}getProps(t,r){const a=this.$animations;if(!r||!a)return this;const n={};return t.forEach(i=>{n[i]=a[i]&&a[i].active()?a[i]._to:this[i]}),n}}ft(nd,"defaults",{}),ft(nd,"defaultRoutes");function B6(s,t){const r=s.options.ticks,a=V6(s),n=Math.min(r.maxTicksLimit||a,a),i=r.major.enabled?Z6(t):[],o=i.length,c=i[0],d=i[o-1],p=[];if(o>n)return W6(t,p,i,o/n),p;const m=H6(i,t,n);if(o>0){let x,b;const h=o>1?Math.round((d-c)/(o-1)):null;for(Jm(t,p,m,Ua(h)?0:c-h,c),x=0,b=o-1;x<b;x++)Jm(t,p,m,i[x],i[x+1]);return Jm(t,p,m,d,Ua(h)?t.length:d+h),p}return Jm(t,p,m),p}function V6(s){const t=s.options.offset,r=s._tickSize(),a=s._length/r+(t?0:1),n=s._maxLength/r;return Math.floor(Math.min(a,n))}function H6(s,t,r){const a=K6(s),n=t.length/r;if(!a)return Math.max(n,1);const i=a3(a);for(let o=0,c=i.length-1;o<c;o++){const d=i[o];if(d>n)return d}return Math.max(n,1)}function Z6(s){const t=[];let r,a;for(r=0,a=s.length;r<a;r++)s[r].major&&t.push(r);return t}function W6(s,t,r,a){let n=0,i=r[0],o;for(a=Math.ceil(a),o=0;o<s.length;o++)o===i&&(t.push(s[o]),n++,i=r[n*a])}function Jm(s,t,r,a,n){const i=Hr(a,0),o=Math.min(Hr(n,s.length),s.length);let c=0,d,p,m;for(r=Math.ceil(r),n&&(d=n-a,r=d/Math.floor(d/r)),m=i;m<0;)c++,m=Math.round(i+c*r);for(p=Math.max(i,0);p<o;p++)p===m&&(t.push(s[p]),c++,m=Math.round(i+c*r))}function K6(s){const t=s.length;let r,a;if(t<2)return!1;for(a=s[0],r=1;r<t;++r)if(s[r]-s[r-1]!==a)return!1;return a}const G6=s=>s==="left"?"right":s==="right"?"left":s,I0=(s,t,r)=>t==="top"||t==="left"?s[t]+r:s[t]-r,L0=(s,t)=>Math.min(t||s,s);function T0(s,t){const r=[],a=s.length/t,n=s.length;let i=0;for(;i<n;i+=a)r.push(s[Math.floor(i)]);return r}function Y6(s,t,r){const a=s.ticks.length,n=Math.min(t,a-1),i=s._startPixel,o=s._endPixel,c=1e-6;let d=s.getPixelForTick(n),p;if(!(r&&(a===1?p=Math.max(d-i,o-d):t===0?p=(s.getPixelForTick(1)-d)/2:p=(d-s.getPixelForTick(n-1))/2,d+=n<t?p:-p,d<i-c||d>o+c)))return d}function J6(s,t){Vr(s,r=>{const a=r.gc,n=a.length/2;let i;if(n>t){for(i=0;i<n;++i)delete r.data[a[i]];a.splice(0,n)}})}function ap(s){return s.drawTicks?s.tickLength:0}function R0(s,t){if(!s.display)return 0;const r=Nn(s.font,t),a=Vi(s.padding);return(ja(s.text)?s.text.length:1)*r.lineHeight+a.height}function X6(s,t){return Nu(s,{scale:t,type:"scale"})}function Q6(s,t,r){return Nu(s,{tick:r,index:t,type:"tick"})}function ez(s,t,r){let a=i1(s);return(r&&t!=="right"||!r&&t==="right")&&(a=G6(a)),a}function tz(s,t,r,a){const{top:n,left:i,bottom:o,right:c,chart:d}=s,{chartArea:p,scales:m}=d;let x=0,b,h,j;const g=o-n,v=c-i;if(s.isHorizontal()){if(h=Bn(a,i,c),Dr(r)){const _=Object.keys(r)[0],k=r[_];j=m[_].getPixelForValue(k)+g-t}else r==="center"?j=(p.bottom+p.top)/2+g-t:j=I0(s,r,t);b=c-i}else{if(Dr(r)){const _=Object.keys(r)[0],k=r[_];h=m[_].getPixelForValue(k)-v+t}else r==="center"?h=(p.left+p.right)/2-v+t:h=I0(s,r,t);j=Bn(a,o,n),x=r==="left"?-ra:ra}return{titleX:h,titleY:j,maxWidth:b,rotation:x}}class dx extends nd{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,r){return t}getUserBounds(){let{_userMin:t,_userMax:r,_suggestedMin:a,_suggestedMax:n}=this;return t=po(t,Number.POSITIVE_INFINITY),r=po(r,Number.NEGATIVE_INFINITY),a=po(a,Number.POSITIVE_INFINITY),n=po(n,Number.NEGATIVE_INFINITY),{min:po(t,a),max:po(r,n),minDefined:ml(t),maxDefined:ml(r)}}getMinMax(t){let{min:r,max:a,minDefined:n,maxDefined:i}=this.getUserBounds(),o;if(n&&i)return{min:r,max:a};const c=this.getMatchingVisibleMetas();for(let d=0,p=c.length;d<p;++d)o=c[d].controller.getMinMax(this,t),n||(r=Math.min(r,o.min)),i||(a=Math.max(a,o.max));return r=i&&r>a?a:r,a=n&&r>a?r:a,{min:po(r,po(a,r)),max:po(a,po(r,a))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){is(this.options.beforeUpdate,[this])}update(t,r,a){const{beginAtZero:n,grace:i,ticks:o}=this.options,c=o.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=r,this._margins=a=Object.assign({left:0,right:0,top:0,bottom:0},a),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+a.left+a.right:this.height+a.top+a.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=I3(this,i,n),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const d=c<this.ticks.length;this._convertTicksToLabels(d?T0(this.ticks,c):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=B6(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),d&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,r,a;this.isHorizontal()?(r=this.left,a=this.right):(r=this.top,a=this.bottom,t=!t),this._startPixel=r,this._endPixel=a,this._reversePixels=t,this._length=a-r,this._alignToPixels=this.options.alignToPixels}afterUpdate(){is(this.options.afterUpdate,[this])}beforeSetDimensions(){is(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){is(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),is(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){is(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const r=this.options.ticks;let a,n,i;for(a=0,n=t.length;a<n;a++)i=t[a],i.label=is(r.callback,[i.value,a,t],this)}afterTickToLabelConversion(){is(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){is(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,r=t.ticks,a=L0(this.ticks.length,t.ticks.maxTicksLimit),n=r.minRotation||0,i=r.maxRotation;let o=n,c,d,p;if(!this._isVisible()||!r.display||n>=i||a<=1||!this.isHorizontal()){this.labelRotation=n;return}const m=this._getLabelSizes(),x=m.widest.width,b=m.highest.height,h=mi(this.chart.width-x,0,this.maxWidth);c=t.offset?this.maxWidth/a:h/(a-1),x+6>c&&(c=h/(a-(t.offset?.5:1)),d=this.maxHeight-ap(t.grid)-r.padding-R0(t.title,this.chart.options.font),p=Math.sqrt(x*x+b*b),o=i3(Math.min(Math.asin(mi((m.highest.height+6)/c,-1,1)),Math.asin(mi(d/p,-1,1))-Math.asin(mi(b/p,-1,1)))),o=Math.max(n,Math.min(i,o))),this.labelRotation=o}afterCalculateLabelRotation(){is(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){is(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:r,options:{ticks:a,title:n,grid:i}}=this,o=this._isVisible(),c=this.isHorizontal();if(o){const d=R0(n,r.options.font);if(c?(t.width=this.maxWidth,t.height=ap(i)+d):(t.height=this.maxHeight,t.width=ap(i)+d),a.display&&this.ticks.length){const{first:p,last:m,widest:x,highest:b}=this._getLabelSizes(),h=a.padding*2,j=Jc(this.labelRotation),g=Math.cos(j),v=Math.sin(j);if(c){const _=a.mirror?0:v*x.width+g*b.height;t.height=Math.min(this.maxHeight,t.height+_+h)}else{const _=a.mirror?0:g*x.width+v*b.height;t.width=Math.min(this.maxWidth,t.width+_+h)}this._calculatePadding(p,m,v,g)}}this._handleMargins(),c?(this.width=this._length=r.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=r.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,r,a,n){const{ticks:{align:i,padding:o},position:c}=this.options,d=this.labelRotation!==0,p=c!=="top"&&this.axis==="x";if(this.isHorizontal()){const m=this.getPixelForTick(0)-this.left,x=this.right-this.getPixelForTick(this.ticks.length-1);let b=0,h=0;d?p?(b=n*t.width,h=a*r.height):(b=a*t.height,h=n*r.width):i==="start"?h=r.width:i==="end"?b=t.width:i!=="inner"&&(b=t.width/2,h=r.width/2),this.paddingLeft=Math.max((b-m+o)*this.width/(this.width-m),0),this.paddingRight=Math.max((h-x+o)*this.width/(this.width-x),0)}else{let m=r.height/2,x=t.height/2;i==="start"?(m=0,x=t.height):i==="end"&&(m=r.height,x=0),this.paddingTop=m+o,this.paddingBottom=x+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){is(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:r}=this.options;return r==="top"||r==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let r,a;for(r=0,a=t.length;r<a;r++)Ua(t[r].label)&&(t.splice(r,1),a--,r--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const r=this.options.ticks.sampleSize;let a=this.ticks;r<a.length&&(a=T0(a,r)),this._labelSizes=t=this._computeLabelSizes(a,a.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,r,a){const{ctx:n,_longestTextCache:i}=this,o=[],c=[],d=Math.floor(r/L0(r,a));let p=0,m=0,x,b,h,j,g,v,_,k,P,L,F;for(x=0;x<r;x+=d){if(j=t[x].label,g=this._resolveTickFontOptions(x),n.font=v=g.string,_=i[v]=i[v]||{data:{},gc:[]},k=g.lineHeight,P=L=0,!Ua(j)&&!ja(j))P=x0(n,_.data,_.gc,P,j),L=k;else if(ja(j))for(b=0,h=j.length;b<h;++b)F=j[b],!Ua(F)&&!ja(F)&&(P=x0(n,_.data,_.gc,P,F),L+=k);o.push(P),c.push(L),p=Math.max(P,p),m=Math.max(L,m)}J6(i,r);const W=o.indexOf(p),R=c.indexOf(m),B=A=>({width:o[A]||0,height:c[A]||0});return{first:B(0),last:B(r-1),widest:B(W),highest:B(R),widths:o,heights:c}}getLabelForValue(t){return t}getPixelForValue(t,r){return NaN}getValueForPixel(t){}getPixelForTick(t){const r=this.ticks;return t<0||t>r.length-1?null:this.getPixelForValue(r[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const r=this._startPixel+t*this._length;return l3(this._alignToPixels?Uc(this.chart,r,0):r)}getDecimalForPixel(t){const r=(t-this._startPixel)/this._length;return this._reversePixels?1-r:r}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:r}=this;return t<0&&r<0?r:t>0&&r>0?t:0}getContext(t){const r=this.ticks||[];if(t>=0&&t<r.length){const a=r[t];return a.$context||(a.$context=Q6(this.getContext(),t,a))}return this.$context||(this.$context=X6(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,r=Jc(this.labelRotation),a=Math.abs(Math.cos(r)),n=Math.abs(Math.sin(r)),i=this._getLabelSizes(),o=t.autoSkipPadding||0,c=i?i.widest.width+o:0,d=i?i.highest.height+o:0;return this.isHorizontal()?d*a>c*n?c/a:d/n:d*n<c*a?d/a:c/n}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const r=this.axis,a=this.chart,n=this.options,{grid:i,position:o,border:c}=n,d=i.offset,p=this.isHorizontal(),x=this.ticks.length+(d?1:0),b=ap(i),h=[],j=c.setContext(this.getContext()),g=j.display?j.width:0,v=g/2,_=function(re){return Uc(a,re,g)};let k,P,L,F,W,R,B,A,S,C,O,Z;if(o==="top")k=_(this.bottom),R=this.bottom-b,A=k-v,C=_(t.top)+v,Z=t.bottom;else if(o==="bottom")k=_(this.top),C=t.top,Z=_(t.bottom)-v,R=k+v,A=this.top+b;else if(o==="left")k=_(this.right),W=this.right-b,B=k-v,S=_(t.left)+v,O=t.right;else if(o==="right")k=_(this.left),S=t.left,O=_(t.right)-v,W=k+v,B=this.left+b;else if(r==="x"){if(o==="center")k=_((t.top+t.bottom)/2+.5);else if(Dr(o)){const re=Object.keys(o)[0],X=o[re];k=_(this.chart.scales[re].getPixelForValue(X))}C=t.top,Z=t.bottom,R=k+v,A=R+b}else if(r==="y"){if(o==="center")k=_((t.left+t.right)/2);else if(Dr(o)){const re=Object.keys(o)[0],X=o[re];k=_(this.chart.scales[re].getPixelForValue(X))}W=k-v,B=W-b,S=t.left,O=t.right}const te=Hr(n.ticks.maxTicksLimit,x),ce=Math.max(1,Math.ceil(x/te));for(P=0;P<x;P+=ce){const re=this.getContext(P),X=i.setContext(re),U=c.setContext(re),oe=X.lineWidth,xe=X.color,J=U.dash||[],$=U.dashOffset,Q=X.tickWidth,q=X.tickColor,I=X.tickBorderDash||[],Y=X.tickBorderDashOffset;L=Y6(this,P,d),L!==void 0&&(F=Uc(a,L,oe),p?W=B=S=O=F:R=A=C=Z=F,h.push({tx1:W,ty1:R,tx2:B,ty2:A,x1:S,y1:C,x2:O,y2:Z,width:oe,color:xe,borderDash:J,borderDashOffset:$,tickWidth:Q,tickColor:q,tickBorderDash:I,tickBorderDashOffset:Y}))}return this._ticksLength=x,this._borderValue=k,h}_computeLabelItems(t){const r=this.axis,a=this.options,{position:n,ticks:i}=a,o=this.isHorizontal(),c=this.ticks,{align:d,crossAlign:p,padding:m,mirror:x}=i,b=ap(a.grid),h=b+m,j=x?-m:h,g=-Jc(this.labelRotation),v=[];let _,k,P,L,F,W,R,B,A,S,C,O,Z="middle";if(n==="top")W=this.bottom-j,R=this._getXAxisLabelAlignment();else if(n==="bottom")W=this.top+j,R=this._getXAxisLabelAlignment();else if(n==="left"){const ce=this._getYAxisLabelAlignment(b);R=ce.textAlign,F=ce.x}else if(n==="right"){const ce=this._getYAxisLabelAlignment(b);R=ce.textAlign,F=ce.x}else if(r==="x"){if(n==="center")W=(t.top+t.bottom)/2+h;else if(Dr(n)){const ce=Object.keys(n)[0],re=n[ce];W=this.chart.scales[ce].getPixelForValue(re)+h}R=this._getXAxisLabelAlignment()}else if(r==="y"){if(n==="center")F=(t.left+t.right)/2-h;else if(Dr(n)){const ce=Object.keys(n)[0],re=n[ce];F=this.chart.scales[ce].getPixelForValue(re)}R=this._getYAxisLabelAlignment(b).textAlign}r==="y"&&(d==="start"?Z="top":d==="end"&&(Z="bottom"));const te=this._getLabelSizes();for(_=0,k=c.length;_<k;++_){P=c[_],L=P.label;const ce=i.setContext(this.getContext(_));B=this.getPixelForTick(_)+i.labelOffset,A=this._resolveTickFontOptions(_),S=A.lineHeight,C=ja(L)?L.length:1;const re=C/2,X=ce.color,U=ce.textStrokeColor,oe=ce.textStrokeWidth;let xe=R;o?(F=B,R==="inner"&&(_===k-1?xe=this.options.reverse?"left":"right":_===0?xe=this.options.reverse?"right":"left":xe="center"),n==="top"?p==="near"||g!==0?O=-C*S+S/2:p==="center"?O=-te.highest.height/2-re*S+S:O=-te.highest.height+S/2:p==="near"||g!==0?O=S/2:p==="center"?O=te.highest.height/2-re*S:O=te.highest.height-C*S,x&&(O*=-1),g!==0&&!ce.showLabelBackdrop&&(F+=S/2*Math.sin(g))):(W=B,O=(1-C)*S/2);let J;if(ce.showLabelBackdrop){const $=Vi(ce.backdropPadding),Q=te.heights[_],q=te.widths[_];let I=O-$.top,Y=0-$.left;switch(Z){case"middle":I-=Q/2;break;case"bottom":I-=Q;break}switch(R){case"center":Y-=q/2;break;case"right":Y-=q;break;case"inner":_===k-1?Y-=q:_>0&&(Y-=q/2);break}J={left:Y,top:I,width:q+$.width,height:Q+$.height,color:ce.backdropColor}}v.push({label:L,font:A,textOffset:O,options:{rotation:g,color:X,strokeColor:U,strokeWidth:oe,textAlign:xe,textBaseline:Z,translation:[F,W],backdrop:J}})}return v}_getXAxisLabelAlignment(){const{position:t,ticks:r}=this.options;if(-Jc(this.labelRotation))return t==="top"?"left":"right";let n="center";return r.align==="start"?n="left":r.align==="end"?n="right":r.align==="inner"&&(n="inner"),n}_getYAxisLabelAlignment(t){const{position:r,ticks:{crossAlign:a,mirror:n,padding:i}}=this.options,o=this._getLabelSizes(),c=t+i,d=o.widest.width;let p,m;return r==="left"?n?(m=this.right+i,a==="near"?p="left":a==="center"?(p="center",m+=d/2):(p="right",m+=d)):(m=this.right-c,a==="near"?p="right":a==="center"?(p="center",m-=d/2):(p="left",m=this.left)):r==="right"?n?(m=this.left+i,a==="near"?p="right":a==="center"?(p="center",m-=d/2):(p="left",m-=d)):(m=this.left+c,a==="near"?p="left":a==="center"?(p="center",m+=d/2):(p="right",m=this.right)):p="right",{textAlign:p,x:m}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,r=this.options.position;if(r==="left"||r==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(r==="top"||r==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:r},left:a,top:n,width:i,height:o}=this;r&&(t.save(),t.fillStyle=r,t.fillRect(a,n,i,o),t.restore())}getLineWidthForValue(t){const r=this.options.grid;if(!this._isVisible()||!r.display)return 0;const n=this.ticks.findIndex(i=>i.value===t);return n>=0?r.setContext(this.getContext(n)).lineWidth:0}drawGrid(t){const r=this.options.grid,a=this.ctx,n=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let i,o;const c=(d,p,m)=>{!m.width||!m.color||(a.save(),a.lineWidth=m.width,a.strokeStyle=m.color,a.setLineDash(m.borderDash||[]),a.lineDashOffset=m.borderDashOffset,a.beginPath(),a.moveTo(d.x,d.y),a.lineTo(p.x,p.y),a.stroke(),a.restore())};if(r.display)for(i=0,o=n.length;i<o;++i){const d=n[i];r.drawOnChartArea&&c({x:d.x1,y:d.y1},{x:d.x2,y:d.y2},d),r.drawTicks&&c({x:d.tx1,y:d.ty1},{x:d.tx2,y:d.ty2},{color:d.tickColor,width:d.tickWidth,borderDash:d.tickBorderDash,borderDashOffset:d.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:r,options:{border:a,grid:n}}=this,i=a.setContext(this.getContext()),o=a.display?i.width:0;if(!o)return;const c=n.setContext(this.getContext(0)).lineWidth,d=this._borderValue;let p,m,x,b;this.isHorizontal()?(p=Uc(t,this.left,o)-o/2,m=Uc(t,this.right,c)+c/2,x=b=d):(x=Uc(t,this.top,o)-o/2,b=Uc(t,this.bottom,c)+c/2,p=m=d),r.save(),r.lineWidth=i.width,r.strokeStyle=i.color,r.beginPath(),r.moveTo(p,x),r.lineTo(m,b),r.stroke(),r.restore()}drawLabels(t){if(!this.options.ticks.display)return;const a=this.ctx,n=this._computeLabelArea();n&&jg(a,n);const i=this.getLabelItems(t);for(const o of i){const c=o.options,d=o.font,p=o.label,m=o.textOffset;Bh(a,p,0,m,d,c)}n&&_g(a)}drawTitle(){const{ctx:t,options:{position:r,title:a,reverse:n}}=this;if(!a.display)return;const i=Nn(a.font),o=Vi(a.padding),c=a.align;let d=i.lineHeight/2;r==="bottom"||r==="center"||Dr(r)?(d+=o.bottom,ja(a.text)&&(d+=i.lineHeight*(a.text.length-1))):d+=o.top;const{titleX:p,titleY:m,maxWidth:x,rotation:b}=tz(this,d,r,c);Bh(t,a.text,0,0,i,{color:a.color,maxWidth:x,rotation:b,textAlign:ez(c,r,n),textBaseline:"middle",translation:[p,m]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,r=t.ticks&&t.ticks.z||0,a=Hr(t.grid&&t.grid.z,-1),n=Hr(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==dx.prototype.draw?[{z:r,draw:i=>{this.draw(i)}}]:[{z:a,draw:i=>{this.drawBackground(),this.drawGrid(i),this.drawTitle()}},{z:n,draw:()=>{this.drawBorder()}},{z:r,draw:i=>{this.drawLabels(i)}}]}getMatchingVisibleMetas(t){const r=this.chart.getSortedVisibleDatasetMetas(),a=this.axis+"AxisID",n=[];let i,o;for(i=0,o=r.length;i<o;++i){const c=r[i];c[a]===this.id&&(!t||c.type===t)&&n.push(c)}return n}_resolveTickFontOptions(t){const r=this.options.ticks.setContext(this.getContext(t));return Nn(r.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class Xm{constructor(t,r,a){this.type=t,this.scope=r,this.override=a,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const r=Object.getPrototypeOf(t);let a;az(r)&&(a=this.register(r));const n=this.items,i=t.id,o=this.scope+"."+i;if(!i)throw new Error("class does not have id: "+t);return i in n||(n[i]=t,rz(t,o,a),this.override&&Bs.override(t.id,t.overrides)),o}get(t){return this.items[t]}unregister(t){const r=this.items,a=t.id,n=this.scope;a in r&&delete r[a],n&&a in Bs[n]&&(delete Bs[n][a],this.override&&delete ad[a])}}function rz(s,t,r){const a=qp(Object.create(null),[r?Bs.get(r):{},Bs.get(t),s.defaults]);Bs.set(t,a),s.defaultRoutes&&sz(t,s.defaultRoutes),s.descriptors&&Bs.describe(t,s.descriptors)}function sz(s,t){Object.keys(t).forEach(r=>{const a=r.split("."),n=a.pop(),i=[s].concat(a).join("."),o=t[r].split("."),c=o.pop(),d=o.join(".");Bs.route(i,n,d,c)})}function az(s){return"id"in s&&"defaults"in s}class nz{constructor(){this.controllers=new Xm(Sp,"datasets",!0),this.elements=new Xm(nd,"elements"),this.plugins=new Xm(Object,"plugins"),this.scales=new Xm(dx,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,r,a){[...r].forEach(n=>{const i=a||this._getRegistryForType(n);a||i.isForType(n)||i===this.plugins&&n.id?this._exec(t,i,n):Vr(n,o=>{const c=a||this._getRegistryForType(o);this._exec(t,c,o)})})}_exec(t,r,a){const n=vg(t);is(a["before"+n],[],a),r[t](a),is(a["after"+n],[],a)}_getRegistryForType(t){for(let r=0;r<this._typedRegistries.length;r++){const a=this._typedRegistries[r];if(a.isForType(t))return a}return this.plugins}_get(t,r,a){const n=r.get(t);if(n===void 0)throw new Error('"'+t+'" is not a registered '+a+".");return n}}var bo=new nz;class iz{constructor(){this._init=void 0}notify(t,r,a,n){if(r==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install")),this._init===void 0)return;const i=n?this._descriptors(t).filter(n):this._descriptors(t),o=this._notify(i,t,r,a);return r==="afterDestroy"&&(this._notify(i,t,"stop"),this._notify(this._init,t,"uninstall"),this._init=void 0),o}_notify(t,r,a,n){n=n||{};for(const i of t){const o=i.plugin,c=o[a],d=[r,n,i.options];if(is(c,d,o)===!1&&n.cancelable)return!1}return!0}invalidate(){Ua(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const r=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),r}_createDescriptors(t,r){const a=t&&t.config,n=Hr(a.options&&a.options.plugins,{}),i=oz(a);return n===!1&&!r?[]:cz(t,i,n,r)}_notifyStateChanges(t){const r=this._oldCache||[],a=this._cache,n=(i,o)=>i.filter(c=>!o.some(d=>c.plugin.id===d.plugin.id));this._notify(n(r,a),t,"stop"),this._notify(n(a,r),t,"start")}}function oz(s){const t={},r=[],a=Object.keys(bo.plugins.items);for(let i=0;i<a.length;i++)r.push(bo.getPlugin(a[i]));const n=s.plugins||[];for(let i=0;i<n.length;i++){const o=n[i];r.indexOf(o)===-1&&(r.push(o),t[o.id]=!0)}return{plugins:r,localIds:t}}function lz(s,t){return!t&&s===!1?null:s===!0?{}:s}function cz(s,{plugins:t,localIds:r},a,n){const i=[],o=s.getContext();for(const c of t){const d=c.id,p=lz(a[d],n);p!==null&&i.push({plugin:c,options:dz(s.config,{plugin:c,local:r[d]},p,o)})}return i}function dz(s,{plugin:t,local:r},a,n){const i=s.pluginScopeKeys(t),o=s.getOptionScopes(a,i);return r&&t.defaults&&o.push(t.defaults),s.createResolver(o,n,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Rb(s,t){const r=Bs.datasets[s]||{};return((t.datasets||{})[s]||{}).indexAxis||t.indexAxis||r.indexAxis||"x"}function uz(s,t){let r=s;return s==="_index_"?r=t:s==="_value_"&&(r=t==="x"?"y":"x"),r}function pz(s,t){return s===t?"_index_":"_value_"}function M0(s){if(s==="x"||s==="y"||s==="r")return s}function mz(s){if(s==="top"||s==="bottom")return"x";if(s==="left"||s==="right")return"y"}function Mb(s,...t){if(M0(s))return s;for(const r of t){const a=r.axis||mz(r.position)||s.length>1&&M0(s[0].toLowerCase());if(a)return a}throw new Error(`Cannot determine type of '${s}' axis. Please provide 'axis' or 'position' option.`)}function F0(s,t,r){if(r[t+"AxisID"]===s)return{axis:t}}function hz(s,t){if(t.data&&t.data.datasets){const r=t.data.datasets.filter(a=>a.xAxisID===s||a.yAxisID===s);if(r.length)return F0(s,"x",r[0])||F0(s,"y",r[0])}return{}}function xz(s,t){const r=ad[s.type]||{scales:{}},a=t.scales||{},n=Rb(s.type,t),i=Object.create(null);return Object.keys(a).forEach(o=>{const c=a[o];if(!Dr(c))return console.error(`Invalid scale configuration for scale: ${o}`);if(c._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const d=Mb(o,c,hz(o,s),Bs.scales[c.type]),p=pz(d,n),m=r.scales||{};i[o]=_p(Object.create(null),[{axis:d},c,m[d],m[p]])}),s.data.datasets.forEach(o=>{const c=o.type||s.type,d=o.indexAxis||Rb(c,t),m=(ad[c]||{}).scales||{};Object.keys(m).forEach(x=>{const b=uz(x,d),h=o[b+"AxisID"]||b;i[h]=i[h]||Object.create(null),_p(i[h],[{axis:b},a[h],m[x]])})}),Object.keys(i).forEach(o=>{const c=i[o];_p(c,[Bs.scales[c.type],Bs.scale])}),i}function k1(s){const t=s.options||(s.options={});t.plugins=Hr(t.plugins,{}),t.scales=xz(s,t)}function N1(s){return s=s||{},s.datasets=s.datasets||[],s.labels=s.labels||[],s}function fz(s){return s=s||{},s.data=N1(s.data),k1(s),s}const U0=new Map,w1=new Set;function Qm(s,t){let r=U0.get(s);return r||(r=t(),U0.set(s,r),w1.add(r)),r}const np=(s,t,r)=>{const a=$p(t,r);a!==void 0&&s.add(a)};class bz{constructor(t){this._config=fz(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=N1(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),k1(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return Qm(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,r){return Qm(`${t}.transition.${r}`,()=>[[`datasets.${t}.transitions.${r}`,`transitions.${r}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,r){return Qm(`${t}-${r}`,()=>[[`datasets.${t}.elements.${r}`,`datasets.${t}`,`elements.${r}`,""]])}pluginScopeKeys(t){const r=t.id,a=this.type;return Qm(`${a}-plugin-${r}`,()=>[[`plugins.${r}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,r){const a=this._scopeCache;let n=a.get(t);return(!n||r)&&(n=new Map,a.set(t,n)),n}getOptionScopes(t,r,a){const{options:n,type:i}=this,o=this._cachedScopes(t,a),c=o.get(r);if(c)return c;const d=new Set;r.forEach(m=>{t&&(d.add(t),m.forEach(x=>np(d,t,x))),m.forEach(x=>np(d,n,x)),m.forEach(x=>np(d,ad[i]||{},x)),m.forEach(x=>np(d,Bs,x)),m.forEach(x=>np(d,Lb,x))});const p=Array.from(d);return p.length===0&&p.push(Object.create(null)),w1.has(r)&&o.set(r,p),p}chartOptionScopes(){const{options:t,type:r}=this;return[t,ad[r]||{},Bs.datasets[r]||{},{type:r},Bs,Lb]}resolveNamedOptions(t,r,a,n=[""]){const i={$shared:!0},{resolver:o,subPrefixes:c}=q0(this._resolverCache,t,n);let d=o;if(vz(o,r)){i.$shared=!1,a=ic(a)?a():a;const p=this.createResolver(t,a,c);d=gu(o,a,p)}for(const p of r)i[p]=d[p];return i}createResolver(t,r,a=[""],n){const{resolver:i}=q0(this._resolverCache,t,a);return Dr(r)?gu(i,r,void 0,n):i}}function q0(s,t,r){let a=s.get(t);a||(a=new Map,s.set(t,a));const n=r.join();let i=a.get(n);return i||(i={resolver:Ng(t,r),subPrefixes:r.filter(c=>!c.toLowerCase().includes("hover"))},a.set(n,i)),i}const gz=s=>Dr(s)&&Object.getOwnPropertyNames(s).some(t=>ic(s[t]));function vz(s,t){const{isScriptable:r,isIndexable:a}=d1(s);for(const n of t){const i=r(n),o=a(n),c=(o||i)&&s[n];if(i&&(ic(c)||gz(c))||o&&ja(c))return!0}return!1}var yz="4.5.1";const jz=["top","bottom","left","right","chartArea"];function $0(s,t){return s==="top"||s==="bottom"||jz.indexOf(s)===-1&&t==="x"}function B0(s,t){return function(r,a){return r[s]===a[s]?r[t]-a[t]:r[s]-a[s]}}function V0(s){const t=s.chart,r=t.options.animation;t.notifyPlugins("afterRender"),is(r&&r.onComplete,[s],t)}function _z(s){const t=s.chart,r=t.options.animation;is(r&&r.onProgress,[s],t)}function S1(s){return zg()&&typeof s=="string"?s=document.getElementById(s):s&&s.length&&(s=s[0]),s&&s.canvas&&(s=s.canvas),s}const bh={},H0=s=>{const t=S1(s);return Object.values(bh).filter(r=>r.canvas===t).pop()};function kz(s,t,r){const a=Object.keys(s);for(const n of a){const i=+n;if(i>=t){const o=s[n];delete s[n],(r>0||i>t)&&(s[i+r]=o)}}}function Nz(s,t,r,a){return!r||s.type==="mouseout"?null:a?t:s}var Jl;let ux=(Jl=class{static register(...t){bo.add(...t),Z0()}static unregister(...t){bo.remove(...t),Z0()}constructor(t,r){const a=this.config=new bz(r),n=S1(t),i=H0(n);if(i)throw new Error("Canvas is already in use. Chart with ID '"+i.id+"' must be destroyed before the canvas with ID '"+i.canvas.id+"' can be reused.");const o=a.createResolver(a.chartOptionScopes(),this.getContext());this.platform=new(a.platform||$6(n)),this.platform.updateConfig(a);const c=this.platform.acquireContext(n,o.aspectRatio),d=c&&c.canvas,p=d&&d.height,m=d&&d.width;if(this.id=YS(),this.ctx=c,this.canvas=d,this.width=m,this.height=p,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new iz,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=m3(x=>this.update(x),o.resizeDelay||0),this._dataChanges=[],bh[this.id]=this,!c||!d){console.error("Failed to create chart: can't acquire context from the given item");return}nl.listen(this,"complete",V0),nl.listen(this,"progress",_z),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:r},width:a,height:n,_aspectRatio:i}=this;return Ua(t)?r&&i?i:n?a/n:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return bo}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():y0(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return f0(this.canvas,this.ctx),this}stop(){return nl.stop(this),this}resize(t,r){nl.running(this)?this._resizeBeforeDraw={width:t,height:r}:this._resize(t,r)}_resize(t,r){const a=this.options,n=this.canvas,i=a.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(n,t,r,i),c=a.devicePixelRatio||this.platform.getDevicePixelRatio(),d=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,y0(this,c,!0)&&(this.notifyPlugins("resize",{size:o}),is(a.onResize,[this,o],this),this.attached&&this._doResize(d)&&this.render())}ensureScalesHaveIDs(){const r=this.options.scales||{};Vr(r,(a,n)=>{a.id=n})}buildOrUpdateScales(){const t=this.options,r=t.scales,a=this.scales,n=Object.keys(a).reduce((o,c)=>(o[c]=!1,o),{});let i=[];r&&(i=i.concat(Object.keys(r).map(o=>{const c=r[o],d=Mb(o,c),p=d==="r",m=d==="x";return{options:c,dposition:p?"chartArea":m?"bottom":"left",dtype:p?"radialLinear":m?"category":"linear"}}))),Vr(i,o=>{const c=o.options,d=c.id,p=Mb(d,c),m=Hr(c.type,o.dtype);(c.position===void 0||$0(c.position,p)!==$0(o.dposition))&&(c.position=o.dposition),n[d]=!0;let x=null;if(d in a&&a[d].type===m)x=a[d];else{const b=bo.getScale(m);x=new b({id:d,type:m,ctx:this.ctx,chart:this}),a[x.id]=x}x.init(c,t)}),Vr(n,(o,c)=>{o||delete a[c]}),Vr(a,o=>{tc.configure(this,o,o.options),tc.addBox(this,o)})}_updateMetasets(){const t=this._metasets,r=this.data.datasets.length,a=t.length;if(t.sort((n,i)=>n.index-i.index),a>r){for(let n=r;n<a;++n)this._destroyDatasetMeta(n);t.splice(r,a-r)}this._sortedMetasets=t.slice(0).sort(B0("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:r}}=this;t.length>r.length&&delete this._stacks,t.forEach((a,n)=>{r.filter(i=>i===a._dataset).length===0&&this._destroyDatasetMeta(n)})}buildOrUpdateControllers(){const t=[],r=this.data.datasets;let a,n;for(this._removeUnreferencedMetasets(),a=0,n=r.length;a<n;a++){const i=r[a];let o=this.getDatasetMeta(a);const c=i.type||this.config.type;if(o.type&&o.type!==c&&(this._destroyDatasetMeta(a),o=this.getDatasetMeta(a)),o.type=c,o.indexAxis=i.indexAxis||Rb(c,this.options),o.order=i.order||0,o.index=a,o.label=""+i.label,o.visible=this.isDatasetVisible(a),o.controller)o.controller.updateIndex(a),o.controller.linkScales();else{const d=bo.getController(c),{datasetElementType:p,dataElementType:m}=Bs.datasets[c];Object.assign(d,{dataElementType:bo.getElement(m),datasetElementType:p&&bo.getElement(p)}),o.controller=new d(this,a),t.push(o.controller)}}return this._updateMetasets(),t}_resetElements(){Vr(this.data.datasets,(t,r)=>{this.getDatasetMeta(r).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const r=this.config;r.update();const a=this._options=r.createResolver(r.chartOptionScopes(),this.getContext()),n=this._animationsDisabled=!a.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const i=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let p=0,m=this.data.datasets.length;p<m;p++){const{controller:x}=this.getDatasetMeta(p),b=!n&&i.indexOf(x)===-1;x.buildOrUpdateElements(b),o=Math.max(+x.getMaxOverflow(),o)}o=this._minPadding=a.layout.autoPadding?o:0,this._updateLayout(o),n||Vr(i,p=>{p.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(B0("z","_idx"));const{_active:c,_lastEvent:d}=this;d?this._eventHandler(d,!0):c.length&&this._updateHoverStyles(c,c,!0),this.render()}_updateScales(){Vr(this.scales,t=>{tc.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,r=new Set(Object.keys(this._listeners)),a=new Set(t.events);(!o0(r,a)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,r=this._getUniformDataChanges()||[];for(const{method:a,start:n,count:i}of r){const o=a==="_removeElements"?-i:i;kz(t,n,o)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const r=this.data.datasets.length,a=i=>new Set(t.filter(o=>o[0]===i).map((o,c)=>c+","+o.splice(1).join(","))),n=a(0);for(let i=1;i<r;i++)if(!o0(n,a(i)))return;return Array.from(n).map(i=>i.split(",")).map(i=>({method:i[1],start:+i[2],count:+i[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;tc.update(this,this.width,this.height,t);const r=this.chartArea,a=r.width<=0||r.height<=0;this._layers=[],Vr(this.boxes,n=>{a&&n.position==="chartArea"||(n.configure&&n.configure(),this._layers.push(...n._layers()))},this),this._layers.forEach((n,i)=>{n._idx=i}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let r=0,a=this.data.datasets.length;r<a;++r)this.getDatasetMeta(r).controller.configure();for(let r=0,a=this.data.datasets.length;r<a;++r)this._updateDataset(r,ic(t)?t({datasetIndex:r}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,r){const a=this.getDatasetMeta(t),n={meta:a,index:t,mode:r,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",n)!==!1&&(a.controller._update(r),n.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",n))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(nl.has(this)?this.attached&&!nl.running(this)&&nl.start(this):(this.draw(),V0({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:a,height:n}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(a,n)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const r=this._layers;for(t=0;t<r.length&&r[t].z<=0;++t)r[t].draw(this.chartArea);for(this._drawDatasets();t<r.length;++t)r[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const r=this._sortedMetasets,a=[];let n,i;for(n=0,i=r.length;n<i;++n){const o=r[n];(!t||o.visible)&&a.push(o)}return a}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let r=t.length-1;r>=0;--r)this._drawDataset(t[r]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const r=this.ctx,a={meta:t,index:t.index,cancelable:!0},n=e6(this,t);this.notifyPlugins("beforeDatasetDraw",a)!==!1&&(n&&jg(r,n),t.controller.draw(),n&&_g(r),a.cancelable=!1,this.notifyPlugins("afterDatasetDraw",a))}isPointInArea(t){return c1(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,r,a,n){const i=j6.modes[r];return typeof i=="function"?i(this,t,a,n):[]}getDatasetMeta(t){const r=this.data.datasets[t],a=this._metasets;let n=a.filter(i=>i&&i._dataset===r).pop();return n||(n={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:r&&r.order||0,index:t,_dataset:r,_parsed:[],_sorted:!1},a.push(n)),n}getContext(){return this.$context||(this.$context=Nu(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const r=this.data.datasets[t];if(!r)return!1;const a=this.getDatasetMeta(t);return typeof a.hidden=="boolean"?!a.hidden:!r.hidden}setDatasetVisibility(t,r){const a=this.getDatasetMeta(t);a.hidden=!r}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,r,a){const n=a?"show":"hide",i=this.getDatasetMeta(t),o=i.controller._resolveAnimations(void 0,n);Fh(r)?(i.data[r].hidden=!a,this.update()):(this.setDatasetVisibility(t,a),o.update(i,{visible:a}),this.update(c=>c.datasetIndex===t?n:void 0))}hide(t,r){this._updateVisibility(t,r,!1)}show(t,r){this._updateVisibility(t,r,!0)}_destroyDatasetMeta(t){const r=this._metasets[t];r&&r.controller&&r.controller._destroy(),delete this._metasets[t]}_stop(){let t,r;for(this.stop(),nl.remove(this),t=0,r=this.data.datasets.length;t<r;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:r}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),f0(t,r),this.platform.releaseContext(r),this.canvas=null,this.ctx=null),delete bh[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,r=this.platform,a=(i,o)=>{r.addEventListener(this,i,o),t[i]=o},n=(i,o,c)=>{i.offsetX=o,i.offsetY=c,this._eventHandler(i)};Vr(this.options.events,i=>a(i,n))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,r=this.platform,a=(d,p)=>{r.addEventListener(this,d,p),t[d]=p},n=(d,p)=>{t[d]&&(r.removeEventListener(this,d,p),delete t[d])},i=(d,p)=>{this.canvas&&this.resize(d,p)};let o;const c=()=>{n("attach",c),this.attached=!0,this.resize(),a("resize",i),a("detach",o)};o=()=>{this.attached=!1,n("resize",i),this._stop(),this._resize(0,0),a("attach",c)},r.isAttached(this.canvas)?c():o()}unbindEvents(){Vr(this._listeners,(t,r)=>{this.platform.removeEventListener(this,r,t)}),this._listeners={},Vr(this._responsiveListeners,(t,r)=>{this.platform.removeEventListener(this,r,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,r,a){const n=a?"set":"remove";let i,o,c,d;for(r==="dataset"&&(i=this.getDatasetMeta(t[0].datasetIndex),i.controller["_"+n+"DatasetHoverStyle"]()),c=0,d=t.length;c<d;++c){o=t[c];const p=o&&this.getDatasetMeta(o.datasetIndex).controller;p&&p[n+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const r=this._active||[],a=t.map(({datasetIndex:i,index:o})=>{const c=this.getDatasetMeta(i);if(!c)throw new Error("No dataset found at index "+i);return{datasetIndex:i,element:c.data[o],index:o}});!Rh(a,r)&&(this._active=a,this._lastEvent=null,this._updateHoverStyles(a,r))}notifyPlugins(t,r,a){return this._plugins.notify(this,t,r,a)}isPluginEnabled(t){return this._plugins._cache.filter(r=>r.plugin.id===t).length===1}_updateHoverStyles(t,r,a){const n=this.options.hover,i=(d,p)=>d.filter(m=>!p.some(x=>m.datasetIndex===x.datasetIndex&&m.index===x.index)),o=i(r,t),c=a?t:i(t,r);o.length&&this.updateHoverStyle(o,n.mode,!1),c.length&&n.mode&&this.updateHoverStyle(c,n.mode,!0)}_eventHandler(t,r){const a={event:t,replay:r,cancelable:!0,inChartArea:this.isPointInArea(t)},n=o=>(o.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",a,n)===!1)return;const i=this._handleEvent(t,r,a.inChartArea);return a.cancelable=!1,this.notifyPlugins("afterEvent",a,n),(i||a.changed)&&this.render(),this}_handleEvent(t,r,a){const{_active:n=[],options:i}=this,o=r,c=this._getActiveElements(t,n,a,o),d=r3(t),p=Nz(t,this._lastEvent,a,d);a&&(this._lastEvent=null,is(i.onHover,[t,c,this],this),d&&is(i.onClick,[t,c,this],this));const m=!Rh(c,n);return(m||r)&&(this._active=c,this._updateHoverStyles(c,n,r)),this._lastEvent=p,m}_getActiveElements(t,r,a,n){if(t.type==="mouseout")return[];if(!a)return r;const i=this.options.hover;return this.getElementsAtEventForMode(t,i.mode,i,n)}},ft(Jl,"defaults",Bs),ft(Jl,"instances",bh),ft(Jl,"overrides",ad),ft(Jl,"registry",bo),ft(Jl,"version",yz),ft(Jl,"getChart",H0),Jl);function Z0(){return Vr(ux.instances,s=>s._plugins.invalidate())}function wz(s,t,r){const{startAngle:a,x:n,y:i,outerRadius:o,innerRadius:c,options:d}=t,{borderWidth:p,borderJoinStyle:m}=d,x=Math.min(p/o,go(a-r));if(s.beginPath(),s.arc(n,i,o-p/2,a+x/2,r-x/2),c>0){const b=Math.min(p/c,go(a-r));s.arc(n,i,c+p/2,r-b/2,a+b/2,!0)}else{const b=Math.min(p/2,o*go(a-r));if(m==="round")s.arc(n,i,b,r-os/2,a+os/2,!0);else if(m==="bevel"){const h=2*b*b,j=-h*Math.cos(r+os/2)+n,g=-h*Math.sin(r+os/2)+i,v=h*Math.cos(a+os/2)+n,_=h*Math.sin(a+os/2)+i;s.lineTo(j,g),s.lineTo(v,_)}}s.closePath(),s.moveTo(0,0),s.rect(0,0,s.canvas.width,s.canvas.height),s.clip("evenodd")}function Sz(s,t,r){const{startAngle:a,pixelMargin:n,x:i,y:o,outerRadius:c,innerRadius:d}=t;let p=n/c;s.beginPath(),s.arc(i,o,c,a-p,r+p),d>n?(p=n/d,s.arc(i,o,d,r+p,a-p,!0)):s.arc(i,o,n,r+ra,a-ra),s.closePath(),s.clip()}function zz(s){return kg(s,["outerStart","outerEnd","innerStart","innerEnd"])}function Cz(s,t,r,a){const n=zz(s.options.borderRadius),i=(r-t)/2,o=Math.min(i,a*t/2),c=d=>{const p=(r-Math.min(i,d))*a/2;return mi(d,0,Math.min(i,p))};return{outerStart:c(n.outerStart),outerEnd:c(n.outerEnd),innerStart:mi(n.innerStart,0,o),innerEnd:mi(n.innerEnd,0,o)}}function Jd(s,t,r,a){return{x:r+s*Math.cos(t),y:a+s*Math.sin(t)}}function Zh(s,t,r,a,n,i){const{x:o,y:c,startAngle:d,pixelMargin:p,innerRadius:m}=t,x=Math.max(t.outerRadius+a+r-p,0),b=m>0?m+a+r+p:0;let h=0;const j=n-d;if(a){const ce=m>0?m-a:0,re=x>0?x-a:0,X=(ce+re)/2,U=X!==0?j*X/(X+a):j;h=(j-U)/2}const g=Math.max(.001,j*x-r/os)/x,v=(j-g)/2,_=d+v+h,k=n-v-h,{outerStart:P,outerEnd:L,innerStart:F,innerEnd:W}=Cz(t,b,x,k-_),R=x-P,B=x-L,A=_+P/R,S=k-L/B,C=b+F,O=b+W,Z=_+F/C,te=k-W/O;if(s.beginPath(),i){const ce=(A+S)/2;if(s.arc(o,c,x,A,ce),s.arc(o,c,x,ce,S),L>0){const oe=Jd(B,S,o,c);s.arc(oe.x,oe.y,L,S,k+ra)}const re=Jd(O,k,o,c);if(s.lineTo(re.x,re.y),W>0){const oe=Jd(O,te,o,c);s.arc(oe.x,oe.y,W,k+ra,te+Math.PI)}const X=(k-W/b+(_+F/b))/2;if(s.arc(o,c,b,k-W/b,X,!0),s.arc(o,c,b,X,_+F/b,!0),F>0){const oe=Jd(C,Z,o,c);s.arc(oe.x,oe.y,F,Z+Math.PI,_-ra)}const U=Jd(R,_,o,c);if(s.lineTo(U.x,U.y),P>0){const oe=Jd(R,A,o,c);s.arc(oe.x,oe.y,P,_-ra,A)}}else{s.moveTo(o,c);const ce=Math.cos(A)*x+o,re=Math.sin(A)*x+c;s.lineTo(ce,re);const X=Math.cos(S)*x+o,U=Math.sin(S)*x+c;s.lineTo(X,U)}s.closePath()}function Pz(s,t,r,a,n){const{fullCircles:i,startAngle:o,circumference:c}=t;let d=t.endAngle;if(i){Zh(s,t,r,a,d,n);for(let p=0;p<i;++p)s.fill();isNaN(c)||(d=o+(c%Gs||Gs))}return Zh(s,t,r,a,d,n),s.fill(),d}function Az(s,t,r,a,n){const{fullCircles:i,startAngle:o,circumference:c,options:d}=t,{borderWidth:p,borderJoinStyle:m,borderDash:x,borderDashOffset:b,borderRadius:h}=d,j=d.borderAlign==="inner";if(!p)return;s.setLineDash(x||[]),s.lineDashOffset=b,j?(s.lineWidth=p*2,s.lineJoin=m||"round"):(s.lineWidth=p,s.lineJoin=m||"bevel");let g=t.endAngle;if(i){Zh(s,t,r,a,g,n);for(let v=0;v<i;++v)s.stroke();isNaN(c)||(g=o+(c%Gs||Gs))}j&&Sz(s,t,g),d.selfJoin&&g-o>=os&&h===0&&m!=="miter"&&wz(s,t,g),i||(Zh(s,t,r,a,g,n),s.stroke())}class hp extends nd{constructor(r){super();ft(this,"circumference");ft(this,"endAngle");ft(this,"fullCircles");ft(this,"innerRadius");ft(this,"outerRadius");ft(this,"pixelMargin");ft(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,r&&Object.assign(this,r)}inRange(r,a,n){const i=this.getProps(["x","y"],n),{angle:o,distance:c}=r1(i,{x:r,y:a}),{startAngle:d,endAngle:p,innerRadius:m,outerRadius:x,circumference:b}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],n),h=(this.options.spacing+this.options.borderWidth)/2,j=Hr(b,p-d),g=$h(o,d,p)&&d!==p,v=j>=Gs||g,_=up(c,m+h,x+h);return v&&_}getCenterPoint(r){const{x:a,y:n,startAngle:i,endAngle:o,innerRadius:c,outerRadius:d}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],r),{offset:p,spacing:m}=this.options,x=(i+o)/2,b=(c+d+m+p)/2;return{x:a+Math.cos(x)*b,y:n+Math.sin(x)*b}}tooltipPosition(r){return this.getCenterPoint(r)}draw(r){const{options:a,circumference:n}=this,i=(a.offset||0)/4,o=(a.spacing||0)/2,c=a.circular;if(this.pixelMargin=a.borderAlign==="inner"?.33:0,this.fullCircles=n>Gs?Math.floor(n/Gs):0,n===0||this.innerRadius<0||this.outerRadius<0)return;r.save();const d=(this.startAngle+this.endAngle)/2;r.translate(Math.cos(d)*i,Math.sin(d)*i);const p=1-Math.sin(Math.min(os,n||0)),m=i*p;r.fillStyle=a.backgroundColor,r.strokeStyle=a.borderColor,Pz(r,this,m,o,c),Az(r,this,m,o,c),r.restore()}}ft(hp,"id","arc"),ft(hp,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),ft(hp,"defaultRoutes",{backgroundColor:"backgroundColor"}),ft(hp,"descriptors",{_scriptable:!0,_indexable:r=>r!=="borderDash"});const W0=(s,t)=>{let{boxHeight:r=t,boxWidth:a=t}=s;return s.usePointStyle&&(r=Math.min(r,t),a=s.pointStyleWidth||Math.min(a,t)),{boxWidth:a,boxHeight:r,itemHeight:Math.max(t,r)}},Oz=(s,t)=>s!==null&&t!==null&&s.datasetIndex===t.datasetIndex&&s.index===t.index;class K0 extends nd{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,r,a){this.maxWidth=t,this.maxHeight=r,this._margins=a,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let r=is(t.generateLabels,[this.chart],this)||[];t.filter&&(r=r.filter(a=>t.filter(a,this.chart.data))),t.sort&&(r=r.sort((a,n)=>t.sort(a,n,this.chart.data))),this.options.reverse&&r.reverse(),this.legendItems=r}fit(){const{options:t,ctx:r}=this;if(!t.display){this.width=this.height=0;return}const a=t.labels,n=Nn(a.font),i=n.size,o=this._computeTitleHeight(),{boxWidth:c,itemHeight:d}=W0(a,i);let p,m;r.font=n.string,this.isHorizontal()?(p=this.maxWidth,m=this._fitRows(o,i,c,d)+10):(m=this.maxHeight,p=this._fitCols(o,n,c,d)+10),this.width=Math.min(p,t.maxWidth||this.maxWidth),this.height=Math.min(m,t.maxHeight||this.maxHeight)}_fitRows(t,r,a,n){const{ctx:i,maxWidth:o,options:{labels:{padding:c}}}=this,d=this.legendHitBoxes=[],p=this.lineWidths=[0],m=n+c;let x=t;i.textAlign="left",i.textBaseline="middle";let b=-1,h=-m;return this.legendItems.forEach((j,g)=>{const v=a+r/2+i.measureText(j.text).width;(g===0||p[p.length-1]+v+2*c>o)&&(x+=m,p[p.length-(g>0?0:1)]=0,h+=m,b++),d[g]={left:0,top:h,row:b,width:v,height:n},p[p.length-1]+=v+c}),x}_fitCols(t,r,a,n){const{ctx:i,maxHeight:o,options:{labels:{padding:c}}}=this,d=this.legendHitBoxes=[],p=this.columnSizes=[],m=o-t;let x=c,b=0,h=0,j=0,g=0;return this.legendItems.forEach((v,_)=>{const{itemWidth:k,itemHeight:P}=Dz(a,r,i,v,n);_>0&&h+P+2*c>m&&(x+=b+c,p.push({width:b,height:h}),j+=b+c,g++,b=h=0),d[_]={left:j,top:h,col:g,width:k,height:P},b=Math.max(b,k),h+=P+c}),x+=b,p.push({width:b,height:h}),x}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:r,options:{align:a,labels:{padding:n},rtl:i}}=this,o=du(i,this.left,this.width);if(this.isHorizontal()){let c=0,d=Bn(a,this.left+n,this.right-this.lineWidths[c]);for(const p of r)c!==p.row&&(c=p.row,d=Bn(a,this.left+n,this.right-this.lineWidths[c])),p.top+=this.top+t+n,p.left=o.leftForLtr(o.x(d),p.width),d+=p.width+n}else{let c=0,d=Bn(a,this.top+t+n,this.bottom-this.columnSizes[c].height);for(const p of r)p.col!==c&&(c=p.col,d=Bn(a,this.top+t+n,this.bottom-this.columnSizes[c].height)),p.top=d,p.left+=this.left+n,p.left=o.leftForLtr(o.x(p.left),p.width),d+=p.height+n}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;jg(t,this),this._draw(),_g(t)}}_draw(){const{options:t,columnSizes:r,lineWidths:a,ctx:n}=this,{align:i,labels:o}=t,c=Bs.color,d=du(t.rtl,this.left,this.width),p=Nn(o.font),{padding:m}=o,x=p.size,b=x/2;let h;this.drawTitle(),n.textAlign=d.textAlign("left"),n.textBaseline="middle",n.lineWidth=.5,n.font=p.string;const{boxWidth:j,boxHeight:g,itemHeight:v}=W0(o,x),_=function(W,R,B){if(isNaN(j)||j<=0||isNaN(g)||g<0)return;n.save();const A=Hr(B.lineWidth,1);if(n.fillStyle=Hr(B.fillStyle,c),n.lineCap=Hr(B.lineCap,"butt"),n.lineDashOffset=Hr(B.lineDashOffset,0),n.lineJoin=Hr(B.lineJoin,"miter"),n.lineWidth=A,n.strokeStyle=Hr(B.strokeStyle,c),n.setLineDash(Hr(B.lineDash,[])),o.usePointStyle){const S={radius:g*Math.SQRT2/2,pointStyle:B.pointStyle,rotation:B.rotation,borderWidth:A},C=d.xPlus(W,j/2),O=R+b;l1(n,S,C,O,o.pointStyleWidth&&j)}else{const S=R+Math.max((x-g)/2,0),C=d.leftForLtr(W,j),O=wp(B.borderRadius);n.beginPath(),Object.values(O).some(Z=>Z!==0)?Tb(n,{x:C,y:S,w:j,h:g,radius:O}):n.rect(C,S,j,g),n.fill(),A!==0&&n.stroke()}n.restore()},k=function(W,R,B){Bh(n,B.text,W,R+v/2,p,{strikethrough:B.hidden,textAlign:d.textAlign(B.textAlign)})},P=this.isHorizontal(),L=this._computeTitleHeight();P?h={x:Bn(i,this.left+m,this.right-a[0]),y:this.top+m+L,line:0}:h={x:this.left+m,y:Bn(i,this.top+L+m,this.bottom-r[0].height),line:0},h1(this.ctx,t.textDirection);const F=v+m;this.legendItems.forEach((W,R)=>{n.strokeStyle=W.fontColor,n.fillStyle=W.fontColor;const B=n.measureText(W.text).width,A=d.textAlign(W.textAlign||(W.textAlign=o.textAlign)),S=j+b+B;let C=h.x,O=h.y;d.setWidth(this.width),P?R>0&&C+S+m>this.right&&(O=h.y+=F,h.line++,C=h.x=Bn(i,this.left+m,this.right-a[h.line])):R>0&&O+F>this.bottom&&(C=h.x=C+r[h.line].width+m,h.line++,O=h.y=Bn(i,this.top+L+m,this.bottom-r[h.line].height));const Z=d.x(C);if(_(Z,O,W),C=h3(A,C+j+b,P?C+S:this.right,t.rtl),k(d.x(C),O,W),P)h.x+=S+m;else if(typeof W.text!="string"){const te=p.lineHeight;h.y+=z1(W,te)+m}else h.y+=F}),x1(this.ctx,t.textDirection)}drawTitle(){const t=this.options,r=t.title,a=Nn(r.font),n=Vi(r.padding);if(!r.display)return;const i=du(t.rtl,this.left,this.width),o=this.ctx,c=r.position,d=a.size/2,p=n.top+d;let m,x=this.left,b=this.width;if(this.isHorizontal())b=Math.max(...this.lineWidths),m=this.top+p,x=Bn(t.align,x,this.right-b);else{const j=this.columnSizes.reduce((g,v)=>Math.max(g,v.height),0);m=p+Bn(t.align,this.top,this.bottom-j-t.labels.padding-this._computeTitleHeight())}const h=Bn(c,x,x+b);o.textAlign=i.textAlign(i1(c)),o.textBaseline="middle",o.strokeStyle=r.color,o.fillStyle=r.color,o.font=a.string,Bh(o,r.text,h,m,a)}_computeTitleHeight(){const t=this.options.title,r=Nn(t.font),a=Vi(t.padding);return t.display?r.lineHeight+a.height:0}_getLegendItemAt(t,r){let a,n,i;if(up(t,this.left,this.right)&&up(r,this.top,this.bottom)){for(i=this.legendHitBoxes,a=0;a<i.length;++a)if(n=i[a],up(t,n.left,n.left+n.width)&&up(r,n.top,n.top+n.height))return this.legendItems[a]}return null}handleEvent(t){const r=this.options;if(!Lz(t.type,r))return;const a=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const n=this._hoveredItem,i=Oz(n,a);n&&!i&&is(r.onLeave,[t,n,this],this),this._hoveredItem=a,a&&!i&&is(r.onHover,[t,a,this],this)}else a&&is(r.onClick,[t,a,this],this)}}function Dz(s,t,r,a,n){const i=Ez(a,s,t,r),o=Iz(n,a,t.lineHeight);return{itemWidth:i,itemHeight:o}}function Ez(s,t,r,a){let n=s.text;return n&&typeof n!="string"&&(n=n.reduce((i,o)=>i.length>o.length?i:o)),t+r.size/2+a.measureText(n).width}function Iz(s,t,r){let a=s;return typeof t.text!="string"&&(a=z1(t,r)),a}function z1(s,t){const r=s.text?s.text.length:0;return t*r}function Lz(s,t){return!!((s==="mousemove"||s==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(s==="click"||s==="mouseup"))}var Tz={id:"legend",_element:K0,start(s,t,r){const a=s.legend=new K0({ctx:s.ctx,options:r,chart:s});tc.configure(s,a,r),tc.addBox(s,a)},stop(s){tc.removeBox(s,s.legend),delete s.legend},beforeUpdate(s,t,r){const a=s.legend;tc.configure(s,a,r),a.options=r},afterUpdate(s){const t=s.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(s,t){t.replay||s.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(s,t,r){const a=t.datasetIndex,n=r.chart;n.isDatasetVisible(a)?(n.hide(a),t.hidden=!0):(n.show(a),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:s=>s.chart.options.color,boxWidth:40,padding:10,generateLabels(s){const t=s.data.datasets,{labels:{usePointStyle:r,pointStyle:a,textAlign:n,color:i,useBorderRadius:o,borderRadius:c}}=s.legend.options;return s._getSortedDatasetMetas().map(d=>{const p=d.controller.getStyle(r?0:void 0),m=Vi(p.borderWidth);return{text:t[d.index].label,fillStyle:p.backgroundColor,fontColor:i,hidden:!d.visible,lineCap:p.borderCapStyle,lineDash:p.borderDash,lineDashOffset:p.borderDashOffset,lineJoin:p.borderJoinStyle,lineWidth:(m.width+m.height)/4,strokeStyle:p.borderColor,pointStyle:a||p.pointStyle,rotation:p.rotation,textAlign:n||p.textAlign,borderRadius:o&&(c||p.borderRadius),datasetIndex:d.index}},this)}},title:{color:s=>s.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:s=>!s.startsWith("on"),labels:{_scriptable:s=>!["generateLabels","filter","sort"].includes(s)}}};const xp={average(s){if(!s.length)return!1;let t,r,a=new Set,n=0,i=0;for(t=0,r=s.length;t<r;++t){const c=s[t].element;if(c&&c.hasValue()){const d=c.tooltipPosition();a.add(d.x),n+=d.y,++i}}return i===0||a.size===0?!1:{x:[...a].reduce((c,d)=>c+d)/a.size,y:n/i}},nearest(s,t){if(!s.length)return!1;let r=t.x,a=t.y,n=Number.POSITIVE_INFINITY,i,o,c;for(i=0,o=s.length;i<o;++i){const d=s[i].element;if(d&&d.hasValue()){const p=d.getCenterPoint(),m=o3(t,p);m<n&&(n=m,c=d)}}if(c){const d=c.tooltipPosition();r=d.x,a=d.y}return{x:r,y:a}}};function xo(s,t){return t&&(ja(t)?Array.prototype.push.apply(s,t):s.push(t)),s}function il(s){return(typeof s=="string"||s instanceof String)&&s.indexOf(`
`)>-1?s.split(`
`):s}function Rz(s,t){const{element:r,datasetIndex:a,index:n}=t,i=s.getDatasetMeta(a).controller,{label:o,value:c}=i.getLabelAndValue(n);return{chart:s,label:o,parsed:i.getParsed(n),raw:s.data.datasets[a].data[n],formattedValue:c,dataset:i.getDataset(),dataIndex:n,datasetIndex:a,element:r}}function G0(s,t){const r=s.chart.ctx,{body:a,footer:n,title:i}=s,{boxWidth:o,boxHeight:c}=t,d=Nn(t.bodyFont),p=Nn(t.titleFont),m=Nn(t.footerFont),x=i.length,b=n.length,h=a.length,j=Vi(t.padding);let g=j.height,v=0,_=a.reduce((L,F)=>L+F.before.length+F.lines.length+F.after.length,0);if(_+=s.beforeBody.length+s.afterBody.length,x&&(g+=x*p.lineHeight+(x-1)*t.titleSpacing+t.titleMarginBottom),_){const L=t.displayColors?Math.max(c,d.lineHeight):d.lineHeight;g+=h*L+(_-h)*d.lineHeight+(_-1)*t.bodySpacing}b&&(g+=t.footerMarginTop+b*m.lineHeight+(b-1)*t.footerSpacing);let k=0;const P=function(L){v=Math.max(v,r.measureText(L).width+k)};return r.save(),r.font=p.string,Vr(s.title,P),r.font=d.string,Vr(s.beforeBody.concat(s.afterBody),P),k=t.displayColors?o+2+t.boxPadding:0,Vr(a,L=>{Vr(L.before,P),Vr(L.lines,P),Vr(L.after,P)}),k=0,r.font=m.string,Vr(s.footer,P),r.restore(),v+=j.width,{width:v,height:g}}function Mz(s,t){const{y:r,height:a}=t;return r<a/2?"top":r>s.height-a/2?"bottom":"center"}function Fz(s,t,r,a){const{x:n,width:i}=a,o=r.caretSize+r.caretPadding;if(s==="left"&&n+i+o>t.width||s==="right"&&n-i-o<0)return!0}function Uz(s,t,r,a){const{x:n,width:i}=r,{width:o,chartArea:{left:c,right:d}}=s;let p="center";return a==="center"?p=n<=(c+d)/2?"left":"right":n<=i/2?p="left":n>=o-i/2&&(p="right"),Fz(p,s,t,r)&&(p="center"),p}function Y0(s,t,r){const a=r.yAlign||t.yAlign||Mz(s,r);return{xAlign:r.xAlign||t.xAlign||Uz(s,t,r,a),yAlign:a}}function qz(s,t){let{x:r,width:a}=s;return t==="right"?r-=a:t==="center"&&(r-=a/2),r}function $z(s,t,r){let{y:a,height:n}=s;return t==="top"?a+=r:t==="bottom"?a-=n+r:a-=n/2,a}function J0(s,t,r,a){const{caretSize:n,caretPadding:i,cornerRadius:o}=s,{xAlign:c,yAlign:d}=r,p=n+i,{topLeft:m,topRight:x,bottomLeft:b,bottomRight:h}=wp(o);let j=qz(t,c);const g=$z(t,d,p);return d==="center"?c==="left"?j+=p:c==="right"&&(j-=p):c==="left"?j-=Math.max(m,b)+n:c==="right"&&(j+=Math.max(x,h)+n),{x:mi(j,0,a.width-t.width),y:mi(g,0,a.height-t.height)}}function eh(s,t,r){const a=Vi(r.padding);return t==="center"?s.x+s.width/2:t==="right"?s.x+s.width-a.right:s.x+a.left}function X0(s){return xo([],il(s))}function Bz(s,t,r){return Nu(s,{tooltip:t,tooltipItems:r,type:"tooltip"})}function Q0(s,t){const r=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return r?s.override(r):s}const C1={beforeTitle:rl,title(s){if(s.length>0){const t=s[0],r=t.chart.data.labels,a=r?r.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(a>0&&t.dataIndex<a)return r[t.dataIndex]}return""},afterTitle:rl,beforeBody:rl,beforeLabel:rl,label(s){if(this&&this.options&&this.options.mode==="dataset")return s.label+": "+s.formattedValue||s.formattedValue;let t=s.dataset.label||"";t&&(t+=": ");const r=s.formattedValue;return Ua(r)||(t+=r),t},labelColor(s){const r=s.chart.getDatasetMeta(s.datasetIndex).controller.getStyle(s.dataIndex);return{borderColor:r.borderColor,backgroundColor:r.backgroundColor,borderWidth:r.borderWidth,borderDash:r.borderDash,borderDashOffset:r.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(s){const r=s.chart.getDatasetMeta(s.datasetIndex).controller.getStyle(s.dataIndex);return{pointStyle:r.pointStyle,rotation:r.rotation}},afterLabel:rl,afterBody:rl,beforeFooter:rl,footer:rl,afterFooter:rl};function vn(s,t,r,a){const n=s[t].call(r,a);return typeof n>"u"?C1[t].call(r,a):n}class Fb extends nd{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const r=this.chart,a=this.options.setContext(this.getContext()),n=a.enabled&&r.options.animation&&a.animations,i=new f1(this.chart,n);return n._cacheable&&(this._cachedAnimations=Object.freeze(i)),i}getContext(){return this.$context||(this.$context=Bz(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,r){const{callbacks:a}=r,n=vn(a,"beforeTitle",this,t),i=vn(a,"title",this,t),o=vn(a,"afterTitle",this,t);let c=[];return c=xo(c,il(n)),c=xo(c,il(i)),c=xo(c,il(o)),c}getBeforeBody(t,r){return X0(vn(r.callbacks,"beforeBody",this,t))}getBody(t,r){const{callbacks:a}=r,n=[];return Vr(t,i=>{const o={before:[],lines:[],after:[]},c=Q0(a,i);xo(o.before,il(vn(c,"beforeLabel",this,i))),xo(o.lines,vn(c,"label",this,i)),xo(o.after,il(vn(c,"afterLabel",this,i))),n.push(o)}),n}getAfterBody(t,r){return X0(vn(r.callbacks,"afterBody",this,t))}getFooter(t,r){const{callbacks:a}=r,n=vn(a,"beforeFooter",this,t),i=vn(a,"footer",this,t),o=vn(a,"afterFooter",this,t);let c=[];return c=xo(c,il(n)),c=xo(c,il(i)),c=xo(c,il(o)),c}_createItems(t){const r=this._active,a=this.chart.data,n=[],i=[],o=[];let c=[],d,p;for(d=0,p=r.length;d<p;++d)c.push(Rz(this.chart,r[d]));return t.filter&&(c=c.filter((m,x,b)=>t.filter(m,x,b,a))),t.itemSort&&(c=c.sort((m,x)=>t.itemSort(m,x,a))),Vr(c,m=>{const x=Q0(t.callbacks,m);n.push(vn(x,"labelColor",this,m)),i.push(vn(x,"labelPointStyle",this,m)),o.push(vn(x,"labelTextColor",this,m))}),this.labelColors=n,this.labelPointStyles=i,this.labelTextColors=o,this.dataPoints=c,c}update(t,r){const a=this.options.setContext(this.getContext()),n=this._active;let i,o=[];if(!n.length)this.opacity!==0&&(i={opacity:0});else{const c=xp[a.position].call(this,n,this._eventPosition);o=this._createItems(a),this.title=this.getTitle(o,a),this.beforeBody=this.getBeforeBody(o,a),this.body=this.getBody(o,a),this.afterBody=this.getAfterBody(o,a),this.footer=this.getFooter(o,a);const d=this._size=G0(this,a),p=Object.assign({},c,d),m=Y0(this.chart,a,p),x=J0(a,p,m,this.chart);this.xAlign=m.xAlign,this.yAlign=m.yAlign,i={opacity:1,x:x.x,y:x.y,width:d.width,height:d.height,caretX:c.x,caretY:c.y}}this._tooltipItems=o,this.$context=void 0,i&&this._resolveAnimations().update(this,i),t&&a.external&&a.external.call(this,{chart:this.chart,tooltip:this,replay:r})}drawCaret(t,r,a,n){const i=this.getCaretPosition(t,a,n);r.lineTo(i.x1,i.y1),r.lineTo(i.x2,i.y2),r.lineTo(i.x3,i.y3)}getCaretPosition(t,r,a){const{xAlign:n,yAlign:i}=this,{caretSize:o,cornerRadius:c}=a,{topLeft:d,topRight:p,bottomLeft:m,bottomRight:x}=wp(c),{x:b,y:h}=t,{width:j,height:g}=r;let v,_,k,P,L,F;return i==="center"?(L=h+g/2,n==="left"?(v=b,_=v-o,P=L+o,F=L-o):(v=b+j,_=v+o,P=L-o,F=L+o),k=v):(n==="left"?_=b+Math.max(d,m)+o:n==="right"?_=b+j-Math.max(p,x)-o:_=this.caretX,i==="top"?(P=h,L=P-o,v=_-o,k=_+o):(P=h+g,L=P+o,v=_+o,k=_-o),F=P),{x1:v,x2:_,x3:k,y1:P,y2:L,y3:F}}drawTitle(t,r,a){const n=this.title,i=n.length;let o,c,d;if(i){const p=du(a.rtl,this.x,this.width);for(t.x=eh(this,a.titleAlign,a),r.textAlign=p.textAlign(a.titleAlign),r.textBaseline="middle",o=Nn(a.titleFont),c=a.titleSpacing,r.fillStyle=a.titleColor,r.font=o.string,d=0;d<i;++d)r.fillText(n[d],p.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+c,d+1===i&&(t.y+=a.titleMarginBottom-c)}}_drawColorBox(t,r,a,n,i){const o=this.labelColors[a],c=this.labelPointStyles[a],{boxHeight:d,boxWidth:p}=i,m=Nn(i.bodyFont),x=eh(this,"left",i),b=n.x(x),h=d<m.lineHeight?(m.lineHeight-d)/2:0,j=r.y+h;if(i.usePointStyle){const g={radius:Math.min(p,d)/2,pointStyle:c.pointStyle,rotation:c.rotation,borderWidth:1},v=n.leftForLtr(b,p)+p/2,_=j+d/2;t.strokeStyle=i.multiKeyBackground,t.fillStyle=i.multiKeyBackground,b0(t,g,v,_),t.strokeStyle=o.borderColor,t.fillStyle=o.backgroundColor,b0(t,g,v,_)}else{t.lineWidth=Dr(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,t.strokeStyle=o.borderColor,t.setLineDash(o.borderDash||[]),t.lineDashOffset=o.borderDashOffset||0;const g=n.leftForLtr(b,p),v=n.leftForLtr(n.xPlus(b,1),p-2),_=wp(o.borderRadius);Object.values(_).some(k=>k!==0)?(t.beginPath(),t.fillStyle=i.multiKeyBackground,Tb(t,{x:g,y:j,w:p,h:d,radius:_}),t.fill(),t.stroke(),t.fillStyle=o.backgroundColor,t.beginPath(),Tb(t,{x:v,y:j+1,w:p-2,h:d-2,radius:_}),t.fill()):(t.fillStyle=i.multiKeyBackground,t.fillRect(g,j,p,d),t.strokeRect(g,j,p,d),t.fillStyle=o.backgroundColor,t.fillRect(v,j+1,p-2,d-2))}t.fillStyle=this.labelTextColors[a]}drawBody(t,r,a){const{body:n}=this,{bodySpacing:i,bodyAlign:o,displayColors:c,boxHeight:d,boxWidth:p,boxPadding:m}=a,x=Nn(a.bodyFont);let b=x.lineHeight,h=0;const j=du(a.rtl,this.x,this.width),g=function(B){r.fillText(B,j.x(t.x+h),t.y+b/2),t.y+=b+i},v=j.textAlign(o);let _,k,P,L,F,W,R;for(r.textAlign=o,r.textBaseline="middle",r.font=x.string,t.x=eh(this,v,a),r.fillStyle=a.bodyColor,Vr(this.beforeBody,g),h=c&&v!=="right"?o==="center"?p/2+m:p+2+m:0,L=0,W=n.length;L<W;++L){for(_=n[L],k=this.labelTextColors[L],r.fillStyle=k,Vr(_.before,g),P=_.lines,c&&P.length&&(this._drawColorBox(r,t,L,j,a),b=Math.max(x.lineHeight,d)),F=0,R=P.length;F<R;++F)g(P[F]),b=x.lineHeight;Vr(_.after,g)}h=0,b=x.lineHeight,Vr(this.afterBody,g),t.y-=i}drawFooter(t,r,a){const n=this.footer,i=n.length;let o,c;if(i){const d=du(a.rtl,this.x,this.width);for(t.x=eh(this,a.footerAlign,a),t.y+=a.footerMarginTop,r.textAlign=d.textAlign(a.footerAlign),r.textBaseline="middle",o=Nn(a.footerFont),r.fillStyle=a.footerColor,r.font=o.string,c=0;c<i;++c)r.fillText(n[c],d.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+a.footerSpacing}}drawBackground(t,r,a,n){const{xAlign:i,yAlign:o}=this,{x:c,y:d}=t,{width:p,height:m}=a,{topLeft:x,topRight:b,bottomLeft:h,bottomRight:j}=wp(n.cornerRadius);r.fillStyle=n.backgroundColor,r.strokeStyle=n.borderColor,r.lineWidth=n.borderWidth,r.beginPath(),r.moveTo(c+x,d),o==="top"&&this.drawCaret(t,r,a,n),r.lineTo(c+p-b,d),r.quadraticCurveTo(c+p,d,c+p,d+b),o==="center"&&i==="right"&&this.drawCaret(t,r,a,n),r.lineTo(c+p,d+m-j),r.quadraticCurveTo(c+p,d+m,c+p-j,d+m),o==="bottom"&&this.drawCaret(t,r,a,n),r.lineTo(c+h,d+m),r.quadraticCurveTo(c,d+m,c,d+m-h),o==="center"&&i==="left"&&this.drawCaret(t,r,a,n),r.lineTo(c,d+x),r.quadraticCurveTo(c,d,c+x,d),r.closePath(),r.fill(),n.borderWidth>0&&r.stroke()}_updateAnimationTarget(t){const r=this.chart,a=this.$animations,n=a&&a.x,i=a&&a.y;if(n||i){const o=xp[t.position].call(this,this._active,this._eventPosition);if(!o)return;const c=this._size=G0(this,t),d=Object.assign({},o,this._size),p=Y0(r,t,d),m=J0(t,d,p,r);(n._to!==m.x||i._to!==m.y)&&(this.xAlign=p.xAlign,this.yAlign=p.yAlign,this.width=c.width,this.height=c.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,m))}}_willRender(){return!!this.opacity}draw(t){const r=this.options.setContext(this.getContext());let a=this.opacity;if(!a)return;this._updateAnimationTarget(r);const n={width:this.width,height:this.height},i={x:this.x,y:this.y};a=Math.abs(a)<.001?0:a;const o=Vi(r.padding),c=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;r.enabled&&c&&(t.save(),t.globalAlpha=a,this.drawBackground(i,t,n,r),h1(t,r.textDirection),i.y+=o.top,this.drawTitle(i,t,r),this.drawBody(i,t,r),this.drawFooter(i,t,r),x1(t,r.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,r){const a=this._active,n=t.map(({datasetIndex:c,index:d})=>{const p=this.chart.getDatasetMeta(c);if(!p)throw new Error("Cannot find a dataset at index "+c);return{datasetIndex:c,element:p.data[d],index:d}}),i=!Rh(a,n),o=this._positionChanged(n,r);(i||o)&&(this._active=n,this._eventPosition=r,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,r,a=!0){if(r&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const n=this.options,i=this._active||[],o=this._getActiveElements(t,i,r,a),c=this._positionChanged(o,t),d=r||!Rh(o,i)||c;return d&&(this._active=o,(n.enabled||n.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,r))),d}_getActiveElements(t,r,a,n){const i=this.options;if(t.type==="mouseout")return[];if(!n)return r.filter(c=>this.chart.data.datasets[c.datasetIndex]&&this.chart.getDatasetMeta(c.datasetIndex).controller.getParsed(c.index)!==void 0);const o=this.chart.getElementsAtEventForMode(t,i.mode,i,a);return i.reverse&&o.reverse(),o}_positionChanged(t,r){const{caretX:a,caretY:n,options:i}=this,o=xp[i.position].call(this,t,r);return o!==!1&&(a!==o.x||n!==o.y)}}ft(Fb,"positioners",xp);var Vz={id:"tooltip",_element:Fb,positioners:xp,afterInit(s,t,r){r&&(s.tooltip=new Fb({chart:s,options:r}))},beforeUpdate(s,t,r){s.tooltip&&s.tooltip.initialize(r)},reset(s,t,r){s.tooltip&&s.tooltip.initialize(r)},afterDraw(s){const t=s.tooltip;if(t&&t._willRender()){const r={tooltip:t};if(s.notifyPlugins("beforeTooltipDraw",{...r,cancelable:!0})===!1)return;t.draw(s.ctx),s.notifyPlugins("afterTooltipDraw",r)}},afterEvent(s,t){if(s.tooltip){const r=t.replay;s.tooltip.handleEvent(t.event,r,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(s,t)=>t.bodyFont.size,boxWidth:(s,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:C1},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:s=>s!=="filter"&&s!=="itemSort"&&s!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const px={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},kn=Object.keys(px);function ej(s,t){return s-t}function tj(s,t){if(Ua(t))return null;const r=s._adapter,{parser:a,round:n,isoWeekday:i}=s._parseOpts;let o=t;return typeof a=="function"&&(o=a(o)),ml(o)||(o=typeof a=="string"?r.parse(o,a):r.parse(o)),o===null?null:(n&&(o=n==="week"&&(qh(i)||i===!0)?r.startOf(o,"isoWeek",i):r.startOf(o,n)),+o)}function rj(s,t,r,a){const n=kn.length;for(let i=kn.indexOf(s);i<n-1;++i){const o=px[kn[i]],c=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((r-t)/(c*o.size))<=a)return kn[i]}return kn[n-1]}function Hz(s,t,r,a,n){for(let i=kn.length-1;i>=kn.indexOf(r);i--){const o=kn[i];if(px[o].common&&s._adapter.diff(n,a,o)>=t-1)return o}return kn[r?kn.indexOf(r):0]}function Zz(s){for(let t=kn.indexOf(s)+1,r=kn.length;t<r;++t)if(px[kn[t]].common)return kn[t]}function sj(s,t,r){if(!r)s[t]=!0;else if(r.length){const{lo:a,hi:n}=yg(r,t),i=r[a]>=t?r[a]:r[n];s[i]=!0}}function Wz(s,t,r,a){const n=s._adapter,i=+n.startOf(t[0].value,a),o=t[t.length-1].value;let c,d;for(c=i;c<=o;c=+n.add(c,1,a))d=r[c],d>=0&&(t[d].major=!0);return t}function aj(s,t,r){const a=[],n={},i=t.length;let o,c;for(o=0;o<i;++o)c=t[o],n[c]=o,a.push({value:c,major:!1});return i===0||!r?a:Wz(s,a,n,r)}class Wh extends dx{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,r={}){const a=t.time||(t.time={}),n=this._adapter=new f6._date(t.adapters.date);n.init(r),_p(a.displayFormats,n.formats()),this._parseOpts={parser:a.parser,round:a.round,isoWeekday:a.isoWeekday},super.init(t),this._normalized=r.normalized}parse(t,r){return t===void 0?null:tj(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,r=this._adapter,a=t.time.unit||"day";let{min:n,max:i,minDefined:o,maxDefined:c}=this.getUserBounds();function d(p){!o&&!isNaN(p.min)&&(n=Math.min(n,p.min)),!c&&!isNaN(p.max)&&(i=Math.max(i,p.max))}(!o||!c)&&(d(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&d(this.getMinMax(!1))),n=ml(n)&&!isNaN(n)?n:+r.startOf(Date.now(),a),i=ml(i)&&!isNaN(i)?i:+r.endOf(Date.now(),a)+1,this.min=Math.min(n,i-1),this.max=Math.max(n+1,i)}_getLabelBounds(){const t=this.getLabelTimestamps();let r=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY;return t.length&&(r=t[0],a=t[t.length-1]),{min:r,max:a}}buildTicks(){const t=this.options,r=t.time,a=t.ticks,n=a.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&n.length&&(this.min=this._userMin||n[0],this.max=this._userMax||n[n.length-1]);const i=this.min,o=this.max,c=d3(n,i,o);return this._unit=r.unit||(a.autoSkip?rj(r.minUnit,this.min,this.max,this._getLabelCapacity(i)):Hz(this,c.length,r.minUnit,this.min,this.max)),this._majorUnit=!a.major.enabled||this._unit==="year"?void 0:Zz(this._unit),this.initOffsets(n),t.reverse&&c.reverse(),aj(this,c,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let r=0,a=0,n,i;this.options.offset&&t.length&&(n=this.getDecimalForValue(t[0]),t.length===1?r=1-n:r=(this.getDecimalForValue(t[1])-n)/2,i=this.getDecimalForValue(t[t.length-1]),t.length===1?a=i:a=(i-this.getDecimalForValue(t[t.length-2]))/2);const o=t.length<3?.5:.25;r=mi(r,0,o),a=mi(a,0,o),this._offsets={start:r,end:a,factor:1/(r+1+a)}}_generate(){const t=this._adapter,r=this.min,a=this.max,n=this.options,i=n.time,o=i.unit||rj(i.minUnit,r,a,this._getLabelCapacity(r)),c=Hr(n.ticks.stepSize,1),d=o==="week"?i.isoWeekday:!1,p=qh(d)||d===!0,m={};let x=r,b,h;if(p&&(x=+t.startOf(x,"isoWeek",d)),x=+t.startOf(x,p?"day":o),t.diff(a,r,o)>1e5*c)throw new Error(r+" and "+a+" are too far apart with stepSize of "+c+" "+o);const j=n.ticks.source==="data"&&this.getDataTimestamps();for(b=x,h=0;b<a;b=+t.add(b,c,o),h++)sj(m,b,j);return(b===a||n.bounds==="ticks"||h===1)&&sj(m,b,j),Object.keys(m).sort(ej).map(g=>+g)}getLabelForValue(t){const r=this._adapter,a=this.options.time;return a.tooltipFormat?r.format(t,a.tooltipFormat):r.format(t,a.displayFormats.datetime)}format(t,r){const n=this.options.time.displayFormats,i=this._unit,o=r||n[i];return this._adapter.format(t,o)}_tickFormatFunction(t,r,a,n){const i=this.options,o=i.ticks.callback;if(o)return is(o,[t,r,a],this);const c=i.time.displayFormats,d=this._unit,p=this._majorUnit,m=d&&c[d],x=p&&c[p],b=a[r],h=p&&x&&b&&b.major;return this._adapter.format(t,n||(h?x:m))}generateTickLabels(t){let r,a,n;for(r=0,a=t.length;r<a;++r)n=t[r],n.label=this._tickFormatFunction(n.value,r,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const r=this._offsets,a=this.getDecimalForValue(t);return this.getPixelForDecimal((r.start+a)*r.factor)}getValueForPixel(t){const r=this._offsets,a=this.getDecimalForPixel(t)/r.factor-r.end;return this.min+a*(this.max-this.min)}_getLabelSize(t){const r=this.options.ticks,a=this.ctx.measureText(t).width,n=Jc(this.isHorizontal()?r.maxRotation:r.minRotation),i=Math.cos(n),o=Math.sin(n),c=this._resolveTickFontOptions(0).size;return{w:a*i+c*o,h:a*o+c*i}}_getLabelCapacity(t){const r=this.options.time,a=r.displayFormats,n=a[r.unit]||a.millisecond,i=this._tickFormatFunction(t,0,aj(this,[t],this._majorUnit),n),o=this._getLabelSize(i),c=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return c>0?c:1}getDataTimestamps(){let t=this._cache.data||[],r,a;if(t.length)return t;const n=this.getMatchingVisibleMetas();if(this._normalized&&n.length)return this._cache.data=n[0].controller.getAllParsedValues(this);for(r=0,a=n.length;r<a;++r)t=t.concat(n[r].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let r,a;if(t.length)return t;const n=this.getLabels();for(r=0,a=n.length;r<a;++r)t.push(tj(this,n[r]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return p3(t.sort(ej))}}ft(Wh,"id","time"),ft(Wh,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function th(s,t,r){let a=0,n=s.length-1,i,o,c,d;r?(t>=s[a].pos&&t<=s[n].pos&&({lo:a,hi:n}=Ib(s,"pos",t)),{pos:i,time:c}=s[a],{pos:o,time:d}=s[n]):(t>=s[a].time&&t<=s[n].time&&({lo:a,hi:n}=Ib(s,"time",t)),{time:i,pos:c}=s[a],{time:o,pos:d}=s[n]);const p=o-i;return p?c+(d-c)*(t-i)/p:c}class nj extends Wh{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),r=this._table=this.buildLookupTable(t);this._minPos=th(r,this.min),this._tableRange=th(r,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:r,max:a}=this,n=[],i=[];let o,c,d,p,m;for(o=0,c=t.length;o<c;++o)p=t[o],p>=r&&p<=a&&n.push(p);if(n.length<2)return[{time:r,pos:0},{time:a,pos:1}];for(o=0,c=n.length;o<c;++o)m=n[o+1],d=n[o-1],p=n[o],Math.round((m+d)/2)!==p&&i.push({time:p,pos:o/(c-1)});return i}_generate(){const t=this.min,r=this.max;let a=super.getDataTimestamps();return(!a.includes(t)||!a.length)&&a.splice(0,0,t),(!a.includes(r)||a.length===1)&&a.push(r),a.sort((n,i)=>n-i)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const r=this.getDataTimestamps(),a=this.getLabelTimestamps();return r.length&&a.length?t=this.normalize(r.concat(a)):t=r.length?r:a,t=this._cache.all=t,t}getDecimalForValue(t){return(th(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const r=this._offsets,a=this.getDecimalForPixel(t)/r.factor-r.end;return th(this._table,a*this._tableRange+this._minPos,!0)}}ft(nj,"id","timeseries"),ft(nj,"defaults",Wh.defaults);const P1="label";function ij(s,t){typeof s=="function"?s(t):s&&(s.current=t)}function Kz(s,t){const r=s.options;r&&t&&Object.assign(r,t)}function A1(s,t){s.labels=t}function O1(s,t,r=P1){const a=[];s.datasets=t.map(n=>{const i=s.datasets.find(o=>o[r]===n[r]);return!i||!n.data||a.includes(i)?{...n}:(a.push(i),Object.assign(i,n),i)})}function Gz(s,t=P1){const r={labels:[],datasets:[]};return A1(r,s.labels),O1(r,s.datasets,t),r}function Yz(s,t){const{height:r=150,width:a=300,redraw:n=!1,datasetIdKey:i,type:o,data:c,options:d,plugins:p=[],fallbackContent:m,updateMode:x,...b}=s,h=z.useRef(null),j=z.useRef(null),g=()=>{h.current&&(j.current=new ux(h.current,{type:o,data:Gz(c,i),options:d&&{...d},plugins:p}),ij(t,j.current))},v=()=>{ij(t,null),j.current&&(j.current.destroy(),j.current=null)};return z.useEffect(()=>{!n&&j.current&&d&&Kz(j.current,d)},[n,d]),z.useEffect(()=>{!n&&j.current&&A1(j.current.config.data,c.labels)},[n,c.labels]),z.useEffect(()=>{!n&&j.current&&c.datasets&&O1(j.current.config.data,c.datasets,i)},[n,c.datasets]),z.useEffect(()=>{j.current&&(n?(v(),setTimeout(g)):j.current.update(x))},[n,d,c.labels,c.datasets,x]),z.useEffect(()=>{j.current&&(v(),setTimeout(g))},[o]),z.useEffect(()=>(g(),()=>v()),[]),e.jsx("canvas",{ref:h,role:"img",height:r,width:a,...b,children:m})}const Jz=z.forwardRef(Yz);function Xz(s,t){return ux.register(t),z.forwardRef((r,a)=>e.jsx(Jz,{...r,ref:a,type:s}))}const Qz=Xz("doughnut",pp);ux.register(hp,Vz,Tz);function Tf({title:s,data:t}){const r={labels:t.labels,datasets:[{data:t.values,backgroundColor:t.colors,borderWidth:0,borderRadius:4,spacing:2}]},a={responsive:!0,maintainAspectRatio:!0,cutout:"60%",plugins:{legend:{display:!1},tooltip:{enabled:!0,backgroundColor:"#282828",titleColor:"#e4e4e7",bodyColor:"#a1a1aa",borderColor:"rgba(255, 255, 255, 0.1)",borderWidth:1,padding:12,displayColors:!0,callbacks:{label:n=>{const i=n.label||"",o=n.parsed;return`${i}: ${o}`}}}},animation:{animateRotate:!0,animateScale:!1,duration:800,easing:"easeOutQuart"}};return e.jsxs("div",{className:"bg-bg-surface p-8 rounded-lg border border-border-subtle",children:[e.jsx("h3",{className:"text-heading-md font-semibold text-text-primary mb-6",children:s}),e.jsx("div",{className:"w-[280px] h-[280px] mx-auto",children:e.jsx(Qz,{data:r,options:a})}),e.jsx("div",{className:"mt-6 space-y-3",children:t.labels.map((n,i)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:t.colors[i]}}),e.jsx("span",{className:"text-body-sm text-text-secondary",children:n}),e.jsx("span",{className:"text-body-sm font-medium text-text-primary ml-auto",children:t.values[i]})]},i))})]})}function dl({title:s,columns:t,data:r,onViewAll:a,onViewItem:n,onEditItem:i,onDeleteItem:o,customActions:c}){const{t:d}=et();return e.jsxs("div",{className:"bg-bg-surface p-8 rounded-lg border border-border-subtle",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-heading-md font-semibold text-text-primary",children:s}),a&&e.jsx("button",{onClick:()=>{console.log("DataTable: View All button clicked"),a()},className:"text-body-sm font-medium text-accent-primary hover:text-accent-primary-hover transition-colors duration-150",children:d("common.viewAll")})]}),e.jsx("div",{className:"border border-border-subtle rounded-md overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-near-black border-b border-border-moderate",children:e.jsxs("tr",{children:[t.map((p,m)=>e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-medium text-text-secondary uppercase tracking-wider",children:p.header},m)),(n||i||o||c)&&e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-medium text-text-secondary uppercase tracking-wider",children:d("common.actions")})]})}),e.jsx("tbody",{children:r.map((p,m)=>e.jsxs("tr",{className:`
                    border-b border-border-subtle hover:bg-bg-surface-hover transition-colors duration-200
                    ${m===r.length-1?"border-b-0":""}
                  `,children:[t.map((x,b)=>e.jsx("td",{className:`px-4 py-4 text-body-sm text-text-primary ${x.className||""}`,children:x.render?x.render(p):String(p[x.key]||"-")},b)),(n||i||o||c)&&e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[n&&e.jsx("button",{onClick:()=>{console.log("DataTable: View button clicked for item:",p),n(p)},className:`h-8 w-8 p-0 text-accent-primary border border-accent-primary rounded-sm
                                       hover:bg-accent-primary hover:text-white transition-all duration-200 flex items-center justify-center`,title:d("common.view"),children:e.jsx(lr,{className:"w-4 h-4"})}),i&&e.jsx("button",{onClick:()=>{console.log("DataTable: Edit button clicked for item:",p),i(p)},className:`h-8 w-8 p-0 text-blue-600 border border-blue-600 rounded-sm
                                       hover:bg-blue-600 hover:text-white transition-all duration-200 flex items-center justify-center`,title:d("common.edit"),children:e.jsx(ar,{className:"w-4 h-4"})}),c&&c(p),o&&e.jsx("button",{onClick:()=>{console.log("DataTable: Delete button clicked for item:",p),o(p)},className:`h-8 w-8 p-0 text-risk-high border border-risk-high rounded-sm
                                       hover:bg-risk-high hover:text-white transition-all duration-200 flex items-center justify-center`,title:d("common.delete"),children:e.jsx(pr,{className:"w-4 h-4"})})]})})]},p.id))})]})})})]})}function Yp({isOpen:s,onClose:t,title:r,children:a}){return s?(console.log("DetailModal: Opening modal with title:",r),e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:()=>{console.log("DetailModal: Backdrop clicked - closing modal"),t()}}),e.jsxs("div",{className:"relative bg-bg-surface border border-border-subtle rounded-lg shadow-xl max-w-3xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-border-subtle bg-gradient-to-r from-accent-primary/10 to-accent-secondary/10",children:[e.jsx("h2",{className:"text-h3 text-text-primary font-semibold",children:r}),e.jsx("button",{onClick:()=>{console.log("DetailModal: X button clicked - closing modal"),t()},className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150 hover:shadow-glow-sm","aria-label":"Zapri",children:e.jsx(Ar,{className:"w-5 h-5 text-text-secondary"})})]}),e.jsx("div",{className:"p-6",children:a})]})]})):null}function Ag({isOpen:s,onClose:t,incident:r}){return r?e.jsx(Yp,{isOpen:s,onClose:t,title:`Incident: ${r.incident_id}`,children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"ID incidenta"}),e.jsx("p",{className:"text-body-lg text-text-primary font-mono bg-bg-near-black px-4 py-2 rounded border border-border-subtle",children:r.incident_id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Tip incidenta"}),e.jsx("p",{className:"text-body-lg text-text-primary bg-bg-near-black px-4 py-2 rounded border border-border-subtle",children:r.type})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Ocenjena koda"}),e.jsx("div",{className:"flex items-center",children:e.jsx(vr,{type:"risk",value:r.estimated_damage})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Status"}),e.jsx("div",{className:"flex items-center",children:e.jsx(vr,{type:"status",value:r.status})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Datum detekcije"}),e.jsx("p",{className:"text-body-lg text-text-primary bg-bg-near-black px-4 py-2 rounded border border-border-subtle",children:new Date(r.detected_at).toLocaleString("sl-SI")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Datum reitve"}),e.jsx("p",{className:"text-body-lg text-text-primary bg-bg-near-black px-4 py-2 rounded border border-border-subtle",children:r.resolved_at?new Date(r.resolved_at).toLocaleString("sl-SI"):"Ni reeno"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"zahteva NIS-2"}),e.jsx("p",{className:"text-body-lg text-text-primary bg-bg-near-black px-4 py-2 rounded border border-border-subtle",children:r.nis2_required?" Da":" Ne"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Control Manager"}),e.jsx("p",{className:"text-body-lg text-text-primary bg-bg-near-black px-4 py-2 rounded border border-border-subtle",children:r.control_manager||"Ni doloen"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Datum poroanja"}),e.jsx("p",{className:"text-body-lg text-text-primary bg-bg-near-black px-4 py-2 rounded border border-border-subtle",children:r.report_date?new Date(r.report_date).toLocaleDateString("sl-SI"):"Ni poroano"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Ustvarjeno"}),e.jsx("p",{className:"text-body-lg text-text-primary bg-bg-near-black px-4 py-2 rounded border border-border-subtle",children:new Date(r.created_at).toLocaleString("sl-SI")})]})]}),e.jsx("div",{className:"flex justify-end gap-3 pt-4 border-t border-border-subtle",children:e.jsx("button",{onClick:t,className:"px-6 py-2 bg-bg-near-black text-text-primary border border-border-subtle rounded hover:bg-bg-surface transition-colors duration-150",children:"Zapri"})})]})}):null}function eC({isOpen:s,onClose:t,report:r}){var a;return r?e.jsx(Yp,{isOpen:s,onClose:t,title:`Cyber Poroilo: ${r.referencna_stevilka||r.incident_number||"Novo poroilo"}`,children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"0.1 Referenna tevilka"}),e.jsx("p",{className:"text-body-lg text-text-primary font-mono bg-bg-near-black px-4 py-2 rounded border border-border-subtle",children:r.referencna_stevilka||r.incident_number||`INC-${((a=r.id)==null?void 0:a.slice(0,8))||"NEW"}`})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"0.2 Zadeva"}),e.jsx("p",{className:"text-body-lg text-text-primary bg-bg-near-black px-4 py-2 rounded border border-border-subtle",children:r.zadeva||r.opis_incidenta||r.incident_description||"Brez zadeve"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"1.5 Tip poroila"}),e.jsx("p",{className:"text-body-lg text-text-primary bg-bg-near-black px-4 py-2 rounded border border-border-subtle",children:(()=>{const n=r.tip_porocila||r.report_type;return{prvo_porocilo:"Prvo poroilo zavezanca",vmesno_porocilo:"Vmesno/konno poroilo",obvescanje_pno:"Prvo obveanje PNO",prostovoljna_priglasitev:"Prostovoljna priglasitev incidenta",koncno_porocilo:"Konno poroilo"}[n]||n||"-"})()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Status"}),e.jsx("div",{className:"flex items-center",children:e.jsx(vr,{type:"status",value:r.trenutno_stanje||r.incident_status||"v teku"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"2.1 Zaetek incidenta"}),e.jsx("p",{className:"text-body-lg text-text-primary bg-bg-near-black px-4 py-2 rounded border border-border-subtle",children:(()=>{const n=r.zacetek_incidenta||r.detection_datetime;return n?new Date(n).toLocaleString("sl-SI"):"-"})()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"3.2 Zadnje poroanje"}),e.jsx("p",{className:"text-body-lg text-text-primary bg-bg-near-black px-4 py-2 rounded border border-border-subtle",children:r.cas_zadnjega_porocanja?new Date(r.cas_zadnjega_porocanja).toLocaleString("sl-SI"):"Ni podatka"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Ustvarjeno"}),e.jsx("p",{className:"text-body-lg text-text-primary bg-bg-near-black px-4 py-2 rounded border border-border-subtle",children:new Date(r.created_at).toLocaleString("sl-SI")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Posodobljeno"}),e.jsx("p",{className:"text-body-lg text-text-primary bg-bg-near-black px-4 py-2 rounded border border-border-subtle",children:new Date(r.updated_at).toLocaleString("sl-SI")})]})]}),e.jsx("div",{className:"flex justify-end gap-3 pt-4 border-t border-border-subtle",children:e.jsx("button",{onClick:t,className:"px-6 py-2 bg-bg-near-black text-text-primary border border-border-subtle rounded hover:bg-bg-surface transition-colors duration-150",children:"Zapri"})})]})}):null}function tC({isOpen:s,onClose:t,device:r}){return r?e.jsx(Yp,{isOpen:s,onClose:t,title:`Naprava: ${r.manufacturer} ${r.model}`,children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Proizvajalec"}),e.jsx("p",{className:"text-body-lg text-text-primary bg-bg-near-black px-4 py-2 rounded border border-border-subtle",children:r.manufacturer})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Model"}),e.jsx("p",{className:"text-body-lg text-text-primary bg-bg-near-black px-4 py-2 rounded border border-border-subtle",children:r.model})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Tip naprave"}),e.jsx("p",{className:"text-body-lg text-text-primary bg-bg-near-black px-4 py-2 rounded border border-border-subtle",children:r.device_type})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Lokacija"}),e.jsx("p",{className:"text-body-lg text-text-primary bg-bg-near-black px-4 py-2 rounded border border-border-subtle",children:r.location})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Uporabnik naprave"}),e.jsx("p",{className:"text-body-lg text-text-primary bg-bg-near-black px-4 py-2 rounded border border-border-subtle",children:r.device_user||"Ni doloen"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Nivo tveganja"}),e.jsx("div",{className:"flex items-center",children:e.jsx(vr,{type:"risk",value:r.risk_level})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Zadnji pregled"}),e.jsx("p",{className:"text-body-lg text-text-primary bg-bg-near-black px-4 py-2 rounded border border-border-subtle",children:r.last_check?new Date(r.last_check).toLocaleString("sl-SI"):"Ni podatka"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Status"}),e.jsx("div",{className:"flex items-center",children:e.jsx(vr,{type:"status",value:r.status})})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Ustvarjeno"}),e.jsx("p",{className:"text-body-lg text-text-primary bg-bg-near-black px-4 py-2 rounded border border-border-subtle",children:new Date(r.created_at).toLocaleString("sl-SI")})]})]}),e.jsx("div",{className:"flex justify-end gap-3 pt-4 border-t border-border-subtle",children:e.jsx("button",{onClick:t,className:"px-6 py-2 bg-bg-near-black text-text-primary border border-border-subtle rounded hover:bg-bg-surface transition-colors duration-150",children:"Zapri"})})]})}):null}function rC({isOpen:s,onClose:t,supportRequest:r}){return r?e.jsx(Yp,{isOpen:s,onClose:t,title:`Zahtevek: ${r.ticket_id}`,children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Zahtevek za podporo"}),e.jsx("p",{className:"text-body-lg text-text-primary font-mono bg-bg-near-black px-4 py-2 rounded border border-border-subtle",children:r.ticket_id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Ime in Priimek"}),e.jsx("p",{className:"text-body-lg text-text-primary bg-bg-near-black px-4 py-2 rounded border border-border-subtle",children:r.full_name})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Zadeva"}),e.jsx("p",{className:"text-body-lg text-text-primary bg-bg-near-black px-4 py-2 rounded border border-border-subtle",children:r.subject})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Prioriteta"}),e.jsx("div",{className:"flex items-center",children:e.jsx(vr,{type:"priority",value:r.priority})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Status zahtevka"}),e.jsx("div",{className:"flex items-center",children:e.jsx(vr,{type:"status",value:r.status})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Ustvarjeno"}),e.jsx("p",{className:"text-body-lg text-text-primary bg-bg-near-black px-4 py-2 rounded border border-border-subtle",children:new Date(r.created_at).toLocaleString("sl-SI")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Posodobljeno"}),e.jsx("p",{className:"text-body-lg text-text-primary bg-bg-near-black px-4 py-2 rounded border border-border-subtle",children:new Date(r.updated_at).toLocaleString("sl-SI")})]}),r.user_id&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"ID uporabnika"}),e.jsx("p",{className:"text-body-lg text-text-primary font-mono bg-bg-near-black px-4 py-2 rounded border border-border-subtle",children:r.user_id})]})]}),e.jsx("div",{className:"flex justify-end gap-3 pt-4 border-t border-border-subtle",children:e.jsx("button",{onClick:t,className:"px-6 py-2 bg-bg-near-black text-text-primary border border-border-subtle rounded hover:bg-bg-surface transition-colors duration-150",children:"Zapri"})})]})}):null}function sC(){const{t:s}=et(),{user:t}=cr(),[r,a]=z.useState([]),[n,i]=z.useState([]),[o,c]=z.useState([]),[d,p]=z.useState(!0),[m,x]=z.useState(null),b=[{id:"1",incident_id:"INC-2024-001",type:"Ransomware napad",detected_at:"2024-11-01T10:30:00Z",description:"Ransomware je prizadel datoteni strenik",estimated_damage:"Visoko",status:"investigating",organization_id:"demo-org",created_at:"2024-11-01T10:30:00Z",updated_at:"2024-11-01T10:30:00Z"},{id:"2",incident_id:"INC-2024-002",type:"Phishing e-pota",detected_at:"2024-11-02T14:20:00Z",description:"Zaposleni je prejel sumljivo e-potno sporoilo",estimated_damage:"Srednje",status:"active",organization_id:"demo-org",created_at:"2024-11-02T14:20:00Z",updated_at:"2024-11-02T14:20:00Z"}],h=[{id:"1",stevilo_prijave:"ZZPri-2024-001",kratek_opis:"Sum korupcije v javnem naroanju",podrocje:"korupcija",status:"prejeta",datum_potrditev:"2024-11-20T10:00:00Z",datum_resitve:"2024-12-01T10:00:00Z",created_at:"2024-11-01T10:30:00Z",updated_at:"2024-11-01T10:30:00Z"},{id:"2",stevilo_prijave:"ZZPri-2024-002",kratek_opis:"Nepravilnosti pri javni upravi",podrocje:"nepravilnosti",status:"prejeta",datum_potrditev:"2024-11-25T10:00:00Z",datum_resitve:"2024-12-05T10:00:00Z",created_at:"2024-11-02T14:20:00Z",updated_at:"2024-11-02T14:20:00Z"}],j=[{id:"1",request_id:"GDPR-2024-001",subject_name:"Janez Novak",subject_email:"janez.novak@example.com",request_date:"2024-10-20T10:00:00Z",request_type:"Right to be forgotten",status:"received",response_deadline:"2024-10-25T23:59:59Z",legal_basis_description:"GDPR Article 17 - Right to erasure",data_categories:["contact_information","purchase_history"],data_description:"Kontaktni podatki in zgodovina nakupov",created_at:"2024-10-20T10:00:00Z",updated_at:"2024-10-20T10:00:00Z"},{id:"2",request_id:"GDPR-2024-002",subject_name:"Ana Kova",subject_email:"ana.kovac@example.com",request_date:"2024-10-15T10:00:00Z",request_type:"Right to be forgotten",status:"processing",response_deadline:"2024-10-20T23:59:59Z",legal_basis_description:"GDPR Article 17 - Right to erasure",data_categories:["personal_profile"],data_description:"Osebni profil in nastavitve",created_at:"2024-10-15T10:00:00Z",updated_at:"2024-10-15T10:00:00Z"},{id:"3",request_id:"GDPR-2024-003",subject_name:"Marko Pretnar",subject_email:"marko.pretnar@example.com",request_date:"2024-10-10T10:00:00Z",request_type:"Right to be forgotten",status:"received",response_deadline:"2024-10-15T23:59:59Z",legal_basis_description:"GDPR Article 17 - Right to erasure",data_categories:["contact_information"],data_description:"Kontaktni podatki",created_at:"2024-10-10T10:00:00Z",updated_at:"2024-10-10T10:00:00Z"}];z.useEffect(()=>{(async()=>{if(!t){p(!1);return}try{const{data:S,error:C}=await Ne.from("profiles").select("*, organization_id").eq("id",t.id).single();if(C)throw C;x(S)}catch(S){console.error("Error fetching user profile:",S),x({organization_id:null})}})()},[t]);async function g(){if(!(m!=null&&m.organization_id)){a(b),i(h),c(j),p(!1);return}p(!0);try{const[A,S,C]=await Promise.all([Ne.from("incidents").select("*").eq("organization_id",m.organization_id).order("detected_at",{ascending:!1}),Ne.from("prijave").select("*").eq("organization_id",m.organization_id).order("created_at",{ascending:!1}),Ne.from("gdpr_right_forgotten").select("*").eq("organization_id",m.organization_id).order("request_date",{ascending:!1})]);a(A.data||[]),i(S.data||[]),c(C.data||[])}catch(A){console.error("Error loading alerts data:",A),a(b),i(h),c(j)}finally{p(!1)}}z.useEffect(()=>{if(!(m!=null&&m.organization_id)){p(!1);return}g();const A=Ne.channel(`incidents:organization_id=eq.${m.organization_id}`).on("postgres_changes",{event:"*",schema:"public",table:"incidents",filter:`organization_id=eq.${m.organization_id}`},()=>{console.log("Incidents changed - refreshing alerts"),g()}).subscribe(),S=Ne.channel(`prijave:organization_id=eq.${m.organization_id}`).on("postgres_changes",{event:"*",schema:"public",table:"prijave",filter:`organization_id=eq.${m.organization_id}`},()=>{console.log("Prijave changed - refreshing alerts"),g()}).subscribe(),C=Ne.channel(`gdpr_right_forgotten:organization_id=eq.${m.organization_id}`).on("postgres_changes",{event:"*",schema:"public",table:"gdpr_right_forgotten",filter:`organization_id=eq.${m.organization_id}`},()=>{console.log("GDPR zahtevki changed - refreshing alerts"),g()}).subscribe();return()=>{Ne.removeChannel(A),Ne.removeChannel(S),Ne.removeChannel(C)}},[m]);function v(A){const S=new Date(A),C=new Date,O=S.getTime()-C.getTime();return Math.ceil(O/(1e3*60*60*24))}function _(A){const S=new Date(A),O=new Date().getTime()-S.getTime();return Math.floor(O/(1e3*60*60*24))}const k=r.filter(A=>{const C=_(A.detected_at)>1,O=A.status!=="resolved";return C&&O}),P=n.filter(A=>{let S=!1;if(A.datum_potrditev){const O=v(A.datum_potrditev);O>=0&&O<3&&(S=!0)}if(A.datum_resitve){const O=v(A.datum_resitve);O>=0&&O<3&&(S=!0)}const C=A.status!=="reena";return S&&C}),L=o.filter(A=>A.status==="completed"||A.status==="executed"?!1:A.response_deadline?v(A.response_deadline)<0:!1),F=k.length+P.length+L.length,W=F>0;return{incidents:r,prijave:n,gdprZahtevki:o,loading:d,stariIncidenti:k,kratkiRokiPrijave:P,potekliGdprZahtevki:L,hasActiveAlerts:W,totalActiveAlerts:F,noAlertsMessage:"Trenutno ni aktivnih opozoril",activeAlertsMessage:"POZOR! Obstajajo opozorila - oglejte si jih!",refreshData:g}}function Rf({setCurrentPage:s}){const{t}=et(),{user:r}=cr(),[a,n]=z.useState([]),[i,o]=z.useState([]),[c,d]=z.useState([]),[p,m]=z.useState([]),[x,b]=z.useState([]),[h,j]=z.useState(!0),[g,v]=z.useState(null),{hasActiveAlerts:_,noAlertsMessage:k,activeAlertsMessage:P,loading:L,refreshData:F}=sC();z.useEffect(()=>{const ne=setInterval(()=>{F&&F()},3e4);return()=>clearInterval(ne)},[F]);const W=[{id:1,ticket_id:"ZD-2024-001",requester_name:"Marija Kova",subject:"Teava z dostopom do sistema",priority:"high",status:"in_progress",created_date:"2024-11-08T10:30:00Z"},{id:2,ticket_id:"ZD-2024-002",requester_name:"Peter Horvat",subject:"Pozabljeno geslo",priority:"medium",status:"resolved",created_date:"2024-11-07T14:15:00Z"},{id:3,ticket_id:"ZD-2024-003",requester_name:"Toma Bergant",subject:"Varnostni incident - sum vdora",priority:"urgent",status:"open",created_date:"2024-11-06T09:20:00Z"},{id:4,ticket_id:"ZD-2024-004",requester_name:"Maja Virti",subject:"Zahteva za usposabljanje",priority:"low",status:"waiting_for_customer",created_date:"2024-11-05T16:45:00Z"},{id:5,ticket_id:"ZD-2024-005",requester_name:"Robert Kosec",subject:"Teava s tiskalnikom",priority:"medium",status:"closed",created_date:"2024-11-04T11:30:00Z"}],[R,B]=z.useState(!1),[A,S]=z.useState(null),[C,O]=z.useState(!1),[Z,te]=z.useState(null),[ce,re]=z.useState(!1),[X,U]=z.useState(null),[oe,xe]=z.useState(!1),[J,$]=z.useState(null);z.useEffect(()=>{(async()=>{if(r)try{const{data:Re,error:Oe}=await Ne.from("profiles").select("*, organization_id").eq("id",r.id).single();if(Oe)throw Oe;v(Re)}catch(Re){console.error("Error fetching user profile:",Re)}})()},[r]),z.useEffect(()=>{g!=null&&g.organization_id?Q():j(!1)},[g]);async function Q(){if(!(g!=null&&g.organization_id)){j(!1);return}j(!0);try{const[{data:ne},{data:Re},{data:Oe},{data:Je},{data:Be}]=await Promise.all([Ne.from("incidents").select("*").eq("organization_id",g.organization_id).order("created_at",{ascending:!1}).limit(3),Ne.from("cyber_incident_reports").select("*").eq("organization_id",g.organization_id).order("created_at",{ascending:!1}).limit(3),Ne.from("devices").select("*").eq("risk_level","High").eq("organization_id",g.organization_id).order("created_at",{ascending:!1}).limit(3),Ne.from("support_ticket_management").select("*").order("created_date",{ascending:!1}).limit(3),Ne.from("risk_data").select("*").eq("organization_id",g.organization_id)]);n(ne||[]),o(Re||[]),d(Oe||[]);const kt=Je&&Je.length>0?Je:[...W].sort((it,Ft)=>new Date(Ft.created_date).getTime()-new Date(it.created_date).getTime()).slice(0,3);m(kt),b(Be||[])}catch(ne){console.error("Error loading data:",ne)}finally{j(!1)}}const q=ne=>{console.log("Dashboard: handleViewIncident called with incident:",ne),S(ne),B(!0),console.log("Dashboard: Incident modal should now be open")},I=ne=>{console.log("Dashboard: handleViewReport called with report:",ne),te(ne),O(!0),console.log("Dashboard: Report modal should now be open")},Y=ne=>{console.log("Dashboard: handleViewDevice called with device:",ne),U(ne),re(!0),console.log("Dashboard: Device modal should now be open")},H=ne=>({id:ne.id,ticket_id:ne.ticket_id,user_id:null,full_name:ne.requester_name||"Neznano",subject:ne.subject,priority:ne.priority==="low"?"Nizka":ne.priority==="medium"?"Normalna":ne.priority==="high"?"Visoka":"Normalna",status:ne.status==="open"?"Odprt":ne.status==="in_progress"?"V obdelavi":ne.status==="resolved"?"Zaprt":"Odprt",created_at:ne.created_date,updated_at:ne.resolved_date||ne.created_date}),he=ne=>{console.log("Dashboard: handleViewSupport called with support:",ne);const Re=H(ne);$(Re),xe(!0),console.log("Dashboard: Support modal should now be open")},ge=()=>{console.log("Dashboard: handleViewAllIncidents called - navigating to nis2 page"),s("nis2")},K=()=>{console.log("Dashboard: handleViewAllReports called - navigating to nis2 page"),s("nis2")},T=()=>{console.log("Dashboard: handleViewAllDevices called - navigating to workspaces page"),s("workspaces")},ee=()=>{console.log("Dashboard: handleViewAllSupport called - navigating to support-tickets page"),s("support-tickets")},_e={labels:[t("common.highRiskDevices"),t("common.mediumRiskDevices"),t("common.lowRiskDevices")],values:x.filter(ne=>ne.category==="inventory").sort((ne,Re)=>{const Oe={High:0,Medium:1,Low:2};return Oe[ne.risk_level]-Oe[Re.risk_level]}).map(ne=>ne.count),colors:["#ef4444","#f59e0b","#22c55e"]},ke={labels:[t("common.highRiskSuppliers"),t("common.mediumRiskSuppliers"),t("common.lowRiskSuppliers")],values:x.filter(ne=>ne.category==="suppliers").sort((ne,Re)=>{const Oe={High:0,Medium:1,Low:2};return Oe[ne.risk_level]-Oe[Re.risk_level]}).map(ne=>ne.count),colors:["#ef4444","#f59e0b","#22c55e"]},ue={labels:[t("common.highRisk"),t("common.mediumRisk"),t("common.lowRisk")],values:x.filter(ne=>ne.category==="potentials").sort((ne,Re)=>{const Oe={High:0,Medium:1,Low:2};return Oe[ne.risk_level]-Oe[Re.risk_level]}).map(ne=>ne.count),colors:["#ef4444","#f59e0b","#22c55e"]};if(h)return e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})});const je=new URLSearchParams(window.location.search).get("demo")==="true";return!(g!=null&&g.organization_id)&&!je?e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-300 mb-2",children:t("common.organizationRequired")}),e.jsx("p",{className:"text-gray-400",children:t("common.organizationRequiredDescription")})]})}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-gradient-to-br from-[#1a1a1a] to-[#0f0f0f] p-8 rounded-lg border border-border-subtle",children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-3",children:t("dashboard.welcomeTitle")}),e.jsx("p",{className:"text-body-lg text-text-secondary",children:t("dashboard.welcome")})]}),!L&&e.jsx("div",{className:`p-4 rounded-lg border-2 ${_?"bg-red-500/5 border-red-500/30":"bg-green-500/5 border-green-500/30"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${_?"bg-red-500/20 border border-red-500/40":"bg-green-500/20 border border-green-500/40"}`,children:_?e.jsx(pt,{className:"w-5 h-5 text-red-400"}):e.jsx(Mt,{className:"w-5 h-5 text-green-400"})}),e.jsx("div",{className:"flex-1",children:_?e.jsx("button",{onClick:()=>s("alerts"),className:"text-body font-medium text-red-400 hover:text-red-300 transition-colors text-left",children:P}):e.jsx("p",{className:"text-body font-medium text-green-400",children:k})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx(Tf,{title:t("dashboard.potentialsRisk"),data:ue}),e.jsx(Tf,{title:t("dashboard.inventoryRisk"),data:_e}),e.jsx(Tf,{title:t("dashboard.suppliersRisk"),data:ke})]}),e.jsx(dl,{title:t("dashboard.incidentManagementTable"),columns:[{key:"incident_id",header:t("dashboard.incidentId")},{key:"type",header:t("dashboard.incidentType")},{key:"estimated_damage",header:t("dashboard.estimatedDamage"),render:ne=>e.jsx(vr,{type:"risk",value:ne.estimated_damage})},{key:"detected_at",header:t("dashboard.detectionDate"),render:ne=>new Date(ne.detected_at).toLocaleDateString("sl-SI")},{key:"resolved_at",header:t("dashboard.resolutionDate"),render:ne=>ne.resolved_at?new Date(ne.resolved_at).toLocaleDateString("sl-SI"):"-"},{key:"nis2_required",header:t("dashboard.nis2Required"),render:ne=>ne.nis2_required?t("dashboard.yes"):t("dashboard.no")},{key:"status",header:t("common.status"),render:ne=>e.jsx(vr,{type:"status",value:ne.status})}],data:a,onViewAll:ge,onViewItem:q}),e.jsx(dl,{title:t("dashboard.cyberIncidentReportsTable"),columns:[{key:"referencna_stevilka",header:"Referenna t.",render:ne=>{var Re;return ne.referencna_stevilka||ne.incident_number||`INC-${((Re=ne.id)==null?void 0:Re.slice(0,8))||"NEW"}`}},{key:"zadeva",header:"Zadeva",render:ne=>ne.zadeva||ne.opis_incidenta||ne.incident_description||"Brez zadeve"},{key:"tip_porocila",header:"Poroilo",render:ne=>{const Re=ne.tip_porocila||ne.report_type;return{prvo_porocilo:"Prvo poroilo",vmesno_porocilo:"Vmesno poroilo",koncno_porocilo:"Konno poroilo",prostovoljna_priglasitev:"Prostovoljna priglasitev"}[Re]||Re||"-"}},{key:"zacetek_incidenta",header:"Zaetek incidenta",render:ne=>{const Re=ne.zacetek_incidenta||ne.detection_datetime;return Re?new Date(Re).toLocaleString("sl-SI"):"-"}},{key:"cas_zadnjega_porocanja",header:"Zadnje poroanje",render:ne=>{const Re=ne.cas_zadnjega_porocanja;return Re?new Date(Re).toLocaleString("sl-SI"):"-"}},{key:"trenutno_stanje",header:t("common.status"),render:ne=>e.jsx(vr,{type:"status",value:ne.trenutno_stanje||ne.incident_status||"v teku"})}],data:i,onViewAll:K,onViewItem:I}),e.jsx(dl,{title:t("dashboard.workspacesTable"),columns:[{key:"manufacturer",header:t("dashboard.manufacturerAndModel"),render:ne=>`${ne.manufacturer} ${ne.model}`},{key:"device_type",header:t("dashboard.type")},{key:"location",header:t("dashboard.whereIsLocated")},{key:"risk_level",header:t("dashboard.riskLevel"),render:ne=>e.jsx(vr,{type:"risk",value:ne.risk_level})},{key:"last_check",header:t("dashboard.lastDeviceCheck"),render:ne=>ne.last_check?new Date(ne.last_check).toLocaleString("sl-SI"):"-"}],data:c,onViewAll:T,onViewItem:Y}),e.jsx(dl,{title:t("dashboard.supportRequestsTable"),columns:[{key:"ticket_id",header:t("common.id")},{key:"created_date",header:t("dashboard.dateAndTime"),render:ne=>new Date(ne.created_date).toLocaleString("sl-SI")},{key:"requester_name",header:t("dashboard.fullNameColumn")},{key:"subject",header:t("dashboard.subject")},{key:"priority",header:t("dashboard.priority"),render:ne=>{const Oe={low:"Nizka",medium:"Srednja",high:"Visoka",urgent:"Nujna",critical:"Kritina"}[ne.priority]||ne.priority;return e.jsx(vr,{type:"priority",value:Oe})}},{key:"status",header:t("dashboard.requestStatus"),render:ne=>{const Oe={open:"Odprto",in_progress:"V teku",waiting_for_customer:"akanje na stranko",resolved:"Reeno",closed:"Zaprto"}[ne.status]||ne.status;return e.jsx(vr,{type:"status",value:Oe})}}],data:p,onViewAll:ee,onViewItem:he}),e.jsx(Ag,{isOpen:R,onClose:()=>{console.log("Dashboard: Incident modal closing"),B(!1),S(null)},incident:A}),e.jsx(eC,{isOpen:C,onClose:()=>{console.log("Dashboard: Report modal closing"),O(!1),te(null)},report:Z}),e.jsx(tC,{isOpen:ce,onClose:()=>{console.log("Dashboard: Device modal closing"),re(!1),U(null)},device:X}),e.jsx(rC,{isOpen:oe,onClose:()=>{console.log("Dashboard: Support modal closing"),xe(!1),$(null)},supportRequest:J})]})}function ha({isOpen:s,onClose:t,onSave:r,title:a,table:n,fields:i,defaultValues:o={}}){const{user:c}=cr(),[d,p]=z.useState(!1),[m,x]=z.useState(o),[b,h]=z.useState({}),[j,g]=z.useState(null);z.useEffect(()=>{(async()=>{if(!(!c||!s))try{const{data:B,error:A}=await Ne.from("profiles").select("*, organization_id").eq("id",c.id).single();if(A)throw A;g(B)}catch(B){console.error("Error fetching user profile:",B)}})()},[c,s]);const v=()=>{const R={};return i.forEach(B=>{B.required&&((m[B.key]||o[B.key]||"").trim()||(R[B.key]=`${B.label} je obvezno polje`)),B.key==="organization_id"&&((m[B.key]||o[B.key]||(j==null?void 0:j.organization_id)||"").trim()||(R[B.key]="ID organizacije je obvezno polje"))}),h(R),Object.keys(R).length===0},_=async R=>{if(R.preventDefault(),!!v()){p(!0);try{if(!(j!=null&&j.organization_id))throw new Error("Organizacijski kontekst ni na voljo");const B={...o,...m,organization_id:j.organization_id},{error:A}=await Ne.from(n).insert([B]);if(A)throw A.code==="23502"?new Error("Manjkajo obvezna polja"):A.code==="23505"?new Error("Zapis s tem ID-jem e obstaja"):A;r(),t(),x(o),h({})}catch(B){console.error("Napaka pri shranjevanju:",B);const A=B.message||"Napaka pri shranjevanju podatkov";A.includes("Organizacijski kontekst")?alert("Napaka: "+A):alert(A)}finally{p(!1)}}},k=(R,B)=>{x(A=>({...A,[R]:B})),b[R]&&h(A=>({...A,[R]:""}))},P=()=>{x(o),h({})},L=(R,B)=>B==="priority"?{low:"Nizka",medium:"Srednja",high:"Visoka",urgent:"Nujna"}[R]||R:B==="status"?{open:"Odprto",in_progress:"V teku",waiting_for_customer:"akanje na stranko",resolved:"Reeno",closed:"Zaprto",active:"Aktivna",inactive:"Neaktivna",maintenance:"Vzdrevanje"}[R]||R:B==="device_type"?{server:"Strenik",workstation:"Delovna postaja",laptop:"Prenosnik",mobile_device:"Mobilna naprava",network_device:"Omrena naprava",printer:"Tiskalnik",storage_device:"Naprava za shranjevanje",security_device:"Varnostna naprava",iot_device:"IoT naprava",other:"Drugo"}[R]||R:B==="asset_type"?{hardware:"Strojna oprema",software:"Programska oprema",data:"Podatki",service:"Storitev",facility:"Prostor",human_resource:"loveki viri",intellectual_property:"Intelektualna lastnina",reputation:"Sloves",business_process:"Poslovni proces"}[R]||R:B==="classification"?{public:"Javno",internal:"Interno",confidential:"Zaupno",restricted:"Omejeno"}[R]||R:B==="value_rating"?{very_low:"Zelo nizka",low:"Nizka",medium:"Srednja",high:"Visoka",very_high:"Zelo visoka"}[R]||R:B==="risk_level"?{low:"Nizko",Low:"Nizko",medium:"Srednje",Medium:"Srednje",high:"Visoko",High:"Visoko",very_low:"Zelo nizko",very_high:"Zelo visoko",critical:"Kritino"}[R]||R:B==="category"&&{technical_issue:"Tehnina teava",access_request:"Zahteva za dostop",password_reset:"Ponastavitev gesla",software_install:"Namestitev programske opreme",hardware_issue:"Teava s strojno opremo",network_problem:"Teava z omrejem",security_incident:"Varnostni incident",compliance_question:"Vpraanje o skladnosti",training_request:"Zahteva za usposabljanje",other:"Drugo"}[R]||R,F=R=>R.key.includes("name")||R.key.includes("ime")?e.jsx(en,{className:"w-4 h-4"}):R.key.includes("email")||R.key.includes("e-naslov")?e.jsx(bu,{className:"w-4 h-4"}):R.key.includes("telefon")||R.key.includes("phone")?e.jsx(hg,{className:"w-4 h-4"}):R.key.includes("subject")||R.key.includes("zadeva")||R.key==="description"||R.key==="resolution_notes"?e.jsx(ut,{className:"w-4 h-4"}):R.key.includes("date")||R.key.includes("termin")?e.jsx(_a,{className:"w-4 h-4"}):R.key==="priority"?e.jsx(dS,{className:"w-4 h-4"}):R.key==="category"?e.jsx(vS,{className:"w-4 h-4"}):R.key==="status"?e.jsx(Rt,{className:"w-4 h-4"}):R.key==="assigned_to"?e.jsx(fi,{className:"w-4 h-4"}):R.key==="satisfaction_rating"?e.jsx(gS,{className:"w-4 h-4"}):e.jsx(ut,{className:"w-4 h-4"}),W=R=>{var A;const B={id:R.key,value:m[R.key]||"",onChange:S=>k(R.key,S.target.value),required:R.required,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary"};switch(R.type){case"textarea":return e.jsx("textarea",{...B,rows:4,className:`${B.className} resize-none`});case"select":return e.jsxs("select",{...B,children:[e.jsx("option",{value:"",children:"Izberite..."}),(A=R.options)==null?void 0:A.map(S=>e.jsx("option",{value:S,children:L(S,R.key)},S))]});case"datetime":return e.jsx("input",{...B,type:"datetime-local",className:B.className});case"date":return e.jsx("input",{...B,type:"date",className:B.className});case"number":return e.jsx("input",{...B,type:"number",className:B.className});default:return e.jsx("input",{...B,type:"text",className:B.className})}};return e.jsx(zs,{isOpen:s,onClose:t,title:a,children:e.jsxs("form",{onSubmit:_,className:"space-y-6",children:[n==="inventory_software"?e.jsx("div",{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:i.map(R=>e.jsxs("div",{className:R.type==="textarea"?"md:col-span-2":"",children:[e.jsxs("label",{htmlFor:R.key,className:"block text-body-sm font-medium text-text-primary mb-2",children:[F(R),e.jsxs("span",{className:"ml-2",children:[R.label," ",R.required&&e.jsx("span",{className:"text-status-error",children:"*"})]})]}),W(R),b[R.key]&&e.jsx("p",{className:"text-status-error text-xs mt-1",children:b[R.key]})]},R.key))})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center gap-2",children:[e.jsx(en,{className:"w-5 h-5"}),"Osnovne informacije"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:i.filter(R=>R.key.includes("ticket_id")||R.key.includes("subject")||R.key.includes("description")||R.key.includes("requester")).map(R=>e.jsxs("div",{className:R.type==="textarea"?"md:col-span-2":"",children:[e.jsxs("label",{htmlFor:R.key,className:"block text-body-sm font-medium text-text-primary mb-2",children:[F(R),e.jsxs("span",{className:"ml-2",children:[R.label," ",R.required&&e.jsx("span",{className:"text-status-error",children:"*"})]})]}),W(R),b[R.key]&&e.jsx("p",{className:"text-status-error text-xs mt-1",children:b[R.key]})]},R.key))})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center gap-2",children:[e.jsx(fi,{className:"w-5 h-5"}),"Podrobnosti zahtevka"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:i.filter(R=>R.key==="priority"||R.key==="status"||R.key==="category"||R.key==="assigned_to").map(R=>e.jsxs("div",{className:R.type==="textarea"?"md:col-span-2":"",children:[e.jsxs("label",{htmlFor:R.key,className:"block text-body-sm font-medium text-text-primary mb-2",children:[F(R),e.jsxs("span",{className:"ml-2",children:[R.label," ",R.required&&e.jsx("span",{className:"text-status-error",children:"*"})]})]}),W(R),b[R.key]&&e.jsx("p",{className:"text-status-error text-xs mt-1",children:b[R.key]})]},R.key))})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center gap-2",children:[e.jsx(Rt,{className:"w-5 h-5"}),"Zakljuek in ocena"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:i.filter(R=>R.key.includes("date")||R.key==="resolved_date"||R.key==="resolution_notes"||R.key==="satisfaction_rating").map(R=>e.jsxs("div",{className:R.type==="textarea"?"md:col-span-2":"",children:[e.jsxs("label",{htmlFor:R.key,className:"block text-body-sm font-medium text-text-primary mb-2",children:[F(R),e.jsxs("span",{className:"ml-2",children:[R.label," ",R.required&&e.jsx("span",{className:"text-status-error",children:"*"})]})]}),W(R),b[R.key]&&e.jsx("p",{className:"text-status-error text-xs mt-1",children:b[R.key]})]},R.key))})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t border-border-subtle",children:[e.jsx("button",{type:"button",onClick:()=>{t(),P()},className:"px-6 py-2 bg-bg-near-black text-text-primary border border-border-subtle rounded hover:bg-bg-surface transition-colors duration-150",children:"Preklii"}),e.jsx("button",{type:"submit",disabled:d,className:"px-6 py-2 bg-accent-primary hover:bg-accent-primary/90 text-white rounded transition-colors duration-200 disabled:opacity-50 flex items-center gap-2",children:d?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/20 border-t-white rounded-full animate-spin"}),"Shranjujem..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Rt,{className:"w-4 h-4"}),"Shrani"]})})]})]})})}const aC=({isOpen:s,onClose:t,onSave:r})=>{const{t:a}=et(),n=[{key:"manufacturer",label:a("modals.add.common.manufacturer"),type:"text",required:!0},{key:"model",label:a("modals.add.common.model"),type:"text",required:!0},{key:"device_type",label:a("modals.add.common.deviceType"),type:"select",required:!0,options:["server","workstation","laptop","mobile_device","network_device","printer","storage_device","security_device","iot_device","other"]},{key:"location",label:a("modals.add.common.location"),type:"text",required:!0},{key:"device_user",label:a("modals.add.common.deviceUser"),type:"text"},{key:"risk_level",label:a("modals.add.common.riskLevel"),type:"select",required:!0,options:["Low","Medium","High"]},{key:"last_check",label:a("modals.add.common.lastCheck"),type:"datetime"},{key:"status",label:a("modals.add.common.status"),type:"select",options:["active","inactive","maintenance"]}];return e.jsx(ha,{isOpen:s,onClose:t,onSave:r,title:a("modals.add.device.title"),table:"devices",fields:n})};function gi({isOpen:s,onClose:t,onConfirm:r,title:a,message:n,isDeleting:i=!1}){const{t:o}=et();return s?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:t}),e.jsxs("div",{className:"relative bg-bg-surface border border-border-subtle rounded-lg shadow-xl max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-border-subtle",children:[e.jsx("h2",{className:"text-h3 text-text-primary",children:a}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",children:e.jsx(Ar,{className:"w-5 h-5 text-text-secondary"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-body text-text-secondary mb-6",children:n}),e.jsxs("div",{className:"flex items-center gap-3 justify-end",children:[e.jsx("button",{onClick:t,disabled:i,className:"h-10 px-4 bg-bg-near-black hover:bg-bg-surface text-text-primary rounded-sm transition-colors duration-150",children:o("modals.deleteConfirm.cancel")}),e.jsx("button",{onClick:r,disabled:i,className:"h-10 px-4 bg-status-error hover:bg-status-error/80 text-white rounded-sm transition-colors duration-150 disabled:opacity-50",children:o(i?"forms.deleting":"modals.deleteConfirm.delete")})]})]})]})]}):null}function mx({isOpen:s,onClose:t,onSuccess:r,tableName:a,title:n,columns:i,sampleData:o}){const{t:c}=et(),[d,p]=z.useState(null),[m,x]=z.useState(!1),[b,h]=z.useState(null),[j,g]=z.useState(!1),[v,_]=z.useState({total:0,successful:0,failed:0});if(!s)return null;const k=B=>{var S;const A=(S=B.target.files)==null?void 0:S[0];if(A){if(!A.name.endsWith(".csv")){h("Prosimo, naloite CSV datoteko");return}p(A),h(null),g(!1)}},P=B=>{const A=B.trim().split(`
`);if(A.length<2)throw new Error("CSV datoteka mora vsebovati glavo in vsaj eno vrstico podatkov");const S=A[0].split(";").map(Z=>Z.trim().replace(/^"|"$/g,"")),C=i.filter(Z=>!S.includes(Z));if(C.length>0)throw new Error(`Manjkajoi stolpci: ${C.join(", ")}`);const O=[];for(let Z=1;Z<A.length;Z++){if(!A[Z].trim())continue;const te=A[Z].split(";").map(re=>re.trim().replace(/^"|"$/g,"")),ce={};S.forEach((re,X)=>{const U=te[X]||"";ce[re]=U===""||U==="-"?null:U}),O.push(ce)}return O},L=async()=>{if(!d){h("Prosimo, izberite datoteko");return}x(!0),h(null),g(!1);try{const B=await d.text(),A=P(B);if(A.length===0)throw new Error("CSV datoteka ne vsebuje podatkov");let S=0,C=0;const O=100;for(let Z=0;Z<A.length;Z+=O){const te=A.slice(Z,Z+O);try{const{error:ce}=await Ne.from(a).insert(te);ce?(console.error("Batch insert error:",ce),C+=te.length):S+=te.length}catch(ce){console.error("Batch error:",ce),C+=te.length}}_({total:A.length,successful:S,failed:C}),C===0?(g(!0),setTimeout(()=>{r(),t(),F()},2e3)):S>0?h(`Uvoenih ${S} od ${A.length} zapisov. ${C} zapisov ni bilo mogoe uvoziti.`):h(c("modals.csvImport.importError",{error:"Format error"}))}catch(B){h(B.message||"Napaka pri uvozu podatkov")}finally{x(!1)}},F=()=>{p(null),h(null),g(!1),_({total:0,successful:0,failed:0})},W=()=>{m||(F(),t())},R=()=>{if(!o)return;const B=new Blob([o],{type:"text/csv;charset=utf-8;"}),A=document.createElement("a");A.href=URL.createObjectURL(B),A.download=`${a}_template.csv`,A.click(),URL.revokeObjectURL(A.href)};return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:W}),e.jsxs("div",{className:"relative bg-bg-surface border border-border-subtle rounded-lg shadow-xl max-w-2xl w-full mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-border-subtle",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(cS,{className:"w-6 h-6 text-accent-primary"}),e.jsx("h2",{className:"text-h3 text-text-primary",children:n})]}),e.jsx("button",{onClick:W,disabled:m,className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150 disabled:opacity-50",children:e.jsx(Ar,{className:"w-5 h-5 text-text-secondary"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"bg-bg-near-black p-4 rounded border border-border-subtle",children:[e.jsx("h3",{className:"text-sm font-medium text-text-primary mb-2",children:"Navodila"}),e.jsxs("ul",{className:"text-sm text-text-secondary space-y-1",children:[e.jsxs("li",{children:[" CSV datoteka mora vsebovati naslednje stolpce: ",e.jsx("span",{className:"font-mono text-text-primary",children:i.join(", ")})]}),e.jsx("li",{children:" Uporabite podpije (;) kot loilo med vrednostmi"}),e.jsx("li",{children:" Prva vrstica mora biti glava s imeni stolpcev"}),e.jsx("li",{children:' Prazen ali "-" vrednosti bodo shranjene kot NULL'})]}),o&&e.jsx("button",{onClick:R,className:"mt-3 text-sm text-accent-primary hover:text-accent-primary-hover font-medium",children:c("modals.csvImport.downloadTemplate")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:c("modals.csvImport.selectFile")}),e.jsx("div",{className:"relative",children:e.jsx("input",{type:"file",accept:".csv",onChange:k,disabled:m,className:`block w-full text-sm text-text-secondary
                  file:mr-4 file:py-2 file:px-4
                  file:rounded file:border-0
                  file:text-sm file:font-medium
                  file:bg-accent-primary file:text-white
                  file:cursor-pointer
                  hover:file:bg-accent-primary-hover
                  disabled:opacity-50 disabled:cursor-not-allowed`})}),d&&e.jsxs("p",{className:"mt-2 text-sm text-text-secondary",children:["Izbrana datoteka: ",e.jsx("span",{className:"font-medium text-text-primary",children:d.name})]})]}),b&&e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-status-error/10 border border-status-error rounded",children:[e.jsx(er,{className:"w-5 h-5 text-status-error flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm text-status-error",children:b})]}),j&&e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-status-success/10 border border-status-success rounded",children:[e.jsx(Rt,{className:"w-5 h-5 text-status-success flex-shrink-0 mt-0.5"}),e.jsxs("p",{className:"text-sm text-status-success",children:["Uspeno uvoenih ",v.successful," zapisov!"]})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 px-6 py-4 border-t border-border-subtle",children:[e.jsx("button",{onClick:W,disabled:m,className:"px-6 py-2 bg-bg-near-black text-text-primary border border-border-subtle rounded hover:bg-bg-surface transition-colors duration-150 disabled:opacity-50",children:c("modals.csvImport.cancel")}),e.jsx("button",{onClick:L,disabled:!d||m,className:"inline-flex items-center gap-2 px-6 py-2 bg-accent-primary hover:bg-accent-primary-hover text-white rounded transition-colors duration-150 disabled:opacity-50 disabled:cursor-not-allowed",children:m?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e.jsx("span",{children:"Uvaam..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Xa,{className:"w-4 h-4"}),e.jsx("span",{children:c("modals.csvImport.import")})]})})]})]})]})}function nC(){const{t:s}=et(),[t,r]=z.useState([]),[a,n]=z.useState(!0),[i,o]=z.useState("all"),[c,d]=z.useState(null),[p,m]=z.useState(!1),[x,b]=z.useState(!1),[h,j]=z.useState(!1),[g,v]=z.useState(!1),[_,k]=z.useState(!1),[P,L]=z.useState(!1),[F,W]=z.useState(null),[R,B]=z.useState({manufacturer:"",model:"",device_type:"",location:"",risk_level:"Low",status:"active",last_check:""}),[A,S]=z.useState(!1),[C,O]=z.useState(!1),[Z,te]=z.useState(!1);z.useEffect(()=>{ce();const q=Ne.channel("devices-changes").on("postgres_changes",{event:"*",schema:"public",table:"devices"},()=>{ce()}).subscribe();return()=>{Ne.removeChannel(q)}},[i]);async function ce(){n(!0);try{let q=Ne.from("devices").select("*").order("created_at",{ascending:!1});i!=="all"&&(q=q.eq("risk_level",i.charAt(0).toUpperCase()+i.slice(1)));const{data:I}=await q;r(I||[])}catch(q){console.error("Error loading devices:",q)}finally{n(!1)}}const re=q=>{d(q),m(!0)},X=()=>{m(!1),d(null)},U=q=>{W(q),B({manufacturer:q.manufacturer,model:q.model,device_type:q.device_type,location:q.location,risk_level:q.risk_level,status:q.status,last_check:q.last_check?new Date(q.last_check).toISOString().slice(0,16):""}),k(!0)},oe=async q=>{if(q.preventDefault(),!!F){S(!0);try{const I={manufacturer:R.manufacturer,model:R.model,device_type:R.device_type,location:R.location,risk_level:R.risk_level,status:R.status};R.last_check&&(I.last_check=R.last_check);const{error:Y}=await Ne.from("devices").update(I).eq("id",F.id);if(Y)throw Y;await ce(),k(!1),W(null)}catch(I){console.error("Error updating device:",I),alert(s("forms.updateError"))}finally{S(!1)}}},xe=q=>{W(q),L(!0)},J=async()=>{if(F){O(!0);try{const{error:q}=await Ne.from("devices").delete().eq("id",F.id);if(q)throw q;await ce(),L(!1),W(null)}catch(q){console.error("Error deleting device:",q),alert(s("forms.deleteError"))}finally{O(!1)}}},$=()=>{b(!0);try{const q=["ID","Manufacturer","Model","Device Type","Location","Risk Level","Status","Last Check","Created At"],I=t.map(K=>[K.id,K.manufacturer,K.model,K.device_type,K.location,K.risk_level,K.status,K.last_check?new Date(K.last_check).toLocaleString("sl-SI"):"Nikoli",new Date(K.created_at).toLocaleString("sl-SI")]),Y=[q.join(";"),...I.map(K=>K.map(T=>`"${T}"`).join(";"))].join(`
`),H=new Blob([Y],{type:"text/csv;charset=utf-8;"}),he=document.createElement("a");he.href=URL.createObjectURL(H);const ge=new Date().toISOString().split("T")[0];he.download=`Workspaces_naprave_${ge}.csv`,he.click(),URL.revokeObjectURL(he.href)}catch(q){console.error("CSV export error:",q),alert(s("forms.csvExportError"))}finally{b(!1)}},Q=async()=>{j(!0);try{const{data:q,error:I}=await Ne.functions.invoke("generate-workspaces-pdf",{body:{devices:t}});if(I)throw I;const Y=new Blob([q],{type:"text/html"}),H=URL.createObjectURL(Y),he=window.open(H,"_blank");he&&(he.onload=()=>{setTimeout(()=>{he.print()},250)});const K=`Workspaces_naprave_${new Date().toISOString().split("T")[0]}.html`,T=document.createElement("a");T.href=H,T.download=K,T.click(),URL.revokeObjectURL(H)}catch(q){console.error("PDF export error:",q),alert(s("forms.pdfExportError"))}finally{j(!1)}};return a?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:s("workspaces.title")}),e.jsx("p",{className:"text-body text-text-secondary",children:s("workspaces.subtitle")})]}),e.jsx("div",{className:"w-20 h-20 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center shadow-lg",children:e.jsx(Mt,{className:"w-10 h-10 text-white"})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:["High","Medium","Low","Total"].map((q,I)=>{const Y=q==="Total"?t.length:t.filter(he=>he.risk_level===q).length,H=s(q==="Total"?"common.all":`dashboard.${q.toLowerCase()}`);return e.jsxs("div",{className:"bg-bg-surface p-6 rounded-lg border border-border-subtle",children:[e.jsxs("div",{className:"text-caption text-text-secondary mb-2",children:[H," ",q==="Total"||s("workspaces.subtitle").includes("tveganja")?"":"tveganja"]}),e.jsx("div",{className:"text-display-lg font-bold text-text-primary",children:Y})]},q)})}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsxs("button",{onClick:()=>te(!0),className:"inline-flex items-center gap-2 px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg transition-all duration-200 shadow-lg shadow-green-600/25",children:[e.jsx(Xa,{className:"w-5 h-5"}),s("workspaces.importCSV")]}),e.jsxs("button",{onClick:()=>v(!0),className:"inline-flex items-center gap-2 px-6 py-3 bg-accent-primary hover:bg-accent-primary-hover text-white font-medium rounded-lg transition-all duration-200 shadow-lg shadow-accent-primary/25",children:[e.jsx(Dt,{className:"w-5 h-5"}),s("workspaces.addDevice")]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsx("div",{className:"flex gap-3",children:["all","high","medium","low"].map(q=>e.jsx("button",{onClick:()=>o(q),className:`px-4 py-2 rounded-sm text-body-sm font-medium transition-all duration-200
                ${i===q?"bg-accent-primary text-white":"bg-bg-surface text-text-secondary hover:bg-bg-surface-hover"}`,children:s(q==="all"?"workspaces.filters.all":`dashboard.${q}`)},q))}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:$,disabled:x||h||t.length===0,className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-white font-medium rounded-lg transition-all duration-200 shadow-lg shadow-blue-600/25",children:[e.jsx(Ir,{className:"w-4 h-4"}),s(x?"workspaces.exporting":"workspaces.exportCSV")]}),e.jsxs("button",{onClick:Q,disabled:x||h||t.length===0,className:"inline-flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed text-white font-medium rounded-lg transition-all duration-200 shadow-lg shadow-purple-600/25",children:[e.jsx(ut,{className:"w-4 h-4"}),s(h?"workspaces.preparing":"workspaces.exportPDF")]})]})]}),e.jsxs("div",{className:"bg-bg-surface p-6 rounded-lg border border-border-subtle",children:[e.jsxs("h3",{className:"text-heading-md font-semibold text-text-primary mb-6",children:[s("workspaces.devices")," (",t.length,")"]}),e.jsx("div",{className:"border border-border-subtle rounded-md overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-near-black border-b border-border-moderate",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-medium text-text-secondary uppercase tracking-wider",children:s("workspaces.table.manufacturer")}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-medium text-text-secondary uppercase tracking-wider",children:s("workspaces.table.location")}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-medium text-text-secondary uppercase tracking-wider",children:s("workspaces.table.riskLevel")}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-medium text-text-secondary uppercase tracking-wider",children:s("common.status")}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-medium text-text-secondary uppercase tracking-wider",children:s("workspaces.table.lastCheck")}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-medium text-text-secondary uppercase tracking-wider",children:s("common.actions")})]})}),e.jsx("tbody",{children:t.map((q,I)=>e.jsxs("tr",{className:`border-b border-border-subtle hover:bg-bg-surface-hover transition-colors duration-200 ${I===t.length-1?"border-b-0":""}`,children:[e.jsxs("td",{className:"px-4 py-4",children:[e.jsxs("div",{className:"font-medium text-text-primary",children:[q.manufacturer," ",q.model]}),e.jsx("div",{className:"text-caption text-text-tertiary",children:q.device_type})]}),e.jsx("td",{className:"px-4 py-4 text-body-sm text-text-primary",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Th,{className:"w-4 h-4 text-text-tertiary"}),e.jsx("span",{children:q.location})]})}),e.jsx("td",{className:"px-4 py-4 text-body-sm text-text-primary",children:e.jsx(vr,{type:"risk",value:q.risk_level})}),e.jsx("td",{className:"px-4 py-4 text-body-sm text-text-primary",children:e.jsx(vr,{type:"status",value:q.status})}),e.jsx("td",{className:"px-4 py-4 text-body-sm text-text-primary",children:q.last_check?new Date(q.last_check).toLocaleString("sl-SI"):"Nikoli"}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>re(q),className:"p-2 rounded-lg bg-blue-600/20 hover:bg-blue-600/30 text-blue-400 transition-colors",title:"Podrobnosti naprave",children:e.jsx(lr,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>U(q),className:"p-2 rounded-lg bg-yellow-600/20 hover:bg-yellow-600/30 text-yellow-400 transition-colors",title:"Uredi napravo",children:e.jsx(ar,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>xe(q),className:"p-2 rounded-lg bg-red-600/20 hover:bg-red-600/30 text-red-400 transition-colors",title:"Izbrii napravo",children:e.jsx(pr,{className:"w-4 h-4"})})]})})]},q.id))})]})})})]}),e.jsx(aC,{isOpen:g,onClose:()=>v(!1),onSave:ce}),_&&F&&e.jsx(zs,{isOpen:_,onClose:()=>k(!1),title:"Uredi napravo",children:e.jsxs("form",{onSubmit:oe,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"manufacturer",className:"block text-sm font-medium text-text-secondary mb-2",children:["Proizvajalec ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"text",id:"manufacturer",value:R.manufacturer,onChange:q=>B(I=>({...I,manufacturer:q.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"model",className:"block text-sm font-medium text-text-secondary mb-2",children:["Model ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"text",id:"model",value:R.model,onChange:q=>B(I=>({...I,model:q.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"device_type",className:"block text-sm font-medium text-text-secondary mb-2",children:["Tip naprave ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsxs("select",{id:"device_type",value:R.device_type,onChange:q=>B(I=>({...I,device_type:q.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"",children:"Izberite..."}),e.jsx("option",{value:"server",children:"server"}),e.jsx("option",{value:"workstation",children:"workstation"}),e.jsx("option",{value:"laptop",children:"laptop"}),e.jsx("option",{value:"mobile_device",children:"mobile_device"}),e.jsx("option",{value:"network_device",children:"network_device"}),e.jsx("option",{value:"printer",children:"printer"}),e.jsx("option",{value:"storage_device",children:"storage_device"}),e.jsx("option",{value:"security_device",children:"security_device"}),e.jsx("option",{value:"iot_device",children:"iot_device"}),e.jsx("option",{value:"other",children:"other"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"location",className:"block text-sm font-medium text-text-secondary mb-2",children:["Lokacija ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"text",id:"location",value:R.location,onChange:q=>B(I=>({...I,location:q.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"risk_level",className:"block text-sm font-medium text-text-secondary mb-2",children:["Nivo tveganja ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsxs("select",{id:"risk_level",value:R.risk_level,onChange:q=>B(I=>({...I,risk_level:q.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"Low",children:s("dashboard.low")}),e.jsx("option",{value:"Medium",children:s("dashboard.medium")}),e.jsx("option",{value:"High",children:s("dashboard.high")})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-text-secondary mb-2",children:"Status"}),e.jsxs("select",{id:"status",value:R.status,onChange:q=>B(I=>({...I,status:q.target.value})),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"active",children:"active"}),e.jsx("option",{value:"inactive",children:"inactive"}),e.jsx("option",{value:"maintenance",children:"maintenance"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"last_check",className:"block text-sm font-medium text-text-secondary mb-2",children:"Zadnji pregled"}),e.jsx("input",{type:"datetime-local",id:"last_check",value:R.last_check,onChange:q=>B(I=>({...I,last_check:q.target.value})),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-border-subtle",children:[e.jsx("button",{type:"button",onClick:()=>k(!1),className:"px-6 py-2 bg-bg-near-black text-text-primary border border-border-subtle rounded hover:bg-bg-surface transition-colors duration-150",children:"Preklii"}),e.jsx("button",{type:"submit",disabled:A,className:"px-6 py-2 bg-accent-primary hover:bg-accent-primary-hover text-white rounded transition-colors duration-150 disabled:opacity-50",children:s(A?"forms.saving":"forms.save")})]})]})}),e.jsx(gi,{isOpen:P,onClose:()=>L(!1),onConfirm:J,title:"Izbrii napravo",message:`Ali ste prepriani, da elite izbrisati napravo ${F==null?void 0:F.manufacturer} ${F==null?void 0:F.model}? Te akcije ni mogoe razveljaviti.`,isDeleting:C}),e.jsx(mx,{isOpen:Z,onClose:()=>te(!1),onSuccess:ce,tableName:"devices",title:"Uvozi naprave iz CSV",columns:["manufacturer","model","device_type","location","risk_level","status"],sampleData:`manufacturer;model;device_type;location;risk_level;status
Dell;PowerEdge R740;server;Ljubljana;High;active
HP;EliteBook 850;laptop;Maribor;Medium;active
Cisco;Catalyst 9200;network_device;Celje;High;active`}),p&&c&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm",onClick:X,children:e.jsxs("div",{className:"bg-gray-800 border border-gray-700/50 rounded-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto shadow-2xl",onClick:q=>q.stopPropagation(),children:[e.jsxs("div",{className:"sticky top-0 bg-gray-800 border-b border-gray-700/50 px-6 py-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:s("workspaces.deviceDetails")}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:[c.manufacturer," ",c.model]})]}),e.jsx("button",{onClick:X,className:"p-2 rounded-lg hover:bg-gray-700/50 transition-colors",children:e.jsx(Ar,{className:"w-5 h-5 text-gray-400"})})]}),e.jsxs("div",{className:"px-6 py-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx(vr,{type:"risk",value:c.risk_level}),e.jsx(vr,{type:"status",value:c.status})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Manufacturer"}),e.jsx("div",{className:"text-sm text-white font-medium",children:c.manufacturer})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:s("workspaces.table.model")}),e.jsx("div",{className:"text-sm text-white font-medium",children:c.model})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Device Type"}),e.jsx("div",{className:"text-sm text-white font-medium",children:c.device_type})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Location"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-white font-medium",children:[e.jsx(Th,{className:"w-4 h-4 text-text-tertiary"}),c.location]})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Risk Level"}),e.jsx("div",{className:"text-sm text-white font-medium",children:c.risk_level})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:s("common.status")}),e.jsx("div",{className:"text-sm text-white font-medium",children:c.status})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:s("workspaces.table.lastCheck")}),e.jsx("div",{className:"text-sm text-white font-medium",children:c.last_check?new Date(c.last_check).toLocaleString("sl-SI"):"Nikoli"})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Created At"}),e.jsx("div",{className:"text-sm text-white font-medium",children:new Date(c.created_at).toLocaleString("sl-SI")})]})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-3",children:"Metapodatki"}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Device ID"}),e.jsx("div",{className:"text-sm text-white font-mono",children:c.id})]})})]})]}),e.jsx("div",{className:"sticky bottom-0 bg-gray-800 border-t border-gray-700/50 px-6 py-4 flex justify-end",children:e.jsx("button",{onClick:X,className:"px-6 py-2 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-lg transition-all duration-200",children:"Zapri"})})]})})]})}function iC({setCurrentPage:s}){const{t}=et(),{user:r}=cr(),[a,n]=z.useState([]),[i,o]=z.useState(!0),[c,d]=z.useState(null),[p,m]=z.useState("incidents"),[x,b]=z.useState(!1),[h,j]=z.useState(null);z.useEffect(()=>{(async()=>{if(r)try{const{data:P,error:L}=await Ne.from("profiles").select("*, organization_id").eq("id",r.id).single();if(L)throw L;d(P)}catch(P){console.error("Error fetching user profile:",P)}})()},[r]),z.useEffect(()=>{if(c!=null&&c.organization_id){g();const k=Ne.channel("incidents-changes").on("postgres_changes",{event:"*",schema:"public",table:"incidents"},()=>{g()}).subscribe();return()=>{Ne.removeChannel(k)}}},[c]);async function g(){if(!(c!=null&&c.organization_id)){o(!1);return}o(!0);try{const{data:k}=await Ne.from("incidents").select("*").eq("organization_id",c.organization_id).order("created_at",{ascending:!1});n(k||[])}catch(k){console.error("Error loading incidents:",k)}finally{o(!1)}}const v=k=>{j(k),b(!0),console.log("Opening incident modal for:",k)};if(i)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})});if(!(c!=null&&c.organization_id))return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center shadow-lg mx-auto mb-3",children:e.jsx(Mt,{className:"w-8 h-8 text-white"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-300 mb-2",children:t("common.organizationRequired")}),e.jsx("p",{className:"text-gray-400",children:t("common.organizationRequiredDescription")})]})});const _={total:a.length,open:a.filter(k=>k.status==="open").length,investigating:a.filter(k=>k.status==="investigating").length,resolved:a.filter(k=>k.status==="resolved").length,nis2Required:a.filter(k=>k.nis2_required).length};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:t("nis2.title")}),e.jsx("p",{className:"text-body text-text-secondary",children:t("nis2.subtitle")})]}),e.jsx("div",{className:"w-20 h-20 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center shadow-lg",children:e.jsx(Mt,{className:"w-10 h-10 text-white"})})]}),e.jsx("div",{className:"flex space-x-1 bg-gray-800/50 p-1 rounded-lg w-fit",children:e.jsxs("button",{onClick:()=>s("cyber-incident-report"),className:"px-4 py-2 rounded-md text-sm font-medium text-gray-400 hover:text-white hover:bg-gray-700/50 transition-all flex items-center gap-2",children:[e.jsx(ut,{className:"w-4 h-4"}),"Poroanje o incidentih"]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6",children:[e.jsxs("div",{className:"bg-bg-surface p-6 rounded-lg border border-border-subtle",children:[e.jsx("div",{className:"text-caption text-text-secondary mb-2",children:"Total Incidents"}),e.jsx("div",{className:"text-display-lg font-bold text-text-primary",children:_.total})]}),e.jsxs("div",{className:"bg-bg-surface p-6 rounded-lg border border-border-subtle",children:[e.jsx("div",{className:"text-caption text-text-secondary mb-2",children:"Open"}),e.jsx("div",{className:"text-display-lg font-bold text-risk-high",children:_.open})]}),e.jsxs("div",{className:"bg-bg-surface p-6 rounded-lg border border-border-subtle",children:[e.jsx("div",{className:"text-caption text-text-secondary mb-2",children:"Investigating"}),e.jsx("div",{className:"text-display-lg font-bold text-risk-medium",children:_.investigating})]}),e.jsxs("div",{className:"bg-bg-surface p-6 rounded-lg border border-border-subtle",children:[e.jsx("div",{className:"text-caption text-text-secondary mb-2",children:"Resolved"}),e.jsx("div",{className:"text-display-lg font-bold text-risk-low",children:_.resolved})]}),e.jsxs("div",{className:"bg-bg-surface p-6 rounded-lg border border-border-subtle",children:[e.jsx("div",{className:"text-caption text-text-secondary mb-2",children:"zahteva NIS-2"}),e.jsx("div",{className:"text-display-lg font-bold text-accent-primary",children:_.nis2Required})]})]}),e.jsxs("div",{className:"space-y-8",children:[_.open>0&&e.jsxs("div",{className:"bg-risk-high/15 border border-risk-high/30 p-6 rounded-lg flex items-start gap-4",children:[e.jsx(pt,{className:"w-6 h-6 text-risk-high flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-heading-md font-semibold text-risk-high mb-2",children:"Kritini incidenti zahtevajo pozornost"}),e.jsxs("p",{className:"text-body-sm text-text-primary",children:[_.open," odprtih incidentov zahteva takojnjo obravnavo.",_.nis2Required>0&&` ${_.nis2Required} incidentov zahteva NIS2 poroanje.`]})]})]}),e.jsx(dl,{title:t("nis2.tabs.incidents"),columns:[{key:"incident_id",header:t("nis2.incidents.table.incidentId")},{key:"type",header:t("nis2.incidents.table.incidentType")},{key:"estimated_damage",header:t("nis2.incidents.table.estimatedDamage"),render:k=>e.jsx(vr,{type:"risk",value:k.estimated_damage})},{key:"detected_at",header:t("nis2.incidents.table.detectionDate"),render:k=>new Date(k.detected_at).toLocaleDateString("sl-SI")},{key:"resolved_at",header:t("nis2.incidents.table.resolutionDate"),render:k=>k.resolved_at?new Date(k.resolved_at).toLocaleDateString("sl-SI"):"-"},{key:"nis2_required",header:t("nis2.incidents.table.nis2Required"),render:k=>e.jsx("span",{className:k.nis2_required?"text-risk-high font-medium":"text-text-tertiary",children:k.nis2_required?"DA":"NE"})},{key:"status",header:t("nis2.incidents.table.status"),render:k=>e.jsx(vr,{type:"status",value:k.status})}],data:a,onViewItem:v})]}),e.jsx(Ag,{isOpen:x,onClose:()=>{b(!1),j(null)},incident:h})]})}function oC({isOpen:s,onClose:t,documentation:r,onSuccess:a}){const[n,i]=z.useState({title:"",description:"",document_type:"pdf",category:"",tags:"",is_confidential:!1,version:"",status:"draft"}),[o,c]=z.useState(null),[d,p]=z.useState(!1),[m,x]=z.useState(""),[b,h]=z.useState(!1),j=z.useRef(null),g=["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/csv"],v=[{value:"pdf",label:"PDF"},{value:"doc",label:"DOC"},{value:"docx",label:"DOCX"},{value:"xls",label:"XLS"},{value:"xlsx",label:"XLSX"},{value:"csv",label:"CSV"}],_=[{value:"draft",label:"Osnutek"},{value:"active",label:"Aktiven"},{value:"archived",label:"Arhiviran"}];z.useEffect(()=>{var B;i(r?{title:r.title,description:r.description||"",document_type:r.document_type,category:r.category||"",tags:((B=r.tags)==null?void 0:B.join(", "))||"",is_confidential:r.is_confidential,version:r.version||"",status:r.status}:{title:"",description:"",document_type:"pdf",category:"",tags:"",is_confidential:!1,version:"",status:"draft"}),c(null),x("")},[r,s]);const k=B=>{var S;if(!g.includes(B.type)){x("Nepodprt tip datoteke. Dovoljeni so: PDF, DOC, DOCX, XLS, XLSX, CSV");return}if(B.size>50*1024*1024){x("Datoteka je prevelika. Najveja dovoljena velikost je 50MB.");return}c(B),x("");const A=(S=B.name.split(".").pop())==null?void 0:S.toLowerCase();if(A){const C=v.find(O=>O.value===A);C&&i(O=>({...O,document_type:C.value}))}},P=B=>{B.preventDefault(),B.stopPropagation(),B.type==="dragenter"||B.type==="dragover"?h(!0):B.type==="dragleave"&&h(!1)},L=B=>{B.preventDefault(),B.stopPropagation(),h(!1),B.dataTransfer.files&&B.dataTransfer.files[0]&&k(B.dataTransfer.files[0])},F=(B,A)=>{i(S=>({...S,[B]:A}))},W=async B=>{if(B.preventDefault(),!r&&!o){x("Izberite datoteko za nalaganje.");return}if(!n.title.trim()){x("Vnesite naslov dokumenta.");return}p(!0),x("");try{const{data:{user:A}}=await Ne.auth.getUser();if(!A)throw new Error("Uporabnik ni prijavljen.");let S=(r==null?void 0:r.file_path)||"",C=(r==null?void 0:r.file_name)||"";if(o){const ce=Date.now(),re=A.id,X=o.name.split(".").pop(),U=o.name.replace(/[^a-zA-Z0-9.-]/g,"_");C=U,S=`${re}/${ce}_${U}`;const{error:oe}=await Ne.storage.from("nis2-documents").upload(S,o,{cacheControl:"3600",upsert:!1});if(oe)throw new Error(`Napaka pri nalaganju datoteke: ${oe.message}`)}const O=n.tags.split(",").map(ce=>ce.trim()).filter(ce=>ce.length>0),Z={title:n.title.trim(),description:n.description.trim()||null,document_type:n.document_type,file_name:C,file_path:S,file_size:o?o.size:(r==null?void 0:r.file_size)||0,uploaded_by:A.id,category:n.category.trim()||null,tags:O.length>0?O:null,is_confidential:n.is_confidential,version:n.version.trim()||null,status:n.status};let te;if(r?te=await Ne.from("nis2_documentation").update(Z).eq("id",r.id):te=await Ne.from("nis2_documentation").insert([Z]),te.error)throw new Error(te.error.message);a()}catch(A){console.error("Error saving documentation:",A),x(A.message||"Prilo je do napake pri shranjevanju dokumenta.")}finally{p(!1)}};if(!s)return null;const R=r?"Uredi dokument":"Dodaj nov dokument";return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[70] flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-bg-surface rounded-lg border border-border-subtle w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-border-subtle",children:[e.jsx("h2",{className:"text-heading-lg font-semibold text-text-primary",children:R}),e.jsx("button",{onClick:t,className:"text-text-tertiary hover:text-text-primary transition-colors",children:e.jsx(Ar,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:W,className:"p-6 space-y-6 max-h-[calc(90vh-80px)] overflow-y-auto",children:[m&&e.jsxs("div",{className:"bg-risk-high/15 border border-risk-high/30 p-4 rounded-lg flex items-center gap-3",children:[e.jsx(er,{className:"w-5 h-5 text-risk-high flex-shrink-0"}),e.jsx("span",{className:"text-text-primary",children:m})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary",children:["Datoteka ",!r&&"*"]}),!r&&e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${b?"border-accent-primary bg-accent-primary/5":"border-border-subtle hover:border-border-medium"}`,onDragEnter:P,onDragLeave:P,onDragOver:P,onDrop:L,children:[e.jsx("input",{ref:j,type:"file",accept:".pdf,.doc,.docx,.xls,.xlsx,.csv",onChange:B=>{var A;return((A=B.target.files)==null?void 0:A[0])&&k(B.target.files[0])},className:"hidden"}),o?e.jsxs("div",{className:"space-y-2",children:[e.jsx(ut,{className:"w-8 h-8 text-accent-primary mx-auto"}),e.jsx("div",{className:"text-text-primary font-medium",children:o.name}),e.jsxs("div",{className:"text-text-secondary text-sm",children:["Velikost: ",(o.size/(1024*1024)).toFixed(2)," MB"]}),e.jsx("button",{type:"button",onClick:()=>{var B;c(null),(B=j.current)==null||B.click()},className:"text-accent-primary hover:text-accent-primary/80 text-sm",children:"Zamenjaj datoteko"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(Xa,{className:"w-8 h-8 text-text-tertiary mx-auto"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-text-primary font-medium mb-2",children:"Povlecite datoteko sem ali kliknite za izbiro"}),e.jsx("div",{className:"text-text-secondary text-sm",children:"Podprti formati: PDF, DOC, DOCX, XLS, XLSX, CSV (max 50MB)"})]}),e.jsx("button",{type:"button",onClick:()=>{var B;return(B=j.current)==null?void 0:B.click()},className:"bg-accent-primary hover:bg-accent-primary/90 text-white px-4 py-2 rounded-lg text-sm font-medium",children:"Izberi datoteko"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Naslov *"}),e.jsx("input",{type:"text",value:n.title,onChange:B=>F("title",B.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:border-accent-primary focus:ring-1 focus:ring-accent-primary",placeholder:"Vnesite naslov dokumenta",required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Opis"}),e.jsx("textarea",{value:n.description,onChange:B=>F("description",B.target.value),rows:3,className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:border-accent-primary focus:ring-1 focus:ring-accent-primary resize-none",placeholder:"Kratek opis dokumenta"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Tip dokumenta"}),e.jsx("select",{value:n.document_type,onChange:B=>F("document_type",B.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg text-text-primary focus:border-accent-primary focus:ring-1 focus:ring-accent-primary",children:v.map(B=>e.jsx("option",{value:B.value,children:B.label},B.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Kategorija"}),e.jsx("input",{type:"text",value:n.category,onChange:B=>F("category",B.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:border-accent-primary focus:ring-1 focus:ring-accent-primary",placeholder:"npr. Politike, Postopki, Evidence"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Oznake (loene z vejico)"}),e.jsx("input",{type:"text",value:n.tags,onChange:B=>F("tags",B.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:border-accent-primary focus:ring-1 focus:ring-accent-primary",placeholder:"npr. varnost, GDPR, upravljanje"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Verzija"}),e.jsx("input",{type:"text",value:n.version,onChange:B=>F("version",B.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:border-accent-primary focus:ring-1 focus:ring-accent-primary",placeholder:"npr. v1.0, 2024-11"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Status"}),e.jsx("select",{value:n.status,onChange:B=>F("status",B.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg text-text-primary focus:border-accent-primary focus:ring-1 focus:ring-accent-primary",children:_.map(B=>e.jsx("option",{value:B.value,children:B.label},B.value))})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:n.is_confidential,onChange:B=>F("is_confidential",B.target.checked),className:"w-4 h-4 text-accent-primary border-border-subtle rounded focus:ring-accent-primary focus:ring-2"}),e.jsx("span",{className:"text-text-primary",children:"Zaupni dokument"})]})})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-border-subtle",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-text-secondary hover:text-text-primary transition-colors",disabled:d,children:"Preklii"}),e.jsx("button",{type:"submit",disabled:d,className:"bg-accent-primary hover:bg-accent-primary/90 text-white px-6 py-2 rounded-lg font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:d?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Shranjevanje..."]}):r?"Posodobi":"Shrani"})]})]})]})})}function lC({setCurrentPage:s}){const{t}=et(),[r,a]=z.useState([]),[n,i]=z.useState(!0),[o,c]=z.useState(!1),[d,p]=z.useState(null),[m,x]=z.useState(""),[b,h]=z.useState(""),[j,g]=z.useState("");z.useEffect(()=>{v();const A=Ne.channel("documentation-changes").on("postgres_changes",{event:"*",schema:"public",table:"nis2_documentation"},()=>{v()}).subscribe();return()=>{Ne.removeChannel(A)}},[]);async function v(){i(!0);try{const{data:A}=await Ne.from("nis2_documentation").select("*").order("created_at",{ascending:!1});a(A||[])}catch(A){console.error("Error loading documentation:",A)}finally{i(!1)}}const _=()=>{p(null),c(!0)},k=A=>{p(A),c(!0)},P=A=>{p(A),c(!0)},L=async A=>{if(confirm(`Ali ste prepriani, da elite izbrisati dokument "${A.title}"?`))try{const{error:S}=await Ne.storage.from("nis2-documents").remove([A.file_path]);S&&console.error("Error deleting file from storage:",S);const{error:C}=await Ne.from("nis2_documentation").delete().eq("id",A.id);C?(console.error("Error deleting documentation record:",C),alert("Napaka pri brisanju dokumenta.")):(v(),alert("Dokument je bil uspeno izbrisan."))}catch(S){console.error("Error:",S),alert("Prilo je do napake pri brisanju dokumenta.")}},F=async A=>{try{const{data:S,error:C}=await Ne.storage.from("nis2-documents").download(A.file_path);if(C){console.error("Error downloading file:",C),alert("Napaka pri prenosu datoteke.");return}const O=URL.createObjectURL(S),Z=document.createElement("a");Z.href=O,Z.download=A.file_name,document.body.appendChild(Z),Z.click(),document.body.removeChild(Z),URL.revokeObjectURL(O)}catch(S){console.error("Error:",S),alert("Prilo je do napake pri prenosu datoteke.")}},W=r.filter(A=>{var Z;const S=A.title.toLowerCase().includes(m.toLowerCase())||((Z=A.description)==null?void 0:Z.toLowerCase().includes(m.toLowerCase()))||A.file_name.toLowerCase().includes(m.toLowerCase()),C=!b||A.category===b,O=!j||A.status===j;return S&&C&&O}),R=[...new Set(r.map(A=>A.category).filter(Boolean))];if(n)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})});const B={total:r.length,active:r.filter(A=>A.status==="active").length,draft:r.filter(A=>A.status==="draft").length,archived:r.filter(A=>A.status==="archived").length,confidential:r.filter(A=>A.is_confidential).length};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:[t("navigation.nis2")," ",t("nis2Documentation.title")]}),e.jsx("p",{className:"text-body text-text-secondary",children:t("nis2Documentation.description")})]}),e.jsx("div",{className:"flex gap-3",children:e.jsxs("button",{onClick:_,className:"bg-accent-primary hover:bg-accent-primary/90 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-all font-medium",children:[e.jsx(Dt,{className:"w-4 h-4"}),t("nis2Documentation.addDocument")]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6",children:[e.jsxs("div",{className:"bg-bg-surface p-6 rounded-lg border border-border-subtle",children:[e.jsx("div",{className:"text-caption text-text-secondary mb-2",children:t("nis2Documentation.stats.totalDocuments")}),e.jsx("div",{className:"text-display-lg font-bold text-text-primary",children:B.total})]}),e.jsxs("div",{className:"bg-bg-surface p-6 rounded-lg border border-border-subtle",children:[e.jsx("div",{className:"text-caption text-text-secondary mb-2",children:t("nis2Documentation.stats.active")}),e.jsx("div",{className:"text-display-lg font-bold text-risk-low",children:B.active})]}),e.jsxs("div",{className:"bg-bg-surface p-6 rounded-lg border border-border-subtle",children:[e.jsx("div",{className:"text-caption text-text-secondary mb-2",children:t("nis2Documentation.stats.drafts")}),e.jsx("div",{className:"text-display-lg font-bold text-risk-medium",children:B.draft})]}),e.jsxs("div",{className:"bg-bg-surface p-6 rounded-lg border border-border-subtle",children:[e.jsx("div",{className:"text-caption text-text-secondary mb-2",children:t("nis2Documentation.stats.archived")}),e.jsx("div",{className:"text-display-lg font-bold text-text-tertiary",children:B.archived})]}),e.jsxs("div",{className:"bg-bg-surface p-6 rounded-lg border border-border-subtle",children:[e.jsx("div",{className:"text-caption text-text-secondary mb-2",children:t("nis2Documentation.stats.confidential")}),e.jsx("div",{className:"text-display-lg font-bold text-risk-high",children:B.confidential})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ss,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-text-tertiary w-4 h-4"}),e.jsx("input",{type:"text",placeholder:t("nis2Documentation.searchPlaceholder"),value:m,onChange:A=>x(A.target.value),className:"w-full pl-10 pr-4 py-2 bg-bg-surface border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:border-accent-primary focus:ring-1 focus:ring-accent-primary"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("select",{value:b,onChange:A=>h(A.target.value),className:"px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg text-text-primary focus:border-accent-primary focus:ring-1 focus:ring-accent-primary",children:[e.jsx("option",{value:"",children:t("nis2Documentation.filters.allCategories")}),R.map(A=>e.jsx("option",{value:A,children:A},A))]}),e.jsxs("select",{value:j,onChange:A=>g(A.target.value),className:"px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg text-text-primary focus:border-accent-primary focus:ring-1 focus:ring-accent-primary",children:[e.jsx("option",{value:"",children:t("nis2Documentation.filters.allStatuses")}),e.jsx("option",{value:"draft",children:t("nis2Documentation.filters.draft")}),e.jsx("option",{value:"active",children:t("nis2Documentation.filters.active")}),e.jsx("option",{value:"archived",children:t("nis2Documentation.filters.archived")})]})]})]}),e.jsx(dl,{title:`Dokumenti (${W.length})`,columns:[{key:"title",header:"Naslov",render:A=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ut,{className:"w-4 h-4 text-text-tertiary"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-text-primary",children:A.title}),A.description&&e.jsx("div",{className:"text-sm text-text-tertiary truncate max-w-xs",children:A.description})]})]})},{key:"document_type",header:"Tip",render:A=>e.jsx(vr,{type:"status",value:A.document_type.toUpperCase()})},{key:"category",header:"Kategorija",render:A=>e.jsx("span",{className:"text-text-secondary",children:A.category||"-"})},{key:"file_size",header:"Velikost",render:A=>`${(A.file_size/1048576).toFixed(2)} MB`},{key:"status",header:"Status",render:A=>{const C={draft:{color:"text-risk-medium",label:"Osnutek"},active:{color:"text-risk-low",label:"Aktiven"},archived:{color:"text-text-tertiary",label:"Arhiviran"}}[A.status];return e.jsx("span",{className:C.color,children:C.label})}},{key:"is_confidential",header:"Zaupnost",render:A=>e.jsx("span",{className:A.is_confidential?"text-risk-high font-medium":"text-text-tertiary",children:A.is_confidential?"Zaupno":"Javno"})},{key:"created_at",header:"Naloeno",render:A=>new Date(A.created_at).toLocaleDateString("sl-SI")}],data:W,onViewItem:k,onEditItem:P,onDeleteItem:L,customActions:A=>e.jsx("button",{onClick:()=>F(A),className:`h-8 w-8 p-0 text-green-600 border border-green-600 rounded-sm
                       hover:bg-green-600 hover:text-white transition-all duration-200 flex items-center justify-center`,title:t("common.export"),children:e.jsx(Ir,{className:"w-4 h-4"})})}),e.jsx(oC,{isOpen:o,onClose:()=>{c(!1),p(null)},documentation:d,onSuccess:()=>{v(),c(!1),p(null)}})]})}function cC({isOpen:s,onClose:t,control:r,onSuccess:a}){const{t:n}=et(),[i,o]=z.useState({title:(r==null?void 0:r.title)||"",description:(r==null?void 0:r.description)||"",control_type:(r==null?void 0:r.control_type)||"",control_category:(r==null?void 0:r.control_category)||"",status:(r==null?void 0:r.status)||"planned",priority:(r==null?void 0:r.priority)||"medium",owner:(r==null?void 0:r.owner)||"",procedures:(r==null?void 0:r.procedures)||"",compliance_status:(r==null?void 0:r.compliance_status)||"not_assessed"}),[c,d]=z.useState(!1),[p,m]=z.useState("");if(!s)return null;const x=async b=>{b.preventDefault(),d(!0),m("");try{const h={...i,control_id:(r==null?void 0:r.control_id)||`NIS2-${Date.now()}`,organization_id:(r==null?void 0:r.organization_id)||"11111111-1111-1111-1111-111111111111"};if(r){const{error:j}=await Ne.from("nis2_controls").update(h).eq("id",r.id)}else{const{error:j}=await Ne.from("nis2_controls").insert([h])}if(p)throw p;a(),t()}catch(h){m(h.message)}finally{d(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-bg-surface rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:n(r?"nis2Controls.messages.editTitle":"nis2Controls.messages.title")}),e.jsx("button",{onClick:t,className:"text-text-tertiary hover:text-text-primary",children:e.jsx(Ar,{size:24})})]}),p&&e.jsx("div",{className:"mb-4 p-3 bg-status-error bg-opacity-20 border border-status-error border-opacity-30 rounded-lg",children:e.jsx("p",{className:"text-status-error text-sm",children:p})}),e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-2",children:[n("nis2Controls.fields.controlName")," *"]}),e.jsx("input",{type:"text",value:i.title,onChange:b=>o({...i,title:b.target.value}),className:"w-full px-3 py-2 bg-bg-surface-hover border border-border-subtle rounded-lg text-text-primary focus:border-accent-primary focus:outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:n("nis2Controls.fields.description")}),e.jsx("textarea",{value:i.description,onChange:b=>o({...i,description:b.target.value}),rows:3,className:"w-full px-3 py-2 bg-bg-surface-hover border border-border-subtle rounded-lg text-text-primary focus:border-accent-primary focus:outline-none"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:n("nis2Controls.fields.controlType")}),e.jsx("input",{type:"text",value:i.control_type,onChange:b=>o({...i,control_type:b.target.value}),placeholder:n("nis2Controls.fields.controlTypeExample"),className:"w-full px-3 py-2 bg-bg-surface-hover border border-border-subtle rounded-lg text-text-primary focus:border-accent-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:n("nis2Controls.fields.controlCategory")}),e.jsxs("select",{value:i.control_category,onChange:b=>o({...i,control_category:b.target.value}),className:"w-full px-3 py-2 bg-bg-surface-hover border border-border-subtle rounded-lg text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"",children:n("common.selectOption")}),e.jsx("option",{value:"governance",children:n("nis2Controls.categoryOptions.governance")}),e.jsx("option",{value:"asset_management",children:n("nis2Controls.categoryOptions.asset_management")}),e.jsx("option",{value:"hr_security",children:n("nis2Controls.categoryOptions.hr_security")}),e.jsx("option",{value:"physical_environmental",children:n("nis2Controls.categoryOptions.physical_environmental")}),e.jsx("option",{value:"network_systems",children:n("nis2Controls.categoryOptions.network_systems")}),e.jsx("option",{value:"cryptography",children:n("nis2Controls.categoryOptions.cryptography")}),e.jsx("option",{value:"physical_logical_access",children:n("nis2Controls.categoryOptions.physical_logical_access")}),e.jsx("option",{value:"access_control",children:n("nis2Controls.categoryOptions.access_control")}),e.jsx("option",{value:"communications_operations",children:n("nis2Controls.categoryOptions.communications_operations")}),e.jsx("option",{value:"incident_management",children:n("nis2Controls.categoryOptions.incident_management")}),e.jsx("option",{value:"business_continuity",children:n("nis2Controls.categoryOptions.business_continuity")}),e.jsx("option",{value:"compliance",children:n("nis2Controls.categoryOptions.compliance")}),e.jsx("option",{value:"supplier_relationships",children:n("nis2Controls.categoryOptions.supplier_relationships")}),e.jsx("option",{value:"information_security",children:n("nis2Controls.categoryOptions.information_security")})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:n("nis2Controls.fields.status")}),e.jsxs("select",{value:i.status,onChange:b=>o({...i,status:b.target.value}),className:"w-full px-3 py-2 bg-bg-surface-hover border border-border-subtle rounded-lg text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"planned",children:n("nis2Controls.statusOptions.planned")}),e.jsx("option",{value:"in_progress",children:n("nis2Controls.statusOptions.in_progress")}),e.jsx("option",{value:"implemented",children:n("nis2Controls.statusOptions.implemented")}),e.jsx("option",{value:"not_applicable",children:n("nis2Controls.statusOptions.not_applicable")}),e.jsx("option",{value:"deferred",children:n("nis2Controls.statusOptions.deferred")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:n("nis2Controls.fields.priority")}),e.jsxs("select",{value:i.priority,onChange:b=>o({...i,priority:b.target.value}),className:"w-full px-3 py-2 bg-bg-surface-hover border border-border-subtle rounded-lg text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"low",children:n("nis2Controls.priorityOptions.low")}),e.jsx("option",{value:"medium",children:n("nis2Controls.priorityOptions.medium")}),e.jsx("option",{value:"high",children:n("nis2Controls.priorityOptions.high")}),e.jsx("option",{value:"critical",children:n("nis2Controls.priorityOptions.critical")})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:n("nis2Controls.fields.owner")}),e.jsx("input",{type:"text",value:i.owner,onChange:b=>o({...i,owner:b.target.value}),placeholder:n("nis2Controls.fields.ownerPlaceholder"),className:"w-full px-3 py-2 bg-bg-surface-hover border border-border-subtle rounded-lg text-text-primary focus:border-accent-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:n("nis2Controls.fields.procedures")}),e.jsx("textarea",{value:i.procedures,onChange:b=>o({...i,procedures:b.target.value}),rows:3,placeholder:n("nis2Controls.fields.proceduresPlaceholder"),className:"w-full px-3 py-2 bg-bg-surface-hover border border-border-subtle rounded-lg text-text-primary focus:border-accent-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:n("nis2Controls.fields.complianceStatus")}),e.jsxs("select",{value:i.compliance_status,onChange:b=>o({...i,compliance_status:b.target.value}),className:"w-full px-3 py-2 bg-bg-surface-hover border border-border-subtle rounded-lg text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"compliant",children:n("nis2Controls.complianceStatusOptions.compliant")}),e.jsx("option",{value:"partially_compliant",children:n("nis2Controls.complianceStatusOptions.partially_compliant")}),e.jsx("option",{value:"non_compliant",children:n("nis2Controls.complianceStatusOptions.non_compliant")}),e.jsx("option",{value:"not_assessed",children:n("nis2Controls.complianceStatusOptions.not_assessed")})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-text-secondary hover:text-text-primary",children:n("common.cancel")}),e.jsx("button",{type:"submit",disabled:c,className:"px-4 py-2 bg-accent-primary text-white rounded-lg hover:bg-accent-primary/90 disabled:opacity-50",children:n(c?"common.saving":r?"nis2Controls.update":"nis2Controls.create")})]})]})]})})}function dC({setCurrentPage:s}){const[t,r]=z.useState([]),[a,n]=z.useState(!0),[i,o]=z.useState(!1),[c,d]=z.useState(null),[p,m]=z.useState(""),[x,b]=z.useState(""),[h,j]=z.useState(""),[g,v]=z.useState(""),[_,k]=z.useState("");z.useEffect(()=>{P();const U=Ne.channel("controls-changes").on("postgres_changes",{event:"*",schema:"public",table:"nis2_controls"},()=>{P()}).subscribe();return()=>{Ne.removeChannel(U)}},[]);async function P(){n(!0);try{const{data:U}=await Ne.from("nis2_controls").select("*").eq("is_active",!0).order("created_at",{ascending:!1});r(U||[])}catch(U){console.error("Error loading controls:",U)}finally{n(!1)}}const L=()=>{d(null),o(!0)},F=U=>{d(U),o(!0)},W=async U=>{if(confirm(`Ali ste prepriani, da elite izbrisati kontrolo "${U.title}"?`))try{const{error:oe}=await Ne.from("nis2_controls").update({is_active:!1}).eq("id",U.id);oe?(console.error("Error deactivating control:",oe),alert("Napaka pri brisanju kontrole.")):(P(),alert("Kontrola je bila uspeno izbrisana."))}catch(oe){console.error("Error:",oe),alert("Prilo je do napake pri brisanju kontrole.")}},R=t.filter(U=>{var q,I;const oe=U.title.toLowerCase().includes(p.toLowerCase())||((q=U.description)==null?void 0:q.toLowerCase().includes(p.toLowerCase()))||((I=U.owner)==null?void 0:I.toLowerCase().includes(p.toLowerCase())),xe=!x||U.control_type===x,J=!h||U.control_category===h,$=!g||U.status===g,Q=!_||U.priority===_;return oe&&xe&&J&&$&&Q}),B=[...new Set(t.map(U=>U.control_type))],A=[...new Set(t.map(U=>U.control_category))],S=[...new Set(t.map(U=>U.status))],C=[...new Set(t.map(U=>U.priority))];if(a)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})});const O={total:t.length,preventive:t.filter(U=>U.control_type==="preventive").length,corrective:t.filter(U=>U.control_type==="corrective").length,detective:t.filter(U=>U.control_type==="detective").length,responsive:t.filter(U=>U.control_type==="responsive").length,implemented:t.filter(U=>U.status==="implemented").length,inProgress:t.filter(U=>U.status==="in_progress").length,planned:t.filter(U=>U.status==="planned").length,highPriority:t.filter(U=>U.priority==="high").length,effective:t.filter(U=>U.compliance_status==="compliant").length},Z=U=>{switch(U){case"implemented":return e.jsx(Rt,{className:"w-4 h-4 text-risk-low"});case"in_progress":return e.jsx(cs,{className:"w-4 h-4 text-risk-medium"});case"planned":return e.jsx(er,{className:"w-4 h-4 text-risk-medium"});case"deprecated":return e.jsx(Ss,{className:"w-4 h-4 text-risk-high"});default:return e.jsx(Mt,{className:"w-4 h-4 text-text-tertiary"})}},te=U=>({preventive:"Preventivni",corrective:"Korektivni",detective:"Detektivni",responsive:"Odzivni"})[U]||U,ce=U=>({technical:"Tehnini",organizational:"Organizacijski",physical:"Fizini",legal:"Pravni"})[U]||U,re=U=>({planned:"Nartovan",in_progress:"V izvedbi",implemented:"Implementiran",verified:"Preverjen",maintenance:"Vzdrevanje",deprecated:"Opuen"})[U]||U,X=U=>({high:"Visoka",medium:"Srednja",low:"Nizka"})[U]||U;return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:"Evidentiranje kontrol in ukrepov"}),e.jsx("p",{className:"text-body text-text-secondary",children:"Upravljanje varnostnih kontrol in ukrepov v skladu z NIS2 direktivo"})]}),e.jsx("div",{className:"flex gap-3",children:e.jsxs("button",{onClick:L,className:"bg-accent-primary hover:bg-accent-primary/90 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-all font-medium",children:[e.jsx(Dt,{className:"w-4 h-4"}),"Dodaj kontrolo"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-6",children:[e.jsxs("div",{className:"bg-bg-surface p-6 rounded-lg border border-border-subtle",children:[e.jsx("div",{className:"text-caption text-text-secondary mb-2",children:"Skupno kontrol"}),e.jsx("div",{className:"text-display-lg font-bold text-text-primary",children:O.total})]}),e.jsxs("div",{className:"bg-bg-surface p-6 rounded-lg border border-border-subtle",children:[e.jsx("div",{className:"text-caption text-text-secondary mb-2",children:"Preventivne"}),e.jsx("div",{className:"text-display-lg font-bold text-risk-low",children:O.preventive})]}),e.jsxs("div",{className:"bg-bg-surface p-6 rounded-lg border border-border-subtle",children:[e.jsx("div",{className:"text-caption text-text-secondary mb-2",children:"Korektivne"}),e.jsx("div",{className:"text-display-lg font-bold text-accent-primary",children:O.corrective})]}),e.jsxs("div",{className:"bg-bg-surface p-6 rounded-lg border border-border-subtle",children:[e.jsx("div",{className:"text-caption text-text-secondary mb-2",children:"Implementirane"}),e.jsx("div",{className:"text-display-lg font-bold text-risk-low",children:O.implemented})]}),e.jsxs("div",{className:"bg-bg-surface p-6 rounded-lg border border-border-subtle",children:[e.jsx("div",{className:"text-caption text-text-secondary mb-2",children:"V izvedbi"}),e.jsx("div",{className:"text-display-lg font-bold text-risk-medium",children:O.inProgress})]}),e.jsxs("div",{className:"bg-bg-surface p-6 rounded-lg border border-border-subtle",children:[e.jsx("div",{className:"text-caption text-text-secondary mb-2",children:"Visoka prioriteta"}),e.jsx("div",{className:"text-display-lg font-bold text-risk-high",children:O.highPriority})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ss,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-text-tertiary w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Ii po naslovu, opisu ali odgovorni osebi...",value:p,onChange:U=>m(U.target.value),className:"w-full pl-10 pr-4 py-2 bg-bg-surface border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:border-accent-primary focus:ring-1 focus:ring-accent-primary"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("select",{value:x,onChange:U=>b(U.target.value),className:"px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg text-text-primary focus:border-accent-primary focus:ring-1 focus:ring-accent-primary",children:[e.jsx("option",{value:"",children:"Vsi tipi"}),B.map(U=>e.jsx("option",{value:U,children:te(U)},U))]}),e.jsxs("select",{value:h,onChange:U=>j(U.target.value),className:"px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg text-text-primary focus:border-accent-primary focus:ring-1 focus:ring-accent-primary",children:[e.jsx("option",{value:"",children:"Vse kategorije"}),A.map(U=>e.jsx("option",{value:U,children:ce(U)},U))]}),e.jsxs("select",{value:g,onChange:U=>v(U.target.value),className:"px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg text-text-primary focus:border-accent-primary focus:ring-1 focus:ring-accent-primary",children:[e.jsx("option",{value:"",children:"Vsi statusi"}),S.map(U=>e.jsx("option",{value:U,children:re(U)},U))]}),e.jsxs("select",{value:_,onChange:U=>k(U.target.value),className:"px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg text-text-primary focus:border-accent-primary focus:ring-1 focus:ring-accent-primary",children:[e.jsx("option",{value:"",children:"Vse prioritete"}),C.map(U=>e.jsx("option",{value:U,children:X(U)},U))]})]})]}),e.jsx(dl,{title:`Kontrolni ukrepi (${R.length})`,columns:[{key:"title",header:"Naziv kontrole",render:U=>e.jsxs("div",{className:"flex items-center gap-3",children:[Z(U.status),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-text-primary",children:U.title}),U.description&&e.jsx("div",{className:"text-sm text-text-tertiary truncate max-w-xs",children:U.description})]})]})},{key:"control_type",header:"Tip",render:U=>e.jsx("span",{className:"text-accent-primary font-medium",children:te(U.control_type)})},{key:"control_category",header:"Kategorija",render:U=>e.jsx("span",{className:"text-text-secondary",children:ce(U.control_category)})},{key:"priority",header:"Prioriteta",render:U=>{const oe={high:"text-risk-high",medium:"text-risk-medium",low:"text-risk-low"};return e.jsx("span",{className:oe[U.priority],children:X(U.priority)})}},{key:"status",header:"Status",render:U=>e.jsx(vr,{type:"status",value:re(U.status)})},{key:"responsible_person",header:"Odgovorna oseba",render:U=>e.jsx("div",{className:"text-text-primary",children:U.owner})},{key:"implementation_date",header:"Implementacija",render:U=>e.jsx("span",{className:"text-text-secondary",children:U.implementation_date?new Date(U.implementation_date).toLocaleDateString("sl-SI"):"-"})},{key:"effectiveness_rating",header:"Skladnost",render:U=>{const oe={compliant:"text-status-success",partially_compliant:"text-risk-medium",non_compliant:"text-status-error",not_assessed:"text-text-tertiary"},xe={compliant:"Skladno",partially_compliant:"Delno skladno",non_compliant:"Neskladno",not_assessed:"Ne ocenjeno"};return e.jsx("span",{className:oe[U.compliance_status],children:xe[U.compliance_status]||"-"})}}],data:R,onViewItem:F,onDeleteItem:W}),e.jsx(cC,{isOpen:i,onClose:()=>{o(!1),d(null)},control:c,onSuccess:()=>{P(),o(!1),d(null)}})]})}const ip=rd("https://ckxlbiiirfdogobccmjs.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNreGxiaWlpcmZkb2dvYmNjbWpzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE4NjI5NjIsImV4cCI6MjA3NzQzODk2Mn0.Y8T0bCsL5t_9u71z-yHYxrdyl4rqPN3fUMBg9k-p_TA");function uC({setCurrentPage:s}){const{t}=et(),[r,a]=z.useState([]),[n,i]=z.useState(!0),[o,c]=z.useState(""),[d,p]=z.useState(""),[m,x]=z.useState(""),[b,h]=z.useState(!1),[j,g]=z.useState(null),v=[{id:"1",identification_code:"NC-2024-001",title:"Neavtoriziran dostop do strenike sobe",description:"Med varnostnim pregledom je bilo ugotovljeno, da strenika soba nima ustreznih fizinih kontrol dostopa. Vrata niso bila zaklenjena, dostop pa je omogoen vsem zaposlenim.",severity:"visoka",status:"v-obdelavi",reported_by:"Janez Novak",assigned_to:"Marko Kova",detection_date:"2025-10-25",due_date:"2025-11-08",root_cause:"Sistem za nadzor dostopa je zaradi tehnine napake prenehal delovati",corrective_action:"Zamenjava kljuavnice in popravilo sistema za nadzor dostopa",preventive_action:"Implementacija rednega mesenega pregleda sistemov dostopa",nis2_requirement:"len 21 - Fizina varnost",impact_assessment:"Visok rizik za varnost IT infrastrukture",business_impact:"Monost neavtoriziranega dostopa do kritinih sistemov",compliance_notes:"Kritev zahtev za fizino varnost po NIS 2 direktivi",verification_status:"prevereno",verified_by:"Ana Plans",created_at:"2024-11-01T08:00:00Z",updated_at:"2024-11-02T10:30:00Z"},{id:"2",identification_code:"NC-2024-002",title:"Manjkajoi varnostni posodobitve na Windows streniku",description:"Windows strenik (SRV-APP-01) nima nameenih varnostnih posodobitev za zadnjih 6 mesecev. Odkritih je bilo 23 kritinih ranljivosti.",severity:"kriticna",status:"odprto",reported_by:"Sistem za spremljanje",assigned_to:"Toma Vesel",detection_date:"2025-10-15",due_date:"2025-11-12",root_cause:"Avtomatsko nameanje posodobitev je bilo onemogoeno",corrective_action:"Namestitev vseh kritinih varnostnih posodobitev",preventive_action:"Aktiviranje avtomatskega nameanja varnostnih posodobitev",nis2_requirement:"len 21 - Varnost v kibernetskem prostoru",impact_assessment:"Kritina ranljivost za kibernetske napade",business_impact:"Visok rizik za podatke in sisteme, mona okvara storitev",compliance_notes:"Kritev zahtev za upravljanje ranljivosti",verification_status:"neprevereno",created_at:"2024-10-28T14:20:00Z",updated_at:"2024-10-28T14:20:00Z"},{id:"3",identification_code:"NC-2024-003",title:"Neustrezno varovanje osebnih podatkov strank",description:"Med internim pregledom je bilo ugotovljeno, da so osebni podatki strank shranjeni v neencriptirani bazi podatkov, ki ni ustrezno zaitena.",severity:"visoka",status:"reseno",reported_by:"Petra Mlakar",assigned_to:"Milan Krek",detection_date:"2025-10-20",due_date:"2025-11-05",resolution_date:"2024-10-30",root_cause:"Pri implementaciji novega sistema baze podatkov ni bilo vkljueno ifriranje",corrective_action:"Implementacija ifriranja baze podatkov in sprememba varnostnih politik",preventive_action:"Vkljuitev varnostnih zahtev v proces razvoja",nis2_requirement:"len 28 - Varstvo podatkov",impact_assessment:"Visok rizik za osebne podatke strank",business_impact:"Kritev GDPR, mone kazni in koda ugleda",compliance_notes:"Implementirana ustrezna varnostna zaita",verification_status:"odobreno",verified_by:"Urka Goriek",created_at:"2024-10-15T09:15:00Z",updated_at:"2024-10-30T16:45:00Z"},{id:"4",identification_code:"NC-2024-004",title:"Nedostopne varnostne kopije ve kot 24 ur",description:"Sistem za varnostne kopije ne deluje e 36 ur. Ni mogoe ugotoviti, kdaj so bile nazadnje uspeno narejene varnostne kopije kljunih sistemov.",severity:"srednja",status:"zaprto",reported_by:"Peter Bergant",assigned_to:"Luka Potonik",detection_date:"2025-10-28",due_date:"2025-11-10",resolution_date:"2024-10-22",root_cause:"Napaka v mreni povezavi med primarnim sistemom in strenikom za varnostne kopije",corrective_action:"Popravilo mrene povezave in izdelava zamujenih varnostnih kopij",preventive_action:"Implementacija spremljanja povezav in avtomatskih opozoril",nis2_requirement:"len 21 - Varnost podatkov",impact_assessment:"Srednji rizik zaradi nedostopnih varnostnih kopij",business_impact:"Povean rizik v primeru izpada glavnih sistemov",compliance_notes:"Reeno, varnostne kopije so ponovno na voljo",verification_status:"odobreno",verified_by:"Barbara Zorman",created_at:"2024-10-20T11:30:00Z",updated_at:"2024-10-22T14:20:00Z"},{id:"5",identification_code:"NC-2024-005",title:"Potreba po posodobitvi varnostne politike",description:"Varnostna politika za uporabo mobilnih naprav ni bila posodobljena e 2 leti. Potrebna je posodobitev glede novejih groenj in tehnologij.",severity:"nizka",status:"v-obdelavi",reported_by:"Katja Horvat",assigned_to:"Ale Marki",detection_date:"2025-11-01",due_date:"2025-11-15",root_cause:"Ni bila dodeljena odgovornost za redno posodabljanje politik",corrective_action:"Auriranje varnostne politike za mobilne naprave",preventive_action:"Dodelitev odgovornosti za redno letno posodabljanje politik",nis2_requirement:"len 21 - Varnostna politika",impact_assessment:"Nizek rizik, vendar potrebno zaradi sprememb v tehnologiji",business_impact:"Manja pomanjkanja v urejenosti varnostnih postopkov",compliance_notes:"V postopku posodobitve",verification_status:"neprevereno",created_at:"2024-11-05T13:45:00Z",updated_at:"2024-11-06T08:15:00Z"}],[_,k]=z.useState({identification_code:"",title:"",description:"",severity:"srednja",status:"odprto",reported_by:"",assigned_to:"",detection_date:"",due_date:"",root_cause:"",corrective_action:"",preventive_action:"",nis2_requirement:"",impact_assessment:"",business_impact:"",compliance_notes:""}),P=async()=>{try{i(!0);let O=ip.from("non_conformities").select("*").order("created_at",{ascending:!1});o&&(O=O.or(`title.ilike.%${o}%,identification_code.ilike.%${o}%`)),d&&(O=O.eq("status",d)),m&&(O=O.eq("severity",m));const{data:Z,error:te}=await O;if(te)throw te;!Z||Z.length===0?a(v):a(Z)}catch(O){console.error("Error loading non-conformities:",O),a(v)}finally{i(!1)}};z.useEffect(()=>{P()},[o,d,m]);const L=()=>{k({identification_code:"",title:"",description:"",severity:"srednja",status:"odprto",reported_by:"",assigned_to:"",detection_date:"",due_date:"",root_cause:"",corrective_action:"",preventive_action:"",nis2_requirement:"",impact_assessment:"",business_impact:"",compliance_notes:""}),g(null)},F=O=>{O?(g(O),k({identification_code:O.identification_code,title:O.title,description:O.description,severity:O.severity,status:O.status,reported_by:O.reported_by||"",assigned_to:O.assigned_to||"",detection_date:O.detection_date,due_date:O.due_date||"",root_cause:O.root_cause||"",corrective_action:O.corrective_action||"",preventive_action:O.preventive_action||"",nis2_requirement:O.nis2_requirement||"",impact_assessment:O.impact_assessment||"",business_impact:O.business_impact||"",compliance_notes:O.compliance_notes||""})):L(),h(!0)},W=()=>{h(!1),L()},R=async()=>{try{if(j){const{error:O}=await ip.from("non_conformities").update(_).eq("id",j.id);if(O)throw O}else{const{data:O}=await ip.rpc("generate_nc_code"),Z=O||`NC-${new Date().getFullYear()}-${String(r.length+1).padStart(3,"0")}`,{error:te}=await ip.from("non_conformities").insert([{..._,identification_code:Z}]);if(te)throw te}W(),P()}catch(O){console.error("Error saving non-conformity:",O),alert("Napaka pri shranjevanju neskladnosti")}},B=async O=>{if(confirm("Ali ste prepriani, da elite izbrisati to neskladnost?"))try{const{error:Z}=await ip.from("non_conformities").delete().eq("id",O);if(Z)throw Z;P()}catch(Z){console.error("Error deleting non-conformity:",Z),alert("Napaka pri brisanju neskladnosti")}},A=O=>{switch(O){case"odprto":return"text-red-500 bg-red-500/10";case"v-obdelavi":return"text-yellow-500 bg-yellow-500/10";case"reseno":return"text-green-500 bg-green-500/10";case"zaprto":return"text-gray-500 bg-gray-500/10";case"zavrnjeno":return"text-purple-500 bg-purple-500/10";default:return"text-gray-500 bg-gray-500/10"}},S=O=>{switch(O){case"nizka":return"text-green-500 bg-green-500/10";case"srednja":return"text-yellow-500 bg-yellow-500/10";case"visoka":return"text-red-500 bg-red-500/10";case"kriticna":return"text-red-500 bg-red-500/10";default:return"text-gray-500 bg-gray-500/10"}},C=O=>{switch(O){case"odprto":return e.jsx(pt,{className:"w-4 h-4"});case"v-obdelavi":return e.jsx(cs,{className:"w-4 h-4"});case"reseno":return e.jsx(Rt,{className:"w-4 h-4"});case"zaprto":return e.jsx(Rt,{className:"w-4 h-4"});default:return e.jsx(ut,{className:"w-4 h-4"})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Evidenca neskladnosti"}),e.jsx("p",{className:"text-text-tertiary mt-1",children:"Upravljanje neskladnosti in korektivnih ukrepov po NIS 2 direktivi"})]}),e.jsxs("button",{onClick:()=>F(),className:"bg-accent-primary hover:bg-accent-primary/90 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors",children:[e.jsx(Dt,{className:"w-4 h-4"}),"Dodaj neskladnost"]})]}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ss,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-text-tertiary w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Iskanje po naslovu ali kodi...",value:o,onChange:O=>c(O.target.value),className:"w-full pl-10 pr-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-accent-primary/20 focus:border-accent-primary"})]}),e.jsxs("select",{value:d,onChange:O=>p(O.target.value),className:"px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary/20 focus:border-accent-primary",children:[e.jsx("option",{value:"",children:"Vsi statusi"}),e.jsx("option",{value:"odprto",children:"Odprto"}),e.jsx("option",{value:"v-obdelavi",children:"V obdelavi"}),e.jsx("option",{value:"reseno",children:"Reeno"}),e.jsx("option",{value:"zaprto",children:"Zaprto"}),e.jsx("option",{value:"zavrnjeno",children:"Zavrnjeno"})]}),e.jsxs("select",{value:m,onChange:O=>x(O.target.value),className:"px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary/20 focus:border-accent-primary",children:[e.jsx("option",{value:"",children:"Vse resnosti"}),e.jsx("option",{value:"nizka",children:"Nizka"}),e.jsx("option",{value:"srednja",children:"Srednja"}),e.jsx("option",{value:"visoka",children:"Visoka"}),e.jsx("option",{value:"kriticna",children:"Kritina"})]}),e.jsx("button",{onClick:()=>{c(""),p(""),x("")},className:"px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-secondary hover:text-text-primary hover:border-border-strong transition-colors",children:"Poisti filter"})]})}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-near-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:"Koda"}),e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:"Naslov"}),e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:"Resnost"}),e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:"Status"}),e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:"Dodeljeno"}),e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:"Rok"}),e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:"Akcije"})]})}),e.jsx("tbody",{children:n?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"p-8 text-center text-text-tertiary",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-accent-primary mx-auto"})})}):r.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"p-8 text-center text-text-tertiary",children:"Ni najdenih neskladnosti"})}):r.map(O=>e.jsxs("tr",{className:"border-b border-border-subtle hover:bg-bg-near-black transition-colors",children:[e.jsx("td",{className:"p-4",children:e.jsx("div",{className:"font-medium text-text-primary",children:O.identification_code})}),e.jsxs("td",{className:"p-4",children:[e.jsx("div",{className:"text-text-primary font-medium",children:O.title}),e.jsxs("div",{className:"text-text-tertiary text-sm mt-1",children:[O.description.substring(0,100),"..."]})]}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${S(O.severity)}`,children:O.severity.charAt(0).toUpperCase()+O.severity.slice(1)})}),e.jsx("td",{className:"p-4",children:e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${A(O.status)}`,children:[C(O.status),O.status.replace("-"," ").charAt(0).toUpperCase()+O.status.replace("-"," ").slice(1)]})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(en,{className:"w-4 h-4 text-text-tertiary"}),e.jsx("span",{className:"text-text-primary",children:O.assigned_to||"Nedodeljeno"})]})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_a,{className:"w-4 h-4 text-text-tertiary"}),e.jsx("span",{className:"text-text-primary",children:O.due_date||"Brez roka"})]})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>F(O),className:"text-accent-primary hover:text-accent-primary/80 transition-colors",children:e.jsx(ar,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>B(O.id),className:"text-red-500 hover:text-red-400 transition-colors",children:e.jsx(pr,{className:"w-4 h-4"})})]})})]},O.id))})]})})}),b&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-border-subtle",children:e.jsx("h2",{className:"text-xl font-bold text-text-primary",children:j?"Uredi neskladnost":"Dodaj novo neskladnost"})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Identifikacijska koda"}),e.jsx("input",{type:"text",value:_.identification_code,onChange:O=>k({..._,identification_code:O.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-accent-primary/20 focus:border-accent-primary",placeholder:"Samodejno generirano",disabled:!!j})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Naslov *"}),e.jsx("input",{type:"text",value:_.title,onChange:O=>k({..._,title:O.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-accent-primary/20 focus:border-accent-primary",placeholder:"Naslov neskladnosti",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Opis *"}),e.jsx("textarea",{value:_.description,onChange:O=>k({..._,description:O.target.value}),rows:3,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-accent-primary/20 focus:border-accent-primary",placeholder:"Podroben opis neskladnosti",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Resnost *"}),e.jsxs("select",{value:_.severity,onChange:O=>k({..._,severity:O.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary/20 focus:border-accent-primary",children:[e.jsx("option",{value:"nizka",children:"Nizka"}),e.jsx("option",{value:"srednja",children:"Srednja"}),e.jsx("option",{value:"visoka",children:"Visoka"}),e.jsx("option",{value:"kriticna",children:"Kritina"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Status *"}),e.jsxs("select",{value:_.status,onChange:O=>k({..._,status:O.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary/20 focus:border-accent-primary",children:[e.jsx("option",{value:"odprto",children:"Odprto"}),e.jsx("option",{value:"v-obdelavi",children:"V obdelavi"}),e.jsx("option",{value:"reseno",children:"Reeno"}),e.jsx("option",{value:"zaprto",children:"Zaprto"}),e.jsx("option",{value:"zavrnjeno",children:"Zavrnjeno"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"NIS 2 zahteva"}),e.jsx("input",{type:"text",value:_.nis2_requirement,onChange:O=>k({..._,nis2_requirement:O.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-accent-primary/20 focus:border-accent-primary",placeholder:"npr. len 21"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Prijavil"}),e.jsx("input",{type:"text",value:_.reported_by,onChange:O=>k({..._,reported_by:O.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-accent-primary/20 focus:border-accent-primary",placeholder:"Ime in priimek"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Dodeljeno"}),e.jsx("input",{type:"text",value:_.assigned_to,onChange:O=>k({..._,assigned_to:O.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-accent-primary/20 focus:border-accent-primary",placeholder:"Ime in priimek"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Datum odkritja *"}),e.jsx("input",{type:"date",value:_.detection_date,onChange:O=>k({..._,detection_date:O.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary/20 focus:border-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Rok za reitev"}),e.jsx("input",{type:"date",value:_.due_date,onChange:O=>k({..._,due_date:O.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary/20 focus:border-accent-primary"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Vzrok neskladnosti"}),e.jsx("textarea",{value:_.root_cause,onChange:O=>k({..._,root_cause:O.target.value}),rows:3,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-accent-primary/20 focus:border-accent-primary",placeholder:"Opis vzroka, ki je privedel do neskladnosti"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Korektivni ukrep"}),e.jsx("textarea",{value:_.corrective_action,onChange:O=>k({..._,corrective_action:O.target.value}),rows:3,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-accent-primary/20 focus:border-accent-primary",placeholder:"Ukrep za odpravo trenutne neskladnosti"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Preventivni ukrep"}),e.jsx("textarea",{value:_.preventive_action,onChange:O=>k({..._,preventive_action:O.target.value}),rows:3,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-accent-primary/20 focus:border-accent-primary",placeholder:"Ukrep za prepreitev ponovitve"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Ocena vpliva"}),e.jsx("textarea",{value:_.impact_assessment,onChange:O=>k({..._,impact_assessment:O.target.value}),rows:3,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-accent-primary/20 focus:border-accent-primary",placeholder:"Ocena vpliva neskladnosti na varnost"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Vpliv na poslovanje"}),e.jsx("textarea",{value:_.business_impact,onChange:O=>k({..._,business_impact:O.target.value}),rows:3,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-accent-primary/20 focus:border-accent-primary",placeholder:"Vpliv na poslovne procese in dejavnosti"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Opombe o skladnosti"}),e.jsx("textarea",{value:_.compliance_notes,onChange:O=>k({..._,compliance_notes:O.target.value}),rows:3,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-accent-primary/20 focus:border-accent-primary",placeholder:"Dodatne opombe o skladnosti z NIS 2 direktivo"})]})]}),e.jsxs("div",{className:"p-6 border-t border-border-subtle flex justify-end gap-3",children:[e.jsx("button",{onClick:W,className:"px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-secondary hover:text-text-primary hover:border-border-strong transition-colors",children:"Preklii"}),e.jsx("button",{onClick:R,className:"px-4 py-2 bg-accent-primary hover:bg-accent-primary/90 text-white rounded-lg transition-colors",children:j?"Shrani spremembe":"Dodaj neskladnost"})]})]})})]})}const Wl=rd("https://ckxlbiiirfdogobccmjs.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNreGxiaWlpcmZkb2dvYmNjbWpzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE4NjI5NjIsImV4cCI6MjA3NzQzODk2Mn0.Y8T0bCsL5t_9u71z-yHYxrdyl4rqPN3fUMBg9k-p_TA");function pC({setCurrentPage:s}){const{t}=et(),{user:r}=cr(),[a,n]=z.useState("dashboard"),[i,o]=z.useState([]),[c,d]=z.useState([]),[p,m]=z.useState([]),[x,b]=z.useState(!0),[h,j]=z.useState(null),[g,v]=z.useState(""),[_,k]=z.useState(""),[P,L]=z.useState(""),[F,W]=z.useState({isOpen:!1,type:null}),[R,B]=z.useState({}),[A,S]=z.useState(!1),C=[{id:"dashboard",label:"Pregled",icon:Bi},{id:"suppliers",label:"Dobavitelji",icon:t0},{id:"risk-assessments",label:"Ocenjevanje tveganj",icon:Mt},{id:"incidents",label:"Incidenti",icon:er},{id:"monitoring",label:"Monitoring",icon:lr},{id:"action-plans",label:"Narti ukrepov",icon:Rp},{id:"compliance",label:"Skladnost",icon:pl}],O=async()=>{try{b(!0);const{data:ne,error:Re}=await Wl.from("supply_chain_suppliers").select("*").order("created_at",{ascending:!1});if(Re)throw Re;o(ne||[]);const{data:Oe,error:Je}=await Wl.from("supply_chain_risk_assessments").select("*").order("created_at",{ascending:!1});if(Je)throw Je;d(Oe||[]);const{data:Be,error:kt}=await Wl.from("supply_chain_incidents").select("*").order("created_at",{ascending:!1});if(kt)throw kt;m(Be||[])}catch(ne){console.error("Error loading dashboard data:",ne)}finally{b(!1)}};z.useEffect(()=>{O()},[]);const te=(()=>{const ne=i.length,Re=i.filter(it=>it.criticality_level==="kriticna").length,Oe=i.filter(it=>it.overall_risk_score&&it.overall_risk_score>=6).length,Je=p.filter(it=>["identificiran","v-preiskavi","v-odpravi"].includes(it.status)).length,Be=i.filter(it=>it.next_assessment_date&&new Date(it.next_assessment_date)<new Date).length,kt=ne>0?Math.round(i.filter(it=>it.iso27001_certified&&it.data_protection_compliance).length/ne*100):0;return{totalSuppliers:ne,criticalSuppliers:Re,highRiskSuppliers:Oe,activeIncidents:Je,overdueAssessments:Be,complianceRate:kt}})(),ce=ne=>ne?ne<=2?"bg-green-100 text-green-800 border-green-200":ne<=4?"bg-yellow-100 text-yellow-800 border-yellow-200":ne<=6?"bg-orange-100 text-orange-800 border-orange-200":"bg-red-100 text-red-800 border-red-200":"bg-gray-100 text-gray-800 border-gray-200",re=ne=>{switch(ne){case"nizka":return"bg-green-100 text-green-800 border-green-200";case"srednja":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"visoka":return"bg-orange-100 text-orange-800 border-orange-200";case"kriticna":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},X=ne=>{switch(ne){case"aktivno":return"bg-green-100 text-green-800 border-green-200";case"neaktivno":return"bg-gray-100 text-gray-800 border-gray-200";case"suspeneded":return"bg-red-100 text-red-800 border-red-200";case"v-pregledu":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},U=(ne,Re)=>{W({isOpen:!0,type:ne,data:Re}),B(Re||{})},oe=()=>{W({isOpen:!1,type:null}),B({})},xe=async ne=>{S(!0);try{const{data:Re,error:Oe}=await Wl.from("supply_chain_suppliers").insert([{...ne,supplier_id:`SUP-${Date.now()}`,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]).select().single();if(Oe)throw Oe;o(Je=>[Re,...Je]),oe()}catch(Re){console.error("Error creating supplier:",Re),alert("Napaka pri ustvarjanju dobavitelja")}finally{S(!1)}},J=async(ne,Re)=>{S(!0);try{const{data:Oe,error:Je}=await Wl.from("supply_chain_suppliers").update({...Re,updated_at:new Date().toISOString()}).eq("id",ne).select().single();if(Je)throw Je;o(Be=>Be.map(kt=>kt.id===ne?Oe:kt)),oe()}catch(Oe){console.error("Error updating supplier:",Oe),alert("Napaka pri posodabljanju dobavitelja")}finally{S(!1)}},$=async ne=>{if(confirm("Ali ste prepriani, da elite izbrisati tega dobavitelja?"))try{const{error:Re}=await Wl.from("supply_chain_suppliers").delete().eq("id",ne);if(Re)throw Re;o(Oe=>Oe.filter(Je=>Je.id!==ne))}catch(Re){console.error("Error deleting supplier:",Re),alert("Napaka pri brisanju dobavitelja")}},Q=async ne=>{S(!0);try{const{data:Re,error:Oe}=await Wl.from("supply_chain_risk_assessments").insert([{...ne,assessment_id:`AST-${Date.now()}`,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]).select().single();if(Oe)throw Oe;d(Je=>[Re,...Je]),oe()}catch(Re){console.error("Error creating risk assessment:",Re),alert("Napaka pri ustvarjanju ocene tveganja")}finally{S(!1)}},q=async ne=>{S(!0);try{const{data:Re,error:Oe}=await Wl.from("supply_chain_incidents").insert([{...ne,incident_id:`INC-${Date.now()}`,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]).select().single();if(Oe)throw Oe;m(Je=>[Re,...Je]),oe()}catch(Re){console.error("Error creating incident:",Re),alert("Napaka pri ustvarjanju incidenta")}finally{S(!1)}},I=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-text-tertiary text-sm font-medium",children:"Skupaj dobaviteljev"}),e.jsx("p",{className:"text-2xl font-bold text-text-primary",children:te.totalSuppliers})]}),e.jsx(t0,{className:"w-8 h-8 text-accent-primary"})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("span",{className:"text-sm text-text-tertiary",children:[te.criticalSuppliers," kritinih"]})})]}),e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-text-tertiary text-sm font-medium",children:"Visoko tveganje"}),e.jsx("p",{className:"text-2xl font-bold text-text-primary",children:te.highRiskSuppliers})]}),e.jsx(pt,{className:"w-8 h-8 text-red-500"})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("span",{className:"text-sm text-text-tertiary",children:["Od ",te.totalSuppliers," dobaviteljev"]})})]}),e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-text-tertiary text-sm font-medium",children:"Aktivni incidenti"}),e.jsx("p",{className:"text-2xl font-bold text-text-primary",children:te.activeIncidents})]}),e.jsx(er,{className:"w-8 h-8 text-orange-500"})]}),e.jsx("div",{className:"mt-4",children:e.jsx("span",{className:"text-sm text-text-tertiary",children:"Zahtevajo pozornost"})})]}),e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-text-tertiary text-sm font-medium",children:"Skladnost"}),e.jsxs("p",{className:"text-2xl font-bold text-text-primary",children:[te.complianceRate,"%"]})]}),e.jsx(Rt,{className:"w-8 h-8 text-green-500"})]}),e.jsx("div",{className:"mt-4",children:e.jsx("div",{className:"w-full bg-bg-near-black rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${te.complianceRate}%`}})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Pregled tveganj"}),e.jsx("div",{className:"space-y-3",children:[{level:"kritino",count:i.filter(ne=>ne.overall_risk_score&&ne.overall_risk_score>=8).length,color:"bg-red-500"},{level:"visoko",count:i.filter(ne=>ne.overall_risk_score&&ne.overall_risk_score>=6&&ne.overall_risk_score<8).length,color:"bg-orange-500"},{level:"srednje",count:i.filter(ne=>ne.overall_risk_score&&ne.overall_risk_score>=4&&ne.overall_risk_score<6).length,color:"bg-yellow-500"},{level:"nizko",count:i.filter(ne=>ne.overall_risk_score&&ne.overall_risk_score<4).length,color:"bg-green-500"}].map(ne=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-text-secondary capitalize",children:[ne.level," tveganje"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${ne.color}`}),e.jsx("span",{className:"text-text-primary font-medium",children:ne.count})]})]},ne.level))})]}),e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Nedavni incidenti"}),e.jsx("div",{className:"space-y-3",children:p.slice(0,5).map(ne=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-near-black rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-text-primary font-medium text-sm",children:ne.incident_type}),e.jsx("p",{className:"text-text-tertiary text-xs",children:new Date(ne.detection_date).toLocaleDateString("sl-SI")})]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium border ${X(ne.status)}`,children:ne.severity_level})]},ne.id))})]})]}),te.overdueAssessments>0&&e.jsx("div",{className:"bg-orange-100 border border-orange-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(pt,{className:"w-5 h-5 text-orange-600"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-orange-800 font-medium",children:[te.overdueAssessments," dobaviteljev ima prekoraene roke za ocenjevanje tveganj"]}),e.jsx("p",{className:"text-orange-700 text-sm",children:"Preverite in posodobite ocene tveganj."})]})]})})]}),Y=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Upravljanje dobaviteljev"}),e.jsx("p",{className:"text-text-tertiary",children:"Dodajte in upravljajte tretje stranke"})]}),e.jsxs("button",{onClick:()=>U("supplier"),className:"bg-accent-primary hover:bg-accent-primary/90 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[e.jsx(Dt,{className:"w-4 h-4"}),"Dodaj dobavitelja"]})]}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ss,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-text-tertiary w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Iskanje dobaviteljev...",value:g,onChange:ne=>v(ne.target.value),className:"w-full pl-10 pr-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-accent-primary/20 focus:border-accent-primary"})]}),e.jsxs("select",{value:_,onChange:ne=>k(ne.target.value),className:"px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary/20 focus:border-accent-primary",children:[e.jsx("option",{value:"",children:"Vsi statusi"}),e.jsx("option",{value:"aktivno",children:"Aktivno"}),e.jsx("option",{value:"neaktivno",children:"Neaktivno"}),e.jsx("option",{value:"suspeneded",children:"Suspendirano"}),e.jsx("option",{value:"v-pregledu",children:"V pregledu"})]}),e.jsxs("select",{value:P,onChange:ne=>L(ne.target.value),className:"px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary/20 focus:border-accent-primary",children:[e.jsx("option",{value:"",children:"Vse kritinosti"}),e.jsx("option",{value:"nizka",children:"Nizka"}),e.jsx("option",{value:"srednja",children:"Srednja"}),e.jsx("option",{value:"visoka",children:"Visoka"}),e.jsx("option",{value:"kriticna",children:"Kritina"})]})]})}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-near-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:"Dobavitelj"}),e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:"Kontakt"}),e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:"Storitev"}),e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:"Kritinost"}),e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:"Tveganje"}),e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:"Skladnost"}),e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:"Status"}),e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:"Akcije"})]})}),e.jsx("tbody",{children:x?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"p-8 text-center text-text-tertiary",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-accent-primary mx-auto"})})}):i.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"p-8 text-center text-text-tertiary",children:"Ni najdenih dobaviteljev"})}):i.filter(ne=>(_===""||ne.status===_)&&(P===""||ne.criticality_level===P)&&(g===""||ne.company_name.toLowerCase().includes(g.toLowerCase()))).map(ne=>e.jsxs("tr",{className:"border-b border-border-subtle hover:bg-bg-near-black transition-colors",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-text-primary",children:ne.company_name}),e.jsx("div",{className:"text-text-tertiary text-sm",children:ne.supplier_id})]})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-text-primary",children:ne.contact_person}),e.jsx("div",{className:"text-text-tertiary text-sm",children:ne.email})]})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"text-text-primary",children:ne.service_type})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`inline-flex px-2 py-1 rounded-full text-xs font-medium border ${re(ne.criticality_level)}`,children:ne.criticality_level})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`inline-flex px-2 py-1 rounded-full text-xs font-medium border ${ce(ne.overall_risk_score)}`,children:ne.overall_risk_score||"N/A"})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex gap-1",children:[ne.iso27001_certified&&e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded",children:"ISO27001"}),ne.data_protection_compliance&&e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:"GDPR"})]})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`inline-flex px-2 py-1 rounded-full text-xs font-medium border ${X(ne.status)}`,children:ne.status})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>U("supplier",ne),className:"text-accent-primary hover:text-accent-primary/80",children:e.jsx(ar,{className:"w-4 h-4"})}),e.jsx("button",{className:"text-text-tertiary hover:text-text-primary",children:e.jsx(lr,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>$(ne.id),className:"text-red-500 hover:text-red-400",children:e.jsx(pr,{className:"w-4 h-4"})})]})})]},ne.id))})]})})})]}),H=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Ocenjevanje tveganj"}),e.jsx("p",{className:"text-text-tertiary",children:"Upravljajte ocene tveganj dobavnih verig"})]}),e.jsxs("button",{onClick:()=>U("risk-assessment"),className:"bg-accent-primary hover:bg-accent-primary/90 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[e.jsx(Dt,{className:"w-4 h-4"}),"Nova ocena"]})]}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-near-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:"Ocenjevanje"}),e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:"Dobavitelj"}),e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:"Datum"}),e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:"Tip"}),e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:"Tveganje"}),e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:"NIS2"}),e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:"Akcije"})]})}),e.jsx("tbody",{children:c.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"p-8 text-center text-text-tertiary",children:"Ni najdenih ocen tveganj"})}):c.map(ne=>{var Re;return e.jsxs("tr",{className:"border-b border-border-subtle hover:bg-bg-near-black transition-colors",children:[e.jsx("td",{className:"p-4",children:e.jsx("div",{className:"font-medium text-text-primary",children:ne.assessment_id})}),e.jsx("td",{className:"p-4",children:e.jsx("div",{className:"text-text-primary",children:(Re=i.find(Oe=>Oe.id===ne.supplier_id))==null?void 0:Re.company_name})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"text-text-primary",children:new Date(ne.assessment_date).toLocaleDateString("sl-SI")})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"text-text-tertiary",children:ne.assessment_type})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`inline-flex px-2 py-1 rounded-full text-xs font-medium border ${ce(ne.overall_risk_score)}`,children:ne.risk_level})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"text-text-primary",children:ne.nis2_compliance_level})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"text-accent-primary hover:text-accent-primary/80",children:e.jsx(ar,{className:"w-4 h-4"})}),e.jsx("button",{className:"text-text-tertiary hover:text-text-primary",children:e.jsx(lr,{className:"w-4 h-4"})})]})})]},ne.id)})})]})})})]}),he=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Incidenti dobavnih verig"}),e.jsx("p",{className:"text-text-tertiary",children:"Spremljanje in upravljanje incidentov tretjih strank"})]}),e.jsxs("button",{onClick:()=>U("incident"),className:"bg-accent-primary hover:bg-accent-primary/90 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[e.jsx(Dt,{className:"w-4 h-4"}),"Prijavi incident"]})]}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-near-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:"Incident"}),e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:"Dobavitelj"}),e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:"Tip"}),e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:"Resnost"}),e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:"Status"}),e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:"NIS2"}),e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:"Akcije"})]})}),e.jsx("tbody",{children:p.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"p-8 text-center text-text-tertiary",children:"Ni prijavljenih incidentov"})}):p.map(ne=>{var Re;return e.jsxs("tr",{className:"border-b border-border-subtle hover:bg-bg-near-black transition-colors",children:[e.jsxs("td",{className:"p-4",children:[e.jsx("div",{className:"font-medium text-text-primary",children:ne.incident_id}),e.jsxs("div",{className:"text-text-tertiary text-sm truncate max-w-xs",children:[ne.incident_description.substring(0,60),"..."]})]}),e.jsx("td",{className:"p-4",children:e.jsx("div",{className:"text-text-primary",children:(Re=i.find(Oe=>Oe.id===ne.supplier_id))==null?void 0:Re.company_name})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"text-text-primary",children:ne.incident_type})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`inline-flex px-2 py-1 rounded-full text-xs font-medium border ${re(ne.severity_level)}`,children:ne.severity_level})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"text-text-primary",children:ne.status})}),e.jsx("td",{className:"p-4",children:ne.nis2_notifiable&&e.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs rounded",children:"Poroljiv"})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"text-accent-primary hover:text-accent-primary/80",children:e.jsx(ar,{className:"w-4 h-4"})}),e.jsx("button",{className:"text-text-tertiary hover:text-text-primary",children:e.jsx(lr,{className:"w-4 h-4"})})]})})]},ne.id)})})]})})})]}),ge=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Monitoring in nadzor"}),e.jsx("p",{className:"text-text-tertiary",children:"Spremljanje varnosti in uinkovitosti dobavnih verig"})]}),e.jsxs("button",{onClick:()=>alert("Funkcionalnost za nastavitev monitoringa bo implementirana v prihodnji verziji"),className:"bg-accent-primary hover:bg-accent-primary/90 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[e.jsx(fi,{className:"w-4 h-4"}),"Nastavi monitoring"]})]}),e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-8 text-center",children:[e.jsx(lr,{className:"w-16 h-16 text-text-tertiary mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:"Funkcije monitoringa"}),e.jsx("p",{className:"text-text-tertiary",children:"Funkcionalnosti za monitoring bodo implementirane v prihodnji verziji"})]})]}),K=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Narti ukrepov"}),e.jsx("p",{className:"text-text-tertiary",children:"Upravljanje korektivnih in preventivnih ukrepov"})]}),e.jsxs("button",{onClick:()=>alert("Funkcionalnost za narte ukrepov bo implementirana v prihodnji verziji"),className:"bg-accent-primary hover:bg-accent-primary/90 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[e.jsx(Dt,{className:"w-4 h-4"}),"Nov nart"]})]}),e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-8 text-center",children:[e.jsx(Rp,{className:"w-16 h-16 text-text-tertiary mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:"Narti ukrepov"}),e.jsx("p",{className:"text-text-tertiary",children:"Funkcionalnosti za nartovanje ukrepov bodo implementirane v prihodnji verziji"})]})]}),T=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Dokumentacija skladnosti"}),e.jsx("p",{className:"text-text-tertiary",children:"Evidence in dokumenti za NIS 2 skladnost"})]}),e.jsxs("button",{className:"bg-accent-primary hover:bg-accent-primary/90 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[e.jsx(Ir,{className:"w-4 h-4"}),"Izvozi poroilo"]})]}),e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-8 text-center",children:[e.jsx(pl,{className:"w-16 h-16 text-text-tertiary mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:"Skladnost z NIS 2"}),e.jsx("p",{className:"text-text-tertiary",children:"Funkcionalnosti za sledenje skladnosti bodo implementirane v prihodnji verziji"})]})]}),ee=()=>{switch(a){case"dashboard":return I();case"suppliers":return Y();case"risk-assessments":return H();case"incidents":return he();case"monitoring":return ge();case"action-plans":return K();case"compliance":return T();default:return I()}},_e=()=>e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-bg-surface rounded-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-border-subtle",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:F.data?"Uredi dobavitelja":"Dodaj novega dobavitelja"}),e.jsx("button",{onClick:oe,className:"text-text-tertiary hover:text-text-primary",children:""})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Naziv podjetja *"}),e.jsx("input",{type:"text",value:R.company_name||"",onChange:ne=>B({...R,company_name:ne.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary",placeholder:"Vnesite naziv podjetja"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Kontaktna oseba"}),e.jsx("input",{type:"text",value:R.contact_person||"",onChange:ne=>B({...R,contact_person:ne.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary",placeholder:"Ime in priimek"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"E-pota"}),e.jsx("input",{type:"email",value:R.email||"",onChange:ne=>B({...R,email:ne.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary",placeholder:"email@podjetje.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Telefon"}),e.jsx("input",{type:"tel",value:R.phone||"",onChange:ne=>B({...R,phone:ne.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary",placeholder:"+386 XX XXX XXX"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Drava"}),e.jsx("input",{type:"text",value:R.country||"",onChange:ne=>B({...R,country:ne.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary",placeholder:"Slovenija"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Tip storitve"}),e.jsx("input",{type:"text",value:R.service_type||"",onChange:ne=>B({...R,service_type:ne.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary",placeholder:"IT storitve, svetovanje, itd."})]})]}),e.jsxs("div",{className:"border-t border-border-subtle pt-6",children:[e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-4",children:"Informacije o pogodbi"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Zaetek pogodbe"}),e.jsx("input",{type:"date",value:R.contract_start_date||"",onChange:ne=>B({...R,contract_start_date:ne.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Konec pogodbe"}),e.jsx("input",{type:"date",value:R.contract_end_date||"",onChange:ne=>B({...R,contract_end_date:ne.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary"})]})]})]}),e.jsxs("div",{className:"border-t border-border-subtle pt-6",children:[e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-4",children:"Tveganja in skladnost"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Kritinost *"}),e.jsxs("select",{value:R.criticality_level||"srednja",onChange:ne=>B({...R,criticality_level:ne.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary",children:[e.jsx("option",{value:"nizka",children:"Nizka"}),e.jsx("option",{value:"srednja",children:"Srednja"}),e.jsx("option",{value:"visoka",children:"Visoka"}),e.jsx("option",{value:"kriticna",children:"Kritina"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Status *"}),e.jsxs("select",{value:R.status||"aktivno",onChange:ne=>B({...R,status:ne.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary",children:[e.jsx("option",{value:"aktivno",children:"Aktivno"}),e.jsx("option",{value:"neaktivno",children:"Neaktivno"}),e.jsx("option",{value:"suspeneded",children:"Suspendirano"}),e.jsx("option",{value:"v-pregledu",children:"V pregledu"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Ocenitev kibernetske varnosti (1-10)"}),e.jsx("input",{type:"number",min:"1",max:"10",value:R.cybersecurity_risk_score||"",onChange:ne=>B({...R,cybersecurity_risk_score:parseInt(ne.target.value)}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Naslednja ocenitev"}),e.jsx("input",{type:"date",value:R.next_assessment_date||"",onChange:ne=>B({...R,next_assessment_date:ne.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary"})]})]}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:R.iso27001_certified||!1,onChange:ne=>B({...R,iso27001_certified:ne.target.checked}),className:"mr-2"}),e.jsx("span",{className:"text-text-primary",children:"ISO 27001 certificiran"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:R.data_protection_compliance||!1,onChange:ne=>B({...R,data_protection_compliance:ne.target.checked}),className:"mr-2"}),e.jsx("span",{className:"text-text-primary",children:"Skladen z varstvom osebnih podatkov (GDPR in ZVOP-2)"})]})]})]})]}),e.jsxs("div",{className:"p-6 border-t border-border-subtle flex justify-end space-x-4",children:[e.jsx("button",{onClick:oe,className:"px-4 py-2 text-text-tertiary hover:text-text-primary transition-colors",children:"Preklii"}),e.jsx("button",{onClick:()=>{if(!R.company_name){alert("Naziv podjetja je obvezen");return}F.data?J(F.data.id,R):xe(R)},disabled:A,className:"px-6 py-2 bg-accent-primary hover:bg-accent-primary/90 text-white rounded-lg flex items-center gap-2 disabled:opacity-50",children:A?"Shranjujem...":"Shrani"})]})]})}),ke=()=>e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-bg-surface rounded-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-border-subtle",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Nova ocena tveganja"}),e.jsx("button",{onClick:oe,className:"text-text-tertiary hover:text-text-primary",children:""})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Dobavitelj *"}),e.jsxs("select",{value:R.supplier_id||"",onChange:ne=>B({...R,supplier_id:ne.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary",children:[e.jsx("option",{value:"",children:"Izberite dobavitelja"}),i.map(ne=>e.jsx("option",{value:ne.id,children:ne.company_name},ne.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Tip ocenitve *"}),e.jsxs("select",{value:R.assessment_type||"periodic",onChange:ne=>B({...R,assessment_type:ne.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary",children:[e.jsx("option",{value:"initial",children:"Zaetna"}),e.jsx("option",{value:"periodic",children:"Periodina"}),e.jsx("option",{value:"incident-based",children:"Na osnovi incidenta"}),e.jsx("option",{value:"due-diligence",children:"Due diligence"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Datum ocenitve *"}),e.jsx("input",{type:"date",value:R.assessment_date||new Date().toISOString().split("T")[0],onChange:ne=>B({...R,assessment_date:ne.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Ocenil"}),e.jsx("input",{type:"text",value:R.assessed_by||"",onChange:ne=>B({...R,assessed_by:ne.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary",placeholder:"Ime in priimek"})]})]}),e.jsxs("div",{className:"border-t border-border-subtle pt-6",children:[e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-4",children:"Ocene tveganj (1-10)"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Kibernetska varnost"}),e.jsx("input",{type:"number",min:"1",max:"10",value:R.cybersecurity_risk_score||"",onChange:ne=>B({...R,cybersecurity_risk_score:parseInt(ne.target.value)}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Operativno tveganje"}),e.jsx("input",{type:"number",min:"1",max:"10",value:R.operational_risk_score||"",onChange:ne=>B({...R,operational_risk_score:parseInt(ne.target.value)}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Finanno tveganje"}),e.jsx("input",{type:"number",min:"1",max:"10",value:R.financial_risk_score||"",onChange:ne=>B({...R,financial_risk_score:parseInt(ne.target.value)}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Skladnost"}),e.jsx("input",{type:"number",min:"1",max:"10",value:R.compliance_risk_score||"",onChange:ne=>B({...R,compliance_risk_score:parseInt(ne.target.value)}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Kljune ugotovitve"}),e.jsx("textarea",{value:R.key_findings||"",onChange:ne=>B({...R,key_findings:ne.target.value}),rows:4,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary",placeholder:"Opiite kljune ugotovitve ocenitve..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Priporoila"}),e.jsx("textarea",{value:R.recommendations||"",onChange:ne=>B({...R,recommendations:ne.target.value}),rows:4,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary",placeholder:"Opiite priporoila za izboljave..."})]})]}),e.jsxs("div",{className:"p-6 border-t border-border-subtle flex justify-end space-x-4",children:[e.jsx("button",{onClick:oe,className:"px-4 py-2 text-text-tertiary hover:text-text-primary transition-colors",children:"Preklii"}),e.jsx("button",{onClick:()=>{if(!R.supplier_id||!R.assessment_date){alert("Izberite dobavitelja in vnesite datum ocenitve");return}Q(R)},disabled:A,className:"px-6 py-2 bg-accent-primary hover:bg-accent-primary/90 text-white rounded-lg flex items-center gap-2 disabled:opacity-50",children:A?"Shranjujem...":"Shrani"})]})]})}),ue=()=>e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-bg-surface rounded-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-border-subtle",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Prijavi incident"}),e.jsx("button",{onClick:oe,className:"text-text-tertiary hover:text-text-primary",children:""})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Dobavitelj *"}),e.jsxs("select",{value:R.supplier_id||"",onChange:ne=>B({...R,supplier_id:ne.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary",children:[e.jsx("option",{value:"",children:"Izberite dobavitelja"}),i.map(ne=>e.jsx("option",{value:ne.id,children:ne.company_name},ne.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Tip incidenta *"}),e.jsxs("select",{value:R.incident_type||"",onChange:ne=>B({...R,incident_type:ne.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary",children:[e.jsx("option",{value:"",children:"Izberite tip"}),e.jsx("option",{value:"data-breach",children:"Kritev podatkov"}),e.jsx("option",{value:"service-disruption",children:"Motnja storitve"}),e.jsx("option",{value:"security-incident",children:"Varnostni incident"}),e.jsx("option",{value:"compliance-violation",children:"Kritev skladnosti"}),e.jsx("option",{value:"third-party-breach",children:"Kritev tretje strani"}),e.jsx("option",{value:"malware-detection",children:"Odkritje zlonamerne programske opreme"}),e.jsx("option",{value:"unauthorized-access",children:"Neavtoriziran dostop"}),e.jsx("option",{value:"system-compromise",children:"Kompromitacija sistema"}),e.jsx("option",{value:"business-continuity",children:"Poslovna kontinuiteta"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Datum odkritja *"}),e.jsx("input",{type:"datetime-local",value:R.detection_date||new Date().toISOString().slice(0,16),onChange:ne=>B({...R,detection_date:ne.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Resnost *"}),e.jsxs("select",{value:R.severity_level||"srednja",onChange:ne=>B({...R,severity_level:ne.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary",children:[e.jsx("option",{value:"nizka",children:"Nizka"}),e.jsx("option",{value:"srednja",children:"Srednja"}),e.jsx("option",{value:"visoka",children:"Visoka"}),e.jsx("option",{value:"kritina",children:"Kritina"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Opis incidenta *"}),e.jsx("textarea",{value:R.incident_description||"",onChange:ne=>B({...R,incident_description:ne.target.value}),rows:4,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary",placeholder:"Podroben opis incidenta..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Ocenitev vpliva"}),e.jsx("textarea",{value:R.impact_assessment||"",onChange:ne=>B({...R,impact_assessment:ne.target.value}),rows:3,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary",placeholder:"Opiite vpliv incidenta..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Dodeljen"}),e.jsx("input",{type:"text",value:R.assigned_to||"",onChange:ne=>B({...R,assigned_to:ne.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary",placeholder:"Ime in priimek odgovorne osebe"})]}),e.jsxs("div",{className:"border-t border-border-subtle pt-6",children:[e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-4",children:"NIS 2 obveznosti"}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:R.nis2_notifiable||!1,onChange:ne=>B({...R,nis2_notifiable:ne.target.checked}),className:"mr-2"}),e.jsx("span",{className:"text-text-primary",children:"Incident je potrebno prijaviti pristojnim organom (NIS 2)"})]})]})]}),e.jsxs("div",{className:"p-6 border-t border-border-subtle flex justify-end space-x-4",children:[e.jsx("button",{onClick:oe,className:"px-4 py-2 text-text-tertiary hover:text-text-primary transition-colors",children:"Preklii"}),e.jsx("button",{onClick:()=>{if(!R.supplier_id||!R.incident_type||!R.incident_description){alert("Izpolnite vsa obvezna polja");return}q(R)},disabled:A,className:"px-6 py-2 bg-accent-primary hover:bg-accent-primary/90 text-white rounded-lg flex items-center gap-2 disabled:opacity-50",children:A?"Shranjujem...":"Shrani"})]})]})}),je=()=>{if(!F.isOpen)return null;switch(F.type){case"supplier":return _e();case"risk-assessment":return ke();case"incident":return ue();default:return null}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Dobavne verige"}),e.jsx("p",{className:"text-text-tertiary mt-1",children:"Upravljanje tveganj in skladnosti dobavnih verig po NIS 2 direktivi"})]}),e.jsx("div",{className:"border-b border-border-subtle",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:C.map(ne=>{const Re=ne.icon;return e.jsxs("button",{onClick:()=>n(ne.id),className:`
                  group inline-flex items-center py-2 px-1 border-b-2 font-medium text-sm transition-colors
                  ${a===ne.id?"border-accent-primary text-accent-primary":"border-transparent text-text-tertiary hover:text-text-secondary hover:border-border-subtle"}
                `,children:[e.jsx(Re,{className:`
                  -ml-0.5 mr-2 h-5 w-5
                  ${a===ne.id?"text-accent-primary":"text-text-tertiary group-hover:text-text-secondary"}
                `}),ne.label]},ne.id)})})}),ee(),je()]})}const mC="https://ckxlbiiirfdogobccmjs.supabase.co",hC="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNreGxiaWlpcmZkb2dvYmNjbWpzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE4NjI5NjIsImV4cCI6MjA3NzQzODk2Mn0.Y8T0bCsL5t_9u71z-yHYxrdyl4rqPN3fUMBg9k-p_TA",va=rd(mC,hC);function xC({setCurrentPage:s}){const{t}=et(),[r,a]=z.useState({activeTab:"overview",responsibilityOfficers:[],policyApprovals:[],decisionLog:[],employeeCompetency:[],loading:!0,searchTerm:"",selectedFilter:"all",showAddModal:!1,selectedItem:null,modalType:""});z.useEffect(()=>{n("overview")},[]);const n=async A=>{a(S=>({...S,loading:!0}));try{let S=[];switch(A){case"overview":await Promise.all([i(),o(),c(),d()]);break;case"officers":S=await i();break;case"policies":S=await o();break;case"decisions":S=await c();break;case"competency":S=await d();break}}catch(S){console.error("Error loading data:",S)}finally{a(S=>({...S,loading:!1}))}},i=async()=>{const{data:A,error:S}=await va.from("responsibility_officers").select("*").order("created_at",{ascending:!1});if(S)throw S;const C=[{id:"1",identification_code:"OFF-2024-001",full_name:"Dr. Marko Kova",position_title:"Vodja kibernetske varnosti",email:"marko.kovac@company.si",role_type:"Vodja varnosti",status:"Aktiven",nis2_training_completed:!0,nis2_awareness_level:"Strokovna",decision_authority_level:"Strateke odloitve",active_from:"2024-01-15"},{id:"2",identification_code:"OFF-2024-002",full_name:"Ana Plans",position_title:"Direktorica informacijske tehnologije",email:"ana.plans@company.si",role_type:"CIO",status:"Aktiven",nis2_training_completed:!0,nis2_awareness_level:"Napredna",decision_authority_level:"Operativne odloitve",active_from:"2023-11-20"},{id:"3",identification_code:"OFF-2024-003",full_name:"Milan Krek",position_title:"Pooblaenec za varstvo podatkov",email:"milan.krek@company.si",role_type:"DPO",status:"Aktiven",nis2_training_completed:!0,nis2_awareness_level:"Strokovna",decision_authority_level:"Taktine odloitve",active_from:"2024-03-01"},{id:"4",identification_code:"OFF-2024-004",full_name:"Petra Mlakar",position_title:"Vodja operacij",email:"petra.mlakar@company.si",role_type:"Vodja operacij",status:"V izpostavitvi",nis2_training_completed:!1,nis2_awareness_level:"Srednja",decision_authority_level:"Taktine odloitve",active_from:"2024-06-01"},{id:"5",identification_code:"OFF-2024-005",full_name:"Toma Vesel",position_title:"Izvrni direktor",email:"tomaz.vesel@company.si",role_type:"CEO",status:"Aktiven",nis2_training_completed:!0,nis2_awareness_level:"Napredna",decision_authority_level:"Strateke odloitve",active_from:"2022-01-10"}];return!A||A.length===0?(a(O=>({...O,responsibilityOfficers:C})),C):(a(O=>({...O,responsibilityOfficers:A||[]})),A||[])},o=async()=>{const{data:A,error:S}=await va.from("policy_approvals").select("*").order("created_at",{ascending:!1});if(S)throw S;const C=[{id:"1",document_id:"POL-2024-001",document_name:"Varnostna politika informacijskih sistemov",document_type:"Varnostna politika",approval_status:"Potrjeno",compliance_status:"Skladno",effective_date:"2024-01-15",next_review_date:"2025-01-15"},{id:"2",document_id:"POL-2024-002",document_name:"Politika upravljanja dostopa",document_type:"Politika upravljanja dostopa",approval_status:"V potrjevanju",compliance_status:"V pregledu",effective_date:"2024-11-01",next_review_date:"2025-11-01"},{id:"3",document_id:"POL-2024-003",document_name:"Incidentni odzivni nart",document_type:"Incidentna politika",approval_status:"Potrjeno",compliance_status:"Skladno",effective_date:"2024-03-01",next_review_date:"2025-03-01"},{id:"4",document_id:"POL-2024-004",document_name:"Politika varstva osebnih podatkov",document_type:"Politika varstva podatkov",approval_status:"Zavrnjeno",compliance_status:"Neskladno",effective_date:"2024-10-01",next_review_date:"2025-10-01"},{id:"5",document_id:"POL-2024-005",document_name:"Nart upravljanja tveganj",document_type:"Upravljanje tveganj",approval_status:"V potrjevanju",compliance_status:"Delno skladno",effective_date:"2024-11-15",next_review_date:"2025-11-15"}];return!A||A.length===0?(a(O=>({...O,policyApprovals:C})),C):(a(O=>({...O,policyApprovals:A||[]})),A||[])},c=async()=>{const{data:A,error:S}=await va.from("decision_log").select("*").order("decision_date",{ascending:!1});if(S)throw S;const C=[{id:"1",decision_id:"DEC-2024-001",decision_title:"Implementacija dvofaktorske avtentikacije",decision_category:"Varnostna odloitev",decision_status:"Sprejeta",decision_date:"2024-10-15",implementation_status:"Implementirano"},{id:"2",decision_id:"DEC-2024-002",decision_title:"Nakup naprednih SIEM orodij",decision_category:"Investicijska odloitev",decision_status:"Sprejeta",decision_date:"2024-09-28",implementation_status:"V implementaciji"},{id:"3",decision_id:"DEC-2024-003",decision_title:"Prenova varnostne politike",decision_category:"Skladnostna odloitev",decision_status:"V preuevanju",decision_date:"2024-11-01",implementation_status:"Nezaeto"},{id:"4",decision_id:"DEC-2024-004",decision_title:"Selitev kritinih sistemov v oblak",decision_category:"Strateka odloitev",decision_status:"Zavrnjena",decision_date:"2024-08-20",implementation_status:"Zamrznjeno"},{id:"5",decision_id:"DEC-2024-005",decision_title:"Avtomatizacija varnostnih testov",decision_category:"Operativna odloitev",decision_status:"Sprejeta",decision_date:"2024-10-30",implementation_status:"V implementaciji"}];return!A||A.length===0?(a(O=>({...O,decisionLog:C})),C):(a(O=>({...O,decisionLog:A||[]})),A||[])},d=async()=>{const{data:A,error:S}=await va.from("employee_competency").select("*").order("created_at",{ascending:!1});if(S)throw S;const C=[{id:"1",employee_id:"EMP-001",full_name:"Luka Potonik",department:"Informacijska tehnologija",role_category:"Tehnina osebje",nis2_awareness_training_completed:!0,overall_competency_level:"Napredni",security_awareness_level:"Napredna",next_training_due_date:"2025-03-15"},{id:"2",employee_id:"EMP-002",full_name:"Barbara Zorman",department:"loveki viri",role_category:"Zaposleni",nis2_awareness_training_completed:!0,overall_competency_level:"Srednji",security_awareness_level:"Srednja",next_training_due_date:"2025-06-20"},{id:"3",employee_id:"EMP-003",full_name:"Urka Goriek",department:"Informacijska tehnologija",role_category:"Kljuni upravitelj",nis2_awareness_training_completed:!0,overall_competency_level:"Ekspert",security_awareness_level:"Kritina",next_training_due_date:"2025-01-10"},{id:"4",employee_id:"EMP-004",full_name:"Peter Bergant",department:"Operacije",role_category:"Zaposleni",nis2_awareness_training_completed:!1,overall_competency_level:"Zaetnik",security_awareness_level:"Osnovna",next_training_due_date:"2024-12-01"},{id:"5",employee_id:"EMP-005",full_name:"Katja Horvat",department:"Pravne zadeve",role_category:"Management",nis2_awareness_training_completed:!0,overall_competency_level:"Napredni",security_awareness_level:"Napredna",next_training_due_date:"2025-04-25"}];return!A||A.length===0?(a(O=>({...O,employeeCompetency:C})),C):(a(O=>({...O,employeeCompetency:A||[]})),A||[])},p=A=>{a(S=>({...S,showAddModal:!0,modalType:A,selectedItem:null}))},m=(A,S)=>{a(C=>({...C,showAddModal:!0,modalType:A,selectedItem:S}))},x=async(A,S)=>{if(confirm("Ali ste prepriani, da elite izbrisati ta element?"))try{const C=b(A),{error:O}=await va.from(C).delete().eq("id",S);if(O)throw O;await n(r.activeTab),alert("Element je bil uspeno izbrisan.")}catch(C){console.error("Error deleting item:",C),alert("Prilo je do napake pri brisanju elementa.")}},b=A=>({officer:"responsibility_officers",policy:"policy_approvals",decision:"decision_log",competency:"employee_competency"})[A]||"",h=async A=>{var S;try{if(r.selectedItem){const{error:C}=await va.from("responsibility_officers").update(A).eq("id",r.selectedItem.id);if(C)throw C}else{const{error:C}=await va.from("responsibility_officers").insert([{...A,user_id:(S=(await va.auth.getUser()).data.user)==null?void 0:S.id}]);if(C)throw C}await n(r.activeTab),a(C=>({...C,showAddModal:!1,selectedItem:null}))}catch(C){console.error("Error saving officer:",C),alert("Prilo je do napake pri shranjevanju odgovorne osebe.")}},j=async A=>{var S;try{if(r.selectedItem){const{error:C}=await va.from("policy_approvals").update(A).eq("id",r.selectedItem.id);if(C)throw C}else{const{error:C}=await va.from("policy_approvals").insert([{...A,user_id:(S=(await va.auth.getUser()).data.user)==null?void 0:S.id}]);if(C)throw C}await n(r.activeTab),a(C=>({...C,showAddModal:!1,selectedItem:null}))}catch(C){console.error("Error saving policy:",C),alert("Prilo je do napake pri shranjevanju politike.")}},g=async A=>{var S;try{if(r.selectedItem){const{error:C}=await va.from("decision_log").update(A).eq("id",r.selectedItem.id);if(C)throw C}else{const{error:C}=await va.from("decision_log").insert([{...A,user_id:(S=(await va.auth.getUser()).data.user)==null?void 0:S.id}]);if(C)throw C}await n(r.activeTab),a(C=>({...C,showAddModal:!1,selectedItem:null}))}catch(C){console.error("Error saving decision:",C),alert("Prilo je do napake pri shranjevanju odloitve.")}},v=async A=>{var S;try{if(r.selectedItem){const{error:C}=await va.from("employee_competency").update(A).eq("id",r.selectedItem.id);if(C)throw C}else{const{error:C}=await va.from("employee_competency").insert([{...A,user_id:(S=(await va.auth.getUser()).data.user)==null?void 0:S.id}]);if(C)throw C}await n(r.activeTab),a(C=>({...C,showAddModal:!1,selectedItem:null}))}catch(C){console.error("Error saving competency:",C),alert("Prilo je do napake pri shranjevanju usposobljenosti.")}},_=(A,S)=>{const C={default:{active:{bg:"bg-green-500/20",text:"text-green-400",icon:Rt},inactive:{bg:"bg-gray-500/20",text:"text-gray-400",icon:Ss},pending:{bg:"bg-yellow-500/20",text:"text-yellow-400",icon:cs}},officers:{Aktiven:{bg:"bg-green-500/20",text:"text-green-400",icon:Rt},Neaktiven:{bg:"bg-gray-500/20",text:"text-gray-400",icon:Ss},"V izpostavitvi":{bg:"bg-orange-500/20",text:"text-orange-400",icon:pt}},policies:{Potrjeno:{bg:"bg-green-500/20",text:"text-green-400",icon:Rt},"V potrjevanju":{bg:"bg-yellow-500/20",text:"text-yellow-400",icon:cs},Zavrnjeno:{bg:"bg-red-500/20",text:"text-red-400",icon:Ss}},decisions:{Sprejeta:{bg:"bg-green-500/20",text:"text-green-400",icon:Rt},"V preuevanju":{bg:"bg-yellow-500/20",text:"text-yellow-400",icon:cs},Implementirano:{bg:"bg-blue-500/20",text:"text-blue-400",icon:Mp}}},O=C[S]||C.default,Z=O[A]||O["V potrjevanju"],te=Z.icon;return e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${Z.bg} ${Z.text}`,children:[e.jsx(te,{className:"w-3 h-3"}),A]})},k=()=>{const A={totalOfficers:r.responsibilityOfficers.length,activeOfficers:r.responsibilityOfficers.filter(S=>S.status==="Aktiven").length,approvedPolicies:r.policyApprovals.filter(S=>S.approval_status==="Potrjeno").length,pendingPolicies:r.policyApprovals.filter(S=>S.approval_status==="V potrjevanju").length,totalDecisions:r.decisionLog.length,implementedDecisions:r.decisionLog.filter(S=>S.implementation_status==="Implementirano").length,trainedEmployees:r.employeeCompetency.filter(S=>S.nis2_awareness_training_completed).length,overdueTraining:r.employeeCompetency.filter(S=>S.next_training_due_date&&new Date(S.next_training_due_date)<new Date).length};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-text-tertiary text-body-sm",children:"Skupaj odgovornih oseb"}),e.jsx("p",{className:"text-3xl font-bold text-text-primary mt-1",children:A.totalOfficers}),e.jsxs("p",{className:"text-body-sm text-green-400 mt-1",children:[A.activeOfficers," aktivnih"]})]}),e.jsx("div",{className:"w-12 h-12 bg-blue-500/20 rounded-lg flex items-center justify-center",children:e.jsx(Fa,{className:"w-6 h-6 text-blue-400"})})]})}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-text-tertiary text-body-sm",children:"Potrjene politike"}),e.jsx("p",{className:"text-3xl font-bold text-text-primary mt-1",children:A.approvedPolicies}),e.jsxs("p",{className:"text-body-sm text-yellow-400 mt-1",children:[A.pendingPolicies," akajo"]})]}),e.jsx("div",{className:"w-12 h-12 bg-green-500/20 rounded-lg flex items-center justify-center",children:e.jsx(xi,{className:"w-6 h-6 text-green-400"})})]})}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-text-tertiary text-body-sm",children:"Sprejete odloitve"}),e.jsx("p",{className:"text-3xl font-bold text-text-primary mt-1",children:A.totalDecisions}),e.jsxs("p",{className:"text-body-sm text-green-400 mt-1",children:[A.implementedDecisions," izvedenih"]})]}),e.jsx("div",{className:"w-12 h-12 bg-purple-500/20 rounded-lg flex items-center justify-center",children:e.jsx(ul,{className:"w-6 h-6 text-purple-400"})})]})}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-text-tertiary text-body-sm",children:"Usposobljeni zaposleni"}),e.jsx("p",{className:"text-3xl font-bold text-text-primary mt-1",children:A.trainedEmployees}),e.jsxs("p",{className:"text-body-sm text-red-400 mt-1",children:[A.overdueTraining," zapadlo"]})]}),e.jsx("div",{className:"w-12 h-12 bg-orange-500/20 rounded-lg flex items-center justify-center",children:e.jsx(Ab,{className:"w-6 h-6 text-orange-400"})})]})})]}),e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Hitri ukrepi"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("button",{onClick:()=>p("officer"),className:"flex items-center gap-3 p-4 bg-bg-surface-hover border border-border-subtle rounded-lg hover:bg-bg-near-black transition-colors",children:[e.jsx(xg,{className:"w-5 h-5 text-blue-400"}),e.jsx("span",{className:"text-body-sm font-medium",children:"Dodaj odgovorno osebo"})]}),e.jsxs("button",{onClick:()=>p("policy"),className:"flex items-center gap-3 p-4 bg-bg-surface-hover border border-border-subtle rounded-lg hover:bg-bg-near-black transition-colors",children:[e.jsx(xi,{className:"w-5 h-5 text-green-400"}),e.jsx("span",{className:"text-body-sm font-medium",children:"Odobri politiko"})]}),e.jsxs("button",{onClick:()=>p("decision"),className:"flex items-center gap-3 p-4 bg-bg-surface-hover border border-border-subtle rounded-lg hover:bg-bg-near-black transition-colors",children:[e.jsx(ul,{className:"w-5 h-5 text-purple-400"}),e.jsx("span",{className:"text-body-sm font-medium",children:"Evidentiraj odloitev"})]}),e.jsxs("button",{onClick:()=>p("competency"),className:"flex items-center gap-3 p-4 bg-bg-surface-hover border border-border-subtle rounded-lg hover:bg-bg-near-black transition-colors",children:[e.jsx(pl,{className:"w-5 h-5 text-orange-400"}),e.jsx("span",{className:"text-body-sm font-medium",children:"Spremljaj usposobljenost"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Nedavne odloitve"}),e.jsx("div",{className:"space-y-3",children:r.decisionLog.slice(0,5).map(S=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-surface-hover rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-text-primary",children:S.decision_title}),e.jsx("p",{className:"text-body-sm text-text-tertiary",children:S.decision_date})]}),_(S.decision_status,"decisions")]},S.id))})]}),e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Potrjene politike"}),e.jsx("div",{className:"space-y-3",children:r.policyApprovals.filter(S=>S.approval_status==="Potrjeno").slice(0,5).map(S=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-surface-hover rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-text-primary",children:S.document_name}),e.jsxs("p",{className:"text-body-sm text-text-tertiary",children:["Do: ",S.next_review_date]})]}),_(S.approval_status,"policies")]},S.id))})]})]})]})},P=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Odgovorne osebe"}),e.jsxs("button",{onClick:()=>p("officer"),className:"flex items-center gap-2 bg-accent-primary text-white px-4 py-2 rounded-lg hover:bg-accent-primary/90 transition-colors",children:[e.jsx(Dt,{className:"w-4 h-4"}),"Dodaj osebo"]})]}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-surface-hover",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-4 text-body-sm font-medium text-text-tertiary",children:"Oseba"}),e.jsx("th",{className:"text-left p-4 text-body-sm font-medium text-text-tertiary",children:"Vloga"}),e.jsx("th",{className:"text-left p-4 text-body-sm font-medium text-text-tertiary",children:"Status"}),e.jsx("th",{className:"text-left p-4 text-body-sm font-medium text-text-tertiary",children:"Usposabljanje"}),e.jsx("th",{className:"text-left p-4 text-body-sm font-medium text-text-tertiary",children:"Pooblastila"}),e.jsx("th",{className:"text-left p-4 text-body-sm font-medium text-text-tertiary",children:"Akcije"})]})}),e.jsx("tbody",{children:r.responsibilityOfficers.map(A=>e.jsxs("tr",{className:"border-t border-border-subtle hover:bg-bg-surface-hover",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-text-primary",children:A.full_name}),e.jsx("p",{className:"text-body-sm text-text-tertiary",children:A.position_title}),e.jsx("p",{className:"text-body-sm text-text-tertiary",children:A.email})]})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-500/20 text-blue-400",children:A.role_type.toUpperCase()})}),e.jsx("td",{className:"p-4",children:_(A.status,"officers")}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[A.nis2_training_completed?e.jsx(Rt,{className:"w-4 h-4 text-green-400"}):e.jsx(Ss,{className:"w-4 h-4 text-red-400"}),e.jsx("span",{className:"text-body-sm",children:A.nis2_awareness_level})]})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-500/20 text-purple-400",children:A.decision_authority_level})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>m("officer",A),className:"p-1 text-blue-400 hover:text-blue-300 transition-colors",children:e.jsx(ar,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>x("officer",A.id),className:"p-1 text-red-400 hover:text-red-300 transition-colors",children:e.jsx(pr,{className:"w-4 h-4"})})]})})]},A.id))})]})})})]}),L=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Potrjevanje politik"}),e.jsxs("button",{onClick:()=>p("policy"),className:"flex items-center gap-2 bg-accent-primary text-white px-4 py-2 rounded-lg hover:bg-accent-primary/90 transition-colors",children:[e.jsx(Dt,{className:"w-4 h-4"}),"Nova politika"]})]}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-surface-hover",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-4 text-body-sm font-medium text-text-tertiary",children:"Dokument"}),e.jsx("th",{className:"text-left p-4 text-body-sm font-medium text-text-tertiary",children:"Tip"}),e.jsx("th",{className:"text-left p-4 text-body-sm font-medium text-text-tertiary",children:"Status"}),e.jsx("th",{className:"text-left p-4 text-body-sm font-medium text-text-tertiary",children:"Skladnost"}),e.jsx("th",{className:"text-left p-4 text-body-sm font-medium text-text-tertiary",children:"Veljavno do"}),e.jsx("th",{className:"text-left p-4 text-body-sm font-medium text-text-tertiary",children:"Akcije"})]})}),e.jsx("tbody",{children:r.policyApprovals.map(A=>e.jsxs("tr",{className:"border-t border-border-subtle hover:bg-bg-surface-hover",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-text-primary",children:A.document_name}),e.jsx("p",{className:"text-body-sm text-text-tertiary",children:A.document_id})]})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-500/20 text-gray-400",children:A.document_type})}),e.jsx("td",{className:"p-4",children:_(A.approval_status,"policies")}),e.jsx("td",{className:"p-4",children:_(A.compliance_status,"default")}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"text-body-sm",children:A.next_review_date})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>m("policy",A),className:"p-1 text-blue-400 hover:text-blue-300 transition-colors",children:e.jsx(ar,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>x("policy",A.id),className:"p-1 text-red-400 hover:text-red-300 transition-colors",children:e.jsx(pr,{className:"w-4 h-4"})})]})})]},A.id))})]})})})]}),F=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Dnevnik odloitev"}),e.jsxs("button",{onClick:()=>p("decision"),className:"flex items-center gap-2 bg-accent-primary text-white px-4 py-2 rounded-lg hover:bg-accent-primary/90 transition-colors",children:[e.jsx(Dt,{className:"w-4 h-4"}),"Nova odloitev"]})]}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-surface-hover",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-4 text-body-sm font-medium text-text-tertiary",children:"Odloitev"}),e.jsx("th",{className:"text-left p-4 text-body-sm font-medium text-text-tertiary",children:" Kategorija"}),e.jsx("th",{className:"text-left p-4 text-body-sm font-medium text-text-tertiary",children:"Datum"}),e.jsx("th",{className:"text-left p-4 text-body-sm font-medium text-text-tertiary",children:"Status"}),e.jsx("th",{className:"text-left p-4 text-body-sm font-medium text-text-tertiary",children:"Izvedba"}),e.jsx("th",{className:"text-left p-4 text-body-sm font-medium text-text-tertiary",children:"Akcije"})]})}),e.jsx("tbody",{children:r.decisionLog.map(A=>e.jsxs("tr",{className:"border-t border-border-subtle hover:bg-bg-surface-hover",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-text-primary",children:A.decision_title}),e.jsx("p",{className:"text-body-sm text-text-tertiary",children:A.decision_id})]})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-500/20 text-purple-400",children:A.decision_category})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"text-body-sm",children:A.decision_date})}),e.jsx("td",{className:"p-4",children:_(A.decision_status,"decisions")}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"text-body-sm",children:A.implementation_status})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>m("decision",A),className:"p-1 text-blue-400 hover:text-blue-300 transition-colors",children:e.jsx(ar,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>x("decision",A.id),className:"p-1 text-red-400 hover:text-red-300 transition-colors",children:e.jsx(pr,{className:"w-4 h-4"})})]})})]},A.id))})]})})})]}),W=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Usposobljenost zaposlenih"}),e.jsxs("button",{onClick:()=>p("competency"),className:"flex items-center gap-2 bg-accent-primary text-white px-4 py-2 rounded-lg hover:bg-accent-primary/90 transition-colors",children:[e.jsx(Dt,{className:"w-4 h-4"}),"Dodaj zaposlenega"]})]}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-surface-hover",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-4 text-body-sm font-medium text-text-tertiary",children:"Zaposleni"}),e.jsx("th",{className:"text-left p-4 text-body-sm font-medium text-text-tertiary",children:"Vloga"}),e.jsx("th",{className:"text-left p-4 text-body-sm font-medium text-text-tertiary",children:"NIS 2 usposabljanje"}),e.jsx("th",{className:"text-left p-4 text-body-sm font-medium text-text-tertiary",children:"Raven zavedanja"}),e.jsx("th",{className:"text-left p-4 text-body-sm font-medium text-text-tertiary",children:"Naslednje usposabljanje"}),e.jsx("th",{className:"text-left p-4 text-body-sm font-medium text-text-tertiary",children:"Akcije"})]})}),e.jsx("tbody",{children:r.employeeCompetency.map(A=>e.jsxs("tr",{className:"border-t border-border-subtle hover:bg-bg-surface-hover",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-text-primary",children:A.full_name}),e.jsx("p",{className:"text-body-sm text-text-tertiary",children:A.department}),e.jsx("p",{className:"text-body-sm text-text-tertiary",children:A.employee_id})]})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-500/20 text-blue-400",children:A.role_category})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[A.nis2_awareness_training_completed?e.jsx(Rt,{className:"w-4 h-4 text-green-400"}):e.jsx(Ss,{className:"w-4 h-4 text-red-400"}),e.jsx("span",{className:"text-body-sm",children:A.nis2_awareness_training_completed?"Konano":"Ni konano"})]})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${A.security_awareness_level==="Kritina"?"bg-green-500/20 text-green-400":A.security_awareness_level==="Napredna"?"bg-blue-500/20 text-blue-400":A.security_awareness_level==="Srednja"?"bg-yellow-500/20 text-yellow-400":"bg-red-500/20 text-red-400"}`,children:A.security_awareness_level})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"text-body-sm",children:A.next_training_due_date})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>m("competency",A),className:"p-1 text-blue-400 hover:text-blue-300 transition-colors",children:e.jsx(ar,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>x("competency",A.id),className:"p-1 text-red-400 hover:text-red-300 transition-colors",children:e.jsx(pr,{className:"w-4 h-4"})})]})})]},A.id))})]})})})]}),R=[{id:"overview",label:"Pregled",icon:Bi},{id:"officers",label:"Odgovorne osebe",icon:Fa},{id:"policies",label:"Potrjevanje politik",icon:xi},{id:"decisions",label:"Dnevnik odloitev",icon:ul},{id:"competency",label:"Usposobljenost",icon:Ab}],B=()=>{switch(r.activeTab){case"overview":return k();case"officers":return P();case"policies":return L();case"decisions":return F();case"competency":return W();default:return k()}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(Mt,{className:"w-8 h-8 text-accent-primary"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Evidenca odgovornih oseb"}),e.jsx("p",{className:"text-text-tertiary",children:"Upravljanje odgovornosti vodstva po NIS 2 direktivi"})]})]}),e.jsx("div",{className:"flex flex-wrap gap-1 bg-bg-near-black p-1 rounded-lg",children:R.map(A=>{const S=A.icon;return e.jsxs("button",{onClick:()=>{a(C=>({...C,activeTab:A.id})),n(A.id)},className:`flex items-center gap-2 px-4 py-2 rounded-lg text-body-sm font-medium transition-colors ${r.activeTab===A.id?"bg-accent-primary text-white":"text-text-tertiary hover:text-text-primary hover:bg-bg-surface-hover"}`,children:[e.jsx(S,{className:"w-4 h-4"}),A.label]},A.id)})})]}),r.loading?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-accent-primary"})}):B(),r.showAddModal&&r.modalType==="officer"&&e.jsx(fC,{isOpen:r.showAddModal,onClose:()=>a(A=>({...A,showAddModal:!1,selectedItem:null})),onSave:h,officer:r.selectedItem}),r.showAddModal&&r.modalType==="policy"&&e.jsx(bC,{isOpen:r.showAddModal,onClose:()=>a(A=>({...A,showAddModal:!1,selectedItem:null})),onSave:j,policy:r.selectedItem}),r.showAddModal&&r.modalType==="decision"&&e.jsx(gC,{isOpen:r.showAddModal,onClose:()=>a(A=>({...A,showAddModal:!1,selectedItem:null})),onSave:g,decision:r.selectedItem}),r.showAddModal&&r.modalType==="competency"&&e.jsx(vC,{isOpen:r.showAddModal,onClose:()=>a(A=>({...A,showAddModal:!1,selectedItem:null})),onSave:v,competency:r.selectedItem})]})}function fC({isOpen:s,onClose:t,onSave:r,officer:a}){const[n,i]=z.useState({identification_code:"",full_name:"",position_title:"",email:"",role_type:"",status:"",nis2_training_completed:!1,nis2_awareness_level:"",decision_authority_level:"",active_from:""});z.useEffect(()=>{i(a?{identification_code:a.identification_code||"",full_name:a.full_name||"",position_title:a.position_title||"",email:a.email||"",role_type:a.role_type||"",status:a.status||"",nis2_training_completed:a.nis2_training_completed||!1,nis2_awareness_level:a.nis2_awareness_level||"",decision_authority_level:a.decision_authority_level||"",active_from:a.active_from||""}:{identification_code:"",full_name:"",position_title:"",email:"",role_type:"",status:"",nis2_training_completed:!1,nis2_awareness_level:"",decision_authority_level:"",active_from:""})},[a]);const o=c=>{c.preventDefault(),r(n)};return s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-6",children:a?"Uredi odgovorno osebo":"Dodaj novo odgovorno osebo"}),e.jsxs("form",{onSubmit:o,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Identifikacijska koda *"}),e.jsx("input",{type:"text",value:n.identification_code,onChange:c=>i(d=>({...d,identification_code:c.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Polno ime *"}),e.jsx("input",{type:"text",value:n.full_name,onChange:c=>i(d=>({...d,full_name:c.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Naziv delovnega mesta *"}),e.jsx("input",{type:"text",value:n.position_title,onChange:c=>i(d=>({...d,position_title:c.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"E-pota *"}),e.jsx("input",{type:"email",value:n.email,onChange:c=>i(d=>({...d,email:c.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Tip vloge *"}),e.jsxs("select",{value:n.role_type,onChange:c=>i(d=>({...d,role_type:c.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0,children:[e.jsx("option",{value:"",children:"Izberi tip vloge"}),e.jsx("option",{value:"Vodja varnosti",children:"Vodja varnosti"}),e.jsx("option",{value:"CEO",children:"Direktor (CEO)"}),e.jsx("option",{value:"CIO",children:"Vodja informacijske tehnologije (CIO)"}),e.jsx("option",{value:"DPO",children:"Pooblaenec za varstvo podatkov (DPO)"}),e.jsx("option",{value:"Vodja operacij",children:"Vodja operacij"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Status *"}),e.jsxs("select",{value:n.status,onChange:c=>i(d=>({...d,status:c.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0,children:[e.jsx("option",{value:"",children:"Izberi status"}),e.jsx("option",{value:"Aktiven",children:"Aktiven"}),e.jsx("option",{value:"Neaktiven",children:"Neaktiven"}),e.jsx("option",{value:"V izpostavitvi",children:"V izpostavitvi"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"NIS 2 usposabljanje konano"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:n.nis2_training_completed,onChange:c=>i(d=>({...d,nis2_training_completed:c.target.checked})),className:"mr-2"}),e.jsx("span",{className:"text-text-primary",children:"Usposabljanje je konano"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"NIS 2 raven ozaveenosti"}),e.jsxs("select",{value:n.nis2_awareness_level,onChange:c=>i(d=>({...d,nis2_awareness_level:c.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",children:[e.jsx("option",{value:"",children:"Izberi raven"}),e.jsx("option",{value:"Osnovna",children:"Osnovna"}),e.jsx("option",{value:"Srednja",children:"Srednja"}),e.jsx("option",{value:"Napredna",children:"Napredna"}),e.jsx("option",{value:"Strokovna",children:"Strokovna"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Raven pooblastil za odloitve"}),e.jsxs("select",{value:n.decision_authority_level,onChange:c=>i(d=>({...d,decision_authority_level:c.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",children:[e.jsx("option",{value:"",children:"Izberi raven"}),e.jsx("option",{value:"Strateke odloitve",children:"Strateke odloitve"}),e.jsx("option",{value:"Operativne odloitve",children:"Operativne odloitve"}),e.jsx("option",{value:"Taktine odloitve",children:"Taktine odloitve"}),e.jsx("option",{value:"Samo pregled in priporoila",children:"Samo pregled in priporoila"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Aktiven od"}),e.jsx("input",{type:"date",value:n.active_from,onChange:c=>i(d=>({...d,active_from:c.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 bg-bg-surface-hover text-text-primary rounded-lg hover:bg-bg-near-black transition-colors",children:"Zapri"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-accent-primary text-white rounded-lg hover:bg-accent-primary/90 transition-colors",children:a?"Shrani spremembe":"Shrani osebo"})]})]})]})}):null}function bC({isOpen:s,onClose:t,onSave:r,policy:a}){const[n,i]=z.useState({document_id:"",document_name:"",document_type:"",approval_status:"",compliance_status:"",effective_date:"",next_review_date:""});z.useEffect(()=>{i(a?{document_id:a.document_id||"",document_name:a.document_name||"",document_type:a.document_type||"",approval_status:a.approval_status||"",compliance_status:a.compliance_status||"",effective_date:a.effective_date||"",next_review_date:a.next_review_date||""}:{document_id:"",document_name:"",document_type:"",approval_status:"",compliance_status:"",effective_date:"",next_review_date:""})},[a]);const o=c=>{c.preventDefault(),r(n)};return s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-6",children:a?"Uredi potrjevanje politike":"Dodaj novo potrjevanje politike"}),e.jsxs("form",{onSubmit:o,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"ID dokumenta *"}),e.jsx("input",{type:"text",value:n.document_id,onChange:c=>i(d=>({...d,document_id:c.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Ime dokumenta *"}),e.jsx("input",{type:"text",value:n.document_name,onChange:c=>i(d=>({...d,document_name:c.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Tip dokumenta *"}),e.jsxs("select",{value:n.document_type,onChange:c=>i(d=>({...d,document_type:c.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0,children:[e.jsx("option",{value:"",children:"Izberi tip"}),e.jsx("option",{value:"Varnostna politika",children:"Varnostna politika"}),e.jsx("option",{value:"Politika upravljanja dostopa",children:"Politika upravljanja dostopa"}),e.jsx("option",{value:"Incidentna politika",children:"Incidentna politika"}),e.jsx("option",{value:"Zaslona oglasnih zaslonov",children:"Zaslon oglasnih zaslonov"}),e.jsx("option",{value:"Politika varstva podatkov",children:"Politika varstva podatkov"}),e.jsx("option",{value:"Upravljanje tveganj",children:"Upravljanje tveganj"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Status potrjevanja *"}),e.jsxs("select",{value:n.approval_status,onChange:c=>i(d=>({...d,approval_status:c.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0,children:[e.jsx("option",{value:"",children:"Izberi status"}),e.jsx("option",{value:"V potrjevanju",children:"V potrjevanju"}),e.jsx("option",{value:"Potrjeno",children:"Potrjeno"}),e.jsx("option",{value:"Zavrnjeno",children:"Zavrnjeno"}),e.jsx("option",{value:"V reviziji",children:"V reviziji"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Status skladnosti *"}),e.jsxs("select",{value:n.compliance_status,onChange:c=>i(d=>({...d,compliance_status:c.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0,children:[e.jsx("option",{value:"",children:"Izberi status"}),e.jsx("option",{value:"Skladno",children:"Skladno"}),e.jsx("option",{value:"Delno skladno",children:"Delno skladno"}),e.jsx("option",{value:"Neskladno",children:"Neskladno"}),e.jsx("option",{value:"V pregledu",children:"V pregledu"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Veljavno od"}),e.jsx("input",{type:"date",value:n.effective_date,onChange:c=>i(d=>({...d,effective_date:c.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Naslednja revizija"}),e.jsx("input",{type:"date",value:n.next_review_date,onChange:c=>i(d=>({...d,next_review_date:c.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 bg-bg-surface-hover text-text-primary rounded-lg hover:bg-bg-near-black transition-colors",children:"Zapri"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-accent-primary text-white rounded-lg hover:bg-accent-primary/90 transition-colors",children:a?"Shrani spremembe":"Shrani politiko"})]})]})]})}):null}function gC({isOpen:s,onClose:t,onSave:r,decision:a}){const[n,i]=z.useState({decision_id:"",decision_title:"",decision_category:"",decision_status:"",decision_date:"",implementation_status:""});z.useEffect(()=>{i(a?{decision_id:a.decision_id||"",decision_title:a.decision_title||"",decision_category:a.decision_category||"",decision_status:a.decision_status||"",decision_date:a.decision_date||"",implementation_status:a.implementation_status||""}:{decision_id:"",decision_title:"",decision_category:"",decision_status:"",decision_date:"",implementation_status:""})},[a]);const o=c=>{c.preventDefault(),r(n)};return s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-6",children:a?"Uredi odloitev":"Dodaj novo odloitev"}),e.jsxs("form",{onSubmit:o,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"ID odloitve *"}),e.jsx("input",{type:"text",value:n.decision_id,onChange:c=>i(d=>({...d,decision_id:c.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Naslov odloitve *"}),e.jsx("input",{type:"text",value:n.decision_title,onChange:c=>i(d=>({...d,decision_title:c.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Kategorija odloitve *"}),e.jsxs("select",{value:n.decision_category,onChange:c=>i(d=>({...d,decision_category:c.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0,children:[e.jsx("option",{value:"",children:"Izberi kategorijo"}),e.jsx("option",{value:"Varnostna odloitev",children:"Varnostna odloitev"}),e.jsx("option",{value:"Operativna odloitev",children:"Operativna odloitev"}),e.jsx("option",{value:"Strateka odloitev",children:"Strateka odloitev"}),e.jsx("option",{value:"Skladnostna odloitev",children:"Skladnostna odloitev"}),e.jsx("option",{value:"Investicijska odloitev",children:"Investicijska odloitev"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Status odloitve *"}),e.jsxs("select",{value:n.decision_status,onChange:c=>i(d=>({...d,decision_status:c.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0,children:[e.jsx("option",{value:"",children:"Izberi status"}),e.jsx("option",{value:"Sprejeta",children:"Sprejeta"}),e.jsx("option",{value:"Zavrnjena",children:"Zavrnjena"}),e.jsx("option",{value:"V preuevanju",children:"V preuevanju"}),e.jsx("option",{value:"Odloena",children:"Odloena"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Datum odloitve"}),e.jsx("input",{type:"date",value:n.decision_date,onChange:c=>i(d=>({...d,decision_date:c.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Status implementacije *"}),e.jsxs("select",{value:n.implementation_status,onChange:c=>i(d=>({...d,implementation_status:c.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0,children:[e.jsx("option",{value:"",children:"Izberi status"}),e.jsx("option",{value:"Implementirano",children:"Implementirano"}),e.jsx("option",{value:"V implementaciji",children:"V implementaciji"}),e.jsx("option",{value:"Nezaeto",children:"Nezaeto"}),e.jsx("option",{value:"Zamrznjeno",children:"Zamrznjeno"})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 bg-bg-surface-hover text-text-primary rounded-lg hover:bg-bg-near-black transition-colors",children:"Zapri"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-accent-primary text-white rounded-lg hover:bg-accent-primary/90 transition-colors",children:a?"Shrani spremembe":"Shrani odloitev"})]})]})]})}):null}function vC({isOpen:s,onClose:t,onSave:r,competency:a}){const[n,i]=z.useState({employee_id:"",full_name:"",department:"",role_category:"",nis2_awareness_training_completed:!1,overall_competency_level:"",security_awareness_level:"",next_training_due_date:""});z.useEffect(()=>{i(a?{employee_id:a.employee_id||"",full_name:a.full_name||"",department:a.department||"",role_category:a.role_category||"",nis2_awareness_training_completed:a.nis2_awareness_training_completed||!1,overall_competency_level:a.overall_competency_level||"",security_awareness_level:a.security_awareness_level||"",next_training_due_date:a.next_training_due_date||""}:{employee_id:"",full_name:"",department:"",role_category:"",nis2_awareness_training_completed:!1,overall_competency_level:"",security_awareness_level:"",next_training_due_date:""})},[a]);const o=c=>{c.preventDefault(),r(n)};return s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-6",children:a?"Uredi usposobljenost":"Dodaj novo usposobljenost"}),e.jsxs("form",{onSubmit:o,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"ID zaposlenega *"}),e.jsx("input",{type:"text",value:n.employee_id,onChange:c=>i(d=>({...d,employee_id:c.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Polno ime *"}),e.jsx("input",{type:"text",value:n.full_name,onChange:c=>i(d=>({...d,full_name:c.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Oddelek *"}),e.jsxs("select",{value:n.department,onChange:c=>i(d=>({...d,department:c.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0,children:[e.jsx("option",{value:"",children:"Izberi oddelek"}),e.jsx("option",{value:"Informacijska tehnologija",children:"Informacijska tehnologija"}),e.jsx("option",{value:"loveki viri",children:"loveki viri"}),e.jsx("option",{value:"Raunovodstvo",children:"Raunovodstvo"}),e.jsx("option",{value:"Prodaja",children:"Prodaja"}),e.jsx("option",{value:"Marketing",children:"Marketing"}),e.jsx("option",{value:"Pravne zadeve",children:"Pravne zadeve"}),e.jsx("option",{value:"Operacije",children:"Operacije"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Kategorija vloge *"}),e.jsxs("select",{value:n.role_category,onChange:c=>i(d=>({...d,role_category:c.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0,children:[e.jsx("option",{value:"",children:"Izberi kategorijo"}),e.jsx("option",{value:"Tehnina osebje",children:"Tehnina osebje"}),e.jsx("option",{value:"Management",children:"Management"}),e.jsx("option",{value:"Zaposleni",children:"Zaposleni"}),e.jsx("option",{value:"Kljucni upravitelj",children:"Kljucni upravitelj"}),e.jsx("option",{value:"Varnostni odgovoren",children:"Varnostni odgovoren"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"NIS 2 usposabljanje konano"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:n.nis2_awareness_training_completed,onChange:c=>i(d=>({...d,nis2_awareness_training_completed:c.target.checked})),className:"mr-2"}),e.jsx("span",{className:"text-text-primary",children:"Usposabljanje je konano"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Celotna raven kompetenc *"}),e.jsxs("select",{value:n.overall_competency_level,onChange:c=>i(d=>({...d,overall_competency_level:c.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0,children:[e.jsx("option",{value:"",children:"Izberi raven"}),e.jsx("option",{value:"Zaetnik",children:"Zaetnik"}),e.jsx("option",{value:"Srednji",children:"Srednji"}),e.jsx("option",{value:"Napredni",children:"Napredni"}),e.jsx("option",{value:"Ekspert",children:"Ekspert"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Raven varnostne ozaveenosti *"}),e.jsxs("select",{value:n.security_awareness_level,onChange:c=>i(d=>({...d,security_awareness_level:c.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0,children:[e.jsx("option",{value:"",children:"Izberi raven"}),e.jsx("option",{value:"Osnovna",children:"Osnovna"}),e.jsx("option",{value:"Srednja",children:"Srednja"}),e.jsx("option",{value:"Napredna",children:"Napredna"}),e.jsx("option",{value:"Kritina",children:"Kritina"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Naslednje usposabljanje zapade"}),e.jsx("input",{type:"date",value:n.next_training_due_date,onChange:c=>i(d=>({...d,next_training_due_date:c.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 bg-bg-surface-hover text-text-primary rounded-lg hover:bg-bg-near-black transition-colors",children:"Zapri"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-accent-primary text-white rounded-lg hover:bg-accent-primary/90 transition-colors",children:a?"Shrani spremembe":"Shrani usposobljenost"})]})]})]})}):null}function yC({onNavigate:s}){const{t}=et(),r=[{id:"gdpr-data-protection",title:t("pages.gdpr.cards.dataProtection.title"),description:t("pages.gdpr.cards.dataProtection.description"),icon:_u,iconColor:"text-blue-400",bgColor:"bg-blue-500/10",borderColor:"border-blue-500/30"},{id:"gdpr-privacy-policy",title:t("pages.gdpr.cards.privacyPolicy.title"),description:t("pages.gdpr.cards.privacyPolicy.description"),icon:ut,iconColor:"text-green-400",bgColor:"bg-green-500/10",borderColor:"border-green-500/30"},{id:"gdpr-consent",title:t("pages.gdpr.cards.consent.title"),description:t("pages.gdpr.cards.consent.description"),icon:xg,iconColor:"text-purple-400",bgColor:"bg-purple-500/10",borderColor:"border-purple-500/30"},{id:"gdpr-forgotten",title:t("pages.gdpr.cards.forgotten.title"),description:t("pages.gdpr.cards.forgotten.description"),icon:yS,iconColor:"text-orange-400",bgColor:"bg-orange-500/10",borderColor:"border-orange-500/30"},{id:"gdpr-breach",title:t("pages.gdpr.cards.breach.title"),description:t("pages.gdpr.cards.breach.description"),icon:pt,iconColor:"text-red-400",bgColor:"bg-red-500/10",borderColor:"border-red-500/30"},{id:"zvop-2",title:t("pages.gdpr.cards.zvop2.title"),description:t("pages.gdpr.cards.zvop2.description"),icon:Mt,iconColor:"text-cyan-400",bgColor:"bg-cyan-500/10",borderColor:"border-cyan-500/30"},{id:"gdpr-audit",title:t("pages.gdpr.cards.audit.title"),description:t("pages.gdpr.cards.audit.description"),icon:jp,iconColor:"text-yellow-400",bgColor:"bg-yellow-500/10",borderColor:"border-yellow-500/30"},{id:"gdpr-dpia",title:t("pages.gdpr.cards.dpia.title"),description:t("pages.gdpr.cards.dpia.description"),icon:Db,iconColor:"text-pink-400",bgColor:"bg-pink-500/10",borderColor:"border-pink-500/30"},{id:"processing-activities",title:t("pages.gdpr.cards.processingActivities.title"),description:t("pages.gdpr.cards.processingActivities.description"),icon:xi,iconColor:"text-gray-400",bgColor:"bg-gray-500/10",borderColor:"border-gray-500/30"},{id:"gdpr-usposabljanja",title:t("pages.gdpr.cards.usposabljanja.title"),description:t("pages.gdpr.cards.usposabljanja.description"),icon:Ab,iconColor:"text-indigo-400",bgColor:"bg-indigo-500/10",borderColor:"border-indigo-500/30"},{id:"gdpr-controller",title:t("pages.gdpr.cards.controller.title"),description:t("pages.gdpr.cards.controller.description"),icon:Fa,iconColor:"text-indigo-400",bgColor:"bg-indigo-500/10",borderColor:"border-indigo-500/30"}];return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:t("pages.gdpr.title")}),e.jsx("p",{className:"text-body text-text-secondary",children:t("pages.gdpr.description")})]}),e.jsx("div",{className:"w-20 h-20 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center shadow-lg",children:e.jsx(Mt,{className:"w-10 h-10 text-white"})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(a=>{const n=a.icon;return e.jsxs("button",{onClick:()=>s==null?void 0:s(a.id),className:"bg-bg-surface p-6 rounded-lg border border-border-subtle hover:border-accent-primary/50 transition-all duration-200 text-left group hover:bg-bg-surface-hover",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg ${a.bgColor} border ${a.borderColor} flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-200`,children:e.jsx(n,{className:`w-6 h-6 ${a.iconColor}`})}),e.jsx("h3",{className:"text-heading-md font-semibold text-text-primary mb-2",children:a.title}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:a.description})]},a.id)})})]})}function jC({onNavigate:s}){const{t}=et(),r=[{id:"iso-scope",title:t("pages.iso27001.cards.scope.title"),description:t("pages.iso27001.cards.scope.description"),icon:Rp,iconColor:"text-teal-400",bgColor:"bg-teal-500/10",borderColor:"border-teal-500/30"},{id:"iso-information-security-policy",title:t("pages.iso27001.cards.informationSecurityPolicy.title"),description:t("pages.iso27001.cards.informationSecurityPolicy.description"),icon:Mt,iconColor:"text-green-400",bgColor:"bg-green-500/10",borderColor:"border-green-500/30"},{id:"iso-audit",title:t("pages.iso27001.cards.audit.title"),description:t("pages.iso27001.cards.audit.description"),icon:jp,iconColor:"text-blue-400",bgColor:"bg-blue-500/10",borderColor:"border-blue-500/30"},{id:"iso-risk",title:t("pages.iso27001.cards.risk.title"),description:t("pages.iso27001.cards.risk.description"),icon:pt,iconColor:"text-red-400",bgColor:"bg-red-500/10",borderColor:"border-red-500/30"},{id:"iso-controls",title:t("pages.iso27001.cards.controls.title"),description:t("pages.iso27001.cards.controls.description"),icon:fi,iconColor:"text-purple-400",bgColor:"bg-purple-500/10",borderColor:"border-purple-500/30"},{id:"iso-vloge-odgovornosti",title:t("pages.iso27001.cards.rolesAndResponsibilities.title"),description:t("pages.iso27001.cards.rolesAndResponsibilities.description"),icon:ox,iconColor:"text-indigo-400",bgColor:"bg-indigo-500/10",borderColor:"border-indigo-500/30"},{id:"iso-certification",title:t("pages.iso27001.cards.certification.title"),description:t("pages.iso27001.cards.certification.description"),icon:pl,iconColor:"text-yellow-400",bgColor:"bg-yellow-500/10",borderColor:"border-yellow-500/30"},{id:"iso-assets",title:t("pages.iso27001.cards.assets.title"),description:t("pages.iso27001.cards.assets.description"),icon:sd,iconColor:"text-cyan-400",bgColor:"bg-cyan-500/10",borderColor:"border-cyan-500/30"},{id:"iso-incident",title:t("pages.iso27001.cards.incident.title"),description:t("pages.iso27001.cards.incident.description"),icon:cg,iconColor:"text-orange-400",bgColor:"bg-orange-500/10",borderColor:"border-orange-500/30"},{id:"iso-compliance",title:t("pages.iso27001.cards.compliance.title"),description:t("pages.iso27001.cards.compliance.description"),icon:Rt,iconColor:"text-pink-400",bgColor:"bg-pink-500/10",borderColor:"border-pink-500/30"},{id:"iso-soa",title:t("pages.iso27001.cards.soa.title"),description:t("pages.iso27001.cards.soa.description"),icon:ul,iconColor:"text-indigo-400",bgColor:"bg-indigo-500/10",borderColor:"border-indigo-500/30"}];return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:t("pages.iso27001.title")}),e.jsx("p",{className:"text-body text-text-secondary",children:t("pages.iso27001.description")})]}),e.jsx("div",{className:"w-20 h-20 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center shadow-lg",children:e.jsx(Mt,{className:"w-10 h-10 text-white"})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(a=>{const n=a.icon;return e.jsxs("button",{onClick:()=>s==null?void 0:s(a.id),className:"bg-bg-surface p-6 rounded-lg border border-border-subtle hover:border-accent-primary/50 transition-all duration-200 text-left group hover:bg-bg-surface-hover",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg ${a.bgColor} border ${a.borderColor} flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-200`,children:e.jsx(n,{className:`w-6 h-6 ${a.iconColor}`})}),e.jsx("h3",{className:"text-heading-md font-semibold text-text-primary mb-2",children:a.title}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:a.description})]},a.id)})})]})}const _C=({isOpen:s,onClose:t,onSave:r})=>{const{t:a}=et(),n=[{key:"module_id",label:a("modals.add.common.moduleId"),type:"text",required:!0},{key:"module_name",label:a("modals.add.common.moduleName"),type:"text",required:!0},{key:"category",label:a("modals.add.common.category"),type:"select",required:!0,options:["security_awareness","gdpr_compliance","iso_27001","nis2_directive","data_protection","incident_response","risk_management","business_continuity","physical_security","technical_training"]},{key:"duration_minutes",label:a("modals.add.common.duration"),type:"number"},{key:"description",label:a("modals.add.common.description"),type:"textarea",required:!0},{key:"learning_objectives",label:a("modals.add.common.learningObjectives"),type:"textarea"},{key:"content_url",label:a("modals.add.common.contentUrl"),type:"text"},{key:"mandatory",label:a("modals.add.common.isRequired"),type:"select",options:["true","false"]},{key:"completion_rate",label:a("modals.add.common.completionRate"),type:"number"}];return e.jsx(ha,{isOpen:s,onClose:t,onSave:r,title:a("modals.add.education.title"),table:"education_modules",fields:n})};function oj(){const[s,t]=z.useState([]),[r,a]=z.useState(!0),[n,i]=z.useState(!1),[o,c]=z.useState(null),[d,p]=z.useState(!1),[m,x]=z.useState(!1),[b,h]=z.useState(!1),[j,g]=z.useState(null),[v,_]=z.useState({module_name:"",category:"",duration_minutes:"",description:"",learning_objectives:"",content_url:"",mandatory:!1,completion_rate:""}),[k,P]=z.useState(!1),[L,F]=z.useState(!1);z.useEffect(()=>{(async()=>{try{const{data:te,error:ce}=await Ne.from("education_modules").select("*").order("created_at",{ascending:!1});if(ce)throw ce;!te||te.length===0?t([{id:1,module_name:"Osnove kibernetske varnosti",category:"Kibernetska varnost",duration_minutes:90,description:"Temeljni modul o osnovah kibernetske varnosti, ki vkljuuje prepoznavanje groenj, varnostnih politik in najboljih praks za zaito digitalnih sredstev.",learning_objectives:"Prepoznavanje groenj, razumevanje varnostnih politik, uporaba varnih gesel, prepoznavanje phishing napadov",content_url:"https://standario.example.com/izobrazevanje/kibernetska-varnost",mandatory:!0,completion_rate:95,created_at:"2024-10-15T08:00:00Z",updated_at:"2024-11-01T10:30:00Z"},{id:2,module_name:"GDPR in varstvo osebnih podatkov",category:"Zakonska ustreznost",duration_minutes:60,description:"Poglobljen pregled Splone uredbe o varstvu podatkov (GDPR), njenih zahtev in implementacije v vsakdanjo prakso organizacije.",learning_objectives:"Razumevanje GDPR nael, identifikacija osebnih podatkov, postopki obdelave podatkov, pravice posameznikov",content_url:"https://standario.example.com/izobrazevanje/gdpr",mandatory:!0,completion_rate:88,created_at:"2024-10-10T09:15:00Z",updated_at:"2024-10-20T14:45:00Z"},{id:3,module_name:"Varno delo na daljavo",category:"Delo na daljavo",duration_minutes:45,description:"Smernice in protokoli za varno delo izven pisarnikih prostorov, vkljuno z varnimi povezavami, fizino varnostjo in higieno podatkov.",learning_objectives:"Vzpostavitev varnega domaega delovnega mesta, varna povezava do podjetnikih sistemov, zaita obutljivih podatkov",content_url:"https://standario.example.com/izobrazevanje/delo-na-daljavo",mandatory:!1,completion_rate:72,created_at:"2024-10-05T11:20:00Z",updated_at:"2024-10-25T16:10:00Z"},{id:4,module_name:"Socialna varnost in etina uporaba AI",category:"Umetna inteligenca",duration_minutes:75,description:"Modul o odgovorni uporabi umetne inteligence, etinih vidikih AI in ukrepih za prepreevanje zlorab v poslovnem okolju.",learning_objectives:"Razumevanje etinih vidikov AI, prepoznavanje pristranosti, varen razvoj AI sistemov, transparentnost algoritmov",content_url:"https://standario.example.com/izobrazevanje/ai-etika",mandatory:!0,completion_rate:81,created_at:"2024-09-28T13:45:00Z",updated_at:"2024-10-15T09:30:00Z"},{id:5,module_name:"Upravljanje digitalnih identitet",category:"Identiteta in dostop",duration_minutes:50,description:"Nauite se upravljati digitalne identitete, vefaktorsko avtentikacijo ter varnostne protokole za zaito uporabnikih raunov.",learning_objectives:"Konfiguracija MFA, upravljanje gesel, razumevanje SSO, zaita digitalnih sledi",content_url:"https://standario.example.com/izobrazevanje/digitalna-identiteta",mandatory:!1,completion_rate:67,created_at:"2024-09-20T15:10:00Z",updated_at:"2024-10-05T12:20:00Z"}]):t(te)}catch(te){console.error("Error:",te),t([{id:1,module_name:"Osnove kibernetske varnosti",category:"Kibernetska varnost",duration_minutes:90,description:"Temeljni modul o osnovah kibernetske varnosti, ki vkljuuje prepoznavanje groenj, varnostnih politik in najboljih praks za zaito digitalnih sredstev.",learning_objectives:"Prepoznavanje groenj, razumevanje varnostnih politik, uporaba varnih gesel, prepoznavanje phishing napadov",content_url:"https://standario.example.com/izobrazevanje/kibernetska-varnost",mandatory:!0,completion_rate:95,created_at:"2024-10-15T08:00:00Z",updated_at:"2024-11-01T10:30:00Z"},{id:2,module_name:"GDPR in varstvo osebnih podatkov",category:"Zakonska ustreznost",duration_minutes:60,description:"Poglobljen pregled Splone uredbe o varstvu podatkov (GDPR), njenih zahtev in implementacije v vsakdanjo prakso organizacije.",learning_objectives:"Razumevanje GDPR nael, identifikacija osebnih podatkov, postopki obdelave podatkov, pravice posameznikov",content_url:"https://standario.example.com/izobrazevanje/gdpr",mandatory:!0,completion_rate:88,created_at:"2024-10-10T09:15:00Z",updated_at:"2024-10-20T14:45:00Z"},{id:3,module_name:"Varno delo na daljavo",category:"Delo na daljavo",duration_minutes:45,description:"Smernice in protokoli za varno delo izven pisarnikih prostorov, vkljuno z varnimi povezavami, fizino varnostjo in higieno podatkov.",learning_objectives:"Vzpostavitev varnega domaega delovnega mesta, varna povezava do podjetnikih sistemov, zaita obutljivih podatkov",content_url:"https://standario.example.com/izobrazevanje/delo-na-daljavo",mandatory:!1,completion_rate:72,created_at:"2024-10-05T11:20:00Z",updated_at:"2024-10-25T16:10:00Z"},{id:4,module_name:"Socialna varnost in etina uporaba AI",category:"Umetna inteligenca",duration_minutes:75,description:"Modul o odgovorni uporabi umetne inteligence, etinih vidikih AI in ukrepih za prepreevanje zlorab v poslovnem okolju.",learning_objectives:"Razumevanje etinih vidikov AI, prepoznavanje pristranosti, varen razvoj AI sistemov, transparentnost algoritmov",content_url:"https://standario.example.com/izobrazevanje/ai-etika",mandatory:!0,completion_rate:81,created_at:"2024-09-28T13:45:00Z",updated_at:"2024-10-15T09:30:00Z"},{id:5,module_name:"Upravljanje digitalnih identitet",category:"Identiteta in dostop",duration_minutes:50,description:"Nauite se upravljati digitalne identitete, vefaktorsko avtentikacijo ter varnostne protokole za zaito uporabnikih raunov.",learning_objectives:"Konfiguracija MFA, upravljanje gesel, razumevanje SSO, zaita digitalnih sledi",content_url:"https://standario.example.com/izobrazevanje/digitalna-identiteta",mandatory:!1,completion_rate:67,created_at:"2024-09-20T15:10:00Z",updated_at:"2024-10-05T12:20:00Z"}])}finally{a(!1)}})()},[]);const W=async()=>{const{data:Z,error:te}=await Ne.from("education_modules").select("*").order("created_at",{ascending:!1});if(te){console.error("Error:",te);return}t(Z||[])},R=Z=>{c(Z),p(!0)},B=()=>{p(!1),c(null)},A=Z=>{var te,ce;g(Z),_({module_name:Z.module_name||"",category:Z.category||"",duration_minutes:((te=Z.duration_minutes)==null?void 0:te.toString())||"",description:Z.description||"",learning_objectives:Z.learning_objectives||"",content_url:Z.content_url||"",mandatory:Z.mandatory||!1,completion_rate:((ce=Z.completion_rate)==null?void 0:ce.toString())||""}),x(!0)},S=async Z=>{if(Z.preventDefault(),!!j){P(!0);try{const{error:te}=await Ne.from("education_modules").update({module_name:v.module_name,category:v.category,duration_minutes:parseInt(v.duration_minutes),description:v.description,learning_objectives:v.learning_objectives,content_url:v.content_url,mandatory:v.mandatory,completion_rate:parseInt(v.completion_rate)}).eq("id",j.id);if(te)throw te;await W(),x(!1),g(null)}catch(te){console.error("Error updating education module:",te),alert("Napaka pri posodabljanju modula")}finally{P(!1)}}},C=Z=>{g(Z),h(!0)},O=async()=>{if(j){F(!0);try{const{error:Z}=await Ne.from("education_modules").delete().eq("id",j.id);if(Z)throw Z;await W(),h(!1),g(null)}catch(Z){console.error("Error deleting education module:",Z),alert("Napaka pri brisanju modula")}finally{F(!1)}}};return r?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Izobraevalni moduli"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Varnostno izobraevanje in usposabljanje"})]}),e.jsx("div",{className:"w-20 h-20 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center shadow-lg",children:e.jsx(hi,{className:"w-10 h-10 text-white"})})]}),e.jsxs("button",{onClick:()=>i(!0),className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Dt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:"Nov modul"})]})]}),e.jsx("div",{className:"bg-bg-surface rounded-sm border border-border-subtle overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-pure-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Modul"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Kategorija"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Trajanje"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Obvezno"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Zakljuenost"}),e.jsx("th",{className:"text-center px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Akcije"})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:s.map(Z=>e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 text-body text-text-primary font-medium",children:Z.module_name}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:Z.category}),e.jsxs("td",{className:"px-6 py-4 text-body text-text-secondary",children:[Z.duration_minutes," min"]}),e.jsx("td",{className:"px-6 py-4",children:Z.mandatory?e.jsx("span",{className:"px-2 py-1 rounded-full text-caption font-medium bg-status-error/10 text-status-error",children:"Obvezno"}):e.jsx("span",{className:"px-2 py-1 rounded-full text-caption font-medium bg-status-info/10 text-status-info",children:"Opcijsko"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 h-2 bg-bg-near-black rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-accent-primary transition-all duration-300",style:{width:`${Z.completion_rate}%`}})}),e.jsxs("span",{className:"text-body-sm text-text-secondary font-medium",children:[Z.completion_rate,"%"]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("button",{onClick:()=>R(Z),className:"p-2 rounded-lg bg-blue-600/20 hover:bg-blue-600/30 text-blue-400 transition-colors",title:"Podrobnosti izobraevanja",children:e.jsx(lr,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>A(Z),className:"p-2 rounded-lg bg-yellow-600/20 hover:bg-yellow-600/30 text-yellow-400 transition-colors",title:"Uredi modul",children:e.jsx(ar,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>C(Z),className:"p-2 rounded-lg bg-red-600/20 hover:bg-red-600/30 text-red-400 transition-colors",title:"Izbrii modul",children:e.jsx(pr,{className:"w-4 h-4"})})]})})]},Z.id))})]})}),e.jsx(_C,{isOpen:n,onClose:()=>i(!1),onSave:W}),d&&o&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm",onClick:Z=>{Z.target===Z.currentTarget&&B()},children:e.jsxs("div",{className:"bg-gray-800 border border-gray-700/50 rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto shadow-2xl",children:[e.jsxs("div",{className:"sticky top-0 bg-gray-800 border-b border-gray-700/50 px-6 py-4 flex items-center justify-between z-10",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:o.module_name}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Podrobnosti izobraevalnega modula"})]}),e.jsx("button",{onClick:B,className:"p-2 rounded-lg hover:bg-gray-700/50 transition-colors",children:e.jsx(Ar,{className:"w-5 h-5 text-gray-400"})})]}),e.jsxs("div",{className:"px-6 py-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-3",children:[o.mandatory?e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-red-500/20 text-red-400 border border-red-500/30",children:"Obvezno"}):e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-500/20 text-blue-400 border border-blue-500/30",children:"Opcijsko"}),e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-purple-500/20 text-purple-400 border border-purple-500/30",children:o.category})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"ID Modula"}),e.jsx("div",{className:"text-sm text-white font-medium",children:o.module_id||"-"})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Trajanje"}),e.jsxs("div",{className:"text-sm text-white font-medium",children:[o.duration_minutes," minut"]})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Zakljuenost"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 h-2 bg-gray-900 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 transition-all duration-300",style:{width:`${o.completion_rate}%`}})}),e.jsxs("span",{className:"text-sm text-white font-medium",children:[o.completion_rate,"%"]})]})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Kategorija"}),e.jsx("div",{className:"text-sm text-white font-medium",children:o.category})]})]}),o.description&&e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Opis"}),e.jsx("div",{className:"text-sm text-white whitespace-pre-wrap",children:o.description})]}),o.learning_objectives&&e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Uni cilji"}),e.jsx("div",{className:"text-sm text-white whitespace-pre-wrap",children:o.learning_objectives})]}),o.content_url&&e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Povezava do vsebine"}),e.jsx("a",{href:o.content_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-400 hover:text-blue-300 underline break-all",children:o.content_url})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-3",children:"Metapodatki"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"ID"}),e.jsx("div",{className:"text-sm text-white font-mono break-all",children:o.id})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Ustvarjeno"}),e.jsx("div",{className:"text-sm text-white",children:new Date(o.created_at).toLocaleString("sl-SI")})]}),o.updated_at&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Posodobljeno"}),e.jsx("div",{className:"text-sm text-white",children:new Date(o.updated_at).toLocaleString("sl-SI")})]})]})]})]}),e.jsx("div",{className:"sticky bottom-0 bg-gray-800 border-t border-gray-700/50 px-6 py-4 flex justify-end",children:e.jsx("button",{onClick:B,className:"px-6 py-2 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-lg transition-all duration-200",children:"Zapri"})})]})}),m&&j&&e.jsx(zs,{isOpen:m,onClose:()=>x(!1),title:"Uredi izobraevalni modul",children:e.jsxs("form",{onSubmit:S,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{htmlFor:"module_name",className:"block text-sm font-medium text-text-secondary mb-2",children:["Naziv modula ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"text",id:"module_name",value:v.module_name,onChange:Z=>_(te=>({...te,module_name:Z.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"category",className:"block text-sm font-medium text-text-secondary mb-2",children:["Kategorija ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"text",id:"category",value:v.category,onChange:Z=>_(te=>({...te,category:Z.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"duration_minutes",className:"block text-sm font-medium text-text-secondary mb-2",children:["Trajanje (minute) ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"number",id:"duration_minutes",value:v.duration_minutes,onChange:Z=>_(te=>({...te,duration_minutes:Z.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-text-secondary mb-2",children:"Opis"}),e.jsx("textarea",{id:"description",value:v.description,onChange:Z=>_(te=>({...te,description:Z.target.value})),rows:3,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary resize-none"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"learning_objectives",className:"block text-sm font-medium text-text-secondary mb-2",children:"Uni cilji"}),e.jsx("textarea",{id:"learning_objectives",value:v.learning_objectives,onChange:Z=>_(te=>({...te,learning_objectives:Z.target.value})),rows:3,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary resize-none"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"content_url",className:"block text-sm font-medium text-text-secondary mb-2",children:"Povezava do vsebine"}),e.jsx("input",{type:"url",id:"content_url",value:v.content_url,onChange:Z=>_(te=>({...te,content_url:Z.target.value})),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"completion_rate",className:"block text-sm font-medium text-text-secondary mb-2",children:["Zakljuenost (%) ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"number",id:"completion_rate",min:"0",max:"100",value:v.completion_rate,onChange:Z=>_(te=>({...te,completion_rate:Z.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsx("div",{className:"flex items-center",children:e.jsxs("label",{htmlFor:"mandatory",className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",id:"mandatory",checked:v.mandatory,onChange:Z=>_(te=>({...te,mandatory:Z.target.checked})),className:"mr-2 w-4 h-4 bg-bg-near-black border border-border-subtle rounded focus:ring-accent-primary"}),e.jsx("span",{className:"text-sm font-medium text-text-secondary",children:"Obvezno izobraevanje"})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-border-subtle",children:[e.jsx("button",{type:"button",onClick:()=>x(!1),className:"px-6 py-2 bg-bg-near-black text-text-primary border border-border-subtle rounded hover:bg-bg-surface transition-colors duration-150",children:"Preklii"}),e.jsx("button",{type:"submit",disabled:k,className:"px-6 py-2 bg-accent-primary hover:bg-accent-primary-hover text-white rounded transition-colors duration-150 disabled:opacity-50",children:k?"Shranjujem...":"Shrani"})]})]})}),e.jsx(gi,{isOpen:b,onClose:()=>h(!1),onConfirm:O,title:"Izbrii izobraevalni modul",message:`Ali ste prepriani, da elite izbrisati modul "${j==null?void 0:j.module_name}"? Te akcije ni mogoe razveljaviti.`,isDeleting:L})]})}function kC(){const[s,t]=z.useState([]),[r,a]=z.useState(!0);z.useEffect(()=>{n()},[]);const n=async()=>{try{const d=new Date,p=[],{data:m,error:x}=await Ne.from("inventory_licenses").select("*").not("expiry_date","is",null).order("expiry_date",{ascending:!0});!x&&m&&m.forEach(g=>{const v=new Date(g.expiry_date),_=Math.floor((v.getTime()-d.getTime())/(1e3*60*60*24));_>=-7&&p.push({id:g.id,naziv:g.software_name||"Neimenovana licenca",tip:"Licenca",datum_poteka:g.expiry_date,dnevi_do_poteka:_,additional_info:g.license_key?`Klju: ${g.license_key.slice(-4)}`:void 0,original_record:g})});const{data:b,error:h}=await Ne.from("inventory_software").select("*");!h&&b&&b.forEach(g=>{if(g.renewal_date){const v=new Date(g.renewal_date),_=Math.floor((v.getTime()-d.getTime())/(1e3*60*60*24));_>=-7&&p.push({id:`${g.id}_renewal`,naziv:g.software_name||"Neimenovana programska oprema",tip:"Programska oprema",datum_poteka:g.renewal_date,dnevi_do_poteka:_,additional_info:`Podaljanje | ${g.vendor||"Brez prodajalca"}`,original_record:g})}if(g.support_expiry){const v=new Date(g.support_expiry),_=Math.floor((v.getTime()-d.getTime())/(1e3*60*60*24));_>=-7&&p.push({id:`${g.id}_support`,naziv:g.software_name||"Neimenovana programska oprema",tip:"Programska oprema",datum_poteka:g.support_expiry,dnevi_do_poteka:_,additional_info:`Podpora | ${g.vendor||"Brez prodajalca"}`,original_record:g})}});const j=p.sort((g,v)=>g.dnevi_do_poteka-v.dnevi_do_poteka).slice(0,5);t(j)}catch(d){console.error("Napaka pri pridobivanju zapisov:",d)}finally{a(!1)}},i=d=>d<0?{text:"Poteklo",className:"bg-red-500/20 text-red-400 border-red-500/50",icon:pt}:d<=7?{text:"Nujno",className:"bg-red-500/20 text-red-400 border-red-500/50",icon:pt}:d<=14?{text:"Kritino",className:"bg-orange-500/20 text-orange-400 border-orange-500/50",icon:pt}:d<=30?{text:"Opozorilo",className:"bg-yellow-500/20 text-yellow-400 border-yellow-500/50",icon:_a}:{text:"Prihajajoe",className:"bg-blue-500/20 text-blue-400 border-blue-500/50",icon:_a},o=d=>d<0||d<=7?"bg-red-500/5 border-l-4 border-red-500":d<=14?"bg-orange-500/5 border-l-4 border-orange-500":d<=30?"bg-yellow-500/5 border-l-4 border-yellow-500":"",c=d=>d<0?`Poteklo pred ${Math.abs(d)} dnevi`:d===0?"Potee danes":d===1?"1 dan":d===2?"2 dneva":d===3||d===4?`${d} dnevi`:`${d} dni`;return r?e.jsx("div",{className:"bg-bg-surface rounded-sm border border-border-subtle p-6",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-accent-primary"})})}):e.jsxs("div",{className:"bg-bg-surface rounded-sm border border-border-subtle overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-border-subtle bg-bg-pure-black",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-red-500/10 flex items-center justify-center",children:e.jsx(pt,{className:"w-5 h-5 text-red-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-text-primary",children:"Veljavnost programske opreme in licenc"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Seznam preteklih ali kmalu preteklih licenc"})]})]})}),s.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-pure-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Status"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Naziv"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Tip"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Datum poteka"}),e.jsx("th",{className:"text-right px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Dnevi do poteka"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Dodatne informacije"})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:s.map(d=>{const p=i(d.dnevi_do_poteka),m=p.icon,x=d.tip==="Licenca"?ix:sd;return e.jsxs("tr",{className:`hover:bg-bg-surface-hover transition-colors duration-150 ${o(d.dnevi_do_poteka)}`,children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:`px-3 py-1 rounded-full text-caption font-medium border ${p.className} flex items-center gap-1.5 w-fit`,children:[e.jsx(m,{className:"w-3.5 h-3.5"}),p.text]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-body text-text-primary font-medium",children:d.naziv})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{className:"w-4 h-4 text-text-tertiary"}),e.jsx("span",{className:"text-body text-text-secondary",children:d.tip})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"text-body text-text-primary",children:new Date(d.datum_poteka).toLocaleDateString("sl-SI",{day:"2-digit",month:"2-digit",year:"numeric"})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-right",children:e.jsx("span",{className:`text-body font-medium ${d.dnevi_do_poteka<0||d.dnevi_do_poteka<=7?"text-red-400":d.dnevi_do_poteka<=14?"text-orange-400":d.dnevi_do_poteka<=30?"text-yellow-400":"text-text-secondary"}`,children:c(d.dnevi_do_poteka)})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"text-body-sm text-text-tertiary",children:d.additional_info||"-"})})]},d.id)})})]})}):e.jsx("div",{className:"text-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-green-500/10 flex items-center justify-center",children:e.jsx(_a,{className:"w-8 h-8 text-green-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-heading-md font-semibold text-text-primary mb-1",children:"Ni podatkov o poteklih licencah"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Trenutno ni programske opreme oziroma licenc, ki so ali bodo kmalu potekle."})]})]})})]})}function NC({onNavigate:s}){const{t}=et(),r=[{id:"inventory-devices",title:t("pages.inventory.cards.devices.title"),description:t("pages.inventory.cards.devices.description"),icon:sc,iconColor:"text-blue-400",bgColor:"bg-blue-500/10",borderColor:"border-blue-500/30"},{id:"inventory-software",title:t("pages.inventory.cards.software.title"),description:t("pages.inventory.cards.software.description"),icon:sd,iconColor:"text-green-400",bgColor:"bg-green-500/10",borderColor:"border-green-500/30"},{id:"inventory-licenses",title:t("pages.inventory.cards.licenses.title"),description:t("pages.inventory.cards.licenses.description"),icon:ix,iconColor:"text-purple-400",bgColor:"bg-purple-500/10",borderColor:"border-purple-500/30"}];return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:t("pages.inventory.title")}),e.jsx("p",{className:"text-body text-text-secondary",children:t("pages.inventory.description")})]}),e.jsx("div",{className:"w-20 h-20 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center shadow-lg",children:e.jsx(sd,{className:"w-10 h-10 text-white"})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(a=>{const n=a.icon;return e.jsxs("button",{onClick:()=>s==null?void 0:s(a.id),className:"bg-bg-surface p-6 rounded-lg border border-border-subtle hover:border-accent-primary/50 transition-all duration-200 text-left group hover:bg-bg-surface-hover",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg ${a.bgColor} border ${a.borderColor} flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-200`,children:e.jsx(n,{className:`w-6 h-6 ${a.iconColor}`})}),e.jsx("h3",{className:"text-heading-md font-semibold text-text-primary mb-2",children:a.title}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:a.description})]},a.id)})}),e.jsx("div",{className:"mt-8",children:e.jsx(kC,{})})]})}function wC({onNavigate:s}){const{t}=et(),r=[{id:"procedures-list",title:t("pages.procedures.cards.procedures.title"),description:t("pages.procedures.cards.procedures.description"),icon:ut,iconColor:"text-blue-400",bgColor:"bg-blue-500/10",borderColor:"border-blue-500/30"},{id:"policies-list",title:t("pages.procedures.cards.policies.title"),description:t("pages.procedures.cards.policies.description"),icon:hi,iconColor:"text-green-400",bgColor:"bg-green-500/10",borderColor:"border-green-500/30"},{id:"templates-list",title:t("pages.procedures.cards.templates.title"),description:t("pages.procedures.cards.templates.description"),icon:Pb,iconColor:"text-purple-400",bgColor:"bg-purple-500/10",borderColor:"border-purple-500/30"}];return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:t("pages.procedures.title")}),e.jsx("p",{className:"text-body text-text-secondary",children:t("pages.procedures.description")})]}),e.jsx("div",{className:"w-20 h-20 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center shadow-lg",children:e.jsx(ut,{className:"w-10 h-10 text-white"})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(a=>{const n=a.icon;return e.jsxs("button",{onClick:()=>s==null?void 0:s(a.id),className:"bg-bg-surface p-6 rounded-lg border border-border-subtle hover:border-accent-primary/50 transition-all duration-200 text-left group hover:bg-bg-surface-hover",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg ${a.bgColor} border ${a.borderColor} flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-200`,children:e.jsx(n,{className:`w-6 h-6 ${a.iconColor}`})}),e.jsx("h3",{className:"text-heading-md font-semibold text-text-primary mb-2",children:a.title}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:a.description})]},a.id)})})]})}function lj(){const{t:s}=et(),[t,r]=z.useState([]),[a,n]=z.useState(!0);z.useEffect(()=>{i();const o=Ne.channel("support-changes").on("postgres_changes",{event:"*",schema:"public",table:"support_requests"},()=>{i()}).subscribe();return()=>{Ne.removeChannel(o)}},[]);async function i(){n(!0);try{const{data:o}=await Ne.from("support_requests").select("*").order("created_at",{ascending:!1});r(o||[])}catch(o){console.error("Error loading support requests:",o)}finally{n(!1)}}return a?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:s("support.title")}),e.jsx("p",{className:"text-body text-text-secondary",children:"Upravljanje podpornih zahtevkov"})]}),e.jsx("div",{className:"w-20 h-20 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center shadow-lg",children:e.jsx(pg,{className:"w-10 h-10 text-white"})})]}),e.jsx(dl,{title:"Vsi podporni zahtevki",columns:[{key:"ticket_id",header:"ID"},{key:"created_at",header:"Datum in Ura",render:o=>new Date(o.created_at).toLocaleString("sl-SI")},{key:"full_name",header:"Ime in Priimek"},{key:"subject",header:"Zadeva"},{key:"priority",header:"Prioriteta",render:o=>e.jsx(vr,{type:"priority",value:o.priority})},{key:"status",header:"Status",render:o=>e.jsx(vr,{type:"status",value:o.status})}],data:t,onViewItem:o=>console.log("View request:",o)})]})}function cj(){const{t:s}=et(),{user:t}=cr(),[r,a]=z.useState(!1);return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:s("settings.title")}),e.jsx("p",{className:"text-body text-text-secondary",children:s("settings.subtitle")})]}),e.jsx("div",{className:"w-20 h-20 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center shadow-lg",children:e.jsx(Mt,{className:"w-10 h-10 text-white"})})]}),e.jsxs("div",{className:"bg-bg-surface p-8 rounded-lg border border-border-subtle",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx(en,{className:"w-6 h-6 text-accent-primary"}),e.jsx("h2",{className:"text-heading-lg font-semibold text-text-primary",children:s("settings.profile")})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:"Email"}),e.jsx("input",{type:"email",value:(t==null?void 0:t.email)||"",disabled:!0,className:"w-full h-12 px-4 bg-bg-near-black border border-border-subtle rounded-md text-body text-text-tertiary"})]})})]}),e.jsxs("div",{className:"bg-bg-surface p-8 rounded-lg border border-border-subtle",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx(Mt,{className:"w-6 h-6 text-accent-primary"}),e.jsx("h2",{className:"text-heading-lg font-semibold text-text-primary",children:"Varnost"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-bg-near-black rounded-md border border-border-subtle",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-body font-medium text-text-primary mb-1",children:"Dvofaktorska avtentikacija (2FA)"}),e.jsx("div",{className:"text-body-sm text-text-secondary",children:"Dodajte dodatno plast varnosti vaemu raunu"})]}),e.jsx("button",{onClick:()=>a(!r),className:`relative inline-flex h-8 w-14 items-center rounded-full transition-colors ${r?"bg-accent-primary":"bg-bg-surface-hover"}`,children:e.jsx("span",{className:`inline-block h-6 w-6 transform rounded-full bg-white transition-transform ${r?"translate-x-7":"translate-x-1"}`})})]}),r&&e.jsx("div",{className:"p-4 bg-accent-primary/15 border border-accent-primary/30 rounded-md",children:e.jsx("p",{className:"text-body-sm text-accent-primary",children:"2FA je omogoena. Pri naslednji prijavi boste morali vnesti kodo iz avtentikacijske aplikacije."})}),e.jsx("button",{className:"w-full h-12 bg-bg-surface-hover text-text-primary border border-border-subtle rounded-sm hover:bg-bg-surface-elevated transition-all",children:"Spremeni geslo"})]})]}),e.jsxs("div",{className:"bg-bg-surface p-8 rounded-lg border border-border-subtle",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx(cg,{className:"w-6 h-6 text-accent-primary"}),e.jsx("h2",{className:"text-heading-lg font-semibold text-text-primary",children:"Obvestila"})]}),e.jsx("div",{className:"space-y-4",children:["Email obvestila za nove incidente","Push obvestila za kritina tveganja","Tedenska povzetka"].map(n=>e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",defaultChecked:!0,className:"w-5 h-5 rounded border-border-subtle bg-bg-near-black"}),e.jsx("span",{className:"text-body text-text-primary",children:n})]},n))})]})]})}var SC=M_();const zC=Xb(SC);var CC=s=>{switch(s){case"success":return OC;case"info":return EC;case"warning":return DC;case"error":return IC;default:return null}},PC=Array(12).fill(0),AC=({visible:s,className:t})=>lt.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":s},lt.createElement("div",{className:"sonner-spinner"},PC.map((r,a)=>lt.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${a}`})))),OC=lt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},lt.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),DC=lt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},lt.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),EC=lt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},lt.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),IC=lt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},lt.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),LC=lt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},lt.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),lt.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),TC=()=>{let[s,t]=lt.useState(document.hidden);return lt.useEffect(()=>{let r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),s},Ub=1,RC=class{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{let r=this.subscribers.indexOf(t);this.subscribers.splice(r,1)}),this.publish=t=>{this.subscribers.forEach(r=>r(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var r;let{message:a,...n}=t,i=typeof(t==null?void 0:t.id)=="number"||((r=t.id)==null?void 0:r.length)>0?t.id:Ub++,o=this.toasts.find(d=>d.id===i),c=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),o?this.toasts=this.toasts.map(d=>d.id===i?(this.publish({...d,...t,id:i,title:a}),{...d,...t,id:i,dismissible:c,title:a}):d):this.addToast({title:a,...n,dismissible:c,id:i}),i},this.dismiss=t=>(this.dismissedToasts.add(t),t||this.toasts.forEach(r=>{this.subscribers.forEach(a=>a({id:r.id,dismiss:!0}))}),this.subscribers.forEach(r=>r({id:t,dismiss:!0})),t),this.message=(t,r)=>this.create({...r,message:t}),this.error=(t,r)=>this.create({...r,message:t,type:"error"}),this.success=(t,r)=>this.create({...r,type:"success",message:t}),this.info=(t,r)=>this.create({...r,type:"info",message:t}),this.warning=(t,r)=>this.create({...r,type:"warning",message:t}),this.loading=(t,r)=>this.create({...r,type:"loading",message:t}),this.promise=(t,r)=>{if(!r)return;let a;r.loading!==void 0&&(a=this.create({...r,promise:t,type:"loading",message:r.loading,description:typeof r.description!="function"?r.description:void 0}));let n=t instanceof Promise?t:t(),i=a!==void 0,o,c=n.then(async p=>{if(o=["resolve",p],lt.isValidElement(p))i=!1,this.create({id:a,type:"default",message:p});else if(FC(p)&&!p.ok){i=!1;let m=typeof r.error=="function"?await r.error(`HTTP error! status: ${p.status}`):r.error,x=typeof r.description=="function"?await r.description(`HTTP error! status: ${p.status}`):r.description;this.create({id:a,type:"error",message:m,description:x})}else if(r.success!==void 0){i=!1;let m=typeof r.success=="function"?await r.success(p):r.success,x=typeof r.description=="function"?await r.description(p):r.description;this.create({id:a,type:"success",message:m,description:x})}}).catch(async p=>{if(o=["reject",p],r.error!==void 0){i=!1;let m=typeof r.error=="function"?await r.error(p):r.error,x=typeof r.description=="function"?await r.description(p):r.description;this.create({id:a,type:"error",message:m,description:x})}}).finally(()=>{var p;i&&(this.dismiss(a),a=void 0),(p=r.finally)==null||p.call(r)}),d=()=>new Promise((p,m)=>c.then(()=>o[0]==="reject"?m(o[1]):p(o[1])).catch(m));return typeof a!="string"&&typeof a!="number"?{unwrap:d}:Object.assign(a,{unwrap:d})},this.custom=(t,r)=>{let a=(r==null?void 0:r.id)||Ub++;return this.create({jsx:t(a),id:a,...r}),a},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},yn=new RC,MC=(s,t)=>{let r=(t==null?void 0:t.id)||Ub++;return yn.addToast({title:s,...t,id:r}),r},FC=s=>s&&typeof s=="object"&&"ok"in s&&typeof s.ok=="boolean"&&"status"in s&&typeof s.status=="number",UC=MC,qC=()=>yn.toasts,$C=()=>yn.getActiveToasts(),Kl=Object.assign(UC,{success:yn.success,info:yn.info,warning:yn.warning,error:yn.error,custom:yn.custom,message:yn.message,promise:yn.promise,dismiss:yn.dismiss,loading:yn.loading},{getHistory:qC,getToasts:$C});function BC(s,{insertAt:t}={}){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",t==="top"&&r.firstChild?r.insertBefore(a,r.firstChild):r.appendChild(a),a.styleSheet?a.styleSheet.cssText=s:a.appendChild(document.createTextNode(s))}BC(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function rh(s){return s.label!==void 0}var VC=3,HC="32px",ZC="16px",dj=4e3,WC=356,KC=14,GC=20,YC=200;function Mi(...s){return s.filter(Boolean).join(" ")}function JC(s){let[t,r]=s.split("-"),a=[];return t&&a.push(t),r&&a.push(r),a}var XC=s=>{var t,r,a,n,i,o,c,d,p,m,x;let{invert:b,toast:h,unstyled:j,interacting:g,setHeights:v,visibleToasts:_,heights:k,index:P,toasts:L,expanded:F,removeToast:W,defaultRichColors:R,closeButton:B,style:A,cancelButtonStyle:S,actionButtonStyle:C,className:O="",descriptionClassName:Z="",duration:te,position:ce,gap:re,loadingIcon:X,expandByDefault:U,classNames:oe,icons:xe,closeButtonAriaLabel:J="Close toast",pauseWhenPageIsHidden:$}=s,[Q,q]=lt.useState(null),[I,Y]=lt.useState(null),[H,he]=lt.useState(!1),[ge,K]=lt.useState(!1),[T,ee]=lt.useState(!1),[_e,ke]=lt.useState(!1),[ue,je]=lt.useState(!1),[ne,Re]=lt.useState(0),[Oe,Je]=lt.useState(0),Be=lt.useRef(h.duration||te||dj),kt=lt.useRef(null),it=lt.useRef(null),Ft=P===0,Tt=P+1<=_,ot=h.type,Jt=h.dismissible!==!1,Vt=h.className||"",wt=h.descriptionClassName||"",Nt=lt.useMemo(()=>k.findIndex(st=>st.toastId===h.id)||0,[k,h.id]),bt=lt.useMemo(()=>{var st;return(st=h.closeButton)!=null?st:B},[h.closeButton,B]),jr=lt.useMemo(()=>h.duration||te||dj,[h.duration,te]),Zt=lt.useRef(0),ct=lt.useRef(0),Ut=lt.useRef(0),dr=lt.useRef(null),[Et,or]=ce.split("-"),qt=lt.useMemo(()=>k.reduce((st,zt,rr)=>rr>=Nt?st:st+zt.height,0),[k,Nt]),Lr=TC(),Tr=h.invert||b,ur=ot==="loading";ct.current=lt.useMemo(()=>Nt*re+qt,[Nt,qt]),lt.useEffect(()=>{Be.current=jr},[jr]),lt.useEffect(()=>{he(!0)},[]),lt.useEffect(()=>{let st=it.current;if(st){let zt=st.getBoundingClientRect().height;return Je(zt),v(rr=>[{toastId:h.id,height:zt,position:h.position},...rr]),()=>v(rr=>rr.filter(_r=>_r.toastId!==h.id))}},[v,h.id]),lt.useLayoutEffect(()=>{if(!H)return;let st=it.current,zt=st.style.height;st.style.height="auto";let rr=st.getBoundingClientRect().height;st.style.height=zt,Je(rr),v(_r=>_r.find(dt=>dt.toastId===h.id)?_r.map(dt=>dt.toastId===h.id?{...dt,height:rr}:dt):[{toastId:h.id,height:rr,position:h.position},..._r])},[H,h.title,h.description,v,h.id]);let De=lt.useCallback(()=>{K(!0),Re(ct.current),v(st=>st.filter(zt=>zt.toastId!==h.id)),setTimeout(()=>{W(h)},YC)},[h,W,v,ct]);lt.useEffect(()=>{if(h.promise&&ot==="loading"||h.duration===1/0||h.type==="loading")return;let st;return F||g||$&&Lr?(()=>{if(Ut.current<Zt.current){let zt=new Date().getTime()-Zt.current;Be.current=Be.current-zt}Ut.current=new Date().getTime()})():Be.current!==1/0&&(Zt.current=new Date().getTime(),st=setTimeout(()=>{var zt;(zt=h.onAutoClose)==null||zt.call(h,h),De()},Be.current)),()=>clearTimeout(st)},[F,g,h,ot,$,Lr,De]),lt.useEffect(()=>{h.delete&&De()},[De,h.delete]);function Qe(){var st,zt,rr;return xe!=null&&xe.loading?lt.createElement("div",{className:Mi(oe==null?void 0:oe.loader,(st=h==null?void 0:h.classNames)==null?void 0:st.loader,"sonner-loader"),"data-visible":ot==="loading"},xe.loading):X?lt.createElement("div",{className:Mi(oe==null?void 0:oe.loader,(zt=h==null?void 0:h.classNames)==null?void 0:zt.loader,"sonner-loader"),"data-visible":ot==="loading"},X):lt.createElement(AC,{className:Mi(oe==null?void 0:oe.loader,(rr=h==null?void 0:h.classNames)==null?void 0:rr.loader),visible:ot==="loading"})}return lt.createElement("li",{tabIndex:0,ref:it,className:Mi(O,Vt,oe==null?void 0:oe.toast,(t=h==null?void 0:h.classNames)==null?void 0:t.toast,oe==null?void 0:oe.default,oe==null?void 0:oe[ot],(r=h==null?void 0:h.classNames)==null?void 0:r[ot]),"data-sonner-toast":"","data-rich-colors":(a=h.richColors)!=null?a:R,"data-styled":!(h.jsx||h.unstyled||j),"data-mounted":H,"data-promise":!!h.promise,"data-swiped":ue,"data-removed":ge,"data-visible":Tt,"data-y-position":Et,"data-x-position":or,"data-index":P,"data-front":Ft,"data-swiping":T,"data-dismissible":Jt,"data-type":ot,"data-invert":Tr,"data-swipe-out":_e,"data-swipe-direction":I,"data-expanded":!!(F||U&&H),style:{"--index":P,"--toasts-before":P,"--z-index":L.length-P,"--offset":`${ge?ne:ct.current}px`,"--initial-height":U?"auto":`${Oe}px`,...A,...h.style},onDragEnd:()=>{ee(!1),q(null),dr.current=null},onPointerDown:st=>{ur||!Jt||(kt.current=new Date,Re(ct.current),st.target.setPointerCapture(st.pointerId),st.target.tagName!=="BUTTON"&&(ee(!0),dr.current={x:st.clientX,y:st.clientY}))},onPointerUp:()=>{var st,zt,rr,_r;if(_e||!Jt)return;dr.current=null;let dt=Number(((st=it.current)==null?void 0:st.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),kr=Number(((zt=it.current)==null?void 0:zt.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Ke=new Date().getTime()-((rr=kt.current)==null?void 0:rr.getTime()),nt=Q==="x"?dt:kr,Nr=Math.abs(nt)/Ke;if(Math.abs(nt)>=GC||Nr>.11){Re(ct.current),(_r=h.onDismiss)==null||_r.call(h,h),Y(Q==="x"?dt>0?"right":"left":kr>0?"down":"up"),De(),ke(!0),je(!1);return}ee(!1),q(null)},onPointerMove:st=>{var zt,rr,_r,dt;if(!dr.current||!Jt||((zt=window.getSelection())==null?void 0:zt.toString().length)>0)return;let kr=st.clientY-dr.current.y,Ke=st.clientX-dr.current.x,nt=(rr=s.swipeDirections)!=null?rr:JC(ce);!Q&&(Math.abs(Ke)>1||Math.abs(kr)>1)&&q(Math.abs(Ke)>Math.abs(kr)?"x":"y");let Nr={x:0,y:0};Q==="y"?(nt.includes("top")||nt.includes("bottom"))&&(nt.includes("top")&&kr<0||nt.includes("bottom")&&kr>0)&&(Nr.y=kr):Q==="x"&&(nt.includes("left")||nt.includes("right"))&&(nt.includes("left")&&Ke<0||nt.includes("right")&&Ke>0)&&(Nr.x=Ke),(Math.abs(Nr.x)>0||Math.abs(Nr.y)>0)&&je(!0),(_r=it.current)==null||_r.style.setProperty("--swipe-amount-x",`${Nr.x}px`),(dt=it.current)==null||dt.style.setProperty("--swipe-amount-y",`${Nr.y}px`)}},bt&&!h.jsx?lt.createElement("button",{"aria-label":J,"data-disabled":ur,"data-close-button":!0,onClick:ur||!Jt?()=>{}:()=>{var st;De(),(st=h.onDismiss)==null||st.call(h,h)},className:Mi(oe==null?void 0:oe.closeButton,(n=h==null?void 0:h.classNames)==null?void 0:n.closeButton)},(i=xe==null?void 0:xe.close)!=null?i:LC):null,h.jsx||z.isValidElement(h.title)?h.jsx?h.jsx:typeof h.title=="function"?h.title():h.title:lt.createElement(lt.Fragment,null,ot||h.icon||h.promise?lt.createElement("div",{"data-icon":"",className:Mi(oe==null?void 0:oe.icon,(o=h==null?void 0:h.classNames)==null?void 0:o.icon)},h.promise||h.type==="loading"&&!h.icon?h.icon||Qe():null,h.type!=="loading"?h.icon||(xe==null?void 0:xe[ot])||CC(ot):null):null,lt.createElement("div",{"data-content":"",className:Mi(oe==null?void 0:oe.content,(c=h==null?void 0:h.classNames)==null?void 0:c.content)},lt.createElement("div",{"data-title":"",className:Mi(oe==null?void 0:oe.title,(d=h==null?void 0:h.classNames)==null?void 0:d.title)},typeof h.title=="function"?h.title():h.title),h.description?lt.createElement("div",{"data-description":"",className:Mi(Z,wt,oe==null?void 0:oe.description,(p=h==null?void 0:h.classNames)==null?void 0:p.description)},typeof h.description=="function"?h.description():h.description):null),z.isValidElement(h.cancel)?h.cancel:h.cancel&&rh(h.cancel)?lt.createElement("button",{"data-button":!0,"data-cancel":!0,style:h.cancelButtonStyle||S,onClick:st=>{var zt,rr;rh(h.cancel)&&Jt&&((rr=(zt=h.cancel).onClick)==null||rr.call(zt,st),De())},className:Mi(oe==null?void 0:oe.cancelButton,(m=h==null?void 0:h.classNames)==null?void 0:m.cancelButton)},h.cancel.label):null,z.isValidElement(h.action)?h.action:h.action&&rh(h.action)?lt.createElement("button",{"data-button":!0,"data-action":!0,style:h.actionButtonStyle||C,onClick:st=>{var zt,rr;rh(h.action)&&((rr=(zt=h.action).onClick)==null||rr.call(zt,st),!st.defaultPrevented&&De())},className:Mi(oe==null?void 0:oe.actionButton,(x=h==null?void 0:h.classNames)==null?void 0:x.actionButton)},h.action.label):null))};function uj(){if(typeof window>"u"||typeof document>"u")return"ltr";let s=document.documentElement.getAttribute("dir");return s==="auto"||!s?window.getComputedStyle(document.documentElement).direction:s}function QC(s,t){let r={};return[s,t].forEach((a,n)=>{let i=n===1,o=i?"--mobile-offset":"--offset",c=i?ZC:HC;function d(p){["top","right","bottom","left"].forEach(m=>{r[`${o}-${m}`]=typeof p=="number"?`${p}px`:p})}typeof a=="number"||typeof a=="string"?d(a):typeof a=="object"?["top","right","bottom","left"].forEach(p=>{a[p]===void 0?r[`${o}-${p}`]=c:r[`${o}-${p}`]=typeof a[p]=="number"?`${a[p]}px`:a[p]}):d(c)}),r}z.forwardRef(function(s,t){let{invert:r,position:a="bottom-right",hotkey:n=["altKey","KeyT"],expand:i,closeButton:o,className:c,offset:d,mobileOffset:p,theme:m="light",richColors:x,duration:b,style:h,visibleToasts:j=VC,toastOptions:g,dir:v=uj(),gap:_=KC,loadingIcon:k,icons:P,containerAriaLabel:L="Notifications",pauseWhenPageIsHidden:F}=s,[W,R]=lt.useState([]),B=lt.useMemo(()=>Array.from(new Set([a].concat(W.filter($=>$.position).map($=>$.position)))),[W,a]),[A,S]=lt.useState([]),[C,O]=lt.useState(!1),[Z,te]=lt.useState(!1),[ce,re]=lt.useState(m!=="system"?m:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),X=lt.useRef(null),U=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),oe=lt.useRef(null),xe=lt.useRef(!1),J=lt.useCallback($=>{R(Q=>{var q;return(q=Q.find(I=>I.id===$.id))!=null&&q.delete||yn.dismiss($.id),Q.filter(({id:I})=>I!==$.id)})},[]);return lt.useEffect(()=>yn.subscribe($=>{if($.dismiss){R(Q=>Q.map(q=>q.id===$.id?{...q,delete:!0}:q));return}setTimeout(()=>{zC.flushSync(()=>{R(Q=>{let q=Q.findIndex(I=>I.id===$.id);return q!==-1?[...Q.slice(0,q),{...Q[q],...$},...Q.slice(q+1)]:[$,...Q]})})})}),[]),lt.useEffect(()=>{if(m!=="system"){re(m);return}if(m==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?re("dark"):re("light")),typeof window>"u")return;let $=window.matchMedia("(prefers-color-scheme: dark)");try{$.addEventListener("change",({matches:Q})=>{re(Q?"dark":"light")})}catch{$.addListener(({matches:q})=>{try{re(q?"dark":"light")}catch(I){console.error(I)}})}},[m]),lt.useEffect(()=>{W.length<=1&&O(!1)},[W]),lt.useEffect(()=>{let $=Q=>{var q,I;n.every(Y=>Q[Y]||Q.code===Y)&&(O(!0),(q=X.current)==null||q.focus()),Q.code==="Escape"&&(document.activeElement===X.current||(I=X.current)!=null&&I.contains(document.activeElement))&&O(!1)};return document.addEventListener("keydown",$),()=>document.removeEventListener("keydown",$)},[n]),lt.useEffect(()=>{if(X.current)return()=>{oe.current&&(oe.current.focus({preventScroll:!0}),oe.current=null,xe.current=!1)}},[X.current]),lt.createElement("section",{ref:t,"aria-label":`${L} ${U}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},B.map(($,Q)=>{var q;let[I,Y]=$.split("-");return W.length?lt.createElement("ol",{key:$,dir:v==="auto"?uj():v,tabIndex:-1,ref:X,className:c,"data-sonner-toaster":!0,"data-theme":ce,"data-y-position":I,"data-lifted":C&&W.length>1&&!i,"data-x-position":Y,style:{"--front-toast-height":`${((q=A[0])==null?void 0:q.height)||0}px`,"--width":`${WC}px`,"--gap":`${_}px`,...h,...QC(d,p)},onBlur:H=>{xe.current&&!H.currentTarget.contains(H.relatedTarget)&&(xe.current=!1,oe.current&&(oe.current.focus({preventScroll:!0}),oe.current=null))},onFocus:H=>{H.target instanceof HTMLElement&&H.target.dataset.dismissible==="false"||xe.current||(xe.current=!0,oe.current=H.relatedTarget)},onMouseEnter:()=>O(!0),onMouseMove:()=>O(!0),onMouseLeave:()=>{Z||O(!1)},onDragEnd:()=>O(!1),onPointerDown:H=>{H.target instanceof HTMLElement&&H.target.dataset.dismissible==="false"||te(!0)},onPointerUp:()=>te(!1)},W.filter(H=>!H.position&&Q===0||H.position===$).map((H,he)=>{var ge,K;return lt.createElement(XC,{key:H.id,icons:P,index:he,toast:H,defaultRichColors:x,duration:(ge=g==null?void 0:g.duration)!=null?ge:b,className:g==null?void 0:g.className,descriptionClassName:g==null?void 0:g.descriptionClassName,invert:r,visibleToasts:j,closeButton:(K=g==null?void 0:g.closeButton)!=null?K:o,interacting:Z,position:$,style:g==null?void 0:g.style,unstyled:g==null?void 0:g.unstyled,classNames:g==null?void 0:g.classNames,cancelButtonStyle:g==null?void 0:g.cancelButtonStyle,actionButtonStyle:g==null?void 0:g.actionButtonStyle,removeToast:J,toasts:W.filter(T=>T.position==H.position),heights:A.filter(T=>T.position==H.position),setHeights:S,expandByDefault:i,gap:_,loadingIcon:k,expanded:C,pauseWhenPageIsHidden:F,swipeDirections:s.swipeDirections})})):null}))});function eP({functionName:s,isOpen:t,onClose:r}){const{t:a}=et(),[n,i]=z.useState([]),[o,c]=z.useState(!1),[d,p]=z.useState(null),[m,x]=z.useState([]),[b,h]=z.useState(24),[j,g]=z.useState(100);async function v(){c(!0),p(null);try{const{data:{session:W}}=await Ne.auth.getSession();if(!(W!=null&&W.access_token))throw new Error("No active session");const{data:R,error:B}=await Ne.functions.invoke("get-function-logs",{body:{functionName:s,hoursBack:b,limit:j},headers:{Authorization:`Bearer ${W.access_token}`,"Content-Type":"application/json"}});if(B)throw B;if(R!=null&&R.error)throw new Error(R.error);i((R==null?void 0:R.data)||[]),Kl.success(`Loaded ${(R==null?void 0:R.count)||0} logs`)}catch(W){const R=W instanceof Error?W.message:"Failed to load logs";p(R),Kl.error(R),console.error("Error fetching logs:",W)}finally{c(!1)}}async function _(){try{const W=JSON.stringify(n,null,2),R=new Blob([W],{type:"application/json"}),B=URL.createObjectURL(R),A=document.createElement("a");A.href=B,A.download=`${s}-logs-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(A),A.click(),document.body.removeChild(A),URL.revokeObjectURL(B),Kl.success("Logs downloaded as JSON")}catch(W){Kl.error("Failed to download logs"),console.error("Download error:",W)}}async function k(){try{const W=JSON.stringify(n,null,2);await navigator.clipboard.writeText(W),Kl.success("Logs copied to clipboard")}catch(W){Kl.error("Failed to copy logs"),console.error("Copy error:",W)}}async function P(W){try{const R=JSON.stringify(W,null,2);await navigator.clipboard.writeText(R),Kl.success("Log entry copied to clipboard")}catch{Kl.error("Failed to copy log")}}function L(W){x(R=>R.includes(W)?R.filter(B=>B!==W):[...R,W])}function F(W){if(typeof W=="string")return W;try{return JSON.stringify(W,null,2)}catch{return String(W)}}return t?e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-end",children:e.jsxs("div",{className:"w-full max-h-[90vh] bg-bg-surface rounded-t-lg shadow-2xl flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"border-b border-border-subtle p-4 flex items-center justify-between bg-bg-near-black",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-text-primary",children:"Function Logs Viewer"}),e.jsxs("p",{className:"text-sm text-text-secondary mt-1",children:["Function: ",e.jsx("code",{className:"font-mono bg-bg-surface px-2 py-1 rounded",children:s})]})]}),e.jsx("button",{onClick:r,className:"p-1 hover:bg-bg-surface rounded transition-colors text-text-secondary hover:text-text-primary",children:e.jsx(Ar,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"border-b border-border-subtle p-4 space-y-3 bg-bg-near-black",children:e.jsxs("div",{className:"flex flex-wrap items-end gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Hours back:"}),e.jsxs("select",{value:b,onChange:W=>h(Number(W.target.value)),className:"px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:1,children:"Last 1 hour"}),e.jsx("option",{value:6,children:"Last 6 hours"}),e.jsx("option",{value:24,children:"Last 24 hours"}),e.jsx("option",{value:72,children:"Last 72 hours"}),e.jsx("option",{value:168,children:"Last 7 days"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Limit:"}),e.jsx("input",{type:"number",min:1,max:500,value:j,onChange:W=>g(Math.min(Number(W.target.value),500)),className:"px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none w-20"})]}),e.jsxs("button",{onClick:v,disabled:o,className:"flex items-center gap-2 px-4 py-2 bg-accent-primary hover:bg-accent-primary/80 disabled:opacity-50 text-white rounded transition-colors",children:[e.jsx(Yc,{className:`w-4 h-4 ${o?"animate-spin":""}`}),"Load Logs"]}),n.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:k,className:"flex items-center gap-2 px-4 py-2 bg-blue-500/20 hover:bg-blue-500/30 text-blue-400 rounded transition-colors",title:"Copy all logs as JSON",children:[e.jsx(Tp,{className:"w-4 h-4"}),"Copy All"]}),e.jsxs("button",{onClick:_,className:"flex items-center gap-2 px-4 py-2 bg-green-500/20 hover:bg-green-500/30 text-green-400 rounded transition-colors",title:"Download logs as JSON file",children:[e.jsx(Ir,{className:"w-4 h-4"}),"Download"]})]})]})}),d&&e.jsxs("div",{className:"p-4 bg-risk-high/10 border-b border-risk-high/30 flex items-start gap-3",children:[e.jsx(er,{className:"w-5 h-5 text-risk-high flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-text-primary font-medium",children:"Error loading logs"}),e.jsx("p",{className:"text-sm text-text-secondary mt-1",children:d})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:[n.length===0&&!o&&e.jsx("div",{className:"text-center py-12 text-text-secondary",children:n.length===0&&!d?'Click "Load Logs" to fetch function logs':"No logs found"}),n.map((W,R)=>{var C,O;const B=`log-${R}-${W.id}`,A=m.includes(B),S=W.error_message||((C=W.status_code)==null?void 0:C.toString().startsWith("4"))||((O=W.status_code)==null?void 0:O.toString().startsWith("5"));return e.jsxs("div",{className:`rounded border ${S?"border-risk-high/30 bg-risk-high/5":"border-border-subtle bg-bg-near-black"} overflow-hidden transition-colors hover:bg-bg-surface`,children:[e.jsxs("button",{onClick:()=>L(B),className:"w-full flex items-start justify-between p-3 text-left gap-3",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[A?e.jsx(K2,{className:"w-4 h-4 text-text-tertiary flex-shrink-0 mt-0.5"}):e.jsx(sx,{className:"w-4 h-4 text-text-tertiary flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap mb-1",children:[e.jsx("span",{className:`text-xs font-medium px-2 py-0.5 rounded ${S?"bg-risk-high/20 text-risk-high":"bg-green-500/15 text-green-400"}`,children:W.status_code||"OK"}),e.jsx("span",{className:"text-xs text-text-tertiary font-mono",children:new Date(W.created_at).toLocaleTimeString()}),W.execution_time_ms&&e.jsxs("span",{className:"text-xs text-text-tertiary",children:[W.execution_time_ms,"ms"]})]}),S&&W.error_message&&e.jsx("p",{className:"text-xs text-risk-high truncate",children:W.error_message})]})]}),e.jsx("button",{onClick:Z=>{Z.stopPropagation(),P(W)},className:"p-1 hover:bg-bg-surface rounded text-text-tertiary hover:text-text-secondary flex-shrink-0",title:"Copy this log entry",children:e.jsx(Tp,{className:"w-4 h-4"})})]}),A&&e.jsx("div",{className:"border-t border-border-subtle p-3 bg-bg-surface max-h-96 overflow-y-auto",children:e.jsx("pre",{className:"text-xs font-mono text-text-tertiary whitespace-pre-wrap break-words",children:F({id:W.id,created_at:W.created_at,function_name:W.function_name,status_code:W.status_code,execution_time_ms:W.execution_time_ms,error_message:W.error_message,logs:W.logs,...Object.entries(W).reduce((Z,[te,ce])=>(["id","created_at","function_name","status_code","execution_time_ms","error_message","logs"].includes(te)||(Z[te]=ce),Z),{})})})})]},B)})]}),n.length>0&&e.jsxs("div",{className:"border-t border-border-subtle p-4 bg-bg-near-black text-center text-sm text-text-secondary",children:["Showing ",n.length," log",n.length!==1?"s":""]})]})}):null}function tP(){const{t:s}=et(),{user:t}=cr(),r=new URLSearchParams(window.location.search).get("demo")==="true",a=new URLSearchParams(window.location.search).get("test")==="true",n=r||a||!(t!=null&&t.email)||t&&t.email&&t.email!=="demo@standario.com"&&t.email!=="admin@standario.com"&&t.email!=="superadmin@standario.com",i=!1,[o,c]=z.useState(""),[d,p]=z.useState(!0),[m,x]=z.useState("users"),[b,h]=z.useState([]),[j,g]=z.useState(!1),[v,_]=z.useState([]),[k,P]=z.useState(null),[L,F]=z.useState([]),[W,R]=z.useState(!1),[B,A]=z.useState([]),[S,C]=z.useState(null),[O,Z]=z.useState(!1),[te,ce]=z.useState(!1),[re,X]=z.useState([]),[U,oe]=z.useState(!1),[xe,J]=z.useState([]),[$,Q]=z.useState(""),[q,I]=z.useState(""),[Y,H]=z.useState(""),[he,ge]=z.useState(!1),[K,T]=z.useState(!1),[ee,_e]=z.useState(!1),[ke,ue]=z.useState(!1),[je,ne]=z.useState(null),[Re,Oe]=z.useState(null),[Je,Be]=z.useState(!1),[kt,it]=z.useState("admin-users"),[Ft,Tt]=z.useState({name:"",slug:"",description:"",subscription_tier:"free"}),[ot,Jt]=z.useState({email:"",password:"",full_name:"",role:"user",organization_id:""}),Vt=[{id:"demo-org-1",name:"Demo Organization 1",slug:"demo-org-1",description:"Testna organizacija za demonstracijo",subscription_tier:"premium",is_active:!0,created_at:"2024-01-01T00:00:00Z",user_count:15},{id:"demo-org-2",name:"Demo Organization 2",slug:"demo-org-2",description:"Druga testna organizacija",subscription_tier:"basic",is_active:!0,created_at:"2024-02-01T00:00:00Z",user_count:8},{id:"demo-org-3",name:"Demo Organization 3",slug:"demo-org-3",description:"Organizacija z omejenim dostopom",subscription_tier:"free",is_active:!1,created_at:"2024-03-01T00:00:00Z",user_count:2}],wt=[{id:"demo-user-1",email:"admin@demo.com",full_name:"Demo Administrator",role:"admin",organization_id:"demo-org-1",created_at:"2024-01-15T00:00:00Z",module_permissions:{nis2:!0,iso27001:!0,gdpr:!0,zzpri:!0,ai_act:!0,misp:!0,soc:!0,incidents:!0,inventory:!0,policies:!0,education:!0,support:!0}},{id:"demo-user-2",email:"user@demo.com",full_name:"Demo User",role:"user",organization_id:"demo-org-1",created_at:"2024-02-01T00:00:00Z",module_permissions:{nis2:!1,iso27001:!1,gdpr:!0,zzpri:!1,ai_act:!0,misp:!1,soc:!1,incidents:!0,inventory:!1,policies:!1,education:!0,support:!0}},{id:"demo-user-3",email:"superadmin@demo.com",full_name:"Demo Super Admin",role:"super_admin",organization_id:"demo-org-2",created_at:"2024-01-01T00:00:00Z",module_permissions:{nis2:!0,iso27001:!0,gdpr:!0,zzpri:!0,ai_act:!0,misp:!0,soc:!0,incidents:!0,inventory:!0,policies:!0,education:!0,support:!0}},{id:"demo-user-4",email:"basic@demo.com",full_name:"Demo Basic User",role:"user",organization_id:"demo-org-3",created_at:"2024-03-01T00:00:00Z",module_permissions:{nis2:!1,iso27001:!1,gdpr:!0,zzpri:!1,ai_act:!1,misp:!1,soc:!1,incidents:!1,inventory:!1,policies:!1,education:!1,support:!0}},{id:"demo-user-5",email:"manager@demo.com",full_name:"Demo Manager",role:"admin",organization_id:"demo-org-2",created_at:"2024-02-15T00:00:00Z",module_permissions:{nis2:!0,iso27001:!0,gdpr:!0,zzpri:!1,ai_act:!0,misp:!1,soc:!0,incidents:!0,inventory:!0,policies:!0,education:!0,support:!1}}],Nt=(De,Qe,st,zt,rr)=>{},bt=z.useCallback(()=>{if(!t)return;let De=!0;try{Ne.from("profiles").select("role").eq("id",t.id).maybeSingle().then(({data:Qe})=>{De&&c((Qe==null?void 0:Qe.role)||"user")}).catch(Qe=>{De&&console.error("Error loading user role:",Qe)}).finally(()=>{De&&p(!1)})}catch(Qe){De&&(console.error("Error loading user role:",Qe),p(!1))}return()=>{De=!1}},[t]);z.useEffect(()=>bt(),[bt]),z.useEffect(()=>{if(n){L.length===0&&Ut(0),m==="users"&&ct(0);return}!o||o!=="super_admin"&&o!=="admin"||(L.length===0&&Ut(0),m==="users"&&ct(0))},[o,m,$,q,Y,L.length,n]);async function jr(){const{data:{session:De}}=await Ne.auth.getSession();if(!(De!=null&&De.access_token))throw new Error("No active session - please sign in again");return{Authorization:`Bearer ${De.access_token}`,"Content-Type":"application/json"}}async function Zt(De,Qe,st=0,zt){var dt,kr,Ke;try{const nt=await jr(),Nr=new AbortController,gr=zt?void 0:setTimeout(()=>Nr.abort(),3e4),Gr=zt||Nr.signal;try{const{data:mr,error:tn}=await Ne.functions.invoke(De,{body:Qe,headers:nt,signal:Gr});if(gr&&clearTimeout(gr),tn)throw tn;if(mr!=null&&mr.error||(mr==null?void 0:mr.success)===!1)throw new Error((mr==null?void 0:mr.error)||(mr==null?void 0:mr.message)||`Function returned error: ${JSON.stringify(mr)}`);return mr}catch(mr){throw gr&&clearTimeout(gr),mr}}catch(nt){if(((nt==null?void 0:nt.name)==="FunctionsFetchError"||((dt=nt==null?void 0:nt.message)==null?void 0:dt.includes("NetworkError"))||((kr=nt==null?void 0:nt.message)==null?void 0:kr.includes("fetch"))||((Ke=nt==null?void 0:nt.message)==null?void 0:Ke.includes("network"))||(nt==null?void 0:nt.name)==="AbortError")&&st<3){const gr=500*Math.pow(2,st);return console.log(`Network error, retrying in ${gr}ms (attempt ${st+1}/3)`),await new Promise(Gr=>setTimeout(Gr,gr)),Zt(De,Qe,st+1,zt)}throw nt}}async function ct(De=0){var zt,rr,_r,dt,kr;g(!0),P(null);const Qe=performance.now(),st={action:"list",search:$,organization_id:q||void 0,role:Y||void 0};if(n){await new Promise(nt=>setTimeout(nt,800)),performance.now()-Qe;let Ke=wt;$&&(Ke=Ke.filter(nt=>{var Nr;return((Nr=nt.full_name)==null?void 0:Nr.toLowerCase().includes($.toLowerCase()))||nt.email.toLowerCase().includes($.toLowerCase())})),q&&(Ke=Ke.filter(nt=>nt.organization_id===q)),Y&&(Ke=Ke.filter(nt=>nt.role===Y)),h(Ke),P(null),g(!1);return}try{const Ke=await Zt("admin-users",st,0),nt=performance.now()-Qe;Nt("admin-users",st,{data:Ke,error:null},"success",nt),h((Ke==null?void 0:Ke.data)||[]),P(null)}catch(Ke){console.error("Error loading users:",Ke),performance.now()-Qe,Nt("admin-users",st,{error:Ke==null?void 0:Ke.message});let nt="";(zt=Ke==null?void 0:Ke.message)!=null&&zt.includes("No active session")?nt="Seja je potekla. Prosimo, prijavite se ponovno.":(Ke==null?void 0:Ke.name)==="FunctionsFetchError"||(rr=Ke==null?void 0:Ke.message)!=null&&rr.includes("NetworkError")?nt="Napaka pri povezavi s strenikom. Preverite internetno povezavo.":(Ke==null?void 0:Ke.name)==="AbortError"||(_r=Ke==null?void 0:Ke.message)!=null&&_r.includes("timeout")?nt="Zahtevek je asovno potekel. Prosimo poskusite ponovno.":(dt=Ke==null?void 0:Ke.message)!=null&&dt.includes("fetch")||(kr=Ke==null?void 0:Ke.message)!=null&&kr.includes("network")?nt="Napaka pri omreni povezavi. Prosimo poskusite ponovno.":nt=(Ke==null?void 0:Ke.message)||"Napaka pri nalaganju uporabnikov. Prosimo poskusite ponovno.",P(nt),Z(!1)}finally{g(!1)}}async function Ut(De=0){var zt,rr,_r,dt,kr;R(!0),C(null);const Qe=performance.now(),st={action:"list",search:$};if(n){await new Promise(nt=>setTimeout(nt,600)),performance.now()-Qe;let Ke=Vt;$&&(Ke=Ke.filter(nt=>{var Nr;return nt.name.toLowerCase().includes($.toLowerCase())||nt.slug.toLowerCase().includes($.toLowerCase())||((Nr=nt.description)==null?void 0:Nr.toLowerCase().includes($.toLowerCase()))})),F(Ke),C(null),R(!1);return}try{const Ke=await Zt("admin-organizations",st,0),nt=performance.now()-Qe;Nt("admin-organizations",st,{data:Ke,error:null},"success",nt),F((Ke==null?void 0:Ke.data)||[]),C(null)}catch(Ke){console.error("Error loading organizations:",Ke),performance.now()-Qe,Nt("admin-organizations",st,{error:Ke==null?void 0:Ke.message});let nt="";(zt=Ke==null?void 0:Ke.message)!=null&&zt.includes("No active session")?nt="Seja je potekla. Prosimo, prijavite se ponovno.":(Ke==null?void 0:Ke.name)==="FunctionsFetchError"||(rr=Ke==null?void 0:Ke.message)!=null&&rr.includes("NetworkError")?nt="Napaka pri povezavi s strenikom. Preverite internetno povezavo.":(Ke==null?void 0:Ke.name)==="AbortError"||(_r=Ke==null?void 0:Ke.message)!=null&&_r.includes("timeout")?nt="Zahtevek je asovno potekel. Prosimo poskusite ponovno.":(dt=Ke==null?void 0:Ke.message)!=null&&dt.includes("fetch")||(kr=Ke==null?void 0:Ke.message)!=null&&kr.includes("network")?nt="Napaka pri omreni povezavi. Prosimo poskusite ponovno.":nt=(Ke==null?void 0:Ke.message)||"Napaka pri nalaganju organizacij. Prosimo poskusite ponovno.",C(nt),ce(!1)}finally{R(!1)}}async function dr(){try{if(n){await new Promise(st=>setTimeout(st,1e3));const Qe={id:`demo-org-${Date.now()}`,name:Ft.name,slug:Ft.slug,description:Ft.description,subscription_tier:Ft.subscription_tier,is_active:!0,created_at:new Date().toISOString(),user_count:0};F(st=>[...st,Qe]),ge(!1),Tt({name:"",slug:"",description:"",subscription_tier:"free"});return}const De=await Zt("admin-organizations",{action:"create",...Ft});ge(!1),Tt({name:"",slug:"",description:"",subscription_tier:"free"}),Ut()}catch(De){console.error("Error creating organization:",De);const Qe=(De==null?void 0:De.message)||(typeof De=="string"?De:"Neznana napaka");alert("Napaka pri ustvarjanju organizacije: "+Qe)}}async function Et(De){if(confirm("Ali ste prepriani, da elite izbrisati to organizacijo?"))try{const Qe=await Zt("admin-organizations",{action:"delete",id:De});Ut()}catch(Qe){console.error("Error deleting organization:",Qe);const st=(Qe==null?void 0:Qe.message)||(typeof Qe=="string"?Qe:"Neznana napaka");alert("Napaka pri brisanju organizacije: "+st)}}async function or(){try{if(n){await new Promise(st=>setTimeout(st,1e3));const Qe={id:`demo-user-${Date.now()}`,email:ot.email,full_name:ot.full_name,role:ot.role,organization_id:ot.organization_id,created_at:new Date().toISOString(),module_permissions:{nis2:!0,iso27001:!0,gdpr:!0,zzpri:!1,ai_act:!0,misp:!1,soc:!1,incidents:!0,inventory:!1,policies:!1,education:!0,support:!0}};h(st=>[...st,Qe]),T(!1),Jt({email:"",password:"",full_name:"",role:"user",organization_id:""});return}const De=await Zt("admin-users",{action:"create",...ot});T(!1),Jt({email:"",password:"",full_name:"",role:"user",organization_id:""}),ct()}catch(De){console.error("Error creating user:",De);const Qe=(De==null?void 0:De.message)||(typeof De=="string"?De:"Neznana napaka");alert("Napaka pri ustvarjanju uporabnika: "+Qe)}}async function qt(){if(Re!=null&&Re.id)try{const De=await Zt("admin-users",{action:"update",id:Re.id,...Re});ue(!1),Oe(null),ct()}catch(De){console.error("Error updating user:",De);const Qe=(De==null?void 0:De.message)||(typeof De=="string"?De:"Neznana napaka");alert("Napaka pri posodabljanju uporabnika: "+Qe)}}async function Lr(De){if(confirm("Ali ste prepriani, da elite izbrisati tega uporabnika?"))try{const Qe=await Zt("admin-users",{action:"delete",id:De});ct()}catch(Qe){console.error("Error deleting user:",Qe);const st=(Qe==null?void 0:Qe.message)||(typeof Qe=="string"?Qe:"Neznana napaka");alert("Napaka pri brisanju uporabnika: "+st)}}async function Tr(){if(!(v.length===0||!confirm(`Ali ste prepriani, da elite izbrisati ${v.length} uporabnikov?`)))try{const De=await Zt("admin-users",{action:"bulk",operation:"delete",userIds:v});_([]),ct()}catch(De){console.error("Error bulk deleting users:",De);const Qe=(De==null?void 0:De.message)||(typeof De=="string"?De:"Neznana napaka");alert("Napaka pri mnoinem brisanju: "+Qe)}}async function ur(De){if(!(v.length===0||!De))try{const Qe=await Zt("admin-users",{action:"bulk",operation:"update_organization",userIds:v,data:{organization_id:De}});_([]),ct()}catch(Qe){console.error("Error bulk updating organization:",Qe);const st=(Qe==null?void 0:Qe.message)||(typeof Qe=="string"?Qe:"Neznana napaka");alert("Napaka pri mnoini spremembi organizacije: "+st)}}return a&&!(t!=null&&t.email)?e.jsx("div",{className:"min-h-[400px] flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Mt,{className:"w-16 h-16 text-blue-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-heading-lg font-semibold text-text-primary mb-2",children:"Testni nain"}),e.jsx("p",{className:"text-body text-text-secondary mb-4",children:"Trenutno uporabljate testni nain z simuliranimi podatki. Za dostop do pravih podatkov se prijavite z administratorskim raunom."}),e.jsxs("p",{className:"text-sm text-text-muted",children:["Dodajte ",e.jsx("code",{children:"?demo=true"})," ali ",e.jsx("code",{children:"?test=true"})," k URL-ju za testni nain"]})]})}):!n&&o!=="super_admin"&&o!=="admin"?e.jsx("div",{className:"min-h-[400px] flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Mt,{className:"w-16 h-16 text-risk-high mx-auto mb-4"}),e.jsx("h2",{className:"text-heading-lg font-semibold text-text-primary mb-2",children:"Dostop zavrnjen"}),e.jsx("p",{className:"text-body text-text-secondary",children:"Za dostop do te strani potrebujete administratorske pravice."})]})}):!n&&d?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:"Super Admin Dashboard"}),e.jsx("p",{className:"text-body text-text-secondary",children:"Upravljanje uporabnikov, organizacij in sistemskih konfiguration"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>Be(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-500/20 hover:bg-blue-500/30 text-blue-400 rounded-lg transition-colors",title:"View Supabase function logs",children:[e.jsx(ut,{className:"w-5 h-5"}),"View Logs"]}),e.jsx(ox,{className:"w-12 h-12 text-accent-primary"})]})]}),e.jsx("div",{className:"border-b border-border-subtle",children:e.jsxs("nav",{className:"flex space-x-8",children:[e.jsx("button",{onClick:()=>x("users"),className:`py-4 px-2 border-b-2 font-medium text-sm transition-colors ${m==="users"?"border-accent-primary text-accent-primary":"border-transparent text-text-secondary hover:text-text-primary hover:border-border-emphasis"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Fa,{className:"w-5 h-5"}),"Uporabniki (",b.length,")"]})}),e.jsx("button",{onClick:()=>x("organizations"),className:`py-4 px-2 border-b-2 font-medium text-sm transition-colors ${m==="organizations"?"border-accent-primary text-accent-primary":"border-transparent text-text-secondary hover:text-text-primary hover:border-border-emphasis"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(dg,{className:"w-5 h-5"}),"Organizacije (",L.length,")"]})})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ss,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-text-tertiary"}),e.jsx("input",{type:"text",placeholder:m==="users"?"Ii uporabnike...":"Ii organizacije...",value:$,onChange:De=>Q(De.target.value),className:"pl-10 pr-4 py-2 w-64 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:border-accent-primary focus:outline-none"})]}),m==="users"&&e.jsxs(e.Fragment,{children:[e.jsxs("select",{value:q,onChange:De=>I(De.target.value),className:"px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"",children:"Vse organizacije"}),L.map(De=>e.jsx("option",{value:De.id,children:De.name},De.id))]}),e.jsxs("select",{value:Y,onChange:De=>H(De.target.value),className:"px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"",children:"Vse vloge"}),e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"super_admin",children:"Super Admin"})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[m==="users"&&v.length>0&&e.jsxs("div",{className:"flex gap-2 mr-4",children:[e.jsxs("select",{onChange:De=>{De.target.value&&(ur(De.target.value),De.target.value="")},className:"px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"",children:"Premakni v organizacijo..."}),L.map(De=>e.jsx("option",{value:De.id,children:De.name},De.id))]}),e.jsxs("button",{onClick:Tr,className:"px-4 py-2 bg-risk-high hover:bg-risk-high/80 text-white rounded-lg transition-colors",children:["Izbrii (",v.length,")"]})]}),e.jsxs("button",{onClick:()=>m==="users"?T(!0):ge(!0),className:"flex items-center gap-2 px-4 py-2 bg-accent-primary hover:bg-accent-primary/80 text-white rounded-lg transition-colors",children:[e.jsx(Dt,{className:"w-4 h-4"}),m==="users"?"Dodaj uporabnika":"Dodaj organizacijo"]})]})]}),m==="users"&&k&&e.jsxs("div",{className:"bg-risk-high/10 border border-risk-high/30 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(er,{className:"w-5 h-5 text-risk-high flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-risk-high mb-1",children:"Napaka pri nalaganju uporabnikov"}),e.jsx("p",{className:"text-sm text-text-secondary mb-3",children:k}),O&&e.jsxs("p",{className:"text-sm text-accent-primary mb-2 flex items-center gap-2",children:[e.jsx(Yc,{className:"w-4 h-4 animate-spin"}),"Samodejni ponovni poskus..."]}),e.jsxs("button",{onClick:()=>ct(0),disabled:j||O,className:"flex items-center gap-2 px-4 py-2 bg-risk-high hover:bg-risk-high/80 text-white rounded-lg transition-colors disabled:opacity-50",children:[e.jsx(Yc,{className:`w-4 h-4 ${j?"animate-spin":""}`}),"Poskusi znova"]})]})]}),m==="organizations"&&S&&e.jsxs("div",{className:"bg-risk-high/10 border border-risk-high/30 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(er,{className:"w-5 h-5 text-risk-high flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-risk-high mb-1",children:"Napaka pri nalaganju organizacij"}),e.jsx("p",{className:"text-sm text-text-secondary mb-3",children:S}),te&&e.jsxs("p",{className:"text-sm text-accent-primary mb-2 flex items-center gap-2",children:[e.jsx(Yc,{className:"w-4 h-4 animate-spin"}),"Samodejni ponovni poskus..."]}),e.jsxs("button",{onClick:()=>Ut(0),disabled:W||te,className:"flex items-center gap-2 px-4 py-2 bg-risk-high hover:bg-risk-high/80 text-white rounded-lg transition-colors disabled:opacity-50",children:[e.jsx(Yc,{className:`w-4 h-4 ${W?"animate-spin":""}`}),"Poskusi znova"]})]})]}),m==="users"?e.jsx(rP,{users:b,loading:j,selectedUsers:v,setSelectedUsers:_,onEdit:De=>{Oe(De),ue(!0)},onDelete:Lr,organizations:L}):e.jsx(sP,{organizations:L,loading:W,selectedOrganizations:B,setSelectedOrganizations:A,onEdit:De=>{ne(De),_e(!0)},onDelete:Et})]}),e.jsx(zs,{isOpen:he,onClose:()=>ge(!1),title:"Ustvari novo organizacijo",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Ime organizacije *"}),e.jsx("input",{type:"text",value:Ft.name,onChange:De=>Tt({...Ft,name:De.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Slug *"}),e.jsx("input",{type:"text",value:Ft.slug,onChange:De=>Tt({...Ft,slug:De.target.value.toLowerCase().replace(/\s+/g,"-")}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Opis"}),e.jsx("textarea",{value:Ft.description,onChange:De=>Tt({...Ft,description:De.target.value}),rows:3,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Subscription Tier"}),e.jsxs("select",{value:Ft.subscription_tier,onChange:De=>Tt({...Ft,subscription_tier:De.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"free",children:"Free"}),e.jsx("option",{value:"basic",children:"Basic"}),e.jsx("option",{value:"premium",children:"Premium"}),e.jsx("option",{value:"enterprise",children:"Enterprise"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{onClick:()=>ge(!1),className:"px-4 py-2 text-text-secondary hover:text-text-primary transition-colors",children:"Preklii"}),e.jsx("button",{onClick:dr,disabled:!Ft.name||!Ft.slug,className:"bg-accent-primary hover:bg-accent-primary/80 px-4 py-2 rounded transition-colors text-white disabled:opacity-50",children:"Ustvari"})]})]})}),e.jsx(zs,{isOpen:K,onClose:()=>T(!1),title:"Ustvari novega uporabnika",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Email *"}),e.jsx("input",{type:"email",value:ot.email,onChange:De=>Jt({...ot,email:De.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Geslo *"}),e.jsx("input",{type:"password",value:ot.password,onChange:De=>Jt({...ot,password:De.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Polno ime"}),e.jsx("input",{type:"text",value:ot.full_name,onChange:De=>Jt({...ot,full_name:De.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Vloga"}),e.jsxs("select",{value:ot.role,onChange:De=>Jt({...ot,role:De.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"super_admin",children:"Super Admin"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Organizacija *"}),e.jsxs("select",{value:ot.organization_id,onChange:De=>Jt({...ot,organization_id:De.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",required:!0,children:[e.jsx("option",{value:"",children:"Izberi organizacijo"}),L.map(De=>e.jsx("option",{value:De.id,children:De.name},De.id))]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{onClick:()=>T(!1),className:"px-4 py-2 text-text-secondary hover:text-text-primary transition-colors",children:"Preklii"}),e.jsx("button",{onClick:or,disabled:!ot.email||!ot.password||!ot.organization_id,className:"bg-accent-primary hover:bg-accent-primary/80 px-4 py-2 rounded transition-colors text-white disabled:opacity-50",children:"Ustvari"})]})]})}),e.jsx(zs,{isOpen:ke,onClose:()=>{ue(!1),Oe(null)},title:"Uredi uporabnika",children:Re&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Email"}),e.jsx("input",{type:"email",value:Re.email||"",onChange:De=>Oe({...Re,email:De.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Polno ime"}),e.jsx("input",{type:"text",value:Re.full_name||"",onChange:De=>Oe({...Re,full_name:De.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Vloga"}),e.jsxs("select",{value:Re.role||"user",onChange:De=>Oe({...Re,role:De.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"super_admin",children:"Super Admin"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Organizacija"}),e.jsxs("select",{value:Re.organization_id||"",onChange:De=>Oe({...Re,organization_id:De.target.value}),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"",children:"Izberi organizacijo"}),L.map(De=>e.jsx("option",{value:De.id,children:De.name},De.id))]})]}),e.jsxs("div",{className:"pt-4 border-t border-border-subtle",children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-3",children:"Dovoljenja za module"}),e.jsx("div",{className:"space-y-2",children:[{key:"nis2",label:"NIS 2 / ZInfV-1"},{key:"iso27001",label:"ISO 27001"},{key:"gdpr",label:"GDPR / ZVOP-2"},{key:"zzpri",label:"ZZPri"},{key:"ai_act",label:"AI Act"},{key:"misp",label:"MISP"},{key:"soc",label:"SOC"},{key:"incidents",label:"Incidenti"},{key:"inventory",label:"Inventar"},{key:"policies",label:"Politike in postopki"},{key:"education",label:"Izobraevanje"},{key:"support",label:"Podpora"}].map(De=>{var Qe;return e.jsxs("label",{className:"flex items-center gap-3 p-2 hover:bg-bg-near-black rounded cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:((Qe=Re.module_permissions)==null?void 0:Qe[De.key])??!0,onChange:st=>{const zt=Re.module_permissions||{};Oe({...Re,module_permissions:{...zt,[De.key]:st.target.checked}})},className:"rounded border-border-subtle focus:ring-accent-primary"}),e.jsx("span",{className:"text-sm text-text-primary",children:De.label})]},De.key)})})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-border-subtle",children:[e.jsx("button",{onClick:()=>{ue(!1),Oe(null)},className:"px-4 py-2 text-text-secondary hover:text-text-primary transition-colors",children:"Preklii"}),e.jsx("button",{onClick:qt,className:"bg-accent-primary hover:bg-accent-primary/80 px-4 py-2 rounded transition-colors text-white",children:"Shrani"})]})]})}),i,i,e.jsx(eP,{functionName:kt,isOpen:Je,onClose:()=>Be(!1)})]})}function rP({users:s,loading:t,selectedUsers:r,setSelectedUsers:a,onEdit:n,onDelete:i,organizations:o}){const c=m=>{a(r.includes(m)?r.filter(x=>x!==m):[...r,m])},d=()=>{a(r.length===s.length?[]:s.map(m=>m.id))};if(t)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})});const p=m=>m?Object.values(m).filter(x=>x===!0).length:12;return e.jsxs("div",{className:"bg-bg-surface rounded-lg border border-border-subtle overflow-hidden",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-near-black",children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-12 px-6 py-4 text-left",children:e.jsx("input",{type:"checkbox",checked:r.length===s.length&&s.length>0,onChange:d,className:"rounded"})}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-text-secondary",children:"Ime"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-text-secondary",children:"Email"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-text-secondary",children:"Vloga"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-text-secondary",children:"Organizacija"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-text-secondary",children:"Moduli"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-text-secondary",children:"Ustvarjeno"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-text-secondary",children:"Dejanja"})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:s.map(m=>{var b;const x=p(m.module_permissions);return e.jsxs("tr",{className:"hover:bg-bg-near-black",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("input",{type:"checkbox",checked:r.includes(m.id),onChange:()=>c(m.id),className:"rounded"})}),e.jsx("td",{className:"px-6 py-4 text-text-primary",children:m.full_name||"-"}),e.jsx("td",{className:"px-6 py-4 text-text-primary",children:m.email}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-caption font-medium uppercase ${m.role==="super_admin"?"bg-risk-high/15 text-risk-high":m.role==="admin"?"bg-risk-medium/15 text-risk-medium":"bg-bg-surface-hover text-text-secondary"}`,children:m.role})}),e.jsx("td",{className:"px-6 py-4 text-text-secondary",children:((b=o.find(h=>h.id===m.organization_id))==null?void 0:b.name)||"-"}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:`px-3 py-1 rounded-full text-caption font-medium ${x===12?"bg-green-500/15 text-green-400":x===0?"bg-risk-high/15 text-risk-high":"bg-blue-500/15 text-blue-400"}`,children:[x,"/12"]})}),e.jsx("td",{className:"px-6 py-4 text-text-secondary",children:new Date(m.created_at).toLocaleDateString("sl-SI")}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>n(m),className:"p-1 text-text-secondary hover:text-accent-primary",children:e.jsx(ar,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>i(m.id),className:"p-1 text-text-secondary hover:text-risk-high",children:e.jsx(pr,{className:"w-4 h-4"})})]})})]},m.id)})})]}),s.length===0&&e.jsx("div",{className:"text-center py-12 text-text-secondary",children:"Ni najdenih uporabnikov"})]})}function sP({organizations:s,loading:t,selectedOrganizations:r,setSelectedOrganizations:a,onEdit:n,onDelete:i}){return t?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})}):e.jsxs("div",{className:"bg-bg-surface rounded-lg border border-border-subtle overflow-hidden",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-near-black",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-text-secondary",children:"Ime"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-text-secondary",children:"Slug"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-text-secondary",children:"Tier"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-text-secondary",children:"Stanje"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-text-secondary",children:"Uporabniki"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-text-secondary",children:"Ustvarjeno"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-text-secondary",children:"Dejanja"})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:s.map(o=>e.jsxs("tr",{className:"hover:bg-bg-near-black",children:[e.jsx("td",{className:"px-6 py-4 text-text-primary",children:o.name}),e.jsx("td",{className:"px-6 py-4 text-text-secondary",children:o.slug}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-caption font-medium uppercase ${o.subscription_tier==="enterprise"?"bg-accent-primary/15 text-accent-primary":o.subscription_tier==="premium"?"bg-blue-500/15 text-blue-400":o.subscription_tier==="basic"?"bg-green-500/15 text-green-400":"bg-bg-surface-hover text-text-secondary"}`,children:o.subscription_tier})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-caption font-medium ${o.is_active?"bg-green-500/15 text-green-400":"bg-risk-medium/15 text-risk-medium"}`,children:o.is_active?"Aktivna":"Neaktivna"})}),e.jsx("td",{className:"px-6 py-4 text-text-secondary",children:o.user_count||0}),e.jsx("td",{className:"px-6 py-4 text-text-secondary",children:new Date(o.created_at).toLocaleDateString("sl-SI")}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>n(o),className:"p-1 text-text-secondary hover:text-accent-primary",children:e.jsx(ar,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>i(o.id),className:"p-1 text-text-secondary hover:text-risk-high",children:e.jsx(pr,{className:"w-4 h-4"})})]})})]},o.id))})]}),s.length===0&&e.jsx("div",{className:"text-center py-12 text-text-secondary",children:"Ni najdenih organizacij"})]})}function aP({setCurrentPage:s}){const{t}=et(),[r,a]=z.useState([]),[n,i]=z.useState(!0),[o,c]=z.useState(null),[d,p]=z.useState(null),m=new URLSearchParams(window.location.search).get("demo")==="true",x=z.useCallback(async()=>{if(i(!0),c(null),m){setTimeout(()=>{a(b()),p(new Date),c("Demo nain: Prikazani so testni MISP podatki"),i(!1)},1e3);return}try{const k="https://ckxlbiiirfdogobccmjs.supabase.co/functions/v1/fetch-misp-feed";console.log("Fetching MISP data from:",k);const P=await fetch(k,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},signal:AbortSignal.timeout(3e4)});if(!P.ok)throw console.error(`HTTP error: ${P.status} ${P.statusText}`),new Error(`HTTP ${P.status}: ${P.statusText}`);const L=await P.json();if(L.demo||!L.success||!L.events){console.warn("MISP feed returned demo flag or no data:",L),a(b()),p(new Date),c(L.error?`Dostop do CERT.si ni na voljo: ${L.error}. Prikazani so demo podatki.`:"Prikazani so demo podatki - dostop do CERT.si MISP feed-a trenutno ni na voljo");return}a(L.events),p(new Date),c(null)}catch(_){console.error("Error fetching MISP data:",_),a(b()),p(new Date);const k=(_==null?void 0:_.message)||"Neznana napaka pri pridobivanju podatkov";k.includes("abort")||k.includes("timeout")?c("Zahteva je potekla. Prikazani so demo podatki."):k.includes("Network")||k.includes("fetch")?c("Mrena napaka. Prikazani so demo podatki."):c(`Napaka pri pridobivanju podatkov: ${k}. Prikazani so demo podatki.`)}finally{i(!1)}},[m]),b=()=>[{id:"1",uuid:"demo-uuid-1",date:new Date().toISOString().split("T")[0],info:"Phishing kampanja ciljana na slovenske uporabnike",threat_level_id:"2",published:!0,timestamp:Date.now().toString(),attribute_count:"15",analysis:"2",orgc:{name:"SI-CERT",uuid:"cert-si-uuid"}},{id:"2",uuid:"demo-uuid-2",date:new Date(Date.now()-864e5).toISOString().split("T")[0],info:"Malware distribucija preko kompromitiranih spletnih strani",threat_level_id:"3",published:!0,timestamp:(Date.now()-864e5).toString(),attribute_count:"8",analysis:"1",orgc:{name:"SI-CERT",uuid:"cert-si-uuid"}},{id:"3",uuid:"demo-uuid-3",date:new Date(Date.now()-2*864e5).toISOString().split("T")[0],info:"Ransomware napad na slovensko infrastrukturo",threat_level_id:"1",published:!0,timestamp:(Date.now()-2*864e5).toString(),attribute_count:"22",analysis:"2",orgc:{name:"SI-CERT",uuid:"cert-si-uuid"}}];z.useEffect(()=>{x()},[x]);const h=_=>{switch(_){case"1":return e.jsx(vr,{type:"risk",value:"high"});case"2":return e.jsx(vr,{type:"risk",value:"medium"});case"3":return e.jsx(vr,{type:"risk",value:"low"});case"4":return e.jsx(vr,{type:"status",value:"Nedefinirana"});default:return e.jsx(vr,{type:"status",value:"Neznana"})}},j=_=>{switch(_){case"0":return e.jsx(vr,{type:"status",value:"Odprt"});case"1":return e.jsx(vr,{type:"status",value:"V obdelavi"});case"2":return e.jsx(vr,{type:"status",value:"Zaprt"});default:return e.jsx(vr,{type:"status",value:"Neznana"})}},g=_=>new Date(parseInt(_)*1e3).toLocaleString("sl-SI"),v=[{key:"info",header:"Opis dogodka",render:_=>e.jsxs("div",{className:"max-w-md",children:[e.jsx("div",{className:"font-medium text-text-primary mb-1",children:_.info}),e.jsxs("div",{className:"text-body-sm text-text-secondary",children:["ID: ",_.id," | UUID: ",_.uuid.substring(0,8),"..."]})]})},{key:"date",header:"Datum",render:_=>e.jsxs("div",{className:"text-body-sm",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(_a,{className:"w-4 h-4 text-text-secondary"}),e.jsx("span",{children:_.date})]}),e.jsx("div",{className:"text-text-secondary",children:g(_.timestamp)})]})},{key:"threat_level",header:"Stopnja gronje",render:_=>h(_.threat_level_id)},{key:"analysis",header:"Status analize",render:_=>j(_.analysis)},{key:"attributes",header:"Atributi",render:_=>e.jsx("div",{className:"text-center",children:e.jsx("span",{className:"text-accent-primary font-medium",children:_.attribute_count})})},{key:"organization",header:"Organizacija",render:_=>{var k;return e.jsx("div",{className:"text-body-sm",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(nx,{className:"w-4 h-4 text-text-secondary"}),e.jsx("span",{children:((k=_.orgc)==null?void 0:k.name)||"SI-CERT"})]})})}}];return e.jsx("div",{className:"min-h-screen bg-bg-near-black",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-accent-primary/20 flex items-center justify-center",children:e.jsx(pt,{className:"w-6 h-6 text-accent-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"MISP - Kibernetske gronje"}),e.jsx("p",{className:"text-body text-text-secondary",children:"Informacije o kibernetskih gronjah iz SI-CERT MISP feed-a"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Mt,{className:"w-5 h-5 text-accent-primary"}),e.jsx("span",{className:"text-body-sm font-medium text-text-secondary",children:"Skupaj dogodkov"})]}),e.jsx("div",{className:"text-h3 font-bold text-text-primary",children:r.length})]}),e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(pt,{className:"w-5 h-5 text-red-500"}),e.jsx("span",{className:"text-body-sm font-medium text-text-secondary",children:"Visoke gronje"})]}),e.jsx("div",{className:"text-h3 font-bold text-text-primary",children:r.filter(_=>_.threat_level_id==="1").length})]}),e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Th,{className:"w-5 h-5 text-accent-primary"}),e.jsx("span",{className:"text-body-sm font-medium text-text-secondary",children:"Vir"})]}),e.jsx("div",{className:"text-body font-medium text-text-primary",children:"SI-CERT"})]}),e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(_a,{className:"w-5 h-5 text-accent-primary"}),e.jsx("span",{className:"text-body-sm font-medium text-text-secondary",children:"Zadnja posodobitev"})]}),e.jsx("div",{className:"text-body-sm text-text-primary",children:d?d.toLocaleString("sl-SI"):"Ni podatka"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:x,disabled:n,className:"flex items-center gap-2 px-4 py-2 bg-accent-primary text-white rounded-lg hover:bg-accent-primary/90 disabled:opacity-50 transition-colors",children:[e.jsx(Yc,{className:`w-4 h-4 ${n?"animate-spin":""}`}),"Posodobi podatke"]}),e.jsx("a",{href:"https://www.cert.si/navodila-za-misp-feed/",target:"_blank",rel:"noopener noreferrer",className:"text-body text-accent-primary hover:text-accent-primary/80 transition-colors",children:"Ve o CERT.si MISP feed "})]})]}),o&&e.jsx("div",{className:"mb-6 p-4 bg-yellow-500/20 border border-yellow-500/40 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pt,{className:"w-5 h-5 text-yellow-500"}),e.jsx("span",{className:"text-body text-yellow-200",children:o})]})}),e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg",children:[e.jsxs("div",{className:"p-6 border-b border-border-subtle",children:[e.jsx("h2",{className:"text-h3 font-semibold text-text-primary",children:"Nedavni kibernetski incidenti"}),e.jsx("p",{className:"text-body text-text-secondary mt-1",children:"Pregled kibernetskih gronji iz Slovenije in regije"})]}),n?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary mx-auto"}),e.jsx("p",{className:"mt-4 text-text-secondary",children:"Nalagam MISP podatke..."})]}):e.jsx(dl,{title:"MISP Dogodki",data:r,columns:v})]}),e.jsxs("div",{className:"mt-8 p-6 bg-bg-surface border border-border-subtle rounded-lg",children:[e.jsx("h3",{className:"text-h4 font-semibold text-text-primary mb-3",children:"O MISP podatkih"}),e.jsx("div",{className:"prose prose-invert max-w-none",children:e.jsx("p",{className:"text-body text-text-secondary",children:"MISP (Malware Information Sharing Platform) je odprta platforma za deljenje informacij o kibernetskih gronjah. SI-CERT uporablja MISP za zbiranje in deljenje informacij o kibernetskih incidentih v Sloveniji."})})]})]})})}function nP(){const{t:s}=et(),{signIn:t}=cr(),[r,a]=z.useState(""),[n,i]=z.useState(""),[o,c]=z.useState(""),[d,p]=z.useState(!1);async function m(h){h.preventDefault(),c(""),p(!0);try{await t(r,n)}catch(j){c(j.message||s("auth.loginError"))}finally{p(!1)}}const{i18n:x}=et(),b=h=>{x.changeLanguage(h)};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-bg-near-black",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsx("div",{className:"flex flex-col items-center mb-8",children:e.jsx(Y2,{size:"xl"})}),e.jsx("div",{className:"flex justify-center mb-8",children:e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:x.language,onChange:h=>b(h.target.value),className:`appearance-none bg-bg-surface-elevated border border-border-subtle rounded-md
                       px-4 py-2 pr-8 text-body-sm text-text-primary
                       focus:outline-none focus:border-accent-primary focus:ring-3 focus:ring-accent-primary/15
                       transition-all duration-200 cursor-pointer`,children:[e.jsx("option",{value:"sl",children:" Slovenina"}),e.jsx("option",{value:"en",children:" English"})]}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none",children:e.jsx(nx,{className:"h-4 w-4 text-text-secondary"})})]})}),e.jsx("div",{className:"bg-bg-surface-elevated p-10 rounded-lg border border-border-moderate",children:e.jsxs("form",{onSubmit:m,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-body-sm font-medium text-text-primary mb-2",children:s("auth.emailAddress")}),e.jsx("input",{id:"email",type:"email",value:r,onChange:h=>a(h.target.value),required:!0,className:`w-full h-12 px-4 bg-bg-near-black border border-border-subtle rounded-md
                         text-body text-text-primary placeholder-text-tertiary
                         focus:outline-none focus:border-accent-primary focus:ring-3 focus:ring-accent-primary/15
                         transition-all duration-200`,placeholder:s("auth.emailPlaceholder")})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-body-sm font-medium text-text-primary mb-2",children:s("auth.password")}),e.jsx("input",{id:"password",type:"password",value:n,onChange:h=>i(h.target.value),required:!0,minLength:6,className:`w-full h-12 px-4 bg-bg-near-black border border-border-subtle rounded-md
                         text-body text-text-primary placeholder-text-tertiary
                         focus:outline-none focus:border-accent-primary focus:ring-3 focus:ring-accent-primary/15
                         transition-all duration-200`,placeholder:s("auth.passwordPlaceholder")})]}),o&&e.jsx("div",{className:"p-4 bg-risk-high/15 border border-risk-high/30 rounded-md",children:e.jsx("p",{className:"text-body-sm text-risk-high",children:o})}),e.jsx("button",{type:"submit",disabled:d,className:`w-full h-12 bg-accent-primary text-white font-semibold rounded-sm
                       hover:brightness-110 hover:shadow-glow-accent-sm
                       active:translate-y-0 disabled:opacity-50 disabled:cursor-not-allowed
                       transition-all duration-150`,children:s(d?"auth.signingIn":"auth.login")})]})})]})})}function sh({title:s,subtitle:t,children:r,defaultOpen:a=!1,sectionNumber:n}){const[i,o]=z.useState(a);return e.jsxs("div",{className:"bg-gray-800/30 border border-gray-700/50 rounded-xl overflow-hidden",children:[e.jsxs("button",{type:"button",onClick:()=>o(!i),className:"w-full px-6 py-4 flex items-center justify-between bg-gray-700/30 hover:bg-gray-700/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3 text-left",children:[n&&e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-600/20 border border-blue-500/30 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-blue-400 font-semibold text-sm",children:n})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:s}),t&&e.jsx("p",{className:"text-sm text-gray-400 mt-0.5",children:t})]})]}),e.jsx(sx,{className:`w-5 h-5 text-gray-400 transition-transform duration-200 ${i?"rotate-180":""}`})]}),i&&e.jsx("div",{className:"px-6 py-6 space-y-6",children:r})]})}const Mf=[{category:"Zlonamerna vsebina",value:"zlonamerna_vsebina"},{category:"Zlonamerna koda",value:"zlonamerna_koda"},{category:"Zbiranje informacij",value:"zbiranje_informacij"},{category:"Poizkusi vdora",value:"poizkusi_vdora"},{category:"Vdori",value:"vdori"},{category:"Razpololjivost",value:"razpolozljivost"},{category:"Varnost informacijskih virov",value:"varnost_informacijskih_virov"},{category:"Goljufije",value:"goljufije"},{category:"Ranljivost",value:"ranljivost"},{category:"Drugo",value:"drugo"},{category:"Test",value:"test"}],Ff=[{label:"Prvo poroilo zavezanca",value:"prvo_porocilo"},{label:"Vmesno/konno poroilo",value:"vmesno_porocilo"},{label:"Prvo obveanje PNO",value:"obvescanje_pno"}],ah=[{value:"prostovoljna_priglasitev",label:"Prostovoljna priglasitev incidenta"},{value:"prvo_porocilo",label:"Prvo poroilo o incidentu zavezanca"},{value:"vmesno_porocilo",label:"Vmesno poroilo o incidentu zavezanca"},{value:"koncno_porocilo",label:"Konno poroilo o incidentu zavezanca"}],iP=["Energetika","Promet","Bannitvo","Infrastruktura finannega trga","Zdravstvo","Pitna voda","Odpadna voda","Digitalna infrastruktura","Javna uprava","Vesolje","Drugo"],oP=["Nizka","Srednja","Visoka","Kritina"],lP=["1","2","3","4","5"],cP=["V reevanju","Zakljuen"],dP=[{id:"demo-1",incident_number:null,detection_datetime:"2024-10-15T08:30:00Z",incident_type:"zlonamerna_koda",incident_description:"Ransomware napad na glavni datoteni strenik",impact_assessment:"Visok vpliv na poslovanje, 500+ uporabnikov prizadetih",incident_status:"v teku",entity_identifier:"ORG-001",contact_name:"Janez Novak",contact_phone:"+386 41 123 456",contact_email:"janez.novak@podjetje.si",report_datetime:"2024-10-15T09:15:00Z",incident_cause:"zlonamerno dejanje",incident_impact:"ifriranje datotek, zahteva za odkupnino",response_measures:"Izolacija prizadetega sistema, aktiviran incidentni nart",lessons_learned:"Potreba po boljem rednem varnostnem kopiranju",report_type:"prvo_porocilo",created_at:"2024-10-15T09:20:00Z",updated_at:"2024-10-15T09:20:00Z",referencna_stevilka:"INC-2024-001",zadeva:"Ransomware napad na datoteni strenik",tip_porocila:"prvo_porocilo",naziv_subjekta:"Podjetje d.o.o.",sektor:"Digitalna infrastruktura",kontakt_tehnicni_ime:"Marko Bergant",kontakt_tehnicni_email:"marko.bergant@podjetje.si",kontakt_tehnicni_telefon:"+386 41 234 567",kontakt_oseba_ime:"Janez Novak",kontakt_oseba_email:"janez.novak@podjetje.si",kontakt_oseba_telefon:"+386 41 123 456",zacetek_incidenta:"2024-10-15T08:30:00Z",cas_zaznave:"2024-10-15T08:45:00Z",opis_incidenta:"Ransomware napad je prizadel glavni datoteni strenik. Datoteke so bile ifrirane z .locked ekstenzijo. Zahtevana je bila odkupnina v Bitcoin vrednosti 50.000 EUR.",taksonomija:"zlonamerna_koda",ocena_nevarnosti:"Kritina",ocena_vpliva:"Visok vpliv na poslovanje - 500+ uporabnikov ne more dostopati do svojih datotek. Kritine poslovne aplikacije so na voljo.",stopnja_incidenta:"4",opombe:"Napad se je verjetno zael prek phishing e-pote",cas_zadnjega_porocanja:"2024-10-15T09:15:00Z",trenutno_stanje:"V reevanju",opis_napake_sistem:"Windows Server 2019 datoteni strenik",opis_napake_streznik:"Primarni file server DC01",opis_napake_aplikacije:"Shared folders, print services",opis_napake_drugo:null,izvor_usb:!1,izvor_email:!0,izvor_vdor:!1,izvor_spletno:!1,izvor_datoteke:!1,izvor_drugo:"Phishing e-pota",ogrozena_storitev_zinfv:!1,ogrozena_storitev_ostale:!0,cezmejni_vpliv_da_ne:!1,cezmejni_vpliv_opis:null,akcijski_ze_sprejeti:"Izolacija prizadetega strenika iz mree, aktiviran incidentni nart, kontaktiranje SI-CERT",akcijski_nacrtovani:"Obnova podatkov iz varnostnih kopij, popravila varnostnih lukenj, olanja zaposlenih",povzrocena_skoda:"Ocenjena na 25.000 EUR (stroki obnove, izpad delovanja)",potrebe_odprava:"Bolji backup sistem, spam filter, security awareness training",casovni_okvir:"7 dni",priloge_seznam:"Email screenshot, virus scan report, network diagram"},{id:"demo-2",incident_number:null,detection_datetime:"2024-10-10T14:20:00Z",incident_type:"varnost_informacijskih_virov",incident_description:"Napano poiljanje e-pote z osebnimi podatki",impact_assessment:"Srednji vpliv, prizadetih 50 posameznikov",incident_status:"reen",entity_identifier:"ORG-001",contact_name:"Ana Kova",contact_phone:"+386 51 789 123",contact_email:"ana.kovac@podjetje.si",report_datetime:"2024-10-10T15:00:00Z",incident_cause:"loveka napaka",incident_impact:"Razkritje osebnih podatkov (ime, priimek, naslov, davna tevilka)",response_measures:"Takojen umik e-pote, obveanje prejemnikov",lessons_learned:"Potreba po implementaciji DLP reitve",report_type:"koncno_porocilo",created_at:"2024-10-10T15:05:00Z",updated_at:"2024-10-12T10:30:00Z",referencna_stevilka:"INC-2024-002",zadeva:"Napano poiljanje osebnih podatkov",tip_porocila:"koncno_porocilo",naziv_subjekta:"Podjetje d.o.o.",sektor:"Javna uprava",kontakt_tehnicni_ime:"Toma Zorman",kontakt_tehnicni_email:"tomaz.zorman@podjetje.si",kontakt_tehnicni_telefon:"+386 51 345 678",kontakt_oseba_ime:"Ana Kova",kontakt_oseba_email:"ana.kovac@podjetje.si",kontakt_oseba_telefon:"+386 51 789 123",zacetek_incidenta:"2024-10-10T14:20:00Z",cas_zaznave:"2024-10-10T14:20:00Z",opis_incidenta:"Zaposleni je po pomoti poslal e-poto z Excel datoteko, ki je vsebovala seznam zaposlenih z osebnimi podatki na napaen e-potni naslov namesto internega.",taksonomija:"varnost_informacijskih_virov",ocena_nevarnosti:"Srednja",ocena_vpliva:"Srednji vpliv - prizadetih 50 posameznikov, podatki so bili poslani na neznano e-poto, vendar smo uspeli kontaktirati prejemnika.",stopnja_incidenta:"2",opombe:"Prejemnik je bil ustrezno obveen in je datoteko izbrisal",cas_zadnjega_porocanja:"2024-10-12T10:30:00Z",trenutno_stanje:"Zakljuen",opis_napake_sistem:null,opis_napake_streznik:null,opis_napake_aplikacije:"Microsoft Outlook",opis_napake_drugo:null,izvor_usb:!1,izvor_email:!0,izvor_vdor:!1,izvor_spletno:!1,izvor_datoteke:!1,izvor_drugo:"loveka napaka",ogrozena_storitev_zinfv:!1,ogrozena_storitev_ostale:!1,cezmejni_vpliv_da_ne:!1,cezmejni_vpliv_opis:null,akcijski_ze_sprejeti:"Takojen umik e-pote, obveanje prejemnika, izbris datoteke, obveanje prizadetih",akcijski_nacrtovani:"Implementacija DLP reitve, olanja zaposlenih",povzrocena_skoda:"Ocenjena na 2.000 EUR (administrativni stroki, as)",potrebe_odprava:"DLP reitev, varnostno olanja",casovni_okvir:"30 dni",priloge_seznam:"Email screenshot, acknowledgment from recipient, notification to affected individuals"},{id:"demo-3",incident_number:null,detection_datetime:"2024-10-08T22:15:00Z",incident_type:"vdori",incident_description:"Neavtoriziran dostop do strenika prek RDP",impact_assessment:"Visok vpliv, sistem je bil ogroen 4 ure",incident_status:"v teku",entity_identifier:"ORG-001",contact_name:"Peter Medved",contact_phone:"+386 40 987 654",contact_email:"peter.medved@podjetje.si",report_datetime:"2024-10-08T22:30:00Z",incident_cause:"zlonamerno dejanje",incident_impact:"Neavtoriziran dostop do interno mree",response_measures:"Brisanje uporabnikih raunov, sprememba gesel",lessons_learned:"Potreba po RDP gateway in MFA",report_type:"vmesno_porocilo",created_at:"2024-10-08T22:35:00Z",updated_at:"2024-10-09T08:00:00Z",referencna_stevilka:"INC-2024-003",zadeva:"Neavtoriziran dostop do sistema",tip_porocila:"vmesno_porocilo",naziv_subjekta:"Podjetje d.o.o.",sektor:"Digitalna infrastruktura",kontakt_tehnicni_ime:"Miha Dragar",kontakt_tehnicni_email:"miha.dragar@podjetje.si",kontakt_tehnicni_telefon:"+386 40 876 543",kontakt_oseba_ime:"Peter Medved",kontakt_oseba_email:"peter.medved@podjetje.si",kontakt_oseba_telefon:"+386 40 987 654",zacetek_incidenta:"2024-10-08T18:30:00Z",cas_zaznave:"2024-10-08T22:15:00Z",opis_incidenta:"Zaznali smo neavtoriziran dostop do Windows strenika prek RDP protokola. Napadalec je uporabil brute force napad na RDP dostop in uspeno vstopil v sistem.",taksonomija:"vdori",ocena_nevarnosti:"Visoka",ocena_vpliva:"Visok vpliv - napadalec je imel dostop do interne mree 4 ure, vendar ni uspel pridobiti dostopa do kritinih sistemov.",stopnja_incidenta:"3",opombe:"Napad je priel iz IP naslova iz Romunije",cas_zadnjega_porocanja:"2024-10-09T08:00:00Z",trenutno_stanje:"V reevanju",opis_napake_sistem:"Windows Server 2019, RDP enabled",opis_napake_streznik:"PRIMARY-DC01",opis_napake_aplikacije:"File services, Active Directory",opis_napake_drugo:null,izvor_usb:!1,izvor_email:!1,izvor_vdor:!0,izvor_spletno:!0,izvor_datoteke:!1,izvor_drugo:"Brute force RDP attack",ogrozena_storitev_zinfv:!1,ogrozena_storitev_ostale:!0,cezmejni_vpliv_da_ne:!1,cezmejni_vpliv_opis:null,akcijski_ze_sprejeti:"Onemogoen RDP dostop, sprememba vseh gesel, log audit",akcijski_nacrtovani:"Namestitev RDP Gateway, implementacija MFA, VPN reitev",povzrocena_skoda:"Ocenjena na 8.000 EUR (forensics, ukrepi)",potrebe_odprava:"RDP Gateway, MFA, SIEM sistem",casovni_okvir:"14 dni",priloge_seznam:"RDP login logs, network traffic analysis, forensic report"},{id:"demo-4",incident_number:null,detection_datetime:"2024-10-05T11:45:00Z",incident_type:"ranljivost",incident_description:"Kompromitacija gesla sistemskega administratorja",impact_assessment:"Visok vpliv, administratorjevo geslo je bilo ukradeno",incident_status:"reen",entity_identifier:"ORG-001",contact_name:"Sandra Horvat",contact_phone:"+386 30 654 321",contact_email:"sandra.horvat@podjetje.si",report_datetime:"2024-10-05T12:00:00Z",incident_cause:"zlonamerno dejanje",incident_impact:"Dostop do vseh sistemov za 2 uri",response_measures:"Takojnja sprememba gesel, two-factor authentication",lessons_learned:"Implementacija MFA je nujna",report_type:"koncno_porocilo",created_at:"2024-10-05T12:10:00Z",updated_at:"2024-10-06T16:45:00Z",referencna_stevilka:"INC-2024-004",zadeva:"Kompromitacija gesla",tip_porocila:"koncno_porocilo",naziv_subjekta:"Podjetje d.o.o.",sektor:"Bannitvo",kontakt_tehnicni_ime:"Alja Koir",kontakt_tehnicni_email:"aljaz.kosir@podjetje.si",kontakt_tehnicni_telefon:"+386 30 765 432",kontakt_oseba_ime:"Sandra Horvat",kontakt_oseba_email:"sandra.horvat@podjetje.si",kontakt_oseba_telefon:"+386 30 654 321",zacetek_incidenta:"2024-10-05T09:00:00Z",cas_zaznave:"2024-10-05T11:45:00Z",opis_incidenta:"Sistemski administrator je kliknil na phishing povezavo v e-poti, kar je privedlo do kraja uporabnikih podatkov prek keyloggerja. Napadalec je nato zlorabil njegove podatke za dostop do sistema.",taksonomija:"ranljivost",ocena_nevarnosti:"Kritina",ocena_vpliva:"Kritien vpliv - napadalec je z administratorjevimi pravicami imel dostop do vseh sistemov za 2 uri. Mono je bilo ogroeni podatkov in konfiguracij.",stopnja_incidenta:"5",opombe:"Incident je bil odkrit s pomojo SIEM sistema",cas_zadnjega_porocanja:"2024-10-06T16:45:00Z",trenutno_stanje:"Zakljuen",opis_napake_sistem:"Windows Domain Controller",opis_napake_streznik:"DC-PRIMARY",opis_napake_aplikacije:"Active Directory, File Server, Database Server",opis_napake_drugo:null,izvor_usb:!1,izvor_email:!0,izvor_vdor:!1,izvor_spletno:!0,izvor_datoteke:!1,izvor_drugo:"Phishing with keylogger",ogrozena_storitev_zinfv:!0,ogrozena_storitev_ostale:!0,cezmejni_vpliv_da_ne:!1,cezmejni_vpliv_opis:null,akcijski_ze_sprejeti:"Sprememba vseh gesel, onemogoenje rauna, antivirus scan, SIEM monitoring",akcijski_nacrtovani:"MFA za vse administratorske raune, security awareness training, email filtering",povzrocena_skoda:"Ocenjena na 35.000 EUR (investigacija, obnovitev, preventivni ukrepi)",potrebe_odprava:"MFA reitev, napredna email security, redna olanja",casovni_okvir:"7 dni",priloge_seznam:"SIEM logs, phishing email, system audit, security assessment report"},{id:"demo-5",incident_number:null,detection_datetime:"2024-10-02T16:30:00Z",incident_type:"varnost_informacijskih_virov",incident_description:"Izguba prenosne naprave z zaupnimi podatki",impact_assessment:"Srednji vpliv, naprava z medsebojnimi podatki",incident_status:"reen",entity_identifier:"ORG-001",contact_name:"Martin Kosec",contact_phone:"+386 70 111 222",contact_email:"martin.kosec@podjetje.si",report_datetime:"2024-10-02T17:00:00Z",incident_cause:"loveka napaka",incident_impact:"Izguba prenosnega raunalnika z zaupnimi podatki",response_measures:"Oddaljena blokada naprave, sprememba gesel",lessons_learned:"Potreba po BitLocker ifriranju in MDM",report_type:"koncno_porocilo",created_at:"2024-10-02T17:05:00Z",updated_at:"2024-10-04T14:20:00Z",referencna_stevilka:"INC-2024-005",zadeva:"Izguba prenosne naprave",tip_porocila:"koncno_porocilo",naziv_subjekta:"Podjetje d.o.o.",sektor:"Javna uprava",kontakt_tehnicni_ime:"Katja Pavlin",kontakt_tehnicni_email:"katja.pavlin@podjetje.si",kontakt_tehnicni_telefon:"+386 70 333 444",kontakt_oseba_ime:"Martin Kosec",kontakt_oseba_email:"martin.kosec@podjetje.si",kontakt_oseba_telefon:"+386 70 111 222",zacetek_incidenta:"2024-10-02T14:00:00Z",cas_zaznave:"2024-10-02T16:30:00Z",opis_incidenta:"Zaposleni je na potovanju v Ljubljani izgubil prenosni raunalnik z delovnega potovanja. Naprava je vsebovala Excel datoteke s projektnimi podatki in seznamom strank.",taksonomija:"varnost_informacijskih_virov",ocena_nevarnosti:"Nizka",ocena_vpliva:"Nizek do srednji vpliv - naprava je bila ifrirana z BitLocker, vendar je bil moen dostop do podatkov prek gesla, e ga je napadalec poznal. Prizadeti so projektni podatki in podatki strank.",stopnja_incidenta:"2",opombe:"Naprava je bila pozneje najdena, vendar je bila vklopljena",cas_zadnjega_porocanja:"2024-10-04T14:20:00Z",trenutno_stanje:"Zakljuen",opis_napake_sistem:"Windows 11 laptop",opis_napake_streznik:null,opis_napake_aplikacije:"Microsoft Office, project management software",opis_napake_drugo:null,izvor_usb:!1,izvor_email:!1,izvor_vdor:!1,izvor_spletno:!1,izvor_datoteke:!1,izvor_drugo:"loveka napaka - izguba",ogrozena_storitev_zinfv:!1,ogrozena_storitev_ostale:!1,cezmejni_vpliv_da_ne:!1,cezmejni_vpliv_opis:null,akcijski_ze_sprejeti:"Oddaljena blokada naprave, sprememba gesel, sprememba pristopnih podatkov do sistemov",akcijski_nacrtovani:"Implementacija MDM reitve, izboljanje ifriranja, politika za prenosne naprave",povzrocena_skoda:"Ocenjena na 3.500 EUR (nakup nove naprave, administrativni stroki)",potrebe_odprava:"MDM sistem, BitLocker with TPM, device usage policy",casovni_okvir:"14 dni",priloge_seznam:"Incident report, device tracking logs, recovery confirmation, policy update"}];function uP(){var q,I,Y;const{user:s}=cr(),[t,r]=z.useState("form"),[a,n]=z.useState([]),[i,o]=z.useState([]),[c,d]=z.useState("all"),[p,m]=z.useState(!1),[x,b]=z.useState(!1),[h,j]=z.useState(null),[g,v]=z.useState(null),[_,k]=z.useState(!1),[P,L]=z.useState(!1),[F,W]=z.useState(!1),[R,B]=z.useState(null),[A]=z.useState(new URLSearchParams(window.location.search).get("demo")==="true"),[S,C]=z.useState({incident_number:"",detection_datetime:"",incident_type:"",incident_description:"",impact_assessment:"",incident_status:"v teku",entity_identifier:"",contact_name:"",contact_phone:"",contact_email:"",report_datetime:new Date().toISOString().slice(0,16),incident_cause:"",incident_impact:"",response_measures:"",lessons_learned:"",report_type:"prvo_porocilo",referencna_stevilka:"",zadeva:"",tip_porocila:"prvo_porocilo",naziv_subjekta:"",sektor:"",kontakt_tehnicni_ime:"",kontakt_tehnicni_email:"",kontakt_tehnicni_telefon:"",kontakt_oseba_ime:"",kontakt_oseba_email:"",kontakt_oseba_telefon:"",zacetek_incidenta:"",cas_zaznave:"",opis_incidenta:"",taksonomija:"",ocena_nevarnosti:"",ocena_vpliva:"",stopnja_incidenta:"",opombe:"",cas_zadnjega_porocanja:"",trenutno_stanje:"",opis_napake_sistem:"",opis_napake_streznik:"",opis_napake_aplikacije:"",opis_napake_drugo:"",izvor_usb:!1,izvor_email:!1,izvor_vdor:!1,izvor_spletno:!1,izvor_datoteke:!1,izvor_drugo:"",ogrozena_storitev_zinfv:!1,ogrozena_storitev_ostale:!1,cezmejni_vpliv_da_ne:!1,cezmejni_vpliv_opis:"",akcijski_ze_sprejeti:"",akcijski_nacrtovani:"",povzrocena_skoda:"",potrebe_odprava:"",casovni_okvir:"",priloge_seznam:""});z.useEffect(()=>{(async()=>{if(s)try{const{data:he,error:ge}=await Ne.from("profiles").select("*, organization_id").eq("id",s.id).single();if(ge)throw ge;B(he)}catch(he){console.error("Error fetching user profile:",he)}})()},[s]),z.useEffect(()=>{(A||R!=null&&R.organization_id)&&O()},[R,A]),z.useEffect(()=>{let H=a;a.length===0&&(H=dP),o(c==="all"?H:H.filter(he=>he.report_type===c||he.tip_porocila===c))},[a,c]);const O=async()=>{if(!A&&!(R!=null&&R.organization_id)){m(!1);return}if(m(!0),A){n([]),m(!1);return}try{const{data:H,error:he}=await Ne.from("cyber_incident_reports").select("*").eq("organization_id",R.organization_id).order("created_at",{ascending:!1});if(he)throw he;n(H||[])}catch(H){console.error("Napaka pri nalaganju poroil:",H)}finally{m(!1)}},Z=(H,he)=>{C(ge=>({...ge,[H]:he}))},te=()=>{const he=["zadeva","naziv_subjekta","sektor","kontakt_oseba_ime","kontakt_oseba_email","zacetek_incidenta","cas_zaznave","opis_incidenta","taksonomija","ocena_nevarnosti","ocena_vpliva","stopnja_incidenta"].filter(K=>!S[K]);return he.length>0?(j({type:"error",text:`Manjkajo obvezna polja: ${he.join(", ")}`}),!1):/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(S.kontakt_oseba_email)?!0:(j({type:"error",text:"Neveljaven format e-potnega naslova"}),!1)},ce=async H=>{if(H.preventDefault(),!!te()){b(!0),j(null);try{const he=Object.fromEntries(Object.entries(S).map(([K,T])=>[K,T===""?null:T]));he.organization_id=R.organization_id;const{error:ge}=await Ne.from("cyber_incident_reports").insert([he]);if(ge)throw console.error("Supabase error:",ge),new Error(`Napaka pri shranjevanju: ${ge.message}`);j({type:"success",text:"Poroilo je bilo uspeno shranjeno in si ga lahko ogledate med ostalimi poroili, tako da zgoraj kliknete na opcijo Seznam poroil. V podrobnostih posameznega poroila lahko poroilo izvozite in kot Prilogo E poljete na SI-CERT."}),setTimeout(()=>{r("list"),j(null)},5e3),C({incident_number:"",detection_datetime:"",incident_type:"",incident_description:"",impact_assessment:"",incident_status:"v teku",entity_identifier:"",contact_name:"",contact_phone:"",contact_email:"",report_datetime:new Date().toISOString().slice(0,16),incident_cause:"",incident_impact:"",response_measures:"",lessons_learned:"",report_type:"prvo_porocilo",referencna_stevilka:"",zadeva:"",tip_porocila:"prvo_porocilo",naziv_subjekta:"",sektor:"",kontakt_tehnicni_ime:"",kontakt_tehnicni_email:"",kontakt_tehnicni_telefon:"",kontakt_oseba_ime:"",kontakt_oseba_email:"",kontakt_oseba_telefon:"",zacetek_incidenta:"",cas_zaznave:"",opis_incidenta:"",taksonomija:"",ocena_nevarnosti:"",ocena_vpliva:"",stopnja_incidenta:"",opombe:"",cas_zadnjega_porocanja:"",trenutno_stanje:"",opis_napake_sistem:"",opis_napake_streznik:"",opis_napake_aplikacije:"",opis_napake_drugo:"",izvor_usb:!1,izvor_email:!1,izvor_vdor:!1,izvor_spletno:!1,izvor_datoteke:!1,izvor_drugo:"",ogrozena_storitev_zinfv:!1,ogrozena_storitev_ostale:!1,cezmejni_vpliv_da_ne:!1,cezmejni_vpliv_opis:"",akcijski_ze_sprejeti:"",akcijski_nacrtovani:"",povzrocena_skoda:"",potrebe_odprava:"",casovni_okvir:"",priloge_seznam:""}),O()}catch(he){console.error("Napaka pri poiljanju poroila:",he),j({type:"error",text:he instanceof Error?he.message:"Napaka pri poiljanju poroila. Poskusite ponovno."})}finally{b(!1)}}},re=async H=>{var he;W(!0);try{const{data:ge,error:K}=await Ne.functions.invoke("generate-incident-report-pdf",{body:{reportId:H.id}});if(K)throw new Error("Napaka pri generiranju PDF");const T=new Blob([ge],{type:"text/html"}),ee=URL.createObjectURL(T),_e=H.incident_number||H.referencna_stevilka||`INC-${H.id.slice(0,8)}`,ke=new Date().toISOString().split("T")[0],ue=`Porocilo_${_e}_${ke}.html`,je=document.createElement("a");je.href=ee,je.download=ue,je.click(),URL.revokeObjectURL(ee);const ne=encodeURIComponent(`Prijava incidenta - ${H.zadeva||H.referencna_stevilka||"Nov incident"}`),Re=encodeURIComponent(`Spotovani,

v prilogi vam poiljam poroilo o kibernetskem incidentu.

Osnovni podatki:
- Zadeva: ${H.zadeva||"N/A"}
- Referenna tevilka: ${H.referencna_stevilka||"N/A"}
- Tip poroila: ${((he=ah.find(Oe=>Oe.value===H.tip_porocila))==null?void 0:he.label)||H.tip_porocila||"N/A"}
- Subjekt: ${H.naziv_subjekta||"N/A"}

NAVODILA:
1. PDF poroilo je bilo avtomatsko preneseno na va raunalnik (${ue})
2. Odprite HTML datoteko v brskalniku
3. Natisnite v PDF (File  Print  Save as PDF)
4. Priloite konni PDF k temu sporoilu pred poiljanjem

Lep pozdrav,
${H.kontakt_oseba_ime||H.contact_name||""}`);setTimeout(()=>{window.location.href=`mailto:cert@cert.si?subject=${ne}&body=${Re}`},500),alert("Dokument (Priloga E - NOKI) je prenesen, e-potni odjemalec se bo odprl. Sledite navodilom v sporoilu za dokonanje poiljanja na SI-CERT.")}catch(ge){console.error("Napaka pri poiljanju na SI-CERT:",ge),alert(`Napaka: ${ge instanceof Error?ge.message:"Poskusite ponovno."}`)}finally{W(!1)}},X=H=>{switch(H){case"v teku":return e.jsx(cs,{className:"w-4 h-4 text-yellow-400"});case"reen":return e.jsx(Rt,{className:"w-4 h-4 text-green-400"});case"zaprt":return e.jsx(Ar,{className:"w-4 h-4 text-gray-400"});default:return e.jsx(pt,{className:"w-4 h-4 text-orange-400"})}},U=H=>{const he="inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium";switch(H){case"v teku":return`${he} bg-yellow-500/20 text-yellow-400 border border-yellow-500/30`;case"reen":return`${he} bg-green-500/20 text-green-400 border border-green-500/30`;case"zaprt":return`${he} bg-gray-500/20 text-gray-400 border border-gray-500/30`;default:return`${he} bg-orange-500/20 text-orange-400 border border-orange-500/30`}},oe=H=>{const he="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium";switch(H){case"prvo_porocilo":return`${he} bg-blue-500/20 text-blue-400 border border-blue-500/30`;case"vmesno_porocilo":return`${he} bg-purple-500/20 text-purple-400 border border-purple-500/30`;case"obvescanje_pno":return`${he} bg-red-500/20 text-red-400 border border-red-500/30`;default:return`${he} bg-gray-500/20 text-gray-400 border border-gray-500/30`}},xe=H=>{const he=Ff.find(ge=>ge.value===H);return he?he.label:H},J=H=>{v(H),k(!0)},$=()=>{k(!1),v(null)},Q=async H=>{L(!0);try{const{data:he,error:ge}=await Ne.functions.invoke("generate-incident-report-pdf",{body:{reportId:H.id}});if(ge)throw ge;const K=new Blob([he],{type:"text/html"}),T=URL.createObjectURL(K),ee=window.open(T,"_blank");ee&&(ee.onload=()=>{setTimeout(()=>{ee.print()},250)});const _e=H.incident_number||`INC-${H.id.slice(0,8)}`,ke=new Date().toISOString().split("T")[0],ue=`Porocilo_${_e}_${ke}.html`,je=document.createElement("a");je.href=T,je.download=ue,je.click(),URL.revokeObjectURL(T)}catch(he){console.error("PDF export error:",he),alert("Napaka pri izvozu PDF. Poskusite ponovno.")}finally{L(!1)}};return!A&&!(R!=null&&R.organization_id)&&p?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):!A&&!(R!=null&&R.organization_id)?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(pt,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("h3",{className:"text-lg font-medium text-gray-300 mb-2",children:"Organizacija je obvezna"}),e.jsx("p",{className:"text-gray-400",children:"Dostop do poroil zahteva povezavo z organizacijo."})]})}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Poroanje o kibernetskih incidentih"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"NOKI - Nacionalni nart odzivanja na kibernetske incidente"})]})}),e.jsxs("div",{className:"flex space-x-1 bg-gray-800/50 p-1 rounded-lg w-fit",children:[e.jsx("button",{onClick:()=>r("form"),className:`px-4 py-2 rounded-md text-sm font-medium transition-all ${t==="form"?"bg-blue-600 text-white shadow-lg shadow-blue-600/25":"text-gray-400 hover:text-white hover:bg-gray-700/50"}`,children:"Novo poroilo"}),e.jsx("button",{onClick:()=>r("list"),className:`px-4 py-2 rounded-md text-sm font-medium transition-all ${t==="list"?"bg-blue-600 text-white shadow-lg shadow-blue-600/25":"text-gray-400 hover:text-white hover:bg-gray-700/50"}`,children:"Seznam poroil"})]}),t==="form"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("form",{onSubmit:ce,className:"space-y-6",children:[e.jsx(sh,{title:"Osnovni podatki incidenta",subtitle:"Referenna tevilka, zadeva in tip poroila",sectionNumber:"0",defaultOpen:!0,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Referenna tevilka"}),e.jsx("input",{type:"text",value:S.referencna_stevilka,onChange:H=>Z("referencna_stevilka",H.target.value),className:"w-full px-4 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",placeholder:"Doloi odzivni center",disabled:!0,readOnly:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Zadeva *"}),e.jsx("input",{type:"text",value:S.zadeva,onChange:H=>Z("zadeva",H.target.value),className:"w-full px-4 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",placeholder:"Zadeva incidenta",required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:"Tip poroila *"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:ah.map(H=>e.jsx("button",{type:"button",onClick:()=>Z("tip_porocila",H.value),className:`p-3 text-left rounded-lg border transition-all ${S.tip_porocila===H.value?"border-blue-500 bg-blue-500/20 text-blue-400":"border-gray-600/50 bg-gray-700/30 text-gray-300 hover:border-gray-500"}`,children:e.jsx("div",{className:"font-medium text-sm",children:H.label})},H.value))})]})]})}),e.jsx(sh,{title:"Splone informacije o poroevalcu",subtitle:"Podatki o subjektu in kontaktne informacije",sectionNumber:"1",defaultOpen:!0,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Naziv subjekta, ki poroa *"}),e.jsx("input",{type:"text",value:S.naziv_subjekta,onChange:H=>Z("naziv_subjekta",H.target.value),className:"w-full px-4 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",placeholder:"Ime organizacije",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Sektor zavezanca *"}),e.jsxs("select",{value:S.sektor,onChange:H=>Z("sektor",H.target.value),className:"w-full px-4 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",required:!0,children:[e.jsx("option",{value:"",children:"Izberite sektor"}),iP.map(H=>e.jsx("option",{value:H,children:H},H))]})]}),e.jsxs("div",{className:"md:col-span-2 bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-400 mb-3",children:"Kontaktni podatki za tehnina vpraanja"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Ime in priimek"}),e.jsx("input",{type:"text",value:S.kontakt_tehnicni_ime,onChange:H=>Z("kontakt_tehnicni_ime",H.target.value),className:"w-full px-4 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",placeholder:"Ime priimek"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"E-pota"}),e.jsx("input",{type:"email",value:S.kontakt_tehnicni_email,onChange:H=>Z("kontakt_tehnicni_email",H.target.value),className:"w-full px-4 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",placeholder:"ime@podjetje.si"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Telefon"}),e.jsx("input",{type:"tel",value:S.kontakt_tehnicni_telefon,onChange:H=>Z("kontakt_tehnicni_telefon",H.target.value),className:"w-full px-4 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",placeholder:"+386 XX XXX XXX"})]})]})]}),e.jsxs("div",{className:"md:col-span-2 bg-purple-500/10 border border-purple-500/30 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-purple-400 mb-3",children:"Kontaktna oseba zavezanca"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Ime in priimek *"}),e.jsx("input",{type:"text",value:S.kontakt_oseba_ime,onChange:H=>Z("kontakt_oseba_ime",H.target.value),className:"w-full px-4 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",placeholder:"Ime priimek",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"E-pota *"}),e.jsx("input",{type:"email",value:S.kontakt_oseba_email,onChange:H=>Z("kontakt_oseba_email",H.target.value),className:"w-full px-4 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",placeholder:"ime@podjetje.si",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Telefon"}),e.jsx("input",{type:"tel",value:S.kontakt_oseba_telefon,onChange:H=>Z("kontakt_oseba_telefon",H.target.value),className:"w-full px-4 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",placeholder:"+386 XX XXX XXX"})]})]})]})]})}),e.jsx(sh,{title:"Zaetne informacije o incidentu",subtitle:"Podrobnosti o incidentu in oceni vpliva",sectionNumber:"2",defaultOpen:!1,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Zaetek/nastanek incidenta *"}),e.jsx("input",{type:"datetime-local",value:S.zacetek_incidenta,onChange:H=>Z("zacetek_incidenta",H.target.value),className:"w-full px-4 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"as zaznave incidenta v sistemu *"}),e.jsx("input",{type:"datetime-local",value:S.cas_zaznave,onChange:H=>Z("cas_zaznave",H.target.value),className:"w-full px-4 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Opis incidenta *"}),e.jsx("textarea",{value:S.opis_incidenta,onChange:H=>Z("opis_incidenta",H.target.value),rows:4,className:"w-full px-4 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",placeholder:"Opiite incident...",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Taksonomija *"}),e.jsxs("select",{value:S.taksonomija,onChange:H=>Z("taksonomija",H.target.value),className:"w-full px-4 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",required:!0,children:[e.jsx("option",{value:"",children:"Izberite taksonomijo"}),Mf.map(H=>e.jsx("option",{value:H.value,children:H.category},H.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Ocena stopnje nevarnosti *"}),e.jsxs("select",{value:S.ocena_nevarnosti,onChange:H=>Z("ocena_nevarnosti",H.target.value),className:"w-full px-4 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",required:!0,children:[e.jsx("option",{value:"",children:"Izberite oceno"}),oP.map(H=>e.jsx("option",{value:H,children:H},H))]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Ocena monega vpliva *"}),e.jsx("textarea",{value:S.ocena_vpliva,onChange:H=>Z("ocena_vpliva",H.target.value),rows:3,className:"w-full px-4 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",placeholder:"Ocenite moni vpliv incidenta...",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Ocena stopnje incidenta (1-5) *"}),e.jsxs("select",{value:S.stopnja_incidenta,onChange:H=>Z("stopnja_incidenta",H.target.value),className:"w-full px-4 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",required:!0,children:[e.jsx("option",{value:"",children:"Izberite stopnjo"}),lP.map(H=>e.jsxs("option",{value:H,children:["Stopnja ",H]},H))]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Opombe"}),e.jsx("textarea",{value:S.opombe,onChange:H=>Z("opombe",H.target.value),rows:2,className:"w-full px-4 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",placeholder:"Dodatne opombe..."})]})]})}),e.jsx(sh,{title:"Vmesno/konno poroanje",subtitle:"Stanje incidenta, ukrepi in posledice",sectionNumber:"3",defaultOpen:!1,children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"as zadnjega poroanja"}),e.jsx("input",{type:"datetime-local",value:S.cas_zadnjega_porocanja,onChange:H=>Z("cas_zadnjega_porocanja",H.target.value),className:"w-full px-4 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Trenutno stanje kibernetskega incidenta"}),e.jsxs("select",{value:S.trenutno_stanje,onChange:H=>Z("trenutno_stanje",H.target.value),className:"w-full px-4 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",children:[e.jsx("option",{value:"",children:"Izberite stanje"}),cP.map(H=>e.jsx("option",{value:H,children:H},H))]})]})]}),e.jsxs("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-red-400 mb-3",children:"Opis napake - Prizadeta sredstva"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Sistem"}),e.jsx("textarea",{value:S.opis_napake_sistem,onChange:H=>Z("opis_napake_sistem",H.target.value),rows:2,className:"w-full px-4 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",placeholder:"Okvara/zloraba sistema..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Strenik"}),e.jsx("textarea",{value:S.opis_napake_streznik,onChange:H=>Z("opis_napake_streznik",H.target.value),rows:2,className:"w-full px-4 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",placeholder:"Okvara/zloraba strenika..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Aplikacije"}),e.jsx("textarea",{value:S.opis_napake_aplikacije,onChange:H=>Z("opis_napake_aplikacije",H.target.value),rows:2,className:"w-full px-4 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",placeholder:"Nedelujoe aplikacije..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Drugo"}),e.jsx("textarea",{value:S.opis_napake_drugo,onChange:H=>Z("opis_napake_drugo",H.target.value),rows:2,className:"w-full px-4 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",placeholder:"Druge napake..."})]})]})]}),e.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-yellow-400 mb-3",children:"Izvor incidenta"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:S.izvor_usb,onChange:H=>Z("izvor_usb",H.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500 focus:ring-offset-gray-800"}),e.jsx("span",{className:"text-sm text-gray-300",children:"USB klju"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:S.izvor_email,onChange:H=>Z("izvor_email",H.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500 focus:ring-offset-gray-800"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Elektronsko sporoilo"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:S.izvor_vdor,onChange:H=>Z("izvor_vdor",H.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500 focus:ring-offset-gray-800"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Vdor v sistem"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:S.izvor_spletno,onChange:H=>Z("izvor_spletno",H.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500 focus:ring-offset-gray-800"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Spletno mesto"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:S.izvor_datoteke,onChange:H=>Z("izvor_datoteke",H.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500 focus:ring-offset-gray-800"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Zlonamerne datoteke"})]}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Drugo (opredelite)"}),e.jsx("input",{type:"text",value:S.izvor_drugo,onChange:H=>Z("izvor_drugo",H.target.value),className:"w-full px-4 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",placeholder:"Opredelite drug izvor..."})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:S.ogrozena_storitev_zinfv,onChange:H=>Z("ogrozena_storitev_zinfv",H.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500 focus:ring-offset-gray-800"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Bistvena storitev ZInfV"})]})}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:S.ogrozena_storitev_ostale,onChange:H=>Z("ogrozena_storitev_ostale",H.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500 focus:ring-offset-gray-800"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Ostale storitve"})]})})]}),e.jsxs("div",{className:"bg-orange-500/10 border border-orange-500/30 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-orange-400 mb-3",children:"ezmejni vpliv incidenta"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:S.cezmejni_vpliv_da_ne,onChange:H=>Z("cezmejni_vpliv_da_ne",H.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500 focus:ring-offset-gray-800"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Ali ima incident vpliv na druge drave?"})]}),S.cezmejni_vpliv_da_ne&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Opis ezmejnega vpliva (katera drava, kaken vpliv)"}),e.jsx("textarea",{value:S.cezmejni_vpliv_opis,onChange:H=>Z("cezmejni_vpliv_opis",H.target.value),rows:3,className:"w-full px-4 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",placeholder:"Opiite ezmejni vpliv..."})]})]})]}),e.jsxs("div",{className:"bg-green-500/10 border border-green-500/30 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-green-400 mb-3",children:"Akcijski nart in protiukrepi"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"e sprejeti ukrepi"}),e.jsx("textarea",{value:S.akcijski_ze_sprejeti,onChange:H=>Z("akcijski_ze_sprejeti",H.target.value),rows:3,className:"w-full px-4 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",placeholder:"Opiite ukrepe, ki so bili e sprejeti..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Nartovani ukrepi"}),e.jsx("textarea",{value:S.akcijski_nacrtovani,onChange:H=>Z("akcijski_nacrtovani",H.target.value),rows:3,className:"w-full px-4 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",placeholder:"Opiite nartovane ukrepe..."})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Povzroena koda"}),e.jsx("textarea",{value:S.povzrocena_skoda,onChange:H=>Z("povzrocena_skoda",H.target.value),rows:2,className:"w-full px-4 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",placeholder:"Opiite povzroeno kodo..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Potrebe za odpravo posledic"}),e.jsx("textarea",{value:S.potrebe_odprava,onChange:H=>Z("potrebe_odprava",H.target.value),rows:2,className:"w-full px-4 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",placeholder:"Opiite potrebe za odpravo..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"asovni okvir odprave posledic"}),e.jsx("input",{type:"text",value:S.casovni_okvir,onChange:H=>Z("casovni_okvir",H.target.value),className:"w-full px-4 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",placeholder:"npr. 24 ur, 3 dni..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Priloge (seznam dokumentov)"}),e.jsx("textarea",{value:S.priloge_seznam,onChange:H=>Z("priloge_seznam",H.target.value),rows:2,className:"w-full px-4 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",placeholder:"Seznam priloenih dokumentov..."})]})]})]})}),h&&e.jsx("div",{className:`p-4 rounded-lg border ${h.type==="success"?"bg-green-500/20 text-green-400 border-green-500/30":"bg-red-500/20 text-red-400 border-red-500/30"}`,children:h.text}),e.jsx("div",{className:"flex justify-end gap-3",children:e.jsx("button",{type:"submit",disabled:x,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-white font-medium rounded-lg transition-all duration-200 shadow-lg shadow-blue-600/25",children:x?"Shranjujem...":"Shrani poroilo"})})]})}),t==="list"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Filtriraj po vrsti poroila"}),e.jsxs("select",{value:c,onChange:H=>d(H.target.value),className:"px-4 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",children:[e.jsx("option",{value:"all",children:"Vsi tipi"}),Ff.map(H=>e.jsx("option",{value:H.value,children:H.label},H.value))]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{onClick:O,disabled:p,className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 disabled:opacity-50 text-white font-medium rounded-lg transition-all duration-200",children:p?"Nalagam...":"Osvei"})})]}),e.jsx("div",{className:"bg-gray-800/30 border border-gray-700/50 rounded-xl overflow-hidden",children:e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-700/30 border-b border-gray-700/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Incident"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Naziv subjekta"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Tip poroila"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Datum zaetka"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Akcije"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700/50",children:i.map(H=>{var he,ge;return e.jsxs("tr",{className:"hover:bg-gray-700/20 transition-colors",children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsxs("div",{className:"text-sm text-white font-medium flex items-center gap-2",children:[e.jsx("span",{children:H.referencna_stevilka||H.incident_number||`INC-${H.id.slice(0,8)}`}),H.id.startsWith("demo-")&&e.jsx("span",{className:"px-2 py-1 text-xs bg-orange-500/20 text-orange-400 border border-orange-500/30 rounded-full",children:"DEMO"})]}),e.jsx("div",{className:"text-sm text-gray-400 max-w-xs truncate",children:H.zadeva||H.opis_incidenta||H.incident_description||"-"})]}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm text-white",children:H.naziv_subjekta||H.entity_identifier||"-"}),e.jsx("div",{className:"text-sm text-gray-400",children:H.sektor||"-"})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:oe(H.tip_porocila||H.report_type),children:((he=ah.find(K=>K.value===H.tip_porocila))==null?void 0:he.label)||((ge=Ff.find(K=>K.value===H.report_type))==null?void 0:ge.label)||H.tip_porocila||H.report_type||"-"})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm text-white",children:H.zacetek_incidenta?new Date(H.zacetek_incidenta).toLocaleDateString("sl-SI"):H.detection_datetime?new Date(H.detection_datetime).toLocaleDateString("sl-SI"):"-"}),e.jsx("div",{className:"text-sm text-gray-400",children:H.zacetek_incidenta?new Date(H.zacetek_incidenta).toLocaleTimeString("sl-SI"):H.detection_datetime?new Date(H.detection_datetime).toLocaleTimeString("sl-SI"):""})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:U(H.trenutno_stanje||H.incident_status),children:[X(H.trenutno_stanje||H.incident_status),H.trenutno_stanje||H.incident_status]})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("button",{onClick:()=>J(H),className:"inline-flex items-center justify-center p-2 rounded-lg bg-blue-600/20 hover:bg-blue-600/30 border border-blue-500/30 transition-all duration-200 group",title:"Podrobnosti poroila",children:e.jsx(lr,{className:"w-5 h-5 text-blue-400 group-hover:text-blue-300"})})})]},H.id)})})]}),i.length===0&&!p&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(pt,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-300",children:"Ni poroil"}),e.jsx("p",{className:"mt-1 text-sm text-gray-400",children:c==="all"?"e ni bilo ustvarjenih poroil.":"Ni poroil za izbrani tip."})]}),a.length===0&&!p&&i.length>0&&e.jsx("div",{className:"text-center py-6",children:e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[e.jsx(pt,{className:"w-5 h-5 text-blue-400"}),e.jsx("h3",{className:"text-sm font-medium text-blue-400",children:"Demo podatki"})]}),e.jsx("p",{className:"text-sm text-blue-300",children:"Prikazani so primeri testnih zapisov incidentov. V bazi podatkov ni realnih poroil za to organizacijo."})]})})]})})]}),_&&g&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-700/50 rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto shadow-2xl",children:[e.jsxs("div",{className:"sticky top-0 bg-gray-800 border-b border-gray-700/50 px-6 py-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Podrobnosti poroila"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:g.incident_number||`INC-${g.id.slice(0,8)}`})]}),e.jsx("button",{onClick:$,className:"p-2 rounded-lg hover:bg-gray-700/50 transition-colors",children:e.jsx(Ar,{className:"w-5 h-5 text-gray-400"})})]}),e.jsxs("div",{className:"px-6 py-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx("span",{className:oe(g.report_type),children:xe(g.report_type)}),e.jsxs("span",{className:U(g.incident_status),children:[X(g.incident_status),g.incident_status||g.trenutno_stanje]})]}),(g.referencna_stevilka||g.zadeva||g.tip_porocila)&&e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:[e.jsx("h3",{className:"text-sm font-medium text-blue-400 mb-4",children:"0. Osnovni podatki incidenta"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[g.referencna_stevilka&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Referenna tevilka"}),e.jsx("div",{className:"text-sm text-white",children:g.referencna_stevilka})]}),g.tip_porocila&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Tip poroila"}),e.jsx("div",{className:"text-sm text-white",children:((q=ah.find(H=>H.value===g.tip_porocila))==null?void 0:q.label)||g.tip_porocila})]}),g.zadeva&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Zadeva"}),e.jsx("div",{className:"text-sm text-white",children:g.zadeva})]})]})]}),(g.naziv_subjekta||g.sektor||g.kontakt_tehnicni_ime||g.kontakt_oseba_ime)&&e.jsxs("div",{className:"bg-green-500/10 border border-green-500/30 rounded-lg p-4",children:[e.jsx("h3",{className:"text-sm font-medium text-green-400 mb-4",children:"1. Splone informacije o poroevalcu"}),g.naziv_subjekta&&e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Naziv subjekta"}),e.jsx("div",{className:"text-sm text-white",children:g.naziv_subjekta})]}),g.sektor&&e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Sektor"}),e.jsx("div",{className:"text-sm text-white",children:g.sektor})]}),g.kontakt_tehnicni_ime&&e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Kontakt za tehnina vpraanja"}),e.jsx("div",{className:"text-sm text-white",children:g.kontakt_tehnicni_ime}),g.kontakt_tehnicni_email&&e.jsx("div",{className:"text-xs text-gray-500",children:g.kontakt_tehnicni_email}),g.kontakt_tehnicni_telefon&&e.jsx("div",{className:"text-xs text-gray-500",children:g.kontakt_tehnicni_telefon})]}),g.kontakt_oseba_ime&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Kontaktna oseba zavezanca"}),e.jsx("div",{className:"text-sm text-white",children:g.kontakt_oseba_ime}),g.kontakt_oseba_email&&e.jsx("div",{className:"text-xs text-gray-500",children:g.kontakt_oseba_email}),g.kontakt_oseba_telefon&&e.jsx("div",{className:"text-xs text-gray-500",children:g.kontakt_oseba_telefon})]})]}),e.jsxs("div",{className:"bg-orange-500/10 border border-orange-500/30 rounded-lg p-4",children:[e.jsx("h3",{className:"text-sm font-medium text-orange-400 mb-4",children:"2. Zaetne informacije o incidentu"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(g.zacetek_incidenta||g.detection_datetime)&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:g.zacetek_incidenta?"Zaetek incidenta":"Datum in as odkritja"}),e.jsx("div",{className:"text-sm text-white font-medium",children:g.zacetek_incidenta?new Date(g.zacetek_incidenta).toLocaleString("sl-SI"):g.detection_datetime?new Date(g.detection_datetime).toLocaleString("sl-SI"):"-"})]}),g.report_datetime&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Datum poroanja"}),e.jsx("div",{className:"text-sm text-white font-medium",children:new Date(g.report_datetime).toLocaleString("sl-SI")})]}),(g.taksonomija||g.incident_type)&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Vrsta incidenta"}),e.jsx("div",{className:"text-sm text-white font-medium",children:g.taksonomija?((I=Mf.find(H=>H.value===g.taksonomija))==null?void 0:I.category)||g.taksonomija:g.incident_type?((Y=Mf.find(H=>H.value===g.incident_type))==null?void 0:Y.category)||g.incident_type:"-"})]}),g.ocena_nevarnosti&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Ocena nevarnosti"}),e.jsx("div",{className:"text-sm text-white font-medium",children:g.ocena_nevarnosti})]}),g.ocena_vpliva&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Ocena vpliva"}),e.jsx("div",{className:"text-sm text-white font-medium",children:g.ocena_vpliva})]}),g.stopnja_incidenta&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Stopnja incidenta"}),e.jsx("div",{className:"text-sm text-white font-medium",children:g.stopnja_incidenta})]}),g.entity_identifier&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Identifikator entitete"}),e.jsx("div",{className:"text-sm text-white font-medium",children:g.entity_identifier})]})]}),(g.opis_incidenta||g.incident_description)&&e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Opis incidenta"}),e.jsx("div",{className:"text-sm text-white whitespace-pre-wrap",children:g.opis_incidenta||g.incident_description||"-"})]}),(g.impact_assessment||g.opombe)&&e.jsxs("div",{children:[g.impact_assessment&&e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Ocena vpliva"}),e.jsx("div",{className:"text-sm text-white whitespace-pre-wrap",children:g.impact_assessment})]}),g.opombe&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Opombe"}),e.jsx("div",{className:"text-sm text-white whitespace-pre-wrap",children:g.opombe})]})]})]}),(g.cas_zadnjega_porocanja||g.trenutno_stanje||g.akcijski_ze_sprejeti||g.opis_napake_sistem)&&e.jsxs("div",{className:"bg-purple-500/10 border border-purple-500/30 rounded-lg p-4",children:[e.jsx("h3",{className:"text-sm font-medium text-purple-400 mb-4",children:"3. Vmesno/konno poroanje"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[g.cas_zadnjega_porocanja&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"as zadnjega poroanja"}),e.jsx("div",{className:"text-sm text-white",children:new Date(g.cas_zadnjega_porocanja).toLocaleString("sl-SI")})]}),g.trenutno_stanje&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Trenutno stanje"}),e.jsx("div",{className:"text-sm text-white",children:g.trenutno_stanje})]}),g.cezmejni_vpliv_da_ne!==null&&g.cezmejni_vpliv_da_ne!==void 0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"ezmejni vpliv"}),e.jsx("div",{className:"text-sm text-white",children:g.cezmejni_vpliv_da_ne?"DA":"NE"})]})]}),(g.opis_napake_sistem||g.opis_napake_streznik||g.opis_napake_aplikacije||g.opis_napake_drugo)&&e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Opis napake"}),e.jsxs("div",{className:"text-sm text-white space-y-1",children:[g.opis_napake_sistem&&e.jsxs("div",{children:[e.jsx("strong",{children:"Sistem:"})," ",g.opis_napake_sistem]}),g.opis_napake_streznik&&e.jsxs("div",{children:[e.jsx("strong",{children:"Strenik:"})," ",g.opis_napake_streznik]}),g.opis_napake_aplikacije&&e.jsxs("div",{children:[e.jsx("strong",{children:"Aplikacije:"})," ",g.opis_napake_aplikacije]}),g.opis_napake_drugo&&e.jsxs("div",{children:[e.jsx("strong",{children:"Drugo:"})," ",g.opis_napake_drugo]})]})]}),(g.izvor_usb||g.izvor_email||g.izvor_vdor||g.izvor_spletno||g.izvor_datoteke||g.izvor_drugo)&&e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Izvor incidenta"}),e.jsxs("div",{className:"text-sm text-white space-y-1",children:[g.izvor_usb&&e.jsx("div",{children:" USB klju"}),g.izvor_email&&e.jsx("div",{children:" Elektronsko sporoilo"}),g.izvor_vdor&&e.jsx("div",{children:" Vdor v sistem"}),g.izvor_spletno&&e.jsx("div",{children:" Spletno mesto"}),g.izvor_datoteke&&e.jsx("div",{children:" Zlonamerne datoteke"}),g.izvor_drugo&&e.jsxs("div",{children:[" Drugo: ",g.izvor_drugo]})]})]}),g.akcijski_ze_sprejeti&&e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"e sprejeti ukrepi"}),e.jsx("div",{className:"text-sm text-white whitespace-pre-wrap",children:g.akcijski_ze_sprejeti})]}),g.akcijski_nacrtovani&&e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Nartovani ukrepi"}),e.jsx("div",{className:"text-sm text-white whitespace-pre-wrap",children:g.akcijski_nacrtovani})]}),g.povzrocena_skoda&&e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Povzroena koda"}),e.jsx("div",{className:"text-sm text-white whitespace-pre-wrap",children:g.povzrocena_skoda})]}),g.potrebe_odprava&&e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Potrebe za odpravo posledic"}),e.jsx("div",{className:"text-sm text-white whitespace-pre-wrap",children:g.potrebe_odprava})]}),g.casovni_okvir&&e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"asovni okvir odprave"}),e.jsx("div",{className:"text-sm text-white whitespace-pre-wrap",children:g.casovni_okvir})]}),g.response_measures&&e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Odzivni ukrepi"}),e.jsx("div",{className:"text-sm text-white whitespace-pre-wrap",children:g.response_measures})]}),g.lessons_learned&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Pridobljene izkunje"}),e.jsx("div",{className:"text-sm text-white whitespace-pre-wrap",children:g.lessons_learned})]}),g.priloge_seznam&&e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Priloge"}),e.jsx("div",{className:"text-sm text-white whitespace-pre-wrap",children:g.priloge_seznam})]})]}),!g.kontakt_oseba_ime&&(g.contact_name||g.contact_email||g.contact_phone)&&e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-3",children:"Kontaktne informacije"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[g.contact_name&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Ime"}),e.jsx("div",{className:"text-sm text-white",children:g.contact_name})]}),g.contact_email&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"E-pota"}),e.jsx("div",{className:"text-sm text-white",children:g.contact_email})]}),g.contact_phone&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Telefon"}),e.jsx("div",{className:"text-sm text-white",children:g.contact_phone})]})]})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-3",children:"Metapodatki"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"ID poroila"}),e.jsx("div",{className:"text-sm text-white font-mono",children:g.id})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Ustvarjeno"}),e.jsx("div",{className:"text-sm text-white",children:new Date(g.created_at).toLocaleString("sl-SI")})]}),g.updated_at&&e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Posodobljeno"}),e.jsx("div",{className:"text-sm text-white",children:new Date(g.updated_at).toLocaleString("sl-SI")})]})})]})]})]}),e.jsxs("div",{className:"sticky bottom-0 bg-gray-800 border-t border-gray-700/50 px-6 py-4 flex justify-between items-center",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>Q(g),disabled:P,className:"inline-flex items-center gap-2 px-6 py-2 bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-white font-medium rounded-lg transition-all duration-200 shadow-lg shadow-blue-600/25",children:[e.jsx(Ir,{className:"w-4 h-4"}),P?"Pripravljam...":"Ustvari obrazec za poroanje na SI-CERT - Priloga E"]}),e.jsxs("button",{onClick:()=>re(g),disabled:F,className:"inline-flex items-center gap-2 px-6 py-2 bg-green-600 hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed text-white font-medium rounded-lg transition-all duration-200 shadow-lg shadow-green-600/25",children:[e.jsx(bu,{className:"w-4 h-4"}),F?"Poiljam...":"Polji na SI-CERT"]})]}),e.jsx("button",{onClick:$,className:"px-6 py-2 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-lg transition-all duration-200",children:"Zapri"})]})]})})]})}function pP(){const[s,t]=z.useState({naronik:"",telefon:"",email:"",zadeva:"",sporoilo:""}),[r,a]=z.useState(!1),n=o=>{const{name:c,value:d}=o.target;t(p=>({...p,[c]:d}))},i=o=>{o.preventDefault(),a(!0);const c=`Sporoilo: ${s.zadeva}`,d=`
Sporoilo preko kontaktnega obrazca

Naronik: ${s.naronik}
Telefon: ${s.telefon}
E-naslov: ${s.email}

Zadeva: ${s.zadeva}

Sporoilo:
${s.sporoilo}

---
Poslano preko Standario kontaktnega obrazca
    `.trim(),p=`mailto:info@nis2.si?subject=${encodeURIComponent(c)}&body=${encodeURIComponent(d)}`;window.location.href=p,setTimeout(()=>{a(!1),t({naronik:"",telefon:"",email:"",zadeva:"",sporoilo:""})},2e3)};return e.jsx("div",{className:"min-h-screen bg-bg-primary p-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6 mb-6",children:e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-accent-primary flex items-center justify-center",children:e.jsx(G2,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-text-primary",children:"Poljite sporoilo"}),e.jsx("p",{className:"text-text-secondary mt-1",children:"Poljite nam sporoilo in odgovorili bomimo v najkrajem monem asu."})]})]})}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:e.jsxs("form",{onSubmit:i,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"naronik",className:"block text-sm font-medium text-text-secondary mb-2",children:"Naronik *"}),e.jsx("input",{type:"text",id:"naronik",name:"naronik",required:!0,value:s.naronik,onChange:n,className:"w-full px-4 py-3 bg-bg-input border border-border-subtle rounded-sm text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-accent-primary focus:border-transparent transition-all duration-200",placeholder:"Vnesite vae ime in priimek ali naziv podjetja"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"telefon",className:"block text-sm font-medium text-text-secondary mb-2",children:"Telefon"}),e.jsx("input",{type:"tel",id:"telefon",name:"telefon",value:s.telefon,onChange:n,className:"w-full px-4 py-3 bg-bg-input border border-border-subtle rounded-sm text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-accent-primary focus:border-transparent transition-all duration-200",placeholder:"Vnesite vao telefonsko tevilko"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-text-secondary mb-2",children:"E-naslov *"}),e.jsx("input",{type:"email",id:"email",name:"email",required:!0,value:s.email,onChange:n,className:"w-full px-4 py-3 bg-bg-input border border-border-subtle rounded-sm text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-accent-primary focus:border-transparent transition-all duration-200",placeholder:"Vnesite va e-naslov"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"zadeva",className:"block text-sm font-medium text-text-secondary mb-2",children:"Zadeva *"}),e.jsx("input",{type:"text",id:"zadeva",name:"zadeva",required:!0,value:s.zadeva,onChange:n,className:"w-full px-4 py-3 bg-bg-input border border-border-subtle rounded-sm text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-accent-primary focus:border-transparent transition-all duration-200",placeholder:"Kratek opis teme vaega sporoila"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sporoilo",className:"block text-sm font-medium text-text-secondary mb-2",children:"Sporoilo *"}),e.jsx("textarea",{id:"sporoilo",name:"sporoilo",required:!0,rows:8,value:s.sporoilo,onChange:n,className:"w-full px-4 py-3 bg-bg-input border border-border-subtle rounded-sm text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-accent-primary focus:border-transparent transition-all duration-200 resize-vertical",placeholder:"Vnesite vae sporoilo..."})]}),e.jsx("div",{className:"pt-4",children:e.jsx("button",{type:"submit",disabled:r,className:`
                  w-full md:w-auto px-8 py-3 rounded-sm font-medium text-white
                  flex items-center justify-center gap-2 transition-all duration-200
                  ${r?"bg-bg-disabled cursor-not-allowed":"bg-accent-primary hover:bg-accent-primary/90 focus:ring-2 focus:ring-accent-primary focus:ring-offset-2 focus:ring-offset-bg-primary"}
                `,children:r?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Poiljanje..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ku,{className:"w-5 h-5"}),"Polji sporoilo"]})})}),e.jsx("div",{className:"bg-bg-secondary border border-border-subtle rounded-sm p-4 mt-6",children:e.jsxs("p",{className:"text-sm text-text-secondary",children:[e.jsx("strong",{children:"Opomba:"}),' Po kliku na "Polji sporoilo" se bo odprl va privzeti email odjemalec s predizpolnjenimi podatki. e se to ne zgodi, nam piite na'," ",e.jsx("a",{href:"mailto:info@nis2.si",className:"text-accent-primary hover:underline",children:"info@nis2.si"}),"."]})})]})})]})})}const mP=({isOpen:s,onClose:t,onSuccess:r})=>{const[a,n]=z.useState({risk_id:"",risk_name:"",category:"",risk_description:"",threat_source:"",vulnerability:"",affected_assets:"",likelihood:1,impact:1,risk_owner:"",current_controls:"",treatment_strategy:"",mitigation_actions:"",treatment_status:"Open",priority:"Medium",residual_likelihood:null,residual_impact:null,identified_date:new Date().toISOString().split("T")[0],review_date:"",target_closure_date:"",last_reviewed:"",comments:""}),[i,o]=z.useState(!1),[c,d]=z.useState(null),p=(_,k)=>{const P=_*k;return P>=21?"Critical":P>=13?"High":P>=7?"Medium":"Low"},m=(_,k)=>{if(!_||!k)return null;const P=_*k;return P>=21?"Critical":P>=13?"High":P>=7?"Medium":"Low"},x=()=>a.likelihood*a.impact,b=()=>p(a.likelihood,a.impact),h=()=>!a.residual_likelihood||!a.residual_impact?null:a.residual_likelihood*a.residual_impact,j=()=>m(a.residual_likelihood,a.residual_impact),g=_=>{const{name:k,value:P}=_.target;if(["likelihood","impact","residual_likelihood","residual_impact"].includes(k)){const L=P===""?null:parseInt(P);n(F=>({...F,[k]:L}))}else n(L=>({...L,[k]:P}))},v=async _=>{_.preventDefault(),o(!0),d(null);try{const k=x(),P=b(),L=h(),F=j(),{error:W}=await Ne.from("nis2_risk_register").insert({...a,risk_score:k,risk_level:P,residual_risk_score:L,residual_risk_level:F,review_date:a.review_date||null,target_closure_date:a.target_closure_date||null,last_reviewed:a.last_reviewed||null,comments:a.comments||null,current_controls:a.current_controls||null,mitigation_actions:a.mitigation_actions||null});if(W)throw W;r(),t(),n({risk_id:"",risk_name:"",category:"",risk_description:"",threat_source:"",vulnerability:"",affected_assets:"",likelihood:1,impact:1,risk_owner:"",current_controls:"",treatment_strategy:"",mitigation_actions:"",treatment_status:"Open",priority:"Medium",residual_likelihood:null,residual_impact:null,identified_date:new Date().toISOString().split("T")[0],review_date:"",target_closure_date:"",last_reviewed:"",comments:""})}catch(k){console.error("Error creating risk register entry:",k),d("Napaka pri shranjevanju vnosa. Prosimo poskusite znova.")}finally{o(!1)}};return s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-bg-surface border-b border-border-subtle px-6 py-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Dodaj novo tveganje"}),e.jsx("button",{onClick:t,className:"text-text-secondary hover:text-text-primary transition-colors",children:e.jsx(Ar,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:v,className:"p-6",children:[c&&e.jsxs("div",{className:"mb-6 p-4 bg-red-600/20 border border-red-500/50 rounded-lg flex items-center",children:[e.jsx(pt,{className:"w-5 h-5 text-red-400 mr-2"}),e.jsx("span",{className:"text-red-400",children:c})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4 border-b border-border-subtle pb-2",children:"1. Identifikacija tveganja"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"ID tveganja *"}),e.jsx("input",{type:"text",name:"risk_id",value:a.risk_id,onChange:g,placeholder:"npr. RISK-011",required:!0,className:"w-full px-3 py-2 bg-bg-primary border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Kategorija *"}),e.jsxs("select",{name:"category",value:a.category,onChange:g,required:!0,className:"w-full px-3 py-2 bg-bg-primary border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"",children:"Izberi kategorijo"}),e.jsx("option",{value:"Operational",children:"Operational"}),e.jsx("option",{value:"Technical",children:"Technical"}),e.jsx("option",{value:"Strategic",children:"Strategic"}),e.jsx("option",{value:"Compliance",children:"Compliance"}),e.jsx("option",{value:"Financial",children:"Financial"}),e.jsx("option",{value:"Reputational",children:"Reputational"}),e.jsx("option",{value:"Supply Chain",children:"Supply Chain"}),e.jsx("option",{value:"Human Resources",children:"Human Resources"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Naziv tveganja *"}),e.jsx("input",{type:"text",name:"risk_name",value:a.risk_name,onChange:g,placeholder:"Kratek opis tveganja",required:!0,className:"w-full px-3 py-2 bg-bg-primary border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Opis tveganja *"}),e.jsx("textarea",{name:"risk_description",value:a.risk_description,onChange:g,rows:3,placeholder:"Podroben opis tveganja in njegovih posledic",required:!0,className:"w-full px-3 py-2 bg-bg-primary border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-primary-500"})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4 border-b border-border-subtle pb-2",children:"2. Gronja in ranljivost"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Vir gronje *"}),e.jsxs("select",{name:"threat_source",value:a.threat_source,onChange:g,required:!0,className:"w-full px-3 py-2 bg-bg-primary border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"",children:"Izberi vir gronje"}),e.jsx("option",{value:"Phishing",children:"Phishing"}),e.jsx("option",{value:"Malware",children:"Malware"}),e.jsx("option",{value:"Ransomware",children:"Ransomware"}),e.jsx("option",{value:"Insider Threat",children:"Insider Threat"}),e.jsx("option",{value:"DDoS Attack",children:"DDoS Attack"}),e.jsx("option",{value:"Social Engineering",children:"Social Engineering"}),e.jsx("option",{value:"Hardware Failure",children:"Hardware Failure"}),e.jsx("option",{value:"Human Error",children:"Human Error"}),e.jsx("option",{value:"Data Breach",children:"Data Breach"}),e.jsx("option",{value:"Third Party",children:"Third Party"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Ranljivost *"}),e.jsx("input",{type:"text",name:"vulnerability",value:a.vulnerability,onChange:g,placeholder:"Opis ranljivosti",required:!0,className:"w-full px-3 py-2 bg-bg-primary border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Prizadeti sistemi/sredstva *"}),e.jsx("input",{type:"text",name:"affected_assets",value:a.affected_assets,onChange:g,placeholder:"Seznam sistemov, ki bi bili prizadeti",required:!0,className:"w-full px-3 py-2 bg-bg-primary border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-primary-500"})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4 border-b border-border-subtle pb-2",children:"3. Ocena inherentnega tveganja"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Verjetnost (1-5) *"}),e.jsxs("select",{name:"likelihood",value:a.likelihood,onChange:g,required:!0,className:"w-full px-3 py-2 bg-bg-primary border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:1,children:"1 - Zelo nizka"}),e.jsx("option",{value:2,children:"2 - Nizka"}),e.jsx("option",{value:3,children:"3 - Srednja"}),e.jsx("option",{value:4,children:"4 - Visoka"}),e.jsx("option",{value:5,children:"5 - Zelo visoka"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Vpliv (1-5) *"}),e.jsxs("select",{name:"impact",value:a.impact,onChange:g,required:!0,className:"w-full px-3 py-2 bg-bg-primary border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:1,children:"1 - Zelo nizek"}),e.jsx("option",{value:2,children:"2 - Nizek"}),e.jsx("option",{value:3,children:"3 - Srednji"}),e.jsx("option",{value:4,children:"4 - Visok"}),e.jsx("option",{value:5,children:"5 - Zelo visok"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Ocena tveganja"}),e.jsx("div",{className:"px-3 py-2 bg-gray-700 border border-border-subtle rounded-lg text-text-primary font-medium",children:x()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Nivo tveganja"}),e.jsx("div",{className:`px-3 py-2 border border-border-subtle rounded-lg font-medium text-center ${b()==="Critical"?"bg-red-600/20 text-red-400":b()==="High"?"bg-orange-600/20 text-orange-400":b()==="Medium"?"bg-yellow-600/20 text-yellow-400":"bg-green-600/20 text-green-400"}`,children:b()})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4 border-b border-border-subtle pb-2",children:"4. Obravnavanje tveganja"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Lastnik tveganja *"}),e.jsx("input",{type:"text",name:"risk_owner",value:a.risk_owner,onChange:g,placeholder:"Ime in priimek odgovorne osebe",required:!0,className:"w-full px-3 py-2 bg-bg-primary border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Strategija obravnavanja *"}),e.jsxs("select",{name:"treatment_strategy",value:a.treatment_strategy,onChange:g,required:!0,className:"w-full px-3 py-2 bg-bg-primary border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"",children:"Izberi strategijo"}),e.jsx("option",{value:"Avoid",children:"Avoid - Izogibanje"}),e.jsx("option",{value:"Transfer",children:"Transfer - Prenos"}),e.jsx("option",{value:"Mitigate",children:"Mitigate - Zmanjanje"}),e.jsx("option",{value:"Accept",children:"Accept - Sprejemanje"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Status obravnavanja *"}),e.jsxs("select",{name:"treatment_status",value:a.treatment_status,onChange:g,required:!0,className:"w-full px-3 py-2 bg-bg-primary border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"Open",children:"Open - Odprto"}),e.jsx("option",{value:"In Progress",children:"In Progress - V teku"}),e.jsx("option",{value:"Implemented",children:"Implemented - Implementirano"}),e.jsx("option",{value:"Accepted",children:"Accepted - Sprejeto"}),e.jsx("option",{value:"Closed",children:"Closed - Zakljueno"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Prioriteta *"}),e.jsxs("select",{name:"priority",value:a.priority,onChange:g,required:!0,className:"w-full px-3 py-2 bg-bg-primary border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"Critical",children:"Critical - Kritina"}),e.jsx("option",{value:"High",children:"High - Visoka"}),e.jsx("option",{value:"Medium",children:"Medium - Srednja"}),e.jsx("option",{value:"Low",children:"Low - Nizka"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Trenutni nadzori"}),e.jsx("textarea",{name:"current_controls",value:a.current_controls,onChange:g,rows:2,placeholder:"Opiite obstojee varnostne ukrepe",className:"w-full px-3 py-2 bg-bg-primary border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Ukrepi za zmanjanje tveganja"}),e.jsx("textarea",{name:"mitigation_actions",value:a.mitigation_actions,onChange:g,rows:2,placeholder:"Nartovani ali implementirani ukrepi",className:"w-full px-3 py-2 bg-bg-primary border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-primary-500"})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4 border-b border-border-subtle pb-2",children:"5. Ocena preostanka tveganja"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Preostana verjetnost (1-5)"}),e.jsxs("select",{name:"residual_likelihood",value:a.residual_likelihood||"",onChange:g,className:"w-full px-3 py-2 bg-bg-primary border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"",children:"Ni ocenjeno"}),e.jsx("option",{value:1,children:"1 - Zelo nizka"}),e.jsx("option",{value:2,children:"2 - Nizka"}),e.jsx("option",{value:3,children:"3 - Srednja"}),e.jsx("option",{value:4,children:"4 - Visoka"}),e.jsx("option",{value:5,children:"5 - Zelo visoka"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Preostan vpliv (1-5)"}),e.jsxs("select",{name:"residual_impact",value:a.residual_impact||"",onChange:g,className:"w-full px-3 py-2 bg-bg-primary border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"",children:"Ni ocenjeno"}),e.jsx("option",{value:1,children:"1 - Zelo nizek"}),e.jsx("option",{value:2,children:"2 - Nizek"}),e.jsx("option",{value:3,children:"3 - Srednji"}),e.jsx("option",{value:4,children:"4 - Visok"}),e.jsx("option",{value:5,children:"5 - Zelo visok"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Preostan rizik"}),e.jsx("div",{className:"px-3 py-2 bg-gray-700 border border-border-subtle rounded-lg text-text-primary font-medium",children:h()||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Nivo preostanka"}),e.jsx("div",{className:`px-3 py-2 border border-border-subtle rounded-lg font-medium text-center ${j()?j()==="Critical"?"bg-red-600/20 text-red-400":j()==="High"?"bg-orange-600/20 text-orange-400":j()==="Medium"?"bg-yellow-600/20 text-yellow-400":"bg-green-600/20 text-green-400":"bg-gray-700 text-text-secondary"}`,children:j()||"Ni ocenjeno"})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4 border-b border-border-subtle pb-2",children:"6. asovnica"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Datum identifikacije *"}),e.jsx("input",{type:"date",name:"identified_date",value:a.identified_date,onChange:g,required:!0,className:"w-full px-3 py-2 bg-bg-primary border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Datum pregleda"}),e.jsx("input",{type:"date",name:"review_date",value:a.review_date,onChange:g,className:"w-full px-3 py-2 bg-bg-primary border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Ciljni datum zakljuka"}),e.jsx("input",{type:"date",name:"target_closure_date",value:a.target_closure_date,onChange:g,className:"w-full px-3 py-2 bg-bg-primary border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Datum zadnjega pregleda"}),e.jsx("input",{type:"date",name:"last_reviewed",value:a.last_reviewed,onChange:g,className:"w-full px-3 py-2 bg-bg-primary border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-500"})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4 border-b border-border-subtle pb-2",children:"7. Dodatne informacije"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Komentarji"}),e.jsx("textarea",{name:"comments",value:a.comments,onChange:g,rows:3,placeholder:"Dodatni komentarji ali opombe",className:"w-full px-3 py-2 bg-bg-primary border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-primary-500"})]})]}),e.jsxs("div",{className:"sticky bottom-0 bg-bg-surface border-t border-border-subtle pt-4 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-text-secondary hover:text-text-primary transition-colors",children:"Preklii"}),e.jsxs("button",{type:"submit",disabled:i,className:"px-6 py-2 bg-primary-600 hover:bg-primary-700 disabled:bg-primary-600/50 text-white rounded-lg font-medium transition-colors flex items-center",children:[e.jsx(Kp,{className:"w-4 h-4 mr-2"}),i?"Shranjujem...":"Shrani tveganje"]})]})]})]})}):null};function Zr(s){"@babel/helpers - typeof";return Zr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zr(s)}var Hi=Uint8Array,Zn=Uint16Array,Og=Int32Array,Dg=new Hi([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Eg=new Hi([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),pj=new Hi([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),D1=function(s,t){for(var r=new Zn(31),a=0;a<31;++a)r[a]=t+=1<<s[a-1];for(var n=new Og(r[30]),a=1;a<30;++a)for(var i=r[a];i<r[a+1];++i)n[i]=i-r[a]<<5|a;return{b:r,r:n}},E1=D1(Dg,2),hP=E1.b,qb=E1.r;hP[28]=258,qb[258]=28;var xP=D1(Eg,0),mj=xP.r,$b=new Zn(32768);for(var ls=0;ls<32768;++ls){var Gl=(ls&43690)>>1|(ls&21845)<<1;Gl=(Gl&52428)>>2|(Gl&13107)<<2,Gl=(Gl&61680)>>4|(Gl&3855)<<4,$b[ls]=((Gl&65280)>>8|(Gl&255)<<8)>>1}var zp=(function(s,t,r){for(var a=s.length,n=0,i=new Zn(t);n<a;++n)s[n]&&++i[s[n]-1];var o=new Zn(t);for(n=1;n<t;++n)o[n]=o[n-1]+i[n-1]<<1;var c;if(r){c=new Zn(1<<t);var d=15-t;for(n=0;n<a;++n)if(s[n])for(var p=n<<4|s[n],m=t-s[n],x=o[s[n]-1]++<<m,b=x|(1<<m)-1;x<=b;++x)c[$b[x]>>d]=p}else for(c=new Zn(a),n=0;n<a;++n)s[n]&&(c[n]=$b[o[s[n]-1]++]>>15-s[n]);return c}),id=new Hi(288);for(var ls=0;ls<144;++ls)id[ls]=8;for(var ls=144;ls<256;++ls)id[ls]=9;for(var ls=256;ls<280;++ls)id[ls]=7;for(var ls=280;ls<288;++ls)id[ls]=8;var Kh=new Hi(32);for(var ls=0;ls<32;++ls)Kh[ls]=5;var fP=zp(id,9,0),bP=zp(Kh,5,0),I1=function(s){return(s+7)/8|0},gP=function(s,t,r){return(r==null||r>s.length)&&(r=s.length),new Hi(s.subarray(t,r))},sl=function(s,t,r){r<<=t&7;var a=t/8|0;s[a]|=r,s[a+1]|=r>>8},op=function(s,t,r){r<<=t&7;var a=t/8|0;s[a]|=r,s[a+1]|=r>>8,s[a+2]|=r>>16},Uf=function(s,t){for(var r=[],a=0;a<s.length;++a)s[a]&&r.push({s:a,f:s[a]});var n=r.length,i=r.slice();if(!n)return{t:T1,l:0};if(n==1){var o=new Hi(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(F,W){return F.f-W.f}),r.push({s:-1,f:25001});var c=r[0],d=r[1],p=0,m=1,x=2;for(r[0]={s:-1,f:c.f+d.f,l:c,r:d};m!=n-1;)c=r[r[p].f<r[x].f?p++:x++],d=r[p!=m&&r[p].f<r[x].f?p++:x++],r[m++]={s:-1,f:c.f+d.f,l:c,r:d};for(var b=i[0].s,a=1;a<n;++a)i[a].s>b&&(b=i[a].s);var h=new Zn(b+1),j=Bb(r[m-1],h,0);if(j>t){var a=0,g=0,v=j-t,_=1<<v;for(i.sort(function(W,R){return h[R.s]-h[W.s]||W.f-R.f});a<n;++a){var k=i[a].s;if(h[k]>t)g+=_-(1<<j-h[k]),h[k]=t;else break}for(g>>=v;g>0;){var P=i[a].s;h[P]<t?g-=1<<t-h[P]++-1:++a}for(;a>=0&&g;--a){var L=i[a].s;h[L]==t&&(--h[L],++g)}j=t}return{t:new Hi(h),l:j}},Bb=function(s,t,r){return s.s==-1?Math.max(Bb(s.l,t,r+1),Bb(s.r,t,r+1)):t[s.s]=r},hj=function(s){for(var t=s.length;t&&!s[--t];);for(var r=new Zn(++t),a=0,n=s[0],i=1,o=function(d){r[a++]=d},c=1;c<=t;++c)if(s[c]==n&&c!=t)++i;else{if(!n&&i>2){for(;i>138;i-=138)o(32754);i>2&&(o(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(o(n),--i;i>6;i-=6)o(8304);i>2&&(o(i-3<<5|8208),i=0)}for(;i--;)o(n);i=1,n=s[c]}return{c:r.subarray(0,a),n:t}},lp=function(s,t){for(var r=0,a=0;a<t.length;++a)r+=s[a]*t[a];return r},L1=function(s,t,r){var a=r.length,n=I1(t+2);s[n]=a&255,s[n+1]=a>>8,s[n+2]=s[n]^255,s[n+3]=s[n+1]^255;for(var i=0;i<a;++i)s[n+i+4]=r[i];return(n+4+a)*8},xj=function(s,t,r,a,n,i,o,c,d,p,m){sl(t,m++,r),++n[256];for(var x=Uf(n,15),b=x.t,h=x.l,j=Uf(i,15),g=j.t,v=j.l,_=hj(b),k=_.c,P=_.n,L=hj(g),F=L.c,W=L.n,R=new Zn(19),B=0;B<k.length;++B)++R[k[B]&31];for(var B=0;B<F.length;++B)++R[F[B]&31];for(var A=Uf(R,7),S=A.t,C=A.l,O=19;O>4&&!S[pj[O-1]];--O);var Z=p+5<<3,te=lp(n,id)+lp(i,Kh)+o,ce=lp(n,b)+lp(i,g)+o+14+3*O+lp(R,S)+2*R[16]+3*R[17]+7*R[18];if(d>=0&&Z<=te&&Z<=ce)return L1(t,m,s.subarray(d,d+p));var re,X,U,oe;if(sl(t,m,1+(ce<te)),m+=2,ce<te){re=zp(b,h,0),X=b,U=zp(g,v,0),oe=g;var xe=zp(S,C,0);sl(t,m,P-257),sl(t,m+5,W-1),sl(t,m+10,O-4),m+=14;for(var B=0;B<O;++B)sl(t,m+3*B,S[pj[B]]);m+=3*O;for(var J=[k,F],$=0;$<2;++$)for(var Q=J[$],B=0;B<Q.length;++B){var q=Q[B]&31;sl(t,m,xe[q]),m+=S[q],q>15&&(sl(t,m,Q[B]>>5&127),m+=Q[B]>>12)}}else re=fP,X=id,U=bP,oe=Kh;for(var B=0;B<c;++B){var I=a[B];if(I>255){var q=I>>18&31;op(t,m,re[q+257]),m+=X[q+257],q>7&&(sl(t,m,I>>23&31),m+=Dg[q]);var Y=I&31;op(t,m,U[Y]),m+=oe[Y],Y>3&&(op(t,m,I>>5&8191),m+=Eg[Y])}else op(t,m,re[I]),m+=X[I]}return op(t,m,re[256]),m+X[256]},vP=new Og([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),T1=new Hi(0),yP=function(s,t,r,a,n,i){var o=i.z||s.length,c=new Hi(a+o+5*(1+Math.ceil(o/7e3))+n),d=c.subarray(a,c.length-n),p=i.l,m=(i.r||0)&7;if(t){m&&(d[0]=i.r>>3);for(var x=vP[t-1],b=x>>13,h=x&8191,j=(1<<r)-1,g=i.p||new Zn(32768),v=i.h||new Zn(j+1),_=Math.ceil(r/3),k=2*_,P=function(ke){return(s[ke]^s[ke+1]<<_^s[ke+2]<<k)&j},L=new Og(25e3),F=new Zn(288),W=new Zn(32),R=0,B=0,A=i.i||0,S=0,C=i.w||0,O=0;A+2<o;++A){var Z=P(A),te=A&32767,ce=v[Z];if(g[te]=ce,v[Z]=te,C<=A){var re=o-A;if((R>7e3||S>24576)&&(re>423||!p)){m=xj(s,d,0,L,F,W,B,S,O,A-O,m),S=R=B=0,O=A;for(var X=0;X<286;++X)F[X]=0;for(var X=0;X<30;++X)W[X]=0}var U=2,oe=0,xe=h,J=te-ce&32767;if(re>2&&Z==P(A-J))for(var $=Math.min(b,re)-1,Q=Math.min(32767,A),q=Math.min(258,re);J<=Q&&--xe&&te!=ce;){if(s[A+U]==s[A+U-J]){for(var I=0;I<q&&s[A+I]==s[A+I-J];++I);if(I>U){if(U=I,oe=J,I>$)break;for(var Y=Math.min(J,I-2),H=0,X=0;X<Y;++X){var he=A-J+X&32767,ge=g[he],K=he-ge&32767;K>H&&(H=K,ce=he)}}}te=ce,ce=g[te],J+=te-ce&32767}if(oe){L[S++]=268435456|qb[U]<<18|mj[oe];var T=qb[U]&31,ee=mj[oe]&31;B+=Dg[T]+Eg[ee],++F[257+T],++W[ee],C=A+U,++R}else L[S++]=s[A],++F[s[A]]}}for(A=Math.max(A,C);A<o;++A)L[S++]=s[A],++F[s[A]];m=xj(s,d,p,L,F,W,B,S,O,A-O,m),p||(i.r=m&7|d[m/8|0]<<3,m-=7,i.h=v,i.p=g,i.i=A,i.w=C)}else{for(var A=i.w||0;A<o+p;A+=65535){var _e=A+65535;_e>=o&&(d[m/8|0]=p,_e=o),m=L1(d,m+1,s.subarray(A,_e))}i.i=o}return gP(c,0,a+I1(m)+n)},R1=function(){var s=1,t=0;return{p:function(r){for(var a=s,n=t,i=r.length|0,o=0;o!=i;){for(var c=Math.min(o+2655,i);o<c;++o)n+=a+=r[o];a=(a&65535)+15*(a>>16),n=(n&65535)+15*(n>>16)}s=a,t=n},d:function(){return s%=65521,t%=65521,(s&255)<<24|(s&65280)<<8|(t&255)<<8|t>>8}}},jP=function(s,t,r,a,n){if(!n&&(n={l:1},t.dictionary)){var i=t.dictionary.subarray(-32768),o=new Hi(i.length+s.length);o.set(i),o.set(s,i.length),s=o,n.w=i.length}return yP(s,t.level==null?6:t.level,t.mem==null?n.l?Math.ceil(Math.max(8,Math.min(13,Math.log(s.length)))*1.5):20:12+t.mem,r,a,n)},M1=function(s,t,r){for(;r;++t)s[t]=r,r>>>=8},_P=function(s,t){var r=t.level,a=r==0?0:r<6?1:r==9?3:2;if(s[0]=120,s[1]=a<<6|(t.dictionary&&32),s[1]|=31-(s[0]<<8|s[1])%31,t.dictionary){var n=R1();n.p(t.dictionary),M1(s,2,n.d())}};function Vb(s,t){t||(t={});var r=R1();r.p(s);var a=jP(s,t,t.dictionary?6:2,4);return _P(a,t),M1(a,a.length-4,r.d()),a}var kP=typeof TextDecoder<"u"&&new TextDecoder,NP=0;try{kP.decode(T1,{stream:!0}),NP=1}catch{}function wP(s){if(Array.isArray(s))return s}function SP(s,t){var r=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(r!=null){var a,n,i,o,c=[],d=!0,p=!1;try{if(i=(r=r.call(s)).next,t!==0)for(;!(d=(a=i.call(r)).done)&&(c.push(a.value),c.length!==t);d=!0);}catch(m){p=!0,n=m}finally{try{if(!d&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(p)throw n}}return c}}function fj(s,t){(t==null||t>s.length)&&(t=s.length);for(var r=0,a=Array(t);r<t;r++)a[r]=s[r];return a}function zP(s,t){if(s){if(typeof s=="string")return fj(s,t);var r={}.toString.call(s).slice(8,-1);return r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set"?Array.from(s):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?fj(s,t):void 0}}function CP(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bj(s,t){return wP(s)||SP(s,t)||zP(s,t)||CP()}function gj(s,t="utf8"){return new TextDecoder(t).decode(s)}const PP=new TextEncoder;function AP(s){return PP.encode(s)}const OP=1024*8,DP=(()=>{const s=new Uint8Array(4),t=new Uint32Array(s.buffer);return!((t[0]=1)&s[0])})(),qf={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class Ig{constructor(t=OP,r={}){ft(this,"buffer");ft(this,"byteLength");ft(this,"byteOffset");ft(this,"length");ft(this,"offset");ft(this,"lastWrittenByte");ft(this,"littleEndian");ft(this,"_data");ft(this,"_mark");ft(this,"_marks");let a=!1;typeof t=="number"?t=new ArrayBuffer(t):(a=!0,this.lastWrittenByte=t.byteLength);const n=r.offset?r.offset>>>0:0,i=t.byteLength-n;let o=n;(ArrayBuffer.isView(t)||t instanceof Ig)&&(t.byteLength!==t.buffer.byteLength&&(o=t.byteOffset+n),t=t.buffer),a?this.lastWrittenByte=i:this.lastWrittenByte=0,this.buffer=t,this.length=i,this.byteLength=i,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,i),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const a=(this.offset+t)*2,n=new Uint8Array(a);n.set(new Uint8Array(this.buffer)),this.buffer=n.buffer,this.length=a,this.byteLength=a,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const a=qf[r].BYTES_PER_ELEMENT*t,n=this.byteOffset+this.offset,i=this.buffer.slice(n,n+a);if(this.littleEndian===DP&&r!=="uint8"&&r!=="int8"){const c=new Uint8Array(this.buffer.slice(n,n+a));c.reverse();const d=new qf[r](c.buffer);return this.offset+=a,d.reverse(),d}const o=new qf[r](i);return this.offset+=a,o}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let a=0;a<t;a++)r+=this.readChar();return r}readUtf8(t=1){return gj(this.readBytes(t))}decodeText(t=1,r="utf8"){return gj(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(AP(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function wu(s){let t=s.length;for(;--t>=0;)s[t]=0}const EP=3,IP=258,F1=29,LP=256,TP=LP+1+F1,U1=30,RP=512,MP=new Array((TP+2)*2);wu(MP);const FP=new Array(U1*2);wu(FP);const UP=new Array(RP);wu(UP);const qP=new Array(IP-EP+1);wu(qP);const $P=new Array(F1);wu($P);const BP=new Array(U1);wu(BP);const VP=(s,t,r,a)=>{let n=s&65535|0,i=s>>>16&65535|0,o=0;for(;r!==0;){o=r>2e3?2e3:r,r-=o;do n=n+t[a++]|0,i=i+n|0;while(--o);n%=65521,i%=65521}return n|i<<16|0};var Hb=VP;const HP=()=>{let s,t=[];for(var r=0;r<256;r++){s=r;for(var a=0;a<8;a++)s=s&1?3988292384^s>>>1:s>>>1;t[r]=s}return t},ZP=new Uint32Array(HP()),WP=(s,t,r,a)=>{const n=ZP,i=a+r;s^=-1;for(let o=a;o<i;o++)s=s>>>8^n[(s^t[o])&255];return s^-1};var mo=WP,Zb={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},q1={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const KP=(s,t)=>Object.prototype.hasOwnProperty.call(s,t);var GP=function(s){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const a in r)KP(r,a)&&(s[a]=r[a])}}return s},YP=s=>{let t=0;for(let a=0,n=s.length;a<n;a++)t+=s[a].length;const r=new Uint8Array(t);for(let a=0,n=0,i=s.length;a<i;a++){let o=s[a];r.set(o,n),n+=o.length}return r},$1={assign:GP,flattenChunks:YP};let B1=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{B1=!1}const Vp=new Uint8Array(256);for(let s=0;s<256;s++)Vp[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;Vp[254]=Vp[254]=1;var JP=s=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(s);let t,r,a,n,i,o=s.length,c=0;for(n=0;n<o;n++)r=s.charCodeAt(n),(r&64512)===55296&&n+1<o&&(a=s.charCodeAt(n+1),(a&64512)===56320&&(r=65536+(r-55296<<10)+(a-56320),n++)),c+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(c),i=0,n=0;i<c;n++)r=s.charCodeAt(n),(r&64512)===55296&&n+1<o&&(a=s.charCodeAt(n+1),(a&64512)===56320&&(r=65536+(r-55296<<10)+(a-56320),n++)),r<128?t[i++]=r:r<2048?(t[i++]=192|r>>>6,t[i++]=128|r&63):r<65536?(t[i++]=224|r>>>12,t[i++]=128|r>>>6&63,t[i++]=128|r&63):(t[i++]=240|r>>>18,t[i++]=128|r>>>12&63,t[i++]=128|r>>>6&63,t[i++]=128|r&63);return t};const XP=(s,t)=>{if(t<65534&&s.subarray&&B1)return String.fromCharCode.apply(null,s.length===t?s:s.subarray(0,t));let r="";for(let a=0;a<t;a++)r+=String.fromCharCode(s[a]);return r};var QP=(s,t)=>{const r=t||s.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(s.subarray(0,t));let a,n;const i=new Array(r*2);for(n=0,a=0;a<r;){let o=s[a++];if(o<128){i[n++]=o;continue}let c=Vp[o];if(c>4){i[n++]=65533,a+=c-1;continue}for(o&=c===2?31:c===3?15:7;c>1&&a<r;)o=o<<6|s[a++]&63,c--;if(c>1){i[n++]=65533;continue}o<65536?i[n++]=o:(o-=65536,i[n++]=55296|o>>10&1023,i[n++]=56320|o&1023)}return XP(i,n)},eA=(s,t)=>{t=t||s.length,t>s.length&&(t=s.length);let r=t-1;for(;r>=0&&(s[r]&192)===128;)r--;return r<0||r===0?t:r+Vp[s[r]]>t?r:t},Wb={string2buf:JP,buf2string:QP,utf8border:eA};function tA(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var rA=tA;const nh=16209,sA=16191;var aA=function(t,r){let a,n,i,o,c,d,p,m,x,b,h,j,g,v,_,k,P,L,F,W,R,B,A,S;const C=t.state;a=t.next_in,A=t.input,n=a+(t.avail_in-5),i=t.next_out,S=t.output,o=i-(r-t.avail_out),c=i+(t.avail_out-257),d=C.dmax,p=C.wsize,m=C.whave,x=C.wnext,b=C.window,h=C.hold,j=C.bits,g=C.lencode,v=C.distcode,_=(1<<C.lenbits)-1,k=(1<<C.distbits)-1;e:do{j<15&&(h+=A[a++]<<j,j+=8,h+=A[a++]<<j,j+=8),P=g[h&_];t:for(;;){if(L=P>>>24,h>>>=L,j-=L,L=P>>>16&255,L===0)S[i++]=P&65535;else if(L&16){F=P&65535,L&=15,L&&(j<L&&(h+=A[a++]<<j,j+=8),F+=h&(1<<L)-1,h>>>=L,j-=L),j<15&&(h+=A[a++]<<j,j+=8,h+=A[a++]<<j,j+=8),P=v[h&k];r:for(;;){if(L=P>>>24,h>>>=L,j-=L,L=P>>>16&255,L&16){if(W=P&65535,L&=15,j<L&&(h+=A[a++]<<j,j+=8,j<L&&(h+=A[a++]<<j,j+=8)),W+=h&(1<<L)-1,W>d){t.msg="invalid distance too far back",C.mode=nh;break e}if(h>>>=L,j-=L,L=i-o,W>L){if(L=W-L,L>m&&C.sane){t.msg="invalid distance too far back",C.mode=nh;break e}if(R=0,B=b,x===0){if(R+=p-L,L<F){F-=L;do S[i++]=b[R++];while(--L);R=i-W,B=S}}else if(x<L){if(R+=p+x-L,L-=x,L<F){F-=L;do S[i++]=b[R++];while(--L);if(R=0,x<F){L=x,F-=L;do S[i++]=b[R++];while(--L);R=i-W,B=S}}}else if(R+=x-L,L<F){F-=L;do S[i++]=b[R++];while(--L);R=i-W,B=S}for(;F>2;)S[i++]=B[R++],S[i++]=B[R++],S[i++]=B[R++],F-=3;F&&(S[i++]=B[R++],F>1&&(S[i++]=B[R++]))}else{R=i-W;do S[i++]=S[R++],S[i++]=S[R++],S[i++]=S[R++],F-=3;while(F>2);F&&(S[i++]=S[R++],F>1&&(S[i++]=S[R++]))}}else if((L&64)===0){P=v[(P&65535)+(h&(1<<L)-1)];continue r}else{t.msg="invalid distance code",C.mode=nh;break e}break}}else if((L&64)===0){P=g[(P&65535)+(h&(1<<L)-1)];continue t}else if(L&32){C.mode=sA;break e}else{t.msg="invalid literal/length code",C.mode=nh;break e}break}}while(a<n&&i<c);F=j>>3,a-=F,j-=F<<3,h&=(1<<j)-1,t.next_in=a,t.next_out=i,t.avail_in=a<n?5+(n-a):5-(a-n),t.avail_out=i<c?257+(c-i):257-(i-c),C.hold=h,C.bits=j};const Xd=15,vj=852,yj=592,jj=0,$f=1,_j=2,nA=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),iA=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),oA=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),lA=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),cA=(s,t,r,a,n,i,o,c)=>{const d=c.bits;let p=0,m=0,x=0,b=0,h=0,j=0,g=0,v=0,_=0,k=0,P,L,F,W,R,B=null,A;const S=new Uint16Array(Xd+1),C=new Uint16Array(Xd+1);let O=null,Z,te,ce;for(p=0;p<=Xd;p++)S[p]=0;for(m=0;m<a;m++)S[t[r+m]]++;for(h=d,b=Xd;b>=1&&S[b]===0;b--);if(h>b&&(h=b),b===0)return n[i++]=1<<24|64<<16|0,n[i++]=1<<24|64<<16|0,c.bits=1,0;for(x=1;x<b&&S[x]===0;x++);for(h<x&&(h=x),v=1,p=1;p<=Xd;p++)if(v<<=1,v-=S[p],v<0)return-1;if(v>0&&(s===jj||b!==1))return-1;for(C[1]=0,p=1;p<Xd;p++)C[p+1]=C[p]+S[p];for(m=0;m<a;m++)t[r+m]!==0&&(o[C[t[r+m]]++]=m);if(s===jj?(B=O=o,A=20):s===$f?(B=nA,O=iA,A=257):(B=oA,O=lA,A=0),k=0,m=0,p=x,R=i,j=h,g=0,F=-1,_=1<<h,W=_-1,s===$f&&_>vj||s===_j&&_>yj)return 1;for(;;){Z=p-g,o[m]+1<A?(te=0,ce=o[m]):o[m]>=A?(te=O[o[m]-A],ce=B[o[m]-A]):(te=96,ce=0),P=1<<p-g,L=1<<j,x=L;do L-=P,n[R+(k>>g)+L]=Z<<24|te<<16|ce|0;while(L!==0);for(P=1<<p-1;k&P;)P>>=1;if(P!==0?(k&=P-1,k+=P):k=0,m++,--S[p]===0){if(p===b)break;p=t[r+o[m]]}if(p>h&&(k&W)!==F){for(g===0&&(g=h),R+=x,j=p-g,v=1<<j;j+g<b&&(v-=S[j+g],!(v<=0));)j++,v<<=1;if(_+=1<<j,s===$f&&_>vj||s===_j&&_>yj)return 1;F=k&W,n[F]=h<<24|j<<16|R-i|0}}return k!==0&&(n[R+k]=p-g<<24|64<<16|0),c.bits=h,0};var Cp=cA;const dA=0,V1=1,H1=2,{Z_FINISH:kj,Z_BLOCK:uA,Z_TREES:ih,Z_OK:od,Z_STREAM_END:pA,Z_NEED_DICT:mA,Z_STREAM_ERROR:bi,Z_DATA_ERROR:Z1,Z_MEM_ERROR:W1,Z_BUF_ERROR:hA,Z_DEFLATED:Nj}=q1,hx=16180,wj=16181,Sj=16182,zj=16183,Cj=16184,Pj=16185,Aj=16186,Oj=16187,Dj=16188,Ej=16189,Gh=16190,al=16191,Bf=16192,Ij=16193,Vf=16194,Lj=16195,Tj=16196,Rj=16197,Mj=16198,oh=16199,lh=16200,Fj=16201,Uj=16202,qj=16203,$j=16204,Bj=16205,Hf=16206,Vj=16207,Hj=16208,fs=16209,K1=16210,G1=16211,xA=852,fA=592,bA=15,gA=bA,Zj=s=>(s>>>24&255)+(s>>>8&65280)+((s&65280)<<8)+((s&255)<<24);function vA(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const ld=s=>{if(!s)return 1;const t=s.state;return!t||t.strm!==s||t.mode<hx||t.mode>G1?1:0},Y1=s=>{if(ld(s))return bi;const t=s.state;return s.total_in=s.total_out=t.total=0,s.msg="",t.wrap&&(s.adler=t.wrap&1),t.mode=hx,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(xA),t.distcode=t.distdyn=new Int32Array(fA),t.sane=1,t.back=-1,od},J1=s=>{if(ld(s))return bi;const t=s.state;return t.wsize=0,t.whave=0,t.wnext=0,Y1(s)},X1=(s,t)=>{let r;if(ld(s))return bi;const a=s.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?bi:(a.window!==null&&a.wbits!==t&&(a.window=null),a.wrap=r,a.wbits=t,J1(s))},Q1=(s,t)=>{if(!s)return bi;const r=new vA;s.state=r,r.strm=s,r.window=null,r.mode=hx;const a=X1(s,t);return a!==od&&(s.state=null),a},yA=s=>Q1(s,gA);let Wj=!0,Zf,Wf;const jA=s=>{if(Wj){Zf=new Int32Array(512),Wf=new Int32Array(32);let t=0;for(;t<144;)s.lens[t++]=8;for(;t<256;)s.lens[t++]=9;for(;t<280;)s.lens[t++]=7;for(;t<288;)s.lens[t++]=8;for(Cp(V1,s.lens,0,288,Zf,0,s.work,{bits:9}),t=0;t<32;)s.lens[t++]=5;Cp(H1,s.lens,0,32,Wf,0,s.work,{bits:5}),Wj=!1}s.lencode=Zf,s.lenbits=9,s.distcode=Wf,s.distbits=5},ek=(s,t,r,a)=>{let n;const i=s.state;return i.window===null&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),a>=i.wsize?(i.window.set(t.subarray(r-i.wsize,r),0),i.wnext=0,i.whave=i.wsize):(n=i.wsize-i.wnext,n>a&&(n=a),i.window.set(t.subarray(r-a,r-a+n),i.wnext),a-=n,a?(i.window.set(t.subarray(r-a,r),0),i.wnext=a,i.whave=i.wsize):(i.wnext+=n,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=n))),0},_A=(s,t)=>{let r,a,n,i,o,c,d,p,m,x,b,h,j,g,v=0,_,k,P,L,F,W,R,B;const A=new Uint8Array(4);let S,C;const O=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(ld(s)||!s.output||!s.input&&s.avail_in!==0)return bi;r=s.state,r.mode===al&&(r.mode=Bf),o=s.next_out,n=s.output,d=s.avail_out,i=s.next_in,a=s.input,c=s.avail_in,p=r.hold,m=r.bits,x=c,b=d,B=od;e:for(;;)switch(r.mode){case hx:if(r.wrap===0){r.mode=Bf;break}for(;m<16;){if(c===0)break e;c--,p+=a[i++]<<m,m+=8}if(r.wrap&2&&p===35615){r.wbits===0&&(r.wbits=15),r.check=0,A[0]=p&255,A[1]=p>>>8&255,r.check=mo(r.check,A,2,0),p=0,m=0,r.mode=wj;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((p&255)<<8)+(p>>8))%31){s.msg="incorrect header check",r.mode=fs;break}if((p&15)!==Nj){s.msg="unknown compression method",r.mode=fs;break}if(p>>>=4,m-=4,R=(p&15)+8,r.wbits===0&&(r.wbits=R),R>15||R>r.wbits){s.msg="invalid window size",r.mode=fs;break}r.dmax=1<<r.wbits,r.flags=0,s.adler=r.check=1,r.mode=p&512?Ej:al,p=0,m=0;break;case wj:for(;m<16;){if(c===0)break e;c--,p+=a[i++]<<m,m+=8}if(r.flags=p,(r.flags&255)!==Nj){s.msg="unknown compression method",r.mode=fs;break}if(r.flags&57344){s.msg="unknown header flags set",r.mode=fs;break}r.head&&(r.head.text=p>>8&1),r.flags&512&&r.wrap&4&&(A[0]=p&255,A[1]=p>>>8&255,r.check=mo(r.check,A,2,0)),p=0,m=0,r.mode=Sj;case Sj:for(;m<32;){if(c===0)break e;c--,p+=a[i++]<<m,m+=8}r.head&&(r.head.time=p),r.flags&512&&r.wrap&4&&(A[0]=p&255,A[1]=p>>>8&255,A[2]=p>>>16&255,A[3]=p>>>24&255,r.check=mo(r.check,A,4,0)),p=0,m=0,r.mode=zj;case zj:for(;m<16;){if(c===0)break e;c--,p+=a[i++]<<m,m+=8}r.head&&(r.head.xflags=p&255,r.head.os=p>>8),r.flags&512&&r.wrap&4&&(A[0]=p&255,A[1]=p>>>8&255,r.check=mo(r.check,A,2,0)),p=0,m=0,r.mode=Cj;case Cj:if(r.flags&1024){for(;m<16;){if(c===0)break e;c--,p+=a[i++]<<m,m+=8}r.length=p,r.head&&(r.head.extra_len=p),r.flags&512&&r.wrap&4&&(A[0]=p&255,A[1]=p>>>8&255,r.check=mo(r.check,A,2,0)),p=0,m=0}else r.head&&(r.head.extra=null);r.mode=Pj;case Pj:if(r.flags&1024&&(h=r.length,h>c&&(h=c),h&&(r.head&&(R=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(a.subarray(i,i+h),R)),r.flags&512&&r.wrap&4&&(r.check=mo(r.check,a,h,i)),c-=h,i+=h,r.length-=h),r.length))break e;r.length=0,r.mode=Aj;case Aj:if(r.flags&2048){if(c===0)break e;h=0;do R=a[i+h++],r.head&&R&&r.length<65536&&(r.head.name+=String.fromCharCode(R));while(R&&h<c);if(r.flags&512&&r.wrap&4&&(r.check=mo(r.check,a,h,i)),c-=h,i+=h,R)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=Oj;case Oj:if(r.flags&4096){if(c===0)break e;h=0;do R=a[i+h++],r.head&&R&&r.length<65536&&(r.head.comment+=String.fromCharCode(R));while(R&&h<c);if(r.flags&512&&r.wrap&4&&(r.check=mo(r.check,a,h,i)),c-=h,i+=h,R)break e}else r.head&&(r.head.comment=null);r.mode=Dj;case Dj:if(r.flags&512){for(;m<16;){if(c===0)break e;c--,p+=a[i++]<<m,m+=8}if(r.wrap&4&&p!==(r.check&65535)){s.msg="header crc mismatch",r.mode=fs;break}p=0,m=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),s.adler=r.check=0,r.mode=al;break;case Ej:for(;m<32;){if(c===0)break e;c--,p+=a[i++]<<m,m+=8}s.adler=r.check=Zj(p),p=0,m=0,r.mode=Gh;case Gh:if(r.havedict===0)return s.next_out=o,s.avail_out=d,s.next_in=i,s.avail_in=c,r.hold=p,r.bits=m,mA;s.adler=r.check=1,r.mode=al;case al:if(t===uA||t===ih)break e;case Bf:if(r.last){p>>>=m&7,m-=m&7,r.mode=Hf;break}for(;m<3;){if(c===0)break e;c--,p+=a[i++]<<m,m+=8}switch(r.last=p&1,p>>>=1,m-=1,p&3){case 0:r.mode=Ij;break;case 1:if(jA(r),r.mode=oh,t===ih){p>>>=2,m-=2;break e}break;case 2:r.mode=Tj;break;case 3:s.msg="invalid block type",r.mode=fs}p>>>=2,m-=2;break;case Ij:for(p>>>=m&7,m-=m&7;m<32;){if(c===0)break e;c--,p+=a[i++]<<m,m+=8}if((p&65535)!==(p>>>16^65535)){s.msg="invalid stored block lengths",r.mode=fs;break}if(r.length=p&65535,p=0,m=0,r.mode=Vf,t===ih)break e;case Vf:r.mode=Lj;case Lj:if(h=r.length,h){if(h>c&&(h=c),h>d&&(h=d),h===0)break e;n.set(a.subarray(i,i+h),o),c-=h,i+=h,d-=h,o+=h,r.length-=h;break}r.mode=al;break;case Tj:for(;m<14;){if(c===0)break e;c--,p+=a[i++]<<m,m+=8}if(r.nlen=(p&31)+257,p>>>=5,m-=5,r.ndist=(p&31)+1,p>>>=5,m-=5,r.ncode=(p&15)+4,p>>>=4,m-=4,r.nlen>286||r.ndist>30){s.msg="too many length or distance symbols",r.mode=fs;break}r.have=0,r.mode=Rj;case Rj:for(;r.have<r.ncode;){for(;m<3;){if(c===0)break e;c--,p+=a[i++]<<m,m+=8}r.lens[O[r.have++]]=p&7,p>>>=3,m-=3}for(;r.have<19;)r.lens[O[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,S={bits:r.lenbits},B=Cp(dA,r.lens,0,19,r.lencode,0,r.work,S),r.lenbits=S.bits,B){s.msg="invalid code lengths set",r.mode=fs;break}r.have=0,r.mode=Mj;case Mj:for(;r.have<r.nlen+r.ndist;){for(;v=r.lencode[p&(1<<r.lenbits)-1],_=v>>>24,k=v>>>16&255,P=v&65535,!(_<=m);){if(c===0)break e;c--,p+=a[i++]<<m,m+=8}if(P<16)p>>>=_,m-=_,r.lens[r.have++]=P;else{if(P===16){for(C=_+2;m<C;){if(c===0)break e;c--,p+=a[i++]<<m,m+=8}if(p>>>=_,m-=_,r.have===0){s.msg="invalid bit length repeat",r.mode=fs;break}R=r.lens[r.have-1],h=3+(p&3),p>>>=2,m-=2}else if(P===17){for(C=_+3;m<C;){if(c===0)break e;c--,p+=a[i++]<<m,m+=8}p>>>=_,m-=_,R=0,h=3+(p&7),p>>>=3,m-=3}else{for(C=_+7;m<C;){if(c===0)break e;c--,p+=a[i++]<<m,m+=8}p>>>=_,m-=_,R=0,h=11+(p&127),p>>>=7,m-=7}if(r.have+h>r.nlen+r.ndist){s.msg="invalid bit length repeat",r.mode=fs;break}for(;h--;)r.lens[r.have++]=R}}if(r.mode===fs)break;if(r.lens[256]===0){s.msg="invalid code -- missing end-of-block",r.mode=fs;break}if(r.lenbits=9,S={bits:r.lenbits},B=Cp(V1,r.lens,0,r.nlen,r.lencode,0,r.work,S),r.lenbits=S.bits,B){s.msg="invalid literal/lengths set",r.mode=fs;break}if(r.distbits=6,r.distcode=r.distdyn,S={bits:r.distbits},B=Cp(H1,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,S),r.distbits=S.bits,B){s.msg="invalid distances set",r.mode=fs;break}if(r.mode=oh,t===ih)break e;case oh:r.mode=lh;case lh:if(c>=6&&d>=258){s.next_out=o,s.avail_out=d,s.next_in=i,s.avail_in=c,r.hold=p,r.bits=m,aA(s,b),o=s.next_out,n=s.output,d=s.avail_out,i=s.next_in,a=s.input,c=s.avail_in,p=r.hold,m=r.bits,r.mode===al&&(r.back=-1);break}for(r.back=0;v=r.lencode[p&(1<<r.lenbits)-1],_=v>>>24,k=v>>>16&255,P=v&65535,!(_<=m);){if(c===0)break e;c--,p+=a[i++]<<m,m+=8}if(k&&(k&240)===0){for(L=_,F=k,W=P;v=r.lencode[W+((p&(1<<L+F)-1)>>L)],_=v>>>24,k=v>>>16&255,P=v&65535,!(L+_<=m);){if(c===0)break e;c--,p+=a[i++]<<m,m+=8}p>>>=L,m-=L,r.back+=L}if(p>>>=_,m-=_,r.back+=_,r.length=P,k===0){r.mode=Bj;break}if(k&32){r.back=-1,r.mode=al;break}if(k&64){s.msg="invalid literal/length code",r.mode=fs;break}r.extra=k&15,r.mode=Fj;case Fj:if(r.extra){for(C=r.extra;m<C;){if(c===0)break e;c--,p+=a[i++]<<m,m+=8}r.length+=p&(1<<r.extra)-1,p>>>=r.extra,m-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=Uj;case Uj:for(;v=r.distcode[p&(1<<r.distbits)-1],_=v>>>24,k=v>>>16&255,P=v&65535,!(_<=m);){if(c===0)break e;c--,p+=a[i++]<<m,m+=8}if((k&240)===0){for(L=_,F=k,W=P;v=r.distcode[W+((p&(1<<L+F)-1)>>L)],_=v>>>24,k=v>>>16&255,P=v&65535,!(L+_<=m);){if(c===0)break e;c--,p+=a[i++]<<m,m+=8}p>>>=L,m-=L,r.back+=L}if(p>>>=_,m-=_,r.back+=_,k&64){s.msg="invalid distance code",r.mode=fs;break}r.offset=P,r.extra=k&15,r.mode=qj;case qj:if(r.extra){for(C=r.extra;m<C;){if(c===0)break e;c--,p+=a[i++]<<m,m+=8}r.offset+=p&(1<<r.extra)-1,p>>>=r.extra,m-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){s.msg="invalid distance too far back",r.mode=fs;break}r.mode=$j;case $j:if(d===0)break e;if(h=b-d,r.offset>h){if(h=r.offset-h,h>r.whave&&r.sane){s.msg="invalid distance too far back",r.mode=fs;break}h>r.wnext?(h-=r.wnext,j=r.wsize-h):j=r.wnext-h,h>r.length&&(h=r.length),g=r.window}else g=n,j=o-r.offset,h=r.length;h>d&&(h=d),d-=h,r.length-=h;do n[o++]=g[j++];while(--h);r.length===0&&(r.mode=lh);break;case Bj:if(d===0)break e;n[o++]=r.length,d--,r.mode=lh;break;case Hf:if(r.wrap){for(;m<32;){if(c===0)break e;c--,p|=a[i++]<<m,m+=8}if(b-=d,s.total_out+=b,r.total+=b,r.wrap&4&&b&&(s.adler=r.check=r.flags?mo(r.check,n,b,o-b):Hb(r.check,n,b,o-b)),b=d,r.wrap&4&&(r.flags?p:Zj(p))!==r.check){s.msg="incorrect data check",r.mode=fs;break}p=0,m=0}r.mode=Vj;case Vj:if(r.wrap&&r.flags){for(;m<32;){if(c===0)break e;c--,p+=a[i++]<<m,m+=8}if(r.wrap&4&&p!==(r.total&4294967295)){s.msg="incorrect length check",r.mode=fs;break}p=0,m=0}r.mode=Hj;case Hj:B=pA;break e;case fs:B=Z1;break e;case K1:return W1;case G1:default:return bi}return s.next_out=o,s.avail_out=d,s.next_in=i,s.avail_in=c,r.hold=p,r.bits=m,(r.wsize||b!==s.avail_out&&r.mode<fs&&(r.mode<Hf||t!==kj))&&ek(s,s.output,s.next_out,b-s.avail_out),x-=s.avail_in,b-=s.avail_out,s.total_in+=x,s.total_out+=b,r.total+=b,r.wrap&4&&b&&(s.adler=r.check=r.flags?mo(r.check,n,b,s.next_out-b):Hb(r.check,n,b,s.next_out-b)),s.data_type=r.bits+(r.last?64:0)+(r.mode===al?128:0)+(r.mode===oh||r.mode===Vf?256:0),(x===0&&b===0||t===kj)&&B===od&&(B=hA),B},kA=s=>{if(ld(s))return bi;let t=s.state;return t.window&&(t.window=null),s.state=null,od},NA=(s,t)=>{if(ld(s))return bi;const r=s.state;return(r.wrap&2)===0?bi:(r.head=t,t.done=!1,od)},wA=(s,t)=>{const r=t.length;let a,n,i;return ld(s)||(a=s.state,a.wrap!==0&&a.mode!==Gh)?bi:a.mode===Gh&&(n=1,n=Hb(n,t,r,0),n!==a.check)?Z1:(i=ek(s,t,r,r),i?(a.mode=K1,W1):(a.havedict=1,od))};var SA=J1,zA=X1,CA=Y1,PA=yA,AA=Q1,OA=_A,DA=kA,EA=NA,IA=wA,LA="pako inflate (from Nodeca project)",cl={inflateReset:SA,inflateReset2:zA,inflateResetKeep:CA,inflateInit:PA,inflateInit2:AA,inflate:OA,inflateEnd:DA,inflateGetHeader:EA,inflateSetDictionary:IA,inflateInfo:LA};function TA(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var RA=TA;const tk=Object.prototype.toString,{Z_NO_FLUSH:MA,Z_FINISH:FA,Z_OK:Hp,Z_STREAM_END:Kf,Z_NEED_DICT:Gf,Z_STREAM_ERROR:UA,Z_DATA_ERROR:Kj,Z_MEM_ERROR:qA}=q1;function Jp(s){this.options=$1.assign({chunkSize:1024*64,windowBits:15,to:""},s||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(s&&s.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15)===0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new rA,this.strm.avail_out=0;let r=cl.inflateInit2(this.strm,t.windowBits);if(r!==Hp)throw new Error(Zb[r]);if(this.header=new RA,cl.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=Wb.string2buf(t.dictionary):tk.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=cl.inflateSetDictionary(this.strm,t.dictionary),r!==Hp)))throw new Error(Zb[r])}Jp.prototype.push=function(s,t){const r=this.strm,a=this.options.chunkSize,n=this.options.dictionary;let i,o,c;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?FA:MA,tk.call(s)==="[object ArrayBuffer]"?r.input=new Uint8Array(s):r.input=s,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(a),r.next_out=0,r.avail_out=a),i=cl.inflate(r,o),i===Gf&&n&&(i=cl.inflateSetDictionary(r,n),i===Hp?i=cl.inflate(r,o):i===Kj&&(i=Gf));r.avail_in>0&&i===Kf&&r.state.wrap>0&&s[r.next_in]!==0;)cl.inflateReset(r),i=cl.inflate(r,o);switch(i){case UA:case Kj:case Gf:case qA:return this.onEnd(i),this.ended=!0,!1}if(c=r.avail_out,r.next_out&&(r.avail_out===0||i===Kf))if(this.options.to==="string"){let d=Wb.utf8border(r.output,r.next_out),p=r.next_out-d,m=Wb.buf2string(r.output,d);r.next_out=p,r.avail_out=a-p,p&&r.output.set(r.output.subarray(d,d+p),0),this.onData(m)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(i===Hp&&c===0)){if(i===Kf)return i=cl.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};Jp.prototype.onData=function(s){this.chunks.push(s)};Jp.prototype.onEnd=function(s){s===Hp&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=$1.flattenChunks(this.chunks)),this.chunks=[],this.err=s,this.msg=this.strm.msg};function $A(s,t){const r=new Jp(t);if(r.push(s),r.err)throw r.msg||Zb[r.err];return r.result}var BA=Jp,VA=$A,HA={Inflate:BA,inflate:VA};const{Inflate:ZA,inflate:WA}=HA;var Gj=ZA,KA=WA;const rk=[];for(let s=0;s<256;s++){let t=s;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;rk[s]=t}const Yj=4294967295;function GA(s,t,r){let a=s;for(let n=0;n<r;n++)a=rk[(a^t[n])&255]^a>>>8;return a}function YA(s,t){return(GA(Yj,s,t)^Yj)>>>0}function Jj(s,t,r){const a=s.readUint32(),n=YA(new Uint8Array(s.buffer,s.byteOffset+s.offset-t-4,t),t);if(n!==a)throw new Error(`CRC mismatch for chunk ${r}. Expected ${a}, found ${n}`)}function sk(s,t,r){for(let a=0;a<r;a++)t[a]=s[a]}function ak(s,t,r,a){let n=0;for(;n<a;n++)t[n]=s[n];for(;n<r;n++)t[n]=s[n]+t[n-a]&255}function nk(s,t,r,a){let n=0;if(r.length===0)for(;n<a;n++)t[n]=s[n];else for(;n<a;n++)t[n]=s[n]+r[n]&255}function ik(s,t,r,a,n){let i=0;if(r.length===0){for(;i<n;i++)t[i]=s[i];for(;i<a;i++)t[i]=s[i]+(t[i-n]>>1)&255}else{for(;i<n;i++)t[i]=s[i]+(r[i]>>1)&255;for(;i<a;i++)t[i]=s[i]+(t[i-n]+r[i]>>1)&255}}function ok(s,t,r,a,n){let i=0;if(r.length===0){for(;i<n;i++)t[i]=s[i];for(;i<a;i++)t[i]=s[i]+t[i-n]&255}else{for(;i<n;i++)t[i]=s[i]+r[i]&255;for(;i<a;i++)t[i]=s[i]+JA(t[i-n],r[i],r[i-n])&255}}function JA(s,t,r){const a=s+t-r,n=Math.abs(a-s),i=Math.abs(a-t),o=Math.abs(a-r);return n<=i&&n<=o?s:i<=o?t:r}function XA(s,t,r,a,n,i){switch(s){case 0:sk(t,r,n);break;case 1:ak(t,r,n,i);break;case 2:nk(t,r,a,n);break;case 3:ik(t,r,a,n,i);break;case 4:ok(t,r,a,n,i);break;default:throw new Error(`Unsupported filter: ${s}`)}}const QA=new Uint16Array([255]),eO=new Uint8Array(QA.buffer),tO=eO[0]===255;function rO(s){const{data:t,width:r,height:a,channels:n,depth:i}=s,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],c=Math.ceil(i/8)*n,d=new Uint8Array(a*r*c);let p=0;for(let m=0;m<7;m++){const x=o[m],b=Math.ceil((r-x.x)/x.xStep),h=Math.ceil((a-x.y)/x.yStep);if(b<=0||h<=0)continue;const j=b*c,g=new Uint8Array(j);for(let v=0;v<h;v++){const _=t[p++],k=t.subarray(p,p+j);p+=j;const P=new Uint8Array(j);XA(_,k,P,g,j,c),g.set(P);for(let L=0;L<b;L++){const F=x.x+L*x.xStep,W=x.y+v*x.yStep;if(!(F>=r||W>=a))for(let R=0;R<c;R++)d[(W*r+F)*c+R]=P[L*c+R]}}}if(i===16){const m=new Uint16Array(d.buffer);if(tO)for(let x=0;x<m.length;x++)m[x]=sO(m[x]);return m}else return d}function sO(s){return(s&255)<<8|s>>8&255}const aO=new Uint16Array([255]),nO=new Uint8Array(aO.buffer),iO=nO[0]===255,oO=new Uint8Array(0);function Xj(s){const{data:t,width:r,height:a,channels:n,depth:i}=s,o=Math.ceil(i/8)*n,c=Math.ceil(i/8*n*r),d=new Uint8Array(a*c);let p=oO,m=0,x,b;for(let h=0;h<a;h++){switch(x=t.subarray(m+1,m+1+c),b=d.subarray(h*c,(h+1)*c),t[m]){case 0:sk(x,b,c);break;case 1:ak(x,b,c,o);break;case 2:nk(x,b,p,c);break;case 3:ik(x,b,p,c,o);break;case 4:ok(x,b,p,c,o);break;default:throw new Error(`Unsupported filter: ${t[m]}`)}p=b,m+=c+1}if(i===16){const h=new Uint16Array(d.buffer);if(iO)for(let j=0;j<h.length;j++)h[j]=lO(h[j]);return h}else return d}function lO(s){return(s&255)<<8|s>>8&255}const gh=Uint8Array.of(137,80,78,71,13,10,26,10);function Qj(s){if(!cO(s.readBytes(gh.length)))throw new Error("wrong PNG signature")}function cO(s){if(s.length<gh.length)return!1;for(let t=0;t<gh.length;t++)if(s[t]!==gh[t])return!1;return!0}const dO="tEXt",uO=0,lk=new TextDecoder("latin1");function pO(s){if(hO(s),s.length===0||s.length>79)throw new Error("keyword length must be between 1 and 79")}const mO=/^[\u0000-\u00FF]*$/;function hO(s){if(!mO.test(s))throw new Error("invalid latin1 text")}function xO(s,t,r){const a=ck(t);s[a]=fO(t,r-a.length-1)}function ck(s){for(s.mark();s.readByte()!==uO;);const t=s.offset;s.reset();const r=lk.decode(s.readBytes(t-s.offset-1));return s.skip(1),pO(r),r}function fO(s,t){return lk.decode(s.readBytes(t))}const $n={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},Yf={UNKNOWN:-1,DEFLATE:0},e_={UNKNOWN:-1,ADAPTIVE:0},Jf={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},ch={NONE:0,BACKGROUND:1,PREVIOUS:2},Xf={SOURCE:0,OVER:1};class bO extends Ig{constructor(r,a={}){super(r);ft(this,"_checkCrc");ft(this,"_inflator");ft(this,"_png");ft(this,"_apng");ft(this,"_end");ft(this,"_hasPalette");ft(this,"_palette");ft(this,"_hasTransparency");ft(this,"_transparency");ft(this,"_compressionMethod");ft(this,"_filterMethod");ft(this,"_interlaceMethod");ft(this,"_colorType");ft(this,"_isAnimated");ft(this,"_numberOfFrames");ft(this,"_numberOfPlays");ft(this,"_frames");ft(this,"_writingDataChunks");const{checkCrc:n=!1}=a;this._checkCrc=n,this._inflator=new Gj,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Yf.UNKNOWN,this._filterMethod=e_.UNKNOWN,this._interlaceMethod=Jf.UNKNOWN,this._colorType=$n.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(Qj(this);!this._end;){const r=this.readUint32(),a=this.readChars(4);this.decodeChunk(r,a)}return this.decodeImage(),this._png}decodeApng(){for(Qj(this);!this._end;){const r=this.readUint32(),a=this.readChars(4);this.decodeApngChunk(r,a)}return this.decodeApngImage(),this._apng}decodeChunk(r,a){const n=this.offset;switch(a){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case dO:xO(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-n!==r)throw new Error(`Length mismatch while decoding chunk ${a}`);this._checkCrc?Jj(this,r+4,a):this.skip(4)}decodeApngChunk(r,a){const n=this.offset;switch(a!=="fdAT"&&a!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),a){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,a),this.offset=n+r;break}if(this.offset-n!==r)throw new Error(`Length mismatch while decoding chunk ${a}`);this._checkCrc?Jj(this,r+4,a):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=gO(this.readUint8());const a=this.readUint8();this._colorType=a;let n;switch(a){case $n.GREYSCALE:n=1;break;case $n.TRUECOLOUR:n=3;break;case $n.INDEXED_COLOUR:n=1;break;case $n.GREYSCALE_ALPHA:n=2;break;case $n.TRUECOLOUR_ALPHA:n=4;break;case $n.UNKNOWN:default:throw new Error(`Unknown color type: ${a}`)}if(this._png.channels=n,this._compressionMethod=this.readUint8(),this._compressionMethod!==Yf.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const a=r/3;this._hasPalette=!0;const n=[];this._palette=n;for(let i=0;i<a;i++)n.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const a=r,n=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,n,a)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let a=r,n=this.offset+this.byteOffset;if(n+=4,a-=4,this._inflator.push(new Uint8Array(this.buffer,n,a)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case $n.GREYSCALE:case $n.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let a=0;a<r/2;a++)this._transparency[a]=this.readUint16();break}case $n.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let a=0;for(;a<r;a++){const n=this.readByte();this._palette[a].push(n)}for(;a<this._palette.length;a++)this._palette[a].push(255);break}case $n.UNKNOWN:case $n.GREYSCALE_ALPHA:case $n.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const a=ck(this),n=this.readUint8();if(n!==Yf.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${n}`);const i=this.readBytes(r-a.length-2);this._png.iccEmbeddedProfile={name:a,profile:KA(i)}}decodepHYs(){const r=this.readUint32(),a=this.readUint32(),n=this.readByte();this._png.resolution={x:r,y:a,unit:n}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const a={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},n=this._frames.at(r);if(n){if(n.data=Xj({data:n.data,width:n.width,height:n.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||n.xOffset===0&&n.yOffset===0&&n.width===this._png.width&&n.height===this._png.height)a.data=n.data;else{const i=this._apng.frames.at(r-1);this.disposeFrame(n,i,a),this.addFrameDataToCanvas(a,n)}this._apng.frames.push(a)}}return this._apng}disposeFrame(r,a,n){switch(r.disposeOp){case ch.NONE:break;case ch.BACKGROUND:for(let i=0;i<this._png.height;i++)for(let o=0;o<this._png.width;o++){const c=(i*r.width+o)*this._png.channels;for(let d=0;d<this._png.channels;d++)n.data[c+d]=0}break;case ch.PREVIOUS:n.data.set(a.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,a){const n=1<<this._png.depth,i=(o,c)=>{const d=((o+a.yOffset)*this._png.width+a.xOffset+c)*this._png.channels,p=(o*a.width+c)*this._png.channels;return{index:d,frameIndex:p}};switch(a.blendOp){case Xf.SOURCE:for(let o=0;o<a.height;o++)for(let c=0;c<a.width;c++){const{index:d,frameIndex:p}=i(o,c);for(let m=0;m<this._png.channels;m++)r.data[d+m]=a.data[p+m]}break;case Xf.OVER:for(let o=0;o<a.height;o++)for(let c=0;c<a.width;c++){const{index:d,frameIndex:p}=i(o,c);for(let m=0;m<this._png.channels;m++){const x=a.data[p+this._png.channels-1]/n,b=m%(this._png.channels-1)===0?1:a.data[p+m],h=Math.floor(x*b+(1-x)*r.data[d+m]);r.data[d+m]+=h}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var a;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((a=this._frames)==null?void 0:a.at(0)).data:this._inflator.result;if(this._filterMethod!==e_.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Jf.NO_INTERLACE)this._png.data=Xj({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===Jf.ADAM7)this._png.data=rO({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,a=this._frames.at(-1);a?a.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:ch.NONE,blendOp:Xf.SOURCE,data:r}),this._inflator=new Gj,this._writingDataChunks=!1}}function gO(s){if(s!==1&&s!==2&&s!==4&&s!==8&&s!==16)throw new Error(`invalid bit depth: ${s}`);return s}var t_;(function(s){s[s.UNKNOWN=0]="UNKNOWN",s[s.METRE=1]="METRE"})(t_||(t_={}));function vO(s,t){return new bO(s,t).decode()}var Qt=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function Qf(){Qt.console&&typeof Qt.console.log=="function"&&Qt.console.log.apply(Qt.console,arguments)}var Xr={log:Qf,warn:function(s){Qt.console&&(typeof Qt.console.warn=="function"?Qt.console.warn.apply(Qt.console,arguments):Qf.call(null,arguments))},error:function(s){Qt.console&&(typeof Qt.console.error=="function"?Qt.console.error.apply(Qt.console,arguments):Qf(s))}};function eb(s,t,r){var a=new XMLHttpRequest;a.open("GET",s),a.responseType="blob",a.onload=function(){Vc(a.response,t,r)},a.onerror=function(){Xr.error("could not download file")},a.send()}function r_(s){var t=new XMLHttpRequest;t.open("HEAD",s,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function dh(s){try{s.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),s.dispatchEvent(t)}}var Vc=Qt.saveAs||((typeof window>"u"?"undefined":Zr(window))!=="object"||window!==Qt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(s,t,r){var a=Qt.URL||Qt.webkitURL,n=document.createElement("a");t=t||s.name||"download",n.download=t,n.rel="noopener",typeof s=="string"?(n.href=s,n.origin!==location.origin?r_(n.href)?eb(s,t,r):dh(n,n.target="_blank"):dh(n)):(n.href=a.createObjectURL(s),setTimeout(function(){a.revokeObjectURL(n.href)},4e4),setTimeout(function(){dh(n)},0))}:"msSaveOrOpenBlob"in navigator?function(s,t,r){if(t=t||s.name||"download",typeof s=="string")if(r_(s))eb(s,t,r);else{var a=document.createElement("a");a.href=s,a.target="_blank",setTimeout(function(){dh(a)})}else navigator.msSaveOrOpenBlob((function(n,i){return i===void 0?i={autoBom:!1}:Zr(i)!=="object"&&(Xr.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\uFEFF",n],{type:n.type}):n})(s,r),t)}:function(s,t,r,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),typeof s=="string")return eb(s,t,r);var n=s.type==="application/octet-stream",i=/constructor/i.test(Qt.HTMLElement)||Qt.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||n&&i)&&(typeof FileReader>"u"?"undefined":Zr(FileReader))==="object"){var c=new FileReader;c.onloadend=function(){var m=c.result;m=o?m:m.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=m:location=m,a=null},c.readAsDataURL(s)}else{var d=Qt.URL||Qt.webkitURL,p=d.createObjectURL(s);a?a.location=p:location.href=p,a=null,setTimeout(function(){d.revokeObjectURL(p)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function dk(s){var t;s=s||"",this.ok=!1,s.charAt(0)=="#"&&(s=s.substr(1,6)),s={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[s=(s=s.replace(/ /g,"")).toLowerCase()]||s;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(c){return[parseInt(c[1]),parseInt(c[2]),parseInt(c[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(c){return[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(c){return[parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)]}}],a=0;a<r.length;a++){var n=r[a].re,i=r[a].process,o=n.exec(s);o&&(t=i(o),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var c=this.r.toString(16),d=this.g.toString(16),p=this.b.toString(16);return c.length==1&&(c="0"+c),d.length==1&&(d="0"+d),p.length==1&&(p="0"+p),"#"+c+d+p}}var vh=Qt.atob.bind(Qt),s_=Qt.btoa.bind(Qt);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function tb(s,t){var r=s[0],a=s[1],n=s[2],i=s[3];r=La(r,a,n,i,t[0],7,-680876936),i=La(i,r,a,n,t[1],12,-389564586),n=La(n,i,r,a,t[2],17,606105819),a=La(a,n,i,r,t[3],22,-1044525330),r=La(r,a,n,i,t[4],7,-176418897),i=La(i,r,a,n,t[5],12,1200080426),n=La(n,i,r,a,t[6],17,-1473231341),a=La(a,n,i,r,t[7],22,-45705983),r=La(r,a,n,i,t[8],7,1770035416),i=La(i,r,a,n,t[9],12,-1958414417),n=La(n,i,r,a,t[10],17,-42063),a=La(a,n,i,r,t[11],22,-1990404162),r=La(r,a,n,i,t[12],7,1804603682),i=La(i,r,a,n,t[13],12,-40341101),n=La(n,i,r,a,t[14],17,-1502002290),r=Ta(r,a=La(a,n,i,r,t[15],22,1236535329),n,i,t[1],5,-165796510),i=Ta(i,r,a,n,t[6],9,-1069501632),n=Ta(n,i,r,a,t[11],14,643717713),a=Ta(a,n,i,r,t[0],20,-373897302),r=Ta(r,a,n,i,t[5],5,-701558691),i=Ta(i,r,a,n,t[10],9,38016083),n=Ta(n,i,r,a,t[15],14,-660478335),a=Ta(a,n,i,r,t[4],20,-405537848),r=Ta(r,a,n,i,t[9],5,568446438),i=Ta(i,r,a,n,t[14],9,-1019803690),n=Ta(n,i,r,a,t[3],14,-187363961),a=Ta(a,n,i,r,t[8],20,1163531501),r=Ta(r,a,n,i,t[13],5,-1444681467),i=Ta(i,r,a,n,t[2],9,-51403784),n=Ta(n,i,r,a,t[7],14,1735328473),r=Ra(r,a=Ta(a,n,i,r,t[12],20,-1926607734),n,i,t[5],4,-378558),i=Ra(i,r,a,n,t[8],11,-2022574463),n=Ra(n,i,r,a,t[11],16,1839030562),a=Ra(a,n,i,r,t[14],23,-35309556),r=Ra(r,a,n,i,t[1],4,-1530992060),i=Ra(i,r,a,n,t[4],11,1272893353),n=Ra(n,i,r,a,t[7],16,-155497632),a=Ra(a,n,i,r,t[10],23,-1094730640),r=Ra(r,a,n,i,t[13],4,681279174),i=Ra(i,r,a,n,t[0],11,-358537222),n=Ra(n,i,r,a,t[3],16,-722521979),a=Ra(a,n,i,r,t[6],23,76029189),r=Ra(r,a,n,i,t[9],4,-640364487),i=Ra(i,r,a,n,t[12],11,-421815835),n=Ra(n,i,r,a,t[15],16,530742520),r=Ma(r,a=Ra(a,n,i,r,t[2],23,-995338651),n,i,t[0],6,-198630844),i=Ma(i,r,a,n,t[7],10,1126891415),n=Ma(n,i,r,a,t[14],15,-1416354905),a=Ma(a,n,i,r,t[5],21,-57434055),r=Ma(r,a,n,i,t[12],6,1700485571),i=Ma(i,r,a,n,t[3],10,-1894986606),n=Ma(n,i,r,a,t[10],15,-1051523),a=Ma(a,n,i,r,t[1],21,-2054922799),r=Ma(r,a,n,i,t[8],6,1873313359),i=Ma(i,r,a,n,t[15],10,-30611744),n=Ma(n,i,r,a,t[6],15,-1560198380),a=Ma(a,n,i,r,t[13],21,1309151649),r=Ma(r,a,n,i,t[4],6,-145523070),i=Ma(i,r,a,n,t[11],10,-1120210379),n=Ma(n,i,r,a,t[2],15,718787259),a=Ma(a,n,i,r,t[9],21,-343485551),s[0]=rc(r,s[0]),s[1]=rc(a,s[1]),s[2]=rc(n,s[2]),s[3]=rc(i,s[3])}function xx(s,t,r,a,n,i){return t=rc(rc(t,s),rc(a,i)),rc(t<<n|t>>>32-n,r)}function La(s,t,r,a,n,i,o){return xx(t&r|~t&a,s,t,n,i,o)}function Ta(s,t,r,a,n,i,o){return xx(t&a|r&~a,s,t,n,i,o)}function Ra(s,t,r,a,n,i,o){return xx(t^r^a,s,t,n,i,o)}function Ma(s,t,r,a,n,i,o){return xx(r^(t|~a),s,t,n,i,o)}function uk(s){var t,r=s.length,a=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=s.length;t+=64)tb(a,yO(s.substring(t-64,t)));s=s.substring(t-64);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<s.length;t++)n[t>>2]|=s.charCodeAt(t)<<(t%4<<3);if(n[t>>2]|=128<<(t%4<<3),t>55)for(tb(a,n),t=0;t<16;t++)n[t]=0;return n[14]=8*r,tb(a,n),a}function yO(s){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=s.charCodeAt(t)+(s.charCodeAt(t+1)<<8)+(s.charCodeAt(t+2)<<16)+(s.charCodeAt(t+3)<<24);return r}var a_="0123456789abcdef".split("");function jO(s){for(var t="",r=0;r<4;r++)t+=a_[s>>8*r+4&15]+a_[s>>8*r&15];return t}function _O(s){return String.fromCharCode(255&s,(65280&s)>>8,(16711680&s)>>16,(4278190080&s)>>24)}function Kb(s){return uk(s).map(_O).join("")}var kO=(function(s){for(var t=0;t<s.length;t++)s[t]=jO(s[t]);return s.join("")})(uk("hello"))!="5d41402abc4b2a76b9719d911017c592";function rc(s,t){if(kO){var r=(65535&s)+(65535&t);return(s>>16)+(t>>16)+(r>>16)<<16|65535&r}return s+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Gb(s,t){var r,a,n,i;if(s!==r){for(var o=(n=s,i=1+(256/s.length|0),new Array(i+1).join(n)),c=[],d=0;d<256;d++)c[d]=d;var p=0;for(d=0;d<256;d++){var m=c[d];p=(p+m+o.charCodeAt(d))%256,c[d]=c[p],c[p]=m}r=s,a=c}else c=a;var x=t.length,b=0,h=0,j="";for(d=0;d<x;d++)h=(h+(m=c[b=(b+1)%256]))%256,c[b]=c[h],c[h]=m,o=c[(c[b]+c[h])%256],j+=String.fromCharCode(t.charCodeAt(d)^o);return j}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var n_={print:4,modify:8,copy:16,"annot-forms":32};function au(s,t,r,a){this.v=1,this.r=2;var n=192;s.forEach(function(c){if(n_.perm!==void 0)throw new Error("Invalid permission: "+c);n+=n_[c]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var i=(t+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,o),this.P=-(1+(255^n)),this.encryptionKey=Kb(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(a)).substr(0,5),this.U=Gb(this.encryptionKey,this.padding)}function nu(s){if(/[^\u0000-\u00ff]/.test(s))throw new Error("Invalid PDF Name Object: "+s+", Only accept ASCII characters.");for(var t="",r=s.length,a=0;a<r;a++){var n=s.charCodeAt(a);t+=n<33||n===35||n===37||n===40||n===41||n===47||n===60||n===62||n===91||n===93||n===123||n===125||n>126?"#"+("0"+n.toString(16)).slice(-2):s[a]}return t}function i_(s){if(Zr(s)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,a,n){if(n=n||!1,typeof r!="string"||typeof a!="function"||typeof n!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var i=Math.random().toString(35);return t[r][i]=[a,!!n],i},this.unsubscribe=function(r){for(var a in t)if(t[a][r])return delete t[a][r],Object.keys(t[a]).length===0&&delete t[a],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var a=Array.prototype.slice.call(arguments,1),n=[];for(var i in t[r]){var o=t[r][i];try{o[0].apply(s,a)}catch(c){Qt.console&&Xr.error("jsPDF PubSub Error",c.message,c)}o[1]&&n.push(i)}n.length&&n.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function Yh(s){if(!(this instanceof Yh))return new Yh(s);var t="opacity,stroke-opacity".split(",");for(var r in s)s.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=s[r]);this.id="",this.objectNumber=-1}function pk(s,t){this.gState=s,this.matrix=t,this.id="",this.objectNumber=-1}function Kc(s,t,r,a,n){if(!(this instanceof Kc))return new Kc(s,t,r,a,n);this.type=s==="axial"?2:3,this.coords=t,this.colors=r,pk.call(this,a,n)}function iu(s,t,r,a,n){if(!(this instanceof iu))return new iu(s,t,r,a,n);this.boundingBox=s,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,pk.call(this,a,n)}function It(s){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",a=arguments[1],n=arguments[2],i=arguments[3],o=[],c=1,d=16,p="S",m=null;Zr(s=s||{})==="object"&&(r=s.orientation,a=s.unit||a,n=s.format||n,i=s.compress||s.compressPdf||i,(m=s.encryption||null)!==null&&(m.userPassword=m.userPassword||"",m.ownerPassword=m.ownerPassword||"",m.userPermissions=m.userPermissions||[]),c=typeof s.userUnit=="number"?Math.abs(s.userUnit):1,s.precision!==void 0&&(t=s.precision),s.floatPrecision!==void 0&&(d=s.floatPrecision),p=s.defaultPathOperation||"S"),o=s.filters||(i===!0?["FlateEncode"]:o),a=a||"mm",r=(""+(r||"P")).toLowerCase();var x=s.putOnlyUsedFonts||!1,b={},h={internal:{},__private__:{}};h.__private__.PubSub=i_;var j="1.3",g=h.__private__.getPdfVersion=function(){return j};h.__private__.setPdfVersion=function(D){j=D};var v={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return v};var _=h.__private__.getPageFormat=function(D){return v[D]};n=n||"a4";var k="compat",P="advanced",L=k;function F(){this.saveGraphicsState(),ue(new dt(Nt,0,0,-Nt,0,cn()*Nt).toString()+" cm"),this.setFontSize(this.getFontSize()/Nt),p="n",L=P}function W(){this.restoreGraphicsState(),p="S",L=k}var R=h.__private__.combineFontStyleAndFontWeight=function(D,ae){if(D=="bold"&&ae=="normal"||D=="bold"&&ae==400||D=="normal"&&ae=="italic"||D=="bold"&&ae=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return ae&&(D=ae==400||ae==="normal"?D==="italic"?"italic":"normal":ae!=700&&ae!=="bold"||D!=="normal"?(ae==700?"bold":ae)+""+D:"bold"),D};h.advancedAPI=function(D){var ae=L===k;return ae&&F.call(this),typeof D!="function"||(D(this),ae&&W.call(this)),this},h.compatAPI=function(D){var ae=L===P;return ae&&W.call(this),typeof D!="function"||(D(this),ae&&F.call(this)),this},h.isAdvancedAPI=function(){return L===P};var B,A=function(D){if(L!==P)throw new Error(D+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},S=h.roundToPrecision=h.__private__.roundToPrecision=function(D,ae){var ve=t||ae;if(isNaN(D)||isNaN(ve))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return D.toFixed(ve).replace(/0+$/,"")};B=h.hpf=h.__private__.hpf=typeof d=="number"?function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.hpf");return S(D,d)}:d==="smart"?function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.hpf");return S(D,D>-1&&D<1?16:5)}:function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.hpf");return S(D,16)};var C=h.f2=h.__private__.f2=function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.f2");return S(D,2)},O=h.__private__.f3=function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.f3");return S(D,3)},Z=h.scale=h.__private__.scale=function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.scale");return L===k?D*Nt:L===P?D:void 0},te=function(D){return Z((function(ae){return L===k?cn()-ae:L===P?ae:void 0})(D))};h.__private__.setPrecision=h.setPrecision=function(D){typeof parseInt(D,10)=="number"&&(t=parseInt(D,10))};var ce,re="00000000000000000000000000000000",X=h.__private__.getFileId=function(){return re},U=h.__private__.setFileId=function(D){return re=D!==void 0&&/^[a-fA-F0-9]{32}$/.test(D)?D.toUpperCase():re.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),m!==null&&(bs=new au(m.userPermissions,m.userPassword,m.ownerPassword,re)),re};h.setFileId=function(D){return U(D),this},h.getFileId=function(){return X()};var oe=h.__private__.convertDateToPDFDate=function(D){var ae=D.getTimezoneOffset(),ve=ae<0?"+":"-",we=Math.floor(Math.abs(ae/60)),Ae=Math.abs(ae%60),Ve=[ve,q(we),"'",q(Ae),"'"].join("");return["D:",D.getFullYear(),q(D.getMonth()+1),q(D.getDate()),q(D.getHours()),q(D.getMinutes()),q(D.getSeconds()),Ve].join("")},xe=h.__private__.convertPDFDateToDate=function(D){var ae=parseInt(D.substr(2,4),10),ve=parseInt(D.substr(6,2),10)-1,we=parseInt(D.substr(8,2),10),Ae=parseInt(D.substr(10,2),10),Ve=parseInt(D.substr(12,2),10),We=parseInt(D.substr(14,2),10);return new Date(ae,ve,we,Ae,Ve,We,0)},J=h.__private__.setCreationDate=function(D){var ae;if(D===void 0&&(D=new Date),D instanceof Date)ae=oe(D);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(D))throw new Error("Invalid argument passed to jsPDF.setCreationDate");ae=D}return ce=ae},$=h.__private__.getCreationDate=function(D){var ae=ce;return D==="jsDate"&&(ae=xe(ce)),ae};h.setCreationDate=function(D){return J(D),this},h.getCreationDate=function(D){return $(D)};var Q,q=h.__private__.padd2=function(D){return("0"+parseInt(D)).slice(-2)},I=h.__private__.padd2Hex=function(D){return("00"+(D=D.toString())).substr(D.length)},Y=0,H=[],he=[],ge=0,K=[],T=[],ee=!1,_e=he;h.__private__.setCustomOutputDestination=function(D){ee=!0,_e=D};var ke=function(D){ee||(_e=D)};h.__private__.resetCustomOutputDestination=function(){ee=!1,_e=he};var ue=h.__private__.out=function(D){return D=D.toString(),ge+=D.length+1,_e.push(D),_e},je=h.__private__.write=function(D){return ue(arguments.length===1?D.toString():Array.prototype.join.call(arguments," "))},ne=h.__private__.getArrayBuffer=function(D){for(var ae=D.length,ve=new ArrayBuffer(ae),we=new Uint8Array(ve);ae--;)we[ae]=D.charCodeAt(ae);return ve},Re=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return Re};var Oe=s.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(D){return Oe=L===P?D/Nt:D,this};var Je,Be=h.__private__.getFontSize=h.getFontSize=function(){return L===k?Oe:Oe*Nt},kt=s.R2L||!1;h.__private__.setR2L=h.setR2L=function(D){return kt=D,this},h.__private__.getR2L=h.getR2L=function(){return kt};var it,Ft=h.__private__.setZoomMode=function(D){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(D))Je=D;else if(isNaN(D)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(D)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+D+'" is not recognized.');Je=D}else Je=parseInt(D,10)};h.__private__.getZoomMode=function(){return Je};var Tt,ot=h.__private__.setPageMode=function(D){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(D)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+D+'" is not recognized.');it=D};h.__private__.getPageMode=function(){return it};var Jt=h.__private__.setLayoutMode=function(D){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(D)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+D+'" is not recognized.');Tt=D};h.__private__.getLayoutMode=function(){return Tt},h.__private__.setDisplayMode=h.setDisplayMode=function(D,ae,ve){return Ft(D),Jt(ae),ot(ve),this};var Vt={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(D){if(Object.keys(Vt).indexOf(D)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Vt[D]},h.__private__.getDocumentProperties=function(){return Vt},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(D){for(var ae in Vt)Vt.hasOwnProperty(ae)&&D[ae]&&(Vt[ae]=D[ae]);return this},h.__private__.setDocumentProperty=function(D,ae){if(Object.keys(Vt).indexOf(D)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Vt[D]=ae};var wt,Nt,bt,jr,Zt,ct={},Ut={},dr=[],Et={},or={},qt={},Lr={},Tr=null,ur=0,De=[],Qe=new i_(h),st=s.hotfixes||[],zt={},rr={},_r=[],dt=function D(ae,ve,we,Ae,Ve,We){if(!(this instanceof D))return new D(ae,ve,we,Ae,Ve,We);isNaN(ae)&&(ae=1),isNaN(ve)&&(ve=0),isNaN(we)&&(we=0),isNaN(Ae)&&(Ae=1),isNaN(Ve)&&(Ve=0),isNaN(We)&&(We=0),this._matrix=[ae,ve,we,Ae,Ve,We]};Object.defineProperty(dt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(D){this._matrix[0]=D}}),Object.defineProperty(dt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(D){this._matrix[1]=D}}),Object.defineProperty(dt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(D){this._matrix[2]=D}}),Object.defineProperty(dt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(D){this._matrix[3]=D}}),Object.defineProperty(dt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(D){this._matrix[4]=D}}),Object.defineProperty(dt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(D){this._matrix[5]=D}}),Object.defineProperty(dt.prototype,"a",{get:function(){return this._matrix[0]},set:function(D){this._matrix[0]=D}}),Object.defineProperty(dt.prototype,"b",{get:function(){return this._matrix[1]},set:function(D){this._matrix[1]=D}}),Object.defineProperty(dt.prototype,"c",{get:function(){return this._matrix[2]},set:function(D){this._matrix[2]=D}}),Object.defineProperty(dt.prototype,"d",{get:function(){return this._matrix[3]},set:function(D){this._matrix[3]=D}}),Object.defineProperty(dt.prototype,"e",{get:function(){return this._matrix[4]},set:function(D){this._matrix[4]=D}}),Object.defineProperty(dt.prototype,"f",{get:function(){return this._matrix[5]},set:function(D){this._matrix[5]=D}}),Object.defineProperty(dt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(dt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(dt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(dt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),dt.prototype.join=function(D){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(B).join(D)},dt.prototype.multiply=function(D){var ae=D.sx*this.sx+D.shy*this.shx,ve=D.sx*this.shy+D.shy*this.sy,we=D.shx*this.sx+D.sy*this.shx,Ae=D.shx*this.shy+D.sy*this.sy,Ve=D.tx*this.sx+D.ty*this.shx+this.tx,We=D.tx*this.shy+D.ty*this.sy+this.ty;return new dt(ae,ve,we,Ae,Ve,We)},dt.prototype.decompose=function(){var D=this.sx,ae=this.shy,ve=this.shx,we=this.sy,Ae=this.tx,Ve=this.ty,We=Math.sqrt(D*D+ae*ae),vt=(D/=We)*ve+(ae/=We)*we;ve-=D*vt,we-=ae*vt;var Ct=Math.sqrt(ve*ve+we*we);return vt/=Ct,D*(we/=Ct)<ae*(ve/=Ct)&&(D=-D,ae=-ae,vt=-vt,We=-We),{scale:new dt(We,0,0,Ct,0,0),translate:new dt(1,0,0,1,Ae,Ve),rotate:new dt(D,ae,-ae,D,0,0),skew:new dt(1,0,vt,1,0,0)}},dt.prototype.toString=function(D){return this.join(" ")},dt.prototype.inversed=function(){var D=this.sx,ae=this.shy,ve=this.shx,we=this.sy,Ae=this.tx,Ve=this.ty,We=1/(D*we-ae*ve),vt=we*We,Ct=-ae*We,Kt=-ve*We,Gt=D*We;return new dt(vt,Ct,Kt,Gt,-vt*Ae-Kt*Ve,-Ct*Ae-Gt*Ve)},dt.prototype.applyToPoint=function(D){var ae=D.x*this.sx+D.y*this.shx+this.tx,ve=D.x*this.shy+D.y*this.sy+this.ty;return new Xn(ae,ve)},dt.prototype.applyToRectangle=function(D){var ae=this.applyToPoint(D),ve=this.applyToPoint(new Xn(D.x+D.w,D.y+D.h));return new Do(ae.x,ae.y,ve.x-ae.x,ve.y-ae.y)},dt.prototype.clone=function(){var D=this.sx,ae=this.shy,ve=this.shx,we=this.sy,Ae=this.tx,Ve=this.ty;return new dt(D,ae,ve,we,Ae,Ve)},h.Matrix=dt;var kr=h.matrixMult=function(D,ae){return ae.multiply(D)},Ke=new dt(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=Ke;var nt=function(D,ae){if(!or[D]){var ve=(ae instanceof Kc?"Sh":"P")+(Object.keys(Et).length+1).toString(10);ae.id=ve,or[D]=ve,Et[ve]=ae,Qe.publish("addPattern",ae)}};h.ShadingPattern=Kc,h.TilingPattern=iu,h.addShadingPattern=function(D,ae){return A("addShadingPattern()"),nt(D,ae),this},h.beginTilingPattern=function(D){A("beginTilingPattern()"),nn(D.boundingBox[0],D.boundingBox[1],D.boundingBox[2]-D.boundingBox[0],D.boundingBox[3]-D.boundingBox[1],D.matrix)},h.endTilingPattern=function(D,ae){A("endTilingPattern()"),ae.stream=T[Q].join(`
`),nt(D,ae),Qe.publish("endTilingPattern",ae),_r.pop().restore()};var Nr,gr=h.__private__.newObject=function(){var D=Gr();return mr(D,!0),D},Gr=h.__private__.newObjectDeferred=function(){return Y++,H[Y]=function(){return ge},Y},mr=function(D,ae){return ae=typeof ae=="boolean"&&ae,H[D]=ge,ae&&ue(D+" 0 obj"),D},tn=h.__private__.newAdditionalObject=function(){var D={objId:Gr(),content:""};return K.push(D),D},Ki=Gr(),zn=Gr(),Wn=h.__private__.decodeColorString=function(D){var ae=D.split(" ");if(ae.length!==2||ae[1]!=="g"&&ae[1]!=="G")ae.length!==5||ae[4]!=="k"&&ae[4]!=="K"||(ae=[(1-ae[0])*(1-ae[3]),(1-ae[1])*(1-ae[3]),(1-ae[2])*(1-ae[3]),"r"]);else{var ve=parseFloat(ae[0]);ae=[ve,ve,ve,"r"]}for(var we="#",Ae=0;Ae<3;Ae++)we+=("0"+Math.floor(255*parseFloat(ae[Ae])).toString(16)).slice(-2);return we},Ys=h.__private__.encodeColorString=function(D){var ae;typeof D=="string"&&(D={ch1:D});var ve=D.ch1,we=D.ch2,Ae=D.ch3,Ve=D.ch4,We=D.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ve=="string"&&ve.charAt(0)!=="#"){var vt=new dk(ve);if(vt.ok)ve=vt.toHex();else if(!/^\d*\.?\d*$/.test(ve))throw new Error('Invalid color "'+ve+'" passed to jsPDF.encodeColorString.')}if(typeof ve=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ve)&&(ve="#"+ve[1]+ve[1]+ve[2]+ve[2]+ve[3]+ve[3]),typeof ve=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ve)){var Ct=parseInt(ve.substr(1),16);ve=Ct>>16&255,we=Ct>>8&255,Ae=255&Ct}if(we===void 0||Ve===void 0&&ve===we&&we===Ae)ae=typeof ve=="string"?ve+" "+We[0]:D.precision===2?C(ve/255)+" "+We[0]:O(ve/255)+" "+We[0];else if(Ve===void 0||Zr(Ve)==="object"){if(Ve&&!isNaN(Ve.a)&&Ve.a===0)return["1.","1.","1.",We[1]].join(" ");ae=typeof ve=="string"?[ve,we,Ae,We[1]].join(" "):D.precision===2?[C(ve/255),C(we/255),C(Ae/255),We[1]].join(" "):[O(ve/255),O(we/255),O(Ae/255),We[1]].join(" ")}else ae=typeof ve=="string"?[ve,we,Ae,Ve,We[2]].join(" "):D.precision===2?[C(ve),C(we),C(Ae),C(Ve),We[2]].join(" "):[O(ve),O(we),O(Ae),O(Ve),We[2]].join(" ");return ae},rn=h.__private__.getFilters=function(){return o},qa=h.__private__.putStream=function(D){var ae=(D=D||{}).data||"",ve=D.filters||rn(),we=D.alreadyAppliedFilters||[],Ae=D.addLength1||!1,Ve=ae.length,We=D.objectId,vt=function(Ts){return Ts};if(m!==null&&We===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");m!==null&&(vt=bs.encryptor(We,0));var Ct={};ve===!0&&(ve=["FlateEncode"]);var Kt=D.additionalKeyValues||[],Gt=(Ct=It.API.processDataByFilters!==void 0?It.API.processDataByFilters(ae,ve):{data:ae,reverseChain:[]}).reverseChain+(Array.isArray(we)?we.join(" "):we.toString());if(Ct.data.length!==0&&(Kt.push({key:"Length",value:Ct.data.length}),Ae===!0&&Kt.push({key:"Length1",value:Ve})),Gt.length!=0)if(Gt.split("/").length-1==1)Kt.push({key:"Filter",value:Gt});else{Kt.push({key:"Filter",value:"["+Gt+"]"});for(var wr=0;wr<Kt.length;wr+=1)if(Kt[wr].key==="DecodeParms"){for(var as=[],Ps=0;Ps<Ct.reverseChain.split("/").length-1;Ps+=1)as.push("null");as.push(Kt[wr].value),Kt[wr].value="["+as.join(" ")+"]"}}ue("<<");for(var Wr=0;Wr<Kt.length;Wr++)ue("/"+Kt[Wr].key+" "+Kt[Wr].value);ue(">>"),Ct.data.length!==0&&(ue("stream"),ue(vt(Ct.data)),ue("endstream"))},_o=h.__private__.putPage=function(D){var ae=D.number,ve=D.data,we=D.objId,Ae=D.contentsObjId;mr(we,!0),ue("<</Type /Page"),ue("/Parent "+D.rootDictionaryObjId+" 0 R"),ue("/Resources "+D.resourceDictionaryObjId+" 0 R"),ue("/MediaBox ["+parseFloat(B(D.mediaBox.bottomLeftX))+" "+parseFloat(B(D.mediaBox.bottomLeftY))+" "+B(D.mediaBox.topRightX)+" "+B(D.mediaBox.topRightY)+"]"),D.cropBox!==null&&ue("/CropBox ["+B(D.cropBox.bottomLeftX)+" "+B(D.cropBox.bottomLeftY)+" "+B(D.cropBox.topRightX)+" "+B(D.cropBox.topRightY)+"]"),D.bleedBox!==null&&ue("/BleedBox ["+B(D.bleedBox.bottomLeftX)+" "+B(D.bleedBox.bottomLeftY)+" "+B(D.bleedBox.topRightX)+" "+B(D.bleedBox.topRightY)+"]"),D.trimBox!==null&&ue("/TrimBox ["+B(D.trimBox.bottomLeftX)+" "+B(D.trimBox.bottomLeftY)+" "+B(D.trimBox.topRightX)+" "+B(D.trimBox.topRightY)+"]"),D.artBox!==null&&ue("/ArtBox ["+B(D.artBox.bottomLeftX)+" "+B(D.artBox.bottomLeftY)+" "+B(D.artBox.topRightX)+" "+B(D.artBox.topRightY)+"]"),typeof D.userUnit=="number"&&D.userUnit!==1&&ue("/UserUnit "+D.userUnit),Qe.publish("putPage",{objId:we,pageContext:De[ae],pageNumber:ae,page:ve}),ue("/Contents "+Ae+" 0 R"),ue(">>"),ue("endobj");var Ve=ve.join(`
`);return L===P&&(Ve+=`
Q`),mr(Ae,!0),qa({data:Ve,filters:rn(),objectId:Ae}),ue("endobj"),we},Cn=h.__private__.putPages=function(){var D,ae,ve=[];for(D=1;D<=ur;D++)De[D].objId=Gr(),De[D].contentsObjId=Gr();for(D=1;D<=ur;D++)ve.push(_o({number:D,data:T[D],objId:De[D].objId,contentsObjId:De[D].contentsObjId,mediaBox:De[D].mediaBox,cropBox:De[D].cropBox,bleedBox:De[D].bleedBox,trimBox:De[D].trimBox,artBox:De[D].artBox,userUnit:De[D].userUnit,rootDictionaryObjId:Ki,resourceDictionaryObjId:zn}));mr(Ki,!0),ue("<</Type /Pages");var we="/Kids [";for(ae=0;ae<ur;ae++)we+=ve[ae]+" 0 R ";ue(we+"]"),ue("/Count "+ur),ue(">>"),ue("endobj"),Qe.publish("postPutPages")},Gi=function(D){Qe.publish("putFont",{font:D,out:ue,newObject:gr,putStream:qa}),D.isAlreadyPutted!==!0&&(D.objectNumber=gr(),ue("<<"),ue("/Type /Font"),ue("/BaseFont /"+nu(D.postScriptName)),ue("/Subtype /Type1"),typeof D.encoding=="string"&&ue("/Encoding /"+D.encoding),ue("/FirstChar 32"),ue("/LastChar 255"),ue(">>"),ue("endobj"))},ko=function(D){D.objectNumber=gr();var ae=[];ae.push({key:"Type",value:"/XObject"}),ae.push({key:"Subtype",value:"/Form"}),ae.push({key:"BBox",value:"["+[B(D.x),B(D.y),B(D.x+D.width),B(D.y+D.height)].join(" ")+"]"}),ae.push({key:"Matrix",value:"["+D.matrix.toString()+"]"});var ve=D.pages[1].join(`
`);qa({data:ve,additionalKeyValues:ae,objectId:D.objectNumber}),ue("endobj")},No=function(D,ae){ae||(ae=21);var ve=gr(),we=(function(We,vt){var Ct,Kt=[],Gt=1/(vt-1);for(Ct=0;Ct<1;Ct+=Gt)Kt.push(Ct);if(Kt.push(1),We[0].offset!=0){var wr={offset:0,color:We[0].color};We.unshift(wr)}if(We[We.length-1].offset!=1){var as={offset:1,color:We[We.length-1].color};We.push(as)}for(var Ps="",Wr=0,Ts=0;Ts<Kt.length;Ts++){for(Ct=Kt[Ts];Ct>We[Wr+1].offset;)Wr++;var gs=We[Wr].offset,Js=(Ct-gs)/(We[Wr+1].offset-gs),dn=We[Wr].color,wa=We[Wr+1].color;Ps+=I(Math.round((1-Js)*dn[0]+Js*wa[0]).toString(16))+I(Math.round((1-Js)*dn[1]+Js*wa[1]).toString(16))+I(Math.round((1-Js)*dn[2]+Js*wa[2]).toString(16))}return Ps.trim()})(D.colors,ae),Ae=[];Ae.push({key:"FunctionType",value:"0"}),Ae.push({key:"Domain",value:"[0.0 1.0]"}),Ae.push({key:"Size",value:"["+ae+"]"}),Ae.push({key:"BitsPerSample",value:"8"}),Ae.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ae.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),qa({data:we,additionalKeyValues:Ae,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ve}),ue("endobj"),D.objectNumber=gr(),ue("<< /ShadingType "+D.type),ue("/ColorSpace /DeviceRGB");var Ve="/Coords ["+B(parseFloat(D.coords[0]))+" "+B(parseFloat(D.coords[1]))+" ";D.type===2?Ve+=B(parseFloat(D.coords[2]))+" "+B(parseFloat(D.coords[3])):Ve+=B(parseFloat(D.coords[2]))+" "+B(parseFloat(D.coords[3]))+" "+B(parseFloat(D.coords[4]))+" "+B(parseFloat(D.coords[5])),ue(Ve+="]"),D.matrix&&ue("/Matrix ["+D.matrix.toString()+"]"),ue("/Function "+ve+" 0 R"),ue("/Extend [true true]"),ue(">>"),ue("endobj")},hl=function(D,ae){var ve=Gr(),we=gr();ae.push({resourcesOid:ve,objectOid:we}),D.objectNumber=we;var Ae=[];Ae.push({key:"Type",value:"/Pattern"}),Ae.push({key:"PatternType",value:"1"}),Ae.push({key:"PaintType",value:"1"}),Ae.push({key:"TilingType",value:"1"}),Ae.push({key:"BBox",value:"["+D.boundingBox.map(B).join(" ")+"]"}),Ae.push({key:"XStep",value:B(D.xStep)}),Ae.push({key:"YStep",value:B(D.yStep)}),Ae.push({key:"Resources",value:ve+" 0 R"}),D.matrix&&Ae.push({key:"Matrix",value:"["+D.matrix.toString()+"]"}),qa({data:D.stream,additionalKeyValues:Ae,objectId:D.objectNumber}),ue("endobj")},Su=function(D){for(var ae in D.objectNumber=gr(),ue("<<"),D)switch(ae){case"opacity":ue("/ca "+C(D[ae]));break;case"stroke-opacity":ue("/CA "+C(D[ae]))}ue(">>"),ue("endobj")},Yr=function(D){mr(D.resourcesOid,!0),ue("<<"),ue("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var ae in ue("/Font <<"),ct)ct.hasOwnProperty(ae)&&(x===!1||x===!0&&b.hasOwnProperty(ae))&&ue("/"+ae+" "+ct[ae].objectNumber+" 0 R");ue(">>")})(),(function(){if(Object.keys(Et).length>0){for(var ae in ue("/Shading <<"),Et)Et.hasOwnProperty(ae)&&Et[ae]instanceof Kc&&Et[ae].objectNumber>=0&&ue("/"+ae+" "+Et[ae].objectNumber+" 0 R");Qe.publish("putShadingPatternDict"),ue(">>")}})(),(function(ae){if(Object.keys(Et).length>0){for(var ve in ue("/Pattern <<"),Et)Et.hasOwnProperty(ve)&&Et[ve]instanceof h.TilingPattern&&Et[ve].objectNumber>=0&&Et[ve].objectNumber<ae&&ue("/"+ve+" "+Et[ve].objectNumber+" 0 R");Qe.publish("putTilingPatternDict"),ue(">>")}})(D.objectOid),(function(){if(Object.keys(qt).length>0){var ae;for(ae in ue("/ExtGState <<"),qt)qt.hasOwnProperty(ae)&&qt[ae].objectNumber>=0&&ue("/"+ae+" "+qt[ae].objectNumber+" 0 R");Qe.publish("putGStateDict"),ue(">>")}})(),(function(){for(var ae in ue("/XObject <<"),zt)zt.hasOwnProperty(ae)&&zt[ae].objectNumber>=0&&ue("/"+ae+" "+zt[ae].objectNumber+" 0 R");Qe.publish("putXobjectDict"),ue(">>")})(),ue(">>"),ue("endobj")},dd=function(D){Ut[D.fontName]=Ut[D.fontName]||{},Ut[D.fontName][D.fontStyle]=D.id},xl=function(D,ae,ve,we,Ae){var Ve={id:"F"+(Object.keys(ct).length+1).toString(10),postScriptName:D,fontName:ae,fontStyle:ve,encoding:we,isStandardFont:Ae||!1,metadata:{}};return Qe.publish("addFont",{font:Ve,instance:this}),ct[Ve.id]=Ve,dd(Ve),Ve.id},$a=h.__private__.pdfEscape=h.pdfEscape=function(D,ae){return(function(ve,we){var Ae,Ve,We,vt,Ct,Kt,Gt,wr,as;if(We=(we=we||{}).sourceEncoding||"Unicode",Ct=we.outputEncoding,(we.autoencode||Ct)&&ct[wt].metadata&&ct[wt].metadata[We]&&ct[wt].metadata[We].encoding&&(vt=ct[wt].metadata[We].encoding,!Ct&&ct[wt].encoding&&(Ct=ct[wt].encoding),!Ct&&vt.codePages&&(Ct=vt.codePages[0]),typeof Ct=="string"&&(Ct=vt[Ct]),Ct)){for(Gt=!1,Kt=[],Ae=0,Ve=ve.length;Ae<Ve;Ae++)(wr=Ct[ve.charCodeAt(Ae)])?Kt.push(String.fromCharCode(wr)):Kt.push(ve[Ae]),Kt[Ae].charCodeAt(0)>>8&&(Gt=!0);ve=Kt.join("")}for(Ae=ve.length;Gt===void 0&&Ae!==0;)ve.charCodeAt(Ae-1)>>8&&(Gt=!0),Ae--;if(!Gt)return ve;for(Kt=we.noBOM?[]:[254,255],Ae=0,Ve=ve.length;Ae<Ve;Ae++){if((as=(wr=ve.charCodeAt(Ae))>>8)>>8)throw new Error("Character at position "+Ae+" of string '"+ve+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Kt.push(as),Kt.push(wr-(as<<8))}return String.fromCharCode.apply(void 0,Kt)})(D,ae).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Yi=h.__private__.beginPage=function(D){T[++ur]=[],De[ur]={objId:0,contentsObjId:0,userUnit:Number(c),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(D[0]),topRightY:Number(D[1])}},wo(ur),ke(T[Q])},ud=function(D,ae){var ve,we,Ae;switch(r=ae||r,typeof D=="string"&&(ve=_(D.toLowerCase()),Array.isArray(ve)&&(we=ve[0],Ae=ve[1])),Array.isArray(D)&&(we=D[0]*Nt,Ae=D[1]*Nt),isNaN(we)&&(we=n[0],Ae=n[1]),(we>14400||Ae>14400)&&(Xr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),we=Math.min(14400,we),Ae=Math.min(14400,Ae)),n=[we,Ae],r.substr(0,1)){case"l":Ae>we&&(n=[Ae,we]);break;case"p":we>Ae&&(n=[Ae,we])}Yi(n),Ao(an),ue(Oo),pc!==0&&ue(pc+" J"),mc!==0&&ue(mc+" j"),Qe.publish("addPage",{pageNumber:ur})},fl=function(D){D>0&&D<=ur&&(T.splice(D,1),De.splice(D,1),ur--,Q>ur&&(Q=ur),this.setPage(Q))},wo=function(D){D>0&&D<=ur&&(Q=D)},Ba=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return T.length-1},pd=function(D,ae,ve){var we,Ae=void 0;return ve=ve||{},D=D!==void 0?D:ct[wt].fontName,ae=ae!==void 0?ae:ct[wt].fontStyle,we=D.toLowerCase(),Ut[we]!==void 0&&Ut[we][ae]!==void 0?Ae=Ut[we][ae]:Ut[D]!==void 0&&Ut[D][ae]!==void 0?Ae=Ut[D][ae]:ve.disableWarning===!1&&Xr.warn("Unable to look up font label for font '"+D+"', '"+ae+"'. Refer to getFontList() for available fonts."),Ae||ve.noFallback||(Ae=Ut.times[ae])==null&&(Ae=Ut.times.normal),Ae},sa=h.__private__.putInfo=function(){var D=gr(),ae=function(we){return we};for(var ve in m!==null&&(ae=bs.encryptor(D,0)),ue("<<"),ue("/Producer ("+$a(ae("jsPDF "+It.version))+")"),Vt)Vt.hasOwnProperty(ve)&&Vt[ve]&&ue("/"+ve.substr(0,1).toUpperCase()+ve.substr(1)+" ("+$a(ae(Vt[ve]))+")");ue("/CreationDate ("+$a(ae(ce))+")"),ue(">>"),ue("endobj")},zu=h.__private__.putCatalog=function(D){var ae=(D=D||{}).rootDictionaryObjId||Ki;switch(gr(),ue("<<"),ue("/Type /Catalog"),ue("/Pages "+ae+" 0 R"),Je||(Je="fullwidth"),Je){case"fullwidth":ue("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ue("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ue("/OpenAction [3 0 R /Fit]");break;case"original":ue("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ve=""+Je;ve.substr(ve.length-1)==="%"&&(Je=parseInt(Je)/100),typeof Je=="number"&&ue("/OpenAction [3 0 R /XYZ null null "+C(Je)+"]")}switch(Tt||(Tt="continuous"),Tt){case"continuous":ue("/PageLayout /OneColumn");break;case"single":ue("/PageLayout /SinglePage");break;case"two":case"twoleft":ue("/PageLayout /TwoColumnLeft");break;case"tworight":ue("/PageLayout /TwoColumnRight")}it&&ue("/PageMode /"+it),Qe.publish("putCatalog"),ue(">>"),ue("endobj")},Cs=h.__private__.putTrailer=function(){ue("trailer"),ue("<<"),ue("/Size "+(Y+1)),ue("/Root "+Y+" 0 R"),ue("/Info "+(Y-1)+" 0 R"),m!==null&&ue("/Encrypt "+bs.oid+" 0 R"),ue("/ID [ <"+re+"> <"+re+"> ]"),ue(">>")},md=h.__private__.putHeader=function(){ue("%PDF-"+j),ue("%")},So=h.__private__.putXRef=function(){var D="0000000000";ue("xref"),ue("0 "+(Y+1)),ue("0000000000 65535 f ");for(var ae=1;ae<=Y;ae++)typeof H[ae]=="function"?ue((D+H[ae]()).slice(-10)+" 00000 n "):H[ae]!==void 0?ue((D+H[ae]).slice(-10)+" 00000 n "):ue("0000000000 00000 n ")},sn=h.__private__.buildDocument=function(){var D;Y=0,ge=0,he=[],H=[],K=[],Ki=Gr(),zn=Gr(),ke(he),Qe.publish("buildDocument"),md(),Cn(),(function(){Qe.publish("putAdditionalObjects");for(var ve=0;ve<K.length;ve++){var we=K[ve];mr(we.objId,!0),ue(we.content),ue("endobj")}Qe.publish("postPutAdditionalObjects")})(),D=[],(function(){for(var ve in ct)ct.hasOwnProperty(ve)&&(x===!1||x===!0&&b.hasOwnProperty(ve))&&Gi(ct[ve])})(),(function(){var ve;for(ve in qt)qt.hasOwnProperty(ve)&&Su(qt[ve])})(),(function(){for(var ve in zt)zt.hasOwnProperty(ve)&&ko(zt[ve])})(),(function(ve){var we;for(we in Et)Et.hasOwnProperty(we)&&(Et[we]instanceof Kc?No(Et[we]):Et[we]instanceof iu&&hl(Et[we],ve))})(D),Qe.publish("putResources"),D.forEach(Yr),Yr({resourcesOid:zn,objectOid:Number.MAX_SAFE_INTEGER}),Qe.publish("postPutResources"),m!==null&&(bs.oid=gr(),ue("<<"),ue("/Filter /Standard"),ue("/V "+bs.v),ue("/R "+bs.r),ue("/U <"+bs.toHexString(bs.U)+">"),ue("/O <"+bs.toHexString(bs.O)+">"),ue("/P "+bs.P),ue(">>"),ue("endobj")),sa(),zu();var ae=ge;return So(),Cs(),ue("startxref"),ue(""+ae),ue("%%EOF"),ke(T[Q]),he.join(`
`)},Pn=h.__private__.getBlob=function(D){return new Blob([ne(D)],{type:"application/pdf"})},ka=h.output=h.__private__.output=(Nr=function(D,ae){switch(typeof(ae=ae||{})=="string"?ae={filename:ae}:ae.filename=ae.filename||"generated.pdf",D){case void 0:return sn();case"save":h.save(ae.filename);break;case"arraybuffer":return ne(sn());case"blob":return Pn(sn());case"bloburi":case"bloburl":if(Qt.URL!==void 0&&typeof Qt.URL.createObjectURL=="function")return Qt.URL&&Qt.URL.createObjectURL(Pn(sn()))||void 0;Xr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ve="",we=sn();try{ve=s_(we)}catch{ve=s_(unescape(encodeURIComponent(we)))}return"data:application/pdf;filename="+ae.filename+";base64,"+ve;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Qt)==="[object Window]"){var Ae="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Ve=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';ae.pdfObjectUrl&&(Ae=ae.pdfObjectUrl,Ve="");var We='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ae+'"'+Ve+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(ae)+");<\/script></body></html>",vt=Qt.open();return vt!==null&&vt.document.write(We),vt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Qt)==="[object Window]"){var Ct='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(ae.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+ae.filename+'" width="500px" height="400px" /></body></html>',Kt=Qt.open();if(Kt!==null){Kt.document.write(Ct);var Gt=this;Kt.document.documentElement.querySelector("#pdfViewer").onload=function(){Kt.document.title=ae.filename,Kt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Gt.output("bloburl"))}}return Kt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Qt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var wr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",ae)+'"></iframe></body></html>',as=Qt.open();if(as!==null&&(as.document.write(wr),as.document.title=ae.filename),as||typeof safari>"u")return as;break;case"datauri":case"dataurl":return Qt.document.location.href=this.output("datauristring",ae);default:return null}},Nr.foo=function(){try{return Nr.apply(this,arguments)}catch(ve){var D=ve.stack||"";~D.indexOf(" at ")&&(D=D.split(" at ")[1]);var ae="Error in function "+D.split(`
`)[0].split("<")[0]+": "+ve.message;if(!Qt.console)throw new Error(ae);Qt.console.error(ae,ve),Qt.alert&&alert(ae)}},Nr.foo.bar=Nr,Nr.foo),zo=function(D){return Array.isArray(st)===!0&&st.indexOf(D)>-1};switch(a){case"pt":Nt=1;break;case"mm":Nt=72/25.4;break;case"cm":Nt=72/2.54;break;case"in":Nt=72;break;case"px":Nt=zo("px_scaling")==1?.75:96/72;break;case"pc":case"em":Nt=12;break;case"ex":Nt=6;break;default:if(typeof a!="number")throw new Error("Invalid unit: "+a);Nt=a}var bs=null;J(),U();var Co=h.__private__.getPageInfo=h.getPageInfo=function(D){if(isNaN(D)||D%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:De[D].objId,pageNumber:D,pageContext:De[D]}},hd=h.__private__.getPageInfoByObjId=function(D){if(isNaN(D)||D%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var ae in De)if(De[ae].objId===D)break;return Co(ae)},cc=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:De[Q].objId,pageNumber:Q,pageContext:De[Q]}};h.addPage=function(){return ud.apply(this,arguments),this},h.setPage=function(){return wo.apply(this,arguments),ke.call(this,T[Q]),this},h.insertPage=function(D){return this.addPage(),this.movePage(Q,D),this},h.movePage=function(D,ae){var ve,we;if(D>ae){ve=T[D],we=De[D];for(var Ae=D;Ae>ae;Ae--)T[Ae]=T[Ae-1],De[Ae]=De[Ae-1];T[ae]=ve,De[ae]=we,this.setPage(ae)}else if(D<ae){ve=T[D],we=De[D];for(var Ve=D;Ve<ae;Ve++)T[Ve]=T[Ve+1],De[Ve]=De[Ve+1];T[ae]=ve,De[ae]=we,this.setPage(ae)}return this},h.deletePage=function(){return fl.apply(this,arguments),this},h.__private__.text=h.text=function(D,ae,ve,we,Ae){var Ve,We,vt,Ct,Kt,Gt,wr,as,Ps,Wr=(we=we||{}).scope||this;if(typeof D=="number"&&typeof ae=="number"&&(typeof ve=="string"||Array.isArray(ve))){var Ts=ve;ve=ae,ae=D,D=Ts}if(arguments[3]instanceof dt==0?(vt=arguments[4],Ct=arguments[5],Zr(wr=arguments[3])==="object"&&wr!==null||(typeof vt=="string"&&(Ct=vt,vt=null),typeof wr=="string"&&(Ct=wr,wr=null),typeof wr=="number"&&(vt=wr,wr=null),we={flags:wr,angle:vt,align:Ct})):(A("The transform parameter of text() with a Matrix value"),Ps=Ae),isNaN(ae)||isNaN(ve)||D==null)throw new Error("Invalid arguments passed to jsPDF.text");if(D.length===0)return Wr;var gs,Js="",dn=typeof we.lineHeightFactor=="number"?we.lineHeightFactor:Na,wa=Wr.internal.scaleFactor;function vd(Sr){return Sr=Sr.split("	").join(Array(we.TabLen||9).join(" ")),$a(Sr,wr)}function Ji(Sr){for(var Rr,ps=Sr.concat(),As=[],Ln=ps.length;Ln--;)typeof(Rr=ps.shift())=="string"?As.push(Rr):Array.isArray(Sr)&&(Rr.length===1||Rr[1]===void 0&&Rr[2]===void 0)?As.push(Rr[0]):As.push([Rr[0],Rr[1],Rr[2]]);return As}function Lo(Sr,Rr){var ps;if(typeof Sr=="string")ps=Rr(Sr)[0];else if(Array.isArray(Sr)){for(var As,Ln,gc=Sr.concat(),zl=[],Ci=gc.length;Ci--;)typeof(As=gc.shift())=="string"?zl.push(Rr(As)[0]):Array.isArray(As)&&typeof As[0]=="string"&&(Ln=Rr(As[0],As[1],As[2]),zl.push([Ln[0],Ln[1],Ln[2]]));ps=zl}return ps}var Xi=!1,To=!0;if(typeof D=="string")Xi=!0;else if(Array.isArray(D)){var Qi=D.concat();We=[];for(var Ro,na=Qi.length;na--;)(typeof(Ro=Qi.shift())!="string"||Array.isArray(Ro)&&typeof Ro[0]!="string")&&(To=!1);Xi=To}if(Xi===!1)throw new Error('Type of text must be string or Array. "'+D+'" is not recognized.');typeof D=="string"&&(D=D.match(/[\r?\n]/)?D.split(/\r\n|\r|\n/g):[D]);var Mo=Oe/Wr.internal.scaleFactor,Fo=Mo*(dn-1);switch(we.baseline){case"bottom":ve-=Fo;break;case"top":ve+=Mo-Fo;break;case"hanging":ve+=Mo-2*Fo;break;case"middle":ve+=Mo/2-Fo}if((Gt=we.maxWidth||0)>0&&(typeof D=="string"?D=Wr.splitTextToSize(D,Gt):Object.prototype.toString.call(D)==="[object Array]"&&(D=D.reduce(function(Sr,Rr){return Sr.concat(Wr.splitTextToSize(Rr,Gt))},[]))),Ve={text:D,x:ae,y:ve,options:we,mutex:{pdfEscape:$a,activeFontKey:wt,fonts:ct,activeFontSize:Oe}},Qe.publish("preProcessText",Ve),D=Ve.text,vt=(we=Ve.options).angle,Ps instanceof dt==0&&vt&&typeof vt=="number"){vt*=Math.PI/180,we.rotationDirection===0&&(vt=-vt),L===P&&(vt=-vt);var fc=Math.cos(vt),bc=Math.sin(vt);Ps=new dt(fc,bc,-bc,fc,0,0)}else vt&&vt instanceof dt&&(Ps=vt);L!==P||Ps||(Ps=Ke),(Kt=we.charSpace||Dn)!==void 0&&(Js+=B(Z(Kt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(as=we.horizontalScale)!==void 0&&(Js+=B(100*as)+` Tz
`),we.lang;var ds=-1,En=we.renderingMode!==void 0?we.renderingMode:we.stroke,Qn=Wr.internal.getCurrentPageInfo().pageContext;switch(En){case 0:case!1:case"fill":ds=0;break;case 1:case!0:case"stroke":ds=1;break;case 2:case"fillThenStroke":ds=2;break;case 3:case"invisible":ds=3;break;case 4:case"fillAndAddForClipping":ds=4;break;case 5:case"strokeAndAddPathForClipping":ds=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":ds=6;break;case 7:case"addToPathForClipping":ds=7}var yd=Qn.usedRenderingMode!==void 0?Qn.usedRenderingMode:-1;ds!==-1?Js+=ds+` Tr
`:yd!==-1&&(Js+=`0 Tr
`),ds!==-1&&(Qn.usedRenderingMode=ds),Ct=we.align||"left";var Ha,eo=Oe*dn,kl=Wr.internal.pageSize.getWidth(),Nl=ct[wt];Kt=we.charSpace||Dn,Gt=we.maxWidth||0,wr=Object.assign({autoencode:!0,noBOM:!0},we.flags);var Ni=[],un=function(Sr){return Wr.getStringUnitWidth(Sr,{font:Nl,charSpace:Kt,fontSize:Oe,doKerning:!1})*Oe/wa};if(Object.prototype.toString.call(D)==="[object Array]"){var Za;We=Ji(D),Ct!=="left"&&(Ha=We.map(un));var Wa,to=0;if(Ct==="right"){ae-=Ha[0],D=[],na=We.length;for(var ei=0;ei<na;ei++)ei===0?(Wa=Va(ae),Za=ji(ve)):(Wa=Z(to-Ha[ei]),Za=-eo),D.push([We[ei],Wa,Za]),to=Ha[ei]}else if(Ct==="center"){ae-=Ha[0]/2,D=[],na=We.length;for(var wi=0;wi<na;wi++)wi===0?(Wa=Va(ae),Za=ji(ve)):(Wa=Z((to-Ha[wi])/2),Za=-eo),D.push([We[wi],Wa,Za]),to=Ha[wi]}else if(Ct==="left"){D=[],na=We.length;for(var Si=0;Si<na;Si++)D.push(We[Si])}else if(Ct==="justify"&&Nl.encoding==="Identity-H"){D=[],na=We.length,Gt=Gt!==0?Gt:kl;for(var ti=0,vs=0;vs<na;vs++)if(Za=vs===0?ji(ve):-eo,Wa=vs===0?Va(ae):ti,vs<na-1){var Uo=Z((Gt-Ha[vs])/(We[vs].split(" ").length-1)),ri=We[vs].split(" ");D.push([ri[0]+" ",Wa,Za]),ti=0;for(var In=1;In<ri.length;In++){var qo=(un(ri[In-1]+" "+ri[In])-un(ri[In]))*wa+Uo;In==ri.length-1?D.push([ri[In],qo,0]):D.push([ri[In]+" ",qo,0]),ti-=qo}}else D.push([We[vs],Wa,Za]);D.push(["",ti,0])}else{if(Ct!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(D=[],na=We.length,Gt=Gt!==0?Gt:kl,vs=0;vs<na;vs++){Za=vs===0?ji(ve):-eo,Wa=vs===0?Va(ae):0;var $o=We[vs].split(" ").length-1,wl=$o>0?(Gt-Ha[vs])/$o:0;vs<na-1?Ni.push(B(Z(wl))):Ni.push(0),D.push([We[vs],Wa,Za])}}}(typeof we.R2L=="boolean"?we.R2L:kt)===!0&&(D=Lo(D,function(Sr,Rr,ps){return[Sr.split("").reverse().join(""),Rr,ps]})),Ve={text:D,x:ae,y:ve,options:we,mutex:{pdfEscape:$a,activeFontKey:wt,fonts:ct,activeFontSize:Oe}},Qe.publish("postProcessText",Ve),D=Ve.text,gs=Ve.mutex.isHex||!1;var Sl=ct[wt].encoding;Sl!=="WinAnsiEncoding"&&Sl!=="StandardEncoding"||(D=Lo(D,function(Sr,Rr,ps){return[vd(Sr),Rr,ps]})),We=Ji(D),D=[];for(var zi,ro,so,Bo=Array.isArray(We[0])?1:0,ao="",Vo=function(Sr,Rr,ps){var As="";return ps instanceof dt?(ps=typeof we.angle=="number"?kr(ps,new dt(1,0,0,1,Sr,Rr)):kr(new dt(1,0,0,1,Sr,Rr),ps),L===P&&(ps=kr(new dt(1,0,0,-1,0,0),ps)),As=ps.join(" ")+` Tm
`):As=B(Sr)+" "+B(Rr)+` Td
`,As},us=0;us<We.length;us++){switch(ao="",Bo){case 1:so=(gs?"<":"(")+We[us][0]+(gs?">":")"),zi=parseFloat(We[us][1]),ro=parseFloat(We[us][2]);break;case 0:so=(gs?"<":"(")+We[us]+(gs?">":")"),zi=Va(ae),ro=ji(ve)}Ni!==void 0&&Ni[us]!==void 0&&(ao=Ni[us]+` Tw
`),us===0?D.push(ao+Vo(zi,ro,Ps)+so):Bo===0?D.push(ao+so):Bo===1&&D.push(ao+Vo(zi,ro,Ps)+so)}D=Bo===0?D.join(` Tj
T* `):D.join(` Tj
`),D+=` Tj
`;var Sa=`BT
/`;return Sa+=wt+" "+Oe+` Tf
`,Sa+=B(Oe*dn)+` TL
`,Sa+=On+`
`,Sa+=Js,Sa+=D,ue(Sa+="ET"),b[wt]=!0,Wr};var Po=h.__private__.clip=h.clip=function(D){return ue(D==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return Po("evenodd")},h.__private__.discardPath=h.discardPath=function(){return ue("n"),this};var Kn=h.__private__.isValidStyle=function(D){var ae=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(D)!==-1&&(ae=!0),ae};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(D){return Kn(D)&&(p=D),this};var bl=h.__private__.getStyle=h.getStyle=function(D){var ae=p;switch(D){case"D":case"S":ae="S";break;case"F":ae="f";break;case"FD":case"DF":ae="B";break;case"f":case"f*":case"B":case"B*":ae=D}return ae},yr=h.close=function(){return ue("h"),this};h.stroke=function(){return ue("S"),this},h.fill=function(D){return vi("f",D),this},h.fillEvenOdd=function(D){return vi("f*",D),this},h.fillStroke=function(D){return vi("B",D),this},h.fillStrokeEvenOdd=function(D){return vi("B*",D),this};var vi=function(D,ae){Zr(ae)==="object"?xd(ae,D):ue(D)},gl=function(D){D===null||L===P&&D===void 0||(D=bl(D),ue(D))};function dc(D,ae,ve,we,Ae){var Ve=new iu(ae||this.boundingBox,ve||this.xStep,we||this.yStep,this.gState,Ae||this.matrix);Ve.stream=this.stream;var We=D+"$$"+this.cloneIndex+++"$$";return nt(We,Ve),Ve}var xd=function(D,ae){var ve=or[D.key],we=Et[ve];if(we instanceof Kc)ue("q"),ue(fd(ae)),we.gState&&h.setGState(we.gState),ue(D.matrix.toString()+" cm"),ue("/"+ve+" sh"),ue("Q");else if(we instanceof iu){var Ae=new dt(1,0,0,-1,0,cn());D.matrix&&(Ae=Ae.multiply(D.matrix||Ke),ve=dc.call(we,D.key,D.boundingBox,D.xStep,D.yStep,Ae).id),ue("q"),ue("/Pattern cs"),ue("/"+ve+" scn"),we.gState&&h.setGState(we.gState),ue(ae),ue("Q")}},fd=function(D){switch(D){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},vl=h.moveTo=function(D,ae){return ue(B(Z(D))+" "+B(te(ae))+" m"),this},yi=h.lineTo=function(D,ae){return ue(B(Z(D))+" "+B(te(ae))+" l"),this},An=h.curveTo=function(D,ae,ve,we,Ae,Ve){return ue([B(Z(D)),B(te(ae)),B(Z(ve)),B(te(we)),B(Z(Ae)),B(te(Ve)),"c"].join(" ")),this};h.__private__.line=h.line=function(D,ae,ve,we,Ae){if(isNaN(D)||isNaN(ae)||isNaN(ve)||isNaN(we)||!Kn(Ae))throw new Error("Invalid arguments passed to jsPDF.line");return L===k?this.lines([[ve-D,we-ae]],D,ae,[1,1],Ae||"S"):this.lines([[ve-D,we-ae]],D,ae,[1,1]).stroke()},h.__private__.lines=h.lines=function(D,ae,ve,we,Ae,Ve){var We,vt,Ct,Kt,Gt,wr,as,Ps,Wr,Ts,gs,Js;if(typeof D=="number"&&(Js=ve,ve=ae,ae=D,D=Js),we=we||[1,1],Ve=Ve||!1,isNaN(ae)||isNaN(ve)||!Array.isArray(D)||!Array.isArray(we)||!Kn(Ae)||typeof Ve!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(vl(ae,ve),We=we[0],vt=we[1],Kt=D.length,Ts=ae,gs=ve,Ct=0;Ct<Kt;Ct++)(Gt=D[Ct]).length===2?(Ts=Gt[0]*We+Ts,gs=Gt[1]*vt+gs,yi(Ts,gs)):(wr=Gt[0]*We+Ts,as=Gt[1]*vt+gs,Ps=Gt[2]*We+Ts,Wr=Gt[3]*vt+gs,Ts=Gt[4]*We+Ts,gs=Gt[5]*vt+gs,An(wr,as,Ps,Wr,Ts,gs));return Ve&&yr(),gl(Ae),this},h.path=function(D){for(var ae=0;ae<D.length;ae++){var ve=D[ae],we=ve.c;switch(ve.op){case"m":vl(we[0],we[1]);break;case"l":yi(we[0],we[1]);break;case"c":An.apply(this,we);break;case"h":yr()}}return this},h.__private__.rect=h.rect=function(D,ae,ve,we,Ae){if(isNaN(D)||isNaN(ae)||isNaN(ve)||isNaN(we)||!Kn(Ae))throw new Error("Invalid arguments passed to jsPDF.rect");return L===k&&(we=-we),ue([B(Z(D)),B(te(ae)),B(Z(ve)),B(Z(we)),"re"].join(" ")),gl(Ae),this},h.__private__.triangle=h.triangle=function(D,ae,ve,we,Ae,Ve,We){if(isNaN(D)||isNaN(ae)||isNaN(ve)||isNaN(we)||isNaN(Ae)||isNaN(Ve)||!Kn(We))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ve-D,we-ae],[Ae-ve,Ve-we],[D-Ae,ae-Ve]],D,ae,[1,1],We,!0),this},h.__private__.roundedRect=h.roundedRect=function(D,ae,ve,we,Ae,Ve,We){if(isNaN(D)||isNaN(ae)||isNaN(ve)||isNaN(we)||isNaN(Ae)||isNaN(Ve)||!Kn(We))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var vt=4/3*(Math.SQRT2-1);return Ae=Math.min(Ae,.5*ve),Ve=Math.min(Ve,.5*we),this.lines([[ve-2*Ae,0],[Ae*vt,0,Ae,Ve-Ve*vt,Ae,Ve],[0,we-2*Ve],[0,Ve*vt,-Ae*vt,Ve,-Ae,Ve],[2*Ae-ve,0],[-Ae*vt,0,-Ae,-Ve*vt,-Ae,-Ve],[0,2*Ve-we],[0,-Ve*vt,Ae*vt,-Ve,Ae,-Ve]],D+Ae,ae,[1,1],We,!0),this},h.__private__.ellipse=h.ellipse=function(D,ae,ve,we,Ae){if(isNaN(D)||isNaN(ae)||isNaN(ve)||isNaN(we)||!Kn(Ae))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Ve=4/3*(Math.SQRT2-1)*ve,We=4/3*(Math.SQRT2-1)*we;return vl(D+ve,ae),An(D+ve,ae-We,D+Ve,ae-we,D,ae-we),An(D-Ve,ae-we,D-ve,ae-We,D-ve,ae),An(D-ve,ae+We,D-Ve,ae+we,D,ae+we),An(D+Ve,ae+we,D+ve,ae+We,D+ve,ae),gl(Ae),this},h.__private__.circle=h.circle=function(D,ae,ve,we){if(isNaN(D)||isNaN(ae)||isNaN(ve)||!Kn(we))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(D,ae,ve,ve,we)},h.setFont=function(D,ae,ve){return ve&&(ae=R(ae,ve)),wt=pd(D,ae,{disableWarning:!1}),this};var Gn=h.__private__.getFont=h.getFont=function(){return ct[pd.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var D,ae,ve={};for(D in Ut)if(Ut.hasOwnProperty(D))for(ae in ve[D]=[],Ut[D])Ut[D].hasOwnProperty(ae)&&ve[D].push(ae);return ve},h.addFont=function(D,ae,ve,we,Ae){var Ve=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Ve.indexOf(arguments[3])!==-1?Ae=arguments[3]:arguments[3]&&Ve.indexOf(arguments[3])==-1&&(ve=R(ve,we)),xl.call(this,D,ae,ve,Ae=Ae||"Identity-H")};var Na,an=s.lineWidth||.200025,Ht=h.__private__.getLineWidth=h.getLineWidth=function(){return an},Ao=h.__private__.setLineWidth=h.setLineWidth=function(D){return an=D,ue(B(Z(D))+" w"),this};h.__private__.setLineDash=It.API.setLineDash=It.API.setLineDashPattern=function(D,ae){if(D=D||[],ae=ae||0,isNaN(ae)||!Array.isArray(D))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return D=D.map(function(ve){return B(Z(ve))}).join(" "),ae=B(Z(ae)),ue("["+D+"] "+ae+" d"),this};var Yn=h.__private__.getLineHeight=h.getLineHeight=function(){return Oe*Na};h.__private__.getLineHeight=h.getLineHeight=function(){return Oe*Na};var Cu=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(D){return typeof(D=D||1.15)=="number"&&(Na=D),this},bd=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return Na};Cu(s.lineHeight);var Va=h.__private__.getHorizontalCoordinate=function(D){return Z(D)},ji=h.__private__.getVerticalCoordinate=function(D){return L===P?D:De[Q].mediaBox.topRightY-De[Q].mediaBox.bottomLeftY-Z(D)},gd=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(D){return B(Va(D))},yl=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(D){return B(ji(D))},Oo=s.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return Wn(Oo)},h.__private__.setStrokeColor=h.setDrawColor=function(D,ae,ve,we){return Oo=Ys({ch1:D,ch2:ae,ch3:ve,ch4:we,pdfColorType:"draw",precision:2}),ue(Oo),this};var uc=s.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return Wn(uc)},h.__private__.setFillColor=h.setFillColor=function(D,ae,ve,we){return uc=Ys({ch1:D,ch2:ae,ch3:ve,ch4:we,pdfColorType:"fill",precision:2}),ue(uc),this};var On=s.textColor||"0 g",Jn=h.__private__.getTextColor=h.getTextColor=function(){return Wn(On)};h.__private__.setTextColor=h.setTextColor=function(D,ae,ve,we){return On=Ys({ch1:D,ch2:ae,ch3:ve,ch4:we,pdfColorType:"text",precision:3}),this};var Dn=s.charSpace,jl=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(Dn||0)};h.__private__.setCharSpace=h.setCharSpace=function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Dn=D,this};var pc=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(D){var ae=h.CapJoinStyles[D];if(ae===void 0)throw new Error("Line cap style of '"+D+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return pc=ae,ue(ae+" J"),this};var mc=0;h.__private__.setLineJoin=h.setLineJoin=function(D){var ae=h.CapJoinStyles[D];if(ae===void 0)throw new Error("Line join style of '"+D+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return mc=ae,ue(ae+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(D){if(D=D||0,isNaN(D))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ue(B(Z(D))+" M"),this},h.GState=Yh,h.setGState=function(D){(D=typeof D=="string"?qt[Lr[D]]:_i(null,D)).equals(Tr)||(ue("/"+D.id+" gs"),Tr=D)};var _i=function(D,ae){if(!D||!Lr[D]){var ve=!1;for(var we in qt)if(qt.hasOwnProperty(we)&&qt[we].equals(ae)){ve=!0;break}if(ve)ae=qt[we];else{var Ae="GS"+(Object.keys(qt).length+1).toString(10);qt[Ae]=ae,ae.id=Ae}return D&&(Lr[D]=ae.id),Qe.publish("addGState",ae),ae}};h.addGState=function(D,ae){return _i(D,ae),this},h.saveGraphicsState=function(){return ue("q"),dr.push({key:wt,size:Oe,color:On}),this},h.restoreGraphicsState=function(){ue("Q");var D=dr.pop();return wt=D.key,Oe=D.size,On=D.color,Tr=null,this},h.setCurrentTransformationMatrix=function(D){return ue(D.toString()+" cm"),this},h.comment=function(D){return ue("#"+D),this};var Xn=function(D,ae){var ve=D||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ve},set:function(Ve){isNaN(Ve)||(ve=parseFloat(Ve))}});var we=ae||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return we},set:function(Ve){isNaN(Ve)||(we=parseFloat(Ve))}});var Ae="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ae},set:function(Ve){Ae=Ve.toString()}}),this},Do=function(D,ae,ve,we){Xn.call(this,D,ae),this.type="rect";var Ae=ve||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ae},set:function(We){isNaN(We)||(Ae=parseFloat(We))}});var Ve=we||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Ve},set:function(We){isNaN(We)||(Ve=parseFloat(We))}}),this},Eo=function(){this.page=ur,this.currentPage=Q,this.pages=T.slice(0),this.pagesContext=De.slice(0),this.x=bt,this.y=jr,this.matrix=Zt,this.width=Io(Q),this.height=on(Q),this.outputDestination=_e,this.id="",this.objectNumber=-1};Eo.prototype.restore=function(){ur=this.page,Q=this.currentPage,De=this.pagesContext,T=this.pages,bt=this.x,jr=this.y,Zt=this.matrix,hc(Q,this.width),ln(Q,this.height),_e=this.outputDestination};var nn=function(D,ae,ve,we,Ae){_r.push(new Eo),ur=Q=0,T=[],bt=D,jr=ae,Zt=Ae,Yi([ve,we])};for(var ki in h.beginFormObject=function(D,ae,ve,we,Ae){return nn(D,ae,ve,we,Ae),this},h.endFormObject=function(D){return(function(ae){if(rr[ae])_r.pop().restore();else{var ve=new Eo,we="Xo"+(Object.keys(zt).length+1).toString(10);ve.id=we,rr[ae]=we,zt[we]=ve,Qe.publish("addFormObject",ve),_r.pop().restore()}})(D),this},h.doFormObject=function(D,ae){var ve=zt[rr[D]];return ue("q"),ue(ae.toString()+" cm"),ue("/"+ve.id+" Do"),ue("Q"),this},h.getFormObject=function(D){var ae=zt[rr[D]];return{x:ae.x,y:ae.y,width:ae.width,height:ae.height,matrix:ae.matrix}},h.save=function(D,ae){return D=D||"generated.pdf",(ae=ae||{}).returnPromise=ae.returnPromise||!1,ae.returnPromise===!1?(Vc(Pn(sn()),D),typeof Vc.unload=="function"&&Qt.setTimeout&&setTimeout(Vc.unload,911),this):new Promise(function(ve,we){try{var Ae=Vc(Pn(sn()),D);typeof Vc.unload=="function"&&Qt.setTimeout&&setTimeout(Vc.unload,911),ve(Ae)}catch(Ve){we(Ve.message)}})},It.API)It.API.hasOwnProperty(ki)&&(ki==="events"&&It.API.events.length?(function(D,ae){var ve,we,Ae;for(Ae=ae.length-1;Ae!==-1;Ae--)ve=ae[Ae][0],we=ae[Ae][1],D.subscribe.apply(D,[ve].concat(typeof we=="function"?[we]:we))})(Qe,It.API.events):h[ki]=It.API[ki]);function Io(D){return De[D].mediaBox.topRightX-De[D].mediaBox.bottomLeftX}function hc(D,ae){De[D].mediaBox.topRightX=ae+De[D].mediaBox.bottomLeftX}function on(D){return De[D].mediaBox.topRightY-De[D].mediaBox.bottomLeftY}function ln(D,ae){De[D].mediaBox.topRightY=ae+De[D].mediaBox.bottomLeftY}var xc=h.getPageWidth=function(D){return Io(D=D||Q)/Nt},aa=h.setPageWidth=function(D,ae){hc(D,ae*Nt)},cn=h.getPageHeight=function(D){return on(D=D||Q)/Nt},_l=h.setPageHeight=function(D,ae){ln(D,ae*Nt)};return h.internal={pdfEscape:$a,getStyle:bl,getFont:Gn,getFontSize:Be,getCharSpace:jl,getTextColor:Jn,getLineHeight:Yn,getLineHeightFactor:bd,getLineWidth:Ht,write:je,getHorizontalCoordinate:Va,getVerticalCoordinate:ji,getCoordinateString:gd,getVerticalCoordinateString:yl,collections:{},newObject:gr,newAdditionalObject:tn,newObjectDeferred:Gr,newObjectDeferredBegin:mr,getFilters:rn,putStream:qa,events:Qe,scaleFactor:Nt,pageSize:{getWidth:function(){return xc(Q)},setWidth:function(D){aa(Q,D)},getHeight:function(){return cn(Q)},setHeight:function(D){_l(Q,D)}},encryptionOptions:m,encryption:bs,getEncryptor:function(D){return m!==null?bs.encryptor(D,0):function(ae){return ae}},output:ka,getNumberOfPages:Ba,pages:T,out:ue,f2:C,f3:O,getPageInfo:Co,getPageInfoByObjId:hd,getCurrentPageInfo:cc,getPDFVersion:g,Point:Xn,Rectangle:Do,Matrix:dt,hasHotfix:zo},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return xc(Q)},set:function(D){aa(Q,D)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return cn(Q)},set:function(D){_l(Q,D)},enumerable:!0,configurable:!0}),(function(D){for(var ae=0,ve=Re.length;ae<ve;ae++){var we=xl.call(this,D[ae][0],D[ae][1],D[ae][2],Re[ae][3],!0);x===!1&&(b[we]=!0);var Ae=D[ae][0].split("-");dd({id:we,fontName:Ae[0],fontStyle:Ae[1]||""})}Qe.publish("addFonts",{fonts:ct,dictionary:Ut})}).call(h,Re),wt="F1",ud(n,r),Qe.publish("initialized"),h}au.prototype.lsbFirstWord=function(s){return String.fromCharCode(255&s,s>>8&255,s>>16&255,s>>24&255)},au.prototype.toHexString=function(s){return s.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},au.prototype.hexToBytes=function(s){for(var t=[],r=0;r<s.length;r+=2)t.push(String.fromCharCode(parseInt(s.substr(r,2),16)));return t.join("")},au.prototype.processOwnerPassword=function(s,t){return Gb(Kb(t).substr(0,5),s)},au.prototype.encryptor=function(s,t){var r=Kb(this.encryptionKey+String.fromCharCode(255&s,s>>8&255,s>>16&255,255&t,t>>8&255)).substr(0,10);return function(a){return Gb(r,a)}},Yh.prototype.equals=function(s){var t,r="id,objectNumber,equals";if(!s||Zr(s)!==Zr(this))return!1;var a=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!s.hasOwnProperty(t)||this[t]!==s[t])return!1;a++}for(t in s)s.hasOwnProperty(t)&&r.indexOf(t)<0&&a--;return a===0},It.API={events:[]},It.version="3.0.3";var Ls=It.API,Lg=1,cd=function(s){return s.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Qd=function(s){return s.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},ir=function(s){return s.toFixed(2)},Yl=function(s){return s.toFixed(5)};Ls.__acroform__={};var wn=function(s,t){s.prototype=Object.create(t.prototype),s.prototype.constructor=s},o_=function(s){return s*Lg},fo=function(s){var t=new hk,r=_t.internal.getHeight(s)||0,a=_t.internal.getWidth(s)||0;return t.BBox=[0,0,Number(ir(a)),Number(ir(r))],t},NO=Ls.__acroform__.setBit=function(s,t){if(s=s||0,t=t||0,isNaN(s)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return s|1<<t},wO=Ls.__acroform__.clearBit=function(s,t){if(s=s||0,t=t||0,isNaN(s)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return s&~(1<<t)},SO=Ls.__acroform__.getBit=function(s,t){if(isNaN(s)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return s&1<<t?1:0},Us=Ls.__acroform__.getBitForPdf=function(s,t){if(isNaN(s)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return SO(s,t-1)},qs=Ls.__acroform__.setBitForPdf=function(s,t){if(isNaN(s)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return NO(s,t-1)},$s=Ls.__acroform__.clearBitForPdf=function(s,t){if(isNaN(s)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return wO(s,t-1)},zO=Ls.__acroform__.calculateCoordinates=function(s,t){var r=t.internal.getHorizontalCoordinate,a=t.internal.getVerticalCoordinate,n=s[0],i=s[1],o=s[2],c=s[3],d={};return d.lowerLeft_X=r(n)||0,d.lowerLeft_Y=a(i+c)||0,d.upperRight_X=r(n+o)||0,d.upperRight_Y=a(i)||0,[Number(ir(d.lowerLeft_X)),Number(ir(d.lowerLeft_Y)),Number(ir(d.upperRight_X)),Number(ir(d.upperRight_Y))]},CO=function(s){if(s.appearanceStreamContent)return s.appearanceStreamContent;if(s.V||s.DV){var t=[],r=s._V||s.DV,a=Yb(s,r),n=s.scope.internal.getFont(s.fontName,s.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(s.scope.__private__.encodeColorString(s.color)),t.push("/"+n+" "+ir(a.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(a.text),t.push("ET"),t.push("Q"),t.push("EMC");var i=fo(s);return i.scope=s.scope,i.stream=t.join(`
`),i}},Yb=function(s,t){var r=s.fontSize===0?s.maxFontSize:s.fontSize,a={text:"",fontSize:""},n=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");n=s.multiline?n.map(function(C){return C.split(`
`)}):n.map(function(C){return[C]});var i=r,o=_t.internal.getHeight(s)||0;o=o<0?-o:o;var c=_t.internal.getWidth(s)||0;c=c<0?-c:c;var d=function(C,O,Z){if(C+1<n.length){var te=O+" "+n[C+1][0];return uh(te,s,Z).width<=c-4}return!1};i++;e:for(;i>0;){t="",i--;var p,m,x=uh("3",s,i).height,b=s.multiline?o-i:(o-x)/2,h=b+=2,j=0,g=0,v=0;if(i<=0){t=`(...) Tj
`,t+="% Width of Text: "+uh(t,s,i=12).width+", FieldWidth:"+c+`
`;break}for(var _="",k=0,P=0;P<n.length;P++)if(n.hasOwnProperty(P)){var L=!1;if(n[P].length!==1&&v!==n[P].length-1){if((x+2)*(k+2)+2>o)continue e;_+=n[P][v],L=!0,g=P,P--}else{_=(_+=n[P][v]+" ").substr(_.length-1)==" "?_.substr(0,_.length-1):_;var F=parseInt(P),W=d(F,_,i),R=P>=n.length-1;if(W&&!R){_+=" ",v=0;continue}if(W||R){if(R)g=F;else if(s.multiline&&(x+2)*(k+2)+2>o)continue e}else{if(!s.multiline||(x+2)*(k+2)+2>o)continue e;g=F}}for(var B="",A=j;A<=g;A++){var S=n[A];if(s.multiline){if(A===g){B+=S[v]+" ",v=(v+1)%S.length;continue}if(A===j){B+=S[S.length-1]+" ";continue}}B+=S[0]+" "}switch(B=B.substr(B.length-1)==" "?B.substr(0,B.length-1):B,m=uh(B,s,i).width,s.textAlign){case"right":p=c-m-2;break;case"center":p=(c-m)/2;break;default:p=2}t+=ir(p)+" "+ir(h)+` Td
`,t+="("+cd(B)+`) Tj
`,t+=-ir(p)+` 0 Td
`,h=-(i+2),m=0,j=L?g:g+1,k++,_=""}break}return a.text=t,a.fontSize=i,a},uh=function(s,t,r){var a=t.scope.internal.getFont(t.fontName,t.fontStyle),n=t.scope.getStringUnitWidth(s,{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:n}},PO={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},AO=function(s,t){var r={type:"reference",object:s};t.internal.getPageInfo(s.page).pageContext.annotations.find(function(a){return a.type===r.type&&a.object===r.object})===void 0&&t.internal.getPageInfo(s.page).pageContext.annotations.push(r)},OO=function(s,t){if(t.scope=s,s.internal!==void 0&&(s.internal.acroformPlugin===void 0||s.internal.acroformPlugin.isInitialized===!1)){if(Zi.FieldNum=0,s.internal.acroformPlugin=JSON.parse(JSON.stringify(PO)),s.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Lg=s.internal.scaleFactor,s.internal.acroformPlugin.acroFormDictionaryRoot=new xk,s.internal.acroformPlugin.acroFormDictionaryRoot.scope=s,s.internal.acroformPlugin.acroFormDictionaryRoot._eventID=s.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(s)}),s.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var a=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var n in a)if(a.hasOwnProperty(n)){var i=a[n];i.objId=void 0,i.hasAnnotation&&AO(i,r)}})(s)}),s.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(s)}),s.internal.events.subscribe("postPutPages",function(r){(function(a,n){var i=!a;for(var o in a||(n.internal.newObjectDeferredBegin(n.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),n.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),a=a||n.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(a.hasOwnProperty(o)){var c=a[o],d=[],p=c.Rect;if(c.Rect&&(c.Rect=zO(c.Rect,n)),n.internal.newObjectDeferredBegin(c.objId,!0),c.DA=_t.createDefaultAppearanceStream(c),Zr(c)==="object"&&typeof c.getKeyValueListForStream=="function"&&(d=c.getKeyValueListForStream()),c.Rect=p,c.hasAppearanceStream&&!c.appearanceStreamContent){var m=CO(c);d.push({key:"AP",value:"<</N "+m+">>"}),n.internal.acroformPlugin.xForms.push(m)}if(c.appearanceStreamContent){var x="";for(var b in c.appearanceStreamContent)if(c.appearanceStreamContent.hasOwnProperty(b)){var h=c.appearanceStreamContent[b];if(x+="/"+b+" ",x+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var o in h)if(h.hasOwnProperty(o)){var j=h[o];typeof j=="function"&&(j=j.call(n,c)),x+="/"+o+" "+j+" ",n.internal.acroformPlugin.xForms.indexOf(j)>=0||n.internal.acroformPlugin.xForms.push(j)}}else typeof(j=h)=="function"&&(j=j.call(n,c)),x+="/"+o+" "+j,n.internal.acroformPlugin.xForms.indexOf(j)>=0||n.internal.acroformPlugin.xForms.push(j);x+=">>"}d.push({key:"AP",value:`<<
`+x+">>"})}n.internal.putStream({additionalKeyValues:d,objectId:c.objId}),n.internal.out("endobj")}i&&(function(g,v){for(var _ in g)if(g.hasOwnProperty(_)){var k=_,P=g[_];v.internal.newObjectDeferredBegin(P.objId,!0),Zr(P)==="object"&&typeof P.putStream=="function"&&P.putStream(),delete g[k]}})(n.internal.acroformPlugin.xForms,n)})(r,s)}),s.internal.acroformPlugin.isInitialized=!0}},mk=Ls.__acroform__.arrayToPdfArray=function(s,t,r){var a=function(o){return o};if(Array.isArray(s)){for(var n="[",i=0;i<s.length;i++)switch(i!==0&&(n+=" "),Zr(s[i])){case"boolean":case"number":case"object":n+=s[i].toString();break;case"string":s[i].substr(0,1)!=="/"?(t!==void 0&&r&&(a=r.internal.getEncryptor(t)),n+="("+cd(a(s[i].toString()))+")"):n+=s[i].toString()}return n+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},rb=function(s,t,r){var a=function(n){return n};return t!==void 0&&r&&(a=r.internal.getEncryptor(t)),(s=s||"").toString(),"("+cd(a(s))+")"},yo=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(s){this._objId=s}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};yo.prototype.toString=function(){return this.objId+" 0 R"},yo.prototype.putStream=function(){var s=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:s,objectId:this.objId}),this.scope.internal.out("endobj")},yo.prototype.getKeyValueListForStream=function(){var s=[],t=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var a=t[r],n=this[a];n&&(Array.isArray(n)?s.push({key:a,value:mk(n,this.objId,this.scope)}):n instanceof yo?(n.scope=this.scope,s.push({key:a,value:n.objId+" 0 R"})):typeof n!="function"&&s.push({key:a,value:n}))}return s};var hk=function(){yo.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var s,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){s=r.trim()},get:function(){return s||null}})};wn(hk,yo);var xk=function(){yo.call(this);var s,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(s){var r=function(a){return a};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+cd(r(s))+")"}},set:function(r){s=r}})};wn(xk,yo);var Zi=function s(){yo.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(_){if(isNaN(_))throw new Error('Invalid value "'+_+'" for attribute F supplied.');t=_}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Us(t,3)},set:function(_){_?this.F=qs(t,3):this.F=$s(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(_){if(isNaN(_))throw new Error('Invalid value "'+_+'" for attribute Ff supplied.');r=_}});var a=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(a.length!==0)return a},set:function(_){a=_!==void 0?_:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[0])?0:a[0]},set:function(_){a[0]=_}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[1])?0:a[1]},set:function(_){a[1]=_}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[2])?0:a[2]},set:function(_){a[2]=_}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[3])?0:a[3]},set:function(_){a[3]=_}});var n="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return n},set:function(_){switch(_){case"/Btn":case"/Tx":case"/Ch":case"/Sig":n=_;break;default:throw new Error('Invalid value "'+_+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof Jh)return;i="FieldObject"+s.FieldNum++}var _=function(k){return k};return this.scope&&(_=this.scope.internal.getEncryptor(this.objId)),"("+cd(_(i))+")"},set:function(_){i=_.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(_){i=_}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(_){o=_}});var c="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return c},set:function(_){c=_}});var d=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return d},set:function(_){d=_}});var p=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return p===void 0?50/Lg:p},set:function(_){p=_}});var m="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return m},set:function(_){m=_}});var x="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!x||this instanceof Jh||this instanceof Qc))return rb(x,this.objId,this.scope)},set:function(_){_=_.toString(),x=_}});var b=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(b)return this instanceof pa==0?rb(b,this.objId,this.scope):b},set:function(_){_=_.toString(),b=this instanceof pa==0?_.substr(0,1)==="("?Qd(_.substr(1,_.length-2)):Qd(_):_}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof pa==1?Qd(b.substr(1,b.length-1)):b},set:function(_){_=_.toString(),b=this instanceof pa==1?"/"+_:_}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(_){this.V=_}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof pa==0?rb(h,this.objId,this.scope):h},set:function(_){_=_.toString(),h=this instanceof pa==0?_.substr(0,1)==="("?Qd(_.substr(1,_.length-2)):Qd(_):_}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof pa==1?Qd(h.substr(1,h.length-1)):h},set:function(_){_=_.toString(),h=this instanceof pa==1?"/"+_:_}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var j,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(_){_=!!_,g=_}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(j)return j},set:function(_){j=_}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Us(this.Ff,1)},set:function(_){_?this.Ff=qs(this.Ff,1):this.Ff=$s(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Us(this.Ff,2)},set:function(_){_?this.Ff=qs(this.Ff,2):this.Ff=$s(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Us(this.Ff,3)},set:function(_){_?this.Ff=qs(this.Ff,3):this.Ff=$s(this.Ff,3)}});var v=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(v!==null)return v},set:function(_){if([0,1,2].indexOf(_)===-1)throw new Error('Invalid value "'+_+'" for attribute Q supplied.');v=_}}),Object.defineProperty(this,"textAlign",{get:function(){var _;switch(v){case 0:default:_="left";break;case 1:_="center";break;case 2:_="right"}return _},configurable:!0,enumerable:!0,set:function(_){switch(_){case"right":case 2:v=2;break;case"center":case 1:v=1;break;default:v=0}}})};wn(Zi,yo);var uu=function(){Zi.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var s=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return s},set:function(r){s=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return s},set:function(r){s=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return mk(t,this.objId,this.scope)},set:function(r){var a,n;n=[],typeof(a=r)=="string"&&(n=(function(i,o,c){c||(c=1);for(var d,p=[];d=o.exec(i);)p.push(d[c]);return p})(a,/\((.*?)\)/g)),t=n}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,a){for(a=a||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),a!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Us(this.Ff,18)},set:function(r){r?this.Ff=qs(this.Ff,18):this.Ff=$s(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Us(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=qs(this.Ff,19):this.Ff=$s(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Us(this.Ff,20)},set:function(r){r?(this.Ff=qs(this.Ff,20),t.sort()):this.Ff=$s(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Us(this.Ff,22)},set:function(r){r?this.Ff=qs(this.Ff,22):this.Ff=$s(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Us(this.Ff,23)},set:function(r){r?this.Ff=qs(this.Ff,23):this.Ff=$s(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Us(this.Ff,27)},set:function(r){r?this.Ff=qs(this.Ff,27):this.Ff=$s(this.Ff,27)}}),this.hasAppearanceStream=!1};wn(uu,Zi);var pu=function(){uu.call(this),this.fontName="helvetica",this.combo=!1};wn(pu,uu);var mu=function(){pu.call(this),this.combo=!0};wn(mu,pu);var yh=function(){mu.call(this),this.edit=!0};wn(yh,mu);var pa=function(){Zi.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Us(this.Ff,15)},set:function(r){r?this.Ff=qs(this.Ff,15):this.Ff=$s(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Us(this.Ff,16)},set:function(r){r?this.Ff=qs(this.Ff,16):this.Ff=$s(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Us(this.Ff,17)},set:function(r){r?this.Ff=qs(this.Ff,17):this.Ff=$s(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Us(this.Ff,26)},set:function(r){r?this.Ff=qs(this.Ff,26):this.Ff=$s(this.Ff,26)}});var s,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(i){return i};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var a,n=[];for(a in n.push("<<"),t)n.push("/"+a+" ("+cd(r(t[a]))+")");return n.push(">>"),n.join(`
`)}},set:function(r){Zr(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return s},set:function(r){s=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return s.substr(1,s.length-1)},set:function(r){s="/"+r}})};wn(pa,Zi);var jh=function(){pa.call(this),this.pushButton=!0};wn(jh,pa);var hu=function(){pa.call(this),this.radio=!0,this.pushButton=!1;var s=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return s},set:function(t){s=t!==void 0?t:[]}})};wn(hu,pa);var Jh=function(){var s,t;Zi.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return s},set:function(n){s=n}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(n){t=n}});var r,a={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(c){return c};this.scope&&(n=this.scope.internal.getEncryptor(this.objId));var i,o=[];for(i in o.push("<<"),a)o.push("/"+i+" ("+cd(n(a[i]))+")");return o.push(">>"),o.join(`
`)},set:function(n){Zr(n)==="object"&&(a=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return a.CA||""},set:function(n){typeof n=="string"&&(a.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(n){r=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(n){r="/"+n}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=_t.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};wn(Jh,Zi),hu.prototype.setAppearance=function(s){if(!("createAppearanceStream"in s)||!("getCA"in s))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=s.createAppearanceStream(r.optionName),r.caption=s.getCA()}},hu.prototype.createOption=function(s){var t=new Jh;return t.Parent=this,t.optionName=s,this.Kids.push(t),DO.call(this.scope,t),t};var _h=function(){pa.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=_t.CheckBox.createAppearanceStream()};wn(_h,pa);var Qc=function(){Zi.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Us(this.Ff,13)},set:function(t){t?this.Ff=qs(this.Ff,13):this.Ff=$s(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Us(this.Ff,21)},set:function(t){t?this.Ff=qs(this.Ff,21):this.Ff=$s(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Us(this.Ff,23)},set:function(t){t?this.Ff=qs(this.Ff,23):this.Ff=$s(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Us(this.Ff,24)},set:function(t){t?this.Ff=qs(this.Ff,24):this.Ff=$s(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Us(this.Ff,25)},set:function(t){t?this.Ff=qs(this.Ff,25):this.Ff=$s(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Us(this.Ff,26)},set:function(t){t?this.Ff=qs(this.Ff,26):this.Ff=$s(this.Ff,26)}});var s=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return s},set:function(t){s=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return s},set:function(t){Number.isInteger(t)&&(s=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};wn(Qc,Zi);var kh=function(){Qc.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Us(this.Ff,14)},set:function(s){s?this.Ff=qs(this.Ff,14):this.Ff=$s(this.Ff,14)}}),this.password=!0};wn(kh,Qc);var _t={CheckBox:{createAppearanceStream:function(){return{N:{On:_t.CheckBox.YesNormal},D:{On:_t.CheckBox.YesPushDown,Off:_t.CheckBox.OffPushDown}}},YesPushDown:function(s){var t=fo(s);t.scope=s.scope;var r=[],a=s.scope.internal.getFont(s.fontName,s.fontStyle).id,n=s.scope.__private__.encodeColorString(s.color),i=Yb(s,s.caption);return r.push("0.749023 g"),r.push("0 0 "+ir(_t.internal.getWidth(s))+" "+ir(_t.internal.getHeight(s))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+a+" "+ir(i.fontSize)+" Tf "+n),r.push("BT"),r.push(i.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(s){var t=fo(s);t.scope=s.scope;var r=s.scope.internal.getFont(s.fontName,s.fontStyle).id,a=s.scope.__private__.encodeColorString(s.color),n=[],i=_t.internal.getHeight(s),o=_t.internal.getWidth(s),c=Yb(s,s.caption);return n.push("1 g"),n.push("0 0 "+ir(o)+" "+ir(i)+" re"),n.push("f"),n.push("q"),n.push("0 0 1 rg"),n.push("0 0 "+ir(o-1)+" "+ir(i-1)+" re"),n.push("W"),n.push("n"),n.push("0 g"),n.push("BT"),n.push("/"+r+" "+ir(c.fontSize)+" Tf "+a),n.push(c.text),n.push("ET"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(s){var t=fo(s);t.scope=s.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+ir(_t.internal.getWidth(s))+" "+ir(_t.internal.getHeight(s))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(s){var t={D:{Off:_t.RadioButton.Circle.OffPushDown},N:{}};return t.N[s]=_t.RadioButton.Circle.YesNormal,t.D[s]=_t.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(s){var t=fo(s);t.scope=s.scope;var r=[],a=_t.internal.getWidth(s)<=_t.internal.getHeight(s)?_t.internal.getWidth(s)/4:_t.internal.getHeight(s)/4;a=Number((.9*a).toFixed(5));var n=_t.internal.Bezier_C,i=Number((a*n).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Yl(_t.internal.getWidth(s)/2)+" "+Yl(_t.internal.getHeight(s)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(s){var t=fo(s);t.scope=s.scope;var r=[],a=_t.internal.getWidth(s)<=_t.internal.getHeight(s)?_t.internal.getWidth(s)/4:_t.internal.getHeight(s)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),i=Number((n*_t.internal.Bezier_C).toFixed(5)),o=Number((a*_t.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Yl(_t.internal.getWidth(s)/2)+" "+Yl(_t.internal.getHeight(s)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Yl(_t.internal.getWidth(s)/2)+" "+Yl(_t.internal.getHeight(s)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+o+" "+o+" "+a+" 0 "+a+" c"),r.push("-"+o+" "+a+" -"+a+" "+o+" -"+a+" 0 c"),r.push("-"+a+" -"+o+" -"+o+" -"+a+" 0 -"+a+" c"),r.push(o+" -"+a+" "+a+" -"+o+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(s){var t=fo(s);t.scope=s.scope;var r=[],a=_t.internal.getWidth(s)<=_t.internal.getHeight(s)?_t.internal.getWidth(s)/4:_t.internal.getHeight(s)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),i=Number((n*_t.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Yl(_t.internal.getWidth(s)/2)+" "+Yl(_t.internal.getHeight(s)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(s){var t={D:{Off:_t.RadioButton.Cross.OffPushDown},N:{}};return t.N[s]=_t.RadioButton.Cross.YesNormal,t.D[s]=_t.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(s){var t=fo(s);t.scope=s.scope;var r=[],a=_t.internal.calculateCross(s);return r.push("q"),r.push("1 1 "+ir(_t.internal.getWidth(s)-2)+" "+ir(_t.internal.getHeight(s)-2)+" re"),r.push("W"),r.push("n"),r.push(ir(a.x1.x)+" "+ir(a.x1.y)+" m"),r.push(ir(a.x2.x)+" "+ir(a.x2.y)+" l"),r.push(ir(a.x4.x)+" "+ir(a.x4.y)+" m"),r.push(ir(a.x3.x)+" "+ir(a.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(s){var t=fo(s);t.scope=s.scope;var r=_t.internal.calculateCross(s),a=[];return a.push("0.749023 g"),a.push("0 0 "+ir(_t.internal.getWidth(s))+" "+ir(_t.internal.getHeight(s))+" re"),a.push("f"),a.push("q"),a.push("1 1 "+ir(_t.internal.getWidth(s)-2)+" "+ir(_t.internal.getHeight(s)-2)+" re"),a.push("W"),a.push("n"),a.push(ir(r.x1.x)+" "+ir(r.x1.y)+" m"),a.push(ir(r.x2.x)+" "+ir(r.x2.y)+" l"),a.push(ir(r.x4.x)+" "+ir(r.x4.y)+" m"),a.push(ir(r.x3.x)+" "+ir(r.x3.y)+" l"),a.push("s"),a.push("Q"),t.stream=a.join(`
`),t},OffPushDown:function(s){var t=fo(s);t.scope=s.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+ir(_t.internal.getWidth(s))+" "+ir(_t.internal.getHeight(s))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(s){var t=s.scope.internal.getFont(s.fontName,s.fontStyle).id,r=s.scope.__private__.encodeColorString(s.color);return"/"+t+" "+s.fontSize+" Tf "+r}};_t.internal={Bezier_C:.551915024494,calculateCross:function(s){var t=_t.internal.getWidth(s),r=_t.internal.getHeight(s),a=Math.min(t,r);return{x1:{x:(t-a)/2,y:(r-a)/2+a},x2:{x:(t-a)/2+a,y:(r-a)/2},x3:{x:(t-a)/2,y:(r-a)/2},x4:{x:(t-a)/2+a,y:(r-a)/2+a}}}},_t.internal.getWidth=function(s){var t=0;return Zr(s)==="object"&&(t=o_(s.Rect[2])),t},_t.internal.getHeight=function(s){var t=0;return Zr(s)==="object"&&(t=o_(s.Rect[3])),t};var DO=Ls.addField=function(s){if(OO(this,s),!(s instanceof Zi))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=s).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),s.page=s.scope.internal.getCurrentPageInfo().pageNumber,this};Ls.AcroFormChoiceField=uu,Ls.AcroFormListBox=pu,Ls.AcroFormComboBox=mu,Ls.AcroFormEditBox=yh,Ls.AcroFormButton=pa,Ls.AcroFormPushButton=jh,Ls.AcroFormRadioButton=hu,Ls.AcroFormCheckBox=_h,Ls.AcroFormTextField=Qc,Ls.AcroFormPasswordField=kh,Ls.AcroFormAppearance=_t,Ls.AcroForm={ChoiceField:uu,ListBox:pu,ComboBox:mu,EditBox:yh,Button:pa,PushButton:jh,RadioButton:hu,CheckBox:_h,TextField:Qc,PasswordField:kh,Appearance:_t},It.AcroForm={ChoiceField:uu,ListBox:pu,ComboBox:mu,EditBox:yh,Button:pa,PushButton:jh,RadioButton:hu,CheckBox:_h,TextField:Qc,PasswordField:kh,Appearance:_t};It.AcroForm;function fk(s){return s.reduce(function(t,r,a){return t[r]=a,t},{})}(function(s){var t="addImage_";s.__addimage__={};var r="UNKNOWN",a={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=s.__addimage__.getImageFileTypeByImageData=function(C,O){var Z,te,ce,re,X,U=r;if((O=O||r)==="RGBA"||C.data!==void 0&&C.data instanceof Uint8ClampedArray&&"height"in C&&"width"in C)return"RGBA";if(W(C))for(X in a)for(ce=a[X],Z=0;Z<ce.length;Z+=1){for(re=!0,te=0;te<ce[Z].length;te+=1)if(ce[Z][te]!==void 0&&ce[Z][te]!==C[te]){re=!1;break}if(re===!0){U=X;break}}else for(X in a)for(ce=a[X],Z=0;Z<ce.length;Z+=1){for(re=!0,te=0;te<ce[Z].length;te+=1)if(ce[Z][te]!==void 0&&ce[Z][te]!==C.charCodeAt(te)){re=!1;break}if(re===!0){U=X;break}}return U===r&&O!==r&&(U=O),U},i=function C(O){for(var Z=this.internal.write,te=this.internal.putStream,ce=(0,this.internal.getFilters)();ce.indexOf("FlateEncode")!==-1;)ce.splice(ce.indexOf("FlateEncode"),1);O.objectId=this.internal.newObject();var re=[];if(re.push({key:"Type",value:"/XObject"}),re.push({key:"Subtype",value:"/Image"}),re.push({key:"Width",value:O.width}),re.push({key:"Height",value:O.height}),O.colorSpace===_.INDEXED?re.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(O.palette.length/3-1)+" "+("sMask"in O&&O.sMask!==void 0?O.objectId+2:O.objectId+1)+" 0 R]"}):(re.push({key:"ColorSpace",value:"/"+O.colorSpace}),O.colorSpace===_.DEVICE_CMYK&&re.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),re.push({key:"BitsPerComponent",value:O.bitsPerComponent}),"decodeParameters"in O&&O.decodeParameters!==void 0&&re.push({key:"DecodeParms",value:"<<"+O.decodeParameters+">>"}),"transparency"in O&&Array.isArray(O.transparency)&&O.transparency.length>0){for(var X="",U=0,oe=O.transparency.length;U<oe;U++)X+=O.transparency[U]+" "+O.transparency[U]+" ";re.push({key:"Mask",value:"["+X+"]"})}O.sMask!==void 0&&re.push({key:"SMask",value:O.objectId+1+" 0 R"});var xe=O.filter!==void 0?["/"+O.filter]:void 0;if(te({data:O.data,additionalKeyValues:re,alreadyAppliedFilters:xe,objectId:O.objectId}),Z("endobj"),"sMask"in O&&O.sMask!==void 0){var J,$=(J=O.sMaskBitsPerComponent)!==null&&J!==void 0?J:O.bitsPerComponent,Q={width:O.width,height:O.height,colorSpace:"DeviceGray",bitsPerComponent:$,data:O.sMask};"filter"in O&&(Q.decodeParameters="/Predictor ".concat(O.predictor," /Colors 1 /BitsPerComponent ").concat($," /Columns ").concat(O.width),Q.filter=O.filter),C.call(this,Q)}if(O.colorSpace===_.INDEXED){var q=this.internal.newObject();te({data:B(new Uint8Array(O.palette)),objectId:q}),Z("endobj")}},o=function(){var C=this.internal.collections[t+"images"];for(var O in C)i.call(this,C[O])},c=function(){var C,O=this.internal.collections[t+"images"],Z=this.internal.write;for(var te in O)Z("/I"+(C=O[te]).index,C.objectId,"0","R")},d=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",c))},p=function(){var C=this.internal.collections[t+"images"];return d.call(this),C},m=function(){return Object.keys(this.internal.collections[t+"images"]).length},x=function(C){return typeof s["process"+C.toUpperCase()]=="function"},b=function(C){return Zr(C)==="object"&&C.nodeType===1},h=function(C,O){if(C.nodeName==="IMG"&&C.hasAttribute("src")){var Z=""+C.getAttribute("src");if(Z.indexOf("data:image/")===0)return vh(unescape(Z).split("base64,").pop());var te=s.loadFile(Z,!0);if(te!==void 0)return te}if(C.nodeName==="CANVAS"){if(C.width===0||C.height===0)throw new Error("Given canvas must have data. Canvas width: "+C.width+", height: "+C.height);var ce;switch(O){case"PNG":ce="image/png";break;case"WEBP":ce="image/webp";break;default:ce="image/jpeg"}return vh(C.toDataURL(ce,1).split("base64,").pop())}},j=function(C){var O=this.internal.collections[t+"images"];if(O){for(var Z in O)if(C===O[Z].alias)return O[Z]}},g=function(C,O,Z){return C||O||(C=-96,O=-96),C<0&&(C=-1*Z.width*72/C/this.internal.scaleFactor),O<0&&(O=-1*Z.height*72/O/this.internal.scaleFactor),C===0&&(C=O*Z.width/Z.height),O===0&&(O=C*Z.height/Z.width),[C,O]},v=function(C,O,Z,te,ce,re){var X=g.call(this,Z,te,ce),U=this.internal.getCoordinateString,oe=this.internal.getVerticalCoordinateString,xe=p.call(this);if(Z=X[0],te=X[1],xe[ce.index]=ce,re){re*=Math.PI/180;var J=Math.cos(re),$=Math.sin(re),Q=function(I){return I.toFixed(4)},q=[Q(J),Q($),Q(-1*$),Q(J),0,0,"cm"]}this.internal.write("q"),re?(this.internal.write([1,"0","0",1,U(C),oe(O+te),"cm"].join(" ")),this.internal.write(q.join(" ")),this.internal.write([U(Z),"0","0",U(te),"0","0","cm"].join(" "))):this.internal.write([U(Z),"0","0",U(te),U(C),oe(O+te),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ce.index+" Do"),this.internal.write("Q")},_=s.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};s.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var k=s.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},P=s.__addimage__.sHashCode=function(C){var O,Z,te=0;if(typeof C=="string")for(Z=C.length,O=0;O<Z;O++)te=(te<<5)-te+C.charCodeAt(O),te|=0;else if(W(C))for(Z=C.byteLength/2,O=0;O<Z;O++)te=(te<<5)-te+C[O],te|=0;return te},L=s.__addimage__.validateStringAsBase64=function(C){(C=C||"").toString().trim();var O=!0;return C.length===0&&(O=!1),C.length%4!=0&&(O=!1),/^[A-Za-z0-9+/]+$/.test(C.substr(0,C.length-2))===!1&&(O=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(C.substr(-2))===!1&&(O=!1),O},F=s.__addimage__.extractImageFromDataUrl=function(C){if(C==null||!(C=C.trim()).startsWith("data:"))return null;var O=C.indexOf(",");return O<0?null:C.substring(0,O).trim().endsWith("base64")?C.substring(O+1):null};s.__addimage__.isArrayBuffer=function(C){return C instanceof ArrayBuffer};var W=s.__addimage__.isArrayBufferView=function(C){return C instanceof Int8Array||C instanceof Uint8Array||C instanceof Uint8ClampedArray||C instanceof Int16Array||C instanceof Uint16Array||C instanceof Int32Array||C instanceof Uint32Array||C instanceof Float32Array||C instanceof Float64Array},R=s.__addimage__.binaryStringToUint8Array=function(C){for(var O=C.length,Z=new Uint8Array(O),te=0;te<O;te++)Z[te]=C.charCodeAt(te);return Z},B=s.__addimage__.arrayBufferToBinaryString=function(C){for(var O="",Z=W(C)?C:new Uint8Array(C),te=0;te<Z.length;te+=8192)O+=String.fromCharCode.apply(null,Z.subarray(te,te+8192));return O};s.addImage=function(){var C,O,Z,te,ce,re,X,U,oe;if(typeof arguments[1]=="number"?(O=r,Z=arguments[1],te=arguments[2],ce=arguments[3],re=arguments[4],X=arguments[5],U=arguments[6],oe=arguments[7]):(O=arguments[1],Z=arguments[2],te=arguments[3],ce=arguments[4],re=arguments[5],X=arguments[6],U=arguments[7],oe=arguments[8]),Zr(C=arguments[0])==="object"&&!b(C)&&"imageData"in C){var xe=C;C=xe.imageData,O=xe.format||O||r,Z=xe.x||Z||0,te=xe.y||te||0,ce=xe.w||xe.width||ce,re=xe.h||xe.height||re,X=xe.alias||X,U=xe.compression||U,oe=xe.rotation||xe.angle||oe}var J=this.internal.getFilters();if(U===void 0&&J.indexOf("FlateEncode")!==-1&&(U="SLOW"),isNaN(Z)||isNaN(te))throw new Error("Invalid coordinates passed to jsPDF.addImage");d.call(this);var $=A.call(this,C,O,X,U);return v.call(this,Z,te,ce,re,$,oe),this};var A=function(C,O,Z,te){var ce,re,X;if(typeof C=="string"&&n(C)===r){C=unescape(C);var U=S(C,!1);(U!==""||(U=s.loadFile(C,!0))!==void 0)&&(C=U)}if(b(C)&&(C=h(C,O)),O=n(C,O),!x(O))throw new Error("addImage does not support files of type '"+O+"', please ensure that a plugin for '"+O+"' support is added.");if(((X=Z)==null||X.length===0)&&(Z=(function(oe){return typeof oe=="string"||W(oe)?P(oe):W(oe.data)?P(oe.data):null})(C)),(ce=j.call(this,Z))||(C instanceof Uint8Array||O==="RGBA"||(re=C,C=R(C)),ce=this["process"+O.toUpperCase()](C,m.call(this),Z,(function(oe){return oe&&typeof oe=="string"&&(oe=oe.toUpperCase()),oe in s.image_compression?oe:k.NONE})(te),re)),!ce)throw new Error("An unknown error occurred whilst processing the image.");return ce},S=s.__addimage__.convertBase64ToBinaryString=function(C,O){O=typeof O!="boolean"||O;var Z,te="";if(typeof C=="string"){var ce;Z=(ce=F(C))!==null&&ce!==void 0?ce:C;try{te=vh(Z)}catch(re){if(O)throw L(Z)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+re.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return te};s.getImageProperties=function(C){var O,Z,te="";if(b(C)&&(C=h(C)),typeof C=="string"&&n(C)===r&&((te=S(C,!1))===""&&(te=s.loadFile(C)||""),C=te),Z=n(C),!x(Z))throw new Error("addImage does not support files of type '"+Z+"', please ensure that a plugin for '"+Z+"' support is added.");if(C instanceof Uint8Array||(C=R(C)),!(O=this["process"+Z.toUpperCase()](C)))throw new Error("An unknown error occurred whilst processing the image");return O.fileType=Z,O}})(It.API),(function(s){var t=function(r){if(r!==void 0&&r!="")return!0};It.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),s.events.push(["putPage",function(r){for(var a,n,i,o=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString,d=this.internal.getPageInfoByObjId(r.objId),p=r.pageContext.annotations,m=!1,x=0;x<p.length&&!m;x++)switch((a=p[x]).type){case"link":(t(a.options.url)||t(a.options.pageNumber))&&(m=!0);break;case"reference":case"text":case"freetext":m=!0}if(m!=0){this.internal.write("/Annots [");for(var b=0;b<p.length;b++){a=p[b];var h=this.internal.pdfEscape,j=this.internal.getEncryptor(r.objId);switch(a.type){case"reference":this.internal.write(" "+a.object.objId+" 0 R ");break;case"text":var g=this.internal.newAdditionalObject(),v=this.internal.newAdditionalObject(),_=this.internal.getEncryptor(g.objId),k=a.title||"Note";i="<</Type /Annot /Subtype /Text "+(n="/Rect ["+o(a.bounds.x)+" "+c(a.bounds.y+a.bounds.h)+" "+o(a.bounds.x+a.bounds.w)+" "+c(a.bounds.y)+"] ")+"/Contents ("+h(_(a.contents))+")",i+=" /Popup "+v.objId+" 0 R",i+=" /P "+d.objId+" 0 R",i+=" /T ("+h(_(k))+") >>",g.content=i;var P=g.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(n="/Rect ["+o(a.bounds.x+30)+" "+c(a.bounds.y+a.bounds.h)+" "+o(a.bounds.x+a.bounds.w+30)+" "+c(a.bounds.y)+"] ")+" /Parent "+P,a.open&&(i+=" /Open true"),i+=" >>",v.content=i,this.internal.write(g.objId,"0 R",v.objId,"0 R");break;case"freetext":n="/Rect ["+o(a.bounds.x)+" "+c(a.bounds.y)+" "+o(a.bounds.x+a.bounds.w)+" "+c(a.bounds.y+a.bounds.h)+"] ";var L=a.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+n+"/Contents ("+h(j(a.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+L+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(a.options.name){var F=this.annotations._nameMap[a.options.name];a.options.pageNumber=F.page,a.options.top=F.y}else a.options.top||(a.options.top=0);if(n="/Rect ["+a.finalBounds.x+" "+a.finalBounds.y+" "+a.finalBounds.w+" "+a.finalBounds.h+"] ",i="",a.options.url)i="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /A <</S /URI /URI ("+h(j(a.options.url))+") >>";else if(a.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(a.options.pageNumber).objId+" 0 R",a.options.magFactor=a.options.magFactor||"XYZ",a.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+a.options.top+"]";break;case"FitV":a.options.left=a.options.left||0,i+=" /FitV "+a.options.left+"]";break;default:var W=c(a.options.top);a.options.left=a.options.left||0,a.options.zoom===void 0&&(a.options.zoom=0),i+=" /XYZ "+a.options.left+" "+W+" "+a.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),s.createAnnotation=function(r){var a=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":a.pageContext.annotations.push(r)}},s.link=function(r,a,n,i,o){var c=this.internal.getCurrentPageInfo(),d=this.internal.getCoordinateString,p=this.internal.getVerticalCoordinateString;c.pageContext.annotations.push({finalBounds:{x:d(r),y:p(a),w:d(r+n),h:p(a+i)},options:o,type:"link"})},s.textWithLink=function(r,a,n,i){var o,c,d=this.getTextWidth(r),p=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){c=i.maxWidth;var m=this.splitTextToSize(r,c).length;o=Math.ceil(p*m)}else c=d,o=p;return this.text(r,a,n,i),n+=.2*p,i.align==="center"&&(a-=d/2),i.align==="right"&&(a-=d),this.link(a,n-p,c,o,i),d},s.getTextWidth=function(r){var a=this.internal.getFontSize();return this.getStringUnitWidth(r)*a/this.internal.scaleFactor}})(It.API),(function(s){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},a={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},n=[1570,1571,1573,1575];s.__arabicParser__={};var i=s.__arabicParser__.isInArabicSubstitutionA=function(g){return t[g.charCodeAt(0)]!==void 0},o=s.__arabicParser__.isArabicLetter=function(g){return typeof g=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(g)},c=s.__arabicParser__.isArabicEndLetter=function(g){return o(g)&&i(g)&&t[g.charCodeAt(0)].length<=2},d=s.__arabicParser__.isArabicAlfLetter=function(g){return o(g)&&n.indexOf(g.charCodeAt(0))>=0};s.__arabicParser__.arabicLetterHasIsolatedForm=function(g){return o(g)&&i(g)&&t[g.charCodeAt(0)].length>=1};var p=s.__arabicParser__.arabicLetterHasFinalForm=function(g){return o(g)&&i(g)&&t[g.charCodeAt(0)].length>=2};s.__arabicParser__.arabicLetterHasInitialForm=function(g){return o(g)&&i(g)&&t[g.charCodeAt(0)].length>=3};var m=s.__arabicParser__.arabicLetterHasMedialForm=function(g){return o(g)&&i(g)&&t[g.charCodeAt(0)].length==4},x=s.__arabicParser__.resolveLigatures=function(g){var v=0,_=r,k="",P=0;for(v=0;v<g.length;v+=1)_[g.charCodeAt(v)]!==void 0?(P++,typeof(_=_[g.charCodeAt(v)])=="number"&&(k+=String.fromCharCode(_),_=r,P=0),v===g.length-1&&(_=r,k+=g.charAt(v-(P-1)),v-=P-1,P=0)):(_=r,k+=g.charAt(v-P),v-=P,P=0);return k};s.__arabicParser__.isArabicDiacritic=function(g){return g!==void 0&&a[g.charCodeAt(0)]!==void 0};var b=s.__arabicParser__.getCorrectForm=function(g,v,_){return o(g)?i(g)===!1?-1:!p(g)||!o(v)&&!o(_)||!o(_)&&c(v)||c(g)&&!o(v)||c(g)&&d(v)||c(g)&&c(v)?0:m(g)&&o(v)&&!c(v)&&o(_)&&p(_)?3:c(g)||!o(_)?1:2:-1},h=function(g){var v=0,_=0,k=0,P="",L="",F="",W=(g=g||"").split("\\s+"),R=[];for(v=0;v<W.length;v+=1){for(R.push(""),_=0;_<W[v].length;_+=1)P=W[v][_],L=W[v][_-1],F=W[v][_+1],o(P)?(k=b(P,L,F),R[v]+=k!==-1?String.fromCharCode(t[P.charCodeAt(0)][k]):P):R[v]+=P;R[v]=x(R[v])}return R.join(" ")},j=s.__arabicParser__.processArabic=s.processArabic=function(){var g,v=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,_=[];if(Array.isArray(v)){var k=0;for(_=[],k=0;k<v.length;k+=1)Array.isArray(v[k])?_.push([h(v[k][0]),v[k][1],v[k][2]]):_.push([h(v[k])]);g=_}else g=h(v);return typeof arguments[0]=="string"?g:(arguments[0].text=g,arguments[0])};s.events.push(["preProcessText",j])})(It.API),It.API.autoPrint=function(s){var t;return(s=s||{}).variant=s.variant||"non-conform",s.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},(function(s){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(c){r=c}});var a=150;Object.defineProperty(this,"width",{get:function(){return a},set:function(c){a=isNaN(c)||Number.isInteger(c)===!1||c<0?150:c,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=a+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(c){n=isNaN(c)||Number.isInteger(c)===!1||c<0?300:c,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(c){i=c}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(c){o=c}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,a){var n;if((r=r||"2d")!=="2d")return null;for(n in a)this.pdf.context2d.hasOwnProperty(n)&&(this.pdf.context2d[n]=a[n]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},s.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])})(It.API),(function(s){var t={left:0,top:0,bottom:0,right:0},r=!1,a=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),n.call(this))},n=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var d=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return d},set:function(g){d=g}});var p=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return p},set:function(g){p=g}});var m=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return m},set:function(g){m=g}});var x=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return x},set:function(g){x=g}});var b=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return b},set:function(g){b=g}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(g){h=g}});var j=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return j},set:function(g){j=g}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},s.setHeaderFunction=function(d){return a.call(this),this.internal.__cell__.headerFunction=typeof d=="function"?d:void 0,this},s.getTextDimensions=function(d,p){a.call(this);var m=(p=p||{}).fontSize||this.getFontSize(),x=p.font||this.getFont(),b=p.scaleFactor||this.internal.scaleFactor,h=0,j=0,g=0,v=this;if(!Array.isArray(d)&&typeof d!="string"){if(typeof d!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");d=String(d)}var _=p.maxWidth;_>0?typeof d=="string"?d=this.splitTextToSize(d,_):Object.prototype.toString.call(d)==="[object Array]"&&(d=d.reduce(function(P,L){return P.concat(v.splitTextToSize(L,_))},[])):d=Array.isArray(d)?d:[d];for(var k=0;k<d.length;k++)h<(g=this.getStringUnitWidth(d[k],{font:x})*m)&&(h=g);return h!==0&&(j=d.length),{w:h/=b,h:Math.max((j*m*this.getLineHeightFactor()-m*(this.getLineHeightFactor()-1))/b,0)}},s.cellAddPage=function(){a.call(this),this.addPage();var d=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new i(d.left,d.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=s.cell=function(){var d;d=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),a.call(this);var p=this.internal.__cell__.lastCell,m=this.internal.__cell__.padding,x=this.internal.__cell__.margins||t,b=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return p.lineNumber!==void 0&&(p.lineNumber===d.lineNumber?(d.x=(p.x||0)+(p.width||0),d.y=p.y||0):p.y+p.height+d.height+x.bottom>this.getPageHeight()?(this.cellAddPage(),d.y=x.top,h&&b&&(this.printHeaderRow(d.lineNumber,!0),d.y+=b[0].height)):d.y=p.y+p.height||d.y),d.text[0]!==void 0&&(this.rect(d.x,d.y,d.width,d.height,r===!0?"FD":void 0),d.align==="right"?this.text(d.text,d.x+d.width-m,d.y+m,{align:"right",baseline:"top"}):d.align==="center"?this.text(d.text,d.x+d.width/2,d.y+m,{align:"center",baseline:"top",maxWidth:d.width-m-m}):this.text(d.text,d.x+m,d.y+m,{align:"left",baseline:"top",maxWidth:d.width-m-m})),this.internal.__cell__.lastCell=d,this};s.table=function(d,p,m,x,b){if(a.call(this),!m)throw new Error("No data for PDF table.");var h,j,g,v,_=[],k=[],P=[],L={},F={},W=[],R=[],B=(b=b||{}).autoSize||!1,A=b.printHeaders!==!1,S=b.css&&b.css["font-size"]!==void 0?16*b.css["font-size"]:b.fontSize||12,C=b.margins||Object.assign({width:this.getPageWidth()},t),O=typeof b.padding=="number"?b.padding:3,Z=b.headerBackgroundColor||"#c8c8c8",te=b.headerTextColor||"#000";if(n.call(this),this.internal.__cell__.printHeaders=A,this.internal.__cell__.margins=C,this.internal.__cell__.table_font_size=S,this.internal.__cell__.padding=O,this.internal.__cell__.headerBackgroundColor=Z,this.internal.__cell__.headerTextColor=te,this.setFontSize(S),x==null)k=_=Object.keys(m[0]),P=_.map(function(){return"left"});else if(Array.isArray(x)&&Zr(x[0])==="object")for(_=x.map(function(xe){return xe.name}),k=x.map(function(xe){return xe.prompt||xe.name||""}),P=x.map(function(xe){return xe.align||"left"}),h=0;h<x.length;h+=1)F[x[h].name]=.7499990551181103*x[h].width;else Array.isArray(x)&&typeof x[0]=="string"&&(k=_=x,P=_.map(function(){return"left"}));if(B||Array.isArray(x)&&typeof x[0]=="string")for(h=0;h<_.length;h+=1){for(L[v=_[h]]=m.map(function(xe){return xe[v]}),this.setFont(void 0,"bold"),W.push(this.getTextDimensions(k[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),j=L[v],this.setFont(void 0,"normal"),g=0;g<j.length;g+=1)W.push(this.getTextDimensions(j[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);F[v]=Math.max.apply(null,W)+O+O,W=[]}if(A){var ce={};for(h=0;h<_.length;h+=1)ce[_[h]]={},ce[_[h]].text=k[h],ce[_[h]].align=P[h];var re=c.call(this,ce,F);R=_.map(function(xe){return new i(d,p,F[xe],re,ce[xe].text,void 0,ce[xe].align)}),this.setTableHeaderRow(R),this.printHeaderRow(1,!1)}var X=x.reduce(function(xe,J){return xe[J.name]=J.align,xe},{});for(h=0;h<m.length;h+=1){"rowStart"in b&&b.rowStart instanceof Function&&b.rowStart({row:h,data:m[h]},this);var U=c.call(this,m[h],F);for(g=0;g<_.length;g+=1){var oe=m[h][_[g]];"cellStart"in b&&b.cellStart instanceof Function&&b.cellStart({row:h,col:g,data:oe},this),o.call(this,new i(d,p,F[_[g]],U,oe,h+2,X[_[g]]))}}return this.internal.__cell__.table_x=d,this.internal.__cell__.table_y=p,this};var c=function(d,p){var m=this.internal.__cell__.padding,x=this.internal.__cell__.table_font_size,b=this.internal.scaleFactor;return Object.keys(d).map(function(h){var j=d[h];return this.splitTextToSize(j.hasOwnProperty("text")?j.text:j,p[h]-m-m)},this).map(function(h){return this.getLineHeightFactor()*h.length*x/b+m+m},this).reduce(function(h,j){return Math.max(h,j)},0)};s.setTableHeaderRow=function(d){a.call(this),this.internal.__cell__.tableHeaderRow=d},s.printHeaderRow=function(d,p){if(a.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var m;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var x=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(x[0],x[1],x[2],x[3],void 0,-1)}this.setFont(void 0,"bold");for(var b=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){m=this.internal.__cell__.tableHeaderRow[h].clone(),p&&(m.y=this.internal.__cell__.margins.top||0,b.push(m)),m.lineNumber=d;var j=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,m),this.setTextColor(j)}b.length>0&&this.setTableHeaderRow(b),this.setFont(void 0,"normal"),r=!1}})(It.API);var bk={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},gk=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Jb=fk(gk),vk=[100,200,300,400,500,600,700,800,900],EO=fk(vk);function sb(s){var t=s.family.replace(/"|'/g,"").toLowerCase(),r=(function(i){return bk[i=i||"normal"]?i:"normal"})(s.style),a=(function(i){return i?typeof i=="number"?i>=100&&i<=900&&i%100==0?i:400:/^\d00$/.test(i)?parseInt(i):i==="bold"?700:400:400})(s.weight),n=(function(i){return typeof Jb[i=i||"normal"]=="number"?i:"normal"})(s.stretch);return{family:t,style:r,weight:a,stretch:n,src:s.src||[],ref:s.ref||{name:t,style:[n,r,a].join(" ")}}}function l_(s,t,r,a){var n;for(n=r;n>=0&&n<t.length;n+=a)if(s[t[n]])return s[t[n]];for(n=r;n>=0&&n<t.length;n-=a)if(s[t[n]])return s[t[n]]}var IO={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},c_={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function d_(s){return[s.stretch,s.style,s.weight,s.family].join(" ")}function u_(s){return s.trimLeft()}function LO(s,t){for(var r=0;r<s.length;){if(s.charAt(r)===t)return[s.substring(0,r),s.substring(r+1)];r+=1}return null}function TO(s){var t=s.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],s.substring(t[0].length)]}var ph,p_,m_,eu,mh,h_,x_,f_,ab=["times"];function b_(s,t,r,a,n){var i=4,o=v_;switch(n){case It.API.image_compression.FAST:i=1,o=g_;break;case It.API.image_compression.MEDIUM:i=6,o=y_;break;case It.API.image_compression.SLOW:i=9,o=j_}s=(function(d,p,m,x){for(var b,h=d.length/p,j=new Uint8Array(d.length+h),g=[RO,g_,v_,y_,j_],v=0;v<h;v+=1){var _=v*p,k=d.subarray(_,_+p);if(x)j.set(x(k,m,b),_+v);else{for(var P=g.length,L=[],F=0;F<P;F+=1)L[F]=g[F](k,m,b);var W=FO(L.concat());j.set(L[W],_+v)}b=k}return j})(s,t,Math.ceil(r*a/8),o);var c=Vb(s,{level:i});return It.API.__addimage__.arrayBufferToBinaryString(c)}function RO(s){var t=Array.apply([],s);return t.unshift(0),t}function g_(s,t){var r=s.length,a=[];a[0]=1;for(var n=0;n<r;n+=1){var i=s[n-t]||0;a[n+1]=s[n]-i+256&255}return a}function v_(s,t,r){var a=s.length,n=[];n[0]=2;for(var i=0;i<a;i+=1){var o=r&&r[i]||0;n[i+1]=s[i]-o+256&255}return n}function y_(s,t,r){var a=s.length,n=[];n[0]=3;for(var i=0;i<a;i+=1){var o=s[i-t]||0,c=r&&r[i]||0;n[i+1]=s[i]+256-(o+c>>>1)&255}return n}function j_(s,t,r){var a=s.length,n=[];n[0]=4;for(var i=0;i<a;i+=1){var o=MO(s[i-t]||0,r&&r[i]||0,r&&r[i-t]||0);n[i+1]=s[i]-o+256&255}return n}function MO(s,t,r){if(s===t&&t===r)return s;var a=Math.abs(t-r),n=Math.abs(s-r),i=Math.abs(s+t-r-r);return a<=n&&a<=i?s:n<=i?t:r}function FO(s){var t=s.map(function(r){return r.reduce(function(a,n){return a+Math.abs(n)},0)});return t.indexOf(Math.min.apply(null,t))}function nb(s,t,r){var a=t*r,n=Math.floor(a/8),i=16-(a-8*n+r),o=(1<<r)-1;return yk(s,n)>>i&o}function __(s,t,r,a){var n=r*a,i=Math.floor(n/8),o=16-(n-8*i+a),c=(1<<a)-1,d=(t&c)<<o;(function(p,m,x){if(m+1<p.byteLength)p.setUint16(m,x,!1);else{var b=x>>8&255;p.setUint8(m,b)}})(s,i,yk(s,i)&~(c<<o)&65535|d)}function yk(s,t){return t+1<s.byteLength?s.getUint16(t,!1):s.getUint8(t)<<8}function UO(s){var t=0;if(s[t++]!==71||s[t++]!==73||s[t++]!==70||s[t++]!==56||(s[t++]+1&253)!=56||s[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=s[t++]|s[t++]<<8,a=s[t++]|s[t++]<<8,n=s[t++],i=n>>7,o=1<<1+(7&n);s[t++],s[t++];var c=null,d=null;i&&(c=t,d=o,t+=3*o);var p=!0,m=[],x=0,b=null,h=0,j=null;for(this.width=r,this.height=a;p&&t<s.length;)switch(s[t++]){case 33:switch(s[t++]){case 255:if(s[t]!==11||s[t+1]==78&&s[t+2]==69&&s[t+3]==84&&s[t+4]==83&&s[t+5]==67&&s[t+6]==65&&s[t+7]==80&&s[t+8]==69&&s[t+9]==50&&s[t+10]==46&&s[t+11]==48&&s[t+12]==3&&s[t+13]==1&&s[t+16]==0)t+=14,j=s[t++]|s[t++]<<8,t++;else for(t+=12;;){if(!((C=s[t++])>=0))throw Error("Invalid block size");if(C===0)break;t+=C}break;case 249:if(s[t++]!==4||s[t+4]!==0)throw new Error("Invalid graphics extension block.");var g=s[t++];x=s[t++]|s[t++]<<8,b=s[t++],1&g||(b=null),h=g>>2&7,t++;break;case 254:for(;;){if(!((C=s[t++])>=0))throw Error("Invalid block size");if(C===0)break;t+=C}break;default:throw new Error("Unknown graphic control label: 0x"+s[t-1].toString(16))}break;case 44:var v=s[t++]|s[t++]<<8,_=s[t++]|s[t++]<<8,k=s[t++]|s[t++]<<8,P=s[t++]|s[t++]<<8,L=s[t++],F=L>>6&1,W=1<<1+(7&L),R=c,B=d,A=!1;L>>7&&(A=!0,R=t,B=W,t+=3*W);var S=t;for(t++;;){var C;if(!((C=s[t++])>=0))throw Error("Invalid block size");if(C===0)break;t+=C}m.push({x:v,y:_,width:k,height:P,has_local_palette:A,palette_offset:R,palette_size:B,data_offset:S,data_length:t-S,transparent_index:b,interlaced:!!F,delay:x,disposal:h});break;case 59:p=!1;break;default:throw new Error("Unknown gif block: 0x"+s[t-1].toString(16))}this.numFrames=function(){return m.length},this.loopCount=function(){return j},this.frameInfo=function(O){if(O<0||O>=m.length)throw new Error("Frame index out of range.");return m[O]},this.decodeAndBlitFrameBGRA=function(O,Z){var te=this.frameInfo(O),ce=te.width*te.height,re=new Uint8Array(ce);k_(s,te.data_offset,re,ce);var X=te.palette_offset,U=te.transparent_index;U===null&&(U=256);var oe=te.width,xe=r-oe,J=oe,$=4*(te.y*r+te.x),Q=4*((te.y+te.height)*r+te.x),q=$,I=4*xe;te.interlaced===!0&&(I+=4*r*7);for(var Y=8,H=0,he=re.length;H<he;++H){var ge=re[H];if(J===0&&(J=oe,(q+=I)>=Q&&(I=4*xe+4*r*(Y-1),q=$+(oe+xe)*(Y<<1),Y>>=1)),ge===U)q+=4;else{var K=s[X+3*ge],T=s[X+3*ge+1],ee=s[X+3*ge+2];Z[q++]=ee,Z[q++]=T,Z[q++]=K,Z[q++]=255}--J}},this.decodeAndBlitFrameRGBA=function(O,Z){var te=this.frameInfo(O),ce=te.width*te.height,re=new Uint8Array(ce);k_(s,te.data_offset,re,ce);var X=te.palette_offset,U=te.transparent_index;U===null&&(U=256);var oe=te.width,xe=r-oe,J=oe,$=4*(te.y*r+te.x),Q=4*((te.y+te.height)*r+te.x),q=$,I=4*xe;te.interlaced===!0&&(I+=4*r*7);for(var Y=8,H=0,he=re.length;H<he;++H){var ge=re[H];if(J===0&&(J=oe,(q+=I)>=Q&&(I=4*xe+4*r*(Y-1),q=$+(oe+xe)*(Y<<1),Y>>=1)),ge===U)q+=4;else{var K=s[X+3*ge],T=s[X+3*ge+1],ee=s[X+3*ge+2];Z[q++]=K,Z[q++]=T,Z[q++]=ee,Z[q++]=255}--J}}}function k_(s,t,r,a){for(var n=s[t++],i=1<<n,o=i+1,c=o+1,d=n+1,p=(1<<d)-1,m=0,x=0,b=0,h=s[t++],j=new Int32Array(4096),g=null;;){for(;m<16&&h!==0;)x|=s[t++]<<m,m+=8,h===1?h=s[t++]:--h;if(m<d)break;var v=x&p;if(x>>=d,m-=d,v!==i){if(v===o)break;for(var _=v<c?v:g,k=0,P=_;P>i;)P=j[P]>>8,++k;var L=P;if(b+k+(_!==v?1:0)>a)return void Xr.log("Warning, gif stream longer than expected.");r[b++]=L;var F=b+=k;for(_!==v&&(r[b++]=L),P=_;k--;)P=j[P],r[--F]=255&P,P>>=8;g!==null&&c<4096&&(j[c++]=g<<8|L,c>=p+1&&d<12&&(++d,p=p<<1|1)),g=v}else c=o+1,p=(1<<(d=n+1))-1,g=null}return b!==a&&Xr.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function ib(s){var t,r,a,n,i,o=Math.floor,c=new Array(64),d=new Array(64),p=new Array(64),m=new Array(64),x=new Array(65535),b=new Array(65535),h=new Array(64),j=new Array(64),g=[],v=0,_=7,k=new Array(64),P=new Array(64),L=new Array(64),F=new Array(256),W=new Array(2048),R=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],B=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],A=[0,1,2,3,4,5,6,7,8,9,10,11],S=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],C=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],O=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],Z=[0,1,2,3,4,5,6,7,8,9,10,11],te=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ce=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function re($,Q){for(var q=0,I=0,Y=new Array,H=1;H<=16;H++){for(var he=1;he<=$[H];he++)Y[Q[I]]=[],Y[Q[I]][0]=q,Y[Q[I]][1]=H,I++,q++;q*=2}return Y}function X($){for(var Q=$[0],q=$[1]-1;q>=0;)Q&1<<q&&(v|=1<<_),q--,--_<0&&(v==255?(U(255),U(0)):U(v),_=7,v=0)}function U($){g.push($)}function oe($){U($>>8&255),U(255&$)}function xe($,Q,q,I,Y){for(var H,he=Y[0],ge=Y[240],K=(function(Oe,Je){var Be,kt,it,Ft,Tt,ot,Jt,Vt,wt,Nt,bt=0;for(wt=0;wt<8;++wt){Be=Oe[bt],kt=Oe[bt+1],it=Oe[bt+2],Ft=Oe[bt+3],Tt=Oe[bt+4],ot=Oe[bt+5],Jt=Oe[bt+6];var jr=Be+(Vt=Oe[bt+7]),Zt=Be-Vt,ct=kt+Jt,Ut=kt-Jt,dr=it+ot,Et=it-ot,or=Ft+Tt,qt=Ft-Tt,Lr=jr+or,Tr=jr-or,ur=ct+dr,De=ct-dr;Oe[bt]=Lr+ur,Oe[bt+4]=Lr-ur;var Qe=.707106781*(De+Tr);Oe[bt+2]=Tr+Qe,Oe[bt+6]=Tr-Qe;var st=.382683433*((Lr=qt+Et)-(De=Ut+Zt)),zt=.5411961*Lr+st,rr=1.306562965*De+st,_r=.707106781*(ur=Et+Ut),dt=Zt+_r,kr=Zt-_r;Oe[bt+5]=kr+zt,Oe[bt+3]=kr-zt,Oe[bt+1]=dt+rr,Oe[bt+7]=dt-rr,bt+=8}for(bt=0,wt=0;wt<8;++wt){Be=Oe[bt],kt=Oe[bt+8],it=Oe[bt+16],Ft=Oe[bt+24],Tt=Oe[bt+32],ot=Oe[bt+40],Jt=Oe[bt+48];var Ke=Be+(Vt=Oe[bt+56]),nt=Be-Vt,Nr=kt+Jt,gr=kt-Jt,Gr=it+ot,mr=it-ot,tn=Ft+Tt,Ki=Ft-Tt,zn=Ke+tn,Wn=Ke-tn,Ys=Nr+Gr,rn=Nr-Gr;Oe[bt]=zn+Ys,Oe[bt+32]=zn-Ys;var qa=.707106781*(rn+Wn);Oe[bt+16]=Wn+qa,Oe[bt+48]=Wn-qa;var _o=.382683433*((zn=Ki+mr)-(rn=gr+nt)),Cn=.5411961*zn+_o,Gi=1.306562965*rn+_o,ko=.707106781*(Ys=mr+gr),No=nt+ko,hl=nt-ko;Oe[bt+40]=hl+Cn,Oe[bt+24]=hl-Cn,Oe[bt+8]=No+Gi,Oe[bt+56]=No-Gi,bt++}for(wt=0;wt<64;++wt)Nt=Oe[wt]*Je[wt],h[wt]=Nt>0?Nt+.5|0:Nt-.5|0;return h})($,Q),T=0;T<64;++T)j[R[T]]=K[T];var ee=j[0]-q;q=j[0],ee==0?X(I[0]):(X(I[b[H=32767+ee]]),X(x[H]));for(var _e=63;_e>0&&j[_e]==0;)_e--;if(_e==0)return X(he),q;for(var ke,ue=1;ue<=_e;){for(var je=ue;j[ue]==0&&ue<=_e;)++ue;var ne=ue-je;if(ne>=16){ke=ne>>4;for(var Re=1;Re<=ke;++Re)X(ge);ne&=15}H=32767+j[ue],X(Y[(ne<<4)+b[H]]),X(x[H]),ue++}return _e!=63&&X(he),q}function J($){$=Math.min(Math.max($,1),100),i!=$&&((function(Q){for(var q=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],I=0;I<64;I++){var Y=o((q[I]*Q+50)/100);Y=Math.min(Math.max(Y,1),255),c[R[I]]=Y}for(var H=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],he=0;he<64;he++){var ge=o((H[he]*Q+50)/100);ge=Math.min(Math.max(ge,1),255),d[R[he]]=ge}for(var K=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],T=0,ee=0;ee<8;ee++)for(var _e=0;_e<8;_e++)p[T]=1/(c[R[T]]*K[ee]*K[_e]*8),m[T]=1/(d[R[T]]*K[ee]*K[_e]*8),T++})($<50?Math.floor(5e3/$):Math.floor(200-2*$)),i=$)}this.encode=function($,Q){Q&&J(Q),g=new Array,v=0,_=7,oe(65496),oe(65504),oe(16),U(74),U(70),U(73),U(70),U(0),U(1),U(1),U(0),oe(1),oe(1),U(0),U(0),(function(){oe(65499),oe(132),U(0);for(var kt=0;kt<64;kt++)U(c[kt]);U(1);for(var it=0;it<64;it++)U(d[it])})(),(function(kt,it){oe(65472),oe(17),U(8),oe(it),oe(kt),U(3),U(1),U(17),U(0),U(2),U(17),U(1),U(3),U(17),U(1)})($.width,$.height),(function(){oe(65476),oe(418),U(0);for(var kt=0;kt<16;kt++)U(B[kt+1]);for(var it=0;it<=11;it++)U(A[it]);U(16);for(var Ft=0;Ft<16;Ft++)U(S[Ft+1]);for(var Tt=0;Tt<=161;Tt++)U(C[Tt]);U(1);for(var ot=0;ot<16;ot++)U(O[ot+1]);for(var Jt=0;Jt<=11;Jt++)U(Z[Jt]);U(17);for(var Vt=0;Vt<16;Vt++)U(te[Vt+1]);for(var wt=0;wt<=161;wt++)U(ce[wt])})(),oe(65498),oe(12),U(3),U(1),U(0),U(2),U(17),U(3),U(17),U(0),U(63),U(0);var q=0,I=0,Y=0;v=0,_=7,this.encode.displayName="_encode_";for(var H,he,ge,K,T,ee,_e,ke,ue,je=$.data,ne=$.width,Re=$.height,Oe=4*ne,Je=0;Je<Re;){for(H=0;H<Oe;){for(T=Oe*Je+H,_e=-1,ke=0,ue=0;ue<64;ue++)ee=T+(ke=ue>>3)*Oe+(_e=4*(7&ue)),Je+ke>=Re&&(ee-=Oe*(Je+1+ke-Re)),H+_e>=Oe&&(ee-=H+_e-Oe+4),he=je[ee++],ge=je[ee++],K=je[ee++],k[ue]=(W[he]+W[ge+256|0]+W[K+512|0]>>16)-128,P[ue]=(W[he+768|0]+W[ge+1024|0]+W[K+1280|0]>>16)-128,L[ue]=(W[he+1280|0]+W[ge+1536|0]+W[K+1792|0]>>16)-128;q=xe(k,p,q,t,a),I=xe(P,m,I,r,n),Y=xe(L,m,Y,r,n),H+=32}Je+=8}if(_>=0){var Be=[];Be[1]=_+1,Be[0]=(1<<_+1)-1,X(Be)}return oe(65497),new Uint8Array(g)},s=s||50,(function(){for(var $=String.fromCharCode,Q=0;Q<256;Q++)F[Q]=$(Q)})(),t=re(B,A),r=re(O,Z),a=re(S,C),n=re(te,ce),(function(){for(var $=1,Q=2,q=1;q<=15;q++){for(var I=$;I<Q;I++)b[32767+I]=q,x[32767+I]=[],x[32767+I][1]=q,x[32767+I][0]=I;for(var Y=-(Q-1);Y<=-$;Y++)b[32767+Y]=q,x[32767+Y]=[],x[32767+Y][1]=q,x[32767+Y][0]=Q-1+Y;$<<=1,Q<<=1}})(),(function(){for(var $=0;$<256;$++)W[$]=19595*$,W[$+256|0]=38470*$,W[$+512|0]=7471*$+32768,W[$+768|0]=-11059*$,W[$+1024|0]=-21709*$,W[$+1280|0]=32768*$+8421375,W[$+1536|0]=-27439*$,W[$+1792|0]=-5329*$})(),J(s)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Fi(s,t){if(this.pos=0,this.buffer=s,this.datav=new DataView(s.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function N_(s){function t(A){if(!A)throw Error("assert :P")}function r(A,S,C){for(var O=0;4>O;O++)if(A[S+O]!=C.charCodeAt(O))return!0;return!1}function a(A,S,C,O,Z){for(var te=0;te<Z;te++)A[S+te]=C[O+te]}function n(A,S,C,O){for(var Z=0;Z<O;Z++)A[S+Z]=C}function i(A){return new Int32Array(A)}function o(A,S){for(var C=[],O=0;O<A;O++)C.push(new S);return C}function c(A,S){var C=[];return(function O(Z,te,ce){for(var re=ce[te],X=0;X<re&&(Z.push(ce.length>te+1?[]:new S),!(ce.length<te+1));X++)O(Z[X],te+1,ce)})(C,0,A),C}var d=function(){var A=this;function S(y,w){for(var M=1<<w-1>>>0;y&M;)M>>>=1;return M?(y&M-1)+M:y}function C(y,w,M,G,se){t(!(G%M));do y[w+(G-=M)]=se;while(0<G)}function O(y,w,M,G,se){if(t(2328>=se),512>=se)var le=i(512);else if((le=i(se))==null)return 0;return(function(de,pe,me,fe,Se,Ie){var be,Ce,Ee=pe,$e=1<<me,Te=i(16),Ue=i(16);for(t(Se!=0),t(fe!=null),t(de!=null),t(0<me),Ce=0;Ce<Se;++Ce){if(15<fe[Ce])return 0;++Te[fe[Ce]]}if(Te[0]==Se)return 0;for(Ue[1]=0,be=1;15>be;++be){if(Te[be]>1<<be)return 0;Ue[be+1]=Ue[be]+Te[be]}for(Ce=0;Ce<Se;++Ce)be=fe[Ce],0<fe[Ce]&&(Ie[Ue[be]++]=Ce);if(Ue[15]==1)return(fe=new Z).g=0,fe.value=Ie[0],C(de,Ee,1,$e,fe),$e;var qe,He=-1,Ze=$e-1,Pt=0,ht=1,sr=1,yt=1<<me;for(Ce=0,be=1,Se=2;be<=me;++be,Se<<=1){if(ht+=sr<<=1,0>(sr-=Te[be]))return 0;for(;0<Te[be];--Te[be])(fe=new Z).g=be,fe.value=Ie[Ce++],C(de,Ee+Pt,Se,yt,fe),Pt=S(Pt,be)}for(be=me+1,Se=2;15>=be;++be,Se<<=1){if(ht+=sr<<=1,0>(sr-=Te[be]))return 0;for(;0<Te[be];--Te[be]){if(fe=new Z,(Pt&Ze)!=He){for(Ee+=yt,qe=1<<(He=be)-me;15>He&&!(0>=(qe-=Te[He]));)++He,qe<<=1;$e+=yt=1<<(qe=He-me),de[pe+(He=Pt&Ze)].g=qe+me,de[pe+He].value=Ee-pe-He}fe.g=be-me,fe.value=Ie[Ce++],C(de,Ee+(Pt>>me),Se,yt,fe),Pt=S(Pt,be)}}return ht!=2*Ue[15]-1?0:$e})(y,w,M,G,se,le)}function Z(){this.value=this.g=0}function te(){this.value=this.g=0}function ce(){this.G=o(5,Z),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(un,te)}function re(y,w,M,G){t(y!=null),t(w!=null),t(2147483648>G),y.Ca=254,y.I=0,y.b=-8,y.Ka=0,y.oa=w,y.pa=M,y.Jd=w,y.Yc=M+G,y.Zc=4<=G?M+G-4+1:M,he(y)}function X(y,w){for(var M=0;0<w--;)M|=K(y,128)<<w;return M}function U(y,w){var M=X(y,w);return ge(y)?-M:M}function oe(y,w,M,G){var se,le=0;for(t(y!=null),t(w!=null),t(4294967288>G),y.Sb=G,y.Ra=0,y.u=0,y.h=0,4<G&&(G=4),se=0;se<G;++se)le+=w[M+se]<<8*se;y.Ra=le,y.bb=G,y.oa=w,y.pa=M}function xe(y){for(;8<=y.u&&y.bb<y.Sb;)y.Ra>>>=8,y.Ra+=y.oa[y.pa+y.bb]<<to-8>>>0,++y.bb,y.u-=8;I(y)&&(y.h=1,y.u=0)}function J(y,w){if(t(0<=w),!y.h&&w<=Wa){var M=q(y)&Za[w];return y.u+=w,xe(y),M}return y.h=1,y.u=0}function $(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function Q(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function q(y){return y.Ra>>>(y.u&to-1)>>>0}function I(y){return t(y.bb<=y.Sb),y.h||y.bb==y.Sb&&y.u>to}function Y(y,w){y.u=w,y.h=I(y)}function H(y){y.u>=ei&&(t(y.u>=ei),xe(y))}function he(y){t(y!=null&&y.oa!=null),y.pa<y.Zc?(y.I=(y.oa[y.pa++]|y.I<<8)>>>0,y.b+=8):(t(y!=null&&y.oa!=null),y.pa<y.Yc?(y.b+=8,y.I=y.oa[y.pa++]|y.I<<8):y.Ka?y.b=0:(y.I<<=8,y.b+=8,y.Ka=1))}function ge(y){return X(y,1)}function K(y,w){var M=y.Ca;0>y.b&&he(y);var G=y.b,se=M*w>>>8,le=(y.I>>>G>se)+0;for(le?(M-=se,y.I-=se+1<<G>>>0):M=se+1,G=M,se=0;256<=G;)se+=8,G>>=8;return G=7^se+wi[G],y.b-=G,y.Ca=(M<<G)-1,le}function T(y,w,M){y[w+0]=M>>24&255,y[w+1]=M>>16&255,y[w+2]=M>>8&255,y[w+3]=255&M}function ee(y,w){return y[w+0]|y[w+1]<<8}function _e(y,w){return ee(y,w)|y[w+2]<<16}function ke(y,w){return ee(y,w)|ee(y,w+2)<<16}function ue(y,w){var M=1<<w;return t(y!=null),t(0<w),y.X=i(M),y.X==null?0:(y.Mb=32-w,y.Xa=w,1)}function je(y,w){t(y!=null),t(w!=null),t(y.Xa==w.Xa),a(w.X,0,y.X,0,1<<w.Xa)}function ne(){this.X=[],this.Xa=this.Mb=0}function Re(y,w,M,G){t(M!=null),t(G!=null);var se=M[0],le=G[0];return se==0&&(se=(y*le+w/2)/w),le==0&&(le=(w*se+y/2)/y),0>=se||0>=le?0:(M[0]=se,G[0]=le,1)}function Oe(y,w){return y+(1<<w)-1>>>w}function Je(y,w){return((4278255360&y)+(4278255360&w)>>>0&4278255360)+((16711935&y)+(16711935&w)>>>0&16711935)>>>0}function Be(y,w){A[w]=function(M,G,se,le,de,pe,me){var fe;for(fe=0;fe<de;++fe){var Se=A[y](pe[me+fe-1],se,le+fe);pe[me+fe]=Je(M[G+fe],Se)}}}function kt(){this.ud=this.hd=this.jd=0}function it(y,w){return((4278124286&(y^w))>>>1)+(y&w)>>>0}function Ft(y){return 0<=y&&256>y?y:0>y?0:255<y?255:void 0}function Tt(y,w){return Ft(y+(y-w+.5>>1))}function ot(y,w,M){return Math.abs(w-M)-Math.abs(y-M)}function Jt(y,w,M,G,se,le,de){for(G=le[de-1],M=0;M<se;++M)le[de+M]=G=Je(y[w+M],G)}function Vt(y,w,M,G,se){var le;for(le=0;le<M;++le){var de=y[w+le],pe=de>>8&255,me=16711935&(me=(me=16711935&de)+((pe<<16)+pe));G[se+le]=(4278255360&de)+me>>>0}}function wt(y,w){w.jd=255&y,w.hd=y>>8&255,w.ud=y>>16&255}function Nt(y,w,M,G,se,le){var de;for(de=0;de<G;++de){var pe=w[M+de],me=pe>>>8,fe=pe,Se=255&(Se=(Se=pe>>>16)+((y.jd<<24>>24)*(me<<24>>24)>>>5));fe=255&(fe=(fe+=(y.hd<<24>>24)*(me<<24>>24)>>>5)+((y.ud<<24>>24)*(Se<<24>>24)>>>5)),se[le+de]=(4278255360&pe)+(Se<<16)+fe}}function bt(y,w,M,G,se){A[w]=function(le,de,pe,me,fe,Se,Ie,be,Ce){for(me=Ie;me<be;++me)for(Ie=0;Ie<Ce;++Ie)fe[Se++]=se(pe[G(le[de++])])},A[y]=function(le,de,pe,me,fe,Se,Ie){var be=8>>le.b,Ce=le.Ea,Ee=le.K[0],$e=le.w;if(8>be)for(le=(1<<le.b)-1,$e=(1<<be)-1;de<pe;++de){var Te,Ue=0;for(Te=0;Te<Ce;++Te)Te&le||(Ue=G(me[fe++])),Se[Ie++]=se(Ee[Ue&$e]),Ue>>=be}else A["VP8LMapColor"+M](me,fe,Ee,$e,Se,Ie,de,pe,Ce)}}function jr(y,w,M,G,se){for(M=w+M;w<M;){var le=y[w++];G[se++]=le>>16&255,G[se++]=le>>8&255,G[se++]=255&le}}function Zt(y,w,M,G,se){for(M=w+M;w<M;){var le=y[w++];G[se++]=le>>16&255,G[se++]=le>>8&255,G[se++]=255&le,G[se++]=le>>24&255}}function ct(y,w,M,G,se){for(M=w+M;w<M;){var le=(de=y[w++])>>16&240|de>>12&15,de=240&de|de>>28&15;G[se++]=le,G[se++]=de}}function Ut(y,w,M,G,se){for(M=w+M;w<M;){var le=(de=y[w++])>>16&248|de>>13&7,de=de>>5&224|de>>3&31;G[se++]=le,G[se++]=de}}function dr(y,w,M,G,se){for(M=w+M;w<M;){var le=y[w++];G[se++]=255&le,G[se++]=le>>8&255,G[se++]=le>>16&255}}function Et(y,w,M,G,se,le){if(le==0)for(M=w+M;w<M;)T(G,((le=y[w++])[0]>>24|le[1]>>8&65280|le[2]<<8&16711680|le[3]<<24)>>>0),se+=32;else a(G,se,y,w,M)}function or(y,w){A[w][0]=A[y+"0"],A[w][1]=A[y+"1"],A[w][2]=A[y+"2"],A[w][3]=A[y+"3"],A[w][4]=A[y+"4"],A[w][5]=A[y+"5"],A[w][6]=A[y+"6"],A[w][7]=A[y+"7"],A[w][8]=A[y+"8"],A[w][9]=A[y+"9"],A[w][10]=A[y+"10"],A[w][11]=A[y+"11"],A[w][12]=A[y+"12"],A[w][13]=A[y+"13"],A[w][14]=A[y+"0"],A[w][15]=A[y+"0"]}function qt(y){return y==Al||y==Wo||y==kc||y==Nc}function Lr(){this.eb=[],this.size=this.A=this.fb=0}function Tr(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function ur(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Lr,this.f.kb=new Tr,this.sd=null}function De(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Qe(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function st(y){return alert("todo:WebPSamplerProcessPlane"),y.T}function zt(y,w){var M=y.T,G=w.ba.f.RGBA,se=G.eb,le=G.fb+y.ka*G.A,de=Ca[w.ba.S],pe=y.y,me=y.O,fe=y.f,Se=y.N,Ie=y.ea,be=y.W,Ce=w.cc,Ee=w.dc,$e=w.Mc,Te=w.Nc,Ue=y.ka,qe=y.ka+y.T,He=y.U,Ze=He+1>>1;for(Ue==0?de(pe,me,null,null,fe,Se,Ie,be,fe,Se,Ie,be,se,le,null,null,He):(de(w.ec,w.fc,pe,me,Ce,Ee,$e,Te,fe,Se,Ie,be,se,le-G.A,se,le,He),++M);Ue+2<qe;Ue+=2)Ce=fe,Ee=Se,$e=Ie,Te=be,Se+=y.Rc,be+=y.Rc,le+=2*G.A,de(pe,(me+=2*y.fa)-y.fa,pe,me,Ce,Ee,$e,Te,fe,Se,Ie,be,se,le-G.A,se,le,He);return me+=y.fa,y.j+qe<y.o?(a(w.ec,w.fc,pe,me,He),a(w.cc,w.dc,fe,Se,Ze),a(w.Mc,w.Nc,Ie,be,Ze),M--):1&qe||de(pe,me,null,null,fe,Se,Ie,be,fe,Se,Ie,be,se,le+G.A,null,null,He),M}function rr(y,w,M){var G=y.F,se=[y.J];if(G!=null){var le=y.U,de=w.ba.S,pe=de==_c||de==kc;w=w.ba.f.RGBA;var me=[0],fe=y.ka;me[0]=y.T,y.Kb&&(fe==0?--me[0]:(--fe,se[0]-=y.width),y.j+y.ka+y.T==y.o&&(me[0]=y.o-y.j-fe));var Se=w.eb;fe=w.fb+fe*w.A,y=yc(G,se[0],y.width,le,me,Se,fe+(pe?0:3),w.A),t(M==me),y&&qt(de)&&Zo(Se,fe,pe,le,me,w.A)}return 0}function _r(y){var w=y.ma,M=w.ba.S,G=11>M,se=M==no||M==jc||M==_c||M==Ur||M==12||qt(M);if(w.memory=null,w.Ib=null,w.Jb=null,w.Nd=null,!kl(w.Oa,y,se?11:12))return 0;if(se&&qt(M)&&vd(),y.da)alert("todo:use_scaling");else{if(G){if(w.Ib=st,y.Kb){if(M=y.U+1>>1,w.memory=i(y.U+2*M),w.memory==null)return 0;w.ec=w.memory,w.fc=0,w.cc=w.ec,w.dc=w.fc+y.U,w.Mc=w.cc,w.Nc=w.dc+M,w.Ib=zt,vd()}}else alert("todo:EmitYUV");se&&(w.Jb=rr,G&&dn())}if(G&&!Xs){for(y=0;256>y;++y)Pa[y]=89858*(y-128)+Tn>>Pi,Aa[y]=-22014*(y-128)+Tn,Il[y]=-45773*(y-128),Jo[y]=113618*(y-128)+Tn>>Pi;for(y=Er;y<Mr;++y)w=76283*(y-16)+Tn>>Pi,zd[y-Er]=ds(w,255),sm[y-Er]=ds(w+8>>4,15);Xs=1}return 1}function dt(y){var w=y.ma,M=y.U,G=y.T;return t(!(1&y.ka)),0>=M||0>=G?0:(M=w.Ib(y,w),w.Jb!=null&&w.Jb(y,w,M),w.Dc+=M,1)}function kr(y){y.ma.memory=null}function Ke(y,w,M,G){return J(y,8)!=47?0:(w[0]=J(y,14)+1,M[0]=J(y,14)+1,G[0]=J(y,1),J(y,3)!=0?0:!y.h)}function nt(y,w){if(4>y)return y+1;var M=y-2>>1;return(2+(1&y)<<M)+J(w,M)+1}function Nr(y,w){return 120<w?w-120:1<=(M=((M=bx[w-1])>>4)*y+(8-(15&M)))?M:1;var M}function gr(y,w,M){var G=q(M),se=y[w+=255&G].g-8;return 0<se&&(Y(M,M.u+8),G=q(M),w+=y[w].value,w+=G&(1<<se)-1),Y(M,M.u+y[w].g),y[w].value}function Gr(y,w,M){return M.g+=y.g,M.value+=y.value<<w>>>0,t(8>=M.g),y.g}function mr(y,w,M){var G=y.xc;return t((w=G==0?0:y.vc[y.md*(M>>G)+(w>>G)])<y.Wb),y.Ya[w]}function tn(y,w,M,G){var se=y.ab,le=y.c*w,de=y.C;w=de+w;var pe=M,me=G;for(G=y.Ta,M=y.Ua;0<se--;){var fe=y.gc[se],Se=de,Ie=w,be=pe,Ce=me,Ee=(me=G,pe=M,fe.Ea);switch(t(Se<Ie),t(Ie<=fe.nc),fe.hc){case 2:vs(be,Ce,(Ie-Se)*Ee,me,pe);break;case 0:var $e=Se,Te=Ie,Ue=me,qe=pe,He=(yt=fe).Ea;$e==0&&(Si(be,Ce,null,null,1,Ue,qe),Jt(be,Ce+1,0,0,He-1,Ue,qe+1),Ce+=He,qe+=He,++$e);for(var Ze=1<<yt.b,Pt=Ze-1,ht=Oe(He,yt.b),sr=yt.K,yt=yt.w+($e>>yt.b)*ht;$e<Te;){var xr=sr,ms=yt,nr=1;for(ti(be,Ce,Ue,qe-He,1,Ue,qe);nr<He;){var xt=(nr&~Pt)+Ze;xt>He&&(xt=He),(0,$o[xr[ms++]>>8&15])(be,Ce+ +nr,Ue,qe+nr-He,xt-nr,Ue,qe+nr),nr=xt}Ce+=He,qe+=He,++$e&Pt||(yt+=ht)}Ie!=fe.nc&&a(me,pe-Ee,me,pe+(Ie-Se-1)*Ee,Ee);break;case 1:for(Ee=be,Te=Ce,He=(be=fe.Ea)-(qe=be&~(Ue=(Ce=1<<fe.b)-1)),$e=Oe(be,fe.b),Ze=fe.K,fe=fe.w+(Se>>fe.b)*$e;Se<Ie;){for(Pt=Ze,ht=fe,sr=new kt,yt=Te+qe,xr=Te+be;Te<yt;)wt(Pt[ht++],sr),wl(sr,Ee,Te,Ce,me,pe),Te+=Ce,pe+=Ce;Te<xr&&(wt(Pt[ht++],sr),wl(sr,Ee,Te,He,me,pe),Te+=He,pe+=He),++Se&Ue||(fe+=$e)}break;case 3:if(be==me&&Ce==pe&&0<fe.b){for(Te=me,be=Ee=pe+(Ie-Se)*Ee-(qe=(Ie-Se)*Oe(fe.Ea,fe.b)),Ce=me,Ue=pe,$e=[],qe=(He=qe)-1;0<=qe;--qe)$e[qe]=Ce[Ue+qe];for(qe=He-1;0<=qe;--qe)Te[be+qe]=$e[qe];Uo(fe,Se,Ie,me,Ee,me,pe)}else Uo(fe,Se,Ie,be,Ce,me,pe)}pe=G,me=M}me!=M&&a(G,M,pe,me,le)}function Ki(y,w){var M=y.V,G=y.Ba+y.c*y.C,se=w-y.C;if(t(w<=y.l.o),t(16>=se),0<se){var le=y.l,de=y.Ta,pe=y.Ua,me=le.width;if(tn(y,se,M,G),se=pe=[pe],t((M=y.C)<(G=w)),t(le.v<le.va),G>le.o&&(G=le.o),M<le.j){var fe=le.j-M;M=le.j,se[0]+=fe*me}if(M>=G?M=0:(se[0]+=4*le.v,le.ka=M-le.j,le.U=le.va-le.v,le.T=G-M,M=1),M){if(pe=pe[0],11>(M=y.ca).S){var Se=M.f.RGBA,Ie=(G=M.S,se=le.U,le=le.T,fe=Se.eb,Se.A),be=le;for(Se=Se.fb+y.Ma*Se.A;0<be--;){var Ce=de,Ee=pe,$e=se,Te=fe,Ue=Se;switch(G){case kd:Sl(Ce,Ee,$e,Te,Ue);break;case no:zi(Ce,Ee,$e,Te,Ue);break;case Al:zi(Ce,Ee,$e,Te,Ue),Zo(Te,Ue,0,$e,1,0);break;case Xp:Bo(Ce,Ee,$e,Te,Ue);break;case jc:Et(Ce,Ee,$e,Te,Ue,1);break;case Wo:Et(Ce,Ee,$e,Te,Ue,1),Zo(Te,Ue,0,$e,1,0);break;case _c:Et(Ce,Ee,$e,Te,Ue,0);break;case kc:Et(Ce,Ee,$e,Te,Ue,0),Zo(Te,Ue,1,$e,1,0);break;case Ur:ro(Ce,Ee,$e,Te,Ue);break;case Nc:ro(Ce,Ee,$e,Te,Ue),Au(Te,Ue,$e,1,0);break;case Nd:so(Ce,Ee,$e,Te,Ue);break;default:t(0)}pe+=me,Se+=Ie}y.Ma+=le}else alert("todo:EmitRescaledRowsYUVA");t(y.Ma<=M.height)}}y.C=w,t(y.C<=y.i)}function zn(y){var w;if(0<y.ua)return 0;for(w=0;w<y.Wb;++w){var M=y.Ya[w].G,G=y.Ya[w].H;if(0<M[1][G[1]+0].g||0<M[2][G[2]+0].g||0<M[3][G[3]+0].g)return 0}return 1}function Wn(y,w,M,G,se,le){if(y.Z!=0){var de=y.qd,pe=y.rd;for(t(ia[y.Z]!=null);w<M;++w)ia[y.Z](de,pe,G,se,G,se,le),de=G,pe=se,se+=le;y.qd=de,y.rd=pe}}function Ys(y,w){var M=y.l.ma,G=M.Z==0||M.Z==1?y.l.j:y.C;if(G=y.C<G?G:y.C,t(w<=y.l.o),w>G){var se=y.l.width,le=M.ca,de=M.tb+se*G,pe=y.V,me=y.Ba+y.c*G,fe=y.gc;t(y.ab==1),t(fe[0].hc==3),In(fe[0],G,w,pe,me,le,de),Wn(M,G,w,le,de,se)}y.C=y.Ma=w}function rn(y,w,M,G,se,le,de){var pe=y.$/G,me=y.$%G,fe=y.m,Se=y.s,Ie=M+y.$,be=Ie;se=M+G*se;var Ce=M+G*le,Ee=280+Se.ua,$e=y.Pb?pe:16777216,Te=0<Se.ua?Se.Wa:null,Ue=Se.wc,qe=Ie<Ce?mr(Se,me,pe):null;t(y.C<le),t(Ce<=se);var He=!1;e:for(;;){for(;He||Ie<Ce;){var Ze=0;if(pe>=$e){var Pt=Ie-M;t(($e=y).Pb),$e.wd=$e.m,$e.xd=Pt,0<$e.s.ua&&je($e.s.Wa,$e.s.vb),$e=pe+Sd}if(me&Ue||(qe=mr(Se,me,pe)),t(qe!=null),qe.Qb&&(w[Ie]=qe.qb,He=!0),!He)if(H(fe),qe.jc){Ze=fe,Pt=w;var ht=Ie,sr=qe.pd[q(Ze)&un-1];t(qe.jc),256>sr.g?(Y(Ze,Ze.u+sr.g),Pt[ht]=sr.value,Ze=0):(Y(Ze,Ze.u+sr.g-256),t(256<=sr.value),Ze=sr.value),Ze==0&&(He=!0)}else Ze=gr(qe.G[0],qe.H[0],fe);if(fe.h)break;if(He||256>Ze){if(!He)if(qe.nd)w[Ie]=(qe.qb|Ze<<8)>>>0;else{if(H(fe),He=gr(qe.G[1],qe.H[1],fe),H(fe),Pt=gr(qe.G[2],qe.H[2],fe),ht=gr(qe.G[3],qe.H[3],fe),fe.h)break;w[Ie]=(ht<<24|He<<16|Ze<<8|Pt)>>>0}if(He=!1,++Ie,++me>=G&&(me=0,++pe,de!=null&&pe<=le&&!(pe%16)&&de(y,pe),Te!=null))for(;be<Ie;)Ze=w[be++],Te.X[(506832829*Ze&4294967295)>>>Te.Mb]=Ze}else if(280>Ze){if(Ze=nt(Ze-256,fe),Pt=gr(qe.G[4],qe.H[4],fe),H(fe),Pt=Nr(G,Pt=nt(Pt,fe)),fe.h)break;if(Ie-M<Pt||se-Ie<Ze)break e;for(ht=0;ht<Ze;++ht)w[Ie+ht]=w[Ie+ht-Pt];for(Ie+=Ze,me+=Ze;me>=G;)me-=G,++pe,de!=null&&pe<=le&&!(pe%16)&&de(y,pe);if(t(Ie<=se),me&Ue&&(qe=mr(Se,me,pe)),Te!=null)for(;be<Ie;)Ze=w[be++],Te.X[(506832829*Ze&4294967295)>>>Te.Mb]=Ze}else{if(!(Ze<Ee))break e;for(He=Ze-280,t(Te!=null);be<Ie;)Ze=w[be++],Te.X[(506832829*Ze&4294967295)>>>Te.Mb]=Ze;Ze=Ie,t(!(He>>>(Pt=Te).Xa)),w[Ze]=Pt.X[He],He=!0}He||t(fe.h==I(fe))}if(y.Pb&&fe.h&&Ie<se)t(y.m.h),y.a=5,y.m=y.wd,y.$=y.xd,0<y.s.ua&&je(y.s.vb,y.s.Wa);else{if(fe.h)break e;de!=null&&de(y,pe>le?le:pe),y.a=0,y.$=Ie-M}return 1}return y.a=3,0}function qa(y){t(y!=null),y.vc=null,y.yc=null,y.Ya=null;var w=y.Wa;w!=null&&(w.X=null),y.vb=null,t(y!=null)}function _o(){var y=new Ct;return y==null?null:(y.a=0,y.xb=Dl,or("Predictor","VP8LPredictors"),or("Predictor","VP8LPredictors_C"),or("PredictorAdd","VP8LPredictorsAdd"),or("PredictorAdd","VP8LPredictorsAdd_C"),vs=Vt,wl=Nt,Sl=jr,zi=Zt,ro=ct,so=Ut,Bo=dr,A.VP8LMapColor32b=ri,A.VP8LMapColor8b=qo,y)}function Cn(y,w,M,G,se){var le=1,de=[y],pe=[w],me=G.m,fe=G.s,Se=null,Ie=0;e:for(;;){if(M)for(;le&&J(me,1);){var be=de,Ce=pe,Ee=G,$e=1,Te=Ee.m,Ue=Ee.gc[Ee.ab],qe=J(Te,2);if(Ee.Oc&1<<qe)le=0;else{switch(Ee.Oc|=1<<qe,Ue.hc=qe,Ue.Ea=be[0],Ue.nc=Ce[0],Ue.K=[null],++Ee.ab,t(4>=Ee.ab),qe){case 0:case 1:Ue.b=J(Te,3)+2,$e=Cn(Oe(Ue.Ea,Ue.b),Oe(Ue.nc,Ue.b),0,Ee,Ue.K),Ue.K=Ue.K[0];break;case 3:var He,Ze=J(Te,8)+1,Pt=16<Ze?0:4<Ze?1:2<Ze?2:3;if(be[0]=Oe(Ue.Ea,Pt),Ue.b=Pt,He=$e=Cn(Ze,1,0,Ee,Ue.K)){var ht,sr=Ze,yt=Ue,xr=1<<(8>>yt.b),ms=i(xr);if(ms==null)He=0;else{var nr=yt.K[0],xt=yt.w;for(ms[0]=yt.K[0][0],ht=1;ht<1*sr;++ht)ms[ht]=Je(nr[xt+ht],ms[ht-1]);for(;ht<4*xr;++ht)ms[ht]=0;yt.K[0]=null,yt.K[0]=ms,He=1}}$e=He;break;case 2:break;default:t(0)}le=$e}}if(de=de[0],pe=pe[0],le&&J(me,1)&&!(le=1<=(Ie=J(me,4))&&11>=Ie)){G.a=3;break e}var at;if(at=le)t:{var ys,Wt,hr,Kr=G,Vs=de,Os=pe,ns=Ie,Rs=M,Hs=Kr.m,Qr=Kr.s,br=[null],zr=1,es=0,Cr=em[ns];r:for(;;){if(Rs&&J(Hs,1)){var hs=J(Hs,3)+2,xs=Oe(Vs,hs),qr=Oe(Os,hs),oa=xs*qr;if(!Cn(xs,qr,0,Kr,br))break r;for(br=br[0],Qr.xc=hs,ys=0;ys<oa;++ys){var Fr=br[ys]>>8&65535;br[ys]=Fr,Fr>=zr&&(zr=Fr+1)}}if(Hs.h)break r;for(Wt=0;5>Wt;++Wt){var $r=Ko[Wt];!Wt&&0<ns&&($r+=1<<ns),es<$r&&(es=$r)}var Ds=o(zr*Cr,Z),Qs=zr,Oa=o(Qs,ce);if(Oa==null)var js=null;else t(65536>=Qs),js=Oa;var _s=i(es);if(js==null||_s==null||Ds==null){Kr.a=1;break r}var la=Ds;for(ys=hr=0;ys<zr;++ys){var Br=js[ys],ca=Br.G,hn=Br.H,Rn=0,Zs=1,ks=0;for(Wt=0;5>Wt;++Wt){$r=Ko[Wt],ca[Wt]=la,hn[Wt]=hr,!Wt&&0<ns&&($r+=1<<ns);a:{var lo,Oi=$r,Ll=Kr,ni=_s,nm=la,$u=hr,Jr=0,Mn=Ll.m,Bu=J(Mn,1);if(n(ni,0,0,Oi),Bu){var Vu=J(Mn,1)+1,Cd=J(Mn,1),Pd=J(Mn,Cd==0?1:8);ni[Pd]=1,Vu==2&&(ni[Pd=J(Mn,8)]=1);var ii=1}else{var ts=i(19),Es=J(Mn,4)+4;if(19<Es){Ll.a=3;var Ns=0;break a}for(lo=0;lo<Es;++lo)ts[fx[lo]]=J(Mn,3);var Tl=void 0,Di=void 0,Rl=Ll,_x=ts,Ms=Oi,Ad=ni,Pc=0,oi=Rl.m,Fn=8,Ka=o(128,Z);s:for(;O(Ka,0,7,_x,19);){if(J(oi,1)){var Ac=2+2*J(oi,3);if((Tl=2+J(oi,Ac))>Ms)break s}else Tl=Ms;for(Di=0;Di<Ms&&Tl--;){H(oi);var Od=Ka[0+(127&q(oi))];Y(oi,oi.u+Od.g);var co=Od.value;if(16>co)Ad[Di++]=co,co!=0&&(Fn=co);else{var im=co==16,Hu=co-16,om=wd[Hu],Zu=J(oi,wc[Hu])+om;if(Di+Zu>Ms)break s;for(var lm=im?Fn:0;0<Zu--;)Ad[Di++]=lm}}Pc=1;break s}Pc||(Rl.a=3),ii=Pc}(ii=ii&&!Mn.h)&&(Jr=O(nm,$u,8,ni,Oi)),ii&&Jr!=0?Ns=Jr:(Ll.a=3,Ns=0)}if(Ns==0)break r;if(Zs&&Qp[Wt]==1&&(Zs=la[hr].g==0),Rn+=la[hr].g,hr+=Ns,3>=Wt){var Ml,Dd=_s[0];for(Ml=1;Ml<$r;++Ml)_s[Ml]>Dd&&(Dd=_s[Ml]);ks+=Dd}}if(Br.nd=Zs,Br.Qb=0,Zs&&(Br.qb=(ca[3][hn[3]+0].value<<24|ca[1][hn[1]+0].value<<16|ca[2][hn[2]+0].value)>>>0,Rn==0&&256>ca[0][hn[0]+0].value&&(Br.Qb=1,Br.qb+=ca[0][hn[0]+0].value<<8)),Br.jc=!Br.Qb&&6>ks,Br.jc){var Oc,Ga=Br;for(Oc=0;Oc<un;++Oc){var Ei=Oc,Un=Ga.pd[Ei],Qo=Ga.G[0][Ga.H[0]+Ei];256<=Qo.value?(Un.g=Qo.g+256,Un.value=Qo.value):(Un.g=0,Un.value=0,Ei>>=Gr(Qo,8,Un),Ei>>=Gr(Ga.G[1][Ga.H[1]+Ei],16,Un),Ei>>=Gr(Ga.G[2][Ga.H[2]+Ei],0,Un),Gr(Ga.G[3][Ga.H[3]+Ei],24,Un))}}}Qr.vc=br,Qr.Wb=zr,Qr.Ya=js,Qr.yc=Ds,at=1;break t}at=0}if(!(le=at)){G.a=3;break e}if(0<Ie){if(fe.ua=1<<Ie,!ue(fe.Wa,Ie)){G.a=1,le=0;break e}}else fe.ua=0;var Ed=G,Id=de,cm=pe,Ld=Ed.s,Td=Ld.xc;if(Ed.c=Id,Ed.i=cm,Ld.md=Oe(Id,Td),Ld.wc=Td==0?-1:(1<<Td)-1,M){G.xb=ai;break e}if((Se=i(de*pe))==null){G.a=1,le=0;break e}le=(le=rn(G,Se,0,de,pe,pe,null))&&!me.h;break e}return le?(se!=null?se[0]=Se:(t(Se==null),t(M)),G.$=0,M||qa(fe)):qa(fe),le}function Gi(y,w){var M=y.c*y.i,G=M+w+16*w;return t(y.c<=w),y.V=i(G),y.V==null?(y.Ta=null,y.Ua=0,y.a=1,0):(y.Ta=y.V,y.Ua=y.Ba+M+w,1)}function ko(y,w){var M=y.C,G=w-M,se=y.V,le=y.Ba+y.c*M;for(t(w<=y.l.o);0<G;){var de=16<G?16:G,pe=y.l.ma,me=y.l.width,fe=me*de,Se=pe.ca,Ie=pe.tb+me*M,be=y.Ta,Ce=y.Ua;tn(y,de,se,le),Ou(be,Ce,Se,Ie,fe),Wn(pe,M,M+de,Se,Ie,me),G-=de,se+=de*y.c,M+=de}t(M==w),y.C=y.Ma=w}function No(){this.ub=this.yd=this.td=this.Rb=0}function hl(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Su(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function Yr(){this.Yb=(function(){var y=[];return(function w(M,G,se){for(var le=se[G],de=0;de<le&&(M.push(se.length>G+1?[]:0),!(se.length<G+1));de++)w(M[de],G+1,se)})(y,0,[3,11]),y})()}function dd(){this.jb=i(3),this.Wc=c([4,8],Yr),this.Xc=c([4,17],Yr)}function xl(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function $a(){this.ld=this.La=this.dd=this.tc=0}function Yi(){this.Na=this.la=0}function ud(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function fl(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function wo(){this.uc=this.M=this.Nb=0,this.wa=Array(new $a),this.Y=0,this.ya=Array(new fl),this.aa=0,this.l=new sa}function Ba(){this.y=i(16),this.f=i(8),this.ea=i(8)}function pd(){this.cb=this.a=0,this.sc="",this.m=new $,this.Od=new No,this.Kc=new hl,this.ed=new xl,this.Qa=new Su,this.Ic=this.$c=this.Aa=0,this.D=new wo,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,$),this.ia=0,this.pb=o(4,ud),this.Pa=new dd,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Ba),this.Hd=0,this.rb=Array(new Yi),this.sb=0,this.wa=Array(new $a),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new fl),this.L=this.aa=0,this.gd=c([4,2],$a),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function sa(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function zu(){var y=new pd;return y!=null&&(y.a=0,y.sc="OK",y.cb=0,y.Xb=0,Go||(Go=sn)),y}function Cs(y,w,M){return y.a==0&&(y.a=w,y.sc=M,y.cb=0),0}function md(y,w,M){return 3<=M&&y[w+0]==157&&y[w+1]==1&&y[w+2]==42}function So(y,w){if(y==null)return 0;if(y.a=0,y.sc="OK",w==null)return Cs(y,2,"null VP8Io passed to VP8GetHeaders()");var M=w.data,G=w.w,se=w.ha;if(4>se)return Cs(y,7,"Truncated header.");var le=M[G+0]|M[G+1]<<8|M[G+2]<<16,de=y.Od;if(de.Rb=!(1&le),de.td=le>>1&7,de.yd=le>>4&1,de.ub=le>>5,3<de.td)return Cs(y,3,"Incorrect keyframe parameters.");if(!de.yd)return Cs(y,4,"Frame not displayable.");G+=3,se-=3;var pe=y.Kc;if(de.Rb){if(7>se)return Cs(y,7,"cannot parse picture header");if(!md(M,G,se))return Cs(y,3,"Bad code word");pe.c=16383&(M[G+4]<<8|M[G+3]),pe.Td=M[G+4]>>6,pe.i=16383&(M[G+6]<<8|M[G+5]),pe.Ud=M[G+6]>>6,G+=7,se-=7,y.za=pe.c+15>>4,y.Ub=pe.i+15>>4,w.width=pe.c,w.height=pe.i,w.Da=0,w.j=0,w.v=0,w.va=w.width,w.o=w.height,w.da=0,w.ib=w.width,w.hb=w.height,w.U=w.width,w.T=w.height,n((le=y.Pa).jb,0,255,le.jb.length),t((le=y.Qa)!=null),le.Cb=0,le.Bb=0,le.Fb=1,n(le.Zb,0,0,le.Zb.length),n(le.Lb,0,0,le.Lb)}if(de.ub>se)return Cs(y,7,"bad partition length");re(le=y.m,M,G,de.ub),G+=de.ub,se-=de.ub,de.Rb&&(pe.Ld=ge(le),pe.Kd=ge(le)),pe=y.Qa;var me,fe=y.Pa;if(t(le!=null),t(pe!=null),pe.Cb=ge(le),pe.Cb){if(pe.Bb=ge(le),ge(le)){for(pe.Fb=ge(le),me=0;4>me;++me)pe.Zb[me]=ge(le)?U(le,7):0;for(me=0;4>me;++me)pe.Lb[me]=ge(le)?U(le,6):0}if(pe.Bb)for(me=0;3>me;++me)fe.jb[me]=ge(le)?X(le,8):255}else pe.Bb=0;if(le.Ka)return Cs(y,3,"cannot parse segment header");if((pe=y.ed).zd=ge(le),pe.Tb=X(le,6),pe.wb=X(le,3),pe.Pc=ge(le),pe.Pc&&ge(le)){for(fe=0;4>fe;++fe)ge(le)&&(pe.vd[fe]=U(le,6));for(fe=0;4>fe;++fe)ge(le)&&(pe.od[fe]=U(le,6))}if(y.L=pe.Tb==0?0:pe.zd?1:2,le.Ka)return Cs(y,3,"cannot parse filter header");var Se=se;if(se=me=G,G=me+Se,pe=Se,y.Xb=(1<<X(y.m,2))-1,Se<3*(fe=y.Xb))M=7;else{for(me+=3*fe,pe-=3*fe,Se=0;Se<fe;++Se){var Ie=M[se+0]|M[se+1]<<8|M[se+2]<<16;Ie>pe&&(Ie=pe),re(y.Jc[+Se],M,me,Ie),me+=Ie,pe-=Ie,se+=3}re(y.Jc[+fe],M,me,pe),M=me<G?0:5}if(M!=0)return Cs(y,M,"cannot parse partitions");for(M=X(me=y.m,7),se=ge(me)?U(me,4):0,G=ge(me)?U(me,4):0,pe=ge(me)?U(me,4):0,fe=ge(me)?U(me,4):0,me=ge(me)?U(me,4):0,Se=y.Qa,Ie=0;4>Ie;++Ie){if(Se.Cb){var be=Se.Zb[Ie];Se.Fb||(be+=M)}else{if(0<Ie){y.pb[Ie]=y.pb[0];continue}be=M}var Ce=y.pb[Ie];Ce.Sc[0]=Ol[ds(be+se,127)],Ce.Sc[1]=Sc[ds(be+0,127)],Ce.Eb[0]=2*Ol[ds(be+G,127)],Ce.Eb[1]=101581*Sc[ds(be+pe,127)]>>16,8>Ce.Eb[1]&&(Ce.Eb[1]=8),Ce.Qc[0]=Ol[ds(be+fe,117)],Ce.Qc[1]=Sc[ds(be+me,127)],Ce.lc=be+me}if(!de.Rb)return Cs(y,4,"Not a key frame.");for(ge(le),de=y.Pa,M=0;4>M;++M){for(se=0;8>se;++se)for(G=0;3>G;++G)for(pe=0;11>pe;++pe)fe=K(le,vx[M][se][G][pe])?X(le,8):rm[M][se][G][pe],de.Wc[M][se].Yb[G][pe]=fe;for(se=0;17>se;++se)de.Xc[M][se]=de.Wc[M][Fu[se]]}return y.kc=ge(le),y.kc&&(y.Bd=X(le,8)),y.cb=1}function sn(y,w,M,G,se,le,de){var pe=w[se].Yb[M];for(M=0;16>se;++se){if(!K(y,pe[M+0]))return se;for(;!K(y,pe[M+1]);)if(pe=w[++se].Yb[0],M=0,se==16)return 16;var me=w[se+1].Yb;if(K(y,pe[M+2])){var fe=y,Se=0;if(K(fe,(be=pe)[(Ie=M)+3]))if(K(fe,be[Ie+6])){for(pe=0,Ie=2*(Se=K(fe,be[Ie+8]))+(be=K(fe,be[Ie+9+Se])),Se=0,be=Ru[Ie];be[pe];++pe)Se+=Se+K(fe,be[pe]);Se+=3+(8<<Ie)}else K(fe,be[Ie+7])?(Se=7+2*K(fe,165),Se+=K(fe,145)):Se=5+K(fe,159);else Se=K(fe,be[Ie+4])?3+K(fe,be[Ie+5]):2;pe=me[2]}else Se=1,pe=me[1];me=de+Mu[se],0>(fe=y).b&&he(fe);var Ie,be=fe.b,Ce=(Ie=fe.Ca>>1)-(fe.I>>be)>>31;--fe.b,fe.Ca+=Ce,fe.Ca|=1,fe.I-=(Ie+1&Ce)<<be,le[me]=((Se^Ce)-Ce)*G[(0<se)+0]}return 16}function Pn(y){var w=y.rb[y.sb-1];w.la=0,w.Na=0,n(y.zc,0,0,y.zc.length),y.ja=0}function ka(y,w,M,G,se){se=y[w+M+32*G]+(se>>3),y[w+M+32*G]=-256&se?0>se?0:255:se}function zo(y,w,M,G,se,le){ka(y,w,0,M,G+se),ka(y,w,1,M,G+le),ka(y,w,2,M,G-le),ka(y,w,3,M,G-se)}function bs(y){return(20091*y>>16)+y}function Co(y,w,M,G){var se,le=0,de=i(16);for(se=0;4>se;++se){var pe=y[w+0]+y[w+8],me=y[w+0]-y[w+8],fe=(35468*y[w+4]>>16)-bs(y[w+12]),Se=bs(y[w+4])+(35468*y[w+12]>>16);de[le+0]=pe+Se,de[le+1]=me+fe,de[le+2]=me-fe,de[le+3]=pe-Se,le+=4,w++}for(se=le=0;4>se;++se)pe=(y=de[le+0]+4)+de[le+8],me=y-de[le+8],fe=(35468*de[le+4]>>16)-bs(de[le+12]),ka(M,G,0,0,pe+(Se=bs(de[le+4])+(35468*de[le+12]>>16))),ka(M,G,1,0,me+fe),ka(M,G,2,0,me-fe),ka(M,G,3,0,pe-Se),le++,G+=32}function hd(y,w,M,G){var se=y[w+0]+4,le=35468*y[w+4]>>16,de=bs(y[w+4]),pe=35468*y[w+1]>>16;zo(M,G,0,se+de,y=bs(y[w+1]),pe),zo(M,G,1,se+le,y,pe),zo(M,G,2,se-le,y,pe),zo(M,G,3,se-de,y,pe)}function cc(y,w,M,G,se){Co(y,w,M,G),se&&Co(y,w+16,M,G+4)}function Po(y,w,M,G){Vo(y,w+0,M,G,1),Vo(y,w+32,M,G+128,1)}function Kn(y,w,M,G){var se;for(y=y[w+0]+4,se=0;4>se;++se)for(w=0;4>w;++w)ka(M,G,w,se,y)}function bl(y,w,M,G){y[w+0]&&Sr(y,w+0,M,G),y[w+16]&&Sr(y,w+16,M,G+4),y[w+32]&&Sr(y,w+32,M,G+128),y[w+48]&&Sr(y,w+48,M,G+128+4)}function yr(y,w,M,G){var se,le=i(16);for(se=0;4>se;++se){var de=y[w+0+se]+y[w+12+se],pe=y[w+4+se]+y[w+8+se],me=y[w+4+se]-y[w+8+se],fe=y[w+0+se]-y[w+12+se];le[0+se]=de+pe,le[8+se]=de-pe,le[4+se]=fe+me,le[12+se]=fe-me}for(se=0;4>se;++se)de=(y=le[0+4*se]+3)+le[3+4*se],pe=le[1+4*se]+le[2+4*se],me=le[1+4*se]-le[2+4*se],fe=y-le[3+4*se],M[G+0]=de+pe>>3,M[G+16]=fe+me>>3,M[G+32]=de-pe>>3,M[G+48]=fe-me>>3,G+=64}function vi(y,w,M){var G,se=w-32,le=xa,de=255-y[se-1];for(G=0;G<M;++G){var pe,me=le,fe=de+y[w-1];for(pe=0;pe<M;++pe)y[w+pe]=me[fe+y[se+pe]];w+=32}}function gl(y,w){vi(y,w,4)}function dc(y,w){vi(y,w,8)}function xd(y,w){vi(y,w,16)}function fd(y,w){var M;for(M=0;16>M;++M)a(y,w+32*M,y,w-32,16)}function vl(y,w){var M;for(M=16;0<M;--M)n(y,w,y[w-1],16),w+=32}function yi(y,w,M){var G;for(G=0;16>G;++G)n(w,M+32*G,y,16)}function An(y,w){var M,G=16;for(M=0;16>M;++M)G+=y[w-1+32*M]+y[w+M-32];yi(G>>5,y,w)}function Gn(y,w){var M,G=8;for(M=0;16>M;++M)G+=y[w-1+32*M];yi(G>>4,y,w)}function Na(y,w){var M,G=8;for(M=0;16>M;++M)G+=y[w+M-32];yi(G>>4,y,w)}function an(y,w){yi(128,y,w)}function Ht(y,w,M){return y+2*w+M+2>>2}function Ao(y,w){var M,G=w-32;for(G=new Uint8Array([Ht(y[G-1],y[G+0],y[G+1]),Ht(y[G+0],y[G+1],y[G+2]),Ht(y[G+1],y[G+2],y[G+3]),Ht(y[G+2],y[G+3],y[G+4])]),M=0;4>M;++M)a(y,w+32*M,G,0,G.length)}function Yn(y,w){var M=y[w-1],G=y[w-1+32],se=y[w-1+64],le=y[w-1+96];T(y,w+0,16843009*Ht(y[w-1-32],M,G)),T(y,w+32,16843009*Ht(M,G,se)),T(y,w+64,16843009*Ht(G,se,le)),T(y,w+96,16843009*Ht(se,le,le))}function Cu(y,w){var M,G=4;for(M=0;4>M;++M)G+=y[w+M-32]+y[w-1+32*M];for(G>>=3,M=0;4>M;++M)n(y,w+32*M,G,4)}function bd(y,w){var M=y[w-1+0],G=y[w-1+32],se=y[w-1+64],le=y[w-1-32],de=y[w+0-32],pe=y[w+1-32],me=y[w+2-32],fe=y[w+3-32];y[w+0+96]=Ht(G,se,y[w-1+96]),y[w+1+96]=y[w+0+64]=Ht(M,G,se),y[w+2+96]=y[w+1+64]=y[w+0+32]=Ht(le,M,G),y[w+3+96]=y[w+2+64]=y[w+1+32]=y[w+0+0]=Ht(de,le,M),y[w+3+64]=y[w+2+32]=y[w+1+0]=Ht(pe,de,le),y[w+3+32]=y[w+2+0]=Ht(me,pe,de),y[w+3+0]=Ht(fe,me,pe)}function Va(y,w){var M=y[w+1-32],G=y[w+2-32],se=y[w+3-32],le=y[w+4-32],de=y[w+5-32],pe=y[w+6-32],me=y[w+7-32];y[w+0+0]=Ht(y[w+0-32],M,G),y[w+1+0]=y[w+0+32]=Ht(M,G,se),y[w+2+0]=y[w+1+32]=y[w+0+64]=Ht(G,se,le),y[w+3+0]=y[w+2+32]=y[w+1+64]=y[w+0+96]=Ht(se,le,de),y[w+3+32]=y[w+2+64]=y[w+1+96]=Ht(le,de,pe),y[w+3+64]=y[w+2+96]=Ht(de,pe,me),y[w+3+96]=Ht(pe,me,me)}function ji(y,w){var M=y[w-1+0],G=y[w-1+32],se=y[w-1+64],le=y[w-1-32],de=y[w+0-32],pe=y[w+1-32],me=y[w+2-32],fe=y[w+3-32];y[w+0+0]=y[w+1+64]=le+de+1>>1,y[w+1+0]=y[w+2+64]=de+pe+1>>1,y[w+2+0]=y[w+3+64]=pe+me+1>>1,y[w+3+0]=me+fe+1>>1,y[w+0+96]=Ht(se,G,M),y[w+0+64]=Ht(G,M,le),y[w+0+32]=y[w+1+96]=Ht(M,le,de),y[w+1+32]=y[w+2+96]=Ht(le,de,pe),y[w+2+32]=y[w+3+96]=Ht(de,pe,me),y[w+3+32]=Ht(pe,me,fe)}function gd(y,w){var M=y[w+0-32],G=y[w+1-32],se=y[w+2-32],le=y[w+3-32],de=y[w+4-32],pe=y[w+5-32],me=y[w+6-32],fe=y[w+7-32];y[w+0+0]=M+G+1>>1,y[w+1+0]=y[w+0+64]=G+se+1>>1,y[w+2+0]=y[w+1+64]=se+le+1>>1,y[w+3+0]=y[w+2+64]=le+de+1>>1,y[w+0+32]=Ht(M,G,se),y[w+1+32]=y[w+0+96]=Ht(G,se,le),y[w+2+32]=y[w+1+96]=Ht(se,le,de),y[w+3+32]=y[w+2+96]=Ht(le,de,pe),y[w+3+64]=Ht(de,pe,me),y[w+3+96]=Ht(pe,me,fe)}function yl(y,w){var M=y[w-1+0],G=y[w-1+32],se=y[w-1+64],le=y[w-1+96];y[w+0+0]=M+G+1>>1,y[w+2+0]=y[w+0+32]=G+se+1>>1,y[w+2+32]=y[w+0+64]=se+le+1>>1,y[w+1+0]=Ht(M,G,se),y[w+3+0]=y[w+1+32]=Ht(G,se,le),y[w+3+32]=y[w+1+64]=Ht(se,le,le),y[w+3+64]=y[w+2+64]=y[w+0+96]=y[w+1+96]=y[w+2+96]=y[w+3+96]=le}function Oo(y,w){var M=y[w-1+0],G=y[w-1+32],se=y[w-1+64],le=y[w-1+96],de=y[w-1-32],pe=y[w+0-32],me=y[w+1-32],fe=y[w+2-32];y[w+0+0]=y[w+2+32]=M+de+1>>1,y[w+0+32]=y[w+2+64]=G+M+1>>1,y[w+0+64]=y[w+2+96]=se+G+1>>1,y[w+0+96]=le+se+1>>1,y[w+3+0]=Ht(pe,me,fe),y[w+2+0]=Ht(de,pe,me),y[w+1+0]=y[w+3+32]=Ht(M,de,pe),y[w+1+32]=y[w+3+64]=Ht(G,M,de),y[w+1+64]=y[w+3+96]=Ht(se,G,M),y[w+1+96]=Ht(le,se,G)}function uc(y,w){var M;for(M=0;8>M;++M)a(y,w+32*M,y,w-32,8)}function On(y,w){var M;for(M=0;8>M;++M)n(y,w,y[w-1],8),w+=32}function Jn(y,w,M){var G;for(G=0;8>G;++G)n(w,M+32*G,y,8)}function Dn(y,w){var M,G=8;for(M=0;8>M;++M)G+=y[w+M-32]+y[w-1+32*M];Jn(G>>4,y,w)}function jl(y,w){var M,G=4;for(M=0;8>M;++M)G+=y[w+M-32];Jn(G>>3,y,w)}function pc(y,w){var M,G=4;for(M=0;8>M;++M)G+=y[w-1+32*M];Jn(G>>3,y,w)}function mc(y,w){Jn(128,y,w)}function _i(y,w,M){var G=y[w-M],se=y[w+0],le=3*(se-G)+si[1020+y[w-2*M]-y[w+M]],de=Pl[112+(le+4>>3)];y[w-M]=xa[255+G+Pl[112+(le+3>>3)]],y[w+0]=xa[255+se-de]}function Xn(y,w,M,G){var se=y[w+0],le=y[w+M];return pn[255+y[w-2*M]-y[w-M]]>G||pn[255+le-se]>G}function Do(y,w,M,G){return 4*pn[255+y[w-M]-y[w+0]]+pn[255+y[w-2*M]-y[w+M]]<=G}function Eo(y,w,M,G,se){var le=y[w-3*M],de=y[w-2*M],pe=y[w-M],me=y[w+0],fe=y[w+M],Se=y[w+2*M],Ie=y[w+3*M];return 4*pn[255+pe-me]+pn[255+de-fe]>G?0:pn[255+y[w-4*M]-le]<=se&&pn[255+le-de]<=se&&pn[255+de-pe]<=se&&pn[255+Ie-Se]<=se&&pn[255+Se-fe]<=se&&pn[255+fe-me]<=se}function nn(y,w,M,G){var se=2*G+1;for(G=0;16>G;++G)Do(y,w+G,M,se)&&_i(y,w+G,M)}function ki(y,w,M,G){var se=2*G+1;for(G=0;16>G;++G)Do(y,w+G*M,1,se)&&_i(y,w+G*M,1)}function Io(y,w,M,G){var se;for(se=3;0<se;--se)nn(y,w+=4*M,M,G)}function hc(y,w,M,G){var se;for(se=3;0<se;--se)ki(y,w+=4,M,G)}function on(y,w,M,G,se,le,de,pe){for(le=2*le+1;0<se--;){if(Eo(y,w,M,le,de))if(Xn(y,w,M,pe))_i(y,w,M);else{var me=y,fe=w,Se=M,Ie=me[fe-2*Se],be=me[fe-Se],Ce=me[fe+0],Ee=me[fe+Se],$e=me[fe+2*Se],Te=27*(qe=si[1020+3*(Ce-be)+si[1020+Ie-Ee]])+63>>7,Ue=18*qe+63>>7,qe=9*qe+63>>7;me[fe-3*Se]=xa[255+me[fe-3*Se]+qe],me[fe-2*Se]=xa[255+Ie+Ue],me[fe-Se]=xa[255+be+Te],me[fe+0]=xa[255+Ce-Te],me[fe+Se]=xa[255+Ee-Ue],me[fe+2*Se]=xa[255+$e-qe]}w+=G}}function ln(y,w,M,G,se,le,de,pe){for(le=2*le+1;0<se--;){if(Eo(y,w,M,le,de))if(Xn(y,w,M,pe))_i(y,w,M);else{var me=y,fe=w,Se=M,Ie=me[fe-Se],be=me[fe+0],Ce=me[fe+Se],Ee=Pl[112+(4+($e=3*(be-Ie))>>3)],$e=Pl[112+($e+3>>3)],Te=Ee+1>>1;me[fe-2*Se]=xa[255+me[fe-2*Se]+Te],me[fe-Se]=xa[255+Ie+$e],me[fe+0]=xa[255+be-Ee],me[fe+Se]=xa[255+Ce-Te]}w+=G}}function xc(y,w,M,G,se,le){on(y,w,M,1,16,G,se,le)}function aa(y,w,M,G,se,le){on(y,w,1,M,16,G,se,le)}function cn(y,w,M,G,se,le){var de;for(de=3;0<de;--de)ln(y,w+=4*M,M,1,16,G,se,le)}function _l(y,w,M,G,se,le){var de;for(de=3;0<de;--de)ln(y,w+=4,1,M,16,G,se,le)}function D(y,w,M,G,se,le,de,pe){on(y,w,se,1,8,le,de,pe),on(M,G,se,1,8,le,de,pe)}function ae(y,w,M,G,se,le,de,pe){on(y,w,1,se,8,le,de,pe),on(M,G,1,se,8,le,de,pe)}function ve(y,w,M,G,se,le,de,pe){ln(y,w+4*se,se,1,8,le,de,pe),ln(M,G+4*se,se,1,8,le,de,pe)}function we(y,w,M,G,se,le,de,pe){ln(y,w+4,1,se,8,le,de,pe),ln(M,G+4,1,se,8,le,de,pe)}function Ae(){this.ba=new ur,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Qe,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Ve(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function We(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function vt(){this.ua=0,this.Wa=new ne,this.vb=new ne,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new ce,this.yc=new Z}function Ct(){this.xb=this.a=0,this.l=new sa,this.ca=new ur,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new Q,this.Pb=0,this.wd=new Q,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new vt,this.ab=0,this.gc=o(4,We),this.Oc=0}function Kt(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new sa,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Gt(y,w,M,G,se,le,de){for(y=y==null?0:y[w+0],w=0;w<de;++w)se[le+w]=y+M[G+w]&255,y=se[le+w]}function wr(y,w,M,G,se,le,de){var pe;if(y==null)Gt(null,null,M,G,se,le,de);else for(pe=0;pe<de;++pe)se[le+pe]=y[w+pe]+M[G+pe]&255}function as(y,w,M,G,se,le,de){if(y==null)Gt(null,null,M,G,se,le,de);else{var pe,me=y[w+0],fe=me,Se=me;for(pe=0;pe<de;++pe)fe=Se+(me=y[w+pe])-fe,Se=M[G+pe]+(-256&fe?0>fe?0:255:fe)&255,fe=me,se[le+pe]=Se}}function Ps(y,w,M,G){var se=w.width,le=w.o;if(t(y!=null&&w!=null),0>M||0>=G||M+G>le)return null;if(!y.Cc){if(y.ga==null){var de;if(y.ga=new Kt,(de=y.ga==null)||(de=w.width*w.o,t(y.Gb.length==0),y.Gb=i(de),y.Uc=0,y.Gb==null?de=0:(y.mb=y.Gb,y.nb=y.Uc,y.rc=null,de=1),de=!de),!de){de=y.ga;var pe=y.Fa,me=y.P,fe=y.qc,Se=y.mb,Ie=y.nb,be=me+1,Ce=fe-1,Ee=de.l;if(t(pe!=null&&Se!=null&&w!=null),ia[0]=null,ia[1]=Gt,ia[2]=wr,ia[3]=as,de.ca=Se,de.tb=Ie,de.c=w.width,de.i=w.height,t(0<de.c&&0<de.i),1>=fe)w=0;else if(de.$a=3&pe[me+0],de.Z=pe[me+0]>>2&3,de.Lc=pe[me+0]>>4&3,me=pe[me+0]>>6&3,0>de.$a||1<de.$a||4<=de.Z||1<de.Lc||me)w=0;else if(Ee.put=dt,Ee.ac=_r,Ee.bc=kr,Ee.ma=de,Ee.width=w.width,Ee.height=w.height,Ee.Da=w.Da,Ee.v=w.v,Ee.va=w.va,Ee.j=w.j,Ee.o=w.o,de.$a)e:{t(de.$a==1),w=_o();t:for(;;){if(w==null){w=0;break e}if(t(de!=null),de.mc=w,w.c=de.c,w.i=de.i,w.l=de.l,w.l.ma=de,w.l.width=de.c,w.l.height=de.i,w.a=0,oe(w.m,pe,be,Ce),!Cn(de.c,de.i,1,w,null)||(w.ab==1&&w.gc[0].hc==3&&zn(w.s)?(de.ic=1,pe=w.c*w.i,w.Ta=null,w.Ua=0,w.V=i(pe),w.Ba=0,w.V==null?(w.a=1,w=0):w=1):(de.ic=0,w=Gi(w,de.c)),!w))break t;w=1;break e}de.mc=null,w=0}else w=Ce>=de.c*de.i;de=!w}if(de)return null;y.ga.Lc!=1?y.Ga=0:G=le-M}t(y.ga!=null),t(M+G<=le);e:{if(w=(pe=y.ga).c,le=pe.l.o,pe.$a==0){if(be=y.rc,Ce=y.Vc,Ee=y.Fa,me=y.P+1+M*w,fe=y.mb,Se=y.nb+M*w,t(me<=y.P+y.qc),pe.Z!=0)for(t(ia[pe.Z]!=null),de=0;de<G;++de)ia[pe.Z](be,Ce,Ee,me,fe,Se,w),be=fe,Ce=Se,Se+=w,me+=w;else for(de=0;de<G;++de)a(fe,Se,Ee,me,w),be=fe,Ce=Se,Se+=w,me+=w;y.rc=be,y.Vc=Ce}else{if(t(pe.mc!=null),w=M+G,t((de=pe.mc)!=null),t(w<=de.i),de.C>=w)w=1;else if(pe.ic||dn(),pe.ic){pe=de.V,be=de.Ba,Ce=de.c;var $e=de.i,Te=(Ee=1,me=de.$/Ce,fe=de.$%Ce,Se=de.m,Ie=de.s,de.$),Ue=Ce*$e,qe=Ce*w,He=Ie.wc,Ze=Te<qe?mr(Ie,fe,me):null;t(Te<=Ue),t(w<=$e),t(zn(Ie));t:for(;;){for(;!Se.h&&Te<qe;){if(fe&He||(Ze=mr(Ie,fe,me)),t(Ze!=null),H(Se),256>($e=gr(Ze.G[0],Ze.H[0],Se)))pe[be+Te]=$e,++Te,++fe>=Ce&&(fe=0,++me<=w&&!(me%16)&&Ys(de,me));else{if(!(280>$e)){Ee=0;break t}$e=nt($e-256,Se);var Pt,ht=gr(Ze.G[4],Ze.H[4],Se);if(H(Se),!(Te>=(ht=Nr(Ce,ht=nt(ht,Se)))&&Ue-Te>=$e)){Ee=0;break t}for(Pt=0;Pt<$e;++Pt)pe[be+Te+Pt]=pe[be+Te+Pt-ht];for(Te+=$e,fe+=$e;fe>=Ce;)fe-=Ce,++me<=w&&!(me%16)&&Ys(de,me);Te<qe&&fe&He&&(Ze=mr(Ie,fe,me))}t(Se.h==I(Se))}Ys(de,me>w?w:me);break t}!Ee||Se.h&&Te<Ue?(Ee=0,de.a=Se.h?5:3):de.$=Te,w=Ee}else w=rn(de,de.V,de.Ba,de.c,de.i,w,ko);if(!w){G=0;break e}}M+G>=le&&(y.Cc=1),G=1}if(!G)return null;if(y.Cc&&((G=y.ga)!=null&&(G.mc=null),y.ga=null,0<y.Ga))return alert("todo:WebPDequantizeLevels"),null}return y.nb+M*se}function Wr(y,w,M,G,se,le){for(;0<se--;){var de,pe=y,me=w+(M?1:0),fe=y,Se=w+(M?0:3);for(de=0;de<G;++de){var Ie=fe[Se+4*de];Ie!=255&&(Ie*=32897,pe[me+4*de+0]=pe[me+4*de+0]*Ie>>23,pe[me+4*de+1]=pe[me+4*de+1]*Ie>>23,pe[me+4*de+2]=pe[me+4*de+2]*Ie>>23)}w+=le}}function Ts(y,w,M,G,se){for(;0<G--;){var le;for(le=0;le<M;++le){var de=y[w+2*le+0],pe=15&(fe=y[w+2*le+1]),me=4369*pe,fe=(240&fe|fe>>4)*me>>16;y[w+2*le+0]=(240&de|de>>4)*me>>16&240|(15&de|de<<4)*me>>16>>4&15,y[w+2*le+1]=240&fe|pe}w+=se}}function gs(y,w,M,G,se,le,de,pe){var me,fe,Se=255;for(fe=0;fe<se;++fe){for(me=0;me<G;++me){var Ie=y[w+me];le[de+4*me]=Ie,Se&=Ie}w+=M,de+=pe}return Se!=255}function Js(y,w,M,G,se){var le;for(le=0;le<se;++le)M[G+le]=y[w+le]>>8}function dn(){Zo=Wr,Au=Ts,yc=gs,Ou=Js}function wa(y,w,M){A[y]=function(G,se,le,de,pe,me,fe,Se,Ie,be,Ce,Ee,$e,Te,Ue,qe,He){var Ze,Pt=He-1>>1,ht=pe[me+0]|fe[Se+0]<<16,sr=Ie[be+0]|Ce[Ee+0]<<16;t(G!=null);var yt=3*ht+sr+131074>>2;for(w(G[se+0],255&yt,yt>>16,$e,Te),le!=null&&(yt=3*sr+ht+131074>>2,w(le[de+0],255&yt,yt>>16,Ue,qe)),Ze=1;Ze<=Pt;++Ze){var xr=pe[me+Ze]|fe[Se+Ze]<<16,ms=Ie[be+Ze]|Ce[Ee+Ze]<<16,nr=ht+xr+sr+ms+524296,xt=nr+2*(xr+sr)>>3;yt=xt+ht>>1,ht=(nr=nr+2*(ht+ms)>>3)+xr>>1,w(G[se+2*Ze-1],255&yt,yt>>16,$e,Te+(2*Ze-1)*M),w(G[se+2*Ze-0],255&ht,ht>>16,$e,Te+(2*Ze-0)*M),le!=null&&(yt=nr+sr>>1,ht=xt+ms>>1,w(le[de+2*Ze-1],255&yt,yt>>16,Ue,qe+(2*Ze-1)*M),w(le[de+2*Ze+0],255&ht,ht>>16,Ue,qe+(2*Ze+0)*M)),ht=xr,sr=ms}1&He||(yt=3*ht+sr+131074>>2,w(G[se+He-1],255&yt,yt>>16,$e,Te+(He-1)*M),le!=null&&(yt=3*sr+ht+131074>>2,w(le[de+He-1],255&yt,yt>>16,Ue,qe+(He-1)*M)))}}function vd(){Ca[kd]=yx,Ca[no]=io,Ca[Xp]=jx,Ca[jc]=El,Ca[_c]=Yo,Ca[Ur]=zc,Ca[Nd]=Uu,Ca[Al]=io,Ca[Wo]=El,Ca[kc]=Yo,Ca[Nc]=zc}function Ji(y){return y&-16384?0>y?0:255:y>>oo}function Lo(y,w){return Ji((19077*y>>8)+(26149*w>>8)-14234)}function Xi(y,w,M){return Ji((19077*y>>8)-(6419*w>>8)-(13320*M>>8)+8708)}function To(y,w){return Ji((19077*y>>8)+(33050*w>>8)-17685)}function Qi(y,w,M,G,se){G[se+0]=Lo(y,M),G[se+1]=Xi(y,w,M),G[se+2]=To(y,w)}function Ro(y,w,M,G,se){G[se+0]=To(y,w),G[se+1]=Xi(y,w,M),G[se+2]=Lo(y,M)}function na(y,w,M,G,se){var le=Xi(y,w,M);w=le<<3&224|To(y,w)>>3,G[se+0]=248&Lo(y,M)|le>>5,G[se+1]=w}function Mo(y,w,M,G,se){var le=240&To(y,w)|15;G[se+0]=240&Lo(y,M)|Xi(y,w,M)>>4,G[se+1]=le}function Fo(y,w,M,G,se){G[se+0]=255,Qi(y,w,M,G,se+1)}function fc(y,w,M,G,se){Ro(y,w,M,G,se),G[se+3]=255}function bc(y,w,M,G,se){Qi(y,w,M,G,se),G[se+3]=255}function ds(y,w){return 0>y?0:y>w?w:y}function En(y,w,M){A[y]=function(G,se,le,de,pe,me,fe,Se,Ie){for(var be=Se+(-2&Ie)*M;Se!=be;)w(G[se+0],le[de+0],pe[me+0],fe,Se),w(G[se+1],le[de+0],pe[me+0],fe,Se+M),se+=2,++de,++me,Se+=2*M;1&Ie&&w(G[se+0],le[de+0],pe[me+0],fe,Se)}}function Qn(y,w,M){return M==0?y==0?w==0?6:5:w==0?4:0:M}function yd(y,w,M,G,se){switch(y>>>30){case 3:Vo(w,M,G,se,0);break;case 2:us(w,M,G,se);break;case 1:Sr(w,M,G,se)}}function Ha(y,w){var M,G,se=w.M,le=w.Nb,de=y.oc,pe=y.pc+40,me=y.oc,fe=y.pc+584,Se=y.oc,Ie=y.pc+600;for(M=0;16>M;++M)de[pe+32*M-1]=129;for(M=0;8>M;++M)me[fe+32*M-1]=129,Se[Ie+32*M-1]=129;for(0<se?de[pe-1-32]=me[fe-1-32]=Se[Ie-1-32]=129:(n(de,pe-32-1,127,21),n(me,fe-32-1,127,9),n(Se,Ie-32-1,127,9)),G=0;G<y.za;++G){var be=w.ya[w.aa+G];if(0<G){for(M=-1;16>M;++M)a(de,pe+32*M-4,de,pe+32*M+12,4);for(M=-1;8>M;++M)a(me,fe+32*M-4,me,fe+32*M+4,4),a(Se,Ie+32*M-4,Se,Ie+32*M+4,4)}var Ce=y.Gd,Ee=y.Hd+G,$e=be.ad,Te=be.Hc;if(0<se&&(a(de,pe-32,Ce[Ee].y,0,16),a(me,fe-32,Ce[Ee].f,0,8),a(Se,Ie-32,Ce[Ee].ea,0,8)),be.Za){var Ue=de,qe=pe-32+16;for(0<se&&(G>=y.za-1?n(Ue,qe,Ce[Ee].y[15],4):a(Ue,qe,Ce[Ee+1].y,0,4)),M=0;4>M;M++)Ue[qe+128+M]=Ue[qe+256+M]=Ue[qe+384+M]=Ue[qe+0+M];for(M=0;16>M;++M,Te<<=2)Ue=de,qe=pe+qu[M],mn[be.Ob[M]](Ue,qe),yd(Te,$e,16*+M,Ue,qe)}else if(Ue=Qn(G,se,be.Ob[0]),fa[Ue](de,pe),Te!=0)for(M=0;16>M;++M,Te<<=2)yd(Te,$e,16*+M,de,pe+qu[M]);for(M=be.Gc,Ue=Qn(G,se,be.Dd),za[Ue](me,fe),za[Ue](Se,Ie),Te=$e,Ue=me,qe=fe,255&(be=0|M)&&(170&be?Sa(Te,256,Ue,qe):Rr(Te,256,Ue,qe)),be=Se,Te=Ie,255&(M>>=8)&&(170&M?Sa($e,320,be,Te):Rr($e,320,be,Te)),se<y.Ub-1&&(a(Ce[Ee].y,0,de,pe+480,16),a(Ce[Ee].f,0,me,fe+224,8),a(Ce[Ee].ea,0,Se,Ie+224,8)),M=8*le*y.B,Ce=y.sa,Ee=y.ta+16*G+16*le*y.R,$e=y.qa,be=y.ra+8*G+M,Te=y.Ha,Ue=y.Ia+8*G+M,M=0;16>M;++M)a(Ce,Ee+M*y.R,de,pe+32*M,16);for(M=0;8>M;++M)a($e,be+M*y.B,me,fe+32*M,8),a(Te,Ue+M*y.B,Se,Ie+32*M,8)}}function eo(y,w,M,G,se,le,de,pe,me){var fe=[0],Se=[0],Ie=0,be=me!=null?me.kd:0,Ce=me??new Ve;if(y==null||12>M)return 7;Ce.data=y,Ce.w=w,Ce.ha=M,w=[w],M=[M],Ce.gb=[Ce.gb];e:{var Ee=w,$e=M,Te=Ce.gb;if(t(y!=null),t($e!=null),t(Te!=null),Te[0]=0,12<=$e[0]&&!r(y,Ee[0],"RIFF")){if(r(y,Ee[0]+8,"WEBP")){Te=3;break e}var Ue=ke(y,Ee[0]+4);if(12>Ue||4294967286<Ue){Te=3;break e}if(be&&Ue>$e[0]-8){Te=7;break e}Te[0]=Ue,Ee[0]+=12,$e[0]-=12}Te=0}if(Te!=0)return Te;for(Ue=0<Ce.gb[0],M=M[0];;){e:{var qe=y;$e=w,Te=M;var He=fe,Ze=Se,Pt=Ee=[0];if((yt=Ie=[Ie])[0]=0,8>Te[0])Te=7;else{if(!r(qe,$e[0],"VP8X")){if(ke(qe,$e[0]+4)!=10){Te=3;break e}if(18>Te[0]){Te=7;break e}var ht=ke(qe,$e[0]+8),sr=1+_e(qe,$e[0]+12);if(2147483648<=sr*(qe=1+_e(qe,$e[0]+15))){Te=3;break e}Pt!=null&&(Pt[0]=ht),He!=null&&(He[0]=sr),Ze!=null&&(Ze[0]=qe),$e[0]+=18,Te[0]-=18,yt[0]=1}Te=0}}if(Ie=Ie[0],Ee=Ee[0],Te!=0)return Te;if($e=!!(2&Ee),!Ue&&Ie)return 3;if(le!=null&&(le[0]=!!(16&Ee)),de!=null&&(de[0]=$e),pe!=null&&(pe[0]=0),de=fe[0],Ee=Se[0],Ie&&$e&&me==null){Te=0;break}if(4>M){Te=7;break}if(Ue&&Ie||!Ue&&!Ie&&!r(y,w[0],"ALPH")){M=[M],Ce.na=[Ce.na],Ce.P=[Ce.P],Ce.Sa=[Ce.Sa];e:{ht=y,Te=w,Ue=M;var yt=Ce.gb;He=Ce.na,Ze=Ce.P,Pt=Ce.Sa,sr=22,t(ht!=null),t(Ue!=null),qe=Te[0];var xr=Ue[0];for(t(He!=null),t(Pt!=null),He[0]=null,Ze[0]=null,Pt[0]=0;;){if(Te[0]=qe,Ue[0]=xr,8>xr){Te=7;break e}var ms=ke(ht,qe+4);if(4294967286<ms){Te=3;break e}var nr=8+ms+1&-2;if(sr+=nr,0<yt&&sr>yt){Te=3;break e}if(!r(ht,qe,"VP8 ")||!r(ht,qe,"VP8L")){Te=0;break e}if(xr[0]<nr){Te=7;break e}r(ht,qe,"ALPH")||(He[0]=ht,Ze[0]=qe+8,Pt[0]=ms),qe+=nr,xr-=nr}}if(M=M[0],Ce.na=Ce.na[0],Ce.P=Ce.P[0],Ce.Sa=Ce.Sa[0],Te!=0)break}M=[M],Ce.Ja=[Ce.Ja],Ce.xa=[Ce.xa];e:if(yt=y,Te=w,Ue=M,He=Ce.gb[0],Ze=Ce.Ja,Pt=Ce.xa,ht=Te[0],qe=!r(yt,ht,"VP8 "),sr=!r(yt,ht,"VP8L"),t(yt!=null),t(Ue!=null),t(Ze!=null),t(Pt!=null),8>Ue[0])Te=7;else{if(qe||sr){if(yt=ke(yt,ht+4),12<=He&&yt>He-12){Te=3;break e}if(be&&yt>Ue[0]-8){Te=7;break e}Ze[0]=yt,Te[0]+=8,Ue[0]-=8,Pt[0]=sr}else Pt[0]=5<=Ue[0]&&yt[ht+0]==47&&!(yt[ht+4]>>5),Ze[0]=Ue[0];Te=0}if(M=M[0],Ce.Ja=Ce.Ja[0],Ce.xa=Ce.xa[0],w=w[0],Te!=0)break;if(4294967286<Ce.Ja)return 3;if(pe==null||$e||(pe[0]=Ce.xa?2:1),de=[de],Ee=[Ee],Ce.xa){if(5>M){Te=7;break}pe=de,be=Ee,$e=le,y==null||5>M?y=0:5<=M&&y[w+0]==47&&!(y[w+4]>>5)?(Ue=[0],yt=[0],He=[0],oe(Ze=new Q,y,w,M),Ke(Ze,Ue,yt,He)?(pe!=null&&(pe[0]=Ue[0]),be!=null&&(be[0]=yt[0]),$e!=null&&($e[0]=He[0]),y=1):y=0):y=0}else{if(10>M){Te=7;break}pe=Ee,y==null||10>M||!md(y,w+3,M-3)?y=0:(be=y[w+0]|y[w+1]<<8|y[w+2]<<16,$e=16383&(y[w+7]<<8|y[w+6]),y=16383&(y[w+9]<<8|y[w+8]),1&be||3<(be>>1&7)||!(be>>4&1)||be>>5>=Ce.Ja||!$e||!y?y=0:(de&&(de[0]=$e),pe&&(pe[0]=y),y=1))}if(!y||(de=de[0],Ee=Ee[0],Ie&&(fe[0]!=de||Se[0]!=Ee)))return 3;me!=null&&(me[0]=Ce,me.offset=w-me.w,t(4294967286>w-me.w),t(me.offset==me.ha-M));break}return Te==0||Te==7&&Ie&&me==null?(le!=null&&(le[0]|=Ce.na!=null&&0<Ce.na.length),G!=null&&(G[0]=de),se!=null&&(se[0]=Ee),0):Te}function kl(y,w,M){var G=w.width,se=w.height,le=0,de=0,pe=G,me=se;if(w.Da=y!=null&&0<y.Da,w.Da&&(pe=y.cd,me=y.bd,le=y.v,de=y.j,11>M||(le&=-2,de&=-2),0>le||0>de||0>=pe||0>=me||le+pe>G||de+me>se))return 0;if(w.v=le,w.j=de,w.va=le+pe,w.o=de+me,w.U=pe,w.T=me,w.da=y!=null&&0<y.da,w.da){if(!Re(pe,me,M=[y.ib],le=[y.hb]))return 0;w.ib=M[0],w.hb=le[0]}return w.ob=y!=null&&y.ob,w.Kb=y==null||!y.Sd,w.da&&(w.ob=w.ib<3*G/4&&w.hb<3*se/4,w.Kb=0),1}function Nl(y){if(y==null)return 2;if(11>y.S){var w=y.f.RGBA;w.fb+=(y.height-1)*w.A,w.A=-w.A}else w=y.f.kb,y=y.height,w.O+=(y-1)*w.fa,w.fa=-w.fa,w.N+=(y-1>>1)*w.Ab,w.Ab=-w.Ab,w.W+=(y-1>>1)*w.Db,w.Db=-w.Db,w.F!=null&&(w.J+=(y-1)*w.lb,w.lb=-w.lb);return 0}function Ni(y,w,M,G){if(G==null||0>=y||0>=w)return 2;if(M!=null){if(M.Da){var se=M.cd,le=M.bd,de=-2&M.v,pe=-2&M.j;if(0>de||0>pe||0>=se||0>=le||de+se>y||pe+le>w)return 2;y=se,w=le}if(M.da){if(!Re(y,w,se=[M.ib],le=[M.hb]))return 2;y=se[0],w=le[0]}}G.width=y,G.height=w;e:{var me=G.width,fe=G.height;if(y=G.S,0>=me||0>=fe||!(y>=kd&&13>y))y=2;else{if(0>=G.Rd&&G.sd==null){de=le=se=w=0;var Se=(pe=me*Cc[y])*fe;if(11>y||(le=(fe+1)/2*(w=(me+1)/2),y==12&&(de=(se=me)*fe)),(fe=i(Se+2*le+de))==null){y=1;break e}G.sd=fe,11>y?((me=G.f.RGBA).eb=fe,me.fb=0,me.A=pe,me.size=Se):((me=G.f.kb).y=fe,me.O=0,me.fa=pe,me.Fd=Se,me.f=fe,me.N=0+Se,me.Ab=w,me.Cd=le,me.ea=fe,me.W=0+Se+le,me.Db=w,me.Ed=le,y==12&&(me.F=fe,me.J=0+Se+2*le),me.Tc=de,me.lb=se)}if(w=1,se=G.S,le=G.width,de=G.height,se>=kd&&13>se)if(11>se)y=G.f.RGBA,w&=(pe=Math.abs(y.A))*(de-1)+le<=y.size,w&=pe>=le*Cc[se],w&=y.eb!=null;else{y=G.f.kb,pe=(le+1)/2,Se=(de+1)/2,me=Math.abs(y.fa),fe=Math.abs(y.Ab);var Ie=Math.abs(y.Db),be=Math.abs(y.lb),Ce=be*(de-1)+le;w&=me*(de-1)+le<=y.Fd,w&=fe*(Se-1)+pe<=y.Cd,w=(w&=Ie*(Se-1)+pe<=y.Ed)&me>=le&fe>=pe&Ie>=pe,w&=y.y!=null,w&=y.f!=null,w&=y.ea!=null,se==12&&(w&=be>=le,w&=Ce<=y.Tc,w&=y.F!=null)}else w=0;y=w?0:2}}return y!=0||M!=null&&M.fd&&(y=Nl(G)),y}var un=64,Za=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Wa=24,to=32,ei=8,wi=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Be("Predictor0","PredictorAdd0"),A.Predictor0=function(){return 4278190080},A.Predictor1=function(y){return y},A.Predictor2=function(y,w,M){return w[M+0]},A.Predictor3=function(y,w,M){return w[M+1]},A.Predictor4=function(y,w,M){return w[M-1]},A.Predictor5=function(y,w,M){return it(it(y,w[M+1]),w[M+0])},A.Predictor6=function(y,w,M){return it(y,w[M-1])},A.Predictor7=function(y,w,M){return it(y,w[M+0])},A.Predictor8=function(y,w,M){return it(w[M-1],w[M+0])},A.Predictor9=function(y,w,M){return it(w[M+0],w[M+1])},A.Predictor10=function(y,w,M){return it(it(y,w[M-1]),it(w[M+0],w[M+1]))},A.Predictor11=function(y,w,M){var G=w[M+0];return 0>=ot(G>>24&255,y>>24&255,(w=w[M-1])>>24&255)+ot(G>>16&255,y>>16&255,w>>16&255)+ot(G>>8&255,y>>8&255,w>>8&255)+ot(255&G,255&y,255&w)?G:y},A.Predictor12=function(y,w,M){var G=w[M+0];return(Ft((y>>24&255)+(G>>24&255)-((w=w[M-1])>>24&255))<<24|Ft((y>>16&255)+(G>>16&255)-(w>>16&255))<<16|Ft((y>>8&255)+(G>>8&255)-(w>>8&255))<<8|Ft((255&y)+(255&G)-(255&w)))>>>0},A.Predictor13=function(y,w,M){var G=w[M-1];return(Tt((y=it(y,w[M+0]))>>24&255,G>>24&255)<<24|Tt(y>>16&255,G>>16&255)<<16|Tt(y>>8&255,G>>8&255)<<8|Tt(255&y,255&G))>>>0};var Si=A.PredictorAdd0;A.PredictorAdd1=Jt,Be("Predictor2","PredictorAdd2"),Be("Predictor3","PredictorAdd3"),Be("Predictor4","PredictorAdd4"),Be("Predictor5","PredictorAdd5"),Be("Predictor6","PredictorAdd6"),Be("Predictor7","PredictorAdd7"),Be("Predictor8","PredictorAdd8"),Be("Predictor9","PredictorAdd9"),Be("Predictor10","PredictorAdd10"),Be("Predictor11","PredictorAdd11"),Be("Predictor12","PredictorAdd12"),Be("Predictor13","PredictorAdd13");var ti=A.PredictorAdd2;bt("ColorIndexInverseTransform","MapARGB","32b",function(y){return y>>8&255},function(y){return y}),bt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(y){return y},function(y){return y>>8&255});var vs,Uo=A.ColorIndexInverseTransform,ri=A.MapARGB,In=A.VP8LColorIndexInverseTransformAlpha,qo=A.MapAlpha,$o=A.VP8LPredictorsAdd=[];$o.length=16,(A.VP8LPredictors=[]).length=16,(A.VP8LPredictorsAdd_C=[]).length=16,(A.VP8LPredictors_C=[]).length=16;var wl,Sl,zi,ro,so,Bo,ao,Vo,us,Sa,Sr,Rr,ps,As,Ln,gc,zl,Ci,jd,Cl,_d,Pu,vc,Ho,Zo,Au,yc,Ou,Du=i(511),Eu=i(2041),Iu=i(225),Lu=i(767),Tu=0,si=Eu,Pl=Iu,xa=Lu,pn=Du,kd=0,no=1,Xp=2,jc=3,_c=4,Ur=5,Nd=6,Al=7,Wo=8,kc=9,Nc=10,wc=[2,3,7],wd=[3,3,11],Ko=[280,256,256,256,40],Qp=[0,1,1,1,0],fx=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],bx=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],em=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Sd=8,Ol=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Sc=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Go=null,Ru=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Mu=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],tm=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],rm=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],gx=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],vx=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Fu=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],fa=[],mn=[],za=[],ai=1,Dl=2,ia=[],Ca=[];wa("UpsampleRgbLinePair",Qi,3),wa("UpsampleBgrLinePair",Ro,3),wa("UpsampleRgbaLinePair",bc,4),wa("UpsampleBgraLinePair",fc,4),wa("UpsampleArgbLinePair",Fo,4),wa("UpsampleRgba4444LinePair",Mo,2),wa("UpsampleRgb565LinePair",na,2);var yx=A.UpsampleRgbLinePair,jx=A.UpsampleBgrLinePair,io=A.UpsampleRgbaLinePair,El=A.UpsampleBgraLinePair,Yo=A.UpsampleArgbLinePair,zc=A.UpsampleRgba4444LinePair,Uu=A.UpsampleRgb565LinePair,Pi=16,Tn=1<<Pi-1,Er=-227,Mr=482,oo=6,Xs=0,Pa=i(256),Jo=i(256),Il=i(256),Aa=i(256),zd=i(Mr-Er),sm=i(Mr-Er);En("YuvToRgbRow",Qi,3),En("YuvToBgrRow",Ro,3),En("YuvToRgbaRow",bc,4),En("YuvToBgraRow",fc,4),En("YuvToArgbRow",Fo,4),En("YuvToRgba4444Row",Mo,2),En("YuvToRgb565Row",na,2);var qu=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Xo=[0,2,8],am=[8,7,6,4,4,2,2,2,1,1,1,1],Ai=1;this.WebPDecodeRGBA=function(y,w,M,G,se){var le=no,de=new Ae,pe=new ur;de.ba=pe,pe.S=le,pe.width=[pe.width],pe.height=[pe.height];var me=pe.width,fe=pe.height,Se=new De;if(Se==null||y==null)var Ie=2;else t(Se!=null),Ie=eo(y,w,M,Se.width,Se.height,Se.Pd,Se.Qd,Se.format,null);if(Ie!=0?me=0:(me!=null&&(me[0]=Se.width[0]),fe!=null&&(fe[0]=Se.height[0]),me=1),me){pe.width=pe.width[0],pe.height=pe.height[0],G!=null&&(G[0]=pe.width),se!=null&&(se[0]=pe.height);e:{if(G=new sa,(se=new Ve).data=y,se.w=w,se.ha=M,se.kd=1,w=[0],t(se!=null),((y=eo(se.data,se.w,se.ha,null,null,null,w,null,se))==0||y==7)&&w[0]&&(y=4),(w=y)==0){if(t(de!=null),G.data=se.data,G.w=se.w+se.offset,G.ha=se.ha-se.offset,G.put=dt,G.ac=_r,G.bc=kr,G.ma=de,se.xa){if((y=_o())==null){de=1;break e}if((function(be,Ce){var Ee=[0],$e=[0],Te=[0];t:for(;;){if(be==null)return 0;if(Ce==null)return be.a=2,0;if(be.l=Ce,be.a=0,oe(be.m,Ce.data,Ce.w,Ce.ha),!Ke(be.m,Ee,$e,Te)){be.a=3;break t}if(be.xb=Dl,Ce.width=Ee[0],Ce.height=$e[0],!Cn(Ee[0],$e[0],1,be,null))break t;return 1}return t(be.a!=0),0})(y,G)){if(G=(w=Ni(G.width,G.height,de.Oa,de.ba))==0){t:{G=y;r:for(;;){if(G==null){G=0;break t}if(t(G.s.yc!=null),t(G.s.Ya!=null),t(0<G.s.Wb),t((M=G.l)!=null),t((se=M.ma)!=null),G.xb!=0){if(G.ca=se.ba,G.tb=se.tb,t(G.ca!=null),!kl(se.Oa,M,jc)){G.a=2;break r}if(!Gi(G,M.width)||M.da)break r;if((M.da||qt(G.ca.S))&&dn(),11>G.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),G.ca.f.kb.F!=null&&dn()),G.Pb&&0<G.s.ua&&G.s.vb.X==null&&!ue(G.s.vb,G.s.Wa.Xa)){G.a=1;break r}G.xb=0}if(!rn(G,G.V,G.Ba,G.c,G.i,M.o,Ki))break r;se.Dc=G.Ma,G=1;break t}t(G.a!=0),G=0}G=!G}G&&(w=y.a)}else w=y.a}else{if((y=new zu)==null){de=1;break e}if(y.Fa=se.na,y.P=se.P,y.qc=se.Sa,So(y,G)){if((w=Ni(G.width,G.height,de.Oa,de.ba))==0){if(y.Aa=0,M=de.Oa,t((se=y)!=null),M!=null){if(0<(me=0>(me=M.Md)?0:100<me?255:255*me/100)){for(fe=Se=0;4>fe;++fe)12>(Ie=se.pb[fe]).lc&&(Ie.ia=me*am[0>Ie.lc?0:Ie.lc]>>3),Se|=Ie.ia;Se&&(alert("todo:VP8InitRandom"),se.ia=1)}se.Ga=M.Id,100<se.Ga?se.Ga=100:0>se.Ga&&(se.Ga=0)}(function(be,Ce){if(be==null)return 0;if(Ce==null)return Cs(be,2,"NULL VP8Io parameter in VP8Decode().");if(!be.cb&&!So(be,Ce))return 0;if(t(be.cb),Ce.ac==null||Ce.ac(Ce)){Ce.ob&&(be.L=0);var Ee=Xo[be.L];if(be.L==2?(be.yb=0,be.zb=0):(be.yb=Ce.v-Ee>>4,be.zb=Ce.j-Ee>>4,0>be.yb&&(be.yb=0),0>be.zb&&(be.zb=0)),be.Va=Ce.o+15+Ee>>4,be.Hb=Ce.va+15+Ee>>4,be.Hb>be.za&&(be.Hb=be.za),be.Va>be.Ub&&(be.Va=be.Ub),0<be.L){var $e=be.ed;for(Ee=0;4>Ee;++Ee){var Te;if(be.Qa.Cb){var Ue=be.Qa.Lb[Ee];be.Qa.Fb||(Ue+=$e.Tb)}else Ue=$e.Tb;for(Te=0;1>=Te;++Te){var qe=be.gd[Ee][Te],He=Ue;if($e.Pc&&(He+=$e.vd[0],Te&&(He+=$e.od[0])),0<(He=0>He?0:63<He?63:He)){var Ze=He;0<$e.wb&&(Ze=4<$e.wb?Ze>>2:Ze>>1)>9-$e.wb&&(Ze=9-$e.wb),1>Ze&&(Ze=1),qe.dd=Ze,qe.tc=2*He+Ze,qe.ld=40<=He?2:15<=He?1:0}else qe.tc=0;qe.La=Te}}}Ee=0}else Cs(be,6,"Frame setup failed"),Ee=be.a;if(Ee=Ee==0){if(Ee){be.$c=0,0<be.Aa||(be.Ic=Ai);t:{Ee=be.Ic,$e=4*(Ze=be.za);var Pt=32*Ze,ht=Ze+1,sr=0<be.L?Ze*(0<be.Aa?2:1):0,yt=(be.Aa==2?2:1)*Ze;if((qe=$e+832+(Te=3*(16*Ee+Xo[be.L])/2*Pt)+(Ue=be.Fa!=null&&0<be.Fa.length?be.Kc.c*be.Kc.i:0))!=qe)Ee=0;else{if(qe>be.Vb){if(be.Vb=0,be.Ec=i(qe),be.Fc=0,be.Ec==null){Ee=Cs(be,1,"no memory during frame initialization.");break t}be.Vb=qe}qe=be.Ec,He=be.Fc,be.Ac=qe,be.Bc=He,He+=$e,be.Gd=o(Pt,Ba),be.Hd=0,be.rb=o(ht+1,Yi),be.sb=1,be.wa=sr?o(sr,$a):null,be.Y=0,be.D.Nb=0,be.D.wa=be.wa,be.D.Y=be.Y,0<be.Aa&&(be.D.Y+=Ze),t(!0),be.oc=qe,be.pc=He,He+=832,be.ya=o(yt,fl),be.aa=0,be.D.ya=be.ya,be.D.aa=be.aa,be.Aa==2&&(be.D.aa+=Ze),be.R=16*Ze,be.B=8*Ze,Ze=(Pt=Xo[be.L])*be.R,Pt=Pt/2*be.B,be.sa=qe,be.ta=He+Ze,be.qa=be.sa,be.ra=be.ta+16*Ee*be.R+Pt,be.Ha=be.qa,be.Ia=be.ra+8*Ee*be.B+Pt,be.$c=0,He+=Te,be.mb=Ue?qe:null,be.nb=Ue?He:null,t(He+Ue<=be.Fc+be.Vb),Pn(be),n(be.Ac,be.Bc,0,$e),Ee=1}}if(Ee){if(Ce.ka=0,Ce.y=be.sa,Ce.O=be.ta,Ce.f=be.qa,Ce.N=be.ra,Ce.ea=be.Ha,Ce.Vd=be.Ia,Ce.fa=be.R,Ce.Rc=be.B,Ce.F=null,Ce.J=0,!Tu){for(Ee=-255;255>=Ee;++Ee)Du[255+Ee]=0>Ee?-Ee:Ee;for(Ee=-1020;1020>=Ee;++Ee)Eu[1020+Ee]=-128>Ee?-128:127<Ee?127:Ee;for(Ee=-112;112>=Ee;++Ee)Iu[112+Ee]=-16>Ee?-16:15<Ee?15:Ee;for(Ee=-255;510>=Ee;++Ee)Lu[255+Ee]=0>Ee?0:255<Ee?255:Ee;Tu=1}ao=yr,Vo=cc,Sa=Po,Sr=Kn,Rr=bl,us=hd,ps=xc,As=aa,Ln=D,gc=ae,zl=cn,Ci=_l,jd=ve,Cl=we,_d=nn,Pu=ki,vc=Io,Ho=hc,mn[0]=Cu,mn[1]=gl,mn[2]=Ao,mn[3]=Yn,mn[4]=bd,mn[5]=ji,mn[6]=Va,mn[7]=gd,mn[8]=Oo,mn[9]=yl,fa[0]=An,fa[1]=xd,fa[2]=fd,fa[3]=vl,fa[4]=Gn,fa[5]=Na,fa[6]=an,za[0]=Dn,za[1]=dc,za[2]=uc,za[3]=On,za[4]=pc,za[5]=jl,za[6]=mc,Ee=1}else Ee=0}Ee&&(Ee=(function(xr,ms){for(xr.M=0;xr.M<xr.Va;++xr.M){var nr,xt=xr.Jc[xr.M&xr.Xb],at=xr.m,ys=xr;for(nr=0;nr<ys.za;++nr){var Wt=at,hr=ys,Kr=hr.Ac,Vs=hr.Bc+4*nr,Os=hr.zc,ns=hr.ya[hr.aa+nr];if(hr.Qa.Bb?ns.$b=K(Wt,hr.Pa.jb[0])?2+K(Wt,hr.Pa.jb[2]):K(Wt,hr.Pa.jb[1]):ns.$b=0,hr.kc&&(ns.Ad=K(Wt,hr.Bd)),ns.Za=!K(Wt,145)+0,ns.Za){var Rs=ns.Ob,Hs=0;for(hr=0;4>hr;++hr){var Qr,br=Os[0+hr];for(Qr=0;4>Qr;++Qr){br=gx[Kr[Vs+Qr]][br];for(var zr=tm[K(Wt,br[0])];0<zr;)zr=tm[2*zr+K(Wt,br[zr])];br=-zr,Kr[Vs+Qr]=br}a(Rs,Hs,Kr,Vs,4),Hs+=4,Os[0+hr]=br}}else br=K(Wt,156)?K(Wt,128)?1:3:K(Wt,163)?2:0,ns.Ob[0]=br,n(Kr,Vs,br,4),n(Os,0,br,4);ns.Dd=K(Wt,142)?K(Wt,114)?K(Wt,183)?1:3:2:0}if(ys.m.Ka)return Cs(xr,7,"Premature end-of-partition0 encountered.");for(;xr.ja<xr.za;++xr.ja){if(ys=xt,Wt=(at=xr).rb[at.sb-1],Kr=at.rb[at.sb+at.ja],nr=at.ya[at.aa+at.ja],Vs=at.kc?nr.Ad:0)Wt.la=Kr.la=0,nr.Za||(Wt.Na=Kr.Na=0),nr.Hc=0,nr.Gc=0,nr.ia=0;else{var es,Cr;if(Wt=Kr,Kr=ys,Vs=at.Pa.Xc,Os=at.ya[at.aa+at.ja],ns=at.pb[Os.$b],hr=Os.ad,Rs=0,Hs=at.rb[at.sb-1],br=Qr=0,n(hr,Rs,0,384),Os.Za)var hs=0,xs=Vs[3];else{zr=i(16);var qr=Wt.Na+Hs.Na;if(qr=Go(Kr,Vs[1],qr,ns.Eb,0,zr,0),Wt.Na=Hs.Na=(0<qr)+0,1<qr)ao(zr,0,hr,Rs);else{var oa=zr[0]+3>>3;for(zr=0;256>zr;zr+=16)hr[Rs+zr]=oa}hs=1,xs=Vs[0]}var Fr=15&Wt.la,$r=15&Hs.la;for(zr=0;4>zr;++zr){var Ds=1&$r;for(oa=Cr=0;4>oa;++oa)Fr=Fr>>1|(Ds=(qr=Go(Kr,xs,qr=Ds+(1&Fr),ns.Sc,hs,hr,Rs))>hs)<<7,Cr=Cr<<2|(3<qr?3:1<qr?2:hr[Rs+0]!=0),Rs+=16;Fr>>=4,$r=$r>>1|Ds<<7,Qr=(Qr<<8|Cr)>>>0}for(xs=Fr,hs=$r>>4,es=0;4>es;es+=2){for(Cr=0,Fr=Wt.la>>4+es,$r=Hs.la>>4+es,zr=0;2>zr;++zr){for(Ds=1&$r,oa=0;2>oa;++oa)qr=Ds+(1&Fr),Fr=Fr>>1|(Ds=0<(qr=Go(Kr,Vs[2],qr,ns.Qc,0,hr,Rs)))<<3,Cr=Cr<<2|(3<qr?3:1<qr?2:hr[Rs+0]!=0),Rs+=16;Fr>>=2,$r=$r>>1|Ds<<5}br|=Cr<<4*es,xs|=Fr<<4<<es,hs|=(240&$r)<<es}Wt.la=xs,Hs.la=hs,Os.Hc=Qr,Os.Gc=br,Os.ia=43690&br?0:ns.ia,Vs=!(Qr|br)}if(0<at.L&&(at.wa[at.Y+at.ja]=at.gd[nr.$b][nr.Za],at.wa[at.Y+at.ja].La|=!Vs),ys.Ka)return Cs(xr,7,"Premature end-of-file encountered.")}if(Pn(xr),at=ms,ys=1,nr=(xt=xr).D,Wt=0<xt.L&&xt.M>=xt.zb&&xt.M<=xt.Va,xt.Aa==0)t:{if(nr.M=xt.M,nr.uc=Wt,Ha(xt,nr),ys=1,nr=(Cr=xt.D).Nb,Wt=(br=Xo[xt.L])*xt.R,Kr=br/2*xt.B,zr=16*nr*xt.R,oa=8*nr*xt.B,Vs=xt.sa,Os=xt.ta-Wt+zr,ns=xt.qa,hr=xt.ra-Kr+oa,Rs=xt.Ha,Hs=xt.Ia-Kr+oa,$r=(Fr=Cr.M)==0,Qr=Fr>=xt.Va-1,xt.Aa==2&&Ha(xt,Cr),Cr.uc)for(Ds=(qr=xt).D.M,t(qr.D.uc),Cr=qr.yb;Cr<qr.Hb;++Cr){hs=Cr,xs=Ds;var Qs=(Oa=(ks=qr).D).Nb;es=ks.R;var Oa=Oa.wa[Oa.Y+hs],js=ks.sa,_s=ks.ta+16*Qs*es+16*hs,la=Oa.dd,Br=Oa.tc;if(Br!=0)if(t(3<=Br),ks.L==1)0<hs&&Pu(js,_s,es,Br+4),Oa.La&&Ho(js,_s,es,Br),0<xs&&_d(js,_s,es,Br+4),Oa.La&&vc(js,_s,es,Br);else{var ca=ks.B,hn=ks.qa,Rn=ks.ra+8*Qs*ca+8*hs,Zs=ks.Ha,ks=ks.Ia+8*Qs*ca+8*hs;Qs=Oa.ld,0<hs&&(As(js,_s,es,Br+4,la,Qs),gc(hn,Rn,Zs,ks,ca,Br+4,la,Qs)),Oa.La&&(Ci(js,_s,es,Br,la,Qs),Cl(hn,Rn,Zs,ks,ca,Br,la,Qs)),0<xs&&(ps(js,_s,es,Br+4,la,Qs),Ln(hn,Rn,Zs,ks,ca,Br+4,la,Qs)),Oa.La&&(zl(js,_s,es,Br,la,Qs),jd(hn,Rn,Zs,ks,ca,Br,la,Qs))}}if(xt.ia&&alert("todo:DitherRow"),at.put!=null){if(Cr=16*Fr,Fr=16*(Fr+1),$r?(at.y=xt.sa,at.O=xt.ta+zr,at.f=xt.qa,at.N=xt.ra+oa,at.ea=xt.Ha,at.W=xt.Ia+oa):(Cr-=br,at.y=Vs,at.O=Os,at.f=ns,at.N=hr,at.ea=Rs,at.W=Hs),Qr||(Fr-=br),Fr>at.o&&(Fr=at.o),at.F=null,at.J=null,xt.Fa!=null&&0<xt.Fa.length&&Cr<Fr&&(at.J=Ps(xt,at,Cr,Fr-Cr),at.F=xt.mb,at.F==null&&at.F.length==0)){ys=Cs(xt,3,"Could not decode alpha data.");break t}Cr<at.j&&(br=at.j-Cr,Cr=at.j,t(!(1&br)),at.O+=xt.R*br,at.N+=xt.B*(br>>1),at.W+=xt.B*(br>>1),at.F!=null&&(at.J+=at.width*br)),Cr<Fr&&(at.O+=at.v,at.N+=at.v>>1,at.W+=at.v>>1,at.F!=null&&(at.J+=at.v),at.ka=Cr-at.j,at.U=at.va-at.v,at.T=Fr-Cr,ys=at.put(at))}nr+1!=xt.Ic||Qr||(a(xt.sa,xt.ta-Wt,Vs,Os+16*xt.R,Wt),a(xt.qa,xt.ra-Kr,ns,hr+8*xt.B,Kr),a(xt.Ha,xt.Ia-Kr,Rs,Hs+8*xt.B,Kr))}if(!ys)return Cs(xr,6,"Output aborted.")}return 1})(be,Ce)),Ce.bc!=null&&Ce.bc(Ce),Ee&=1}return Ee?(be.cb=0,Ee):0})(y,G)||(w=y.a)}}else w=y.a}w==0&&de.Oa!=null&&de.Oa.fd&&(w=Nl(de.ba))}de=w}le=de!=0?null:11>le?pe.f.RGBA.eb:pe.f.kb.y}else le=null;return le};var Cc=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function p(A,S){for(var C="",O=0;O<4;O++)C+=String.fromCharCode(A[S++]);return C}function m(A,S){return A[S+0]|A[S+1]<<8}function x(A,S){return(A[S+0]|A[S+1]<<8|A[S+2]<<16)>>>0}function b(A,S){return(A[S+0]|A[S+1]<<8|A[S+2]<<16|A[S+3]<<24)>>>0}new d;var h=[0],j=[0],g=[],v=new d,_=s,k=(function(A,S){var C={},O=0,Z=!1,te=0,ce=0;if(C.frames=[],!(function($,Q){for(var q=0;q<4;q++)if($[Q+q]!="RIFF".charCodeAt(q))return!0;return!1})(A,S)){for(b(A,S+=4),S+=8;S<A.length;){var re=p(A,S),X=b(A,S+=4);S+=4;var U=X+(1&X);switch(re){case"VP8 ":case"VP8L":C.frames[O]===void 0&&(C.frames[O]={}),(J=C.frames[O]).src_off=Z?ce:S-8,J.src_size=te+X+8,O++,Z&&(Z=!1,te=0,ce=0);break;case"VP8X":(J=C.header={}).feature_flags=A[S];var oe=S+4;J.canvas_width=1+x(A,oe),oe+=3,J.canvas_height=1+x(A,oe),oe+=3;break;case"ALPH":Z=!0,te=U+8,ce=S-8;break;case"ANIM":(J=C.header).bgcolor=b(A,S),oe=S+4,J.loop_count=m(A,oe),oe+=2;break;case"ANMF":var xe,J;(J=C.frames[O]={}).offset_x=2*x(A,S),S+=3,J.offset_y=2*x(A,S),S+=3,J.width=1+x(A,S),S+=3,J.height=1+x(A,S),S+=3,J.duration=x(A,S),S+=3,xe=A[S++],J.dispose=1&xe,J.blend=xe>>1&1}re!="ANMF"&&(S+=U)}return C}})(_,0);k.response=_,k.rgbaoutput=!0,k.dataurl=!1;var P=k.header?k.header:null,L=k.frames?k.frames:null;if(P){P.loop_counter=P.loop_count,h=[P.canvas_height],j=[P.canvas_width];for(var F=0;F<L.length&&L[F].blend!=0;F++);}var W=L[0],R=v.WebPDecodeRGBA(_,W.src_off,W.src_size,j,h);W.rgba=R,W.imgwidth=j[0],W.imgheight=h[0];for(var B=0;B<j[0]*h[0]*4;B++)g[B]=R[B];return this.width=j,this.height=h,this.data=g,this}(function(s){var t,r,a,n,i,o,c,d,p,m=function($){return $=$||{},this.isStrokeTransparent=$.isStrokeTransparent||!1,this.strokeOpacity=$.strokeOpacity||1,this.strokeStyle=$.strokeStyle||"#000000",this.fillStyle=$.fillStyle||"#000000",this.isFillTransparent=$.isFillTransparent||!1,this.fillOpacity=$.fillOpacity||1,this.font=$.font||"10px sans-serif",this.textBaseline=$.textBaseline||"alphabetic",this.textAlign=$.textAlign||"left",this.lineWidth=$.lineWidth||1,this.lineJoin=$.lineJoin||"miter",this.lineCap=$.lineCap||"butt",this.path=$.path||[],this.transform=$.transform!==void 0?$.transform.clone():new d,this.globalCompositeOperation=$.globalCompositeOperation||"normal",this.globalAlpha=$.globalAlpha||1,this.clip_path=$.clip_path||[],this.currentPoint=$.currentPoint||new o,this.miterLimit=$.miterLimit||10,this.lastPoint=$.lastPoint||new o,this.lineDashOffset=$.lineDashOffset||0,this.lineDash=$.lineDash||[],this.margin=$.margin||[0,0,0,0],this.prevPageLastElemOffset=$.prevPageLastElemOffset||0,this.ignoreClearRect=typeof $.ignoreClearRect!="boolean"||$.ignoreClearRect,this};s.events.push(["initialized",function(){this.context2d=new x(this),t=this.internal.f2,r=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,n=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,o=this.internal.Point,c=this.internal.Rectangle,d=this.internal.Matrix,p=new m}]);var x=function($){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var Q=$;Object.defineProperty(this,"pdf",{get:function(){return Q}});var q=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return q},set:function(ke){q=!!ke}});var I=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return I},set:function(ke){I=!!ke}});var Y=0;Object.defineProperty(this,"posX",{get:function(){return Y},set:function(ke){isNaN(ke)||(Y=ke)}});var H=0;Object.defineProperty(this,"posY",{get:function(){return H},set:function(ke){isNaN(ke)||(H=ke)}}),Object.defineProperty(this,"margin",{get:function(){return p.margin},set:function(ke){var ue;typeof ke=="number"?ue=[ke,ke,ke,ke]:((ue=new Array(4))[0]=ke[0],ue[1]=ke.length>=2?ke[1]:ue[0],ue[2]=ke.length>=3?ke[2]:ue[0],ue[3]=ke.length>=4?ke[3]:ue[1]),p.margin=ue}});var he=!1;Object.defineProperty(this,"autoPaging",{get:function(){return he},set:function(ke){he=ke}});var ge=0;Object.defineProperty(this,"lastBreak",{get:function(){return ge},set:function(ke){ge=ke}});var K=[];Object.defineProperty(this,"pageBreaks",{get:function(){return K},set:function(ke){K=ke}}),Object.defineProperty(this,"ctx",{get:function(){return p},set:function(ke){ke instanceof m&&(p=ke)}}),Object.defineProperty(this,"path",{get:function(){return p.path},set:function(ke){p.path=ke}});var T=[];Object.defineProperty(this,"ctxStack",{get:function(){return T},set:function(ke){T=ke}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(ke){var ue;ue=b(ke),this.ctx.fillStyle=ue.style,this.ctx.isFillTransparent=ue.a===0,this.ctx.fillOpacity=ue.a,this.pdf.setFillColor(ue.r,ue.g,ue.b,{a:ue.a}),this.pdf.setTextColor(ue.r,ue.g,ue.b,{a:ue.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(ke){var ue=b(ke);this.ctx.strokeStyle=ue.style,this.ctx.isStrokeTransparent=ue.a===0,this.ctx.strokeOpacity=ue.a,ue.a===0?this.pdf.setDrawColor(255,255,255):(ue.a,this.pdf.setDrawColor(ue.r,ue.g,ue.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(ke){["butt","round","square"].indexOf(ke)!==-1&&(this.ctx.lineCap=ke,this.pdf.setLineCap(ke))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(ke){isNaN(ke)||(this.ctx.lineWidth=ke,this.pdf.setLineWidth(ke))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(ke){["bevel","round","miter"].indexOf(ke)!==-1&&(this.ctx.lineJoin=ke,this.pdf.setLineJoin(ke))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(ke){isNaN(ke)||(this.ctx.miterLimit=ke,this.pdf.setMiterLimit(ke))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(ke){this.ctx.textBaseline=ke}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(ke){["right","end","center","left","start"].indexOf(ke)!==-1&&(this.ctx.textAlign=ke)}});var ee=null,_e=null;Object.defineProperty(this,"fontFaces",{get:function(){return _e},set:function(ke){ee=null,_e=ke}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(ke){var ue;if(this.ctx.font=ke,(ue=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(ke))!==null){var je=ue[1];ue[2];var ne=ue[3],Re=ue[4];ue[5];var Oe=ue[6],Je=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Re)[2];Re=Math.floor(Je==="px"?parseFloat(Re)*this.pdf.internal.scaleFactor:Je==="em"?parseFloat(Re)*this.pdf.getFontSize():parseFloat(Re)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Re);var Be=(function(Nt){var bt,jr,Zt=[],ct=Nt.trim();if(ct==="")return ab;if(ct in c_)return[c_[ct]];for(;ct!=="";){switch(jr=null,bt=(ct=u_(ct)).charAt(0)){case'"':case"'":jr=LO(ct.substring(1),bt);break;default:jr=TO(ct)}if(jr===null||(Zt.push(jr[0]),(ct=u_(jr[1]))!==""&&ct.charAt(0)!==","))return ab;ct=ct.replace(/^,/,"")}return Zt})(Oe);if(this.fontFaces){var kt=(function(Nt,bt){if(ee===null){var jr=(function(Zt){var ct=[];return Object.keys(Zt).forEach(function(Ut){Zt[Ut].forEach(function(dr){var Et=null;switch(dr){case"bold":Et={family:Ut,weight:"bold"};break;case"italic":Et={family:Ut,style:"italic"};break;case"bolditalic":Et={family:Ut,weight:"bold",style:"italic"};break;case"":case"normal":Et={family:Ut}}Et!==null&&(Et.ref={name:Ut,style:dr},ct.push(Et))})}),ct})(Nt.getFontList());ee=(function(Zt){for(var ct={},Ut=0;Ut<Zt.length;++Ut){var dr=sb(Zt[Ut]),Et=dr.family,or=dr.stretch,qt=dr.style,Lr=dr.weight;ct[Et]=ct[Et]||{},ct[Et][or]=ct[Et][or]||{},ct[Et][or][qt]=ct[Et][or][qt]||{},ct[Et][or][qt][Lr]=dr}return ct})(jr.concat(bt))}return ee})(this.pdf,this.fontFaces),it=Be.map(function(Nt){return{family:Nt,stretch:"normal",weight:ne,style:je}}),Ft=(function(Nt,bt,jr){for(var Zt=(jr=jr||{}).defaultFontFamily||"times",ct=Object.assign({},IO,jr.genericFontFamilies||{}),Ut=null,dr=null,Et=0;Et<bt.length;++Et)if(ct[(Ut=sb(bt[Et])).family]&&(Ut.family=ct[Ut.family]),Nt.hasOwnProperty(Ut.family)){dr=Nt[Ut.family];break}if(!(dr=dr||Nt[Zt]))throw new Error("Could not find a font-family for the rule '"+d_(Ut)+"' and default family '"+Zt+"'.");if(dr=(function(or,qt){if(qt[or])return qt[or];var Lr=Jb[or],Tr=Lr<=Jb.normal?-1:1,ur=l_(qt,gk,Lr,Tr);if(!ur)throw new Error("Could not find a matching font-stretch value for "+or);return ur})(Ut.stretch,dr),dr=(function(or,qt){if(qt[or])return qt[or];for(var Lr=bk[or],Tr=0;Tr<Lr.length;++Tr)if(qt[Lr[Tr]])return qt[Lr[Tr]];throw new Error("Could not find a matching font-style for "+or)})(Ut.style,dr),!(dr=(function(or,qt){if(qt[or])return qt[or];if(or===400&&qt[500])return qt[500];if(or===500&&qt[400])return qt[400];var Lr=EO[or],Tr=l_(qt,vk,Lr,or<400?-1:1);if(!Tr)throw new Error("Could not find a matching font-weight for value "+or);return Tr})(Ut.weight,dr)))throw new Error("Failed to resolve a font for the rule '"+d_(Ut)+"'.");return dr})(kt,it);this.pdf.setFont(Ft.ref.name,Ft.ref.style)}else{var Tt="";(ne==="bold"||parseInt(ne,10)>=700||je==="bold")&&(Tt="bold"),je==="italic"&&(Tt+="italic"),Tt.length===0&&(Tt="normal");for(var ot="",Jt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Vt=0;Vt<Be.length;Vt++){if(this.pdf.internal.getFont(Be[Vt],Tt,{noFallback:!0,disableWarning:!0})!==void 0){ot=Be[Vt];break}if(Tt==="bolditalic"&&this.pdf.internal.getFont(Be[Vt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)ot=Be[Vt],Tt="bold";else if(this.pdf.internal.getFont(Be[Vt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){ot=Be[Vt],Tt="normal";break}}if(ot===""){for(var wt=0;wt<Be.length;wt++)if(Jt[Be[wt]]){ot=Jt[Be[wt]];break}}ot=ot===""?"Times":ot,this.pdf.setFont(ot,Tt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(ke){this.ctx.globalCompositeOperation=ke}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(ke){this.ctx.globalAlpha=ke}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(ke){this.ctx.lineDashOffset=ke,J.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(ke){this.ctx.lineDash=ke,J.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(ke){this.ctx.ignoreClearRect=!!ke}})};x.prototype.setLineDash=function($){this.lineDash=$},x.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},x.prototype.fill=function(){L.call(this,"fill",!1)},x.prototype.stroke=function(){L.call(this,"stroke",!1)},x.prototype.beginPath=function(){this.path=[{type:"begin"}]},x.prototype.moveTo=function($,Q){if(isNaN($)||isNaN(Q))throw Xr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var q=this.ctx.transform.applyToPoint(new o($,Q));this.path.push({type:"mt",x:q.x,y:q.y}),this.ctx.lastPoint=new o($,Q)},x.prototype.closePath=function(){var $=new o(0,0),Q=0;for(Q=this.path.length-1;Q!==-1;Q--)if(this.path[Q].type==="begin"&&Zr(this.path[Q+1])==="object"&&typeof this.path[Q+1].x=="number"){$=new o(this.path[Q+1].x,this.path[Q+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o($.x,$.y)},x.prototype.lineTo=function($,Q){if(isNaN($)||isNaN(Q))throw Xr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var q=this.ctx.transform.applyToPoint(new o($,Q));this.path.push({type:"lt",x:q.x,y:q.y}),this.ctx.lastPoint=new o(q.x,q.y)},x.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),L.call(this,null,!0)},x.prototype.quadraticCurveTo=function($,Q,q,I){if(isNaN(q)||isNaN(I)||isNaN($)||isNaN(Q))throw Xr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Y=this.ctx.transform.applyToPoint(new o(q,I)),H=this.ctx.transform.applyToPoint(new o($,Q));this.path.push({type:"qct",x1:H.x,y1:H.y,x:Y.x,y:Y.y}),this.ctx.lastPoint=new o(Y.x,Y.y)},x.prototype.bezierCurveTo=function($,Q,q,I,Y,H){if(isNaN(Y)||isNaN(H)||isNaN($)||isNaN(Q)||isNaN(q)||isNaN(I))throw Xr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var he=this.ctx.transform.applyToPoint(new o(Y,H)),ge=this.ctx.transform.applyToPoint(new o($,Q)),K=this.ctx.transform.applyToPoint(new o(q,I));this.path.push({type:"bct",x1:ge.x,y1:ge.y,x2:K.x,y2:K.y,x:he.x,y:he.y}),this.ctx.lastPoint=new o(he.x,he.y)},x.prototype.arc=function($,Q,q,I,Y,H){if(isNaN($)||isNaN(Q)||isNaN(q)||isNaN(I)||isNaN(Y))throw Xr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(H=!!H,!this.ctx.transform.isIdentity){var he=this.ctx.transform.applyToPoint(new o($,Q));$=he.x,Q=he.y;var ge=this.ctx.transform.applyToPoint(new o(0,q)),K=this.ctx.transform.applyToPoint(new o(0,0));q=Math.sqrt(Math.pow(ge.x-K.x,2)+Math.pow(ge.y-K.y,2))}Math.abs(Y-I)>=2*Math.PI&&(I=0,Y=2*Math.PI),this.path.push({type:"arc",x:$,y:Q,radius:q,startAngle:I,endAngle:Y,counterclockwise:H})},x.prototype.arcTo=function($,Q,q,I,Y){throw new Error("arcTo not implemented.")},x.prototype.rect=function($,Q,q,I){if(isNaN($)||isNaN(Q)||isNaN(q)||isNaN(I))throw Xr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo($,Q),this.lineTo($+q,Q),this.lineTo($+q,Q+I),this.lineTo($,Q+I),this.lineTo($,Q),this.lineTo($+q,Q),this.lineTo($,Q)},x.prototype.fillRect=function($,Q,q,I){if(isNaN($)||isNaN(Q)||isNaN(q)||isNaN(I))throw Xr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var Y={};this.lineCap!=="butt"&&(Y.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Y.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect($,Q,q,I),this.fill(),Y.hasOwnProperty("lineCap")&&(this.lineCap=Y.lineCap),Y.hasOwnProperty("lineJoin")&&(this.lineJoin=Y.lineJoin)}},x.prototype.strokeRect=function($,Q,q,I){if(isNaN($)||isNaN(Q)||isNaN(q)||isNaN(I))throw Xr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");j.call(this)||(this.beginPath(),this.rect($,Q,q,I),this.stroke())},x.prototype.clearRect=function($,Q,q,I){if(isNaN($)||isNaN(Q)||isNaN(q)||isNaN(I))throw Xr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect($,Q,q,I))},x.prototype.save=function($){$=typeof $!="boolean"||$;for(var Q=this.pdf.internal.getCurrentPageInfo().pageNumber,q=0;q<this.pdf.internal.getNumberOfPages();q++)this.pdf.setPage(q+1),this.pdf.internal.out("q");if(this.pdf.setPage(Q),$){this.ctx.fontSize=this.pdf.internal.getFontSize();var I=new m(this.ctx);this.ctxStack.push(this.ctx),this.ctx=I}},x.prototype.restore=function($){$=typeof $!="boolean"||$;for(var Q=this.pdf.internal.getCurrentPageInfo().pageNumber,q=0;q<this.pdf.internal.getNumberOfPages();q++)this.pdf.setPage(q+1),this.pdf.internal.out("Q");this.pdf.setPage(Q),$&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},x.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var b=function($){var Q,q,I,Y;if($.isCanvasGradient===!0&&($=$.getColor()),!$)return{r:0,g:0,b:0,a:0,style:$};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test($))Q=0,q=0,I=0,Y=0;else{var H=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec($);if(H!==null)Q=parseInt(H[1]),q=parseInt(H[2]),I=parseInt(H[3]),Y=1;else if((H=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec($))!==null)Q=parseInt(H[1]),q=parseInt(H[2]),I=parseInt(H[3]),Y=parseFloat(H[4]);else{if(Y=1,typeof $=="string"&&$.charAt(0)!=="#"){var he=new dk($);$=he.ok?he.toHex():"#000000"}$.length===4?(Q=$.substring(1,2),Q+=Q,q=$.substring(2,3),q+=q,I=$.substring(3,4),I+=I):(Q=$.substring(1,3),q=$.substring(3,5),I=$.substring(5,7)),Q=parseInt(Q,16),q=parseInt(q,16),I=parseInt(I,16)}}return{r:Q,g:q,b:I,a:Y,style:$}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},j=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};x.prototype.fillText=function($,Q,q,I){if(isNaN(Q)||isNaN(q)||typeof $!="string")throw Xr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(I=isNaN(I)?void 0:I,!h.call(this)){var Y=U(this.ctx.transform.rotation),H=this.ctx.transform.scaleX;O.call(this,{text:$,x:Q,y:q,scale:H,angle:Y,align:this.textAlign,maxWidth:I})}},x.prototype.strokeText=function($,Q,q,I){if(isNaN(Q)||isNaN(q)||typeof $!="string")throw Xr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!j.call(this)){I=isNaN(I)?void 0:I;var Y=U(this.ctx.transform.rotation),H=this.ctx.transform.scaleX;O.call(this,{text:$,x:Q,y:q,scale:H,renderingMode:"stroke",angle:Y,align:this.textAlign,maxWidth:I})}},x.prototype.measureText=function($){if(typeof $!="string")throw Xr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var Q=this.pdf,q=this.pdf.internal.scaleFactor,I=Q.internal.getFontSize(),Y=Q.getStringUnitWidth($)*I/Q.internal.scaleFactor;return new function(H){var he=(H=H||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return he}}),this}({width:Y*=Math.round(96*q/72*1e4)/1e4})},x.prototype.scale=function($,Q){if(isNaN($)||isNaN(Q))throw Xr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var q=new d($,0,0,Q,0,0);this.ctx.transform=this.ctx.transform.multiply(q)},x.prototype.rotate=function($){if(isNaN($))throw Xr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var Q=new d(Math.cos($),Math.sin($),-Math.sin($),Math.cos($),0,0);this.ctx.transform=this.ctx.transform.multiply(Q)},x.prototype.translate=function($,Q){if(isNaN($)||isNaN(Q))throw Xr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var q=new d(1,0,0,1,$,Q);this.ctx.transform=this.ctx.transform.multiply(q)},x.prototype.transform=function($,Q,q,I,Y,H){if(isNaN($)||isNaN(Q)||isNaN(q)||isNaN(I)||isNaN(Y)||isNaN(H))throw Xr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var he=new d($,Q,q,I,Y,H);this.ctx.transform=this.ctx.transform.multiply(he)},x.prototype.setTransform=function($,Q,q,I,Y,H){$=isNaN($)?1:$,Q=isNaN(Q)?0:Q,q=isNaN(q)?0:q,I=isNaN(I)?1:I,Y=isNaN(Y)?0:Y,H=isNaN(H)?0:H,this.ctx.transform=new d($,Q,q,I,Y,H)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};x.prototype.drawImage=function($,Q,q,I,Y,H,he,ge,K){var T=this.pdf.getImageProperties($),ee=1,_e=1,ke=1,ue=1;I!==void 0&&ge!==void 0&&(ke=ge/I,ue=K/Y,ee=T.width/I*ge/I,_e=T.height/Y*K/Y),H===void 0&&(H=Q,he=q,Q=0,q=0),I!==void 0&&ge===void 0&&(ge=I,K=Y),I===void 0&&ge===void 0&&(ge=T.width,K=T.height);for(var je,ne=this.ctx.transform.decompose(),Re=U(ne.rotate.shx),Oe=new d,Je=(Oe=(Oe=(Oe=Oe.multiply(ne.translate)).multiply(ne.skew)).multiply(ne.scale)).applyToRectangle(new c(H-Q*ke,he-q*ue,I*ee,Y*_e)),Be=v.call(this,Je),kt=[],it=0;it<Be.length;it+=1)kt.indexOf(Be[it])===-1&&kt.push(Be[it]);if(P(kt),this.autoPaging)for(var Ft=kt[0],Tt=kt[kt.length-1],ot=Ft;ot<Tt+1;ot++){this.pdf.setPage(ot);var Jt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Vt=ot===1?this.posY+this.margin[0]:this.margin[0],wt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Nt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],bt=ot===1?0:wt+(ot-2)*Nt;if(this.ctx.clip_path.length!==0){var jr=this.path;je=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=k(je,this.posX+this.margin[3],-bt+Vt+this.ctx.prevPageLastElemOffset),F.call(this,"fill",!0),this.path=jr}var Zt=JSON.parse(JSON.stringify(Je));Zt=k([Zt],this.posX+this.margin[3],-bt+Vt+this.ctx.prevPageLastElemOffset)[0];var ct=(ot>Ft||ot<Tt)&&g.call(this);ct&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Jt,Nt,null).clip().discardPath()),this.pdf.addImage($,"JPEG",Zt.x,Zt.y,Zt.w,Zt.h,null,null,Re),ct&&this.pdf.restoreGraphicsState()}else this.pdf.addImage($,"JPEG",Je.x,Je.y,Je.w,Je.h,null,null,Re)};var v=function($,Q,q){var I=[];Q=Q||this.pdf.internal.pageSize.width,q=q||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Y=this.posY+this.ctx.prevPageLastElemOffset;switch($.type){default:case"mt":case"lt":I.push(Math.floor(($.y+Y)/q)+1);break;case"arc":I.push(Math.floor(($.y+Y-$.radius)/q)+1),I.push(Math.floor(($.y+Y+$.radius)/q)+1);break;case"qct":var H=oe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,$.x1,$.y1,$.x,$.y);I.push(Math.floor((H.y+Y)/q)+1),I.push(Math.floor((H.y+H.h+Y)/q)+1);break;case"bct":var he=xe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,$.x1,$.y1,$.x2,$.y2,$.x,$.y);I.push(Math.floor((he.y+Y)/q)+1),I.push(Math.floor((he.y+he.h+Y)/q)+1);break;case"rect":I.push(Math.floor(($.y+Y)/q)+1),I.push(Math.floor(($.y+$.h+Y)/q)+1)}for(var ge=0;ge<I.length;ge+=1)for(;this.pdf.internal.getNumberOfPages()<I[ge];)_.call(this);return I},_=function(){var $=this.fillStyle,Q=this.strokeStyle,q=this.font,I=this.lineCap,Y=this.lineWidth,H=this.lineJoin;this.pdf.addPage(),this.fillStyle=$,this.strokeStyle=Q,this.font=q,this.lineCap=I,this.lineWidth=Y,this.lineJoin=H},k=function($,Q,q){for(var I=0;I<$.length;I++)switch($[I].type){case"bct":$[I].x2+=Q,$[I].y2+=q;case"qct":$[I].x1+=Q,$[I].y1+=q;default:$[I].x+=Q,$[I].y+=q}return $},P=function($){return $.sort(function(Q,q){return Q-q})},L=function($,Q){for(var q,I,Y=this.fillStyle,H=this.strokeStyle,he=this.lineCap,ge=this.lineWidth,K=Math.abs(ge*this.ctx.transform.scaleX),T=this.lineJoin,ee=JSON.parse(JSON.stringify(this.path)),_e=JSON.parse(JSON.stringify(this.path)),ke=[],ue=0;ue<_e.length;ue++)if(_e[ue].x!==void 0)for(var je=v.call(this,_e[ue]),ne=0;ne<je.length;ne+=1)ke.indexOf(je[ne])===-1&&ke.push(je[ne]);for(var Re=0;Re<ke.length;Re++)for(;this.pdf.internal.getNumberOfPages()<ke[Re];)_.call(this);if(P(ke),this.autoPaging)for(var Oe=ke[0],Je=ke[ke.length-1],Be=Oe;Be<Je+1;Be++){this.pdf.setPage(Be),this.fillStyle=Y,this.strokeStyle=H,this.lineCap=he,this.lineWidth=K,this.lineJoin=T;var kt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],it=Be===1?this.posY+this.margin[0]:this.margin[0],Ft=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Tt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ot=Be===1?0:Ft+(Be-2)*Tt;if(this.ctx.clip_path.length!==0){var Jt=this.path;q=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=k(q,this.posX+this.margin[3],-ot+it+this.ctx.prevPageLastElemOffset),F.call(this,$,!0),this.path=Jt}if(I=JSON.parse(JSON.stringify(ee)),this.path=k(I,this.posX+this.margin[3],-ot+it+this.ctx.prevPageLastElemOffset),Q===!1||Be===0){var Vt=(Be>Oe||Be<Je)&&g.call(this);Vt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],kt,Tt,null).clip().discardPath()),F.call(this,$,Q),Vt&&this.pdf.restoreGraphicsState()}this.lineWidth=ge}else this.lineWidth=K,F.call(this,$,Q),this.lineWidth=ge;this.path=ee},F=function($,Q){if(($!=="stroke"||Q||!j.call(this))&&($==="stroke"||Q||!h.call(this))){for(var q,I,Y=[],H=this.path,he=0;he<H.length;he++){var ge=H[he];switch(ge.type){case"begin":Y.push({begin:!0});break;case"close":Y.push({close:!0});break;case"mt":Y.push({start:ge,deltas:[],abs:[]});break;case"lt":var K=Y.length;if(H[he-1]&&!isNaN(H[he-1].x)&&(q=[ge.x-H[he-1].x,ge.y-H[he-1].y],K>0)){for(;K>=0;K--)if(Y[K-1].close!==!0&&Y[K-1].begin!==!0){Y[K-1].deltas.push(q),Y[K-1].abs.push(ge);break}}break;case"bct":q=[ge.x1-H[he-1].x,ge.y1-H[he-1].y,ge.x2-H[he-1].x,ge.y2-H[he-1].y,ge.x-H[he-1].x,ge.y-H[he-1].y],Y[Y.length-1].deltas.push(q);break;case"qct":var T=H[he-1].x+2/3*(ge.x1-H[he-1].x),ee=H[he-1].y+2/3*(ge.y1-H[he-1].y),_e=ge.x+2/3*(ge.x1-ge.x),ke=ge.y+2/3*(ge.y1-ge.y),ue=ge.x,je=ge.y;q=[T-H[he-1].x,ee-H[he-1].y,_e-H[he-1].x,ke-H[he-1].y,ue-H[he-1].x,je-H[he-1].y],Y[Y.length-1].deltas.push(q);break;case"arc":Y.push({deltas:[],abs:[],arc:!0}),Array.isArray(Y[Y.length-1].abs)&&Y[Y.length-1].abs.push(ge)}}I=Q?null:$==="stroke"?"stroke":"fill";for(var ne=!1,Re=0;Re<Y.length;Re++)if(Y[Re].arc)for(var Oe=Y[Re].abs,Je=0;Je<Oe.length;Je++){var Be=Oe[Je];Be.type==="arc"?B.call(this,Be.x,Be.y,Be.radius,Be.startAngle,Be.endAngle,Be.counterclockwise,void 0,Q,!ne):Z.call(this,Be.x,Be.y),ne=!0}else if(Y[Re].close===!0)this.pdf.internal.out("h"),ne=!1;else if(Y[Re].begin!==!0){var kt=Y[Re].start.x,it=Y[Re].start.y;te.call(this,Y[Re].deltas,kt,it),ne=!0}I&&A.call(this,I),Q&&S.call(this)}},W=function($){var Q=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,q=Q*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return $-q;case"top":return $+Q-q;case"hanging":return $+Q-2*q;case"middle":return $+Q/2-q;default:return $}},R=function($){return $+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};x.prototype.createLinearGradient=function(){var $=function(){};return $.colorStops=[],$.addColorStop=function(Q,q){this.colorStops.push([Q,q])},$.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},$.isCanvasGradient=!0,$},x.prototype.createPattern=function(){return this.createLinearGradient()},x.prototype.createRadialGradient=function(){return this.createLinearGradient()};var B=function($,Q,q,I,Y,H,he,ge,K){for(var T=re.call(this,q,I,Y,H),ee=0;ee<T.length;ee++){var _e=T[ee];ee===0&&(K?C.call(this,_e.x1+$,_e.y1+Q):Z.call(this,_e.x1+$,_e.y1+Q)),ce.call(this,$,Q,_e.x2,_e.y2,_e.x3,_e.y3,_e.x4,_e.y4)}ge?S.call(this):A.call(this,he)},A=function($){switch($){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},S=function(){this.pdf.clip(),this.pdf.discardPath()},C=function($,Q){this.pdf.internal.out(r($)+" "+a(Q)+" m")},O=function($){var Q;switch($.align){case"right":case"end":Q="right";break;case"center":Q="center";break;default:Q="left"}var q=this.pdf.getTextDimensions($.text),I=W.call(this,$.y),Y=R.call(this,I)-q.h,H=this.ctx.transform.applyToPoint(new o($.x,I)),he=this.ctx.transform.decompose(),ge=new d;ge=(ge=(ge=ge.multiply(he.translate)).multiply(he.skew)).multiply(he.scale);for(var K,T,ee,_e=this.ctx.transform.applyToRectangle(new c($.x,I,q.w,q.h)),ke=ge.applyToRectangle(new c($.x,Y,q.w,q.h)),ue=v.call(this,ke),je=[],ne=0;ne<ue.length;ne+=1)je.indexOf(ue[ne])===-1&&je.push(ue[ne]);if(P(je),this.autoPaging)for(var Re=je[0],Oe=je[je.length-1],Je=Re;Je<Oe+1;Je++){this.pdf.setPage(Je);var Be=Je===1?this.posY+this.margin[0]:this.margin[0],kt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],it=this.pdf.internal.pageSize.height-this.margin[2],Ft=it-this.margin[0],Tt=this.pdf.internal.pageSize.width-this.margin[1],ot=Tt-this.margin[3],Jt=Je===1?0:kt+(Je-2)*Ft;if(this.ctx.clip_path.length!==0){var Vt=this.path;K=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=k(K,this.posX+this.margin[3],-1*Jt+Be),F.call(this,"fill",!0),this.path=Vt}var wt=k([JSON.parse(JSON.stringify(ke))],this.posX+this.margin[3],-Jt+Be+this.ctx.prevPageLastElemOffset)[0];$.scale>=.01&&(T=this.pdf.internal.getFontSize(),this.pdf.setFontSize(T*$.scale),ee=this.lineWidth,this.lineWidth=ee*$.scale);var Nt=this.autoPaging!=="text";if(Nt||wt.y+wt.h<=it){if(Nt||wt.y>=Be&&wt.x<=Tt){var bt=Nt?$.text:this.pdf.splitTextToSize($.text,$.maxWidth||Tt-wt.x)[0],jr=k([JSON.parse(JSON.stringify(_e))],this.posX+this.margin[3],-Jt+Be+this.ctx.prevPageLastElemOffset)[0],Zt=Nt&&(Je>Re||Je<Oe)&&g.call(this);Zt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ot,Ft,null).clip().discardPath()),this.pdf.text(bt,jr.x,jr.y,{angle:$.angle,align:Q,renderingMode:$.renderingMode}),Zt&&this.pdf.restoreGraphicsState()}}else wt.y<it&&(this.ctx.prevPageLastElemOffset+=it-wt.y);$.scale>=.01&&(this.pdf.setFontSize(T),this.lineWidth=ee)}else $.scale>=.01&&(T=this.pdf.internal.getFontSize(),this.pdf.setFontSize(T*$.scale),ee=this.lineWidth,this.lineWidth=ee*$.scale),this.pdf.text($.text,H.x+this.posX,H.y+this.posY,{angle:$.angle,align:Q,renderingMode:$.renderingMode,maxWidth:$.maxWidth}),$.scale>=.01&&(this.pdf.setFontSize(T),this.lineWidth=ee)},Z=function($,Q,q,I){q=q||0,I=I||0,this.pdf.internal.out(r($+q)+" "+a(Q+I)+" l")},te=function($,Q,q){return this.pdf.lines($,Q,q,null,null)},ce=function($,Q,q,I,Y,H,he,ge){this.pdf.internal.out([t(n(q+$)),t(i(I+Q)),t(n(Y+$)),t(i(H+Q)),t(n(he+$)),t(i(ge+Q)),"c"].join(" "))},re=function($,Q,q,I){for(var Y=2*Math.PI,H=Math.PI/2;Q>q;)Q-=Y;var he=Math.abs(q-Q);he<Y&&I&&(he=Y-he);for(var ge=[],K=I?-1:1,T=Q;he>1e-5;){var ee=T+K*Math.min(he,H);ge.push(X.call(this,$,T,ee)),he-=Math.abs(ee-T),T=ee}return ge},X=function($,Q,q){var I=(q-Q)/2,Y=$*Math.cos(I),H=$*Math.sin(I),he=Y,ge=-H,K=he*he+ge*ge,T=K+he*Y+ge*H,ee=4/3*(Math.sqrt(2*K*T)-T)/(he*H-ge*Y),_e=he-ee*ge,ke=ge+ee*he,ue=_e,je=-ke,ne=I+Q,Re=Math.cos(ne),Oe=Math.sin(ne);return{x1:$*Math.cos(Q),y1:$*Math.sin(Q),x2:_e*Re-ke*Oe,y2:_e*Oe+ke*Re,x3:ue*Re-je*Oe,y3:ue*Oe+je*Re,x4:$*Math.cos(q),y4:$*Math.sin(q)}},U=function($){return 180*$/Math.PI},oe=function($,Q,q,I,Y,H){var he=$+.5*(q-$),ge=Q+.5*(I-Q),K=Y+.5*(q-Y),T=H+.5*(I-H),ee=Math.min($,Y,he,K),_e=Math.max($,Y,he,K),ke=Math.min(Q,H,ge,T),ue=Math.max(Q,H,ge,T);return new c(ee,ke,_e-ee,ue-ke)},xe=function($,Q,q,I,Y,H,he,ge){var K,T,ee,_e,ke,ue,je,ne,Re,Oe,Je,Be,kt,it,Ft=q-$,Tt=I-Q,ot=Y-q,Jt=H-I,Vt=he-Y,wt=ge-H;for(T=0;T<41;T++)Re=(je=(ee=$+(K=T/40)*Ft)+K*((ke=q+K*ot)-ee))+K*(ke+K*(Y+K*Vt-ke)-je),Oe=(ne=(_e=Q+K*Tt)+K*((ue=I+K*Jt)-_e))+K*(ue+K*(H+K*wt-ue)-ne),T==0?(Je=Re,Be=Oe,kt=Re,it=Oe):(Je=Math.min(Je,Re),Be=Math.min(Be,Oe),kt=Math.max(kt,Re),it=Math.max(it,Oe));return new c(Math.round(Je),Math.round(Be),Math.round(kt-Je),Math.round(it-Be))},J=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var $,Q,q=($=this.ctx.lineDash,Q=this.ctx.lineDashOffset,JSON.stringify({lineDash:$,lineDashOffset:Q}));this.prevLineDash!==q&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=q)}}})(It.API),(function(s){var t=function(o){var c,d,p,m,x,b,h,j,g,v;for(d=[],p=0,m=(o+=c="\0\0\0\0".slice(o.length%4||4)).length;m>p;p+=4)(x=(o.charCodeAt(p)<<24)+(o.charCodeAt(p+1)<<16)+(o.charCodeAt(p+2)<<8)+o.charCodeAt(p+3))!==0?(b=(x=((x=((x=((x=(x-(v=x%85))/85)-(g=x%85))/85)-(j=x%85))/85)-(h=x%85))/85)%85,d.push(b+33,h+33,j+33,g+33,v+33)):d.push(122);return(function(_,k){for(var P=k;P>0;P--)_.pop()})(d,c.length),String.fromCharCode.apply(String,d)+"~>"},r=function(o){var c,d,p,m,x,b=String,h="length",j=255,g="charCodeAt",v="slice",_="replace";for(o[v](-2),o=o[v](0,-2)[_](/\s/g,"")[_]("z","!!!!!"),p=[],m=0,x=(o+=c="uuuuu"[v](o[h]%5||5))[h];x>m;m+=5)d=52200625*(o[g](m)-33)+614125*(o[g](m+1)-33)+7225*(o[g](m+2)-33)+85*(o[g](m+3)-33)+(o[g](m+4)-33),p.push(j&d>>24,j&d>>16,j&d>>8,j&d);return(function(k,P){for(var L=P;L>0;L--)k.pop()})(p,c[h]),b.fromCharCode.apply(b,p)},a=function(o){return o.split("").map(function(c){return("0"+c.charCodeAt().toString(16)).slice(-2)}).join("")+">"},n=function(o){var c=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),c.test(o)===!1)return"";for(var d="",p=0;p<o.length;p+=2)d+=String.fromCharCode("0x"+(o[p]+o[p+1]));return d},i=function(o){for(var c=new Uint8Array(o.length),d=o.length;d--;)c[d]=o.charCodeAt(d);return(c=Vb(c)).reduce(function(p,m){return p+String.fromCharCode(m)},"")};s.processDataByFilters=function(o,c){var d=0,p=o||"",m=[];for(typeof(c=c||[])=="string"&&(c=[c]),d=0;d<c.length;d+=1)switch(c[d]){case"ASCII85Decode":case"/ASCII85Decode":p=r(p),m.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":p=t(p),m.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":p=n(p),m.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":p=a(p),m.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":p=i(p),m.push("/FlateDecode");break;default:throw new Error('The filter: "'+c[d]+'" is not implemented')}return{data:p,reverseChain:m.reverse().join(" ")}}})(It.API),(function(s){s.loadFile=function(t,r,a){return(function(n,i,o){i=i!==!1,o=typeof o=="function"?o:function(){};var c=void 0;try{c=(function(d,p,m){var x=new XMLHttpRequest,b=0,h=function(j){var g=j.length,v=[],_=String.fromCharCode;for(b=0;b<g;b+=1)v.push(_(255&j.charCodeAt(b)));return v.join("")};if(x.open("GET",d,!p),x.overrideMimeType("text/plain; charset=x-user-defined"),p===!1&&(x.onload=function(){x.status===200?m(h(this.responseText)):m(void 0)}),x.send(null),p&&x.status===200)return h(x.responseText)})(n,i,o)}catch{}return c})(t,r,a)},s.loadImageFile=s.loadFile})(It.API),(function(s){function t(){return(Qt.html2canvas?Promise.resolve(Qt.html2canvas):gp(()=>import("./html2canvas.esm-QH1iLAAe.js"),[])).catch(function(c){return Promise.reject(new Error("Could not load html2canvas: "+c))}).then(function(c){return c.default?c.default:c})}function r(){return(Qt.DOMPurify?Promise.resolve(Qt.DOMPurify):gp(()=>import("./purify.es-B6FQ9oRL.js"),[])).catch(function(c){return Promise.reject(new Error("Could not load dompurify: "+c))}).then(function(c){return c.default?c.default:c})}var a=function(c){var d=Zr(c);return d==="undefined"?"undefined":d==="string"||c instanceof String?"string":d==="number"||c instanceof Number?"number":d==="function"||c instanceof Function?"function":c&&c.constructor===Array?"array":c&&c.nodeType===1?"element":d==="object"?"object":"unknown"},n=function(c,d){var p=document.createElement(c);for(var m in d.className&&(p.className=d.className),d.innerHTML&&d.dompurify&&(p.innerHTML=d.dompurify.sanitize(d.innerHTML)),d.style)p.style[m]=d.style[m];return p},i=function c(d,p){for(var m=d.nodeType===3?document.createTextNode(d.nodeValue):d.cloneNode(!1),x=d.firstChild;x;x=x.nextSibling)p!==!0&&x.nodeType===1&&x.nodeName==="SCRIPT"||m.appendChild(c(x,p));return d.nodeType===1&&(d.nodeName==="CANVAS"?(m.width=d.width,m.height=d.height,m.getContext("2d").drawImage(d,0,0)):d.nodeName!=="TEXTAREA"&&d.nodeName!=="SELECT"||(m.value=d.value),m.addEventListener("load",function(){m.scrollTop=d.scrollTop,m.scrollLeft=d.scrollLeft},!0)),m},o=function c(d){var p=Object.assign(c.convert(Promise.resolve()),JSON.parse(JSON.stringify(c.template))),m=c.convert(Promise.resolve(),p);return(m=m.setProgress(1,c,1,[c])).set(d)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(c,d){return c.__proto__=d||o.prototype,c},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(c,d){return this.then(function(){switch(d=d||(function(p){switch(a(p)){case"string":return"string";case"element":return p.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(c),d){case"string":return this.then(r).then(function(p){return this.set({src:n("div",{innerHTML:c,dompurify:p})})});case"element":return this.set({src:c});case"canvas":return this.set({canvas:c});case"img":return this.set({img:c});default:return this.error("Unknown source type.")}})},o.prototype.to=function(c){switch(c){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var c={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},d=i(this.prop.src,this.opt.html2canvas.javascriptEnabled);d.tagName==="BODY"&&(c.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=n("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=n("div",{className:"html2pdf__container",style:c}),this.prop.container.appendChild(d),this.prop.container.firstChild.appendChild(n("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var c=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(c).then(t).then(function(d){var p=Object.assign({},this.opt.html2canvas);return delete p.onrendered,d(this.prop.container,p)}).then(function(d){(this.opt.html2canvas.onrendered||function(){})(d),this.prop.canvas=d,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var c=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(c).then(t).then(function(d){var p=this.opt.jsPDF,m=this.opt.fontFaces,x=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,b=Object.assign({async:!0,allowTaint:!0,scale:x,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete b.onrendered,p.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,p.context2d.posX=this.opt.x,p.context2d.posY=this.opt.y,p.context2d.margin=this.opt.margin,p.context2d.fontFaces=m,m)for(var h=0;h<m.length;++h){var j=m[h],g=j.src.find(function(v){return v.format==="truetype"});g&&p.addFont(g.url,j.ref.name,j.ref.style)}return b.windowHeight=b.windowHeight||0,b.windowHeight=b.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):b.windowHeight,p.context2d.save(!0),d(this.prop.container,b)}).then(function(d){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(d),this.prop.canvas=d,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var c=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=c})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(c,d,p){return(p=p||"pdf").toLowerCase()==="img"||p.toLowerCase()==="image"?this.outputImg(c,d):this.outputPdf(c,d)},o.prototype.outputPdf=function(c,d){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(c,d)})},o.prototype.outputImg=function(c){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(c){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+c+'" is not supported.'}})},o.prototype.save=function(c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(c?{filename:c}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(c){if(a(c)!=="object")return this;var d=Object.keys(c||{}).map(function(p){if(p in o.template.prop)return function(){this.prop[p]=c[p]};switch(p){case"margin":return this.setMargin.bind(this,c.margin);case"jsPDF":return function(){return this.opt.jsPDF=c.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,c.pageSize);default:return function(){this.opt[p]=c[p]}}},this);return this.then(function(){return this.thenList(d)})},o.prototype.get=function(c,d){return this.then(function(){var p=c in o.template.prop?this.prop[c]:this.opt[c];return d?d(p):p})},o.prototype.setMargin=function(c){return this.then(function(){switch(a(c)){case"number":c=[c,c,c,c];case"array":if(c.length===2&&(c=[c[0],c[1],c[0],c[1]]),c.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=c}).then(this.setPageSize)},o.prototype.setPageSize=function(c){function d(p,m){return Math.floor(p*m/72*96)}return this.then(function(){(c=c||It.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(c.inner={width:c.width-this.opt.margin[1]-this.opt.margin[3],height:c.height-this.opt.margin[0]-this.opt.margin[2]},c.inner.px={width:d(c.inner.width,c.k),height:d(c.inner.height,c.k)},c.inner.ratio=c.inner.height/c.inner.width),this.prop.pageSize=c})},o.prototype.setProgress=function(c,d,p,m){return c!=null&&(this.progress.val=c),d!=null&&(this.progress.state=d),p!=null&&(this.progress.n=p),m!=null&&(this.progress.stack=m),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(c,d,p,m){return this.setProgress(c?this.progress.val+c:null,d||null,p?this.progress.n+p:null,m?this.progress.stack.concat(m):null)},o.prototype.then=function(c,d){var p=this;return this.thenCore(c,d,function(m,x){return p.updateProgress(null,null,1,[m]),Promise.prototype.then.call(this,function(b){return p.updateProgress(null,m),b}).then(m,x).then(function(b){return p.updateProgress(1),b})})},o.prototype.thenCore=function(c,d,p){p=p||Promise.prototype.then;var m=this;c&&(c=c.bind(m)),d&&(d=d.bind(m));var x=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?m:o.convert(Object.assign({},m),Promise.prototype),b=p.call(x,c,d);return o.convert(b,m.__proto__)},o.prototype.thenExternal=function(c,d){return Promise.prototype.then.call(this,c,d)},o.prototype.thenList=function(c){var d=this;return c.forEach(function(p){d=d.thenCore(p)}),d},o.prototype.catch=function(c){c&&(c=c.bind(this));var d=Promise.prototype.catch.call(this,c);return o.convert(d,this)},o.prototype.catchExternal=function(c){return Promise.prototype.catch.call(this,c)},o.prototype.error=function(c){return this.then(function(){throw new Error(c)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,It.getPageSize=function(c,d,p){if(Zr(c)==="object"){var m=c;c=m.orientation,d=m.unit||d,p=m.format||p}d=d||"mm",p=p||"a4",c=(""+(c||"P")).toLowerCase();var x,b=(""+p).toLowerCase(),h={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(d){case"pt":x=1;break;case"mm":x=72/25.4;break;case"cm":x=72/2.54;break;case"in":x=72;break;case"px":x=.75;break;case"pc":case"em":x=12;break;case"ex":x=6;break;default:throw"Invalid unit: "+d}var j,g=0,v=0;if(h.hasOwnProperty(b))g=h[b][1]/x,v=h[b][0]/x;else try{g=p[1],v=p[0]}catch{throw new Error("Invalid format: "+p)}if(c==="p"||c==="portrait")c="p",v>g&&(j=v,v=g,g=j);else{if(c!=="l"&&c!=="landscape")throw"Invalid orientation: "+c;c="l",g>v&&(j=v,v=g,g=j)}return{width:v,height:g,unit:d,k:x,orientation:c}},s.html=function(c,d){(d=d||{}).callback=d.callback||function(){},d.html2canvas=d.html2canvas||{},d.html2canvas.canvas=d.html2canvas.canvas||this.canvas,d.jsPDF=d.jsPDF||this,d.fontFaces=d.fontFaces?d.fontFaces.map(sb):null;var p=new o(d);return d.worker?p:p.from(c).doCallback()}})(It.API),It.API.addJS=function(s){return m_=s,this.internal.events.subscribe("postPutResources",function(){ph=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(ph+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),p_=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+m_+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){ph!==void 0&&p_!==void 0&&this.internal.out("/Names <</JavaScript "+ph+" 0 R>>")}),this},(function(s){var t;s.events.push(["postPutResources",function(){var r=this,a=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var n=r.outline.render().split(/\r\n/),i=0;i<n.length;i++){var o=n[i],c=a.exec(o);if(c!=null){var d=c[1];r.internal.newObjectDeferredBegin(d,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var p=this.internal.pages.length,m=[];for(i=0;i<p;i++){var x=r.internal.newObject();m.push(x);var b=r.internal.getPageInfo(i+1);r.internal.write("<< /D["+b.objId+" 0 R /XYZ null null null]>> endobj")}var h=r.internal.newObject();for(r.internal.write("<< /Names [ "),i=0;i<m.length;i++)r.internal.write("(page_"+(i+1)+")"+m[i]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+h+" 0 R"),r.internal.write(">>","endobj")}}]),s.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),s.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(a,n,i){var o={title:n,options:i,children:[]};return a==null&&(a=this.root),a.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(a){a.id=r.internal.newObjectDeferred();for(var n=0;n<a.children.length;n++)this.genIds_r(a.children[n])},r.outline.renderRoot=function(a){this.objStart(a),this.line("/Type /Outlines"),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1]))),this.line("/Count "+this.count_r({count:0},a)),this.objEnd()},r.outline.renderItems=function(a){for(var n=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<a.children.length;i++){var o=a.children[i];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(a)),i>0&&this.line("/Prev "+this.makeRef(a.children[i-1])),i<a.children.length-1&&this.line("/Next "+this.makeRef(a.children[i+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var c=this.count=this.count_r({count:0},o);if(c>0&&this.line("/Count "+c),o.options&&o.options.pageNumber){var d=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+d.objId+" 0 R /XYZ 0 "+n(0)+" 0]")}this.objEnd()}for(var p=0;p<a.children.length;p++)this.renderItems(a.children[p])},r.outline.line=function(a){this.ctx.val+=a+`\r
`},r.outline.makeRef=function(a){return a.id+" 0 R"},r.outline.makeString=function(a){return"("+r.internal.pdfEscape(a)+")"},r.outline.objStart=function(a){this.ctx.val+=`\r
`+a.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(a,n){for(var i=0;i<n.children.length;i++)a.count++,this.count_r(a,n.children[i]);return a.count}}])})(It.API),(function(s){var t=[192,193,194,195,196,197,198,199];s.processJPEG=function(r,a,n,i,o,c){var d,p=this.decode.DCT_DECODE,m=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,d=(function(x){for(var b,h=256*x.charCodeAt(4)+x.charCodeAt(5),j=x.length,g={width:0,height:0,numcomponents:1},v=4;v<j;v+=2){if(v+=h,t.indexOf(x.charCodeAt(v+1))!==-1){b=256*x.charCodeAt(v+5)+x.charCodeAt(v+6),g={width:256*x.charCodeAt(v+7)+x.charCodeAt(v+8),height:b,numcomponents:x.charCodeAt(v+9)};break}h=256*x.charCodeAt(v+2)+x.charCodeAt(v+3)}return g})(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),d.numcomponents){case 1:c=this.color_spaces.DEVICE_GRAY;break;case 4:c=this.color_spaces.DEVICE_CMYK;break;case 3:c=this.color_spaces.DEVICE_RGB}m={data:r,width:d.width,height:d.height,colorSpace:c,bitsPerComponent:8,filter:p,index:a,alias:n}}return m}})(It.API),It.API.processPNG=function(s,t,r,a){if(this.__addimage__.isArrayBuffer(s)&&(s=new Uint8Array(s)),this.__addimage__.isArrayBufferView(s)){var n,i=vO(s,{checkCrc:!0}),o=i.width,c=i.height,d=i.channels,p=i.palette,m=i.depth;n=p&&d===1?(function(B){for(var A=B.width,S=B.height,C=B.data,O=B.palette,Z=B.depth,te=!1,ce=[],re=[],X=void 0,U=!1,oe=0,xe=0;xe<O.length;xe++){var J=bj(O[xe],4),$=J[0],Q=J[1],q=J[2],I=J[3];ce.push($,Q,q),I!=null&&(I===0?(oe++,re.length<1&&re.push(xe)):I<255&&(U=!0))}if(U||oe>1){te=!0,re=void 0;var Y=A*S;X=new Uint8Array(Y);for(var H=new DataView(C.buffer),he=0;he<Y;he++){var ge=nb(H,he,Z),K=bj(O[ge],4)[3];X[he]=K}}else oe===0&&(re=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:te?8:void 0,colorBytes:C,alphaBytes:X,needSMask:te,palette:ce,mask:re}})(i):d===2||d===4?(function(B){for(var A=B.data,S=B.width,C=B.height,O=B.channels,Z=B.depth,te=O===2?"DeviceGray":"DeviceRGB",ce=O-1,re=S*C,X=ce,U=re*X,oe=1*re,xe=Math.ceil(U*Z/8),J=Math.ceil(oe*Z/8),$=new Uint8Array(xe),Q=new Uint8Array(J),q=new DataView(A.buffer),I=new DataView($.buffer),Y=new DataView(Q.buffer),H=!1,he=0;he<re;he++){for(var ge=he*O,K=0;K<X;K++)__(I,nb(q,ge+K,Z),he*X+K,Z);var T=nb(q,ge+X,Z);T<(1<<Z)-1&&(H=!0),__(Y,T,1*he,Z)}return{colorSpace:te,colorsPerPixel:ce,sMaskBitsPerComponent:H?Z:void 0,colorBytes:$,alphaBytes:Q,needSMask:H}})(i):(function(B){var A=B.data,S=B.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:S,colorsPerPixel:S==="DeviceGray"?1:3,colorBytes:A instanceof Uint16Array?(function(C){for(var O=C.length,Z=new Uint8Array(2*O),te=new DataView(Z.buffer,Z.byteOffset,Z.byteLength),ce=0;ce<O;ce++)te.setUint16(2*ce,C[ce],!1);return Z})(A):A,needSMask:!1}})(i);var x,b,h,j=n,g=j.colorSpace,v=j.colorsPerPixel,_=j.sMaskBitsPerComponent,k=j.colorBytes,P=j.alphaBytes,L=j.needSMask,F=j.palette,W=j.mask,R=null;return a!==It.API.image_compression.NONE&&typeof Vb=="function"?(R=(function(B){var A;switch(B){case It.API.image_compression.FAST:A=11;break;case It.API.image_compression.MEDIUM:A=13;break;case It.API.image_compression.SLOW:A=14;break;default:A=12}return A})(a),x=this.decode.FLATE_DECODE,b="/Predictor ".concat(R," /Colors ").concat(v," /BitsPerComponent ").concat(m," /Columns ").concat(o),s=b_(k,Math.ceil(o*v*m/8),v,m,a),L&&(h=b_(P,Math.ceil(o*_/8),1,_,a))):(x=void 0,b=void 0,s=k,L&&(h=P)),(this.__addimage__.isArrayBuffer(s)||this.__addimage__.isArrayBufferView(s))&&(s=this.__addimage__.arrayBufferToBinaryString(s)),(h&&this.__addimage__.isArrayBuffer(h)||this.__addimage__.isArrayBufferView(h))&&(h=this.__addimage__.arrayBufferToBinaryString(h)),{alias:r,data:s,index:t,filter:x,decodeParameters:b,transparency:W,palette:F,sMask:h,predictor:R,width:o,height:c,bitsPerComponent:m,sMaskBitsPerComponent:_,colorSpace:g}}},(function(s){s.processGIF89A=function(t,r,a,n){var i=new UO(t),o=i.width,c=i.height,d=[];i.decodeAndBlitFrameRGBA(0,d);var p={data:d,width:o,height:c},m=new ib(100).encode(p,100);return s.processJPEG.call(this,m,r,a,n)},s.processGIF87A=s.processGIF89A})(It.API),Fi.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var s=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(s);for(var t=0;t<s;t++){var r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:n,green:a,blue:r,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Fi.prototype.parseBGR=function(){this.pos=this.offset;try{var s="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[s]()}catch(r){Xr.log("bit decode error:"+r)}},Fi.prototype.bit1=function(){var s,t=Math.ceil(this.width/8),r=t%4;for(s=this.height-1;s>=0;s--){for(var a=this.bottom_up?s:this.height-1-s,n=0;n<t;n++)for(var i=this.datav.getUint8(this.pos++,!0),o=a*this.width*4+8*n*4,c=0;c<8&&8*n+c<this.width;c++){var d=this.palette[i>>7-c&1];this.data[o+4*c]=d.blue,this.data[o+4*c+1]=d.green,this.data[o+4*c+2]=d.red,this.data[o+4*c+3]=255}r!==0&&(this.pos+=4-r)}},Fi.prototype.bit4=function(){for(var s=Math.ceil(this.width/2),t=s%4,r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<s;n++){var i=this.datav.getUint8(this.pos++,!0),o=a*this.width*4+2*n*4,c=i>>4,d=15&i,p=this.palette[c];if(this.data[o]=p.blue,this.data[o+1]=p.green,this.data[o+2]=p.red,this.data[o+3]=255,2*n+1>=this.width)break;p=this.palette[d],this.data[o+4]=p.blue,this.data[o+4+1]=p.green,this.data[o+4+2]=p.red,this.data[o+4+3]=255}t!==0&&(this.pos+=4-t)}},Fi.prototype.bit8=function(){for(var s=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,a=0;a<this.width;a++){var n=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+4*a;if(n<this.palette.length){var o=this.palette[n];this.data[i]=o.red,this.data[i+1]=o.green,this.data[i+2]=o.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}s!==0&&(this.pos+=4-s)}},Fi.prototype.bit15=function(){for(var s=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<this.width;n++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(i&t)/t*255|0,c=(i>>5&t)/t*255|0,d=(i>>10&t)/t*255|0,p=i>>15?255:0,m=a*this.width*4+4*n;this.data[m]=d,this.data[m+1]=c,this.data[m+2]=o,this.data[m+3]=p}this.pos+=s}},Fi.prototype.bit16=function(){for(var s=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),a=this.height-1;a>=0;a--){for(var n=this.bottom_up?a:this.height-1-a,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var c=(o&t)/t*255|0,d=(o>>5&r)/r*255|0,p=(o>>11)/t*255|0,m=n*this.width*4+4*i;this.data[m]=p,this.data[m+1]=d,this.data[m+2]=c,this.data[m+3]=255}this.pos+=s}},Fi.prototype.bit24=function(){for(var s=this.height-1;s>=0;s--){for(var t=this.bottom_up?s:this.height-1-s,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=i,this.data[o+1]=n,this.data[o+2]=a,this.data[o+3]=255}this.pos+=this.width%4}},Fi.prototype.bit32=function(){for(var s=this.height-1;s>=0;s--)for(var t=this.bottom_up?s:this.height-1-s,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),c=t*this.width*4+4*r;this.data[c]=i,this.data[c+1]=n,this.data[c+2]=a,this.data[c+3]=o}},Fi.prototype.getData=function(){return this.data},(function(s){s.processBMP=function(t,r,a,n){var i=new Fi(t,!1),o=i.width,c=i.height,d={data:i.getData(),width:o,height:c},p=new ib(100).encode(d,100);return s.processJPEG.call(this,p,r,a,n)}})(It.API),N_.prototype.getData=function(){return this.data},(function(s){s.processWEBP=function(t,r,a,n){var i=new N_(t),o=i.width,c=i.height,d={data:i.getData(),width:o,height:c},p=new ib(100).encode(d,100);return s.processJPEG.call(this,p,r,a,n)}})(It.API),It.API.processRGBA=function(s,t,r){for(var a=s.data,n=a.length,i=new Uint8Array(n/4*3),o=new Uint8Array(n/4),c=0,d=0,p=0;p<n;p+=4){var m=a[p],x=a[p+1],b=a[p+2],h=a[p+3];i[c++]=m,i[c++]=x,i[c++]=b,o[d++]=h}var j=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:j,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:s.width,height:s.height}},It.API.setLanguage=function(s){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[s]!==void 0&&(this.internal.languageSettings.languageCode=s,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},eu=It.API,mh=eu.getCharWidthsArray=function(s,t){var r,a,n=(t=t||{}).font||this.internal.getFont(),i=t.fontSize||this.internal.getFontSize(),o=t.charSpace||this.internal.getCharSpace(),c=t.widths?t.widths:n.metadata.Unicode.widths,d=c.fof?c.fof:1,p=t.kerning?t.kerning:n.metadata.Unicode.kerning,m=p.fof?p.fof:1,x=t.doKerning!==!1,b=0,h=s.length,j=0,g=c[0]||d,v=[];for(r=0;r<h;r++)a=s.charCodeAt(r),typeof n.metadata.widthOfString=="function"?v.push((n.metadata.widthOfGlyph(n.metadata.characterToGlyph(a))+o*(1e3/i)||0)/1e3):(b=x&&Zr(p[a])==="object"&&!isNaN(parseInt(p[a][j],10))?p[a][j]/m:0,v.push((c[a]||g)/d+b)),j=a;return v},h_=eu.getStringUnitWidth=function(s,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),a=t.font||this.internal.getFont(),n=t.charSpace||this.internal.getCharSpace();return eu.processArabic&&(s=eu.processArabic(s)),typeof a.metadata.widthOfString=="function"?a.metadata.widthOfString(s,r,n)/r:mh.apply(this,arguments).reduce(function(i,o){return i+o},0)},x_=function(s,t,r,a){for(var n=[],i=0,o=s.length,c=0;i!==o&&c+t[i]<r;)c+=t[i],i++;n.push(s.slice(0,i));var d=i;for(c=0;i!==o;)c+t[i]>a&&(n.push(s.slice(d,i)),c=0,d=i),c+=t[i],i++;return d!==i&&n.push(s.slice(d,i)),n},f_=function(s,t,r){r||(r={});var a,n,i,o,c,d,p,m=[],x=[m],b=r.textIndent||0,h=0,j=0,g=s.split(" "),v=mh.apply(this,[" ",r])[0];if(d=r.lineIndent===-1?g[0].length+2:r.lineIndent||0){var _=Array(d).join(" "),k=[];g.map(function(L){(L=L.split(/\s*\n/)).length>1?k=k.concat(L.map(function(F,W){return(W&&F.length?`
`:"")+F})):k.push(L[0])}),g=k,d=h_.apply(this,[_,r])}for(i=0,o=g.length;i<o;i++){var P=0;if(a=g[i],d&&a[0]==`
`&&(a=a.substr(1),P=1),b+h+(j=(n=mh.apply(this,[a,r])).reduce(function(L,F){return L+F},0))>t||P){if(j>t){for(c=x_.apply(this,[a,n,t-(b+h),t]),m.push(c.shift()),m=[c.pop()];c.length;)x.push([c.shift()]);j=n.slice(a.length-(m[0]?m[0].length:0)).reduce(function(L,F){return L+F},0)}else m=[a];x.push(m),b=j+d,h=v}else m.push(a),b+=h+j,h=v}return p=d?function(L,F){return(F?_:"")+L.join(" ")}:function(L){return L.join(" ")},x.map(p)},eu.splitTextToSize=function(s,t,r){var a,n=(r=r||{}).fontSize||this.internal.getFontSize(),i=(function(m){if(m.widths&&m.kerning)return{widths:m.widths,kerning:m.kerning};var x=this.internal.getFont(m.fontName,m.fontStyle),b="Unicode";return x.metadata[b]?{widths:x.metadata[b].widths||{0:1},kerning:x.metadata[b].kerning||{}}:{font:x.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);a=Array.isArray(s)?s:String(s).split(/\r?\n/);var o=1*this.internal.scaleFactor*t/n;i.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/n:0,i.lineIndent=r.lineIndent;var c,d,p=[];for(c=0,d=a.length;c<d;c++)p=p.concat(f_.apply(this,[a[c],o,i]));return p},(function(s){s.__fontmetrics__=s.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",a={},n={},i=0;i<16;i++)a[r[i]]=t[i],n[t[i]]=r[i];var o=function(b){return"0x"+parseInt(b,10).toString(16)},c=s.__fontmetrics__.compress=function(b){var h,j,g,v,_=["{"];for(var k in b){if(h=b[k],isNaN(parseInt(k,10))?j="'"+k+"'":(k=parseInt(k,10),j=(j=o(k).slice(2)).slice(0,-1)+n[j.slice(-1)]),typeof h=="number")h<0?(g=o(h).slice(3),v="-"):(g=o(h).slice(2),v=""),g=v+g.slice(0,-1)+n[g.slice(-1)];else{if(Zr(h)!=="object")throw new Error("Don't know what to do with value type "+Zr(h)+".");g=c(h)}_.push(j+g)}return _.push("}"),_.join("")},d=s.__fontmetrics__.uncompress=function(b){if(typeof b!="string")throw new Error("Invalid argument passed to uncompress.");for(var h,j,g,v,_={},k=1,P=_,L=[],F="",W="",R=b.length-1,B=1;B<R;B+=1)(v=b[B])=="'"?h?(g=h.join(""),h=void 0):h=[]:h?h.push(v):v=="{"?(L.push([P,g]),P={},g=void 0):v=="}"?((j=L.pop())[0][j[1]]=P,g=void 0,P=j[0]):v=="-"?k=-1:g===void 0?a.hasOwnProperty(v)?(F+=a[v],g=parseInt(F,16)*k,k=1,F=""):F+=v:a.hasOwnProperty(v)?(W+=a[v],P[g]=parseInt(W,16)*k,k=1,g=void 0,W=""):W+=v;return _},p={codePages:["WinAnsiEncoding"],WinAnsiEncoding:d("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},m={Unicode:{Courier:p,"Courier-Bold":p,"Courier-BoldOblique":p,"Courier-Oblique":p,Helvetica:p,"Helvetica-Bold":p,"Helvetica-BoldOblique":p,"Helvetica-Oblique":p,"Times-Roman":p,"Times-Bold":p,"Times-BoldItalic":p,"Times-Italic":p}},x={Unicode:{"Courier-Oblique":d("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":d("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":d("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:d("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":d("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":d("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:d("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:d("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":d("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:d("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":d("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":d("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":d("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":d("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};s.events.push(["addFont",function(b){var h=b.font,j=x.Unicode[h.postScriptName];j&&(h.metadata.Unicode={},h.metadata.Unicode.widths=j.widths,h.metadata.Unicode.kerning=j.kerning);var g=m.Unicode[h.postScriptName];g&&(h.metadata.Unicode.encoding=g,h.encoding=g.codePages[0])}])})(It.API),(function(s){var t=function(r){for(var a=r.length,n=new Uint8Array(a),i=0;i<a;i++)n[i]=r.charCodeAt(i);return n};s.API.events.push(["addFont",function(r){var a=void 0,n=r.font,i=r.instance;if(!n.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");if(typeof(a=i.existsFileInVFS(n.postScriptName)===!1?i.loadFile(n.postScriptName):i.getFileFromVFS(n.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");(function(o,c){c=/^\x00\x01\x00\x00/.test(c)?t(c):t(vh(c)),o.metadata=s.API.TTFFont.open(c),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(n,a)}}])})(It),It.API.addSvgAsImage=function(s,t,r,a,n,i,o,c){if(isNaN(t)||isNaN(r))throw Xr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(a)||isNaN(n))throw Xr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var d=document.createElement("canvas");d.width=a,d.height=n;var p=d.getContext("2d");p.fillStyle="#fff",p.fillRect(0,0,d.width,d.height);var m={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},x=this;return(Qt.canvg?Promise.resolve(Qt.canvg):gp(()=>import("./index.es-DNcblvQI.js"),[])).catch(function(b){return Promise.reject(new Error("Could not load canvg: "+b))}).then(function(b){return b.default?b.default:b}).then(function(b){return b.fromString(p,s,m)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(b){return b.render(m)}).then(function(){x.addImage(d.toDataURL("image/jpeg",1),t,r,a,n,o,c)})},It.API.putTotalPages=function(s){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(s,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(s,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var a=1;a<=this.internal.getNumberOfPages();a++)for(var n=0;n<this.internal.pages[a].length;n++)this.internal.pages[a][n]=this.internal.pages[a][n].replace(t,r);return this},It.API.viewerPreferences=function(s,t){var r;s=s||{},t=t||!1;var a,n,i,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},c=Object.keys(o),d=[],p=0,m=0,x=0;function b(j,g){var v,_=!1;for(v=0;v<j.length;v+=1)j[v]===g&&(_=!0);return _}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,s==="reset"||t===!0){var h=c.length;for(x=0;x<h;x+=1)r[c[x]].value=r[c[x]].defaultValue,r[c[x]].explicitSet=!1}if(Zr(s)==="object"){for(n in s)if(i=s[n],b(c,n)&&i!==void 0){if(r[n].type==="boolean"&&typeof i=="boolean")r[n].value=i;else if(r[n].type==="name"&&b(r[n].valueSet,i))r[n].value=i;else if(r[n].type==="integer"&&Number.isInteger(i))r[n].value=i;else if(r[n].type==="array"){for(p=0;p<i.length;p+=1)if(a=!0,i[p].length===1&&typeof i[p][0]=="number")d.push(String(i[p]-1));else if(i[p].length>1){for(m=0;m<i[p].length;m+=1)typeof i[p][m]!="number"&&(a=!1);a===!0&&d.push([i[p][0]-1,i[p][1]-1].join(" "))}r[n].value="["+d.join(" ")+"]"}else r[n].value=r[n].defaultValue;r[n].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var j,g=[];for(j in r)r[j].explicitSet===!0&&(r[j].type==="name"?g.push("/"+j+" /"+r[j].value):g.push("/"+j+" "+r[j].value));g.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+g.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},(function(s){var t=function(){var a='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',n=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(a)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),c=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),d=unescape(encodeURIComponent("</x:xmpmeta>")),p=i.length+o.length+c.length+n.length+d.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+p+" >>"),this.internal.write("stream"),this.internal.write(n+i+o+c+d),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};s.addMetadata=function(a,n){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:a,namespaceuri:n||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}})(It.API),(function(s){var t=s.API,r=t.pdfEscape16=function(i,o){for(var c,d=o.metadata.Unicode.widths,p=["","0","00","000","0000"],m=[""],x=0,b=i.length;x<b;++x){if(c=o.metadata.characterToGlyph(i.charCodeAt(x)),o.metadata.glyIdsUsed.push(c),o.metadata.toUnicode[c]=i.charCodeAt(x),d.indexOf(c)==-1&&(d.push(c),d.push([parseInt(o.metadata.widthOfGlyph(c),10)])),c=="0")return m.join("");c=c.toString(16),m.push(p[4-c.length],c)}return m.join("")},a=function(i){var o,c,d,p,m,x,b;for(m=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,d=[],x=0,b=(c=Object.keys(i).sort(function(h,j){return h-j})).length;x<b;x++)o=c[x],d.length>=100&&(m+=`
`+d.length+` beginbfchar
`+d.join(`
`)+`
endbfchar`,d=[]),i[o]!==void 0&&i[o]!==null&&typeof i[o].toString=="function"&&(p=("0000"+i[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),d.push("<"+o+"><"+p+">"));return d.length&&(m+=`
`+d.length+` beginbfchar
`+d.join(`
`)+`
endbfchar
`),m+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(i){(function(o){var c=o.font,d=o.out,p=o.newObject,m=o.putStream;if(c.metadata instanceof s.API.TTFFont&&c.encoding==="Identity-H"){for(var x=c.metadata.Unicode.widths,b=c.metadata.subset.encode(c.metadata.glyIdsUsed,1),h="",j=0;j<b.length;j++)h+=String.fromCharCode(b[j]);var g=p();m({data:h,addLength1:!0,objectId:g}),d("endobj");var v=p();m({data:a(c.metadata.toUnicode),addLength1:!0,objectId:v}),d("endobj");var _=p();d("<<"),d("/Type /FontDescriptor"),d("/FontName /"+nu(c.fontName)),d("/FontFile2 "+g+" 0 R"),d("/FontBBox "+s.API.PDFObject.convert(c.metadata.bbox)),d("/Flags "+c.metadata.flags),d("/StemV "+c.metadata.stemV),d("/ItalicAngle "+c.metadata.italicAngle),d("/Ascent "+c.metadata.ascender),d("/Descent "+c.metadata.decender),d("/CapHeight "+c.metadata.capHeight),d(">>"),d("endobj");var k=p();d("<<"),d("/Type /Font"),d("/BaseFont /"+nu(c.fontName)),d("/FontDescriptor "+_+" 0 R"),d("/W "+s.API.PDFObject.convert(x)),d("/CIDToGIDMap /Identity"),d("/DW 1000"),d("/Subtype /CIDFontType2"),d("/CIDSystemInfo"),d("<<"),d("/Supplement 0"),d("/Registry (Adobe)"),d("/Ordering ("+c.encoding+")"),d(">>"),d(">>"),d("endobj"),c.objectNumber=p(),d("<<"),d("/Type /Font"),d("/Subtype /Type0"),d("/ToUnicode "+v+" 0 R"),d("/BaseFont /"+nu(c.fontName)),d("/Encoding /"+c.encoding),d("/DescendantFonts ["+k+" 0 R]"),d(">>"),d("endobj"),c.isAlreadyPutted=!0}})(i)}]),t.events.push(["putFont",function(i){(function(o){var c=o.font,d=o.out,p=o.newObject,m=o.putStream;if(c.metadata instanceof s.API.TTFFont&&c.encoding==="WinAnsiEncoding"){for(var x=c.metadata.rawData,b="",h=0;h<x.length;h++)b+=String.fromCharCode(x[h]);var j=p();m({data:b,addLength1:!0,objectId:j}),d("endobj");var g=p();m({data:a(c.metadata.toUnicode),addLength1:!0,objectId:g}),d("endobj");var v=p();d("<<"),d("/Descent "+c.metadata.decender),d("/CapHeight "+c.metadata.capHeight),d("/StemV "+c.metadata.stemV),d("/Type /FontDescriptor"),d("/FontFile2 "+j+" 0 R"),d("/Flags 96"),d("/FontBBox "+s.API.PDFObject.convert(c.metadata.bbox)),d("/FontName /"+nu(c.fontName)),d("/ItalicAngle "+c.metadata.italicAngle),d("/Ascent "+c.metadata.ascender),d(">>"),d("endobj"),c.objectNumber=p();for(var _=0;_<c.metadata.hmtx.widths.length;_++)c.metadata.hmtx.widths[_]=parseInt(c.metadata.hmtx.widths[_]*(1e3/c.metadata.head.unitsPerEm));d("<</Subtype/TrueType/Type/Font/ToUnicode "+g+" 0 R/BaseFont/"+nu(c.fontName)+"/FontDescriptor "+v+" 0 R/Encoding/"+c.encoding+" /FirstChar 29 /LastChar 255 /Widths "+s.API.PDFObject.convert(c.metadata.hmtx.widths)+">>"),d("endobj"),c.isAlreadyPutted=!0}})(i)}]);var n=function(i){var o,c=i.text||"",d=i.x,p=i.y,m=i.options||{},x=i.mutex||{},b=x.pdfEscape,h=x.activeFontKey,j=x.fonts,g=h,v="",_=0,k="",P=j[g].encoding;if(j[g].encoding!=="Identity-H")return{text:c,x:d,y:p,options:m,mutex:x};for(k=c,g=h,Array.isArray(c)&&(k=c[0]),_=0;_<k.length;_+=1)j[g].metadata.hasOwnProperty("cmap")&&(o=j[g].metadata.cmap.unicode.codeMap[k[_].charCodeAt(0)]),o||k[_].charCodeAt(0)<256&&j[g].metadata.hasOwnProperty("Unicode")?v+=k[_]:v+="";var L="";return parseInt(g.slice(1))<14||P==="WinAnsiEncoding"?L=b(v,g).split("").map(function(F){return F.charCodeAt(0).toString(16)}).join(""):P==="Identity-H"&&(L=r(v,j[g])),x.isHex=!0,{text:L,x:d,y:p,options:m,mutex:x}};t.events.push(["postProcessText",function(i){var o=i.text||"",c=[],d={text:o,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(o)){var p=0;for(p=0;p<o.length;p+=1)Array.isArray(o[p])&&o[p].length===3?c.push([n(Object.assign({},d,{text:o[p][0]})).text,o[p][1],o[p][2]]):c.push(n(Object.assign({},d,{text:o[p]})).text);i.text=c}else i.text=n(Object.assign({},d,{text:o})).text}])})(It),(function(s){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};s.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},s.addFileToVFS=function(r,a){return t.call(this),this.internal.vFS[r]=a,this},s.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}})(It.API),(function(s){s.__bidiEngine__=s.prototype.__bidiEngine__=function(a){var n,i,o,c,d,p,m,x=t,b=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],j={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},g={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},v=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],_=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),k=!1,P=0;this.__bidiEngine__={};var L=function(C){var O=C.charCodeAt(),Z=O>>8,te=g[Z];return te!==void 0?x[256*te+(255&O)]:Z===252||Z===253?"AL":_.test(Z)?"L":Z===8?"R":"N"},F=function(C){for(var O,Z=0;Z<C.length;Z++){if((O=L(C.charAt(Z)))==="L")return!1;if(O==="R")return!0}return!1},W=function(C,O,Z,te){var ce,re,X,U,oe=O[te];switch(oe){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":k=!1;break;case"N":case"AN":break;case"EN":k&&(oe="AN");break;case"AL":k=!0,oe="R";break;case"WS":case"BN":oe="N";break;case"CS":te<1||te+1>=O.length||(ce=Z[te-1])!=="EN"&&ce!=="AN"||(re=O[te+1])!=="EN"&&re!=="AN"?oe="N":k&&(re="AN"),oe=re===ce?re:"N";break;case"ES":oe=(ce=te>0?Z[te-1]:"B")==="EN"&&te+1<O.length&&O[te+1]==="EN"?"EN":"N";break;case"ET":if(te>0&&Z[te-1]==="EN"){oe="EN";break}if(k){oe="N";break}for(X=te+1,U=O.length;X<U&&O[X]==="ET";)X++;oe=X<U&&O[X]==="EN"?"EN":"N";break;case"NSM":if(o&&!c){for(U=O.length,X=te+1;X<U&&O[X]==="NSM";)X++;if(X<U){var xe=C[te],J=xe>=1425&&xe<=2303||xe===64286;if(ce=O[X],J&&(ce==="R"||ce==="AL")){oe="R";break}}}oe=te<1||(ce=O[te-1])==="B"?"N":Z[te-1];break;case"B":k=!1,n=!0,oe=P;break;case"S":i=!0,oe="N"}return oe},R=function(C,O,Z){var te=C.split("");return Z&&B(te,Z,{hiLevel:P}),te.reverse(),O&&O.reverse(),te.join("")},B=function(C,O,Z){var te,ce,re,X,U,oe=-1,xe=C.length,J=0,$=[],Q=P?h:b,q=[];for(k=!1,n=!1,i=!1,ce=0;ce<xe;ce++)q[ce]=L(C[ce]);for(re=0;re<xe;re++){if(U=J,$[re]=W(C,q,$,re),te=240&(J=Q[U][j[$[re]]]),J&=15,O[re]=X=Q[J][5],te>0)if(te===16){for(ce=oe;ce<re;ce++)O[ce]=1;oe=-1}else oe=-1;if(Q[J][6])oe===-1&&(oe=re);else if(oe>-1){for(ce=oe;ce<re;ce++)O[ce]=X;oe=-1}q[re]==="B"&&(O[re]=0),Z.hiLevel|=X}i&&(function(I,Y,H){for(var he=0;he<H;he++)if(I[he]==="S"){Y[he]=P;for(var ge=he-1;ge>=0&&I[ge]==="WS";ge--)Y[ge]=P}})(q,O,xe)},A=function(C,O,Z,te,ce){if(!(ce.hiLevel<C)){if(C===1&&P===1&&!n)return O.reverse(),void(Z&&Z.reverse());for(var re,X,U,oe,xe=O.length,J=0;J<xe;){if(te[J]>=C){for(U=J+1;U<xe&&te[U]>=C;)U++;for(oe=J,X=U-1;oe<X;oe++,X--)re=O[oe],O[oe]=O[X],O[X]=re,Z&&(re=Z[oe],Z[oe]=Z[X],Z[X]=re);J=U}J++}}},S=function(C,O,Z){var te=C.split(""),ce={hiLevel:P};return Z||(Z=[]),B(te,Z,ce),(function(re,X,U){if(U.hiLevel!==0&&m)for(var oe,xe=0;xe<re.length;xe++)X[xe]===1&&(oe=v.indexOf(re[xe]))>=0&&(re[xe]=v[oe+1])})(te,Z,ce),A(2,te,O,Z,ce),A(1,te,O,Z,ce),te.join("")};return this.__bidiEngine__.doBidiReorder=function(C,O,Z){if((function(ce,re){if(re)for(var X=0;X<ce.length;X++)re[X]=X;c===void 0&&(c=F(ce)),p===void 0&&(p=F(ce))})(C,O),o||!d||p)if(o&&d&&c^p)P=c?1:0,C=R(C,O,Z);else if(!o&&d&&p)P=c?1:0,C=S(C,O,Z),C=R(C,O);else if(!o||c||d||p){if(o&&!d&&c^p)C=R(C,O),c?(P=0,C=S(C,O,Z)):(P=1,C=S(C,O,Z),C=R(C,O));else if(o&&c&&!d&&p)P=1,C=S(C,O,Z),C=R(C,O);else if(!o&&!d&&c^p){var te=m;c?(P=1,C=S(C,O,Z),P=0,m=!1,C=S(C,O,Z),m=te):(P=0,C=S(C,O,Z),C=R(C,O),P=1,m=!1,C=S(C,O,Z),m=te,C=R(C,O))}}else P=0,C=S(C,O,Z);else P=c?1:0,C=S(C,O,Z);return C},this.__bidiEngine__.setOptions=function(C){C&&(o=C.isInputVisual,d=C.isOutputVisual,c=C.isInputRtl,p=C.isOutputRtl,m=C.isSymmetricSwapping)},this.__bidiEngine__.setOptions(a),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new s.__bidiEngine__({isInputVisual:!0});s.API.events.push(["postProcessText",function(a){var n=a.text;a.x,a.y;var i=a.options||{};a.mutex,i.lang;var o=[];if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,r.setOptions(i),Object.prototype.toString.call(n)==="[object Array]"){var c=0;for(o=[],c=0;c<n.length;c+=1)Object.prototype.toString.call(n[c])==="[object Array]"?o.push([r.doBidiReorder(n[c][0]),n[c][1],n[c][2]]):o.push([r.doBidiReorder(n[c])]);a.text=o}else a.text=r.doBidiReorder(n);r.setOptions({isInputVisual:!0})}])})(It),It.API.TTFFont=(function(){function s(t){var r;if(this.rawData=t,r=this.contents=new oc(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new tD(this),this.registerTTF()}return s.open=function(t){return new s(t)},s.prototype.parse=function(){return this.directory=new qO(this.contents),this.head=new BO(this),this.name=new KO(this),this.cmap=new jk(this),this.toUnicode={},this.hhea=new VO(this),this.maxp=new GO(this),this.hmtx=new YO(this),this.post=new ZO(this),this.os2=new HO(this),this.loca=new eD(this),this.glyf=new JO(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},s.prototype.registerTTF=function(){var t,r,a,n,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,c,d,p;for(p=[],o=0,c=(d=this.bbox).length;o<c;o++)t=d[o],p.push(Math.round(t*this.scaleFactor));return p}).call(this),this.stemV=0,this.post.exists?(a=255&(n=this.post.italic_angle),32768&(r=n>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+a)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},s.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},s.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},s.prototype.widthOfString=function(t,r,a){var n,i,o,c;for(o=0,i=0,c=(t=""+t).length;0<=c?i<c:i>c;i=0<=c?++i:--i)n=t.charCodeAt(i),o+=this.widthOfGlyph(this.characterToGlyph(n))+a*(1e3/r)||0;return o*(r/1e3)},s.prototype.lineHeight=function(t,r){var a;return r==null&&(r=!1),a=r?this.lineGap:0,(this.ascender+a-this.decender)/1e3*t},s})();var Wi,oc=(function(){function s(t){this.data=t??[],this.pos=0,this.length=this.data.length}return s.prototype.readByte=function(){return this.data[this.pos++]},s.prototype.writeByte=function(t){return this.data[this.pos++]=t},s.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},s.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},s.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},s.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},s.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},s.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},s.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},s.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},s.prototype.readString=function(t){var r,a;for(a=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)a[r]=String.fromCharCode(this.readByte());return a.join("")},s.prototype.writeString=function(t){var r,a,n;for(n=[],r=0,a=t.length;0<=a?r<a:r>a;r=0<=a?++r:--r)n.push(this.writeByte(t.charCodeAt(r)));return n},s.prototype.readShort=function(){return this.readInt16()},s.prototype.writeShort=function(t){return this.writeInt16(t)},s.prototype.readLongLong=function(){var t,r,a,n,i,o,c,d;return t=this.readByte(),r=this.readByte(),a=this.readByte(),n=this.readByte(),i=this.readByte(),o=this.readByte(),c=this.readByte(),d=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^a)+4294967296*(255^n)+16777216*(255^i)+65536*(255^o)+256*(255^c)+(255^d)+1):72057594037927940*t+281474976710656*r+1099511627776*a+4294967296*n+16777216*i+65536*o+256*c+d},s.prototype.writeLongLong=function(t){var r,a;return r=Math.floor(t/4294967296),a=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(a>>24&255),this.writeByte(a>>16&255),this.writeByte(a>>8&255),this.writeByte(255&a)},s.prototype.readInt=function(){return this.readInt32()},s.prototype.writeInt=function(t){return this.writeInt32(t)},s.prototype.read=function(t){var r,a;for(r=[],a=0;0<=t?a<t:a>t;a=0<=t?++a:--a)r.push(this.readByte());return r},s.prototype.write=function(t){var r,a,n,i;for(i=[],a=0,n=t.length;a<n;a++)r=t[a],i.push(this.writeByte(r));return i},s})(),qO=(function(){var s;function t(r){var a,n,i;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},n=0,i=this.tableCount;0<=i?n<i:n>i;n=0<=i?++n:--n)a={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[a.tag]=a}return t.prototype.encode=function(r){var a,n,i,o,c,d,p,m,x,b,h,j,g;for(g in h=Object.keys(r).length,d=Math.log(2),x=16*Math.floor(Math.log(h)/d),o=Math.floor(x/d),m=16*h-x,(n=new oc).writeInt(this.scalarType),n.writeShort(h),n.writeShort(x),n.writeShort(o),n.writeShort(m),i=16*h,p=n.pos+i,c=null,j=[],r)for(b=r[g],n.writeString(g),n.writeInt(s(b)),n.writeInt(p),n.writeInt(b.length),j=j.concat(b),g==="head"&&(c=p),p+=b.length;p%4;)j.push(0),p++;return n.write(j),a=2981146554-s(n.data),n.pos=c+8,n.writeUInt32(a),n.data},s=function(r){var a,n,i,o;for(r=_k.call(r);r.length%4;)r.push(0);for(i=new oc(r),n=0,a=0,o=r.length;a<o;a=a+=4)n+=i.readUInt32();return 4294967295&n},t})(),$O={}.hasOwnProperty,jo=function(s,t){for(var r in t)$O.call(t,r)&&(s[r]=t[r]);function a(){this.constructor=s}return a.prototype=t.prototype,s.prototype=new a,s.__super__=t.prototype,s};Wi=(function(){function s(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return s.prototype.parse=function(){},s.prototype.encode=function(){},s.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},s})();var BO=(function(){function s(){return s.__super__.constructor.apply(this,arguments)}return jo(s,Wi),s.prototype.tag="head",s.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},s.prototype.encode=function(t){var r;return(r=new oc).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},s})(),w_=(function(){function s(t,r){var a,n,i,o,c,d,p,m,x,b,h,j,g,v,_,k,P;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),x=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(d=0;d<256;++d)this.codeMap[d]=t.readByte();break;case 4:for(h=t.readUInt16(),b=h/2,t.pos+=6,i=(function(){var L,F;for(F=[],d=L=0;0<=b?L<b:L>b;d=0<=b?++L:--L)F.push(t.readUInt16());return F})(),t.pos+=2,g=(function(){var L,F;for(F=[],d=L=0;0<=b?L<b:L>b;d=0<=b?++L:--L)F.push(t.readUInt16());return F})(),p=(function(){var L,F;for(F=[],d=L=0;0<=b?L<b:L>b;d=0<=b?++L:--L)F.push(t.readUInt16());return F})(),m=(function(){var L,F;for(F=[],d=L=0;0<=b?L<b:L>b;d=0<=b?++L:--L)F.push(t.readUInt16());return F})(),n=(this.length-t.pos+this.offset)/2,c=(function(){var L,F;for(F=[],d=L=0;0<=n?L<n:L>n;d=0<=n?++L:--L)F.push(t.readUInt16());return F})(),d=_=0,P=i.length;_<P;d=++_)for(v=i[d],a=k=j=g[d];j<=v?k<=v:k>=v;a=j<=v?++k:--k)m[d]===0?o=a+p[d]:(o=c[m[d]/2+(a-j)-(b-d)]||0)!==0&&(o+=p[d]),this.codeMap[a]=65535&o}t.pos=x}return s.encode=function(t,r){var a,n,i,o,c,d,p,m,x,b,h,j,g,v,_,k,P,L,F,W,R,B,A,S,C,O,Z,te,ce,re,X,U,oe,xe,J,$,Q,q,I,Y,H,he,ge,K,T,ee;switch(te=new oc,o=Object.keys(t).sort(function(_e,ke){return _e-ke}),r){case"macroman":for(g=0,v=(function(){var _e=[];for(j=0;j<256;++j)_e.push(0);return _e})(),k={0:0},i={},ce=0,oe=o.length;ce<oe;ce++)k[ge=t[n=o[ce]]]==null&&(k[ge]=++g),i[n]={old:t[n],new:k[t[n]]},v[n]=k[t[n]];return te.writeUInt16(1),te.writeUInt16(0),te.writeUInt32(12),te.writeUInt16(0),te.writeUInt16(262),te.writeUInt16(0),te.write(v),{charMap:i,subtable:te.data,maxGlyphID:g+1};case"unicode":for(O=[],x=[],P=0,k={},a={},_=p=null,re=0,xe=o.length;re<xe;re++)k[F=t[n=o[re]]]==null&&(k[F]=++P),a[n]={old:F,new:k[F]},c=k[F]-n,_!=null&&c===p||(_&&x.push(_),O.push(n),p=c),_=n;for(_&&x.push(_),x.push(65535),O.push(65535),S=2*(A=O.length),B=2*Math.pow(Math.log(A)/Math.LN2,2),b=Math.log(B/2)/Math.LN2,R=2*A-B,d=[],W=[],h=[],j=X=0,J=O.length;X<J;j=++X){if(C=O[j],m=x[j],C===65535){d.push(0),W.push(0);break}if(C-(Z=a[C].new)>=32768)for(d.push(0),W.push(2*(h.length+A-j)),n=U=C;C<=m?U<=m:U>=m;n=C<=m?++U:--U)h.push(a[n].new);else d.push(Z-C),W.push(0)}for(te.writeUInt16(3),te.writeUInt16(1),te.writeUInt32(12),te.writeUInt16(4),te.writeUInt16(16+8*A+2*h.length),te.writeUInt16(0),te.writeUInt16(S),te.writeUInt16(B),te.writeUInt16(b),te.writeUInt16(R),H=0,$=x.length;H<$;H++)n=x[H],te.writeUInt16(n);for(te.writeUInt16(0),he=0,Q=O.length;he<Q;he++)n=O[he],te.writeUInt16(n);for(K=0,q=d.length;K<q;K++)c=d[K],te.writeUInt16(c);for(T=0,I=W.length;T<I;T++)L=W[T],te.writeUInt16(L);for(ee=0,Y=h.length;ee<Y;ee++)g=h[ee],te.writeUInt16(g);return{charMap:a,subtable:te.data,maxGlyphID:P+1}}},s})(),jk=(function(){function s(){return s.__super__.constructor.apply(this,arguments)}return jo(s,Wi),s.prototype.tag="cmap",s.prototype.parse=function(t){var r,a,n;for(t.pos=this.offset,this.version=t.readUInt16(),n=t.readUInt16(),this.tables=[],this.unicode=null,a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)r=new w_(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},s.encode=function(t,r){var a,n;return r==null&&(r="macroman"),a=w_.encode(t,r),(n=new oc).writeUInt16(0),n.writeUInt16(1),a.table=n.data.concat(a.subtable),a},s})(),VO=(function(){function s(){return s.__super__.constructor.apply(this,arguments)}return jo(s,Wi),s.prototype.tag="hhea",s.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},s})(),HO=(function(){function s(){return s.__super__.constructor.apply(this,arguments)}return jo(s,Wi),s.prototype.tag="OS/2",s.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=(function(){var r,a;for(a=[],r=0;r<10;++r)a.push(t.readByte());return a})(),this.charRange=(function(){var r,a;for(a=[],r=0;r<4;++r)a.push(t.readInt());return a})(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=(function(){var r,a;for(a=[],r=0;r<2;r=++r)a.push(t.readInt());return a})(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},s})(),ZO=(function(){function s(){return s.__super__.constructor.apply(this,arguments)}return jo(s,Wi),s.prototype.tag="post",s.prototype.parse=function(t){var r,a,n;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var i;for(a=t.readUInt16(),this.glyphNameIndex=[],i=0;0<=a?i<a:i>a;i=0<=a?++i:--i)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],n=[];t.pos<this.offset+this.length;)r=t.readByte(),n.push(this.names.push(t.readString(r)));return n;case 151552:return a=t.readUInt16(),this.offsets=t.read(a);case 262144:return this.map=(function(){var o,c,d;for(d=[],i=o=0,c=this.file.maxp.numGlyphs;0<=c?o<c:o>c;i=0<=c?++o:--o)d.push(t.readUInt32());return d}).call(this)}},s})(),WO=function(s,t){this.raw=s,this.length=s.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},KO=(function(){function s(){return s.__super__.constructor.apply(this,arguments)}return jo(s,Wi),s.prototype.tag="name",s.prototype.parse=function(t){var r,a,n,i,o,c,d,p,m,x,b;for(t.pos=this.offset,t.readShort(),r=t.readShort(),c=t.readShort(),a=[],i=0;0<=r?i<r:i>r;i=0<=r?++i:--i)a.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+c+t.readShort()});for(d={},i=m=0,x=a.length;m<x;i=++m)n=a[i],t.pos=n.offset,p=t.readString(n.length),o=new WO(p,n),d[b=n.nameID]==null&&(d[b]=[]),d[n.nameID].push(o);this.strings=d,this.copyright=d[0],this.fontFamily=d[1],this.fontSubfamily=d[2],this.uniqueSubfamily=d[3],this.fontName=d[4],this.version=d[5];try{this.postscriptName=d[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=d[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=d[7],this.manufacturer=d[8],this.designer=d[9],this.description=d[10],this.vendorUrl=d[11],this.designerUrl=d[12],this.license=d[13],this.licenseUrl=d[14],this.preferredFamily=d[15],this.preferredSubfamily=d[17],this.compatibleFull=d[18],this.sampleText=d[19]},s})(),GO=(function(){function s(){return s.__super__.constructor.apply(this,arguments)}return jo(s,Wi),s.prototype.tag="maxp",s.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},s})(),YO=(function(){function s(){return s.__super__.constructor.apply(this,arguments)}return jo(s,Wi),s.prototype.tag="hmtx",s.prototype.parse=function(t){var r,a,n,i,o,c,d;for(t.pos=this.offset,this.metrics=[],r=0,c=this.file.hhea.numberOfMetrics;0<=c?r<c:r>c;r=0<=c?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(n=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var p,m;for(m=[],r=p=0;0<=n?p<n:p>n;r=0<=n?++p:--p)m.push(t.readInt16());return m})(),this.widths=(function(){var p,m,x,b;for(b=[],p=0,m=(x=this.metrics).length;p<m;p++)i=x[p],b.push(i.advance);return b}).call(this),a=this.widths[this.widths.length-1],d=[],r=o=0;0<=n?o<n:o>n;r=0<=n?++o:--o)d.push(this.widths.push(a));return d},s.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},s})(),_k=[].slice,JO=(function(){function s(){return s.__super__.constructor.apply(this,arguments)}return jo(s,Wi),s.prototype.tag="glyf",s.prototype.parse=function(){return this.cache={}},s.prototype.glyphFor=function(t){var r,a,n,i,o,c,d,p,m,x;return t in this.cache?this.cache[t]:(i=this.file.loca,r=this.file.contents,a=i.indexOf(t),(n=i.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+a,o=(c=new oc(r.read(n))).readShort(),p=c.readShort(),x=c.readShort(),d=c.readShort(),m=c.readShort(),this.cache[t]=o===-1?new QO(c,p,x,d,m):new XO(c,o,p,x,d,m),this.cache[t]))},s.prototype.encode=function(t,r,a){var n,i,o,c,d;for(o=[],i=[],c=0,d=r.length;c<d;c++)n=t[r[c]],i.push(o.length),n&&(o=o.concat(n.encode(a)));return i.push(o.length),{table:o,offsets:i}},s})(),XO=(function(){function s(t,r,a,n,i,o){this.raw=t,this.numberOfContours=r,this.xMin=a,this.yMin=n,this.xMax=i,this.yMax=o,this.compound=!1}return s.prototype.encode=function(){return this.raw.data},s})(),QO=(function(){function s(t,r,a,n,i){var o,c;for(this.raw=t,this.xMin=r,this.yMin=a,this.xMax=n,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;c=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&c;)o.pos+=1&c?4:2,128&c?o.pos+=8:64&c?o.pos+=4:8&c&&(o.pos+=2)}return s.prototype.encode=function(){var t,r,a;for(r=new oc(_k.call(this.raw.data)),t=0,a=this.glyphIDs.length;t<a;++t)r.pos=this.glyphOffsets[t];return r.data},s})(),eD=(function(){function s(){return s.__super__.constructor.apply(this,arguments)}return jo(s,Wi),s.prototype.tag="loca",s.prototype.parse=function(t){var r,a;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var n,i;for(i=[],a=0,n=this.length;a<n;a+=2)i.push(2*t.readUInt16());return i}).call(this):(function(){var n,i;for(i=[],a=0,n=this.length;a<n;a+=4)i.push(t.readUInt32());return i}).call(this)},s.prototype.indexOf=function(t){return this.offsets[t]},s.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},s.prototype.encode=function(t,r){for(var a=new Uint32Array(this.offsets.length),n=0,i=0,o=0;o<a.length;++o)if(a[o]=n,i<r.length&&r[i]==o){++i,a[o]=n;var c=this.offsets[o],d=this.offsets[o+1]-c;d>0&&(n+=d)}for(var p=new Array(4*a.length),m=0;m<a.length;++m)p[4*m+3]=255&a[m],p[4*m+2]=(65280&a[m])>>8,p[4*m+1]=(16711680&a[m])>>16,p[4*m]=(4278190080&a[m])>>24;return p},s})(),tD=(function(){function s(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return s.prototype.generateCmap=function(){var t,r,a,n,i;for(r in n=this.font.cmap.tables[0].codeMap,t={},i=this.subset)a=i[r],t[r]=n[a];return t},s.prototype.glyphsFor=function(t){var r,a,n,i,o,c,d;for(n={},o=0,c=t.length;o<c;o++)n[i=t[o]]=this.font.glyf.glyphFor(i);for(i in r=[],n)(a=n[i])!=null&&a.compound&&r.push.apply(r,a.glyphIDs);if(r.length>0)for(i in d=this.glyphsFor(r))a=d[i],n[i]=a;return n},s.prototype.encode=function(t,r){var a,n,i,o,c,d,p,m,x,b,h,j,g,v,_;for(n in a=jk.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(t),h={0:0},_=a.charMap)h[(d=_[n]).old]=d.new;for(j in b=a.maxGlyphID,o)j in h||(h[j]=b++);return m=(function(k){var P,L;for(P in L={},k)L[k[P]]=P;return L})(h),x=Object.keys(m).sort(function(k,P){return k-P}),g=(function(){var k,P,L;for(L=[],k=0,P=x.length;k<P;k++)c=x[k],L.push(m[c]);return L})(),i=this.font.glyf.encode(o,g,h),p=this.font.loca.encode(i.offsets,g),v={cmap:this.font.cmap.raw(),glyf:i.table,loca:p,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(v["OS/2"]=this.font.os2.raw()),this.font.directory.encode(v)},s})();It.API.PDFObject=(function(){var s;function t(){}return s=function(r,a){return(Array(a+1).join("0")+r).slice(-a)},t.convert=function(r){var a,n,i,o;if(Array.isArray(r))return"["+(function(){var c,d,p;for(p=[],c=0,d=r.length;c<d;c++)a=r[c],p.push(t.convert(a));return p})().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+s(r.getUTCFullYear(),4)+s(r.getUTCMonth(),2)+s(r.getUTCDate(),2)+s(r.getUTCHours(),2)+s(r.getUTCMinutes(),2)+s(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(n in i=["<<"],r)o=r[n],i.push("/"+n+" "+t.convert(o));return i.push(">>"),i.join(`
`)}return""+r},t})();const rD=()=>{const{t:s}=et(),[t,r]=z.useState([]),[a,n]=z.useState(!0),[i,o]=z.useState(""),[c,d]=z.useState("all"),[p,m]=z.useState("all"),[x,b]=z.useState("all"),[h,j]=z.useState(!1),[g,v]=z.useState(!1),[_,k]=z.useState(!1),[P,L]=z.useState(!1),[F,W]=z.useState(null),[R,B]=z.useState(null),[A,S]=z.useState(!1),[C,O]=z.useState(!1),[Z,te]=z.useState(!1),[ce,re]=z.useState(!1);z.useEffect(()=>{X()},[]);const X=async()=>{try{const{data:je,error:ne}=await Ne.from("nis2_risk_register").select("*").order("created_at",{ascending:!1});if(ne)throw ne;r(je||[])}catch(je){console.error("Error fetching risk register records:",je)}finally{n(!1)}},U=t.filter(je=>{const ne=i===""||je.risk_id.toLowerCase().includes(i.toLowerCase())||je.risk_name.toLowerCase().includes(i.toLowerCase())||je.risk_owner.toLowerCase().includes(i.toLowerCase())||je.category.toLowerCase().includes(i.toLowerCase())||je.risk_description.toLowerCase().includes(i.toLowerCase()),Re=c==="all"||je.risk_level===c,Oe=p==="all"||je.treatment_status===p,Je=x==="all"||je.category===x;return ne&&Re&&Oe&&Je}),oe=je=>{const ne="px-2 py-1 rounded text-xs font-medium inline-flex items-center";switch(je){case"Critical":return`${ne} text-red-500 bg-red-500/10`;case"High":return`${ne} text-red-500 bg-red-500/10`;case"Medium":return`${ne} text-yellow-500 bg-yellow-500/10`;case"Low":return`${ne} text-green-500 bg-green-500/10`;default:return`${ne} text-gray-500 bg-gray-500/10`}},xe=je=>{switch(je){case"Critical":return"Kritino";case"High":return"Visoko";case"Medium":return"Srednje";case"Low":return"Nizko";default:return je}},J=je=>{const ne="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium";switch(je){case"Operational":return`${ne} text-blue-500 bg-blue-500/10`;case"Technical":return`${ne} text-emerald-500 bg-emerald-500/10`;case"Strategic":return`${ne} text-orange-500 bg-orange-500/10`;case"Compliance":return`${ne} text-red-500 bg-red-500/10`;case"Financial":return`${ne} text-yellow-500 bg-yellow-500/10`;case"Reputational":return`${ne} text-gray-500 bg-gray-500/10`;case"Supply Chain":return`${ne} text-purple-500 bg-purple-500/10`;case"Human Resources":return`${ne} text-pink-500 bg-pink-500/10`;case"Cyber":return`${ne} text-red-600 bg-red-600/10`;default:return`${ne} text-gray-500 bg-gray-500/10`}},$=je=>{switch(je){case"Open":return"Odprto";case"In Progress":return"V delu";case"Implemented":return"Implementirano";case"Accepted":return"Sprejeto";case"Closed":return"Zaprto";default:return je}},Q=je=>{switch(je){case"Operational":return"Operativno";case"Technical":return"Tehnino";case"Strategic":return"Strateko";case"Compliance":return"Skladnost";case"Financial":return"Finanno";case"Reputational":return"Reputacijsko";case"Supply Chain":return"Dobavna veriga";case"Human Resources":return"loveki viri";case"Cyber":return"Kibernetsko";default:return je}},q=je=>{switch(je){case"Open":return e.jsx(pt,{className:"w-4 h-4"});case"In Progress":return e.jsx(cs,{className:"w-4 h-4"});case"Implemented":return e.jsx(Rt,{className:"w-4 h-4"});case"Accepted":return e.jsx(Rt,{className:"w-4 h-4"});case"Closed":return e.jsx(Rt,{className:"w-4 h-4"});default:return e.jsx(ut,{className:"w-4 h-4"})}},I=je=>{const ne="inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium";switch(je){case"Open":return`${ne} text-red-500 bg-red-500/10`;case"In Progress":return`${ne} text-yellow-500 bg-yellow-500/10`;case"Implemented":return`${ne} text-green-500 bg-green-500/10`;case"Accepted":return`${ne} text-green-500 bg-green-500/10`;case"Closed":return`${ne} text-gray-500 bg-gray-500/10`;default:return`${ne} text-gray-500 bg-gray-500/10`}},Y=je=>{const ne="px-2 py-1 rounded text-xs font-medium";switch(je){case"Critical":return`${ne} text-red-500 bg-red-500/10`;case"High":return`${ne} text-red-500 bg-red-500/10`;case"Medium":return`${ne} text-yellow-500 bg-yellow-500/10`;case"Low":return`${ne} text-green-500 bg-green-500/10`;default:return`${ne} text-gray-500 bg-gray-500/10`}},H=je=>{switch(je){case"Critical":return"Kritino";case"High":return"Visoko";case"Medium":return"Srednje";case"Low":return"Nizko";default:return je}},he=je=>{if(!je)return!1;const ne=new Date("2025-11-01"),Re=new Date(je),Oe=Math.floor((Re.getTime()-ne.getTime())/(1e3*60*60*24));return Oe>0&&Oe<=30},ge=()=>{re(!0);try{const ne=[["Risk ID","Risk Name","Category","Risk Description","Threat Source","Vulnerability","Affected Assets","Likelihood","Impact","Risk Score","Risk Level","Risk Owner","Current Controls","Treatment Strategy","Mitigation Actions","Treatment Status","Priority","Residual Likelihood","Residual Impact","Residual Risk Score","Residual Risk Level","Identified Date","Review Date","Target Closure Date","Last Reviewed","Comments","Created At","Updated At"].join(";"),...U.map(Be=>[Be.risk_id,Be.risk_name,Be.category,Be.risk_description,Be.threat_source,Be.vulnerability,Be.affected_assets,Be.likelihood,Be.impact,Be.risk_score,Be.risk_level,Be.risk_owner,Be.current_controls||"",Be.treatment_strategy,Be.mitigation_actions||"",Be.treatment_status,Be.priority,Be.residual_likelihood||"",Be.residual_impact||"",Be.residual_risk_score||"",Be.residual_risk_level||"",Be.identified_date,Be.review_date||"",Be.target_closure_date||"",Be.last_reviewed||"",Be.comments||"",new Date(Be.created_at).toLocaleDateString("sl-SI"),new Date(Be.updated_at).toLocaleDateString("sl-SI")].map(kt=>`"${String(kt).replace(/"/g,'""')}"`).join(";"))].join(`
`),Re=new Blob(["\uFEFF"+ne],{type:"text/csv;charset=utf-8;"}),Oe=document.createElement("a"),Je=URL.createObjectURL(Re);Oe.setAttribute("href",Je),Oe.setAttribute("download",`NIS2_Risk_Register_${new Date().toISOString().split("T")[0]}.csv`),Oe.style.visibility="hidden",document.body.appendChild(Oe),Oe.click(),document.body.removeChild(Oe)}catch(je){console.error("Error exporting CSV:",je)}finally{re(!1)}},K=je=>{W(je),v(!0)},T=je=>{W(je),B({risk_id:je.risk_id,risk_name:je.risk_name,category:je.category,risk_description:je.risk_description,threat_source:je.threat_source,vulnerability:je.vulnerability,affected_assets:je.affected_assets,likelihood:je.likelihood,impact:je.impact,risk_owner:je.risk_owner,current_controls:je.current_controls||"",treatment_strategy:je.treatment_strategy,mitigation_actions:je.mitigation_actions||"",treatment_status:je.treatment_status,priority:je.priority,residual_likelihood:je.residual_likelihood,residual_impact:je.residual_impact,identified_date:je.identified_date,review_date:je.review_date||"",target_closure_date:je.target_closure_date||"",last_reviewed:je.last_reviewed||"",comments:je.comments||""}),k(!0)},ee=async je=>{if(je.preventDefault(),!(!F||!R)){S(!0);try{const ne=R.likelihood*R.impact,Re=ne>=21?"Critical":ne>=13?"High":ne>=7?"Medium":"Low",Oe=R.residual_likelihood&&R.residual_impact?R.residual_likelihood*R.residual_impact:null,Je=Oe?Oe>=21?"Critical":Oe>=13?"High":Oe>=7?"Medium":"Low":null,{error:Be}=await Ne.from("nis2_risk_register").update({...R,risk_score:ne,risk_level:Re,residual_risk_score:Oe,residual_risk_level:Je,review_date:R.review_date||null,target_closure_date:R.target_closure_date||null,last_reviewed:R.last_reviewed||null,comments:R.comments||null,current_controls:R.current_controls||null,mitigation_actions:R.mitigation_actions||null}).eq("id",F.id);if(Be)throw Be;await X(),k(!1),W(null),B(null)}catch(ne){console.error("Error updating record:",ne)}finally{S(!1)}}},_e=je=>{W(je),L(!0)},ke=async()=>{if(F){O(!0);try{const{error:je}=await Ne.from("nis2_risk_register").delete().eq("id",F.id);if(je)throw je;await X(),L(!1),W(null)}catch(je){console.error("Error deleting record:",je)}finally{O(!1)}}},ue=je=>{if(!R)return;const{name:ne,value:Re}=je.target;if(["likelihood","impact","residual_likelihood","residual_impact"].includes(ne)){const Oe=Re===""?null:parseInt(Re);B(Je=>Je?{...Je,[ne]:Oe}:null)}else B(Oe=>Oe?{...Oe,[ne]:Re}:null)};return a?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-text-secondary",children:"Nalagam evidenco tveganj..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:s("nis2.riskRegister.title")}),e.jsx("p",{className:"text-text-tertiary mt-1",children:s("nis2.riskRegister.description")})]}),e.jsxs("button",{onClick:()=>j(!0),className:"bg-accent-primary hover:bg-accent-primary/90 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors",children:[e.jsx(Dt,{className:"w-4 h-4"}),"Dodaj tveganje"]})]}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ss,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-text-tertiary w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Iskanje po ID, naslovu, lastniku...",value:i,onChange:je=>o(je.target.value),className:"w-full pl-10 pr-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-accent-primary/20 focus:border-accent-primary"})]}),e.jsxs("select",{value:c,onChange:je=>d(je.target.value),className:"px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary/20 focus:border-accent-primary",children:[e.jsx("option",{value:"all",children:"Vsi nivoji"}),e.jsx("option",{value:"Low",children:"Nizko"}),e.jsx("option",{value:"Medium",children:"Srednje"}),e.jsx("option",{value:"High",children:"Visoko"}),e.jsx("option",{value:"Critical",children:"Kritino"})]}),e.jsxs("select",{value:p,onChange:je=>m(je.target.value),className:"px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary/20 focus:border-accent-primary",children:[e.jsx("option",{value:"all",children:"Vsi statusi"}),e.jsx("option",{value:"Open",children:"Odprto"}),e.jsx("option",{value:"In Progress",children:"V delu"}),e.jsx("option",{value:"Implemented",children:"Implementirano"}),e.jsx("option",{value:"Accepted",children:"Sprejeto"}),e.jsx("option",{value:"Closed",children:"Zaprto"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{o(""),d("all"),m("all"),b("all")},className:"px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-secondary hover:text-text-primary hover:border-border-strong transition-colors",children:"Poisti filter"}),e.jsxs("button",{onClick:ge,disabled:ce||U.length===0,className:"px-4 py-2 bg-accent-primary hover:bg-accent-primary/90 text-white rounded-lg font-medium transition-colors flex items-center",children:[e.jsx(Ir,{className:"w-4 h-4 mr-1"}),"CSV"]})]})]})}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-near-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:s("nis2.riskRegister.table.riskId")}),e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:s("nis2.riskRegister.table.riskName")}),e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:s("nis2.riskRegister.table.category")}),e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:s("nis2.riskRegister.table.riskLevel")}),e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:s("nis2.riskRegister.table.riskScore")}),e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:s("nis2.riskRegister.table.treatmentStatus")}),e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:s("nis2.riskRegister.table.priority")}),e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:s("nis2.riskRegister.table.riskOwner")}),e.jsx("th",{className:"text-left p-4 text-text-secondary font-medium",children:s("nis2.riskRegister.table.actions")})]})}),e.jsx("tbody",{children:a?e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"p-8 text-center text-text-tertiary",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-accent-primary mx-auto"})})}):U.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"p-8 text-center text-text-tertiary",children:i||c!=="all"||p!=="all"||x!=="all"?"Nobeno tveganje ne ustreza izbranim filtrom.":"Ni najdenih tveganj"})}):U.map(je=>e.jsxs("tr",{className:"border-b border-border-subtle hover:bg-bg-near-black transition-colors",children:[e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"font-mono text-text-primary",children:je.risk_id})}),e.jsxs("td",{className:"p-4",children:[e.jsx("div",{className:"text-text-primary font-medium",children:je.risk_name}),e.jsxs("div",{className:"text-text-tertiary text-sm mt-1",children:[je.risk_description.substring(0,100),"..."]})]}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:J(je.category),children:Q(je.category)})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:oe(je.risk_level),children:je.risk_level})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"text-text-primary font-medium",children:je.risk_score})}),e.jsx("td",{className:"p-4",children:e.jsxs("span",{className:I(je.treatment_status),children:[q(je.treatment_status),$(je.treatment_status)]})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:Y(je.priority),children:je.priority})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"text-text-primary",children:je.risk_owner})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>K(je),className:"text-accent-primary hover:text-accent-primary/80 transition-colors",title:"Podrobnosti",children:e.jsx(lr,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>T(je),className:"text-yellow-500 hover:text-yellow-400 transition-colors",title:"Uredi",children:e.jsx(ar,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>_e(je),className:"text-red-500 hover:text-red-400 transition-colors",title:"Izbrii",children:e.jsx(pr,{className:"w-4 h-4"})})]})})]},je.id))})]})})}),e.jsx(mP,{isOpen:h,onClose:()=>j(!1),onSuccess:X}),F&&e.jsx(zs,{isOpen:g,onClose:()=>v(!1),title:F.risk_name,children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("span",{className:oe(F.risk_level),children:[xe(F.risk_level)," Tveganje"]}),e.jsxs("span",{className:I(F.treatment_status),children:[q(F.treatment_status),$(F.treatment_status)]}),e.jsxs("span",{className:Y(F.priority),children:[H(F.priority)," Prioriteta"]}),he(F.review_date)&&e.jsxs("span",{className:"px-2 py-1 bg-yellow-600/20 text-yellow-400 rounded text-xs font-medium flex items-center",children:[e.jsx(pt,{className:"w-3 h-3 mr-1"}),"Pregled potreben kmalu"]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-text-primary mb-3",children:"Osnovne informacije"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Risk ID"}),e.jsx("p",{className:"text-text-primary font-mono",children:F.risk_id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Kategorija"}),e.jsx("p",{className:"text-text-primary",children:Q(F.category)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Vir gronje"}),e.jsx("p",{className:"text-text-primary",children:F.threat_source})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Lastnik tveganja"}),e.jsx("p",{className:"text-text-primary",children:F.risk_owner})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Verjetnost"}),e.jsxs("p",{className:"text-text-primary",children:[F.likelihood,"/5"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Vpliv"}),e.jsxs("p",{className:"text-text-primary",children:[F.impact,"/5"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Ocena tveganja"}),e.jsx("p",{className:"text-text-primary font-medium",children:F.risk_score})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Strategija obravnavanja"}),e.jsx("p",{className:"text-text-primary",children:F.treatment_strategy})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-text-primary mb-3",children:"Opis tveganja"}),e.jsx("p",{className:"text-text-primary whitespace-pre-wrap",children:F.risk_description})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-text-primary mb-3",children:"Ranljivost in prizadeti sistemi"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Ranljivost"}),e.jsx("p",{className:"text-text-primary",children:F.vulnerability})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Prizadeti sistemi"}),e.jsx("p",{className:"text-text-primary",children:F.affected_assets})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-text-primary mb-3",children:"Obravnavanje tveganja"}),e.jsxs("div",{className:"space-y-3",children:[F.current_controls&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Trenutni nadzori"}),e.jsx("p",{className:"text-text-primary whitespace-pre-wrap",children:F.current_controls})]}),F.mitigation_actions&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Ukrepi za zmanjanje"}),e.jsx("p",{className:"text-text-primary whitespace-pre-wrap",children:F.mitigation_actions})]})]})]}),F.residual_likelihood&&F.residual_impact&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-text-primary mb-3",children:"Preostan rizik"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Preostana verjetnost"}),e.jsxs("p",{className:"text-text-primary",children:[F.residual_likelihood,"/5"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Preostan vpliv"}),e.jsxs("p",{className:"text-text-primary",children:[F.residual_impact,"/5"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Preostan rizik"}),e.jsx("p",{className:"text-text-primary font-medium",children:F.residual_risk_score})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Nivo preostanka"}),e.jsx("span",{className:oe(F.residual_risk_level||""),children:xe(F.residual_risk_level||"")})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-text-primary mb-3",children:"asovnica"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Datum identifikacije"}),e.jsx("p",{className:"text-text-primary",children:new Date(F.identified_date).toLocaleDateString("sl-SI")})]}),F.review_date&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Datum pregleda"}),e.jsx("p",{className:he(F.review_date)?"text-yellow-400":"text-text-primary",children:new Date(F.review_date).toLocaleDateString("sl-SI")})]}),F.target_closure_date&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Ciljni datum zakljuka"}),e.jsx("p",{className:"text-text-primary",children:new Date(F.target_closure_date).toLocaleDateString("sl-SI")})]}),F.last_reviewed&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Zadnji pregled"}),e.jsx("p",{className:"text-text-primary",children:new Date(F.last_reviewed).toLocaleDateString("sl-SI")})]})]})]}),F.comments&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-text-primary mb-3",children:"Komentarji"}),e.jsx("p",{className:"text-text-primary whitespace-pre-wrap",children:F.comments})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-text-primary mb-3",children:"Metapodatki"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Ustvarjeno"}),e.jsx("p",{className:"text-text-primary",children:new Date(F.created_at).toLocaleDateString("sl-SI")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Posodobljeno"}),e.jsx("p",{className:"text-text-primary",children:new Date(F.updated_at).toLocaleDateString("sl-SI")})]})]})]})]})}),R&&F&&e.jsx(zs,{isOpen:_,onClose:()=>k(!1),title:"Uredi tveganje",children:e.jsxs("form",{onSubmit:ee,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Risk ID"}),e.jsx("input",{type:"text",name:"risk_id",value:R.risk_id,onChange:ue,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary/20 focus:border-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Kategorija"}),e.jsxs("select",{name:"category",value:R.category,onChange:ue,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary/20 focus:border-accent-primary",required:!0,children:[e.jsx("option",{value:"Operational",children:"Operativno"}),e.jsx("option",{value:"Technical",children:"Tehnino"}),e.jsx("option",{value:"Strategic",children:"Strateko"}),e.jsx("option",{value:"Compliance",children:"Skladnost"}),e.jsx("option",{value:"Financial",children:"Finanno"}),e.jsx("option",{value:"Reputational",children:"Reputacijsko"}),e.jsx("option",{value:"Supply Chain",children:"Dobavna veriga"}),e.jsx("option",{value:"Human Resources",children:"loveki viri"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Naziv tveganja"}),e.jsx("input",{type:"text",name:"risk_name",value:R.risk_name,onChange:ue,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary/20 focus:border-accent-primary",required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Opis tveganja"}),e.jsx("textarea",{name:"risk_description",value:R.risk_description,onChange:ue,rows:3,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary/20 focus:border-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Verjetnost (1-5)"}),e.jsxs("select",{name:"likelihood",value:R.likelihood,onChange:ue,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary/20 focus:border-accent-primary",required:!0,children:[e.jsx("option",{value:1,children:"1 - Zelo nizka"}),e.jsx("option",{value:2,children:"2 - Nizka"}),e.jsx("option",{value:3,children:"3 - Srednja"}),e.jsx("option",{value:4,children:"4 - Visoka"}),e.jsx("option",{value:5,children:"5 - Zelo visoka"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Vpliv (1-5)"}),e.jsxs("select",{name:"impact",value:R.impact,onChange:ue,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary/20 focus:border-accent-primary",required:!0,children:[e.jsx("option",{value:1,children:"1 - Zelo nizek"}),e.jsx("option",{value:2,children:"2 - Nizek"}),e.jsx("option",{value:3,children:"3 - Srednji"}),e.jsx("option",{value:4,children:"4 - Visok"}),e.jsx("option",{value:5,children:"5 - Zelo visok"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Lastnik tveganja"}),e.jsx("input",{type:"text",name:"risk_owner",value:R.risk_owner,onChange:ue,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary/20 focus:border-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Status obravnavanja"}),e.jsxs("select",{name:"treatment_status",value:R.treatment_status,onChange:ue,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary/20 focus:border-accent-primary",required:!0,children:[e.jsx("option",{value:"Open",children:"Odprto"}),e.jsx("option",{value:"In Progress",children:"V delu"}),e.jsx("option",{value:"Implemented",children:"Implementirano"}),e.jsx("option",{value:"Accepted",children:"Sprejeto"}),e.jsx("option",{value:"Closed",children:"Zaprto"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>k(!1),className:"px-4 py-2 text-text-secondary hover:text-text-primary transition-colors",children:"Preklii"}),e.jsx("button",{type:"submit",disabled:A,className:"px-6 py-2 bg-accent-primary hover:bg-accent-primary/90 disabled:bg-accent-primary/50 text-white rounded-lg font-medium transition-colors",children:A?"Shranjujem...":"Shrani spremembe"})]})]})}),e.jsx(gi,{isOpen:P,onClose:()=>L(!1),onConfirm:ke,title:"Izbrii tveganje",message:`Ali ste prepriani, da elite izbrisati tveganje "${(F==null?void 0:F.risk_name)||""}"?`,isDeleting:C})]})};function sD({onNavigate:s}){const{user:t}=cr(),{profile:r,loading:a,refreshProfile:n}=Q4(),[i,o]=z.useState(!1),[c,d]=z.useState(null),[p,m]=z.useState({first_name:"",last_name:"",email:"",phone:"",company:"",avatar_url:""});if(z.useEffect(()=>{r&&m({first_name:r.first_name||"",last_name:r.last_name||"",email:(t==null?void 0:t.email)||"",phone:r.phone||"",company:r.department||"",avatar_url:r.avatar_url||""})},[r,t]),a)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})});async function x(h){if(h.preventDefault(),!!t){o(!0),d(null);try{const{error:j}=await Ne.from("profiles").update({first_name:p.first_name,last_name:p.last_name,phone:p.phone,department:p.company,avatar_url:p.avatar_url,updated_at:new Date().toISOString()}).eq("id",t.id);if(j)throw j;await n(),await Ip({action_type:Lp.PROFILE_EDIT,action_description:"Uporabnik je posodobil svoj profil"}),d({type:"success",text:"Profil je bil uspeno posodobljen"}),setTimeout(()=>d(null),3e3)}catch(j){console.error("Napaka pri shranjevanju profila:",j),d({type:"error",text:"Napaka pri shranjevanju profila"})}finally{o(!1)}}}function b(h,j){m(g=>({...g,[h]:j}))}return e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("button",{onClick:()=>s==null?void 0:s("dashboard"),className:"p-2 hover:bg-bg-surface-hover rounded-lg transition-colors",children:e.jsx(rx,{className:"w-5 h-5 text-text-secondary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Uredi profil"}),e.jsx("p",{className:"text-body-sm text-text-secondary mt-1",children:"Posodobite svoje osebne podatke"})]})]}),c&&e.jsx("div",{className:`mb-6 p-4 rounded-lg border ${c.type==="success"?"bg-status-success/10 border-status-success/30 text-status-success":"bg-status-error/10 border-status-error/30 text-status-error"}`,children:c.text}),e.jsxs("form",{onSubmit:x,className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-8 pb-8 border-b border-border-subtle",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-accent-primary flex items-center justify-center border-2 border-accent-primary",children:e.jsx(en,{className:"w-10 h-10 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-body-md font-medium text-text-primary mb-1",children:"Profilna slika"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Priporoena velikost: 200x200px"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"first_name",className:"block text-body-sm font-medium text-text-primary mb-2",children:"Ime"}),e.jsx("input",{type:"text",id:"first_name",value:p.first_name,onChange:h=>b("first_name",h.target.value),className:`w-full px-4 py-3 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary
                       focus:outline-none focus:border-accent-primary transition-colors`,placeholder:"Vnesite svoje ime"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"last_name",className:"block text-body-sm font-medium text-text-primary mb-2",children:"Priimek"}),e.jsx("input",{type:"text",id:"last_name",value:p.last_name,onChange:h=>b("last_name",h.target.value),className:`w-full px-4 py-3 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary
                       focus:outline-none focus:border-accent-primary transition-colors`,placeholder:"Vnesite svoj priimek"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-body-sm font-medium text-text-primary mb-2",children:"E-pota"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"email",id:"email",value:p.email,readOnly:!0,className:`w-full px-4 py-3 pl-10 bg-bg-surface border border-border-subtle rounded-lg text-text-secondary
                         cursor-not-allowed`}),e.jsx(bu,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-text-secondary"})]}),e.jsx("p",{className:"text-body-xs text-text-secondary mt-1",children:"E-potni naslov ni mogoe spremeniti"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-body-sm font-medium text-text-primary mb-2",children:"Telefon"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"tel",id:"phone",value:p.phone,onChange:h=>b("phone",h.target.value),className:`w-full px-4 py-3 pl-10 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary
                         focus:outline-none focus:border-accent-primary transition-colors`,placeholder:"+386 XX XXX XXX"}),e.jsx(hg,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-text-secondary"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"company",className:"block text-body-sm font-medium text-text-primary mb-2",children:"Podjetje/Organizacija"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",id:"company",value:p.company,onChange:h=>b("company",h.target.value),className:`w-full px-4 py-3 pl-10 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary
                         focus:outline-none focus:border-accent-primary transition-colors`,placeholder:"Vnesite ime podjetja"}),e.jsx(dg,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-text-secondary"})]})]})]}),e.jsx("div",{className:"mt-8 flex justify-end",children:e.jsx("button",{type:"submit",disabled:i,className:`flex items-center gap-2 px-6 py-3 bg-accent-primary text-white rounded-lg font-medium
                     hover:bg-accent-primary-hover transition-colors disabled:opacity-50 disabled:cursor-not-allowed`,children:i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e.jsx("span",{children:"Shranjujem..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Kp,{className:"w-4 h-4"}),e.jsx("span",{children:"Shrani spremembe"})]})})})]})]})}function aD({onNavigate:s}){const{user:t}=cr(),[r,a]=z.useState(!0),[n,i]=z.useState([]),[o,c]=z.useState([]),[d,p]=z.useState(""),[m,x]=z.useState("all"),[b,h]=z.useState(1),j=10;z.useEffect(()=>{g()},[t]),z.useEffect(()=>{v()},[n,d,m]);async function g(){if(t){a(!0);try{const{data:A,error:S}=await Ne.from("audit_logs").select("*").eq("user_id",t.id).order("created_at",{ascending:!1});if(S)throw S;i(A||[])}catch(A){console.error("Napaka pri nalaganju revizijske sledi:",A)}finally{a(!1)}}}function v(){let A=[...n];d&&(A=A.filter(S=>S.action_description.toLowerCase().includes(d.toLowerCase())||S.action_type.toLowerCase().includes(d.toLowerCase()))),m!=="all"&&(A=A.filter(S=>S.action_type===m)),c(A),h(1)}function _(A){return{login:"Prijava",logout:"Odjava",profile_edit:"Urejanje profila",password_change:"Sprememba gesla",data_export:"Izvoz podatkov",settings_change:"Sprememba nastavitev",view_page:"Ogled strani"}[A]||A}function k(A){return{login:"bg-status-success/20 text-status-success",logout:"bg-text-secondary/20 text-text-secondary",profile_edit:"bg-accent-primary/20 text-accent-primary",password_change:"bg-status-warning/20 text-status-warning",data_export:"bg-blue-500/20 text-blue-400",settings_change:"bg-purple-500/20 text-purple-400",view_page:"bg-text-secondary/10 text-text-secondary"}[A]||"bg-text-secondary/20 text-text-secondary"}function P(A){return new Date(A).toLocaleString("sl-SI",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"})}const L=Array.from(new Set(n.map(A=>A.action_type))),F=b*j,W=F-j,R=o.slice(W,F),B=Math.ceil(o.length/j);return r?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})}):e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("button",{onClick:()=>s==null?void 0:s("dashboard"),className:"p-2 hover:bg-bg-surface-hover rounded-lg transition-colors",children:e.jsx(rx,{className:"w-5 h-5 text-text-secondary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Revizijska sled"}),e.jsx("p",{className:"text-body-sm text-text-secondary mt-1",children:"Pregled aktivnosti vaega rauna"})]})]}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ss,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-text-secondary"}),e.jsx("input",{type:"text",value:d,onChange:A=>p(A.target.value),placeholder:"Ii po opisu aktivnosti...",className:`w-full pl-10 pr-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary
                       focus:outline-none focus:border-accent-primary transition-colors`})]}),e.jsxs("div",{className:"relative min-w-[200px]",children:[e.jsx(Wp,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-text-secondary pointer-events-none"}),e.jsxs("select",{value:m,onChange:A=>x(A.target.value),className:`w-full pl-10 pr-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary
                       focus:outline-none focus:border-accent-primary transition-colors appearance-none cursor-pointer`,children:[e.jsx("option",{value:"all",children:"Vse aktivnosti"}),L.map(A=>e.jsx("option",{value:A,children:_(A)},A))]})]})]})}),e.jsxs("div",{className:"mb-4 text-body-sm text-text-secondary",children:["Prikazujem ",o.length," ",o.length===1?"rezultat":o.length>4?"rezultatov":"rezultate"]}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg overflow-hidden",children:R.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ut,{className:"w-12 h-12 text-text-secondary mx-auto mb-4"}),e.jsx("p",{className:"text-body-md text-text-secondary",children:"Ni najdenih aktivnosti"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border-subtle bg-bg-near-black",children:[e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-medium text-text-secondary",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_a,{className:"w-4 h-4"}),"Datum in as"]})}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-medium text-text-secondary",children:"Tip aktivnosti"}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-medium text-text-secondary",children:"Opis"}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-medium text-text-secondary",children:"IP naslov"})]})}),e.jsx("tbody",{children:R.map((A,S)=>e.jsxs("tr",{className:`border-b border-border-subtle hover:bg-bg-surface-hover transition-colors ${S===R.length-1?"border-b-0":""}`,children:[e.jsx("td",{className:"px-4 py-4 text-body-sm text-text-primary whitespace-nowrap",children:P(A.created_at)}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("span",{className:`inline-block px-2 py-1 rounded text-body-xs font-medium ${k(A.action_type)}`,children:_(A.action_type)})}),e.jsx("td",{className:"px-4 py-4 text-body-sm text-text-secondary",children:A.action_description}),e.jsx("td",{className:"px-4 py-4 text-body-sm text-text-secondary",children:A.ip_address||"-"})]},A.id))})]})})}),B>1&&e.jsxs("div",{className:"mt-6 flex items-center justify-center gap-2",children:[e.jsx("button",{onClick:()=>h(A=>Math.max(1,A-1)),disabled:b===1,className:`px-4 py-2 border border-border-subtle rounded-lg text-body-sm text-text-primary
                     hover:bg-bg-surface-hover transition-colors disabled:opacity-50 disabled:cursor-not-allowed`,children:"Prejnja"}),e.jsxs("span",{className:"px-4 py-2 text-body-sm text-text-secondary",children:["Stran ",b," od ",B]}),e.jsx("button",{onClick:()=>h(A=>Math.min(B,A+1)),disabled:b===B,className:`px-4 py-2 border border-border-subtle rounded-lg text-body-sm text-text-primary
                     hover:bg-bg-surface-hover transition-colors disabled:opacity-50 disabled:cursor-not-allowed`,children:"Naslednja"})]})]})}function nD({onClose:s}){const[t,r]=z.useState(!1),[a,n]=z.useState(!1),[i,o]=z.useState(!1),[c,d]=z.useState(!1),[p,m]=z.useState(null),[x,b]=z.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[h,j]=z.useState({});function g(){const k={};return x.currentPassword||(k.currentPassword="Trenutno geslo je obvezno"),x.newPassword?x.newPassword.length<8&&(k.newPassword="Geslo mora vsebovati vsaj 8 znakov"):k.newPassword="Novo geslo je obvezno",x.confirmPassword?x.newPassword!==x.confirmPassword&&(k.confirmPassword="Gesli se ne ujemata"):k.confirmPassword="Potrditev gesla je obvezna",j(k),Object.keys(k).length===0}async function v(k){if(k.preventDefault(),!!g()){d(!0),m(null);try{const{data:{user:P}}=await Ne.auth.getUser();if(!(P!=null&&P.email))throw new Error("Uporabnik ni prijavljen");const{error:L}=await Ne.auth.signInWithPassword({email:P.email,password:x.currentPassword});if(L){j({currentPassword:"Trenutno geslo je napano"}),d(!1);return}const{error:F}=await Ne.auth.updateUser({password:x.newPassword});if(F)throw F;await Ip({action_type:Lp.PASSWORD_CHANGE,action_description:"Uporabnik je spremenil svoje geslo"}),m({type:"success",text:"Geslo je bilo uspeno spremenjeno"}),setTimeout(()=>{s()},2e3)}catch(P){console.error("Napaka pri spreminjanju gesla:",P),m({type:"error",text:P.message||"Napaka pri spreminjanju gesla"})}finally{d(!1)}}}function _(k,P){b(L=>({...L,[k]:P})),j(L=>({...L,[k]:void 0}))}return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:s}),e.jsxs("div",{className:"relative w-full max-w-md mx-4 bg-bg-surface border border-border-subtle rounded-lg shadow-xl animate-in fade-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-border-subtle",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-accent-primary/10 rounded-lg",children:e.jsx(mg,{className:"w-5 h-5 text-accent-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-heading-md font-semibold text-text-primary",children:"Spremeni geslo"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Posodobite svoje geslo"})]})]}),e.jsx("button",{onClick:s,className:"p-2 hover:bg-bg-surface-hover rounded-lg transition-colors",children:e.jsx(Ar,{className:"w-5 h-5 text-text-secondary"})})]}),p&&e.jsx("div",{className:`mx-6 mt-4 p-4 rounded-lg border ${p.type==="success"?"bg-status-success/10 border-status-success/30 text-status-success":"bg-status-error/10 border-status-error/30 text-status-error"}`,children:p.text}),e.jsxs("form",{onSubmit:v,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"currentPassword",className:"block text-body-sm font-medium text-text-primary mb-2",children:"Trenutno geslo"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:t?"text":"password",id:"currentPassword",value:x.currentPassword,onChange:k=>_("currentPassword",k.target.value),className:`w-full px-4 py-3 pr-10 bg-bg-near-black border rounded-lg text-text-primary
                         focus:outline-none transition-colors ${h.currentPassword?"border-status-error focus:border-status-error":"border-border-subtle focus:border-accent-primary"}`,placeholder:"Vnesite trenutno geslo"}),e.jsx("button",{type:"button",onClick:()=>r(!t),className:"absolute right-3 top-1/2 -translate-y-1/2 text-text-secondary hover:text-text-primary transition-colors",children:t?e.jsx(wf,{className:"w-4 h-4"}):e.jsx(lr,{className:"w-4 h-4"})})]}),h.currentPassword&&e.jsx("p",{className:"text-body-xs text-status-error mt-1",children:h.currentPassword})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"newPassword",className:"block text-body-sm font-medium text-text-primary mb-2",children:"Novo geslo"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:a?"text":"password",id:"newPassword",value:x.newPassword,onChange:k=>_("newPassword",k.target.value),className:`w-full px-4 py-3 pr-10 bg-bg-near-black border rounded-lg text-text-primary
                         focus:outline-none transition-colors ${h.newPassword?"border-status-error focus:border-status-error":"border-border-subtle focus:border-accent-primary"}`,placeholder:"Vnesite novo geslo (min. 8 znakov)"}),e.jsx("button",{type:"button",onClick:()=>n(!a),className:"absolute right-3 top-1/2 -translate-y-1/2 text-text-secondary hover:text-text-primary transition-colors",children:a?e.jsx(wf,{className:"w-4 h-4"}):e.jsx(lr,{className:"w-4 h-4"})})]}),h.newPassword&&e.jsx("p",{className:"text-body-xs text-status-error mt-1",children:h.newPassword})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-body-sm font-medium text-text-primary mb-2",children:"Potrdi novo geslo"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:i?"text":"password",id:"confirmPassword",value:x.confirmPassword,onChange:k=>_("confirmPassword",k.target.value),className:`w-full px-4 py-3 pr-10 bg-bg-near-black border rounded-lg text-text-primary
                         focus:outline-none transition-colors ${h.confirmPassword?"border-status-error focus:border-status-error":"border-border-subtle focus:border-accent-primary"}`,placeholder:"Ponovno vnesite novo geslo"}),e.jsx("button",{type:"button",onClick:()=>o(!i),className:"absolute right-3 top-1/2 -translate-y-1/2 text-text-secondary hover:text-text-primary transition-colors",children:i?e.jsx(wf,{className:"w-4 h-4"}):e.jsx(lr,{className:"w-4 h-4"})})]}),h.confirmPassword&&e.jsx("p",{className:"text-body-xs text-status-error mt-1",children:h.confirmPassword})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:s,className:`flex-1 px-4 py-3 border border-border-subtle rounded-lg text-text-primary font-medium
                       hover:bg-bg-surface-hover transition-colors`,children:"Preklii"}),e.jsx("button",{type:"submit",disabled:c,className:`flex-1 px-4 py-3 bg-accent-primary text-white rounded-lg font-medium
                       hover:bg-accent-primary-hover transition-colors disabled:opacity-50 disabled:cursor-not-allowed
                       flex items-center justify-center gap-2`,children:c?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e.jsx("span",{children:"Shranjujem..."})]}):"Spremeni geslo"})]})]})]})]})}function iD(){const[s,t]=z.useState({naronik:"",telefon:"",email:"",tip_testa:"",namen_testa:"",cilj_testa:"",opis:"",opombe:"",osebe_senzani:"",predviden_termin:"",kontaktna_oseba:"",narocilnica_st:"",zelite_ponudbo:"",priloga:null}),[r,a]=z.useState(!1),n=d=>{const{name:p,value:m}=d.target;t(x=>({...x,[p]:m}))},i=d=>{var m;const p=((m=d.target.files)==null?void 0:m[0])||null;t(x=>({...x,priloga:p}))},o=d=>{d.preventDefault(),a(!0);const p="Naroilo IT-varnostnih testov",m=`
Naroilo IT-varnostnih testov

Naronik: ${s.naronik}
Telefon: ${s.telefon}
E-naslov: ${s.email}

Tip IT-varnostnega testa: ${s.tip_testa}
Namen testa: ${s.namen_testa}
Cilj testa: ${s.cilj_testa}

Opis: ${s.opis}
Opombe: ${s.opombe}

Osebe, ki bodo seznanjene o testu: ${s.osebe_senzani}
Predviden termin testa: ${s.predviden_termin}
Kontaktna oseba: ${s.kontaktna_oseba}
Naroilnica t.: ${s.narocilnica_st}
elite ponudbo?: ${s.zelite_ponudbo}

Priloga: ${s.priloga?s.priloga.name:"Ni priloene datoteke"}

Poiljam z aplikacije NIS2 Control Dashboard.
    `.trim(),x=`mailto:info@nis2.si?subject=${encodeURIComponent(p)}&body=${encodeURIComponent(m)}`;window.location.href=x,a(!1)},c=["Phishing","Sistemski pregled","Pen test","Socialni ineniring","Drugo"];return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(Mt,{className:"w-8 h-8 text-accent-primary"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Naroilo IT-varnostnih testov"}),e.jsx("p",{className:"text-text-tertiary",children:"Formular za naroilo IT varnostnih storitev"})]})]})}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:e.jsxs("form",{onSubmit:o,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center gap-2",children:[e.jsx(ut,{className:"w-5 h-5"}),"Osnovni podatki"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Naronik *"}),e.jsx("input",{type:"text",name:"naronik",value:s.naronik,onChange:n,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Telefon *"}),e.jsx("input",{type:"tel",name:"telefon",value:s.telefon,onChange:n,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"E-naslov *"}),e.jsx("input",{type:"email",name:"email",value:s.email,onChange:n,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Tip IT-varnostnega testa *"}),e.jsxs("select",{name:"tip_testa",value:s.tip_testa,onChange:n,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0,children:[e.jsx("option",{value:"",children:"Izberite tip testa"}),c.map(d=>e.jsx("option",{value:d,children:d},d))]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Namen in cilji testa"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Namen testa *"}),e.jsx("textarea",{name:"namen_testa",value:s.namen_testa,onChange:n,rows:3,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Cilj testa *"}),e.jsx("textarea",{name:"cilj_testa",value:s.cilj_testa,onChange:n,rows:3,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Opis"}),e.jsx("textarea",{name:"opis",value:s.opis,onChange:n,rows:4,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Opombe"}),e.jsx("textarea",{name:"opombe",value:s.opombe,onChange:n,rows:3,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Dodatne informacije"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Navedite osebe, ki bodo seznanjene o testu *"}),e.jsx("textarea",{name:"osebe_senzani",value:s.osebe_senzani,onChange:n,rows:3,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Predviden termin testa *"}),e.jsx("input",{type:"date",name:"predviden_termin",value:s.predviden_termin,onChange:n,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Kontaktna oseba *"}),e.jsx("input",{type:"text",name:"kontaktna_oseba",value:s.kontaktna_oseba,onChange:n,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Naroilnica t."}),e.jsx("input",{type:"text",name:"narocilnica_st",value:s.narocilnica_st,onChange:n,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"elite ponudbo? *"}),e.jsxs("select",{name:"zelite_ponudbo",value:s.zelite_ponudbo,onChange:n,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0,children:[e.jsx("option",{value:"",children:"Izberite"}),e.jsx("option",{value:"DA",children:"DA"}),e.jsx("option",{value:"NE",children:"NE"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Priloga (npr. naroilnica, podatki)"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"file",onChange:i,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",accept:".pdf,.doc,.docx,.txt,.jpg,.jpeg,.png"}),s.priloga&&e.jsx("span",{className:"text-text-secondary text-sm",children:s.priloga.name})]})]})]})]}),e.jsx("div",{className:"flex justify-center pt-6",children:e.jsxs("button",{type:"submit",disabled:r,className:"flex items-center gap-2 px-8 py-3 bg-accent-primary hover:bg-accent-primary/90 disabled:bg-gray-500 text-white font-semibold rounded-lg transition-colors",children:[e.jsx(ku,{className:"w-5 h-5"}),r?"Poiljam...":"Polji"]})})]})}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ut,{className:"w-5 h-5 text-accent-primary mt-1 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary mb-2",children:"Navodila"}),e.jsxs("p",{className:"text-text-secondary text-sm",children:['Ko kliknete "Polji", se bo odprl va privzeti e-potni odjemalec z vnaprej izpolnjenim e-potnim naslovom',e.jsx("strong",{children:" info@nis2.si "})," in naslovom zadeve ",e.jsx("strong",{children:' "Naroilo IT-varnostnih testov"'}),". Vsa polja, ki ste jih izpolnili, bodo samodejno vkljuena v telo e-pote. Priloene datoteke bodo morale biti priloene rono v e-potnem odjemalcu."]})]})]})})]})}function oD(){const[s,t]=z.useState({naronik:"",telefon:"",email:"",podroje_izobraevanja:"",namen_izobraevanja:"",cilj_izobraevanja:"",opis:"",opombe:"",osebe_senzani:"",predviden_termin:"",kontaktna_oseba:"",narocilnica_st:"",zelite_ponudbo:"",priloga:null}),[r,a]=z.useState(!1),n=d=>{const{name:p,value:m}=d.target;t(x=>({...x,[p]:m}))},i=d=>{var m;const p=((m=d.target.files)==null?void 0:m[0])||null;t(x=>({...x,priloga:p}))},o=d=>{d.preventDefault(),a(!0);const p="Naroilo izobraevanja",m=`
Naroilo izobraevanja

Naronik: ${s.naronik}
Telefon: ${s.telefon}
E-naslov: ${s.email}

Podroje izobraevanja: ${s.podroje_izobraevanja}

Namen izobraevanja:
${s.namen_izobraevanja}

Cilj izobraevanja:
${s.cilj_izobraevanja}

Opis:
${s.opis}

Opombe:
${s.opombe}

Osebe, ki bodo seznanjene o izobraevanju: ${s.osebe_senzani}
Predviden termin: ${s.predviden_termin}
Kontaktna oseba: ${s.kontaktna_oseba}
Naroilnica t.: ${s.narocilnica_st}
elite ponudbo?: ${s.zelite_ponudbo}

Priloga: ${s.priloga?s.priloga.name:"Ni priloene datoteke"}

Poiljam z aplikacije Standario.
    `.trim(),x=`mailto:info@standario.si?subject=${encodeURIComponent(p)}&body=${encodeURIComponent(m)}`;window.location.href=x,a(!1)},c=["Informacijska varnost","Umetna inteligenca","Drugo"];return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(hi,{className:"w-8 h-8 text-accent-primary"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Naroilo izobraevanja"}),e.jsx("p",{className:"text-text-tertiary",children:"Formular za naroilo izobraevalnih storitev"})]})]})}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:e.jsxs("form",{onSubmit:o,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center gap-2",children:[e.jsx(ut,{className:"w-5 h-5"}),"Osnovni podatki"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Naronik *"}),e.jsx("input",{type:"text",name:"naronik",value:s.naronik,onChange:n,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Telefon *"}),e.jsx("input",{type:"tel",name:"telefon",value:s.telefon,onChange:n,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"E-naslov *"}),e.jsx("input",{type:"email",name:"email",value:s.email,onChange:n,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Podroje izobraevanja *"}),e.jsxs("select",{name:"podroje_izobraevanja",value:s.podroje_izobraevanja,onChange:n,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0,children:[e.jsx("option",{value:"",children:"Izberite podroje"}),c.map(d=>e.jsx("option",{value:d,children:d},d))]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Namen in cilji izobraevanja"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Namen izobraevanja *"}),e.jsx("textarea",{name:"namen_izobraevanja",value:s.namen_izobraevanja,onChange:n,rows:3,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Cilj izobraevanja *"}),e.jsx("textarea",{name:"cilj_izobraevanja",value:s.cilj_izobraevanja,onChange:n,rows:3,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Opis"}),e.jsx("textarea",{name:"opis",value:s.opis,onChange:n,rows:4,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Opombe"}),e.jsx("textarea",{name:"opombe",value:s.opombe,onChange:n,rows:3,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Dodatne informacije"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Navedite osebe, ki bodo seznanjene o izobraevanju *"}),e.jsx("textarea",{name:"osebe_senzani",value:s.osebe_senzani,onChange:n,rows:3,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Predviden termin"}),e.jsx("input",{type:"date",name:"predviden_termin",value:s.predviden_termin,onChange:n,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Kontaktna oseba"}),e.jsx("input",{type:"text",name:"kontaktna_oseba",value:s.kontaktna_oseba,onChange:n,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Naroilnica t."}),e.jsx("input",{type:"text",name:"narocilnica_st",value:s.narocilnica_st,onChange:n,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center gap-2",children:[e.jsx(Xa,{className:"w-5 h-5"}),"Priloge"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Dodaj prilogo (datoteka do 10MB)"}),e.jsx("input",{type:"file",onChange:i,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",accept:".pdf,.doc,.docx,.txt,.xls,.xlsx"}),s.priloga&&e.jsxs("p",{className:"text-body-sm text-accent-primary mt-1",children:["Izbrana datoteka: ",s.priloga.name]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Dodatne zahteve"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"elite prejeti ponudbo?"}),e.jsxs("select",{name:"zelite_ponudbo",value:s.zelite_ponudbo,onChange:n,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",children:[e.jsx("option",{value:"",children:"Izberite..."}),e.jsx("option",{value:"Da, elim",children:"Da, elim"}),e.jsx("option",{value:"Ne, ni potrebno",children:"Ne, ni potrebno"})]})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx("button",{type:"submit",disabled:r,className:"w-full bg-accent-primary hover:bg-accent-primary/90 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:r?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/20 border-t-white rounded-full animate-spin"}),"Poiljam..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ku,{className:"w-4 h-4"}),"Polji naroilo"]})})})]})})]})}function lD(){const[s,t]=z.useState({naronik:"",telefon:"",email:"",podroje_its:"",namen_storitve:"",cilj_storitve:"",opis:"",opombe:"",osebe_senzani:"",predviden_termin:"",kontaktna_oseba:"",narocilnica_st:"",zelite_ponudbo:"",priloga:null}),[r,a]=z.useState(!1),n=d=>{const{name:p,value:m}=d.target;t(x=>({...x,[p]:m}))},i=d=>{var m;const p=((m=d.target.files)==null?void 0:m[0])||null;t(x=>({...x,priloga:p}))},o=d=>{d.preventDefault(),a(!0);const p="Naroilo IT-storitev",m=`
Naroilo IT-storitev

Naronik: ${s.naronik}
Telefon: ${s.telefon}
E-naslov: ${s.email}

Podroje IT-storitve: ${s.podroje_its}

Namen storitve:
${s.namen_storitve}

Cilj storitve:
${s.cilj_storitve}

Opis:
${s.opis}

Opombe:
${s.opombe}

Osebe, ki bodo seznanjene o storitvi: ${s.osebe_senzani}
Predviden termin: ${s.predviden_termin}
Kontaktna oseba: ${s.kontaktna_oseba}
Naroilnica t.: ${s.narocilnica_st}
elite ponudbo?: ${s.zelite_ponudbo}

Priloga: ${s.priloga?s.priloga.name:"Ni priloene datoteke"}

Poiljam z aplikacije Standario.
    `.trim(),x=`mailto:info@standario.si?subject=${encodeURIComponent(p)}&body=${encodeURIComponent(m)}`;window.location.href=x,a(!1)},c=["IT svetovanje","IT tehnina pomo","Drugo"];return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(sc,{className:"w-8 h-8 text-accent-primary"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Naroilo IT-storitev"}),e.jsx("p",{className:"text-text-tertiary",children:"Formular za naroilo IT storitev"})]})]})}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:e.jsxs("form",{onSubmit:o,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center gap-2",children:[e.jsx(ut,{className:"w-5 h-5"}),"Osnovni podatki"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Naronik *"}),e.jsx("input",{type:"text",name:"naronik",value:s.naronik,onChange:n,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Telefon *"}),e.jsx("input",{type:"tel",name:"telefon",value:s.telefon,onChange:n,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"E-naslov *"}),e.jsx("input",{type:"email",name:"email",value:s.email,onChange:n,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Podroje IT-storitve *"}),e.jsxs("select",{name:"podroje_its",value:s.podroje_its,onChange:n,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0,children:[e.jsx("option",{value:"",children:"Izberite podroje"}),c.map(d=>e.jsx("option",{value:d,children:d},d))]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Namen in cilji storitve"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Namen storitve *"}),e.jsx("textarea",{name:"namen_storitve",value:s.namen_storitve,onChange:n,rows:3,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Cilj storitve *"}),e.jsx("textarea",{name:"cilj_storitve",value:s.cilj_storitve,onChange:n,rows:3,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Opis"}),e.jsx("textarea",{name:"opis",value:s.opis,onChange:n,rows:4,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Opombe"}),e.jsx("textarea",{name:"opombe",value:s.opombe,onChange:n,rows:3,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Dodatne informacije"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Navedite osebe, ki bodo seznanjene o storitvi *"}),e.jsx("textarea",{name:"osebe_senzani",value:s.osebe_senzani,onChange:n,rows:3,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Predviden termin"}),e.jsx("input",{type:"date",name:"predviden_termin",value:s.predviden_termin,onChange:n,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Kontaktna oseba"}),e.jsx("input",{type:"text",name:"kontaktna_oseba",value:s.kontaktna_oseba,onChange:n,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Naroilnica t."}),e.jsx("input",{type:"text",name:"narocilnica_st",value:s.narocilnica_st,onChange:n,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center gap-2",children:[e.jsx(Xa,{className:"w-5 h-5"}),"Priloge"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Dodaj prilogo (datoteka do 10MB)"}),e.jsx("input",{type:"file",onChange:i,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",accept:".pdf,.doc,.docx,.txt,.xls,.xlsx"}),s.priloga&&e.jsxs("p",{className:"text-body-sm text-accent-primary mt-1",children:["Izbrana datoteka: ",s.priloga.name]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Dodatne zahteve"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"elite prejeti ponudbo?"}),e.jsxs("select",{name:"zelite_ponudbo",value:s.zelite_ponudbo,onChange:n,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",children:[e.jsx("option",{value:"",children:"Izberite..."}),e.jsx("option",{value:"Da, elim",children:"Da, elim"}),e.jsx("option",{value:"Ne, ni potrebno",children:"Ne, ni potrebno"})]})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx("button",{type:"submit",disabled:r,className:"w-full bg-accent-primary hover:bg-accent-primary/90 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:r?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/20 border-t-white rounded-full animate-spin"}),"Poiljam..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ku,{className:"w-4 h-4"}),"Polji naroilo"]})})})]})})]})}function cD(){const[s,t]=z.useState({naronik:"",telefon:"",email:"",zadeva:"","sporoilo naroila":""}),[r,a]=z.useState(!1),n=o=>{const{name:c,value:d}=o.target;t(p=>({...p,[c]:d}))},i=o=>{o.preventDefault(),a(!0);const c=`Naroilo ponudbe: ${s.zadeva}`,d=`
Naroilo ponudbe

Naronik: ${s.naronik}
Telefon: ${s.telefon}
E-naslov: ${s.email}

Zadeva: ${s.zadeva}

Sporoilo naroila:
${s["sporoilo naroila"]}

Poiljam z aplikacije Standario.
    `.trim(),p=`mailto:info@standario.si?subject=${encodeURIComponent(c)}&body=${encodeURIComponent(d)}`;window.location.href=p,a(!1)};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(ut,{className:"w-8 h-8 text-accent-primary"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Naroilo ponudbe"}),e.jsx("p",{className:"text-text-tertiary",children:"Formular za naroilo ponudbe"})]})]})}),e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:[e.jsxs("form",{onSubmit:i,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center gap-2",children:[e.jsx(ut,{className:"w-5 h-5"}),"Osnovni podatki"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Naronik *"}),e.jsx("input",{type:"text",name:"naronik",value:s.naronik,onChange:n,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Telefon *"}),e.jsx("input",{type:"tel",name:"telefon",value:s.telefon,onChange:n,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"E-naslov *"}),e.jsx("input",{type:"email",name:"email",value:s.email,onChange:n,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Zadeva *"}),e.jsx("input",{type:"text",name:"zadeva",value:s.zadeva,onChange:n,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Sporoilo naroila"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-primary mb-2",children:"Sporoilo naroila *"}),e.jsx("textarea",{name:"sporoilo naroila",value:s["sporoilo naroila"],onChange:n,rows:6,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0,placeholder:"Podrobno opiite vae zahteve, tehnine specifikacije, asovne okvire ali druge pomembne informacije..."})]})})]}),e.jsx("div",{className:"pt-4",children:e.jsx("button",{type:"submit",disabled:r,className:"w-full bg-accent-primary hover:bg-accent-primary/90 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:r?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/20 border-t-white rounded-full animate-spin"}),"Poiljam..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ku,{className:"w-4 h-4"}),"Polji naroilo ponudbe"]})})})]}),e.jsx("div",{className:"mt-6 p-4 bg-bg-near-black rounded-lg border border-border-subtle",children:e.jsxs("p",{className:"text-sm text-text-tertiary",children:[e.jsx("strong",{children:"Opomba:"}),' Po kliku na "Polji naroilo ponudbe" se bo odprl va privzeti email odjemalec z vnaprej izpolnjeno vsebino. Poljite email za dokonanje poiljanja.']})})]})]})}function dD({onNavigate:s}){const t=[{id:"it-security-tests-order",title:"Naroilo IT-testov",description:"Naroite razline varnostne teste in preverjanja vaih IT sistemov.",icon:sc,color:"bg-blue-500"},{id:"education-order",title:"Naroilo izobraevanja",description:"Naroite usposabljanja in izobraevanja za vae zaposlene.",icon:hi,color:"bg-green-500"},{id:"it-services-order",title:"Naroilo IT-storitev",description:"Naroite razline IT storitve in tehnino podporo.",icon:fi,color:"bg-purple-500"},{id:"services-quote-order",title:"Naroilo ponudbe",description:"Naroite prilagojeno ponudbo za vae specifine potrebe.",icon:ut,color:"bg-orange-500"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Naroilo storitev"}),e.jsx("p",{className:"text-text-tertiary",children:"Izberite vrsto storitve, ki jo elite naroiti"})]}),e.jsx("div",{className:"w-20 h-20 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center shadow-lg",children:e.jsx(fi,{className:"w-10 h-10 text-white"})})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:t.map(r=>{const a=r.icon;return e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6 hover:bg-bg-surface-hover transition-all duration-200 cursor-pointer group",onClick:()=>s(r.id),children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg ${r.color} flex items-center justify-center`,children:e.jsx(a,{className:"w-6 h-6 text-white"})}),e.jsx(lg,{className:"w-5 h-5 text-text-tertiary group-hover:text-accent-primary transition-colors duration-200"})]}),e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2 group-hover:text-accent-primary transition-colors duration-200",children:r.title}),e.jsx("p",{className:"text-text-secondary mb-4 text-sm",children:r.description}),e.jsx("div",{className:"mt-4 pt-4 border-t border-border-subtle",children:e.jsx("button",{className:"w-full text-left text-sm font-medium text-accent-primary hover:text-accent-primary/80 transition-colors duration-200",children:"Kliknite za naroilo "})})]},r.id)})}),e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-3",children:"Kako deluje naroilo storitev?"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-accent-primary/10 flex items-center justify-center",children:e.jsx("span",{className:"text-accent-primary font-semibold",children:"1"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-text-primary",children:"Izpolnite obrazec"}),e.jsx("p",{className:"text-text-tertiary",children:"Navedite vae zahteve in potrebe"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-accent-primary/10 flex items-center justify-center",children:e.jsx("span",{className:"text-accent-primary font-semibold",children:"2"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-text-primary",children:"Prejmite odgovor"}),e.jsx("p",{className:"text-text-tertiary",children:"Kontaktirali vas bomo v 24 urah"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-accent-primary/10 flex items-center justify-center",children:e.jsx("span",{className:"text-accent-primary font-semibold",children:"3"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-text-primary",children:"Izvedba storitve"}),e.jsx("p",{className:"text-text-tertiary",children:"Po dogovoru izvedemo storitev"})]})]})]})]})]})}const uD=({isOpen:s,onClose:t,onSave:r})=>{const{t:a}=et(),n=[{key:"device_id",label:a("modals.add.common.deviceId"),type:"text",required:!0},{key:"device_name",label:a("modals.add.common.deviceName"),type:"text",required:!0},{key:"device_type",label:a("modals.add.common.deviceType"),type:"select",required:!0,options:["server","laptop","desktop","mobile","tablet","network_device","printer","storage"]},{key:"manufacturer",label:a("modals.add.common.manufacturer"),type:"text"},{key:"model",label:a("modals.add.common.model"),type:"text"},{key:"serial_number",label:a("modals.add.common.serialNumber"),type:"text"},{key:"location",label:a("modals.add.common.location"),type:"text"},{key:"department",label:a("modals.add.common.department"),type:"text"},{key:"assigned_to",label:a("modals.add.common.assignedTo"),type:"text"},{key:"purchase_date",label:a("modals.add.common.purchaseDate"),type:"date"},{key:"warranty_expiry",label:a("modals.add.common.warrantyExpiry"),type:"date"},{key:"status",label:a("modals.add.common.status"),type:"select",options:["active","inactive","maintenance","retired"]},{key:"condition",label:a("modals.add.common.condition"),type:"select",options:["excellent","good","fair","poor"]},{key:"notes",label:a("modals.add.common.notes"),type:"textarea"}];return e.jsx(ha,{isOpen:s,onClose:t,onSave:r,title:a("modals.add.inventoryDevice.title"),table:"inventory_devices",fields:n})};function pD(){const{t:s}=et(),[t,r]=z.useState([]),[a,n]=z.useState([]),[i,o]=z.useState(!0),[c,d]=z.useState(!1),[p,m]=z.useState(null),[x,b]=z.useState(!1),[h,j]=z.useState(!1),[g,v]=z.useState(!1),[_,k]=z.useState(null),[P,L]=z.useState({device_id:"",device_name:"",device_type:"server",manufacturer:"",model:"",serial_number:"",location:"",department:"",assigned_to:"",purchase_date:"",warranty_expiry:"",status:"active",condition:"good",notes:""}),[F,W]=z.useState(!1),[R,B]=z.useState(!1),[A,S]=z.useState("all"),[C,O]=z.useState("");z.useEffect(()=>{Z()},[]),z.useEffect(()=>{te()},[t,A,C]);const Z=async()=>{try{const{data:I,error:Y}=await Ne.from("inventory_devices").select("*").order("created_at",{ascending:!1});if(Y)throw Y;!I||I.length===0?r([{id:"demo-1",device_id:"SRV-001",device_name:"Glavni strenik SRV-001",device_type:"server",manufacturer:"Dell Technologies",model:"PowerEdge R740",serial_number:"SRV001234567",location:"Podatkovni center A",department:"IT oddelek",assigned_to:"Janez Novak",purchase_date:"2023-03-15",warranty_expiry:"2026-03-15",status:"active",condition:"excellent",notes:"Produkcijski strenik za kljune aplikacije",created_at:"2023-03-15T10:00:00Z",updated_at:"2024-11-01T14:30:00Z"},{id:"demo-2",device_id:"LAP-123",device_name:"Prenosni raunalnik LAP-123",device_type:"laptop",manufacturer:"Lenovo",model:"ThinkPad T14",serial_number:"LAP123456789",location:"Pisarna 201",department:"Razvoj",assigned_to:"Ana Kova",purchase_date:"2024-01-10",warranty_expiry:"2026-01-10",status:"active",condition:"good",notes:"Uporablja se za razvoj programske opreme",created_at:"2024-01-10T09:00:00Z",updated_at:"2024-11-05T11:15:00Z"},{id:"demo-3",device_id:"PRT-456",device_name:"Barvni tiskalnik PRT-456",device_type:"printer",manufacturer:"HP",model:"LaserJet Pro 400",serial_number:"PRT456789123",location:"Pisarna 105",department:"Administracija",assigned_to:"Marjeta Horvat",purchase_date:"2022-11-20",warranty_expiry:"2025-11-20",status:"maintenance",condition:"fair",notes:"Potrebna menjava tonerja, nartovano vzdrevanje",created_at:"2022-11-20T13:00:00Z",updated_at:"2024-11-08T16:20:00Z"},{id:"demo-4",device_id:"TAB-789",device_name:"Tablica TAB-789",device_type:"tablet",manufacturer:"Apple",model:'iPad Pro 12.9"',serial_number:"TAB789456123",location:"Skladie",department:"Prodaja",assigned_to:"Peter Pavlin",purchase_date:"2024-06-15",warranty_expiry:"2025-06-15",status:"inactive",condition:"excellent",notes:"Rezervna naprava, ni v uporabi",created_at:"2024-06-15T10:30:00Z",updated_at:"2024-11-02T08:45:00Z"},{id:"demo-5",device_id:"MOB-321",device_name:"Mobilni telefon MOB-321",device_type:"mobile",manufacturer:"Samsung",model:"Galaxy S24",serial_number:"MOB321789456",location:"Direktorjeva pisarna",department:"Vodstvo",assigned_to:"Direktor Janez",purchase_date:"2024-02-28",warranty_expiry:"2026-02-28",status:"active",condition:"excellent",notes:"Poslovni telefon direktorja",created_at:"2024-02-28T14:00:00Z",updated_at:"2024-11-07T10:10:00Z"}]):r(I)}catch(I){console.error("Error:",I),r([{id:"fallback-1",device_id:"NET-555",device_name:"Omreno stikalo NET-555",device_type:"network_device",manufacturer:"Cisco",model:"Catalyst 2960X",serial_number:"NET555123789",location:"IT omora",department:"IT oddelek",assigned_to:"IT ekipa",purchase_date:"2023-08-10",warranty_expiry:"2026-08-10",status:"active",condition:"good",notes:"Glavno omreno stikalo",created_at:"2023-08-10T11:00:00Z",updated_at:"2024-11-09T09:30:00Z"}])}finally{o(!1)}},te=()=>{let I=[...t];if(A!=="all"&&(I=I.filter(Y=>Y.status===A)),C.trim()){const Y=C.toLowerCase();I=I.filter(H=>{var he,ge,K,T;return((he=H.device_name)==null?void 0:he.toLowerCase().includes(Y))||((ge=H.manufacturer)==null?void 0:ge.toLowerCase().includes(Y))||((K=H.model)==null?void 0:K.toLowerCase().includes(Y))||((T=H.device_id)==null?void 0:T.toLowerCase().includes(Y))})}n(I)},ce=async()=>{await Z()},re=I=>{m(I),b(!0)},X=()=>{b(!1),m(null)},U=I=>{k(I),L({device_id:I.device_id||"",device_name:I.device_name||"",device_type:I.device_type||"server",manufacturer:I.manufacturer||"",model:I.model||"",serial_number:I.serial_number||"",location:I.location||"",department:I.department||"",assigned_to:I.assigned_to||"",purchase_date:I.purchase_date?new Date(I.purchase_date).toISOString().split("T")[0]:"",warranty_expiry:I.warranty_expiry?new Date(I.warranty_expiry).toISOString().split("T")[0]:"",status:I.status||"active",condition:I.condition||"good",notes:I.notes||""}),j(!0)},oe=async I=>{if(I.preventDefault(),!!_){W(!0);try{const Y={device_id:P.device_id,device_name:P.device_name,device_type:P.device_type,manufacturer:P.manufacturer,model:P.model,serial_number:P.serial_number,location:P.location,department:P.department,assigned_to:P.assigned_to,status:P.status,condition:P.condition,notes:P.notes};P.purchase_date&&(Y.purchase_date=P.purchase_date),P.warranty_expiry&&(Y.warranty_expiry=P.warranty_expiry);const{error:H}=await Ne.from("inventory_devices").update(Y).eq("id",_.id);if(H)throw H;await ce(),j(!1),k(null)}catch(Y){console.error("Error updating device:",Y),alert("Napaka pri posodabljanju naprave")}finally{W(!1)}}},xe=I=>{k(I),v(!0)},J=async()=>{if(_){B(!0);try{const{error:I}=await Ne.from("inventory_devices").delete().eq("id",_.id);if(I)throw I;await ce(),v(!1),k(null)}catch(I){console.error("Error deleting device:",I),alert("Napaka pri brisanju naprave")}finally{B(!1)}}},$=()=>{const I=["Device ID","Device Name","Type","Manufacturer","Model","Serial Number","Location","Department","Assigned To","Status","Condition","Created At"],Y=a.map(K=>[K.device_id,K.device_name,K.device_type||"-",K.manufacturer||"-",K.model||"-",K.serial_number||"-",K.location||"-",K.department||"-",K.assigned_to||"-",K.status,K.condition||"-",new Date(K.created_at).toLocaleString("sl-SI")]),H=[I,...Y].map(K=>K.join(";")).join(`
`),he=new Blob(["\uFEFF"+H],{type:"text/csv;charset=utf-8;"}),ge=document.createElement("a");ge.href=URL.createObjectURL(he),ge.download=`Inventory_Devices_${new Date().toISOString().split("T")[0]}.csv`,ge.click(),URL.revokeObjectURL(ge.href)},Q=I=>{const Y={active:"bg-green-500/20 text-green-400 border-green-500/30",inactive:"bg-gray-500/20 text-gray-400 border-gray-500/30",maintenance:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",retired:"bg-red-500/20 text-red-400 border-red-500/30"};return Y[I]||Y.inactive},q=I=>{const Y={excellent:"bg-green-500/20 text-green-400 border-green-500/30",good:"bg-blue-500/20 text-blue-400 border-blue-500/30",fair:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",poor:"bg-red-500/20 text-red-400 border-red-500/30"};return Y[I]||Y.good};return i?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-accent-primary/10 flex items-center justify-center",children:e.jsx(sc,{className:"w-5 h-5 text-accent-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:s("modules.inventoryDevices.title")}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Upravljanje strojne opreme"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:$,disabled:a.length===0,className:"h-10 px-4 bg-green-600 hover:bg-green-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Ir,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:s("workspaces.exportCSV")})]}),e.jsxs("button",{onClick:()=>d(!0),className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Dt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:s("modules.inventoryDevices.addDevice")})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex gap-2",children:["all","active","inactive","maintenance","retired"].map(I=>e.jsx("button",{onClick:()=>S(I),className:`px-4 py-2 rounded-sm text-body-sm font-medium transition-colors duration-150
                ${A===I?"bg-accent-primary text-white":"bg-bg-surface text-text-secondary hover:bg-bg-surface-hover border border-border-subtle"}`,children:s(`modules.inventoryDevices.statusFilters.${I}`)},I))}),e.jsx("input",{type:"text",placeholder:s("modules.inventoryDevices.search"),value:C,onChange:I=>O(I.target.value),className:"flex-1 px-4 py-2 bg-bg-surface border border-border-subtle rounded-sm text-text-primary placeholder-text-tertiary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{className:"bg-bg-surface rounded-sm border border-border-subtle overflow-hidden",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-pure-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("modules.inventoryDevices.table.deviceId")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Naprava"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Tip"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Proizvajalec"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Serijska t."}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Lokacija"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Status"}),e.jsx("th",{className:"text-center px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Akcije"})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:a.map(I=>e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 text-body text-text-primary font-mono",children:I.device_id}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-body text-text-primary font-medium",children:I.device_name}),e.jsx("div",{className:"text-caption text-text-tertiary",children:I.model||"-"})]}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:I.device_type}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:I.manufacturer||"-"}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary font-mono",children:I.serial_number||"-"}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:I.location||"-"}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium border ${Q(I.status)}`,children:I.status})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("button",{onClick:()=>re(I),className:"p-2 rounded-lg bg-blue-600/20 hover:bg-blue-600/30 text-blue-400 transition-colors",title:"Podrobnosti naprave",children:e.jsx(lr,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>U(I),className:"p-2 rounded-lg bg-yellow-600/20 hover:bg-yellow-600/30 text-yellow-400 transition-colors",title:"Uredi napravo",children:e.jsx(ar,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>xe(I),className:"p-2 rounded-lg bg-red-600/20 hover:bg-red-600/30 text-red-400 transition-colors",title:"Izbrii napravo",children:e.jsx(pr,{className:"w-4 h-4"})})]})})]},I.id))})]}),a.length===0&&e.jsx("div",{className:"text-center py-12 text-text-secondary",children:A==="all"&&!C?"Ni najdenih naprav. Dodajte novo napravo ali preverite povezavo z bazo podatkov.":"Ni najdenih naprav, ki ustrezajo izbranim filtrom."})]}),e.jsx(uD,{isOpen:c,onClose:()=>d(!1),onSave:ce}),h&&_&&e.jsx(zs,{isOpen:h,onClose:()=>j(!1),title:"Uredi napravo",children:e.jsxs("form",{onSubmit:oe,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"device_id",className:"block text-sm font-medium text-text-secondary mb-2",children:[s("modals.add.common.deviceId")," ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"text",id:"device_id",value:P.device_id,onChange:I=>L(Y=>({...Y,device_id:I.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"device_name",className:"block text-sm font-medium text-text-secondary mb-2",children:[s("modals.add.common.deviceName")," ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"text",id:"device_name",value:P.device_name,onChange:I=>L(Y=>({...Y,device_name:I.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"device_type",className:"block text-sm font-medium text-text-secondary mb-2",children:[s("modals.add.common.deviceType")," ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsxs("select",{id:"device_type",value:P.device_type,onChange:I=>L(Y=>({...Y,device_type:I.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"server",children:s("modules.inventoryDevices.deviceTypeOptions.server")}),e.jsx("option",{value:"laptop",children:s("modules.inventoryDevices.deviceTypeOptions.laptop")}),e.jsx("option",{value:"desktop",children:s("modules.inventoryDevices.deviceTypeOptions.desktop")}),e.jsx("option",{value:"mobile",children:s("modules.inventoryDevices.deviceTypeOptions.mobile")}),e.jsx("option",{value:"tablet",children:s("modules.inventoryDevices.deviceTypeOptions.tablet")}),e.jsx("option",{value:"network_device",children:s("modules.inventoryDevices.deviceTypeOptions.network_device")}),e.jsx("option",{value:"printer",children:s("modules.inventoryDevices.deviceTypeOptions.printer")}),e.jsx("option",{value:"storage",children:s("modules.inventoryDevices.deviceTypeOptions.storage")})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"manufacturer",className:"block text-sm font-medium text-text-secondary mb-2",children:s("modals.add.common.manufacturer")}),e.jsx("input",{type:"text",id:"manufacturer",value:P.manufacturer,onChange:I=>L(Y=>({...Y,manufacturer:I.target.value})),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"model",className:"block text-sm font-medium text-text-secondary mb-2",children:s("modals.add.common.model")}),e.jsx("input",{type:"text",id:"model",value:P.model,onChange:I=>L(Y=>({...Y,model:I.target.value})),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"serial_number",className:"block text-sm font-medium text-text-secondary mb-2",children:s("modals.add.common.serialNumber")}),e.jsx("input",{type:"text",id:"serial_number",value:P.serial_number,onChange:I=>L(Y=>({...Y,serial_number:I.target.value})),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"location",className:"block text-sm font-medium text-text-secondary mb-2",children:s("modals.add.common.location")}),e.jsx("input",{type:"text",id:"location",value:P.location,onChange:I=>L(Y=>({...Y,location:I.target.value})),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"department",className:"block text-sm font-medium text-text-secondary mb-2",children:s("modals.add.common.department")}),e.jsx("input",{type:"text",id:"department",value:P.department,onChange:I=>L(Y=>({...Y,department:I.target.value})),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"assigned_to",className:"block text-sm font-medium text-text-secondary mb-2",children:s("modals.add.common.assignedTo")}),e.jsx("input",{type:"text",id:"assigned_to",value:P.assigned_to,onChange:I=>L(Y=>({...Y,assigned_to:I.target.value})),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"purchase_date",className:"block text-sm font-medium text-text-secondary mb-2",children:s("modals.add.common.purchaseDate")}),e.jsx("input",{type:"date",id:"purchase_date",value:P.purchase_date,onChange:I=>L(Y=>({...Y,purchase_date:I.target.value})),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"warranty_expiry",className:"block text-sm font-medium text-text-secondary mb-2",children:s("modals.add.common.warrantyExpiry")}),e.jsx("input",{type:"date",id:"warranty_expiry",value:P.warranty_expiry,onChange:I=>L(Y=>({...Y,warranty_expiry:I.target.value})),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"status",className:"block text-sm font-medium text-text-secondary mb-2",children:[s("modals.add.common.status")," ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsxs("select",{id:"status",value:P.status,onChange:I=>L(Y=>({...Y,status:I.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"active",children:"Aktiven"}),e.jsx("option",{value:"inactive",children:"Neaktiven"}),e.jsx("option",{value:"maintenance",children:"V vzdrevanju"}),e.jsx("option",{value:"retired",children:"Upokojeni"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"condition",className:"block text-sm font-medium text-text-secondary mb-2",children:s("modals.add.common.condition")}),e.jsxs("select",{id:"condition",value:P.condition,onChange:I=>L(Y=>({...Y,condition:I.target.value})),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"excellent",children:s("modals.add.condition.excellent")}),e.jsx("option",{value:"good",children:s("modals.add.condition.good")}),e.jsx("option",{value:"fair",children:s("modals.add.condition.fair")}),e.jsx("option",{value:"poor",children:s("modals.add.condition.poor")})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-text-secondary mb-2",children:s("modals.add.common.notes")}),e.jsx("textarea",{id:"notes",value:P.notes,onChange:I=>L(Y=>({...Y,notes:I.target.value})),rows:3,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary resize-none"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-border-subtle",children:[e.jsx("button",{type:"button",onClick:()=>j(!1),className:"px-6 py-2 bg-bg-near-black text-text-primary border border-border-subtle rounded hover:bg-bg-surface transition-colors duration-150",children:"Preklii"}),e.jsx("button",{type:"submit",disabled:F,className:"px-6 py-2 bg-accent-primary hover:bg-accent-primary-hover text-white rounded transition-colors duration-150 disabled:opacity-50",children:s(F?"forms.saving":"forms.save")})]})]})}),e.jsx(gi,{isOpen:g,onClose:()=>v(!1),onConfirm:J,title:"Izbrii napravo",message:`Ali ste prepriani, da elite izbrisati napravo "${_==null?void 0:_.device_name}"? Te akcije ni mogoe razveljaviti.`,isDeleting:R}),x&&p&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm",onClick:I=>{I.target===I.currentTarget&&X()},children:e.jsxs("div",{className:"bg-gray-800 border border-gray-700/50 rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto shadow-2xl",children:[e.jsxs("div",{className:"sticky top-0 bg-gray-800 border-b border-gray-700/50 px-6 py-4 flex items-center justify-between z-10",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:p.device_name}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Podrobnosti naprave"})]}),e.jsx("button",{onClick:X,className:"p-2 rounded-lg hover:bg-gray-700/50 transition-colors",children:e.jsx(Ar,{className:"w-5 h-5 text-gray-400"})})]}),e.jsxs("div",{className:"px-6 py-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-medium border ${Q(p.status)}`,children:["Status: ",p.status]}),p.condition&&e.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-medium border ${q(p.condition)}`,children:["Stanje: ",p.condition]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Device ID"}),e.jsx("div",{className:"text-sm text-white font-mono",children:p.device_id})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Tip naprave"}),e.jsx("div",{className:"text-sm text-white",children:p.device_type})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Proizvajalec"}),e.jsx("div",{className:"text-sm text-white",children:p.manufacturer||"-"})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Model"}),e.jsx("div",{className:"text-sm text-white",children:p.model||"-"})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Serijska t."}),e.jsx("div",{className:"text-sm text-white font-mono break-all",children:p.serial_number||"-"})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Lokacija"}),e.jsx("div",{className:"text-sm text-white",children:p.location||"-"})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Oddelek"}),e.jsx("div",{className:"text-sm text-white",children:p.department||"-"})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Dodeljeno"}),e.jsx("div",{className:"text-sm text-white",children:p.assigned_to||"-"})]}),p.purchase_date&&e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Datum nakupa"}),e.jsx("div",{className:"text-sm text-white",children:new Date(p.purchase_date).toLocaleDateString("sl-SI")})]}),p.warranty_expiry&&e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Garancija do"}),e.jsx("div",{className:"text-sm text-white",children:new Date(p.warranty_expiry).toLocaleDateString("sl-SI")})]}),e.jsxs("div",{className:"md:col-span-2 bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Opombe"}),e.jsx("div",{className:"text-sm text-white whitespace-pre-wrap",children:p.notes||"-"})]})]}),e.jsx("div",{className:"flex justify-end gap-2 pt-4",children:e.jsx("button",{onClick:X,className:"px-4 py-2 bg-bg-near-black text-text-primary border border-border-subtle rounded hover:bg-bg-surface transition-colors duration-150",children:"Zapri"})})]})]})})]})}const mD=({isOpen:s,onClose:t,onSave:r})=>{const{t:a}=et(),n=[{key:"software_id",label:a("modals.add.common.softwareId"),type:"text",required:!0},{key:"software_name",label:a("modals.add.common.softwareName"),type:"text",required:!0},{key:"vendor",label:a("modals.add.common.vendor"),type:"text"},{key:"version",label:a("modals.add.common.version"),type:"text"},{key:"license_type",label:a("modals.add.common.licenseType"),type:"select",required:!0,options:["perpetual","subscription","trial","open_source","freeware"]},{key:"category",label:a("modals.add.common.category"),type:"text"},{key:"total_licenses",label:a("modals.add.common.totalLicenses"),type:"number",required:!0},{key:"licenses_in_use",label:a("modals.add.common.licensesInUse"),type:"number",required:!0},{key:"cost_per_license",label:a("modals.add.common.costPerLicense"),type:"number"},{key:"purchase_date",label:a("modals.add.common.purchaseDate"),type:"date"},{key:"renewal_date",label:a("modals.add.common.renewalDate"),type:"date"},{key:"support_expiry",label:a("modals.add.common.supportExpiry"),type:"date"},{key:"notes",label:a("modals.add.common.notes"),type:"textarea"}];return e.jsx(ha,{isOpen:s,onClose:t,onSave:r,title:a("modals.add.inventorySoftware.title"),table:"inventory_software",fields:n})};function hD(){const{t:s}=et(),[t,r]=z.useState([]),[a,n]=z.useState([]),[i,o]=z.useState(!0),[c,d]=z.useState(!1),[p,m]=z.useState(null),[x,b]=z.useState(!1),[h,j]=z.useState(!1),[g,v]=z.useState(!1),[_,k]=z.useState(null),[P,L]=z.useState({software_id:"",software_name:"",vendor:"",version:"",license_type:"subscription",category:"",total_licenses:0,licenses_in_use:0,cost_per_license:0,purchase_date:"",renewal_date:"",support_expiry:"",notes:""}),[F,W]=z.useState(!1),[R,B]=z.useState(!1),[A,S]=z.useState("all"),[C,O]=z.useState("all"),[Z,te]=z.useState(""),ce=async()=>{try{const{data:K,error:T}=await Ne.from("inventory_software").select("*").order("created_at",{ascending:!1});if(T)throw T;r(K||[])}catch(K){console.error("Error:",K)}finally{o(!1)}},re=z.useCallback(()=>{let K=[...t];if(A!=="all"&&(K=K.filter(T=>T.license_type===A)),C!=="all"&&(K=K.filter(T=>T.category===C)),Z.trim()){const T=Z.toLowerCase();K=K.filter(ee=>{var _e,ke,ue,je;return((_e=ee.software_name)==null?void 0:_e.toLowerCase().includes(T))||((ke=ee.vendor)==null?void 0:ke.toLowerCase().includes(T))||((ue=ee.software_id)==null?void 0:ue.toLowerCase().includes(T))||((je=ee.category)==null?void 0:je.toLowerCase().includes(T))})}n(K)},[t,A,C,Z]);z.useEffect(()=>{ce()},[]),z.useEffect(()=>{re()},[t,A,C,Z,re]);const X=()=>{const K=new Set(t.map(T=>T.category).filter(Boolean));return Array.from(K).sort()},U=async()=>{await ce()},oe=K=>{m(K),b(!0)},xe=()=>{b(!1),m(null)},J=K=>{k(K),L({software_id:K.software_id||"",software_name:K.software_name||"",vendor:K.vendor||"",version:K.version||"",license_type:K.license_type||"subscription",category:K.category||"",total_licenses:K.total_licenses||0,licenses_in_use:K.licenses_in_use||0,cost_per_license:K.cost_per_license||0,purchase_date:K.purchase_date?new Date(K.purchase_date).toISOString().split("T")[0]:"",renewal_date:K.renewal_date?new Date(K.renewal_date).toISOString().split("T")[0]:"",support_expiry:K.support_expiry?new Date(K.support_expiry).toISOString().split("T")[0]:"",notes:K.notes||""}),j(!0)},$=async K=>{if(K.preventDefault(),!!_){W(!0);try{const T={software_id:P.software_id,software_name:P.software_name,vendor:P.vendor,version:P.version,license_type:P.license_type,category:P.category,total_licenses:P.total_licenses,licenses_in_use:P.licenses_in_use,cost_per_license:P.cost_per_license,notes:P.notes};P.purchase_date&&(T.purchase_date=P.purchase_date),P.renewal_date&&(T.renewal_date=P.renewal_date),P.support_expiry&&(T.support_expiry=P.support_expiry);const{error:ee}=await Ne.from("inventory_software").update(T).eq("id",_.id);if(ee)throw ee;await U(),j(!1),k(null)}catch(T){console.error("Error updating software:",T),alert("Napaka pri posodabljanju programske opreme")}finally{W(!1)}}},Q=K=>{k(K),v(!0)},q=async()=>{if(_){B(!0);try{const{error:K}=await Ne.from("inventory_software").delete().eq("id",_.id);if(K)throw K;await U(),v(!1),k(null)}catch(K){console.error("Error deleting software:",K),alert("Napaka pri brisanju programske opreme")}finally{B(!1)}}},I=()=>{const K=["Software ID","Software Name","Vendor","Version","License Type","Category","Total Licenses","In Use","Cost Per License","Purchase Date","Renewal Date","Support Expiry","Notes","Created At"],T=a.map(ue=>[ue.software_id,ue.software_name,ue.vendor||"-",ue.version||"-",ue.license_type,ue.category||"-",ue.total_licenses||0,ue.licenses_in_use||0,ue.cost_per_license?`${ue.cost_per_license.toFixed(2)}`:"-",ue.purchase_date?new Date(ue.purchase_date).toLocaleDateString("sl-SI"):"-",ue.renewal_date?new Date(ue.renewal_date).toLocaleDateString("sl-SI"):"-",ue.support_expiry?new Date(ue.support_expiry).toLocaleDateString("sl-SI"):"-",ue.notes||"-",new Date(ue.created_at).toLocaleString("sl-SI")]),ee=[K,...T].map(ue=>ue.join(";")).join(`
`),_e=new Blob(["\uFEFF"+ee],{type:"text/csv;charset=utf-8;"}),ke=document.createElement("a");ke.href=URL.createObjectURL(_e),ke.download=`Inventory_Software_${new Date().toISOString().split("T")[0]}.csv`,ke.click(),URL.revokeObjectURL(ke.href)},Y=K=>{const T={perpetual:"bg-blue-500/20 text-blue-400 border-blue-500/30",subscription:"bg-green-500/20 text-green-400 border-green-500/30",trial:"bg-orange-500/20 text-orange-400 border-orange-500/30",open_source:"bg-purple-500/20 text-purple-400 border-purple-500/30",freeware:"bg-gray-500/20 text-gray-400 border-gray-500/30"};return T[K]||T.subscription},H=K=>"bg-cyan-500/20 text-cyan-400 border-cyan-500/30",he=(K,T)=>!T||T===0?0:Math.round(K/T*100),ge=K=>{if(!K)return!1;const T=new Date(K),ee=new Date,_e=Math.floor((T.getTime()-ee.getTime())/(1e3*60*60*24));return _e<=30&&_e>=0};return i?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-accent-primary/10 flex items-center justify-center",children:e.jsx(sd,{className:"w-5 h-5 text-accent-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:s("modules.inventorySoftware.title")}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Upravljanje licenc in programov"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:I,disabled:a.length===0,className:"h-10 px-4 bg-green-600 hover:bg-green-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Ir,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:"Izvozi CSV"})]}),e.jsxs("button",{onClick:()=>d(!0),className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Dt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:s("modules.inventorySoftware.addSoftware")})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("span",{className:"text-body-sm text-text-secondary self-center mr-2",children:"Tip licence:"}),["all","perpetual","subscription","trial","open_source","freeware"].map(K=>e.jsx("button",{onClick:()=>S(K),className:`px-4 py-2 rounded-sm text-body-sm font-medium transition-colors duration-150
                ${A===K?"bg-accent-primary text-white":"bg-bg-surface text-text-secondary hover:bg-bg-surface-hover border border-border-subtle"}`,children:s(K==="all"?"modules.inventoryLicenses.filters.all":`modules.inventorySoftware.licenseTypeOptions.${K}`)},K))]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("select",{value:C,onChange:K=>O(K.target.value),className:"px-4 py-2 bg-bg-surface border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"all",children:"Vse kategorije"}),X().map(K=>e.jsx("option",{value:K,children:K},K))]}),e.jsx("input",{type:"text",placeholder:s("modules.inventorySoftware.search"),value:Z,onChange:K=>te(K.target.value),className:"flex-1 px-4 py-2 bg-bg-surface border border-border-subtle rounded-sm text-text-primary placeholder-text-tertiary focus:outline-none focus:border-accent-primary"})]})]}),e.jsxs("div",{className:"bg-bg-surface rounded-sm border border-border-subtle overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-pure-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Software ID"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Naziv"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Proizvajalec"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Verzija"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Tip licence"}),e.jsx("th",{className:"text-right px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Skupaj"}),e.jsx("th",{className:"text-right px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"V uporabi"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Uporaba"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Podaljanje"}),e.jsx("th",{className:"text-center px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Akcije"})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:a.map(K=>{const T=he(K.licenses_in_use,K.total_licenses),ee=ge(K.renewal_date);return e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 text-body text-text-primary font-mono",children:K.software_id}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-body text-text-primary font-bold",children:K.software_name}),K.category&&e.jsx("span",{className:`inline-block mt-1 px-2 py-0.5 rounded-full text-caption font-medium border ${H(K.category)}`,children:K.category})]}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:K.vendor||"-"}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:K.version||"-"}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium border ${Y(K.license_type)}`,children:K.license_type})}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary text-right",children:K.total_licenses||0}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary text-right",children:K.licenses_in_use||0}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 bg-gray-700 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:`h-full transition-all duration-300 ${T>=90?"bg-red-500":"bg-blue-500"}`,style:{width:`${Math.min(T,100)}%`}})}),e.jsxs("span",{className:`text-caption font-medium ${T>=90?"text-red-400":"text-blue-400"}`,children:[T,"%"]})]})}),e.jsx("td",{className:"px-6 py-4",children:K.renewal_date?e.jsxs("div",{className:"flex items-center gap-2",children:[ee&&e.jsx(pt,{className:"w-4 h-4 text-yellow-400"}),e.jsx("span",{className:`text-body ${ee?"text-yellow-400 font-medium":"text-text-secondary"}`,children:new Date(K.renewal_date).toLocaleDateString("sl-SI")})]}):e.jsx("span",{className:"text-body text-text-tertiary",children:"-"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("button",{onClick:()=>oe(K),className:"p-2 rounded-lg bg-blue-600/20 hover:bg-blue-600/30 text-blue-400 transition-colors",title:"Podrobnosti programske opreme",children:e.jsx(lr,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>J(K),className:"p-2 rounded-lg bg-yellow-600/20 hover:bg-yellow-600/30 text-yellow-400 transition-colors",title:"Uredi programsko opremo",children:e.jsx(ar,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Q(K),className:"p-2 rounded-lg bg-red-600/20 hover:bg-red-600/30 text-red-400 transition-colors",title:"Izbrii programsko opremo",children:e.jsx(pr,{className:"w-4 h-4"})})]})})]},K.id)})})]})}),a.length===0&&e.jsx("div",{className:"text-center py-12 text-text-secondary",children:"Ni najdene programske opreme"})]}),e.jsx(mD,{isOpen:c,onClose:()=>d(!1),onSave:U}),h&&_&&e.jsx(zs,{isOpen:h,onClose:()=>j(!1),title:"Uredi programsko opremo",children:e.jsxs("form",{onSubmit:$,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"software_id",className:"block text-sm font-medium text-text-secondary mb-2",children:["ID programske opreme ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"text",id:"software_id",value:P.software_id,onChange:K=>L(T=>({...T,software_id:K.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"software_name",className:"block text-sm font-medium text-text-secondary mb-2",children:["Naziv ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"text",id:"software_name",value:P.software_name,onChange:K=>L(T=>({...T,software_name:K.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"vendor",className:"block text-sm font-medium text-text-secondary mb-2",children:"Proizvajalec"}),e.jsx("input",{type:"text",id:"vendor",value:P.vendor,onChange:K=>L(T=>({...T,vendor:K.target.value})),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"version",className:"block text-sm font-medium text-text-secondary mb-2",children:"Verzija"}),e.jsx("input",{type:"text",id:"version",value:P.version,onChange:K=>L(T=>({...T,version:K.target.value})),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"license_type",className:"block text-sm font-medium text-text-secondary mb-2",children:["Tip licence ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsxs("select",{id:"license_type",value:P.license_type,onChange:K=>L(T=>({...T,license_type:K.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"perpetual",children:s("modules.inventorySoftware.licenseTypeOptions.perpetual")}),e.jsx("option",{value:"subscription",children:s("modules.inventorySoftware.licenseTypeOptions.subscription")}),e.jsx("option",{value:"trial",children:s("modules.inventorySoftware.licenseTypeOptions.trial")}),e.jsx("option",{value:"open_source",children:s("modules.inventorySoftware.licenseTypeOptions.open_source")}),e.jsx("option",{value:"freeware",children:s("modules.inventorySoftware.licenseTypeOptions.freeware")})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-text-secondary mb-2",children:"Kategorija"}),e.jsx("input",{type:"text",id:"category",value:P.category,onChange:K=>L(T=>({...T,category:K.target.value})),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"total_licenses",className:"block text-sm font-medium text-text-secondary mb-2",children:["Skupaj licenc ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"number",id:"total_licenses",value:P.total_licenses,onChange:K=>L(T=>({...T,total_licenses:parseInt(K.target.value)||0})),required:!0,min:"0",className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"licenses_in_use",className:"block text-sm font-medium text-text-secondary mb-2",children:["V uporabi ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"number",id:"licenses_in_use",value:P.licenses_in_use,onChange:K=>L(T=>({...T,licenses_in_use:parseInt(K.target.value)||0})),required:!0,min:"0",className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cost_per_license",className:"block text-sm font-medium text-text-secondary mb-2",children:"Cena na licenco ()"}),e.jsx("input",{type:"number",id:"cost_per_license",value:P.cost_per_license,onChange:K=>L(T=>({...T,cost_per_license:parseFloat(K.target.value)||0})),min:"0",step:"0.01",className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"purchase_date",className:"block text-sm font-medium text-text-secondary mb-2",children:"Datum nakupa"}),e.jsx("input",{type:"date",id:"purchase_date",value:P.purchase_date,onChange:K=>L(T=>({...T,purchase_date:K.target.value})),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"renewal_date",className:"block text-sm font-medium text-text-secondary mb-2",children:"Datum podaljanja"}),e.jsx("input",{type:"date",id:"renewal_date",value:P.renewal_date,onChange:K=>L(T=>({...T,renewal_date:K.target.value})),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"support_expiry",className:"block text-sm font-medium text-text-secondary mb-2",children:"Podpora do"}),e.jsx("input",{type:"date",id:"support_expiry",value:P.support_expiry,onChange:K=>L(T=>({...T,support_expiry:K.target.value})),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-text-secondary mb-2",children:"Opombe"}),e.jsx("textarea",{id:"notes",value:P.notes,onChange:K=>L(T=>({...T,notes:K.target.value})),rows:3,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary resize-none"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-border-subtle",children:[e.jsx("button",{type:"button",onClick:()=>j(!1),className:"px-6 py-2 bg-bg-near-black text-text-primary border border-border-subtle rounded hover:bg-bg-surface transition-colors duration-150",children:"Preklii"}),e.jsx("button",{type:"submit",disabled:F,className:"px-6 py-2 bg-accent-primary hover:bg-accent-primary-hover text-white rounded transition-colors duration-150 disabled:opacity-50",children:s(F?"forms.saving":"forms.save")})]})]})}),e.jsx(gi,{isOpen:g,onClose:()=>v(!1),onConfirm:q,title:"Izbrii programsko opremo",message:`Ali ste prepriani, da elite izbrisati programsko opremo "${_==null?void 0:_.software_name}"? Te akcije ni mogoe razveljaviti.`,isDeleting:R}),x&&p&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm",onClick:K=>{K.target===K.currentTarget&&xe()},children:e.jsxs("div",{className:"bg-gray-800 border border-gray-700/50 rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto shadow-2xl",children:[e.jsxs("div",{className:"sticky top-0 bg-gray-800 border-b border-gray-700/50 px-6 py-4 flex items-center justify-between z-10",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:p.software_name}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Podrobnosti programske opreme"})]}),e.jsx("button",{onClick:xe,className:"p-2 rounded-lg hover:bg-gray-700/50 transition-colors",children:e.jsx(Ar,{className:"w-5 h-5 text-gray-400"})})]}),e.jsxs("div",{className:"px-6 py-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium border ${Y(p.license_type)}`,children:p.license_type}),p.category&&e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium border ${H(p.category)}`,children:p.category}),ge(p.renewal_date)&&e.jsxs("span",{className:"px-3 py-1 rounded-full text-xs font-medium border bg-yellow-500/20 text-yellow-400 border-yellow-500/30 flex items-center gap-1",children:[e.jsx(pt,{className:"w-3 h-3"}),"Podaljanje kmalu"]})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-3",children:"Uporaba licenc"}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between text-sm text-white mb-2",children:[e.jsxs("span",{children:[p.licenses_in_use||0," / ",p.total_licenses||0]}),e.jsxs("span",{className:"font-medium",children:[he(p.licenses_in_use,p.total_licenses),"%"]})]}),e.jsx("div",{className:"bg-gray-700 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:`h-full transition-all duration-300 ${he(p.licenses_in_use,p.total_licenses)>=90?"bg-red-500":"bg-blue-500"}`,style:{width:`${Math.min(he(p.licenses_in_use,p.total_licenses),100)}%`}})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Software ID"}),e.jsx("div",{className:"text-sm text-white font-mono",children:p.software_id})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Proizvajalec"}),e.jsx("div",{className:"text-sm text-white",children:p.vendor||"-"})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Verzija"}),e.jsx("div",{className:"text-sm text-white",children:p.version||"-"})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Cena na licenco"}),e.jsx("div",{className:"text-sm text-white font-medium",children:p.cost_per_license?`${p.cost_per_license.toFixed(2)}`:"-"})]}),p.purchase_date&&e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Datum nakupa"}),e.jsx("div",{className:"text-sm text-white",children:new Date(p.purchase_date).toLocaleDateString("sl-SI")})]}),p.renewal_date&&e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Datum podaljanja"}),e.jsx("div",{className:`text-sm font-medium ${ge(p.renewal_date)?"text-yellow-400":"text-white"}`,children:new Date(p.renewal_date).toLocaleDateString("sl-SI")})]}),p.support_expiry&&e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Podpora do"}),e.jsx("div",{className:"text-sm text-white",children:new Date(p.support_expiry).toLocaleDateString("sl-SI")})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Skupni stroki"}),e.jsx("div",{className:"text-sm text-white font-bold",children:p.cost_per_license&&p.total_licenses?`${(p.cost_per_license*p.total_licenses).toFixed(2)}`:"-"})]})]}),p.notes&&e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Opombe"}),e.jsx("div",{className:"text-sm text-white whitespace-pre-wrap",children:p.notes})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-3",children:"Metapodatki"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"UUID"}),e.jsx("div",{className:"text-sm text-white font-mono break-all",children:p.id})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Ustvarjeno"}),e.jsx("div",{className:"text-sm text-white",children:new Date(p.created_at).toLocaleString("sl-SI")})]}),p.updated_at&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Posodobljeno"}),e.jsx("div",{className:"text-sm text-white",children:new Date(p.updated_at).toLocaleString("sl-SI")})]})]})]})]}),e.jsx("div",{className:"sticky bottom-0 bg-gray-800 border-t border-gray-700/50 px-6 py-4 flex justify-end",children:e.jsx("button",{onClick:xe,className:"px-6 py-2 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-lg transition-all duration-200",children:"Zapri"})})]})})]})}const xD=({isOpen:s,onClose:t,onSave:r})=>{const{t:a}=et(),n=[{key:"license_key",label:a("modals.add.common.licenseKey"),type:"text",required:!0},{key:"software_name",label:a("modals.add.common.softwareName"),type:"text",required:!0},{key:"license_type",label:a("modals.add.common.licenseType"),type:"select",required:!0,options:["perpetual","subscription","trial"]},{key:"seats",label:a("modals.add.common.seats"),type:"number",required:!0},{key:"seats_used",label:a("modals.add.common.seatsUsed"),type:"number",required:!0},{key:"assigned_to",label:a("modals.add.common.assignedTo"),type:"text"},{key:"purchase_date",label:a("modals.add.common.purchaseDate"),type:"date"},{key:"expiry_date",label:a("modals.add.common.expiryDate"),type:"date"},{key:"renewal_cost",label:a("modals.add.common.renewalCost"),type:"number"},{key:"status",label:a("modals.add.common.status"),type:"select",required:!0,options:["active","expired","suspended"]},{key:"notes",label:a("modals.add.common.notes"),type:"textarea"}];return e.jsx(ha,{isOpen:s,onClose:t,onSave:r,title:a("modals.add.inventoryLicense.title"),table:"inventory_licenses",fields:n})};function fD(){const{t:s}=et(),[t,r]=z.useState([]),[a,n]=z.useState([]),[i,o]=z.useState(!0),[c,d]=z.useState(!1),[p,m]=z.useState(null),[x,b]=z.useState(!1),[h,j]=z.useState(!1),[g,v]=z.useState(!1),[_,k]=z.useState(null),[P,L]=z.useState({license_key:"",software_name:"",license_type:"subscription",seats:0,seats_used:0,assigned_to:"",purchase_date:"",expiry_date:"",renewal_cost:0,status:"active",notes:""}),[F,W]=z.useState(!1),[R,B]=z.useState(!1),[A,S]=z.useState("all"),[C,O]=z.useState(""),[Z,te]=z.useState(null);z.useEffect(()=>{ce()},[]),z.useEffect(()=>{re()},[t,A,C]);const ce=async()=>{try{const{data:T,error:ee}=await Ne.from("inventory_licenses").select("*").order("created_at",{ascending:!1});if(ee)throw ee;r(T||[])}catch(T){console.error("Error:",T)}finally{o(!1)}},re=()=>{let T=[...t];const ee=new Date,_e=new Date(ee.getTime()+720*60*60*1e3);if(A==="active"?T=T.filter(ke=>ke.status==="active"):A==="expired"?T=T.filter(ke=>ke.status==="expired"||ke.expiry_date&&new Date(ke.expiry_date)<ee):A==="expiring_soon"&&(T=T.filter(ke=>ke.expiry_date&&new Date(ke.expiry_date)>=ee&&new Date(ke.expiry_date)<=_e)),C.trim()){const ke=C.toLowerCase();T=T.filter(ue=>{var je,ne,Re,Oe;return((je=ue.software_name)==null?void 0:je.toLowerCase().includes(ke))||((ne=ue.license_key)==null?void 0:ne.toLowerCase().includes(ke))||((Re=ue.assigned_to)==null?void 0:Re.toLowerCase().includes(ke))||((Oe=ue.license_type)==null?void 0:Oe.toLowerCase().includes(ke))})}n(T)},X=T=>T?T.length<=4?T:`${"*".repeat(T.length-4)}${T.slice(-4)}`:"-",U=async(T,ee)=>{try{await navigator.clipboard.writeText(T),te(ee),setTimeout(()=>te(null),2e3)}catch(_e){console.error("Failed to copy:",_e)}},oe=async()=>{await ce()},xe=T=>{m(T),b(!0)},J=()=>{b(!1),m(null)},$=T=>{k(T),L({license_key:T.license_key||"",software_name:T.software_name||"",license_type:T.license_type||"subscription",seats:T.seats||0,seats_used:T.seats_used||0,assigned_to:T.assigned_to||"",purchase_date:T.purchase_date?new Date(T.purchase_date).toISOString().split("T")[0]:"",expiry_date:T.expiry_date?new Date(T.expiry_date).toISOString().split("T")[0]:"",renewal_cost:T.renewal_cost||0,status:T.status||"active",notes:T.notes||""}),j(!0)},Q=async T=>{if(T.preventDefault(),!!_){W(!0);try{const ee={license_key:P.license_key,software_name:P.software_name,license_type:P.license_type,seats:P.seats,seats_used:P.seats_used,assigned_to:P.assigned_to,renewal_cost:P.renewal_cost,status:P.status,notes:P.notes};P.purchase_date&&(ee.purchase_date=P.purchase_date),P.expiry_date&&(ee.expiry_date=P.expiry_date);const{error:_e}=await Ne.from("inventory_licenses").update(ee).eq("id",_.id);if(_e)throw _e;await oe(),j(!1),k(null)}catch(ee){console.error("Error updating license:",ee),alert("Napaka pri posodabljanju licence")}finally{W(!1)}}},q=T=>{k(T),v(!0)},I=async()=>{if(_){B(!0);try{const{error:T}=await Ne.from("inventory_licenses").delete().eq("id",_.id);if(T)throw T;await oe(),v(!1),k(null)}catch(T){console.error("Error deleting license:",T),alert("Napaka pri brisanju licence")}finally{B(!1)}}},Y=()=>{const T=["License Key","Software Name","License Type","Seats","Seats Used","Assigned To","Purchase Date","Expiry Date","Renewal Cost","Status","Notes","Created At"],ee=a.map(je=>[je.license_key,je.software_name,je.license_type,je.seats||0,je.seats_used||0,je.assigned_to||"-",je.purchase_date?new Date(je.purchase_date).toLocaleDateString("sl-SI"):"-",je.expiry_date?new Date(je.expiry_date).toLocaleDateString("sl-SI"):"-",je.renewal_cost?`${je.renewal_cost.toFixed(2)}`:"-",je.status,je.notes||"-",new Date(je.created_at).toLocaleString("sl-SI")]),_e=[T,...ee].map(je=>je.join(";")).join(`
`),ke=new Blob(["\uFEFF"+_e],{type:"text/csv;charset=utf-8;"}),ue=document.createElement("a");ue.href=URL.createObjectURL(ke),ue.download=`Inventory_Licenses_${new Date().toISOString().split("T")[0]}.csv`,ue.click(),URL.revokeObjectURL(ue.href)},H=(T,ee)=>{if(ee&&new Date(ee)<new Date)return"bg-red-500/20 text-red-400 border-red-500/30";const _e={active:"bg-green-500/20 text-green-400 border-green-500/30",expired:"bg-red-500/20 text-red-400 border-red-500/30",suspended:"bg-gray-500/20 text-gray-400 border-gray-500/30"};return _e[T]||_e.active},he=T=>{const ee={perpetual:"bg-blue-500/20 text-blue-400 border-blue-500/30",subscription:"bg-green-500/20 text-green-400 border-green-500/30",trial:"bg-orange-500/20 text-orange-400 border-orange-500/30"};return ee[T]||ee.subscription},ge=(T,ee)=>!ee||ee===0?0:Math.round(T/ee*100),K=T=>{if(!T)return!1;const ee=new Date(T),_e=new Date,ke=Math.floor((ee.getTime()-_e.getTime())/(1e3*60*60*24));return ke<=30&&ke>=0};return i?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-accent-primary/10 flex items-center justify-center",children:e.jsx(ix,{className:"w-5 h-5 text-accent-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Licence"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Upravljanje licennih kljuev"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:Y,disabled:a.length===0,className:"h-10 px-4 bg-green-600 hover:bg-green-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Ir,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:"Izvozi CSV"})]}),e.jsxs("button",{onClick:()=>d(!0),className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Dt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:"Nova licenca"})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex gap-2",children:["all","active","expired","expiring_soon"].map(T=>e.jsx("button",{onClick:()=>S(T),className:`px-4 py-2 rounded-sm text-body-sm font-medium transition-colors duration-150
                ${A===T?"bg-accent-primary text-white":"bg-bg-surface text-text-secondary hover:bg-bg-surface-hover border border-border-subtle"}`,children:s(`modules.inventoryLicenses.filters.${T==="expiring_soon"?"expiringSoon":T}`)},T))}),e.jsx("input",{type:"text",placeholder:"Iskanje po programu, kljuu, dodeljeno...",value:C,onChange:T=>O(T.target.value),className:"flex-1 px-4 py-2 bg-bg-surface border border-border-subtle rounded-sm text-text-primary placeholder-text-tertiary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{className:"bg-bg-surface rounded-sm border border-border-subtle overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-pure-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Licenni klju"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Program"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Tip"}),e.jsx("th",{className:"text-right px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Sedei"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Uporaba"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Dodeljeno"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Potee"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Status"}),e.jsx("th",{className:"text-center px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Akcije"})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:a.map(T=>{const ee=ge(T.seats_used,T.seats),_e=K(T.expiry_date);return e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-body text-text-primary font-mono",children:X(T.license_key)}),e.jsx("button",{onClick:()=>U(T.license_key,T.id),className:"p-1 rounded hover:bg-gray-700/50 text-gray-400 hover:text-white transition-colors",title:"Kopiraj celoten klju",children:Z===T.id?e.jsx(Cb,{className:"w-3 h-3 text-green-400"}):e.jsx(Tp,{className:"w-3 h-3"})})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-body text-text-primary font-medium",children:T.software_name})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium border ${he(T.license_type)}`,children:T.license_type})}),e.jsxs("td",{className:"px-6 py-4 text-body text-text-secondary text-right",children:[T.seats_used||0," / ",T.seats||0]}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 bg-gray-700 rounded-full h-2 overflow-hidden w-24",children:e.jsx("div",{className:`h-full transition-all duration-300 ${ee>=90?"bg-red-500":"bg-blue-500"}`,style:{width:`${Math.min(ee,100)}%`}})}),e.jsxs("span",{className:`text-caption font-medium ${ee>=90?"text-red-400":"text-blue-400"}`,children:[ee,"%"]})]})}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:T.assigned_to||"-"}),e.jsx("td",{className:"px-6 py-4",children:T.expiry_date?e.jsxs("div",{className:"flex items-center gap-2",children:[_e&&e.jsx(pt,{className:"w-4 h-4 text-yellow-400"}),e.jsx("span",{className:`text-body ${_e?"text-yellow-400 font-medium":"text-text-secondary"}`,children:new Date(T.expiry_date).toLocaleDateString("sl-SI")})]}):e.jsx("span",{className:"text-body text-text-tertiary",children:"-"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium border ${H(T.status,T.expiry_date)}`,children:T.status})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("button",{onClick:()=>xe(T),className:"p-2 rounded-lg bg-blue-600/20 hover:bg-blue-600/30 text-blue-400 transition-colors",title:"Podrobnosti licence",children:e.jsx(lr,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>$(T),className:"p-2 rounded-lg bg-yellow-600/20 hover:bg-yellow-600/30 text-yellow-400 transition-colors",title:"Uredi licenco",children:e.jsx(ar,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>q(T),className:"p-2 rounded-lg bg-red-600/20 hover:bg-red-600/30 text-red-400 transition-colors",title:"Izbrii licenco",children:e.jsx(pr,{className:"w-4 h-4"})})]})})]},T.id)})})]})}),a.length===0&&e.jsx("div",{className:"text-center py-12 text-text-secondary",children:"Ni najdenih licenc"})]}),e.jsx(xD,{isOpen:c,onClose:()=>d(!1),onSave:oe}),h&&_&&e.jsx(zs,{isOpen:h,onClose:()=>j(!1),title:"Uredi licenco",children:e.jsxs("form",{onSubmit:Q,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{htmlFor:"license_key",className:"block text-sm font-medium text-text-secondary mb-2",children:["Licenni klju ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"text",id:"license_key",value:P.license_key,onChange:T=>L(ee=>({...ee,license_key:T.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary font-mono focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"software_name",className:"block text-sm font-medium text-text-secondary mb-2",children:["Naziv programa ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"text",id:"software_name",value:P.software_name,onChange:T=>L(ee=>({...ee,software_name:T.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"license_type",className:"block text-sm font-medium text-text-secondary mb-2",children:["Tip licence ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsxs("select",{id:"license_type",value:P.license_type,onChange:T=>L(ee=>({...ee,license_type:T.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"perpetual",children:"Perpetual"}),e.jsx("option",{value:"subscription",children:"Subscription"}),e.jsx("option",{value:"trial",children:"Trial"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"seats",className:"block text-sm font-medium text-text-secondary mb-2",children:["Sedei ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"number",id:"seats",value:P.seats,onChange:T=>L(ee=>({...ee,seats:parseInt(T.target.value)||0})),required:!0,min:"0",className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"seats_used",className:"block text-sm font-medium text-text-secondary mb-2",children:["Uporabljeni sedei ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"number",id:"seats_used",value:P.seats_used,onChange:T=>L(ee=>({...ee,seats_used:parseInt(T.target.value)||0})),required:!0,min:"0",className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"assigned_to",className:"block text-sm font-medium text-text-secondary mb-2",children:"Dodeljeno"}),e.jsx("input",{type:"text",id:"assigned_to",value:P.assigned_to,onChange:T=>L(ee=>({...ee,assigned_to:T.target.value})),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"purchase_date",className:"block text-sm font-medium text-text-secondary mb-2",children:"Datum nakupa"}),e.jsx("input",{type:"date",id:"purchase_date",value:P.purchase_date,onChange:T=>L(ee=>({...ee,purchase_date:T.target.value})),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"expiry_date",className:"block text-sm font-medium text-text-secondary mb-2",children:"Datum poteka"}),e.jsx("input",{type:"date",id:"expiry_date",value:P.expiry_date,onChange:T=>L(ee=>({...ee,expiry_date:T.target.value})),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"renewal_cost",className:"block text-sm font-medium text-text-secondary mb-2",children:"Stroek podaljanja ()"}),e.jsx("input",{type:"number",id:"renewal_cost",value:P.renewal_cost,onChange:T=>L(ee=>({...ee,renewal_cost:parseFloat(T.target.value)||0})),min:"0",step:"0.01",className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"status",className:"block text-sm font-medium text-text-secondary mb-2",children:["Status ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsxs("select",{id:"status",value:P.status,onChange:T=>L(ee=>({...ee,status:T.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"expired",children:"Expired"}),e.jsx("option",{value:"suspended",children:"Suspended"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-text-secondary mb-2",children:"Opombe"}),e.jsx("textarea",{id:"notes",value:P.notes,onChange:T=>L(ee=>({...ee,notes:T.target.value})),rows:3,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary resize-none"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-border-subtle",children:[e.jsx("button",{type:"button",onClick:()=>j(!1),className:"px-6 py-2 bg-bg-near-black text-text-primary border border-border-subtle rounded hover:bg-bg-surface transition-colors duration-150",children:"Preklii"}),e.jsx("button",{type:"submit",disabled:F,className:"px-6 py-2 bg-accent-primary hover:bg-accent-primary-hover text-white rounded transition-colors duration-150 disabled:opacity-50",children:F?"Shranjujem...":"Shrani"})]})]})}),e.jsx(gi,{isOpen:g,onClose:()=>v(!1),onConfirm:I,title:"Izbrii licenco",message:`Ali ste prepriani, da elite izbrisati licenco za "${_==null?void 0:_.software_name}"? Te akcije ni mogoe razveljaviti.`,isDeleting:R}),x&&p&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm",onClick:T=>{T.target===T.currentTarget&&J()},children:e.jsxs("div",{className:"bg-gray-800 border border-gray-700/50 rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto shadow-2xl",children:[e.jsxs("div",{className:"sticky top-0 bg-gray-800 border-b border-gray-700/50 px-6 py-4 flex items-center justify-between z-10",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:p.software_name}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Podrobnosti licence"})]}),e.jsx("button",{onClick:J,className:"p-2 rounded-lg hover:bg-gray-700/50 transition-colors",children:e.jsx(Ar,{className:"w-5 h-5 text-gray-400"})})]}),e.jsxs("div",{className:"px-6 py-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium border ${he(p.license_type)}`,children:p.license_type}),e.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-medium border ${H(p.status,p.expiry_date)}`,children:["Status: ",p.status]}),K(p.expiry_date)&&e.jsxs("span",{className:"px-3 py-1 rounded-full text-xs font-medium border bg-yellow-500/20 text-yellow-400 border-yellow-500/30 flex items-center gap-1",children:[e.jsx(pt,{className:"w-3 h-3"}),"Potee kmalu"]})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Licenni klju"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("code",{className:"flex-1 text-sm text-white font-mono bg-gray-900/50 px-3 py-2 rounded border border-gray-600/30",children:p.license_key}),e.jsx("button",{onClick:()=>U(p.license_key,`detail-${p.id}`),className:"px-3 py-2 bg-blue-600/20 hover:bg-blue-600/30 text-blue-400 rounded transition-colors flex items-center gap-2",children:Z===`detail-${p.id}`?e.jsxs(e.Fragment,{children:[e.jsx(Cb,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Kopirano"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Tp,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Kopiraj"})]})})]})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-3",children:"Uporaba sedeev"}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between text-sm text-white mb-2",children:[e.jsxs("span",{children:[p.seats_used||0," / ",p.seats||0]}),e.jsxs("span",{className:"font-medium",children:[ge(p.seats_used,p.seats),"%"]})]}),e.jsx("div",{className:"bg-gray-700 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:`h-full transition-all duration-300 ${ge(p.seats_used,p.seats)>=90?"bg-red-500":"bg-blue-500"}`,style:{width:`${Math.min(ge(p.seats_used,p.seats),100)}%`}})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Dodeljeno"}),e.jsx("div",{className:"text-sm text-white",children:p.assigned_to||"-"})]}),p.purchase_date&&e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Datum nakupa"}),e.jsx("div",{className:"text-sm text-white",children:new Date(p.purchase_date).toLocaleDateString("sl-SI")})]}),p.expiry_date&&e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Datum poteka"}),e.jsx("div",{className:`text-sm font-medium ${K(p.expiry_date)?"text-yellow-400":"text-white"}`,children:new Date(p.expiry_date).toLocaleDateString("sl-SI")})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Stroek podaljanja"}),e.jsx("div",{className:"text-sm text-white font-medium",children:p.renewal_cost?`${p.renewal_cost.toFixed(2)}`:"-"})]})]}),p.notes&&e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Opombe"}),e.jsx("div",{className:"text-sm text-white whitespace-pre-wrap",children:p.notes})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-3",children:"Metapodatki"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"UUID"}),e.jsx("div",{className:"text-sm text-white font-mono break-all",children:p.id})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Ustvarjeno"}),e.jsx("div",{className:"text-sm text-white",children:new Date(p.created_at).toLocaleString("sl-SI")})]}),p.updated_at&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Posodobljeno"}),e.jsx("div",{className:"text-sm text-white",children:new Date(p.updated_at).toLocaleString("sl-SI")})]})]})]})]}),e.jsx("div",{className:"sticky bottom-0 bg-gray-800 border-t border-gray-700/50 px-6 py-4 flex justify-end",children:e.jsx("button",{onClick:J,className:"px-6 py-2 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-lg transition-all duration-200",children:"Zapri"})})]})})]})}function bD({isOpen:s,onClose:t,onSave:r}){const{t:a}=et(),{user:n}=cr(),[i,o]=z.useState(!1),[c,d]=z.useState(!1),[p,m]=z.useState(null);z.useEffect(()=>{(async()=>{if(ma.isInitialized){d(!0);return}const _=()=>{ma.isInitialized?d(!0):setTimeout(_,50)};_()})()},[]),z.useEffect(()=>{(async()=>{if(n)try{const{data:_,error:k}=await Ne.from("profiles").select("*, organization_id").eq("id",n.id).single();if(k)throw k;m(_),b(P=>({...P,organization_id:_.organization_id||""}))}catch(_){console.error("Error fetching user profile:",_)}})()},[n]);const[x,b]=z.useState({controller_name:"",controller_address:"",controller_email:"",controller_phone:"",dpo_contact:"",processing_purpose:"",lawful_basis:"",legitimate_interests:"",special_categories:"",personal_data_categories:"",data_sources:"",recipients_categories:"",international_transfers:"",retention_period:"",retention_explanation:"",technical_measures:"",organizational_measures:"",data_processor_name:"",processor_contact:"",data_loss_incidents:0,data_subject_requests:0,automated_decision_making:!1,automated_explanation:"",status:"active",last_review_date:"",next_review_date:"",documentation_url:"",organization_id:""}),h=async v=>{v.preventDefault(),o(!0);try{if(!(p!=null&&p.organization_id))throw new Error("Organizacijski kontekst ni na voljo");const{error:_}=await Ne.from("gdpr_processing_activities_record").insert([{...x,organization_id:p.organization_id,user_id:n==null?void 0:n.id}]);if(_)throw _;r(),j()}catch(_){console.error("Error creating processing activities record:",_),_ instanceof Error&&_.message.includes("Organizacijski kontekst")?alert("Napaka: "+_.message):alert(a("common.errorCreating"))}finally{o(!1)}},j=()=>{b({controller_name:"",controller_address:"",controller_email:"",controller_phone:"",dpo_contact:"",processing_purpose:"",lawful_basis:"",legitimate_interests:"",special_categories:"",personal_data_categories:"",data_sources:"",recipients_categories:"",international_transfers:"",retention_period:"",retention_explanation:"",technical_measures:"",organizational_measures:"",data_processor_name:"",processor_contact:"",data_loss_incidents:0,data_subject_requests:0,automated_decision_making:!1,automated_explanation:"",status:"active",last_review_date:"",next_review_date:"",documentation_url:"",organization_id:(p==null?void 0:p.organization_id)||""})},g=()=>{j(),t()};return!s||!c?null:e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-bg-surface rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-border-subtle",children:[e.jsx("h2",{className:"text-2xl font-bold text-text-primary",children:a("gdpr.processingActivities.addProcessingActivity")}),e.jsx("button",{onClick:g,className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",children:e.jsx("svg",{className:"w-5 h-5 text-text-secondary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"overflow-y-auto max-h-[calc(90vh-120px)]",children:e.jsxs("form",{onSubmit:h,className:"p-6 space-y-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-heading-sm font-semibold text-text-primary border-b border-border-subtle pb-2",children:a("gdpr.processingActivities.sections.controllerInformation")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-body-sm text-text-secondary mb-2",children:[a("gdpr.processingActivities.controllerName")," *"]}),e.jsx("input",{type:"text",required:!0,value:x.controller_name,onChange:v=>b({...x,controller_name:v.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:a("gdpr.processingActivities.placeholders.controllerNamePlaceholder")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:a("gdpr.processingActivities.dpoContact")}),e.jsx("input",{type:"text",value:x.dpo_contact,onChange:v=>b({...x,dpo_contact:v.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:a("gdpr.processingActivities.placeholders.dpoContactPlaceholder")})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-body-sm text-text-secondary mb-2",children:[a("gdpr.processingActivities.controllerAddress")," *"]}),e.jsx("input",{type:"text",required:!0,value:x.controller_address,onChange:v=>b({...x,controller_address:v.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:a("gdpr.processingActivities.placeholders.controllerAddressPlaceholder")||"Polni naslov organizacije"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-body-sm text-text-secondary mb-2",children:[a("gdpr.processingActivities.controllerEmail")," *"]}),e.jsx("input",{type:"email",required:!0,value:x.controller_email,onChange:v=>b({...x,controller_email:v.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:a("gdpr.processingActivities.controllerPhone")}),e.jsx("input",{type:"tel",value:x.controller_phone,onChange:v=>b({...x,controller_phone:v.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-heading-sm font-semibold text-text-primary border-b border-border-subtle pb-2",children:a("gdpr.processingActivities.sections.purposeAndLegalBasis")}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-body-sm text-text-secondary mb-2",children:[a("gdpr.processingActivities.processingPurpose")," *"]}),e.jsx("textarea",{required:!0,value:x.processing_purpose,onChange:v=>b({...x,processing_purpose:v.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",rows:3,placeholder:a("gdpr.processingActivities.placeholders.processingPurposePlaceholder")})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-body-sm text-text-secondary mb-2",children:[a("gdpr.processingActivities.lawfulBasis")," *"]}),e.jsxs("select",{required:!0,value:x.lawful_basis,onChange:v=>b({...x,lawful_basis:v.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"",children:a("common.selectOption")}),e.jsx("option",{value:"Pogodba",children:a("gdpr.processingActivities.legalBasisOptions.contract")}),e.jsx("option",{value:"Privolitev",children:a("gdpr.processingActivities.legalBasisOptions.consent")}),e.jsx("option",{value:"Zakonska obveznost",children:a("gdpr.processingActivities.legalBasisOptions.legal")}),e.jsx("option",{value:"Zakoniti interes",children:a("gdpr.processingActivities.legalBasisOptions.legitimate")}),e.jsx("option",{value:"Nujna potreba",children:a("gdpr.processingActivities.legalBasisOptions.vital")}),e.jsx("option",{value:"Javni interes",children:a("gdpr.processingActivities.legalBasisOptions.public")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:a("gdpr.processingActivities.legitimateInterests")}),e.jsx("input",{type:"text",value:x.legitimate_interests,onChange:v=>b({...x,legitimate_interests:v.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:a("gdpr.processingActivities.placeholders.legitimateInterestsPlaceholder")})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-heading-sm font-semibold text-text-primary border-b border-border-subtle pb-2",children:a("gdpr.processingActivities.sections.dataCategories")}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-body-sm text-text-secondary mb-2",children:[a("gdpr.processingActivities.personalDataCategories")," *"]}),e.jsx("textarea",{required:!0,value:x.personal_data_categories,onChange:v=>b({...x,personal_data_categories:v.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",rows:3,placeholder:a("gdpr.processingActivities.placeholders.personalDataCategoriesPlaceholder")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:a("gdpr.processingActivities.specialCategories")}),e.jsx("textarea",{value:x.special_categories,onChange:v=>b({...x,special_categories:v.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",rows:2,placeholder:a("gdpr.processingActivities.placeholders.specialCategoriesPlaceholder")})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-body-sm text-text-secondary mb-2",children:[a("gdpr.processingActivities.dataSources")," *"]}),e.jsx("textarea",{required:!0,value:x.data_sources,onChange:v=>b({...x,data_sources:v.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",rows:2,placeholder:a("gdpr.processingActivities.placeholders.dataSourcesPlaceholder")})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-heading-sm font-semibold text-text-primary border-b border-border-subtle pb-2",children:a("gdpr.processingActivities.sections.recipientsAndTransfers")}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-body-sm text-text-secondary mb-2",children:[a("gdpr.processingActivities.recipientsCategories")," *"]}),e.jsx("textarea",{required:!0,value:x.recipients_categories,onChange:v=>b({...x,recipients_categories:v.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",rows:2,placeholder:a("gdpr.processingActivities.placeholders.recipientsCategoriesPlaceholder")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:a("gdpr.processingActivities.internationalTransfers")}),e.jsx("textarea",{value:x.international_transfers,onChange:v=>b({...x,international_transfers:v.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",rows:2,placeholder:a("gdpr.processingActivities.placeholders.internationalTransfersPlaceholder")})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-heading-sm font-semibold text-text-primary border-b border-border-subtle pb-2",children:a("gdpr.processingActivities.sections.retention")}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-body-sm text-text-secondary mb-2",children:[a("gdpr.processingActivities.retentionPeriod")," *"]}),e.jsx("input",{type:"text",required:!0,value:x.retention_period,onChange:v=>b({...x,retention_period:v.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:a("gdpr.processingActivities.placeholders.retentionPeriodPlaceholder")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:a("gdpr.processingActivities.retentionExplanation")}),e.jsx("textarea",{value:x.retention_explanation,onChange:v=>b({...x,retention_explanation:v.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",rows:2,placeholder:a("gdpr.processingActivities.placeholders.retentionExplanationPlaceholder")})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-heading-sm font-semibold text-text-primary border-b border-border-subtle pb-2",children:a("gdpr.processingActivities.sections.securityMeasures")}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-body-sm text-text-secondary mb-2",children:[a("gdpr.processingActivities.technicalMeasures")," *"]}),e.jsx("textarea",{required:!0,value:x.technical_measures,onChange:v=>b({...x,technical_measures:v.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",rows:3,placeholder:a("gdpr.processingActivities.placeholders.technicalMeasuresPlaceholder")})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-body-sm text-text-secondary mb-2",children:[a("gdpr.processingActivities.organizationalMeasures")," *"]}),e.jsx("textarea",{required:!0,value:x.organizational_measures,onChange:v=>b({...x,organizational_measures:v.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",rows:3,placeholder:a("gdpr.processingActivities.placeholders.organizationalMeasuresPlaceholder")})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-heading-sm font-semibold text-text-primary border-b border-border-subtle pb-2",children:a("gdpr.processingActivities.sections.dataProcessor")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:a("gdpr.processingActivities.dataProcessorName")}),e.jsx("input",{type:"text",value:x.data_processor_name,onChange:v=>b({...x,data_processor_name:v.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:a("gdpr.processingActivities.placeholders.dataProcessorNamePlaceholder")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:a("gdpr.processingActivities.processorContact")}),e.jsx("input",{type:"text",value:x.processor_contact,onChange:v=>b({...x,processor_contact:v.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:a("gdpr.processingActivities.placeholders.processorContactPlaceholder")})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-heading-sm font-semibold text-text-primary border-b border-border-subtle pb-2",children:a("gdpr.processingActivities.sections.monitoringAndReview")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:a("gdpr.processingActivities.dataLossIncidents")}),e.jsx("input",{type:"number",min:"0",value:x.data_loss_incidents,onChange:v=>b({...x,data_loss_incidents:parseInt(v.target.value)||0}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:a("gdpr.processingActivities.dataSubjectRequests")}),e.jsx("input",{type:"number",min:"0",value:x.data_subject_requests,onChange:v=>b({...x,data_subject_requests:parseInt(v.target.value)||0}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"automated_decision_making",checked:x.automated_decision_making,onChange:v=>b({...x,automated_decision_making:v.target.checked}),className:"rounded border-border-subtle bg-bg-near-black text-accent-primary focus:ring-accent-primary"}),e.jsx("label",{htmlFor:"automated_decision_making",className:"text-body-sm text-text-secondary",children:a("gdpr.processingActivities.automatedDecisionMaking")})]})}),x.automated_decision_making&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:a("gdpr.processingActivities.automatedExplanation")}),e.jsx("textarea",{value:x.automated_explanation,onChange:v=>b({...x,automated_explanation:v.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",rows:2,placeholder:a("gdpr.processingActivities.placeholders.automatedExplanationPlaceholder")})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-heading-sm font-semibold text-text-primary border-b border-border-subtle pb-2",children:a("gdpr.processingActivities.sections.reviewAndDocumentation")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:a("gdpr.processingActivities.lastReviewDate")}),e.jsx("input",{type:"date",value:x.last_review_date,onChange:v=>b({...x,last_review_date:v.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:a("gdpr.processingActivities.nextReviewDate")}),e.jsx("input",{type:"date",value:x.next_review_date,onChange:v=>b({...x,next_review_date:v.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:a("gdpr.processingActivities.documentationUrl")}),e.jsx("input",{type:"url",value:x.documentation_url,onChange:v=>b({...x,documentation_url:v.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:a("gdpr.processingActivities.placeholders.documentationUrlPlaceholder")})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-body-sm text-text-secondary mb-2",children:[a("common.status")," *"]}),e.jsxs("select",{required:!0,value:x.status,onChange:v=>b({...x,status:v.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"active",children:a("common.active")}),e.jsx("option",{value:"inactive",children:a("common.inactive")}),e.jsx("option",{value:"under_review",children:a("gdpr.processingActivities.statusOptions.underReview")}),e.jsx("option",{value:"suspended",children:a("gdpr.processingActivities.statusOptions.suspended")})]})]}),e.jsxs("div",{className:"flex items-center gap-3 justify-end pt-4 border-t border-border-subtle",children:[e.jsx("button",{type:"button",onClick:g,className:"h-10 px-4 bg-bg-near-black hover:bg-bg-surface text-text-primary rounded-sm transition-colors duration-150",children:a("common.cancel")}),e.jsx("button",{type:"submit",disabled:i,className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 disabled:opacity-50",children:a(i?"common.saving":"common.save")})]})]})})]})})}function gD(){const{t:s}=et(),[t,r]=z.useState([]),[a,n]=z.useState(!0),[i,o]=z.useState(!1),[c,d]=z.useState(!1),[p,m]=z.useState(!1),[x,b]=z.useState(null),[h,j]=z.useState({controller_name:"",controller_address:"",controller_email:"",controller_phone:"",dpo_contact:"",processing_purpose:"",lawful_basis:"",legitimate_interests:"",special_categories:"",personal_data_categories:"",data_sources:"",recipients_categories:"",international_transfers:"",retention_period:"",retention_explanation:"",technical_measures:"",organizational_measures:"",data_processor_name:"",processor_contact:"",data_loss_incidents:0,data_subject_requests:0,automated_decision_making:!1,automated_explanation:"",status:"active",last_review_date:"",next_review_date:"",documentation_url:""}),[g,v]=z.useState(!1),[_,k]=z.useState(!1);z.useEffect(()=>{P()},[]);const P=async()=>{try{const{data:S,error:C}=await Ne.from("gdpr_processing_activities_record").select("*").order("created_at",{ascending:!1});if(C)throw C;r(S||[])}catch(S){console.error("Error fetching processing activities record:",S)}finally{n(!1)}},L=()=>{P(),o(!1)},F=async S=>{if(S.preventDefault(),!!x){v(!0);try{const{error:C}=await Ne.from("gdpr_processing_activities_record").update(h).eq("id",x.id);if(C)throw C;await P(),d(!1),b(null),A()}catch(C){console.error("Error updating processing activity record:",C),alert(s("common.errorUpdating"))}finally{v(!1)}}},W=async()=>{if(x){k(!0);try{const{error:S}=await Ne.from("gdpr_processing_activities_record").delete().eq("id",x.id);if(S)throw S;await P(),m(!1),b(null)}catch(S){console.error("Error deleting processing activity record:",S),alert(s("common.errorDeleting"))}finally{k(!1)}}},R=S=>{b(S),j({controller_name:S.controller_name||"",controller_address:S.controller_address||"",controller_email:S.controller_email||"",controller_phone:S.controller_phone||"",dpo_contact:S.dpo_contact||"",processing_purpose:S.processing_purpose||"",lawful_basis:S.lawful_basis||"",legitimate_interests:S.legitimate_interests||"",special_categories:S.special_categories||"",personal_data_categories:S.personal_data_categories||"",data_sources:S.data_sources||"",recipients_categories:S.recipients_categories||"",international_transfers:S.international_transfers||"",retention_period:S.retention_period||"",retention_explanation:S.retention_explanation||"",technical_measures:S.technical_measures||"",organizational_measures:S.organizational_measures||"",data_processor_name:S.data_processor_name||"",processor_contact:S.processor_contact||"",data_loss_incidents:S.data_loss_incidents||0,data_subject_requests:S.data_subject_requests||0,automated_decision_making:S.automated_decision_making||!1,automated_explanation:S.automated_explanation||"",status:S.status||"active",last_review_date:S.last_review_date||"",next_review_date:S.next_review_date||"",documentation_url:S.documentation_url||""}),d(!0)},B=S=>{b(S),m(!0)},A=()=>{j({controller_name:"",controller_address:"",controller_email:"",controller_phone:"",dpo_contact:"",processing_purpose:"",lawful_basis:"",legitimate_interests:"",special_categories:"",personal_data_categories:"",data_sources:"",recipients_categories:"",international_transfers:"",retention_period:"",retention_explanation:"",technical_measures:"",organizational_measures:"",data_processor_name:"",processor_contact:"",data_loss_incidents:0,data_subject_requests:0,automated_decision_making:!1,automated_explanation:"",status:"active",last_review_date:"",next_review_date:"",documentation_url:""})};return a?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-accent-primary/10 flex items-center justify-center",children:e.jsx(ut,{className:"w-5 h-5 text-accent-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:s("gdpr.processingActivities.title")}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:s("gdpr.processingActivities.subtitle")})]})]}),e.jsxs("button",{onClick:()=>o(!0),className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Dt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:s("gdpr.processingActivities.addProcessingActivity")})]})]}),e.jsx("div",{className:"bg-bg-surface rounded-sm border border-border-subtle overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-pure-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("gdpr.processingActivities.controllerName")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("gdpr.processingActivities.processingPurpose")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("gdpr.processingActivities.lawfulBasis")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("gdpr.processingActivities.legitimateInterests")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("gdpr.processingActivities.retentionPeriod")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("gdpr.processingActivities.dataProcessorName")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("gdpr.processingActivities.reviewDate")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("common.status")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("common.actions")})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:t.map(S=>e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 text-body text-text-primary font-medium",children:S.controller_name}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary max-w-xs truncate",children:S.processing_purpose}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"px-2 py-1 rounded-full text-caption font-medium bg-accent-primary/10 text-accent-primary",children:S.lawful_basis})}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary max-w-xs truncate",children:S.legitimate_interests||"-"}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:S.retention_period}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary max-w-xs truncate",children:S.data_processor_name||"-"}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:S.next_review_date?new Date(S.next_review_date).toLocaleDateString("sl-SI"):"-"}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium ${S.status==="active"?"bg-status-success/10 text-status-success":"bg-status-error/10 text-status-error"}`,children:S.status==="active"?s("common.active"):s("common.inactive")})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>R(S),className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",title:s("common.edit"),children:e.jsx(ar,{className:"w-4 h-4 text-text-secondary"})}),e.jsx("button",{onClick:()=>B(S),className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",title:s("common.delete"),children:e.jsx(pr,{className:"w-4 h-4 text-status-error"})}),S.documentation_url&&e.jsx("a",{href:S.documentation_url,target:"_blank",rel:"noopener noreferrer",className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",title:s("gdpr.processingActivities.viewDocumentation"),children:e.jsx(Ir,{className:"w-4 h-4 text-accent-primary"})})]})})]},S.id))})]})})}),e.jsxs("div",{className:"grid grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-bg-surface rounded-sm border border-border-subtle p-6",children:[e.jsx("div",{className:"text-caption text-text-secondary uppercase tracking-wide mb-2",children:s("common.totalRecords")}),e.jsx("div",{className:"text-2xl font-bold text-text-primary",children:t.length})]}),e.jsxs("div",{className:"bg-bg-surface rounded-sm border border-border-subtle p-6",children:[e.jsx("div",{className:"text-caption text-text-secondary uppercase tracking-wide mb-2",children:s("common.active")}),e.jsx("div",{className:"text-h2 text-status-success",children:t.filter(S=>S.status==="active").length})]}),e.jsxs("div",{className:"bg-bg-surface rounded-sm border border-border-subtle p-6",children:[e.jsx("div",{className:"text-caption text-text-secondary uppercase tracking-wide mb-2",children:s("gdpr.processingActivities.totalDataLossIncidents")}),e.jsx("div",{className:"text-h2 text-status-warning",children:t.reduce((S,C)=>S+(C.data_loss_incidents||0),0)})]}),e.jsxs("div",{className:"bg-bg-surface rounded-sm border border-border-subtle p-6",children:[e.jsx("div",{className:"text-caption text-text-secondary uppercase tracking-wide mb-2",children:s("gdpr.processingActivities.dataSubjectRequests")}),e.jsx("div",{className:"text-h2 text-status-info",children:t.reduce((S,C)=>S+(C.data_subject_requests||0),0)})]})]}),e.jsx(bD,{isOpen:i,onClose:()=>{o(!1),A()},onSave:L}),e.jsx(zs,{isOpen:c,onClose:()=>{d(!1),b(null),A()},title:s("common.editRecord"),children:e.jsxs("form",{onSubmit:F,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-heading-sm font-semibold text-text-primary",children:s("gdpr.processingActivities.controllerInformation")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-body-sm text-text-secondary mb-2",children:[s("gdpr.processingActivities.controllerName")," *"]}),e.jsx("input",{type:"text",required:!0,value:h.controller_name,onChange:S=>j({...h,controller_name:S.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:s("gdpr.processingActivities.dpoContact")}),e.jsx("input",{type:"text",value:h.dpo_contact,onChange:S=>j({...h,dpo_contact:S.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 justify-end pt-4",children:[e.jsx("button",{type:"button",onClick:()=>{d(!1),b(null),A()},className:"h-10 px-4 bg-bg-near-black hover:bg-bg-surface text-text-primary rounded-sm transition-colors duration-150",children:s("common.cancel")}),e.jsx("button",{type:"submit",disabled:g,className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 disabled:opacity-50",children:s(g?"common.saving":"common.update")})]})]})}),e.jsx(gi,{isOpen:p,onClose:()=>{m(!1),b(null)},onConfirm:W,title:s("gdpr.processingActivities.deleteProcessingActivity"),message:s("gdpr.processingActivities.deleteConfirmation").replace("{name}",(x==null?void 0:x.controller_name)||""),isDeleting:_})]})}function vD(){const{t:s}=et(),{organizationId:t,userProfile:r,loading:a,error:n}=ju(),[i,o]=z.useState([]),[c,d]=z.useState(!0),[p,m]=z.useState(!1),[x,b]=z.useState(!1),[h,j]=z.useState(!1),[g,v]=z.useState(null),[_,k]=z.useState(null),[P,L]=z.useState({controllerInfo:!0,dpoInfo:!1,purposesAndBasis:!1,dataCategories:!1,recipientsTransfers:!1,security:!1,retention:!1,dataSubjectRights:!1,automatedDecisions:!1,zvop2:!1}),[F,W]=z.useState({data_type:"",processing_purpose:"",legal_basis:"",data_retention_period:"",status:"active",dpo_appointed:!1,automated_decision_making:!1,processing_logs_maintained:!1}),[R,B]=z.useState(!1),[A,S]=z.useState(!1),[C,O]=z.useState(""),[Z,te]=z.useState("all");if(z.useEffect(()=>{t&&ce()},[t]),a)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})});if(n||!t)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(er,{className:"w-12 h-12 text-status-error mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:s("common.accessDenied")}),e.jsx("p",{className:"text-body text-text-secondary",children:n||s("gdpr.dataProtection.noOrganization")})]})});const ce=async()=>{if(!t){d(!1);return}try{k(null);const{data:I,error:Y}=await Ne.from("gdpr_data_protection").select("*").eq("organization_id",t).order("created_at",{ascending:!1});if(Y)throw Y;o(I||[])}catch(I){console.error("Error fetching data:",I),k(I.message),o([])}finally{d(!1)}},re=async I=>{if(I.preventDefault(),!t){k(s("common.noOrganization"));return}B(!0);try{const Y={...F,organization_id:t},{error:H}=await Ne.from("gdpr_data_protection").insert([Y]);if(H)throw H;await ce(),m(!1),J()}catch(Y){console.error("Error creating record:",Y),k(Y.message||s("common.errorCreating"))}finally{B(!1)}},X=async I=>{if(I.preventDefault(),!(!g||!t)){B(!0);try{const{error:Y}=await Ne.from("gdpr_data_protection").update(F).eq("id",g.id).eq("organization_id",t);if(Y)throw Y;await ce(),b(!1),v(null),J()}catch(Y){console.error("Error updating record:",Y),k(Y.message||s("common.errorUpdating"))}finally{B(!1)}}},U=async()=>{if(!(!g||!t)){S(!0);try{const{error:I}=await Ne.from("gdpr_data_protection").delete().eq("id",g.id).eq("organization_id",t);if(I)throw I;await ce(),j(!1),v(null)}catch(I){console.error("Error deleting record:",I),k(I.message||s("common.errorDeleting"))}finally{S(!1)}}},oe=I=>{v(I),W(I),b(!0)},xe=I=>{v(I),j(!0)},J=()=>{W({data_type:"",processing_purpose:"",legal_basis:"",data_retention_period:"",status:"active",dpo_appointed:!1,automated_decision_making:!1,processing_logs_maintained:!1}),L({controllerInfo:!0,dpoInfo:!1,purposesAndBasis:!1,dataCategories:!1,recipientsTransfers:!1,security:!1,retention:!1,dataSubjectRights:!1,automatedDecisions:!1,zvop2:!1})},$=I=>{L(Y=>({...Y,[I]:!Y[I]}))},Q=i.filter(I=>{var ge,K,T,ee,_e,ke;const Y=C.toLowerCase(),H=!C||((ge=I.controller_name)==null?void 0:ge.toLowerCase().includes(Y))||((K=I.processing_purposes_detailed)==null?void 0:K.toLowerCase().includes(Y))||((T=I.processing_purpose)==null?void 0:T.toLowerCase().includes(Y))||((ee=I.legal_basis_detailed)==null?void 0:ee.toLowerCase().includes(Y))||((_e=I.legal_basis)==null?void 0:_e.toLowerCase().includes(Y))||((ke=I.dpo_contact_name)==null?void 0:ke.toLowerCase().includes(Y)),he=Z==="all"||I.status===Z;return H&&he}),q=(I,Y,H)=>e.jsxs("div",{className:"border border-border-subtle rounded-sm overflow-hidden mb-4",children:[e.jsxs("button",{type:"button",onClick:()=>$(I),className:"w-full px-4 py-3 bg-bg-near-black hover:bg-bg-surface flex items-center justify-between transition-colors duration-150",children:[e.jsx("span",{className:"text-body font-medium text-text-primary",children:Y}),P[I]?e.jsx(K2,{className:"w-5 h-5 text-text-secondary"}):e.jsx(sx,{className:"w-5 h-5 text-text-secondary"})]}),P[I]&&e.jsx("div",{className:"p-4 space-y-4 bg-bg-surface",children:H})]});return c?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})}):_?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(er,{className:"w-12 h-12 text-status-error mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:s("common.error")}),e.jsx("p",{className:"text-body text-text-secondary mb-4",children:_}),e.jsx("button",{onClick:()=>ce(),className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150",children:s("common.retry")})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-accent-primary/10 flex items-center justify-center",children:e.jsx(_u,{className:"w-5 h-5 text-accent-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:s("gdpr.dataProtection.title")}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:s("gdpr.dataProtection.subtitle")})]})]}),e.jsxs("button",{onClick:()=>m(!0),className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Dt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:s("common.addRecord")})]})]}),e.jsx("div",{className:"bg-bg-surface rounded-sm border border-border-subtle p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:s("common.search")}),e.jsx("input",{type:"text",value:C,onChange:I=>O(I.target.value),placeholder:s("gdpr.dataProtection.searchPlaceholder"),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:s("common.status")}),e.jsxs("select",{value:Z,onChange:I=>te(I.target.value),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"all",children:s("common.all")}),e.jsx("option",{value:"active",children:s("common.active")}),e.jsx("option",{value:"inactive",children:s("common.inactive")})]})]})]})}),_&&e.jsx("div",{className:"bg-status-error/10 border border-status-error/20 rounded-sm p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(er,{className:"w-5 h-5 text-status-error"}),e.jsx("span",{className:"text-body text-status-error",children:_})]})}),e.jsx("div",{className:"bg-bg-surface rounded-sm border border-border-subtle overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-pure-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("gdpr.dataProtection.fields.controllerName")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("gdpr.dataProtection.fields.processingPurposesDetailed")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("gdpr.dataProtection.fields.legalBasisDetailed")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("gdpr.dataProtection.fields.dpoContactName")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("common.status")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("common.actions")})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:Q.map(I=>e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 text-body text-text-primary",children:I.controller_name||I.data_type}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary max-w-xs truncate",children:I.processing_purposes_detailed||I.processing_purpose}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"px-2 py-1 rounded-full text-caption font-medium bg-accent-primary/10 text-accent-primary",children:I.legal_basis_detailed||I.legal_basis})}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:I.dpo_contact_name||"-"}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium ${I.status==="active"?"bg-status-success/10 text-status-success":"bg-status-error/10 text-status-error"}`,children:I.status==="active"?s("common.active"):s("common.inactive")})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>oe(I),className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",children:e.jsx(ar,{className:"w-4 h-4 text-text-secondary"})}),e.jsx("button",{onClick:()=>xe(I),className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",children:e.jsx(pr,{className:"w-4 h-4 text-status-error"})})]})})]},I.id))})]})})}),e.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-bg-surface rounded-sm border border-border-subtle p-6",children:[e.jsx("div",{className:"text-caption text-text-secondary uppercase tracking-wide mb-2",children:s("common.totalRecords")}),e.jsx("div",{className:"text-2xl font-bold text-text-primary",children:i.length})]}),e.jsxs("div",{className:"bg-bg-surface rounded-sm border border-border-subtle p-6",children:[e.jsx("div",{className:"text-caption text-text-secondary uppercase tracking-wide mb-2",children:s("common.active")}),e.jsx("div",{className:"text-h2 text-status-success",children:i.filter(I=>I.status==="active").length})]}),e.jsxs("div",{className:"bg-bg-surface rounded-sm border border-border-subtle p-6",children:[e.jsx("div",{className:"text-caption text-text-secondary uppercase tracking-wide mb-2",children:s("common.inactive")}),e.jsx("div",{className:"text-h2 text-status-warning",children:i.filter(I=>I.status!=="active").length})]})]}),e.jsx(zs,{isOpen:p||x,onClose:()=>{p&&m(!1),x&&b(!1),v(null),J()},title:s(p?"common.addRecord":"common.editRecord"),children:e.jsxs("form",{onSubmit:p?re:X,className:"space-y-4 max-h-[70vh] overflow-y-auto",children:[q("controllerInfo",s("gdpr.dataProtection.sections.controllerInfo"),e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-body-sm text-text-secondary mb-2",children:[s("gdpr.dataProtection.fields.controllerName")," *"]}),e.jsx("input",{type:"text",required:!0,value:F.controller_name||"",onChange:I=>W({...F,controller_name:I.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:s("gdpr.dataProtection.placeholders.controllerName")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:s("gdpr.dataProtection.fields.controllerAddress")}),e.jsx("input",{type:"text",value:F.controller_address||"",onChange:I=>W({...F,controller_address:I.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:s("gdpr.dataProtection.placeholders.controllerAddress")})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:s("gdpr.dataProtection.fields.controllerEmail")}),e.jsx("input",{type:"email",value:F.controller_email||"",onChange:I=>W({...F,controller_email:I.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:s("gdpr.dataProtection.placeholders.controllerEmail")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:s("gdpr.dataProtection.fields.controllerPhone")}),e.jsx("input",{type:"tel",value:F.controller_phone||"",onChange:I=>W({...F,controller_phone:I.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:s("gdpr.dataProtection.placeholders.controllerPhone")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:s("gdpr.dataProtection.fields.euRepresentative")}),e.jsx("input",{type:"text",value:F.eu_representative||"",onChange:I=>W({...F,eu_representative:I.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:s("gdpr.dataProtection.placeholders.euRepresentative")})]})]})),q("dpoInfo",s("gdpr.dataProtection.sections.dpoContact"),e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:s("gdpr.dataProtection.fields.dpoContactName")}),e.jsx("input",{type:"text",value:F.dpo_contact_name||"",onChange:I=>W({...F,dpo_contact_name:I.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:s("gdpr.dataProtection.placeholders.dpoContactName")})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:s("gdpr.dataProtection.fields.dpoContactEmail")}),e.jsx("input",{type:"email",value:F.dpo_contact_email||"",onChange:I=>W({...F,dpo_contact_email:I.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:s("gdpr.dataProtection.placeholders.dpoContactEmail")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:s("gdpr.dataProtection.fields.dpoContactPhone")}),e.jsx("input",{type:"tel",value:F.dpo_contact_phone||"",onChange:I=>W({...F,dpo_contact_phone:I.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:s("gdpr.dataProtection.placeholders.dpoContactPhone")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"dpo_appointed",checked:F.dpo_appointed||!1,onChange:I=>W({...F,dpo_appointed:I.target.checked}),className:"w-4 h-4 text-accent-primary bg-bg-near-black border-border-subtle rounded focus:ring-accent-primary"}),e.jsx("label",{htmlFor:"dpo_appointed",className:"text-body-sm text-text-secondary",children:s("gdpr.dataProtection.fields.dpoAppointed")})]})]})),q("purposesAndBasis",s("gdpr.dataProtection.sections.purposesAndBasis"),e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-body-sm text-text-secondary mb-2",children:[s("gdpr.dataProtection.fields.processingPurposes")," *"]}),e.jsx("textarea",{required:!0,value:F.processing_purposes_detailed||F.processing_purpose||"",onChange:I=>W({...F,processing_purposes_detailed:I.target.value,processing_purpose:I.target.value}),rows:4,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:s("gdpr.dataProtection.placeholders.processingPurposes")})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-body-sm text-text-secondary mb-2",children:[s("gdpr.dataProtection.fields.legalBasisDetailed")," *"]}),e.jsx("textarea",{required:!0,value:F.legal_basis_detailed||F.legal_basis||"",onChange:I=>W({...F,legal_basis_detailed:I.target.value,legal_basis:I.target.value}),rows:3,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:s("gdpr.dataProtection.placeholders.legalBasisDetailed")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:s("gdpr.dataProtection.fields.legitimateInterests")}),e.jsx("textarea",{value:F.legitimate_interests||"",onChange:I=>W({...F,legitimate_interests:I.target.value}),rows:3,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:s("gdpr.dataProtection.placeholders.legitimateInterests")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:s("gdpr.dataProtection.fields.dataSubjectCategories")}),e.jsx("textarea",{value:F.data_subject_categories||"",onChange:I=>W({...F,data_subject_categories:I.target.value}),rows:2,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:s("gdpr.dataProtection.placeholders.dataSubjectCategories")})]})]})),q("dataCategories",s("gdpr.dataProtection.sections.dataCategories"),e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:s("gdpr.dataProtection.fields.personalDataCategories")}),e.jsx("textarea",{value:F.personal_data_categories||F.data_type||"",onChange:I=>W({...F,personal_data_categories:I.target.value,data_type:I.target.value}),rows:3,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:s("gdpr.dataProtection.placeholders.personalDataCategories")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:s("gdpr.dataProtection.fields.specialDataCategories")}),e.jsx("textarea",{value:F.special_data_categories||"",onChange:I=>W({...F,special_data_categories:I.target.value}),rows:2,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:s("gdpr.dataProtection.placeholders.specialDataCategories")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:s("gdpr.dataProtection.fields.dataSources")}),e.jsx("textarea",{value:F.data_sources||"",onChange:I=>W({...F,data_sources:I.target.value}),rows:2,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:s("gdpr.dataProtection.placeholders.dataSources")})]})]})),q("recipientsTransfers",s("gdpr.dataProtection.sections.recipientsTransfers"),e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:s("gdpr.dataProtection.fields.recipientCategories")}),e.jsx("textarea",{value:F.recipient_categories||"",onChange:I=>W({...F,recipient_categories:I.target.value}),rows:3,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:s("gdpr.dataProtection.placeholders.recipientCategories")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:s("gdpr.dataProtection.fields.internationalTransfers")}),e.jsx("textarea",{value:F.international_transfers||"",onChange:I=>W({...F,international_transfers:I.target.value}),rows:2,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:s("gdpr.dataProtection.placeholders.internationalTransfers")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:s("gdpr.dataProtection.fields.transferSafeguards")}),e.jsx("textarea",{value:F.transfer_safeguards||"",onChange:I=>W({...F,transfer_safeguards:I.target.value}),rows:2,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:s("gdpr.dataProtection.placeholders.transferSafeguards")})]})]})),q("security",s("gdpr.dataProtection.sections.securityMeasures"),e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:s("gdpr.dataProtection.fields.technicalMeasures")}),e.jsx("textarea",{value:F.technical_measures||"",onChange:I=>W({...F,technical_measures:I.target.value}),rows:4,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:s("gdpr.dataProtection.placeholders.technicalMeasures")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:s("gdpr.dataProtection.fields.organizationalMeasures")}),e.jsx("textarea",{value:F.organizational_measures||"",onChange:I=>W({...F,organizational_measures:I.target.value}),rows:4,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:s("gdpr.dataProtection.placeholders.organizationalMeasures")})]})]})),q("retention",s("gdpr.dataProtection.sections.retention"),e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:s("gdpr.dataProtection.fields.retentionPeriodDetailed")}),e.jsx("textarea",{value:F.retention_period_detailed||F.data_retention_period||"",onChange:I=>W({...F,retention_period_detailed:I.target.value,data_retention_period:I.target.value}),rows:3,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:s("gdpr.dataProtection.placeholders.retentionPeriodDetailed")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:s("gdpr.dataProtection.fields.retentionCriteria")}),e.jsx("textarea",{value:F.retention_criteria||"",onChange:I=>W({...F,retention_criteria:I.target.value}),rows:3,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:s("gdpr.dataProtection.placeholders.retentionCriteria")})]})]})),q("dataSubjectRights",s("gdpr.dataProtection.sections.dataSubjectRights"),e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:s("gdpr.dataProtection.fields.dataSubjectRights")}),e.jsx("textarea",{value:F.data_subject_rights||"",onChange:I=>W({...F,data_subject_rights:I.target.value}),rows:4,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:s("gdpr.dataProtection.placeholders.dataSubjectRights")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:s("gdpr.dataProtection.fields.rightsExerciseProcedure")}),e.jsx("textarea",{value:F.rights_exercise_procedure||"",onChange:I=>W({...F,rights_exercise_procedure:I.target.value}),rows:3,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:s("gdpr.dataProtection.placeholders.rightsExerciseProcedure")})]})]})),q("automatedDecisions",s("gdpr.dataProtection.sections.automatedDecisions"),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("input",{type:"checkbox",id:"automated_decision_making",checked:F.automated_decision_making||!1,onChange:I=>W({...F,automated_decision_making:I.target.checked}),className:"w-4 h-4 text-accent-primary bg-bg-near-black border-border-subtle rounded focus:ring-accent-primary"}),e.jsx("label",{htmlFor:"automated_decision_making",className:"text-body-sm text-text-secondary",children:s("gdpr.dataProtection.fields.automatedDecisionMaking")})]}),F.automated_decision_making&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:s("gdpr.dataProtection.fields.profilingDescription")}),e.jsx("textarea",{value:F.profiling_description||"",onChange:I=>W({...F,profiling_description:I.target.value}),rows:4,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:s("gdpr.dataProtection.placeholders.profilingDescription")})]})]})),q("zvop2",s("gdpr.dataProtection.sections.zvop2Specifics"),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("input",{type:"checkbox",id:"processing_logs_maintained",checked:F.processing_logs_maintained||!1,onChange:I=>W({...F,processing_logs_maintained:I.target.checked}),className:"w-4 h-4 text-accent-primary bg-bg-near-black border-border-subtle rounded focus:ring-accent-primary"}),e.jsx("label",{htmlFor:"processing_logs_maintained",className:"text-body-sm text-text-secondary",children:s("gdpr.dataProtection.fields.processingLogsMaintained")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:s("gdpr.dataProtection.fields.specialSystems")}),e.jsx("textarea",{value:F.special_systems||"",onChange:I=>W({...F,special_systems:I.target.value}),rows:3,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:s("gdpr.dataProtection.placeholders.specialSystems")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:s("gdpr.dataProtection.fields.dataResidencyLocation")}),e.jsx("input",{type:"text",value:F.data_residency_location||"",onChange:I=>W({...F,data_residency_location:I.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",placeholder:s("gdpr.dataProtection.placeholders.dataResidencyLocation")})]})]})),e.jsxs("div",{className:"border border-border-subtle rounded-sm p-4 bg-bg-surface",children:[e.jsx("label",{className:"block text-body-sm text-text-secondary mb-2",children:s("common.status")}),e.jsxs("select",{value:F.status||"active",onChange:I=>W({...F,status:I.target.value}),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"active",children:s("common.active")}),e.jsx("option",{value:"inactive",children:s("common.inactive")})]})]}),e.jsxs("div",{className:"flex items-center gap-3 justify-end pt-4 border-t border-border-subtle",children:[e.jsx("button",{type:"button",onClick:()=>{p&&m(!1),x&&b(!1),v(null),J()},className:"h-10 px-4 bg-bg-near-black hover:bg-bg-surface text-text-primary rounded-sm transition-colors duration-150",children:s("common.cancel")}),e.jsx("button",{type:"submit",disabled:R,className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 disabled:opacity-50",children:s(R?"common.saving":p?"common.save":"common.update")})]})]})}),e.jsx(gi,{isOpen:h,onClose:()=>{j(!1),v(null)},onConfirm:U,title:s("common.deleteRecord"),message:`${s("deleteConfirm.message")} "${(g==null?void 0:g.controller_name)||(g==null?void 0:g.data_type)}"`,isDeleting:A})]})}function Qa({isOpen:s,onClose:t,onSave:r,mode:a,record:n,title:i,table:o,fields:c,defaultValues:d={}}){const{user:p}=cr(),[m,x]=z.useState(!1),[b,h]=z.useState(!1),[j,g]=z.useState(!1),[v,_]=z.useState(d),[k,P]=z.useState({}),[L,F]=z.useState(null),[W,R]=z.useState({});z.useEffect(()=>{(async()=>{if(!(!p||!s))try{const{data:X,error:U}=await Ne.from("profiles").select("*, organization_id").eq("id",p.id).single();if(U)throw U;F(X)}catch(X){console.error("Error fetching user profile:",X)}})()},[p,s]),z.useEffect(()=>{const re=async()=>{if(!(L!=null&&L.organization_id))return;const X={};for(const U of c)if(U.type==="select"&&U.dataSource)try{let oe=Ne.from(U.dataSource.table).select(`${U.dataSource.idField}, ${U.dataSource.labelField}`).eq("organization_id",L.organization_id);U.dataSource.filterField&&(oe=oe.eq(U.dataSource.filterField,"active"));const{data:xe,error:J}=await oe;if(J){console.error(`Error fetching ${U.dataSource.table}:`,J);continue}X[U.key]=xe||[]}catch(oe){console.error(`Error fetching dropdown data for ${U.key}:`,oe)}R(X)};s&&(L!=null&&L.organization_id)&&re()},[L,s,c]),z.useEffect(()=>{if(n&&(a==="edit"||a==="view")){const re={...d};c.forEach(X=>{var U;re[X.key]=((U=n[X.key])==null?void 0:U.toString())||""}),_(re)}else _(d);P({})},[a,n,d,c]);const B=()=>{const re={};return c.forEach(X=>{X.required&&((v[X.key]||d[X.key]||"").trim()||(re[X.key]=`${X.label} je obvezno polje`)),X.key==="organization_id"&&((v[X.key]||d[X.key]||(L==null?void 0:L.organization_id)||"").trim()||(re[X.key]="ID organizacije je obvezno polje"))}),P(re),Object.keys(re).length===0},A=async re=>{if(re.preventDefault(),!!B()){x(!0);try{if(!(L!=null&&L.organization_id))throw new Error("Organizacijski kontekst ni na voljo");const X={...d,...v,organization_id:L.organization_id},{error:U}=await Ne.from(o).update(X).eq("id",n.id).eq("organization_id",L.organization_id);if(U)throw U.code==="23502"?new Error("Nekatera obvezna polja niso izpolnjena"):U.code==="23505"?new Error("Vrednost e obstaja"):U;r()}catch(X){console.error("Error updating record:",X),alert(X.message||"Prilo je do napake pri posodabljanju zapisa")}finally{x(!1)}}},S=async()=>{if(!(n!=null&&n.id)||!(L!=null&&L.organization_id)){alert("Manjkajo podatki za brisanje");return}h(!0);try{const{error:re}=await Ne.from(o).delete().eq("id",n.id).eq("organization_id",L.organization_id);if(re)throw re;r()}catch(re){console.error("Error deleting record:",re),alert(re.message||"Prilo je do napake pri brisanju zapisa")}finally{h(!1)}},C=async()=>{if(n){g(!0);try{const re=new It;re.setFont("helvetica"),re.setFontSize(16),re.text("Podrobnosti ocene tveganja",20,20),re.setFontSize(12);const X=n.risk_id||n.asset_name||"Risk Assessment";re.text(`ID tveganja: ${X}`,20,35);let U=55;c.forEach(J=>{const $=v[J.key]||"Ni podatka",Q=O($,J.type,J.key);U>270&&(re.addPage(),U=20),re.setFontSize(10),re.setFont("helvetica","bold"),re.text(J.label+":",20,U),re.setFont("helvetica","normal");const q=re.splitTextToSize(Q,170);re.text(q,20,U+8),U+=20+(q.length-1)*5}),U>250&&(re.addPage(),U=20),re.setFontSize(8),re.setFont("helvetica","italic"),re.text(`Izvoeno: ${new Date().toLocaleDateString("sl-SI")}`,20,280);const oe=new Date().toISOString().split("T")[0],xe=`ocena_tveganja_${X.replace(/[^a-zA-Z0-9]/g,"_")}_${oe}.pdf`;re.save(xe)}catch(re){console.error("Error generating PDF:",re),alert("Prilo je do napake pri ustvarjanju PDF datoteke")}finally{g(!1)}}},O=(re,X,U)=>{if(re==="Ni podatka")return re;switch(X){case"select":return Z(re,U);case"date":return new Date(re).toLocaleDateString("sl-SI");case"number":return re;default:return re}},Z=(re,X)=>{const U={information_security_general:"Splona varnost informacij",access_control:"Kontrola dostopa",data_protection:"Varstvo podatkov",incident_response:"Obvladovanje incidentov",business_continuity:"Kontinuiteta poslovanja",supplier_security:"Varnost dobaviteljev",physical_security:"Fizina varnost",human_resources:"loveki viri",risk_management:"Upravljanje tveganj",compliance:"Skladnost"},oe={draft:"Osnutek",under_review:"V pregledu",approved:"Odobren",active:"Aktiven",retired:"Povleen"};return X==="policy_type"?U[re]||re.replace("_"," ").replace(/\b\w/g,xe=>xe.toUpperCase()):X==="status"?oe[re]||re.replace("_"," ").replace(/\b\w/g,xe=>xe.toUpperCase()):re.replace("_"," ").replace(/\b\w/g,xe=>xe.toUpperCase())},te=re=>{var oe;const X=v[re.key]||"",U=k[re.key];switch(re.type){case"textarea":return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-body text-text-primary font-medium",children:[re.label,re.required&&e.jsx("span",{className:"text-status-error ml-1",children:"*"})]}),e.jsx("textarea",{value:X,onChange:xe=>_(J=>({...J,[re.key]:xe.target.value})),className:`w-full h-24 px-3 py-2 bg-bg-pure-black border rounded-sm text-body text-text-primary resize-none focus:outline-none focus:ring-2 focus:ring-accent-primary ${U?"border-status-error":"border-border-subtle"}`,placeholder:`Vnesite ${re.label.toLowerCase()}`,required:re.required,disabled:a==="view"}),U&&e.jsx("p",{className:"text-body-sm text-status-error",children:U})]},re.key);case"select":return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-body text-text-primary font-medium",children:[re.label,re.required&&e.jsx("span",{className:"text-status-error ml-1",children:"*"})]}),e.jsxs("select",{value:X,onChange:xe=>_(J=>({...J,[re.key]:xe.target.value})),className:`w-full px-3 py-2 bg-bg-pure-black border rounded-sm text-body text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary ${U?"border-status-error":"border-border-subtle"}`,required:re.required,disabled:a==="view",children:[e.jsxs("option",{value:"",children:["Izberite ",re.label.toLowerCase()]}),re.dataSource?(W[re.key]||[]).map(xe=>e.jsx("option",{value:xe[re.dataSource.idField],children:xe[re.dataSource.labelField]},xe[re.dataSource.idField])):(oe=re.options)==null?void 0:oe.map(xe=>e.jsx("option",{value:xe,children:Z(xe,re.key)},xe))]}),U&&e.jsx("p",{className:"text-body-sm text-status-error",children:U})]},re.key);case"date":return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-body text-text-primary font-medium",children:[re.label,re.required&&e.jsx("span",{className:"text-status-error ml-1",children:"*"})]}),e.jsx("input",{type:"date",value:X,onChange:xe=>_(J=>({...J,[re.key]:xe.target.value})),className:`w-full px-3 py-2 bg-bg-pure-black border rounded-sm text-body text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary ${U?"border-status-error":"border-border-subtle"}`,required:re.required,disabled:a==="view"}),U&&e.jsx("p",{className:"text-body-sm text-status-error",children:U})]},re.key);case"number":return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-body text-text-primary font-medium",children:[re.label,re.required&&e.jsx("span",{className:"text-status-error ml-1",children:"*"})]}),e.jsx("input",{type:"number",value:X,onChange:xe=>_(J=>({...J,[re.key]:xe.target.value})),className:`w-full px-3 py-2 bg-bg-pure-black border rounded-sm text-body text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary ${U?"border-status-error":"border-border-subtle"}`,placeholder:`Vnesite ${re.label.toLowerCase()}`,required:re.required,disabled:a==="view"}),U&&e.jsx("p",{className:"text-body-sm text-status-error",children:U})]},re.key);default:return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-body text-text-primary font-medium",children:[re.label,re.required&&e.jsx("span",{className:"text-status-error ml-1",children:"*"})]}),e.jsx("input",{type:"text",value:X,onChange:xe=>_(J=>({...J,[re.key]:xe.target.value})),className:`w-full px-3 py-2 bg-bg-pure-black border rounded-sm text-body text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary ${U?"border-status-error":"border-border-subtle"}`,placeholder:`Vnesite ${re.label.toLowerCase()}`,required:re.required,disabled:a==="view"}),U&&e.jsx("p",{className:"text-body-sm text-status-error",children:U})]},re.key)}},ce=re=>{const X=v[re.key]||"",U=X||"Ni podatka",oe=(xe,J,$)=>{if(xe==="Ni podatka")return xe;switch(J){case"select":return Z(xe,$||"");case"date":return xe?new Date(xe).toLocaleDateString("sl-SI"):"Ni podatka";default:return xe}};return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-body text-text-primary font-medium",children:[re.label,re.required&&e.jsx("span",{className:"text-status-error ml-1",children:"*"})]}),e.jsx("div",{className:"w-full min-h-[40px] px-3 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-body text-text-primary flex items-center",children:re.type==="textarea"?e.jsx("div",{className:"whitespace-pre-wrap break-words",children:oe(X,re.type,re.key)}):e.jsx("span",{children:oe(U,re.type,re.key)})})]},re.key)};return a==="delete"&&n?e.jsx(gi,{isOpen:s,onClose:t,onConfirm:S,title:i,message:`Ali ste prepriani, da elite izbrisati oceno tveganja "${n.risk_id||n.asset_name}"?`,isDeleting:b}):a==="view"?e.jsx(zs,{isOpen:s,onClose:t,title:i,children:e.jsxs("div",{className:"space-y-4 max-h-[70vh] overflow-y-auto",children:[c.map(ce),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-border-subtle",children:[e.jsxs("button",{type:"button",onClick:C,disabled:j||!n,className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 disabled:opacity-50 flex items-center gap-2",children:[e.jsx(Ir,{className:"w-4 h-4"}),j?"Ustvarjam PDF...":"PDF izvoz"]}),e.jsx("button",{type:"button",onClick:t,className:"h-10 px-4 bg-bg-near-black hover:bg-surface text-text-primary rounded-sm transition-colors duration-150",children:"Zapri"})]})]})}):e.jsx(zs,{isOpen:s,onClose:t,title:i,children:e.jsxs("form",{onSubmit:A,className:"space-y-4 max-h-[70vh] overflow-y-auto",children:[c.map(te),e.jsxs("div",{className:"flex items-center gap-3 justify-end pt-4 border-t border-border-subtle",children:[e.jsx("button",{type:"button",onClick:t,className:"h-10 px-4 bg-bg-near-black hover:bg-surface text-text-primary rounded-sm transition-colors duration-150",children:"Preklii"}),e.jsx("button",{type:"submit",disabled:m,className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 disabled:opacity-50",children:m?"Shranjujem...":"Shrani"})]})]})})}function Sn(){const{user:s}=cr(),[t,r]=z.useState(""),[a,n]=z.useState(!0);return z.useEffect(()=>{(async()=>{if(!s){n(!1);return}try{const{data:o,error:c}=await Ne.from("profiles").select("organization_id").eq("id",s.id).single();if(c)throw c;r((o==null?void 0:o.organization_id)||"")}catch(o){console.error("Error fetching organization_id:",o),r("")}finally{n(!1)}})()},[s]),{organizationId:t,loading:a}}function yD({isOpen:s,onClose:t,onSave:r}){const{t:a}=et(),{user:n}=cr(),{organizationId:i}=Sn(),[o,c]=z.useState(!1),[d,p]=z.useState({scope_name:"",scope_description:"",scope_boundaries:"",organizational_units:"",business_processes:"",information_types:"",systems_applications:"",third_party_interfaces:"",regulatory_requirements:"",exclusions:"",exclusion_justification:"",status:"draft",responsible_person:"",effective_date:"",review_date:"",connection_risk_assessment:"",connection_soa:"",connection_policies:"",organization_id:i||""}),[m,x]=z.useState({}),[b,h]=z.useState(null);z.useEffect(()=>{(async()=>{if(!(!n||!s))try{const{data:P,error:L}=await Ne.from("profiles").select("*, organization_id").eq("id",n.id).single();if(L)throw L;h(P)}catch(P){console.error("Error fetching user profile:",P)}})()},[n,s]),z.useEffect(()=>{s&&(b!=null&&b.organization_id)&&p(k=>({...k,organization_id:b.organization_id}))},[s,b]);const j=()=>{p({scope_name:"",scope_description:"",scope_boundaries:"",organizational_units:"",business_processes:"",information_types:"",systems_applications:"",third_party_interfaces:"",regulatory_requirements:"",exclusions:"",exclusion_justification:"",status:"draft",responsible_person:"",effective_date:"",review_date:"",connection_risk_assessment:"",connection_soa:"",connection_policies:"",organization_id:i||""}),x({})},g=()=>{j(),t()},v=()=>{var P,L,F,W,R,B,A;const k={};return(P=d.scope_name)!=null&&P.trim()||(k.scope_name="Naziv obsega je obvezno polje"),(L=d.scope_description)!=null&&L.trim()||(k.scope_description="Opis obsega je obvezno polje"),(F=d.scope_boundaries)!=null&&F.trim()||(k.scope_boundaries="Mejne opredelitve so obvezno polje"),(W=d.organizational_units)!=null&&W.trim()||(k.organizational_units="Organizacijske enote so obvezno polje"),(R=d.responsible_person)!=null&&R.trim()||(k.responsible_person="Odgovorna oseba je obvezno polje"),(B=d.effective_date)!=null&&B.trim()||(k.effective_date="Datum veljavnosti je obvezno polje"),(A=d.review_date)!=null&&A.trim()||(k.review_date="Datum pregleda je obvezno polje"),b!=null&&b.organization_id||(k.organization_id="Organizacijski kontekst ni na voljo"),x(k),Object.keys(k).length===0},_=async k=>{if(k.preventDefault(),!!v()){c(!0);try{const{error:P}=await Ne.from("isms_scope").insert([{...d,organization_id:b.organization_id}]);if(P)throw P.code==="23502"?new Error("Nekatera obvezna polja niso izpolnjena"):P.code==="23505"?new Error("Vrednost e obstaja"):P;r(),g()}catch(P){console.error("Error creating ISMS scope:",P),alert(P.message||"Prilo je do napake pri ustvarjanju obsega")}finally{c(!1)}}};return s?e.jsx(zs,{isOpen:s,onClose:g,title:"Dodaj nov obseg ISMS",children:e.jsxs("form",{onSubmit:_,className:"space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-body font-medium text-text-primary border-b border-border-subtle pb-2",children:"Osnovne informacije"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-body text-text-primary font-medium",children:["Naziv obsega ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"text",value:d.scope_name,onChange:k=>p(P=>({...P,scope_name:k.target.value})),className:`w-full px-3 py-2 bg-bg-pure-black border rounded-sm text-body text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary ${m.scope_name?"border-status-error":"border-border-subtle"}`,placeholder:"Vnesite naziv obsega",required:!0}),m.scope_name&&e.jsx("p",{className:"text-body-sm text-status-error",children:m.scope_name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-body text-text-primary font-medium",children:["Opis obsega ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("textarea",{value:d.scope_description,onChange:k=>p(P=>({...P,scope_description:k.target.value})),className:`w-full h-24 px-3 py-2 bg-bg-pure-black border rounded-sm text-body text-text-primary resize-none focus:outline-none focus:ring-2 focus:ring-accent-primary ${m.scope_description?"border-status-error":"border-border-subtle"}`,placeholder:"Podroben opis obsega ISMS",required:!0}),m.scope_description&&e.jsx("p",{className:"text-body-sm text-status-error",children:m.scope_description})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-body text-text-primary font-medium",children:["Mejne opredelitve ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("textarea",{value:d.scope_boundaries,onChange:k=>p(P=>({...P,scope_boundaries:k.target.value})),className:`w-full h-24 px-3 py-2 bg-bg-pure-black border rounded-sm text-body text-text-primary resize-none focus:outline-none focus:ring-2 focus:ring-accent-primary ${m.scope_boundaries?"border-status-error":"border-border-subtle"}`,placeholder:"Fizine, organizacijske, informacijske in pogodbene meje",required:!0}),m.scope_boundaries&&e.jsx("p",{className:"text-body-sm text-status-error",children:m.scope_boundaries})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-body text-text-primary font-medium",children:["Organizacijske enote ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("textarea",{value:d.organizational_units,onChange:k=>p(P=>({...P,organizational_units:k.target.value})),className:`w-full h-24 px-3 py-2 bg-bg-pure-black border rounded-sm text-body text-text-primary resize-none focus:outline-none focus:ring-2 focus:ring-accent-primary ${m.organizational_units?"border-status-error":"border-border-subtle"}`,placeholder:"Katere enote, oddelki, podrunice so vkljuene",required:!0}),m.organizational_units&&e.jsx("p",{className:"text-body-sm text-status-error",children:m.organizational_units})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-body font-medium text-text-primary border-b border-border-subtle pb-2",children:"Podrobne informacije"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-body text-text-primary font-medium",children:"Poslovni procesi"}),e.jsx("textarea",{value:d.business_processes,onChange:k=>p(P=>({...P,business_processes:k.target.value})),className:"w-full h-20 px-3 py-2 bg-bg-pure-black border border-border-subtle rounded-sm text-body text-text-primary resize-none focus:outline-none focus:ring-2 focus:ring-accent-primary",placeholder:"Kljuni procesi, ki ustvarjajo/obdelujejo varovane informacije"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-body text-text-primary font-medium",children:"Tipi informacij"}),e.jsx("textarea",{value:d.information_types,onChange:k=>p(P=>({...P,information_types:k.target.value})),className:"w-full h-20 px-3 py-2 bg-bg-pure-black border border-border-subtle rounded-sm text-body text-text-primary resize-none focus:outline-none focus:ring-2 focus:ring-accent-primary",placeholder:"Katere informacije so predmet varstva (osebni podatki, intelektualna lastnina, itd.)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-body text-text-primary font-medium",children:"Sistemi in aplikacije"}),e.jsx("textarea",{value:d.systems_applications,onChange:k=>p(P=>({...P,systems_applications:k.target.value})),className:"w-full h-20 px-3 py-2 bg-bg-pure-black border border-border-subtle rounded-sm text-body text-text-primary resize-none focus:outline-none focus:ring-2 focus:ring-accent-primary",placeholder:"Kljuni sistemi, aplikacije, segmenti omreij"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-body text-text-primary font-medium",children:"Vmesniki do tretjih oseb"}),e.jsx("textarea",{value:d.third_party_interfaces,onChange:k=>p(P=>({...P,third_party_interfaces:k.target.value})),className:"w-full h-20 px-3 py-2 bg-bg-pure-black border border-border-subtle rounded-sm text-body text-text-primary resize-none focus:outline-none focus:ring-2 focus:ring-accent-primary",placeholder:"Oblak/SaaS, IDaaS, kolokacije, integracije"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-body text-text-primary font-medium",children:"Regulatorne zahteve"}),e.jsx("textarea",{value:d.regulatory_requirements,onChange:k=>p(P=>({...P,regulatory_requirements:k.target.value})),className:"w-full h-20 px-3 py-2 bg-bg-pure-black border border-border-subtle rounded-sm text-body text-text-primary resize-none focus:outline-none focus:ring-2 focus:ring-accent-primary",placeholder:"Zakoni, predpisi, pogodbe, ki vplivajo na obseg"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-body font-medium text-text-primary border-b border-border-subtle pb-2",children:"Izkljuitve (e obstajajo)"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-body text-text-primary font-medium",children:"Izkljuitve"}),e.jsx("textarea",{value:d.exclusions,onChange:k=>p(P=>({...P,exclusions:k.target.value})),className:"w-full h-20 px-3 py-2 bg-bg-pure-black border border-border-subtle rounded-sm text-body text-text-primary resize-none focus:outline-none focus:ring-2 focus:ring-accent-primary",placeholder:"Kaj je izven obsega in zakaj"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-body text-text-primary font-medium",children:"Utemeljitev izkljuitve"}),e.jsx("textarea",{value:d.exclusion_justification,onChange:k=>p(P=>({...P,exclusion_justification:k.target.value})),className:"w-full h-20 px-3 py-2 bg-bg-pure-black border border-border-subtle rounded-sm text-body text-text-primary resize-none focus:outline-none focus:ring-2 focus:ring-accent-primary",placeholder:"Razlogi in kontrolni vmesniki za izkljuitve"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-body font-medium text-text-primary border-b border-border-subtle pb-2",children:"Upravljavske informacije"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-body text-text-primary font-medium",children:"Status"}),e.jsxs("select",{value:d.status,onChange:k=>p(P=>({...P,status:k.target.value})),className:"w-full px-3 py-2 bg-bg-pure-black border border-border-subtle rounded-sm text-body text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",children:[e.jsx("option",{value:"draft",children:"Osnutek"}),e.jsx("option",{value:"under_review",children:"V pregledu"}),e.jsx("option",{value:"approved",children:"Odobren"}),e.jsx("option",{value:"active",children:"Aktiven"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-body text-text-primary font-medium",children:["Odgovorna oseba ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"text",value:d.responsible_person,onChange:k=>p(P=>({...P,responsible_person:k.target.value})),className:`w-full px-3 py-2 bg-bg-pure-black border rounded-sm text-body text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary ${m.responsible_person?"border-status-error":"border-border-subtle"}`,placeholder:"Ime odgovorne osebe",required:!0}),m.responsible_person&&e.jsx("p",{className:"text-body-sm text-status-error",children:m.responsible_person})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-body text-text-primary font-medium",children:["Datum veljavnosti ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"date",value:d.effective_date,onChange:k=>p(P=>({...P,effective_date:k.target.value})),className:`w-full px-3 py-2 bg-bg-pure-black border rounded-sm text-body text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary ${m.effective_date?"border-status-error":"border-border-subtle"}`,required:!0}),m.effective_date&&e.jsx("p",{className:"text-body-sm text-status-error",children:m.effective_date})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-body text-text-primary font-medium",children:["Datum pregleda ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"date",value:d.review_date,onChange:k=>p(P=>({...P,review_date:k.target.value})),className:`w-full px-3 py-2 bg-bg-pure-black border rounded-sm text-body text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary ${m.review_date?"border-status-error":"border-border-subtle"}`,required:!0}),m.review_date&&e.jsx("p",{className:"text-body-sm text-status-error",children:m.review_date})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-body font-medium text-text-primary border-b border-border-subtle pb-2",children:"Povezave z drugimi dokumenti"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-body text-text-primary font-medium",children:"Povezava z RA"}),e.jsx("input",{type:"text",value:d.connection_risk_assessment,onChange:k=>p(P=>({...P,connection_risk_assessment:k.target.value})),className:"w-full px-3 py-2 bg-bg-pure-black border border-border-subtle rounded-sm text-body text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",placeholder:"Referenca na oceno tveganj"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-body text-text-primary font-medium",children:"Povezava s SoA"}),e.jsx("input",{type:"text",value:d.connection_soa,onChange:k=>p(P=>({...P,connection_soa:k.target.value})),className:"w-full px-3 py-2 bg-bg-pure-black border border-border-subtle rounded-sm text-body text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",placeholder:"Referenca na izjavo o uporabnosti"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-body text-text-primary font-medium",children:"Povezava s politikami"}),e.jsx("input",{type:"text",value:d.connection_policies,onChange:k=>p(P=>({...P,connection_policies:k.target.value})),className:"w-full px-3 py-2 bg-bg-pure-black border border-border-subtle rounded-sm text-body text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",placeholder:"Referenca na povezane politike"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 justify-end pt-4 border-t border-border-subtle",children:[e.jsx("button",{type:"button",onClick:g,className:"h-10 px-4 bg-bg-near-black hover:bg-surface text-text-primary rounded-sm transition-colors duration-150",children:"Preklii"}),e.jsx("button",{type:"submit",disabled:o,className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 disabled:opacity-50",children:o?"Shranjujem...":"Shrani"})]})]})}):null}function jD({isOpen:s,onClose:t,onSave:r}){const{t:a}=et(),{user:n}=cr(),{organizationId:i}=Sn(),[o,c]=z.useState(!1),[d,p]=z.useState({policy_name:"",policy_type:"",policy_description:"",scope_of_application:"",policy_objectives:"",policy_requirements:"",roles_and_responsibilities:"",compliance_requirements:"",implementation_guidelines:"",monitoring_requirements:"",review_procedures:"",version:"1.0",status:"draft",effective_date:"",review_date:"",approval_authority:"",connection_policies:"",connection_procedures:"",connection_risk_assessment:"",connection_soa:"",organization_id:i||""}),[m,x]=z.useState({}),[b,h]=z.useState(null);z.useEffect(()=>{(async()=>{if(!(!n||!s))try{const{data:P,error:L}=await Ne.from("profiles").select("*, organization_id").eq("id",n.id).single();if(L)throw L;h(P)}catch(P){console.error("Error fetching user profile:",P)}})()},[n,s]),z.useEffect(()=>{s&&(b!=null&&b.organization_id)&&p(k=>({...k,organization_id:b.organization_id}))},[s,b]);const j=()=>{p({policy_name:"",policy_type:"",policy_description:"",scope_of_application:"",policy_objectives:"",policy_requirements:"",roles_and_responsibilities:"",compliance_requirements:"",implementation_guidelines:"",monitoring_requirements:"",review_procedures:"",version:"1.0",status:"draft",effective_date:"",review_date:"",approval_authority:"",connection_policies:"",connection_procedures:"",connection_risk_assessment:"",connection_soa:"",organization_id:i||""}),x({})},g=()=>{j(),t()},v=()=>{var P,L,F,W,R,B,A,S,C,O,Z;const k={};return(P=d.policy_name)!=null&&P.trim()||(k.policy_name="Naziv politike je obvezno polje"),(L=d.policy_type)!=null&&L.trim()||(k.policy_type="Tip politike je obvezno polje"),(F=d.policy_description)!=null&&F.trim()||(k.policy_description="Opis politike je obvezno polje"),(W=d.scope_of_application)!=null&&W.trim()||(k.scope_of_application="Podroje uporabe je obvezno polje"),(R=d.policy_objectives)!=null&&R.trim()||(k.policy_objectives="Cilji politike so obvezno polje"),(B=d.policy_requirements)!=null&&B.trim()||(k.policy_requirements="Zahteve politike so obvezno polje"),(A=d.roles_and_responsibilities)!=null&&A.trim()||(k.roles_and_responsibilities="Vloge in odgovornosti so obvezno polje"),(S=d.version)!=null&&S.trim()||(k.version="Verzija je obvezno polje"),(C=d.approval_authority)!=null&&C.trim()||(k.approval_authority="Avtor odobritve je obvezno polje"),(O=d.effective_date)!=null&&O.trim()||(k.effective_date="Datum veljavnosti je obvezno polje"),(Z=d.review_date)!=null&&Z.trim()||(k.review_date="Datum pregleda je obvezno polje"),b!=null&&b.organization_id||(k.organization_id="Organizacijski kontekst ni na voljo"),x(k),Object.keys(k).length===0},_=async k=>{if(k.preventDefault(),!!v()){c(!0);try{const{error:P}=await Ne.from("information_security_policy").insert([{...d,organization_id:b.organization_id}]);if(P)throw P.code==="23502"?new Error("Nekatera obvezna polja niso izpolnjena"):P.code==="23505"?new Error("Vrednost e obstaja"):P;r(),g()}catch(P){console.error("Error creating information security policy:",P),alert(P.message||"Prilo je do napake pri ustvarjanju politike")}finally{c(!1)}}};return s?e.jsx(zs,{isOpen:s,onClose:g,title:"Dodaj novo politiko informacijske varnosti",children:e.jsxs("form",{onSubmit:_,className:"space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-body font-medium text-text-primary border-b border-border-subtle pb-2",children:"Osnovne informacije"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-body text-text-primary font-medium",children:["Naziv politike ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"text",value:d.policy_name,onChange:k=>p(P=>({...P,policy_name:k.target.value})),className:`w-full px-3 py-2 bg-bg-pure-black border rounded-sm text-body text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary ${m.policy_name?"border-status-error":"border-border-subtle"}`,placeholder:"Vnesite naziv politike",required:!0}),m.policy_name&&e.jsx("p",{className:"text-body-sm text-status-error",children:m.policy_name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-body text-text-primary font-medium",children:["Tip politike ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsxs("select",{value:d.policy_type,onChange:k=>p(P=>({...P,policy_type:k.target.value})),className:`w-full px-3 py-2 bg-bg-pure-black border rounded-sm text-body text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary ${m.policy_type?"border-status-error":"border-border-subtle"}`,required:!0,children:[e.jsx("option",{value:"",children:"Izberite tip politike"}),e.jsx("option",{value:"information_security_general",children:"Splona varnost informacij"}),e.jsx("option",{value:"access_control",children:"Kontrola dostopa"}),e.jsx("option",{value:"data_protection",children:"Varstvo podatkov"}),e.jsx("option",{value:"incident_response",children:"Obvladovanje incidentov"}),e.jsx("option",{value:"business_continuity",children:"Kontinuiteta poslovanja"}),e.jsx("option",{value:"supplier_security",children:"Varnost dobaviteljev"}),e.jsx("option",{value:"physical_security",children:"Fizina varnost"}),e.jsx("option",{value:"human_resources",children:"loveki viri"}),e.jsx("option",{value:"risk_management",children:"Upravljanje tveganj"}),e.jsx("option",{value:"compliance",children:"Skladnost"})]}),m.policy_type&&e.jsx("p",{className:"text-body-sm text-status-error",children:m.policy_type})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-body text-text-primary font-medium",children:["Opis politike ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("textarea",{value:d.policy_description,onChange:k=>p(P=>({...P,policy_description:k.target.value})),className:`w-full h-24 px-3 py-2 bg-bg-pure-black border rounded-sm text-body text-text-primary resize-none focus:outline-none focus:ring-2 focus:ring-accent-primary ${m.policy_description?"border-status-error":"border-border-subtle"}`,placeholder:"Podroben opis namena in ciljev politike",required:!0}),m.policy_description&&e.jsx("p",{className:"text-body-sm text-status-error",children:m.policy_description})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-body text-text-primary font-medium",children:["Podroje uporabe ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("textarea",{value:d.scope_of_application,onChange:k=>p(P=>({...P,scope_of_application:k.target.value})),className:`w-full h-24 px-3 py-2 bg-bg-pure-black border rounded-sm text-body text-text-primary resize-none focus:outline-none focus:ring-2 focus:ring-accent-primary ${m.scope_of_application?"border-status-error":"border-border-subtle"}`,placeholder:"Katere sisteme, procese in osebe politika zajema",required:!0}),m.scope_of_application&&e.jsx("p",{className:"text-body-sm text-status-error",children:m.scope_of_application})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-body font-medium text-text-primary border-b border-border-subtle pb-2",children:"Vsebina politike"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-body text-text-primary font-medium",children:["Cilji politike ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("textarea",{value:d.policy_objectives,onChange:k=>p(P=>({...P,policy_objectives:k.target.value})),className:`w-full h-24 px-3 py-2 bg-bg-pure-black border rounded-sm text-body text-text-primary resize-none focus:outline-none focus:ring-2 focus:ring-accent-primary ${m.policy_objectives?"border-status-error":"border-border-subtle"}`,placeholder:"Kaj politika eli dosei - specifini, merljivi cilji",required:!0}),m.policy_objectives&&e.jsx("p",{className:"text-body-sm text-status-error",children:m.policy_objectives})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-body text-text-primary font-medium",children:["Zahteve politike ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("textarea",{value:d.policy_requirements,onChange:k=>p(P=>({...P,policy_requirements:k.target.value})),className:`w-full h-32 px-3 py-2 bg-bg-pure-black border rounded-sm text-body text-text-primary resize-none focus:outline-none focus:ring-2 focus:ring-accent-primary ${m.policy_requirements?"border-status-error":"border-border-subtle"}`,placeholder:"Specifine zahteve, ki jih morajo organizacije izpolnjevati",required:!0}),m.policy_requirements&&e.jsx("p",{className:"text-body-sm text-status-error",children:m.policy_requirements})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-body text-text-primary font-medium",children:["Vloge in odgovornosti ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("textarea",{value:d.roles_and_responsibilities,onChange:k=>p(P=>({...P,roles_and_responsibilities:k.target.value})),className:`w-full h-24 px-3 py-2 bg-bg-pure-black border rounded-sm text-body text-text-primary resize-none focus:outline-none focus:ring-2 focus:ring-accent-primary ${m.roles_and_responsibilities?"border-status-error":"border-border-subtle"}`,placeholder:"Kdo je odgovoren za kaj - vloge, pooblastila, odgovornosti",required:!0}),m.roles_and_responsibilities&&e.jsx("p",{className:"text-body-sm text-status-error",children:m.roles_and_responsibilities})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-body text-text-primary font-medium",children:"Zahteve skladnosti"}),e.jsx("textarea",{value:d.compliance_requirements,onChange:k=>p(P=>({...P,compliance_requirements:k.target.value})),className:"w-full h-20 px-3 py-2 bg-bg-pure-black border border-border-subtle rounded-sm text-body text-text-primary resize-none focus:outline-none focus:ring-2 focus:ring-accent-primary",placeholder:"Zakoni, predpisi, standardi, ki jih je treba upotevati"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-body font-medium text-text-primary border-b border-border-subtle pb-2",children:"Izvajanje in spremljanje"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-body text-text-primary font-medium",children:"Navodila za izvajanje"}),e.jsx("textarea",{value:d.implementation_guidelines,onChange:k=>p(P=>({...P,implementation_guidelines:k.target.value})),className:"w-full h-20 px-3 py-2 bg-bg-pure-black border border-border-subtle rounded-sm text-body text-text-primary resize-none focus:outline-none focus:ring-2 focus:ring-accent-primary",placeholder:"Kako politiko implementirati - koraki, orodja, postopki"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-body text-text-primary font-medium",children:"Zahteve spremljanja"}),e.jsx("textarea",{value:d.monitoring_requirements,onChange:k=>p(P=>({...P,monitoring_requirements:k.target.value})),className:"w-full h-20 px-3 py-2 bg-bg-pure-black border border-border-subtle rounded-sm text-body text-text-primary resize-none focus:outline-none focus:ring-2 focus:ring-accent-primary",placeholder:"Kako spremljati skladnost s politiko - metrije, KPI, poroanje"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-body text-text-primary font-medium",children:"Postopki pregleda"}),e.jsx("textarea",{value:d.review_procedures,onChange:k=>p(P=>({...P,review_procedures:k.target.value})),className:"w-full h-20 px-3 py-2 bg-bg-pure-black border border-border-subtle rounded-sm text-body text-text-primary resize-none focus:outline-none focus:ring-2 focus:ring-accent-primary",placeholder:"Kako pogosto in na kaken nain se politika pregleda in posodobi"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-body font-medium text-text-primary border-b border-border-subtle pb-2",children:"Upravljavske informacije"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-body text-text-primary font-medium",children:["Verzija ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"text",value:d.version,onChange:k=>p(P=>({...P,version:k.target.value})),className:`w-full px-3 py-2 bg-bg-pure-black border rounded-sm text-body text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary ${m.version?"border-status-error":"border-border-subtle"}`,placeholder:"n.m",required:!0}),m.version&&e.jsx("p",{className:"text-body-sm text-status-error",children:m.version})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-body text-text-primary font-medium",children:"Status"}),e.jsxs("select",{value:d.status,onChange:k=>p(P=>({...P,status:k.target.value})),className:"w-full px-3 py-2 bg-bg-pure-black border border-border-subtle rounded-sm text-body text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",children:[e.jsx("option",{value:"draft",children:"Osnutek"}),e.jsx("option",{value:"under_review",children:"V pregledu"}),e.jsx("option",{value:"approved",children:"Odobren"}),e.jsx("option",{value:"active",children:"Aktiven"}),e.jsx("option",{value:"retired",children:"Povleen"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-body text-text-primary font-medium",children:["Avtor odobritve ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"text",value:d.approval_authority,onChange:k=>p(P=>({...P,approval_authority:k.target.value})),className:`w-full px-3 py-2 bg-bg-pure-black border rounded-sm text-body text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary ${m.approval_authority?"border-status-error":"border-border-subtle"}`,placeholder:"Ime in priimek",required:!0}),m.approval_authority&&e.jsx("p",{className:"text-body-sm text-status-error",children:m.approval_authority})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-body text-text-primary font-medium",children:["Datum veljavnosti ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"date",value:d.effective_date,onChange:k=>p(P=>({...P,effective_date:k.target.value})),className:`w-full px-3 py-2 bg-bg-pure-black border rounded-sm text-body text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary ${m.effective_date?"border-status-error":"border-border-subtle"}`,required:!0}),m.effective_date&&e.jsx("p",{className:"text-body-sm text-status-error",children:m.effective_date})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-body text-text-primary font-medium",children:["Datum pregleda ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"date",value:d.review_date,onChange:k=>p(P=>({...P,review_date:k.target.value})),className:`w-full px-3 py-2 bg-bg-pure-black border rounded-sm text-body text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary ${m.review_date?"border-status-error":"border-border-subtle"}`,required:!0}),m.review_date&&e.jsx("p",{className:"text-body-sm text-status-error",children:m.review_date})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-body font-medium text-text-primary border-b border-border-subtle pb-2",children:"Povezave z drugimi dokumenti"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-body text-text-primary font-medium",children:"Povezane politike"}),e.jsx("input",{type:"text",value:d.connection_policies,onChange:k=>p(P=>({...P,connection_policies:k.target.value})),className:"w-full px-3 py-2 bg-bg-pure-black border border-border-subtle rounded-sm text-body text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",placeholder:"Referenca na povezane politike"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-body text-text-primary font-medium",children:"Povezani postopki"}),e.jsx("input",{type:"text",value:d.connection_procedures,onChange:k=>p(P=>({...P,connection_procedures:k.target.value})),className:"w-full px-3 py-2 bg-bg-pure-black border border-border-subtle rounded-sm text-body text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",placeholder:"Referenca na povezane postopke"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-body text-text-primary font-medium",children:"Povezana ocena tveganj"}),e.jsx("input",{type:"text",value:d.connection_risk_assessment,onChange:k=>p(P=>({...P,connection_risk_assessment:k.target.value})),className:"w-full px-3 py-2 bg-bg-pure-black border border-border-subtle rounded-sm text-body text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",placeholder:"Referenca na oceno tveganj"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-body text-text-primary font-medium",children:"Povezana izjava o uporabnosti"}),e.jsx("input",{type:"text",value:d.connection_soa,onChange:k=>p(P=>({...P,connection_soa:k.target.value})),className:"w-full px-3 py-2 bg-bg-pure-black border border-border-subtle rounded-sm text-body text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",placeholder:"Referenca na izjavo o uporabnosti"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 justify-end pt-4 border-t border-border-subtle",children:[e.jsx("button",{type:"button",onClick:g,className:"h-10 px-4 bg-bg-near-black hover:bg-surface text-text-primary rounded-sm transition-colors duration-150",children:"Preklii"}),e.jsx("button",{type:"submit",disabled:o,className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 disabled:opacity-50",children:o?"Shranjujem...":"Shrani"})]})]})}):null}const _D=[{key:"control_id",label:"ID kontrole",type:"text",required:!0},{key:"control_name",label:"Naziv kontrole",type:"text",required:!0},{key:"control_category",label:"Kategorija kontrole",type:"select",required:!0,options:["A.5 - Varnostne politike","A.6 - Organizacija varnosti informacij","A.7 - loveki viri","A.8 - Upravljanje s sredstvi","A.9 - Nadzor dostopa","A.10 - Kriptografija","A.11 - Fizina in okoljska varnost","A.12 - Varnost operacij","A.13 - Varnost komunikacij","A.14 - Pridobivanje, razvoj in vzdrevanje sistemov","A.15 - Odnosi z dobavitelji","A.16 - Upravljanje incidentov","A.17 - Vidiki informacijske varnosti pri upravljanju poslovne kontinuitete","A.18 - Skladnost"]},{key:"description",label:"Opis kontrole",type:"textarea",required:!0},{key:"implementation_status",label:"Status implementacije",type:"select",required:!0,options:["implemented","partially_implemented","not_implemented"]},{key:"responsible_person",label:"Odgovorna oseba",type:"text"},{key:"effectiveness",label:"Uinkovitost",type:"select",options:["high","medium","low"]},{key:"last_review_date",label:"Datum zadnjega pregleda",type:"date"},{key:"notes",label:"Opombe",type:"textarea"}];function kD({isOpen:s,onClose:t,onSave:r}){const{organizationId:a}=Sn();return e.jsx(ha,{isOpen:s,onClose:t,onSave:r,title:"Dodaj novo kontrolo",table:"iso_controls_management",fields:[..._D,{key:"organization_id",label:"ID organizacije",type:"text",required:!0}],defaultValues:{organization_id:a}})}const ND=[{key:"risk_id",label:"ID tveganja",type:"text",required:!0},{key:"asset_name",label:"Naziv sredstva",type:"text",required:!0},{key:"threat_description",label:"Opis gronje",type:"textarea",required:!0},{key:"vulnerability_description",label:"Opis ranljivosti",type:"textarea"},{key:"likelihood",label:"Verjetnost",type:"select",required:!0,options:["very_low","low","medium","high","very_high"]},{key:"impact",label:"Vpliv",type:"select",required:!0,options:["very_low","low","medium","high","very_high"]},{key:"risk_level",label:"Nivo tveganja",type:"select",required:!0,options:["low","medium","high","critical"]},{key:"mitigation_strategy",label:"Strategija za zmanjanje",type:"textarea"},{key:"residual_risk",label:"Preostalo tveganje",type:"select",options:["low","medium","high","critical"]},{key:"owner",label:"Lastnik",type:"text"},{key:"review_date",label:"Datum pregleda",type:"date"}];function wD({isOpen:s,onClose:t,onSave:r}){const{organizationId:a}=Sn();return e.jsx(ha,{isOpen:s,onClose:t,onSave:r,title:"Dodaj novo oceno tveganja",table:"iso_risk_assessment",fields:[...ND,{key:"organization_id",label:"ID organizacije",type:"text",required:!0}],defaultValues:{organization_id:a}})}const SD=[{key:"incident_id",label:"ID incidenta",type:"text",required:!0},{key:"incident_type",label:"Tip incidenta",type:"select",required:!0,options:["malware","phishing","data_breach","unauthorized_access","ddos","social_engineering","insider_threat","physical_security","system_failure","other"]},{key:"detection_date",label:"Datum zaznave",type:"datetime",required:!0},{key:"severity",label:"Resnost",type:"select",required:!0,options:["low","medium","high","critical"]},{key:"description",label:"Opis incidenta",type:"textarea",required:!0},{key:"affected_systems",label:"Prizadeti sistemi",type:"textarea"},{key:"response_actions",label:"Ukrepi odziva",type:"textarea"},{key:"status",label:"Status",type:"select",options:["open","investigating","contained","resolved","closed"]},{key:"closed_date",label:"Datum zaprtja",type:"datetime"},{key:"lessons_learned",label:"Pridobljene izkunje",type:"textarea"}];function zD({isOpen:s,onClose:t,onSave:r}){const{organizationId:a}=Sn();return e.jsx(ha,{isOpen:s,onClose:t,onSave:r,title:"Dodaj nov incident",table:"iso_incident_response",fields:[...SD,{key:"organization_id",label:"ID organizacije",type:"text",required:!0}],defaultValues:{organization_id:a}})}function CD({isOpen:s,onClose:t,onSave:r}){const{t:a}=et(),{organizationId:n}=Sn(),i=[{key:"asset_id",label:a("iso.assets.assetId"),type:"text",required:!0},{key:"asset_name",label:a("iso.assets.assetName"),type:"text",required:!0},{key:"asset_type",label:a("iso.assets.assetType"),type:"select",required:!0,options:["hardware","software","data","service","facility","human_resource","intellectual_property","reputation","business_process"]},{key:"owner",label:a("iso.assets.owner"),type:"text",required:!0},{key:"classification",label:a("iso.assets.classification"),type:"select",required:!0,options:["public","internal","confidential","restricted"]},{key:"location",label:"Lokacija",type:"text"},{key:"value_rating",label:"Ocenjena vrednost",type:"select",options:["very_low","low","medium","high","very_high"]},{key:"risk_level",label:a("iso.risk.riskLevel"),type:"select",options:["low","medium","high","critical"]},{key:"last_assessment_date",label:"Datum zadnjega pregleda",type:"date"}];return e.jsx(ha,{isOpen:s,onClose:t,onSave:r,title:a("iso.assets.addAsset"),table:"iso_asset_management",fields:[...i,{key:"organization_id",label:"ID organizacije",type:"text",required:!0}],defaultValues:{organization_id:n}})}const PD=[{key:"audit_id",label:"ID revizije",type:"text",required:!0},{key:"audit_type",label:"Tip revizije",type:"select",required:!0,options:["internal","external","compliance","security","quality","risk_management","business_continuity"]},{key:"audit_date",label:"Datum revizije",type:"date",required:!0},{key:"auditor_name",label:"Ime revizorja",type:"text",required:!0},{key:"scope",label:"Obseg revizije",type:"textarea",required:!0},{key:"findings",label:"Ugotovitve",type:"textarea"},{key:"recommendations",label:"Priporoila",type:"textarea"},{key:"severity",label:"Resnost",type:"select",options:["low","medium","high","critical"]},{key:"status",label:"Status",type:"select",options:["open","in_progress","resolved","closed"]},{key:"remediation_plan",label:"Nart odprave",type:"textarea"},{key:"due_date",label:"Rok za odpravljanje",type:"date"}];function AD({isOpen:s,onClose:t,onSave:r}){const{organizationId:a}=Sn();return e.jsx(ha,{isOpen:s,onClose:t,onSave:r,title:"Dodaj novo revizijo",table:"iso_audit_log",fields:[...PD,{key:"organization_id",label:"ID organizacije",type:"text",required:!0}],defaultValues:{organization_id:a}})}const OD=[{key:"certification_id",label:"ID certifikacije",type:"text",required:!0},{key:"certification_body",label:"Certifikacijski organ",type:"text",required:!0},{key:"certification_date",label:"Datum certifikacije",type:"date",required:!0},{key:"expiry_date",label:"Datum poteka",type:"date",required:!0},{key:"scope",label:"Obseg certifikacije",type:"textarea",required:!0},{key:"status",label:"Status",type:"select",options:["active","suspended","expired","revoked","under_review"]},{key:"certificate_number",label:"tevilka certifikata",type:"text"},{key:"next_audit_date",label:"Datum naslednje revizije",type:"date"},{key:"notes",label:"Opombe",type:"textarea"}];function DD({isOpen:s,onClose:t,onSave:r}){const{organizationId:a}=Sn();return e.jsx(ha,{isOpen:s,onClose:t,onSave:r,title:"Dodaj novo certifikacijo",table:"iso_certification_status",fields:[...OD,{key:"organization_id",label:"ID organizacije",type:"text",required:!0}],defaultValues:{organization_id:a}})}const ED=[{key:"compliance_id",label:"ID skladnosti",type:"text",required:!0},{key:"requirement_name",label:"Naziv zahteve",type:"text",required:!0},{key:"standard_reference",label:"Referenca standarda",type:"text",required:!0},{key:"compliance_status",label:"Status skladnosti",type:"select",options:["compliant","partially_compliant","non_compliant","under_review","not_applicable"]},{key:"last_assessment_date",label:"Datum zadnjega pregleda",type:"date"},{key:"next_review_date",label:"Datum naslednjega pregleda",type:"date"},{key:"evidence",label:"Dokazila",type:"textarea"},{key:"gaps_identified",label:"Ugotovljene vrzeli",type:"textarea"},{key:"action_plan",label:"Akcijski nart",type:"textarea"}];function ID({isOpen:s,onClose:t,onSave:r}){const{organizationId:a}=Sn();return e.jsx(ha,{isOpen:s,onClose:t,onSave:r,title:"Dodaj novo skladnost",table:"iso_compliance_tracking",fields:[...ED,{key:"organization_id",label:"ID organizacije",type:"text",required:!0}],defaultValues:{organization_id:a}})}function LD({isOpen:s,onClose:t,onSave:r,control:a,organizationId:n,mode:i="edit"}){const[o,c]=z.useState({}),[d,p]=z.useState(!1),[m,x]=z.useState(null);z.useEffect(()=>{a&&c({...a,implementation_date:a.implementation_date||"",last_review_date:a.last_review_date||new Date().toISOString().split("T")[0]})},[a]);const b=(j,g)=>{c(v=>({...v,[j]:g}))},h=async j=>{if(j.preventDefault(),!(!a||!n)){p(!0),x(null);try{const g={status:o.status||"not_implemented",justification:o.justification||"Kontrola e ni bila ocenjena.",isms_scope_reference:o.isms_scope_reference||null,risk_reference:o.risk_reference||null,legal_requirements:o.legal_requirements||null,policy_references:o.policy_references||null,control_owner:o.control_owner||null,implementation_date:o.implementation_date||null,last_review_date:o.last_review_date||new Date().toISOString().split("T")[0],related_controls:o.related_controls||null,evidence:o.evidence||null},{error:v}=await Ne.from("soa_controls").update(g).eq("id",a.id).eq("organization_id",n);if(v)throw v;r()}catch(g){console.error("Error updating control:",g),x(g.message||"Prilo je do napake pri shranjevanju")}finally{p(!1)}}};return!s||!a?null:e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-bg-surface rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-border-subtle",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-heading-lg font-semibold text-text-primary",children:[i==="view"?"Ogled kontrole":"Urejanje kontrole"," - ",a.control_id]}),e.jsxs("p",{className:"text-body-sm text-text-secondary mt-1",children:[a.control_name," | Kategorija: ",a.control_category]})]}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-bg-surface-hover rounded-lg transition-colors",children:e.jsx(Ar,{className:"w-5 h-5 text-text-secondary"})})]}),e.jsxs("form",{onSubmit:h,className:"p-6 space-y-6",children:[m&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 flex items-center gap-2",children:[e.jsx(er,{className:"w-4 h-4 text-red-600 flex-shrink-0"}),e.jsx("span",{className:"text-body-sm text-red-800",children:m})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body font-medium text-text-primary mb-2",children:"Status implementacije *"}),e.jsxs("select",{value:o.status||"not_implemented",onChange:j=>b("status",j.target.value),className:"w-full px-3 py-2 bg-bg-pure-black border border-border-subtle rounded-md focus:ring-2 focus:ring-accent-primary focus:border-transparent disabled:opacity-50 disabled:cursor-not-allowed",required:!0,disabled:i==="view",children:[e.jsx("option",{value:"not_implemented",children:"Ni implementirano"}),e.jsx("option",{value:"planned",children:"Nartovano"}),e.jsx("option",{value:"partially_implemented",children:"Delno implementirano"}),e.jsx("option",{value:"implemented",children:"Implementirano"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body font-medium text-text-primary mb-2",children:"Utemeljitev *"}),e.jsx("textarea",{value:o.justification||"",onChange:j=>b("justification",j.target.value),rows:3,className:"w-full px-3 py-2 bg-bg-pure-black border border-border-subtle rounded-md focus:ring-2 focus:ring-accent-primary focus:border-transparent disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"Razlogi za vkljuitev/izkljuitev kontrole...",required:!0,disabled:i==="view"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-body font-medium text-text-primary mb-2",children:"Lastnik kontrole"}),e.jsx("input",{type:"text",value:o.control_owner||"",onChange:j=>b("control_owner",j.target.value),className:"w-full px-3 py-2 bg-bg-pure-black border border-border-subtle rounded-md focus:ring-2 focus:ring-accent-primary focus:border-transparent disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"npr. Head of Security, IT Manager",disabled:i==="view"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body font-medium text-text-primary mb-2",children:"Datum implementacije"}),e.jsx("input",{type:"date",value:o.implementation_date||"",onChange:j=>b("implementation_date",j.target.value),className:"w-full px-3 py-2 bg-bg-pure-black border border-border-subtle rounded-md focus:ring-2 focus:ring-accent-primary focus:border-transparent disabled:opacity-50 disabled:cursor-not-allowed",disabled:i==="view"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body font-medium text-text-primary mb-2",children:"Reference na obseg ISMS"}),e.jsx("input",{type:"text",value:o.isms_scope_reference||"",onChange:j=>b("isms_scope_reference",j.target.value),className:"w-full px-3 py-2 bg-bg-pure-black border border-border-subtle rounded-md focus:ring-2 focus:ring-accent-primary focus:border-transparent disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"npr. Obseg-ISMS-2025-v1.0",disabled:i==="view"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body font-medium text-text-primary mb-2",children:"Reference na tveganja"}),e.jsx("input",{type:"text",value:o.risk_reference||"",onChange:j=>b("risk_reference",j.target.value),className:"w-full px-3 py-2 bg-bg-pure-black border border-border-subtle rounded-md focus:ring-2 focus:ring-accent-primary focus:border-transparent disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"npr. RA-2025-ID-12, RTP-5.2",disabled:i==="view"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body font-medium text-text-primary mb-2",children:"Pravne/pogodbene zahteve"}),e.jsx("textarea",{value:o.legal_requirements||"",onChange:j=>b("legal_requirements",j.target.value),rows:2,className:"w-full px-3 py-2 bg-bg-pure-black border border-border-subtle rounded-md focus:ring-2 focus:ring-accent-primary focus:border-transparent disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"npr. GDPR Art. 32, Pogodba XYZ-23",disabled:i==="view"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body font-medium text-text-primary mb-2",children:"Reference na politike/postopke"}),e.jsx("textarea",{value:o.policy_references||"",onChange:j=>b("policy_references",j.target.value),rows:2,className:"w-full px-3 py-2 bg-bg-pure-black border border-border-subtle rounded-md focus:ring-2 focus:ring-accent-primary focus:border-transparent disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"npr. POL-IA-01, SOP-IR-03",disabled:i==="view"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body font-medium text-text-primary mb-2",children:"Povezane kontrole"}),e.jsx("input",{type:"text",value:o.related_controls||"",onChange:j=>b("related_controls",j.target.value),className:"w-full px-3 py-2 bg-bg-pure-black border border-border-subtle rounded-md focus:ring-2 focus:ring-accent-primary focus:border-transparent disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"npr. A.5.24, A.5.26, A.8.15",disabled:i==="view"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body font-medium text-text-primary mb-2",children:"Dokazila"}),e.jsx("textarea",{value:o.evidence||"",onChange:j=>b("evidence",j.target.value),rows:2,className:"w-full px-3 py-2 bg-bg-pure-black border border-border-subtle rounded-md focus:ring-2 focus:ring-accent-primary focus:border-transparent disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"npr. DLP-Policy.pdf, SIEM-report-Q3.pdf",disabled:i==="view"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body font-medium text-text-primary mb-2",children:"Datum zadnjega pregleda *"}),e.jsx("input",{type:"date",value:o.last_review_date||new Date().toISOString().split("T")[0],onChange:j=>b("last_review_date",j.target.value),className:"w-full px-3 py-2 bg-bg-pure-black border border-border-subtle rounded-md focus:ring-2 focus:ring-accent-primary focus:border-transparent disabled:opacity-50 disabled:cursor-not-allowed",required:!0,disabled:i==="view"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-border-subtle",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-body font-medium text-text-secondary hover:text-text-primary transition-colors",children:i==="view"?"Zapri":"Preklii"}),i==="edit"&&e.jsxs("button",{type:"submit",disabled:d,className:"px-4 py-2 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-md transition-colors flex items-center gap-2 disabled:opacity-50",children:[e.jsx(Kp,{className:"w-4 h-4"}),d?"Shranjevanje...":"Shrani"]})]})]})]})})}const TD=[{key:"role_name",label:"Naziv vloge",type:"text",required:!0},{key:"role_purpose",label:"Namembnost vloge",type:"textarea",required:!0},{key:"key_responsibilities",label:"Kljune odgovornosti",type:"textarea",required:!0},{key:"authorities",label:"Pooblastila",type:"textarea",required:!0},{key:"reporting_lines",label:"Hierarhija poroanja",type:"textarea",required:!0},{key:"required_competencies",label:"Zahtevane kompetence",type:"textarea",required:!0},{key:"required_training",label:"Zahtevano usposabljanje",type:"textarea",required:!0},{key:"completed_training",label:"Opravljeno usposabljanje",type:"textarea"},{key:"relevant_processes",label:"Ustrezni procesi",type:"textarea",required:!0},{key:"related_controls",label:"Povezane kontrole",type:"textarea",required:!0},{key:"related_risks",label:"Povezana tveganja",type:"textarea"},{key:"performance_indicators",label:"Kazalniki uspenosti",type:"textarea",required:!0},{key:"kpi_targets",label:"Cilji KPI",type:"textarea"},{key:"person_assigned",label:"Dodeljena oseba",type:"text",required:!0},{key:"appointment_date",label:"Datum imenovanja",type:"date",required:!0},{key:"validity_start",label:"Zaetek veljavnosti",type:"date",required:!0},{key:"validity_end",label:"Konec veljavnosti",type:"date",required:!0},{key:"document_version",label:"Verzija dokumenta",type:"text"},{key:"document_owner",label:"Lastnik dokumenta",type:"text"},{key:"communication_plan",label:"Komunikacijski nart",type:"textarea"},{key:"stakeholder_notification",label:"Obveanje stakeholderjem",type:"textarea"},{key:"status",label:"Status",type:"select",options:["active","inactive","pending"]},{key:"notes",label:"Opombe",type:"textarea"}];function RD({isOpen:s,onClose:t,onSave:r}){const{organizationId:a}=Sn();return e.jsx(ha,{isOpen:s,onClose:t,onSave:r,title:"Dodaj novo vlogo",table:"iso_roles_responsibilities",fields:[...TD,{key:"organization_id",label:"ID organizacije",type:"text",required:!0}],defaultValues:{organization_id:a,status:"active"}})}const MD=[{key:"ticket_id",label:"Zahtevek za podporo",type:"text",required:!0},{key:"subject",label:"Zadeva",type:"text",required:!0},{key:"description",label:"Opis",type:"textarea",required:!0},{key:"priority",label:"Prioriteta",type:"select",required:!0,options:["low","medium","high","urgent"]},{key:"status",label:"Status",type:"select",options:["open","in_progress","waiting_for_customer","resolved","closed"]},{key:"category",label:"Kategorija",type:"select",options:["technical_issue","access_request","password_reset","software_install","hardware_issue","network_problem","security_incident","compliance_question","training_request","other"]},{key:"assigned_to",label:"Dodeljeno",type:"text"},{key:"requester_name",label:"Ime zahtevnika",type:"text",required:!0},{key:"requester_email",label:"Email zahtevnika",type:"text",required:!0},{key:"resolved_date",label:"Datum reitve",type:"datetime"},{key:"resolution_notes",label:"Opombe o reitvi",type:"textarea"},{key:"satisfaction_rating",label:"Ocena zadovoljstva (1-5)",type:"number"}];function FD({isOpen:s,onClose:t,onSave:r}){return e.jsx(ha,{isOpen:s,onClose:t,onSave:r,title:"Dodaj nov zahtevek",table:"support_ticket_management",fields:MD})}function UD({isOpen:s,onClose:t,onSave:r}){const{t:a}=et(),{user:n}=cr(),[i,o]=z.useState(!1),[c,d]=z.useState(null),[p,m]=z.useState(null),[x,b]=z.useState({subject_name:"",subject_email:"",consent_type:"marketing_communication",consent_given:"true",consent_date:"",withdrawal_date:"",purpose:"",organization_id:""});z.useEffect(()=>{(async()=>{if(n)try{const{data:_,error:k}=await Ne.from("profiles").select("*, organization_id").eq("id",n.id).single();if(k)throw k;m(_),b(P=>({...P,organization_id:_.organization_id||""}))}catch(_){console.error("Error fetching user profile:",_)}})()},[n]);const h=async v=>{try{if(v.size>10485760)return alert(a("validation.fileTooLarge")),null;const _=v.name.split(".").pop(),P=`${`${Date.now()}-${Math.random().toString(36).substring(7)}.${_}`}`,{data:L,error:F}=await Ne.storage.from("gdpr-attachments").upload(P,v);if(F)throw F;const{data:{publicUrl:W}}=Ne.storage.from("gdpr-attachments").getPublicUrl(P);return{url:W,name:v.name,size:v.size}}catch(_){return console.error("File upload error:",_),alert(a("validation.fileUploadFailed")),null}},j=async v=>{v.preventDefault(),o(!0);try{let _=null;if(c&&(_=await h(c),!_)){o(!1);return}if(!(p!=null&&p.organization_id))throw new Error("Organizacijski kontekst ni na voljo");const{error:k}=await Ne.from("gdpr_consent_management").insert([{...x,organization_id:p.organization_id,consent_given:x.consent_given==="true",..._&&{file_url:_.url,file_name:_.name,file_size:_.size}}]);if(k)throw k;r(),t(),b({subject_name:"",subject_email:"",consent_type:"marketing_communication",consent_given:"true",consent_date:"",withdrawal_date:"",purpose:"",organization_id:(p==null?void 0:p.organization_id)||""}),d(null)}catch(_){console.error("Error:",_),_ instanceof Error&&_.message.includes("Organizacijski kontekst")?alert("Napaka: "+_.message):alert(a("forms.saveFailed"))}finally{o(!1)}},g=(v,_)=>{b(k=>({...k,[v]:_}))};return s?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:t}),e.jsxs("div",{className:"relative bg-bg-surface border border-border-subtle rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-border-subtle",children:[e.jsx("h2",{className:"text-h3 text-text-primary",children:a("modals.add.gdprConsentManagement.title")}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",children:e.jsx(Ar,{className:"w-5 h-5 text-text-secondary"})})]}),e.jsxs("form",{onSubmit:j,className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:[a("gdpr.consent.userName")," ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"text",required:!0,value:x.subject_name,onChange:v=>g("subject_name",v.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:[a("gdpr.consent.userEmail")," ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"email",required:!0,value:x.subject_email,onChange:v=>g("subject_email",v.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:["Tip soglasja ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsxs("select",{required:!0,value:x.consent_type,onChange:v=>g("consent_type",v.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"marketing_communication",children:"Marketing Communication"}),e.jsx("option",{value:"data_processing",children:"Data Processing"}),e.jsx("option",{value:"cookies",children:"Cookies"}),e.jsx("option",{value:"analytics",children:"Analytics"}),e.jsx("option",{value:"third_party_sharing",children:"Third Party Sharing"}),e.jsx("option",{value:"data_retention",children:"Data Retention"}),e.jsx("option",{value:"profiling",children:"Profiling"}),e.jsx("option",{value:"automated_decision_making",children:"Automated Decision Making"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Soglasje podano"}),e.jsxs("select",{value:x.consent_given,onChange:v=>g("consent_given",v.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"true",children:"Da"}),e.jsx("option",{value:"false",children:"Ne"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Datum soglasja"}),e.jsx("input",{type:"datetime-local",value:x.consent_date,onChange:v=>g("consent_date",v.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Datum preklica"}),e.jsx("input",{type:"datetime-local",value:x.withdrawal_date,onChange:v=>g("withdrawal_date",v.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:["Namen ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("textarea",{rows:4,required:!0,value:x.purpose,onChange:v=>g("purpose",v.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none resize-vertical"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:[a("forms.attachFile")," ",e.jsx("span",{className:"text-text-tertiary text-xs",children:"(opcijsko)"})]}),e.jsx("input",{type:"file",accept:".pdf,.doc,.docx,.xls,.xlsx,.csv",onChange:v=>{var _;return d(((_=v.target.files)==null?void 0:_[0])||null)},className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary file:mr-4 file:py-1 file:px-2 file:rounded file:border-0 file:text-sm file:font-medium file:bg-accent-primary file:text-white hover:file:bg-accent-primary-hover"}),c&&e.jsxs("p",{className:"text-xs text-text-tertiary mt-1",children:[c.name," (",Math.round(c.size/1024)," KB)"]})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 bg-bg-near-black text-text-primary border border-border-subtle rounded hover:bg-bg-surface transition-colors duration-150",children:a("modals.add.common.cancel")}),e.jsx("button",{type:"submit",disabled:i,className:"px-4 py-2 bg-accent-primary text-white rounded hover:bg-accent-primary-hover transition-colors duration-150 disabled:opacity-50",children:a(i?"modals.add.common.submitting":"modals.add.common.submit")})]})]})]})]}):null}function qD({isOpen:s,onClose:t,onSave:r}){const{t:a}=et(),{user:n}=cr(),[i,o]=z.useState(!1),[c,d]=z.useState(null),[p,m]=z.useState(null),[x,b]=z.useState({policy_name:"",version:"",effective_date:"",content:"",status:"draft",approved_by:"",last_updated:"",description:"",organization_id:""});z.useEffect(()=>{(async()=>{if(n)try{const{data:_,error:k}=await Ne.from("profiles").select("*, organization_id").eq("id",n.id).single();if(k)throw k;m(_),b(P=>({...P,organization_id:_.organization_id||""}))}catch(_){console.error("Error fetching user profile:",_)}})()},[n]);const h=async v=>{try{if(v.size>10485760)return alert(a("validation.fileTooLarge")),null;const _=v.name.split(".").pop(),P=`${`${Date.now()}-${Math.random().toString(36).substring(7)}.${_}`}`,{data:L,error:F}=await Ne.storage.from("gdpr-attachments").upload(P,v);if(F)throw F;const{data:{publicUrl:W}}=Ne.storage.from("gdpr-attachments").getPublicUrl(P);return{url:W,name:v.name,size:v.size}}catch(_){return console.error("File upload error:",_),alert(a("validation.fileUploadFailed")),null}},j=async v=>{v.preventDefault(),o(!0);try{let _=null;if(c&&(_=await h(c),!_)){o(!1);return}if(!(p!=null&&p.organization_id))throw new Error("Organizacijski kontekst ni na voljo");const{error:k}=await Ne.from("gdpr_privacy_policies").insert([{...x,organization_id:p.organization_id,..._&&{file_url:_.url,file_name:_.name,file_size:_.size}}]);if(k)throw k;r(),t(),b({policy_name:"",version:"",effective_date:"",content:"",status:"draft",approved_by:"",last_updated:"",description:"",organization_id:(p==null?void 0:p.organization_id)||""}),d(null)}catch(_){console.error("Error:",_),_ instanceof Error&&_.message.includes("Organizacijski kontekst")?alert("Napaka: "+_.message):alert(a("forms.saveFailed"))}finally{o(!1)}},g=(v,_)=>{b(k=>({...k,[v]:_}))};return s?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:t}),e.jsxs("div",{className:"relative bg-bg-surface border border-border-subtle rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-border-subtle",children:[e.jsx("h2",{className:"text-h3 text-text-primary",children:a("modals.add.gdprPrivacyPolicy.title")}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",children:e.jsx(Ar,{className:"w-5 h-5 text-text-secondary"})})]}),e.jsxs("form",{onSubmit:j,className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:[a("gdpr.privacyPolicy.policyName")," ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"text",required:!0,value:x.policy_name,onChange:v=>g("policy_name",v.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:[a("modals.add.common.version")," ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"text",required:!0,value:x.version,onChange:v=>g("version",v.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:[a("gdpr.privacyPolicy.effectiveDate")," ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"date",required:!0,value:x.effective_date,onChange:v=>g("effective_date",v.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:a("modals.add.common.status")}),e.jsxs("select",{value:x.status,onChange:v=>g("status",v.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"archived",children:"Archived"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:a("modals.add.common.approvedBy")}),e.jsx("input",{type:"text",value:x.approved_by,onChange:v=>g("approved_by",v.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:a("common.lastUpdated")}),e.jsx("input",{type:"date",value:x.last_updated,onChange:v=>g("last_updated",v.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:a("common.description")}),e.jsx("input",{type:"text",value:x.description,onChange:v=>g("description",v.target.value),placeholder:"Kratek opis politike",className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:a("modals.add.common.content")}),e.jsx("textarea",{rows:4,value:x.content,onChange:v=>g("content",v.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none resize-vertical"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:[a("forms.attachFile")," ",e.jsx("span",{className:"text-text-tertiary text-xs",children:"(opcijsko)"})]}),e.jsx("input",{type:"file",accept:".pdf,.doc,.docx,.xls,.xlsx,.csv",onChange:v=>{var _;return d(((_=v.target.files)==null?void 0:_[0])||null)},className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary file:mr-4 file:py-1 file:px-2 file:rounded file:border-0 file:text-sm file:font-medium file:bg-accent-primary file:text-white hover:file:bg-accent-primary-hover"}),c&&e.jsxs("p",{className:"text-xs text-text-tertiary mt-1",children:[c.name," (",Math.round(c.size/1024)," KB)"]})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 bg-bg-near-black text-text-primary border border-border-subtle rounded hover:bg-bg-surface transition-colors duration-150",children:a("modals.add.common.cancel")}),e.jsx("button",{type:"submit",disabled:i,className:"px-4 py-2 bg-accent-primary text-white rounded hover:bg-accent-primary-hover transition-colors duration-150 disabled:opacity-50",children:a(i?"modals.add.common.submitting":"modals.add.common.submit")})]})]})]})]}):null}function S_({isOpen:s,onClose:t,onSave:r,editMode:a=!1,editRecord:n=null}){const{t:i}=et(),[o,c]=z.useState(!1),[d,p]=z.useState(1),[m,x]=z.useState([]),[b,h]=z.useState({}),[j,g]=z.useState(()=>a&&n?{request_id:n.request_id||`GDPR-${Date.now()}`,subject_name:n.subject_name||"",subject_email:n.subject_email||"",subject_phone:n.subject_phone||"",subject_address:n.subject_address||"",subject_birth_date:n.subject_birth_date||"",subject_type:n.subject_type||"individual",identity_verification_status:n.identity_verification_status||"unverified",identity_document_type:n.identity_document_type||"",identity_document_number:n.identity_document_number||"",identity_document_issued:n.identity_document_issued||"",identity_document_valid_until:n.identity_document_valid_until||"",legal_basis_17_a:n.legal_basis_17_a||!1,legal_basis_17_b:n.legal_basis_17_b||!1,legal_basis_17_c:n.legal_basis_17_c||!1,legal_basis_17_d:n.legal_basis_17_d||!1,legal_basis_17_e:n.legal_basis_17_e||!1,legal_basis_17_f:n.legal_basis_17_f||!1,legal_basis_description:n.legal_basis_description||"",data_categories:n.data_categories||[],data_description:n.data_description||"",data_processing_period_from:n.data_processing_period_from||"",data_processing_period_to:n.data_processing_period_to||"",data_system_location:n.data_system_location||"",data_processing_type:n.data_processing_type||"automatic",organization_type:n.organization_type||"private_sector",organization_id:n.organization_id||"",contact_person:n.contact_person||"",data_processing_log:n.data_processing_log||!1,risk_assessment:n.risk_assessment||"low",dpo_notified:n.dpo_notified||!1,ip_guidelines_compliance:n.ip_guidelines_compliance!==!1,request_date:n.request_date||new Date().toISOString(),status:n.status||"received",notes:n.notes||"",deadline_days:n.deadline_days||30,response_deadline:n.response_deadline||"",exceptions_applied:n.exceptions_applied||[],rejection_reason:n.rejection_reason||""}:{request_id:`GDPR-${Date.now()}`,subject_name:"",subject_email:"",subject_phone:"",subject_address:"",subject_birth_date:"",subject_type:"individual",identity_verification_status:"unverified",identity_document_type:"",identity_document_number:"",identity_document_issued:"",identity_document_valid_until:"",legal_basis_17_a:!1,legal_basis_17_b:!1,legal_basis_17_c:!1,legal_basis_17_d:!1,legal_basis_17_e:!1,legal_basis_17_f:!1,legal_basis_description:"",data_categories:[],data_description:"",data_processing_period_from:"",data_processing_period_to:"",data_system_location:"",data_processing_type:"automatic",organization_type:"private_sector",organization_id:"",contact_person:"",data_processing_log:!1,risk_assessment:"low",dpo_notified:!1,ip_guidelines_compliance:!0,request_date:new Date().toISOString(),status:"received",notes:"",deadline_days:30,response_deadline:"",exceptions_applied:[],rejection_reason:""}),v=S=>{const C=S==="public_sector"?15:30,O=new Date;O.setDate(O.getDate()+C),g(Z=>({...Z,deadline_days:C,response_deadline:O.toISOString()}))},_=[{id:1,title:"Identifikacija in kontakt",required:["subject_name","subject_email","subject_address"]},{id:2,title:"Verifikacija identitete",required:["identity_document_type"]},{id:3,title:"Pravna podlaga za izbris",required:["legal_basis_description"]},{id:4,title:"Opis podatkov za izbris",required:["data_categories","data_description"]},{id:5,title:"Potrditev in dodatne informacije",required:[]}],k=()=>{const S=_[d-1],C={};return S.required.forEach(O=>{O==="data_categories"?j.data_categories.length===0&&(C[O]="Izberite vsaj eno kategorijo podatkov"):(!j[O]||typeof j[O]=="string"&&j[O].trim()==="")&&(C[O]="To polje je obvezno")}),d===2&&m.length===0&&(C.identity_files="Priloite vsaj en identifikacijski dokument"),d===3&&(Object.keys(j).some(Z=>Z.startsWith("legal_basis_17_")&&j[Z])||(C.legal_basis="Izberite vsaj eno pravno podlago")),h(C),Object.keys(C).length===0},P=async S=>{const C=[];for(const O of S){if(O.size>10485760){alert(`Datoteka ${O.name} je prevelika (max 10MB)`);continue}const Z=O.name.split(".").pop(),ce=`identity-docs/${`${Date.now()}-${Math.random().toString(36).substring(7)}.${Z}`}`;try{const{data:re,error:X}=await Ne.storage.from("gdpr-attachments").upload(ce,O);if(X)throw X;const{data:{publicUrl:U}}=Ne.storage.from("gdpr-attachments").getPublicUrl(ce);C.push({url:U,name:O.name,size:O.size})}catch(re){console.error("Napaka pri nalaganju datoteke:",re),alert(`Napaka pri nalaganju datoteke ${O.name}`)}}return C},L=async S=>{if(S.preventDefault(),d<_.length){k()&&(p(C=>C+1),d===_.length-1&&v(j.organization_type));return}c(!0);try{const C=await P(m),O={...j,...C.length>0&&{file_url:C[0].url,file_name:C[0].name,file_size:C[0].size},identity_verification_status:C.length>0?"pending":"unverified"};if(a&&n){const{error:Z}=await Ne.from("gdpr_right_forgotten").update(O).eq("id",n.id);if(Z)throw Z}else{const{error:Z}=await Ne.from("gdpr_right_forgotten").insert([O]);if(Z)throw Z}r(),t(),a||W()}catch(C){console.error("Napaka pri shranjevanju:",C),alert("Napaka pri shranjevanju zahtevka. Poskusite znova.")}finally{c(!1)}},F=()=>{d>1&&p(S=>S-1)},W=()=>{p(1),x([]),h({}),g({request_id:`GDPR-${Date.now()}`,subject_name:"",subject_email:"",subject_phone:"",subject_address:"",subject_birth_date:"",subject_type:"individual",identity_verification_status:"unverified",identity_document_type:"",identity_document_number:"",identity_document_issued:"",identity_document_valid_until:"",legal_basis_17_a:!1,legal_basis_17_b:!1,legal_basis_17_c:!1,legal_basis_17_d:!1,legal_basis_17_e:!1,legal_basis_17_f:!1,legal_basis_description:"",data_categories:[],data_description:"",data_processing_period_from:"",data_processing_period_to:"",data_system_location:"",data_processing_type:"automatic",organization_type:"private_sector",organization_id:"",contact_person:"",data_processing_log:!1,risk_assessment:"low",dpo_notified:!1,ip_guidelines_compliance:!0,request_date:new Date().toISOString(),status:"received",notes:"",deadline_days:30,response_deadline:"",exceptions_applied:[],rejection_reason:""})},R=(S,C)=>{g(O=>({...O,[S]:C})),S==="organization_type"&&v(C)},B=S=>{const C=Array.from(S.target.files||[]);x(O=>[...O,...C])},A=S=>{x(C=>C.filter((O,Z)=>Z!==S))};return s?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:t}),e.jsxs("div",{className:"relative bg-bg-surface border border-border-subtle rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-border-subtle",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-h3 text-text-primary",children:a?"Uredi zahtevo za pozabo":"Zahteva za pozabo osebnih podatkov"}),e.jsxs("p",{className:"text-sm text-text-secondary mt-1",children:["Korak ",d," od ",_.length,": ",_[d-1].title]})]}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",children:e.jsx(Ar,{className:"w-5 h-5 text-text-secondary"})})]}),e.jsx("div",{className:"px-6 py-4 border-b border-border-subtle",children:e.jsx("div",{className:"flex items-center space-x-4",children:_.map((S,C)=>e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsx("div",{className:`
                  w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium transition-colors
                  ${d>S.id?"bg-status-success text-white":d===S.id?"bg-accent-primary text-white":"bg-bg-near-black text-text-secondary border border-border-subtle"}
                `,children:d>S.id?e.jsx(Rt,{className:"w-4 h-4"}):S.id}),C<_.length-1&&e.jsx("div",{className:`
                    flex-1 h-0.5 mx-2 transition-colors
                    ${d>S.id?"bg-status-success":"bg-border-subtle"}
                  `})]},S.id))})}),e.jsxs("form",{onSubmit:L,className:"p-6",children:[d===1&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Identifikacija in kontaktni podatki"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:["Ime in priimek ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"text",required:!0,value:j.subject_name,onChange:S=>R("subject_name",S.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"}),b.subject_name&&e.jsx("p",{className:"text-status-error text-xs mt-1",children:b.subject_name})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:["Email naslov ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"email",required:!0,value:j.subject_email,onChange:S=>R("subject_email",S.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"}),b.subject_email&&e.jsx("p",{className:"text-status-error text-xs mt-1",children:b.subject_email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Telefonska tevilka"}),e.jsx("input",{type:"tel",value:j.subject_phone,onChange:S=>R("subject_phone",S.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Tip posameznika"}),e.jsxs("select",{value:j.subject_type,onChange:S=>R("subject_type",S.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"individual",children:"Fizina oseba"}),e.jsx("option",{value:"legal_representative",children:"Predstavnik pravne osebe"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:["Naslov prebivalia ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"text",required:!0,value:j.subject_address,onChange:S=>R("subject_address",S.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"}),b.subject_address&&e.jsx("p",{className:"text-status-error text-xs mt-1",children:b.subject_address})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Datum rojstva"}),e.jsx("input",{type:"date",value:j.subject_birth_date,onChange:S=>R("subject_birth_date",S.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"})]})]})]}),d===2&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Verifikacija identitete"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:["Tip identifikacijskega dokumenta ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsxs("select",{required:!0,value:j.identity_document_type,onChange:S=>R("identity_document_type",S.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"",children:"Izberite dokument"}),e.jsx("option",{value:"identity_card",children:"Osebna izkaznica"}),e.jsx("option",{value:"passport",children:"Potni list"}),e.jsx("option",{value:"drivers_license",children:"Vozniko dovoljenje"}),e.jsx("option",{value:"other",children:"Drugo"})]}),b.identity_document_type&&e.jsx("p",{className:"text-status-error text-xs mt-1",children:b.identity_document_type})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"tevilka dokumenta (delno skrita)"}),e.jsx("input",{type:"text",value:j.identity_document_number,onChange:S=>R("identity_document_number",S.target.value),placeholder:"Zadnje 4 tevilke",className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Datum izdaje"}),e.jsx("input",{type:"date",value:j.identity_document_issued,onChange:S=>R("identity_document_issued",S.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Datum veljavnosti"}),e.jsx("input",{type:"date",value:j.identity_document_valid_until,onChange:S=>R("identity_document_valid_until",S.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:["Identifikacijski dokumenti ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"file",multiple:!0,accept:".pdf,.jpg,.jpeg,.png",onChange:B,className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary file:mr-4 file:py-1 file:px-2 file:rounded file:border-0 file:text-sm file:font-medium file:bg-accent-primary file:text-white hover:file:bg-accent-primary-hover"}),e.jsx("p",{className:"text-xs text-text-tertiary mt-1",children:"Priloite fotografijo ali sken identifikacijskega dokumenta (PDF, JPG, PNG)"}),b.identity_files&&e.jsx("p",{className:"text-status-error text-xs mt-1",children:b.identity_files}),m.length>0&&e.jsx("div",{className:"mt-3 space-y-2",children:m.map((S,C)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-bg-near-black rounded",children:[e.jsxs("span",{className:"text-sm text-text-primary flex items-center",children:[e.jsx(ut,{className:"w-4 h-4 mr-2"}),S.name," (",Math.round(S.size/1024)," KB)"]}),e.jsx("button",{type:"button",onClick:()=>A(C),className:"text-status-error hover:text-red-400 p-1",children:e.jsx(Ar,{className:"w-4 h-4"})})]},C))})]})]}),d===3&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Pravna podlaga za izbris (GDPR len 17)"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm text-text-secondary",children:"Izberite razlog(e) za izbris osebnih podatkov v skladu z GDPR lenom 17(1):"}),[{key:"legal_basis_17_a",text:"a) Podatki niso ve potrebni za namene, za katere so bili zbrani"},{key:"legal_basis_17_b",text:"b) Posameznik preklie soglasje in ni druge pravne podlage"},{key:"legal_basis_17_c",text:"c) Posameznik nasprotuje obdelavi na podlagi zakonitega interesa"},{key:"legal_basis_17_d",text:"d) Osebni podatki so bili obdelani nezakonito"},{key:"legal_basis_17_e",text:"e) Osebni podatki morajo biti izbrisani zaradi pravne obveznosti"},{key:"legal_basis_17_f",text:"f) Otrokovi osebni podatki, zbrani v povezavi z informacijskimi storitvami"}].map(S=>e.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:j[S.key],onChange:C=>R(S.key,C.target.checked),className:"mt-1 w-4 h-4 text-accent-primary border-border-subtle rounded focus:ring-accent-primary"}),e.jsx("span",{className:"text-sm text-text-primary",children:S.text})]},S.key)),b.legal_basis&&e.jsx("p",{className:"text-status-error text-xs mt-1",children:b.legal_basis})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:["Podroben opis razloga za izbris ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("textarea",{required:!0,rows:4,value:j.legal_basis_description,onChange:S=>R("legal_basis_description",S.target.value),placeholder:"Opiite zakaj zahtevate izbris vaih osebnih podatkov...",className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none resize-vertical"}),b.legal_basis_description&&e.jsx("p",{className:"text-status-error text-xs mt-1",children:b.legal_basis_description})]})]}),d===4&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Opis podatkov za izbris"}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-2",children:["Kategorije podatkov ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:["Kontaktni podatki","Demografski podatki","Podatki o zdravju","Finanni podatki","Tehnini podatki","Podatki o dejavnosti","Ostalo"].map(S=>e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:j.data_categories.includes(S),onChange:C=>{C.target.checked?R("data_categories",[...j.data_categories,S]):R("data_categories",j.data_categories.filter(O=>O!==S))},className:"w-4 h-4 text-accent-primary border-border-subtle rounded focus:ring-accent-primary"}),e.jsx("span",{className:"text-sm text-text-primary",children:S})]},S))}),b.data_categories&&e.jsx("p",{className:"text-status-error text-xs mt-1",children:b.data_categories})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Obdobje obdelave - od"}),e.jsx("input",{type:"date",value:j.data_processing_period_from,onChange:S=>R("data_processing_period_from",S.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Obdobje obdelave - do"}),e.jsx("input",{type:"date",value:j.data_processing_period_to,onChange:S=>R("data_processing_period_to",S.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Sistem/baza kjer se podatki nahajajo"}),e.jsx("input",{type:"text",value:j.data_system_location,onChange:S=>R("data_system_location",S.target.value),placeholder:"npr. CRM sistem, spletna stran, ...",className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Vrsta obdelave"}),e.jsxs("select",{value:j.data_processing_type,onChange:S=>R("data_processing_type",S.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"automatic",children:"Avtomatska"}),e.jsx("option",{value:"manual",children:"Rona"}),e.jsx("option",{value:"both",children:"Oboje"})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:["Specifien opis podatkov ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("textarea",{required:!0,rows:4,value:j.data_description,onChange:S=>R("data_description",S.target.value),placeholder:"Podrobno opiite katere osebne podatke zahtevate za izbris...",className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none resize-vertical"}),b.data_description&&e.jsx("p",{className:"text-status-error text-xs mt-1",children:b.data_description})]})]}),d===5&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Potrditev in dodatne informacije"}),e.jsxs("div",{className:"space-y-4 p-4 bg-bg-near-black rounded-lg",children:[e.jsx("h4",{className:"font-medium text-text-primary",children:"ZVOP-2 informacije (Slovenija)"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Tip organizacije"}),e.jsxs("select",{value:j.organization_type,onChange:S=>R("organization_type",S.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"private_sector",children:"Zasebni sektor (30 dni)"}),e.jsx("option",{value:"public_sector",children:"Javni sektor (15 dni)"}),e.jsx("option",{value:"government",children:"Dravni organ (15 dni)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Ocena tveganja"}),e.jsxs("select",{value:j.risk_assessment,onChange:S=>R("risk_assessment",S.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"low",children:"Nizko tveganje"}),e.jsx("option",{value:"medium",children:"Srednje tveganje"}),e.jsx("option",{value:"high",children:"Visoko tveganje"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Matina tevilka organizacije"}),e.jsx("input",{type:"text",value:j.organization_id,onChange:S=>R("organization_id",S.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Kontaktna oseba"}),e.jsx("input",{type:"text",value:j.contact_person,onChange:S=>R("contact_person",S.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:j.data_processing_log,onChange:S=>R("data_processing_log",S.target.checked),className:"w-4 h-4 text-accent-primary border-border-subtle rounded focus:ring-accent-primary"}),e.jsx("span",{className:"text-sm text-text-primary",children:"Vodenje dnevnika obdelave (len 22 ZVOP-2)"})]}),e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:j.ip_guidelines_compliance,onChange:S=>R("ip_guidelines_compliance",S.target.checked),className:"w-4 h-4 text-accent-primary border-border-subtle rounded focus:ring-accent-primary"}),e.jsx("span",{className:"text-sm text-text-primary",children:"Skladnost z IP smernicami"})]})]})]}),e.jsxs("div",{className:"space-y-4 p-4 bg-bg-near-black rounded-lg",children:[e.jsx("h4",{className:"font-medium text-text-primary",children:"Povzetek zahteve"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Zahtevek za podporo:"})," ",j.request_id]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Ime:"})," ",j.subject_name]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Email:"})," ",j.subject_email]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Kategorije podatkov:"})," ",j.data_categories.join(", ")]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Rok za odgovor:"})," ",j.deadline_days," dni"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Priloeni dokumenti:"})," ",m.length," datoteka(e)"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Dodatne opombe"}),e.jsx("textarea",{rows:3,value:j.notes,onChange:S=>R("notes",S.target.value),placeholder:"Dodatne informacije ali opombe...",className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none resize-vertical"})]}),e.jsx("div",{className:"p-4 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(er,{className:"w-5 h-5 text-blue-400 mt-0.5"}),e.jsxs("div",{className:"text-sm text-text-primary",children:[e.jsx("p",{className:"font-medium mb-1",children:"Pomembno obvestilo:"}),e.jsx("p",{children:"Z oddajo te zahteve potrjujete, da so vsi navedeni podatki resnini in da imate pravico zahtevati izbris navedenih osebnih podatkov. Zahteva bo obravnavana v zakonsko doloenem roku."})]})]})})]}),e.jsxs("div",{className:"flex items-center justify-between pt-6 border-t border-border-subtle",children:[e.jsx("div",{className:"flex items-center space-x-3",children:d>1&&e.jsxs("button",{type:"button",onClick:F,className:"flex items-center px-4 py-2 bg-bg-near-black text-text-primary border border-border-subtle rounded hover:bg-bg-surface transition-colors duration-150",children:[e.jsx(ug,{className:"w-4 h-4 mr-1"}),"Nazaj"]})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 bg-bg-near-black text-text-primary border border-border-subtle rounded hover:bg-bg-surface transition-colors duration-150",children:"Preklii"}),d<_.length?e.jsxs("button",{type:"submit",className:"flex items-center px-4 py-2 bg-accent-primary text-white rounded hover:bg-accent-primary-hover transition-colors duration-150",children:["Naprej",e.jsx(ax,{className:"w-4 h-4 ml-1"})]}):e.jsx("button",{type:"submit",disabled:o,className:"flex items-center px-6 py-2 bg-status-success text-white rounded hover:bg-green-600 transition-colors duration-150 disabled:opacity-50",children:o?"Poiljam...":a?"Posodobi zahtevo":"Polji zahtevo"})]})]})]})]})]}):null}const $D=({isOpen:s,onClose:t,onSuccess:r})=>{const{t:a}=et(),[n,i]=z.useState(1),[o,c]=z.useState(!1),[d,p]=z.useState(null),[m,x]=z.useState(!1),[b,h]=z.useState({}),[j,g]=z.useState({}),[v,_]=z.useState({assessment_id:"",project_name:"",project_description:"",project_purpose:"",lawful_basis:"",lawful_basis_details:"",dpo_involved:!1,dpo_consultation_date:"",dpo_opinion:"",data_types:[],special_categories:!1,special_categories_details:"",criminal_data:!1,criminal_data_details:"",data_subjects:[],data_sources:[],processing_purposes:[],data_recipients:[],third_country_transfers:!1,third_country_details:"",necessity_assessment:"",alternatives_considered:"",data_minimization_measures:"",storage_limitation:"",impact_on_rights:"",risk_scenarios:[""],risk_probability:[1],risk_severity:[1],risk_mitigation_measures:[""],residual_risk_levels:["medium"],technical_measures:[],organizational_measures:[],privacy_by_design:!1,privacy_by_default:!1,rights_mechanisms:[],monitoring_plan:"",review_schedule:"",zvop2_research_purposes:!1,zvop2_research_elaborate:"",zvop2_video_surveillance:!1,zvop2_surveillance_details:"",zvop2_data_pooling:!1,zvop2_pooling_details:"",processing_logs_required:!1,special_security_measures:!1,special_security_details:"",assessment_date:"",completion_date:"",status:"draft",approval_authority:"",approval_date:"",ip_consultation_required:!1,ip_consultation_date:"",ip_response:"",attachments:[]}),k=[[{probability:1,severity:1,level:"low",color:"bg-green-500"},{probability:1,severity:2,level:"low",color:"bg-green-500"},{probability:1,severity:3,level:"medium",color:"bg-yellow-500"},{probability:1,severity:4,level:"medium",color:"bg-yellow-500"},{probability:1,severity:5,level:"high",color:"bg-orange-500"}],[{probability:2,severity:1,level:"low",color:"bg-green-500"},{probability:2,severity:2,level:"low",color:"bg-green-500"},{probability:2,severity:3,level:"medium",color:"bg-yellow-500"},{probability:2,severity:4,level:"high",color:"bg-orange-500"},{probability:2,severity:5,level:"high",color:"bg-orange-500"}],[{probability:3,severity:1,level:"low",color:"bg-green-500"},{probability:3,severity:2,level:"medium",color:"bg-yellow-500"},{probability:3,severity:3,level:"medium",color:"bg-yellow-500"},{probability:3,severity:4,level:"high",color:"bg-orange-500"},{probability:3,severity:5,level:"critical",color:"bg-red-500"}],[{probability:4,severity:1,level:"low",color:"bg-green-500"},{probability:4,severity:2,level:"medium",color:"bg-yellow-500"},{probability:4,severity:3,level:"high",color:"bg-orange-500"},{probability:4,severity:4,level:"high",color:"bg-orange-500"},{probability:4,severity:5,level:"critical",color:"bg-red-500"}],[{probability:5,severity:1,level:"medium",color:"bg-yellow-500"},{probability:5,severity:2,level:"medium",color:"bg-yellow-500"},{probability:5,severity:3,level:"high",color:"bg-orange-500"},{probability:5,severity:4,level:"critical",color:"bg-red-500"},{probability:5,severity:5,level:"critical",color:"bg-red-500"}]];if(!s)return null;const P=()=>{const K=new Date,T=K.getFullYear(),ee=String(K.getMonth()+1).padStart(2,"0"),_e=String(K.getDate()).padStart(2,"0"),ke=String(K.getHours()).padStart(2,"0"),ue=String(K.getMinutes()).padStart(2,"0"),je=String(K.getSeconds()).padStart(2,"0");return`DPIA-${T}${ee}${_e}-${ke}${ue}${je}`},L={1:["assessment_id","project_name","project_description","lawful_basis","lawful_basis_details"],2:["data_types","data_subjects","processing_purposes"],3:["necessity_assessment","data_minimization_measures"],4:["risk_scenarios"],5:["technical_measures","organizational_measures"]},F=["Osebni identifikatorji","Kontaktni podatki","Lokacijski podatki","Finanni podatki","Zdravstveni podatki","Biometrini podatki","Genetski podatki","Podatki o politinih nazorih","Religiozni preprianja","lani sindikatov","Rasa ali etina pripadnost","Spolna usmerjenost","Kazenske evidence","IP naslovi","Spletni pikotki","Mobilni identifikatorji","Drugo"],W=["Zaposleni","Stranke/kupci","Bolniki","tudenti","Otroci (mlaji od 16 let)","Ranljive skupine","Kandidati za zaposlitev","Upokojenci","Dravljani","Drugo"],R=["Izvajanje pogodbe","Pravna obveznost","Osebne storitve","Direktni marketing","Servis strank","Varstvo osebja","Prepreevanje goljufij","Zagotavljanje varnosti","Sledenje storitev","Analitika uporabnikov","Raziskave in analize","Priporoni sistemi","Personalizacija vsebine","Komunikacija","Drugo"],B=["Privolitev (len 6(1)(a))","Pogodba (len 6(1)(b))","Pravna obveznost (len 6(1)(c))","Javna naloga (len 6(1)(e))","Zakoniti interes (len 6(1)(f))","Posebne okoliine (len 6(1)(d))"],A=["ifriranje podatkov","Psevdonimizacija","Dostopni nadzor","Varnostno kopiranje","Varnostni monitoring","Antivirusna zaita","Poarni zid","VPN povezave","Dvofaktorska avtentikacija","Redno varnostno testiranje","Varnostna politika gesel","Zaklepanje raunov","Beleenje dostopov","Oddelek za varnost","Drugo"],S=["Usposabljanje zaposlenih","Politika varstva podatkov","Dostop na podlagi potreb","Klasifikacija podatkov","Pravila hrambe","Protokol incidentov","GDPR usposabljanje","PO vrsta osebja","Varovanje tajnih podatkov","Audit podatkov","Nadzor izvoza","Kodeks ravnanja","Drugo"],C=["Portal za dostop do podatkov","Formular za prenosljivost","Portal za izbris podatkov","Opt-out sistem","Kontaktna toka DPO","Informacijska linija","Pritobeni sistem","Sledljivost zahtevkov"],O=["Neavtoriziran dostop do osebnih podatkov","Napaka pri prenosu podatkov","Kraja podatkov iz naprav","kodljiva programska oprema","Kritev varnosti sistema","Notranja gronja","Spletni napad","Fizina kraja","Odpuanje napake","Ogroanje identitete","Diskriminacija","Finanna koda","Pokodovanje ugleda","Kritev pravic posameznikov","Nadzorna sankcija","Toba","Izguba zaupanja","Napaka v algoritmu"],Z=()=>{const K={};return v.zvop2_research_purposes&&!v.zvop2_research_elaborate&&(K.zvop2_research_elaborate="Za raziskovalne namene je potreben Elaborat po lenu 69 ZVOP-2"),v.zvop2_video_surveillance&&!v.zvop2_surveillance_details&&(K.zvop2_surveillance_details="Pri videonadzoru cest so potrebni tehnini in organizacijski elementi"),v.zvop2_data_pooling&&(v.zvop2_pooling_details||(K.zvop2_pooling_details="Pri povezovanju zbirk je potrebno predhodno posvetovanje z IP"),v.ip_consultation_required=!0),v.special_categories&&(v.special_categories_details||(K.special_categories_details="Podroben opis posebnih kategorij podatkov je obvezen")),v.criminal_data&&(v.criminal_data_details||(K.criminal_data_details="Podrobne informacije o podatkih kazenskih evidenc so obvezne")),v.third_country_transfers&&(v.third_country_details||(K.third_country_details="Pri prenosih v tretje drave je potrebna ocena ustreznosti")),v.risk_probability.some(T=>T>=4)&&!v.privacy_by_design&&(K.privacy_by_design="Pri visokih tveganjih je potreben Privacy by Design pristop"),v.data_types.length>10&&v.data_minimization_measures.length<50&&(K.data_minimization_measures="Pri obdelavi tevilnih podatkov je potrebno podrobno utemeljevanje minimizacije"),g(K),Object.keys(K).length===0},te=K=>{const T=L[K],ee={};return T==null||T.forEach(_e=>{const ke=v[_e];(!ke||Array.isArray(ke)&&ke.length===0||typeof ke=="string"&&!ke.trim())&&(ee[_e]="To polje je obvezno")}),h(ee),Object.keys(ee).length===0},ce=(K,T)=>{var _e;return((_e=k[K-1])==null?void 0:_e[T-1])||{level:"low",color:"bg-green-500"}},re=()=>{_(K=>({...K,risk_scenarios:[...K.risk_scenarios,""],risk_probability:[...K.risk_probability,1],risk_severity:[...K.risk_severity,1],risk_mitigation_measures:[...K.risk_mitigation_measures,""],residual_risk_levels:[...K.residual_risk_levels,"medium"]}))},X=K=>{v.risk_scenarios.length>1&&_(T=>({...T,risk_scenarios:T.risk_scenarios.filter((ee,_e)=>_e!==K),risk_probability:T.risk_probability.filter((ee,_e)=>_e!==K),risk_severity:T.risk_severity.filter((ee,_e)=>_e!==K),risk_mitigation_measures:T.risk_mitigation_measures.filter((ee,_e)=>_e!==K),residual_risk_levels:T.residual_risk_levels.filter((ee,_e)=>_e!==K)}))},U=K=>{var ee;const T=(ee=K.target.files)==null?void 0:ee[0];if(T){if(T.size>10*1024*1024){alert("Datoteka je prevelika (max 10MB)");return}if(!["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/csv"].includes(T.type)){alert("Dovoljeni so samo PDF, DOC, DOCX, XLS, XLSX, CSV fajli.");return}p(T)}},oe=async()=>{if(!d)return null;x(!0);try{const K=d.name.split(".").pop(),T=`${Date.now()}-${Math.random().toString(36).substring(2)}.${K}`,{data:ee,error:_e}=await Ne.storage.from("gdpr-attachments").upload(T,d);if(_e)throw _e;const{data:ke}=Ne.storage.from("gdpr-attachments").getPublicUrl(T);return{url:ke.publicUrl,name:d.name,size:d.size}}catch(K){return console.error("File upload error:",K),alert("Napaka pri nalaganju datoteke"),null}finally{x(!1)}},xe=async K=>{K.preventDefault();let T=!0;for(let ee=1;ee<=5;ee++)if(!te(ee)){i(ee),T=!1;break}if(T){if(!Z()){alert("Prosimo, odpravite kontekstne validacijske napake");return}c(!0);try{let ee=null;if(d&&(ee=await oe(),!ee)){c(!1);return}const _e=ee?{name:ee.name,url:ee.url,type:(d==null?void 0:d.type)||"unknown"}:null,ke=v.assessment_id||P(),ue={...v,assessment_id:ke,data_processing_description:v.project_description,attachments:_e?[_e]:[],updated_at:new Date().toISOString(),created_at:new Date().toISOString(),project_purpose:v.project_purpose||"Ni specificiran",lawful_basis_details:v.lawful_basis_details||"Ni specificiran",alternatives_considered:v.alternatives_considered||"Ni raziskovane alternative",storage_limitation:v.storage_limitation||"Standardno hranjenje",impact_on_rights:v.impact_on_rights||"Ni ocenjenega vpliva",dpo_opinion:v.dpo_opinion||"",dpo_consultation_date:v.dpo_consultation_date||null,assessment_date:v.assessment_date||new Date().toISOString().split("T")[0],completion_date:v.completion_date||null,approval_authority:v.approval_authority||"",approval_date:v.approval_date||null,ip_consultation_date:v.ip_consultation_date||null,ip_response:v.ip_response||""};console.log("Final form data being sent:",JSON.stringify(ue,null,2)),console.log("Assessment ID:",ke);const{error:je}=await Ne.from("gdpr_dpia_assessments").insert([ue]);if(je)throw je;r(),t()}catch(ee){console.error("Error saving DPIA:",ee),alert(`Napaka pri shranjevanju DPIA: ${ee.message||ee}`)}finally{c(!1)}}},J=()=>{te(n)&&Z()&&i(K=>Math.min(K+1,5))},$=()=>{i(K=>Math.max(K-1,1))},Q=K=>e.jsxs("div",{className:"relative group",children:[e.jsx(pg,{className:"w-4 h-4 text-gray-400 ml-1 cursor-help"}),e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap z-10",children:[K,e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900"})]})]}),q=()=>e.jsx("div",{className:"flex items-center justify-center mb-8",children:[1,2,3,4,5].map(K=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-sm font-medium ${K===n?"bg-accent-primary text-white":K<n?"bg-status-success text-white":"bg-bg-surface text-text-secondary"}`,children:K<n?e.jsx(Rt,{className:"w-5 h-5"}):K}),K<5&&e.jsx("div",{className:`w-16 h-1 mx-2 ${K<n?"bg-status-success":"bg-bg-surface"}`})]},K))}),I=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(ut,{className:"w-6 h-6 text-accent-primary"}),e.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"1. Pregled projekta in pravna podlaga"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-2",children:["ID ocenjevanja ",e.jsx("span",{className:"text-red-500",children:"*"}),Q("Unikatni identifikator DPIA ocenjevanja (npr. DPIA-2024-001)")]}),e.jsx("input",{type:"text",value:v.assessment_id,onChange:K=>_(T=>({...T,assessment_id:K.target.value})),className:`w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg focus:ring-2 focus:ring-accent-primary focus:border-accent-primary text-text-primary placeholder-text-secondary ${b.assessment_id?"border-status-error":"border-border-subtle"}`,placeholder:"DPIA-2024-001"}),b.assessment_id&&e.jsx("p",{className:"text-status-error text-sm mt-1",children:b.assessment_id})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-2",children:["Ime projekta ",e.jsx("span",{className:"text-red-500",children:"*"}),Q("Kratko in jasno ime projekta ali obdelave")]}),e.jsx("input",{type:"text",value:v.project_name,onChange:K=>_(T=>({...T,project_name:K.target.value})),className:`w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg focus:ring-2 focus:ring-accent-primary focus:border-accent-primary text-text-primary placeholder-text-secondary ${b.project_name?"border-status-error":"border-border-subtle"}`,placeholder:"npr. CRM sistem za upravljanje strank"}),b.project_name&&e.jsx("p",{className:"text-status-error text-sm mt-1",children:b.project_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Datum ocenjevanja"}),e.jsx("input",{type:"date",value:v.assessment_date,onChange:K=>_(T=>({...T,assessment_date:K.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg focus:ring-2 focus:ring-accent-primary focus:border-accent-primary text-text-primary"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-2",children:["Opis projekta ",e.jsx("span",{className:"text-red-500",children:"*"}),Q("Podroben opis projekta, vkljuno z nameni in obsegom")]}),e.jsx("textarea",{value:v.project_description,onChange:K=>_(T=>({...T,project_description:K.target.value})),rows:4,className:`w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg focus:ring-2 focus:ring-accent-primary focus:border-accent-primary text-text-primary placeholder-text-secondary ${b.project_description?"border-status-error":"border-border-subtle"}`,placeholder:"Podroben opis projekta..."}),b.project_description&&e.jsx("p",{className:"text-status-error text-sm mt-1",children:b.project_description})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-2",children:["Pravna podlaga ",e.jsx("span",{className:"text-red-500",children:"*"}),Q("Pravna podlaga za obdelavo osebnih podatkov po lenu 6 GDPR")]}),e.jsxs("select",{value:v.lawful_basis,onChange:K=>_(T=>({...T,lawful_basis:K.target.value})),className:`w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg focus:ring-2 focus:ring-accent-primary focus:border-accent-primary text-text-primary ${b.lawful_basis?"border-status-error":"border-border-subtle"}`,children:[e.jsx("option",{value:"",children:"Izberite pravno podlago"}),B.map(K=>e.jsx("option",{value:K,children:K},K))]}),b.lawful_basis&&e.jsx("p",{className:"text-status-error text-sm mt-1",children:b.lawful_basis})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[e.jsx("input",{type:"checkbox",checked:v.dpo_involved,onChange:K=>_(T=>({...T,dpo_involved:K.target.checked})),className:"rounded border-border-subtle text-accent-primary focus:ring-accent-primary bg-bg-near-black"}),"DPO vkljuen v proces"]})}),v.dpo_involved&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Datum posvetovanja z DPO"}),e.jsx("input",{type:"date",value:v.dpo_consultation_date,onChange:K=>_(T=>({...T,dpo_consultation_date:K.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg focus:ring-2 focus:ring-accent-primary focus:border-accent-primary text-text-primary"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Mnenje DPO"}),e.jsx("textarea",{value:v.dpo_opinion,onChange:K=>_(T=>({...T,dpo_opinion:K.target.value})),rows:3,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg focus:ring-2 focus:ring-accent-primary focus:border-accent-primary text-text-primary",placeholder:"Mnenje in priporoila DPO..."})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-2",children:["Podrobnosti pravne podlage ",e.jsx("span",{className:"text-red-500",children:"*"}),Q("Podrobna utemeljitev izbrane pravne podlage")]}),e.jsx("textarea",{value:v.lawful_basis_details,onChange:K=>_(T=>({...T,lawful_basis_details:K.target.value})),rows:3,className:`w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg focus:ring-2 focus:ring-accent-primary focus:border-accent-primary text-text-primary placeholder-text-secondary ${b.lawful_basis_details?"border-status-error":"border-border-subtle"}`,placeholder:"Utemeljitev pravne podlage..."}),b.lawful_basis_details&&e.jsx("p",{className:"text-status-error text-sm mt-1",children:b.lawful_basis_details})]})]})]}),Y=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(_u,{className:"w-6 h-6 text-status-success"}),e.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"2. Podrobnosti obdelave podatkov"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-2",children:["Vrste osebnih podatkov ",e.jsx("span",{className:"text-red-500",children:"*"}),Q("Izberite vse vrste osebnih podatkov, ki se obdelujejo")]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:F.map(K=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:v.data_types.includes(K),onChange:T=>{T.target.checked?_(ee=>({...ee,data_types:[...ee.data_types,K]})):_(ee=>({...ee,data_types:ee.data_types.filter(_e=>_e!==K)}))},className:"rounded border-border-subtle text-accent-primary focus:ring-accent-primary bg-bg-near-black"}),e.jsx("span",{className:"text-sm",children:K})]},K))}),b.data_types&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:b.data_types})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[e.jsx("input",{type:"checkbox",checked:v.special_categories,onChange:K=>_(T=>({...T,special_categories:K.target.checked})),className:"rounded border-border-subtle text-status-error focus:ring-status-error bg-bg-near-black"}),"Posebne kategorije podatkov (len 9 GDPR)",Q("Obdelava posebnih kategorij podatkov - zdravje, biometrija, itd.")]})}),v.special_categories&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-2",children:["Podrobnosti posebnih kategorij ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:v.special_categories_details,onChange:K=>_(T=>({...T,special_categories_details:K.target.value})),rows:3,className:`w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg focus:ring-2 focus:ring-accent-primary focus:border-accent-primary text-text-primary placeholder-text-secondary ${b.special_categories_details?"border-status-error":"border-border-subtle"}`,placeholder:"Opis posebnih kategorij podatkov..."}),b.special_categories_details&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:b.special_categories_details})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[e.jsx("input",{type:"checkbox",checked:v.criminal_data,onChange:K=>_(T=>({...T,criminal_data:K.target.checked})),className:"rounded border-border-subtle text-status-error focus:ring-status-error bg-bg-near-black"}),"Podatki o kazenskih obsodbah (len 10 GDPR)"]})}),v.criminal_data&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-2",children:["Podrobnosti kazenskih podatkov ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:v.criminal_data_details,onChange:K=>_(T=>({...T,criminal_data_details:K.target.value})),rows:3,className:`w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg focus:ring-2 focus:ring-accent-primary focus:border-accent-primary text-text-primary placeholder-text-secondary ${b.criminal_data_details?"border-status-error":"border-border-subtle"}`,placeholder:"Opis podatkov o kazenskih obsodbah..."}),b.criminal_data_details&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:b.criminal_data_details})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-2",children:["Kategorije posameznikov ",e.jsx("span",{className:"text-red-500",children:"*"}),Q("Izberite kategorije posameznikov, katerih podatki se obdelujejo")]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:W.map(K=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:v.data_subjects.includes(K),onChange:T=>{T.target.checked?_(ee=>({...ee,data_subjects:[...ee.data_subjects,K]})):_(ee=>({...ee,data_subjects:ee.data_subjects.filter(_e=>_e!==K)}))},className:"rounded border-border-subtle text-accent-primary focus:ring-accent-primary bg-bg-near-black"}),e.jsx("span",{className:"text-sm",children:K})]},K))}),b.data_subjects&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:b.data_subjects})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:["Namen obdelave podatkov ",e.jsx("span",{className:"text-red-500",children:"*"}),Q("Izberite vse namene, za katere se obdelujejo osebni podatki")]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:R.map(K=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:v.processing_purposes.includes(K),onChange:T=>{T.target.checked?_(ee=>({...ee,processing_purposes:[...ee.processing_purposes,K]})):_(ee=>({...ee,processing_purposes:ee.processing_purposes.filter(_e=>_e!==K)}))},className:"rounded border-border-subtle text-accent-primary focus:ring-accent-primary bg-bg-near-black"}),e.jsx("span",{className:"text-sm",children:K})]},K))}),b.processing_purposes&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:b.processing_purposes})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[e.jsx("input",{type:"checkbox",checked:v.third_country_transfers,onChange:K=>_(T=>({...T,third_country_transfers:K.target.checked})),className:"rounded border-border-subtle text-status-warning focus:ring-status-warning bg-bg-near-black"}),"Prenosi v tretje drave",Q("Ali se podatki prenaajo v drave zunaj EU/EEA")]})}),v.third_country_transfers&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-2",children:["Podrobnosti prenosov ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:v.third_country_details,onChange:K=>_(T=>({...T,third_country_details:K.target.value})),rows:3,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${b.third_country_details?"border-red-500":"border-gray-300"}`,placeholder:"Drave in mehanizmi prenosov..."}),b.third_country_details&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:b.third_country_details})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Prejemniki podatkov"}),e.jsx("textarea",{value:v.data_recipients.join(`
`),onChange:K=>_(T=>({...T,data_recipients:K.target.value.split(`
`).filter(ee=>ee.trim())})),rows:3,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg focus:ring-2 focus:ring-accent-primary focus:border-accent-primary text-text-primary",placeholder:"En prejemnik na vrstico..."})]}),Object.keys(j).length>0&&e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"bg-status-error/10 border border-status-error/20 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(er,{className:"w-5 h-5 text-status-error"}),e.jsx("h4",{className:"font-medium text-status-error",children:"Opozorila za napredovanje"})]}),e.jsx("div",{className:"space-y-2",children:Object.entries(j).map(([K,T])=>e.jsxs("p",{className:"text-status-error text-sm",children:[" ",T]},K))}),e.jsx("p",{className:"text-status-error text-xs mt-3",children:"Prosimo, izpolnite zahtevana polja za nadaljevanje."})]})})]})]}),H=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(Ob,{className:"w-6 h-6 text-accent-primary"}),e.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"3. Nujnost in sorazmernost"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-2",children:["Ocena nujnosti ",e.jsx("span",{className:"text-red-500",children:"*"}),Q("Zakaj je obdelava podatkov nujna za doseganje namena")]}),e.jsx("textarea",{value:v.necessity_assessment,onChange:K=>_(T=>({...T,necessity_assessment:K.target.value})),rows:4,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${b.necessity_assessment?"border-red-500":"border-gray-300"}`,placeholder:"Podrobna ocena nujnosti obdelave..."}),b.necessity_assessment&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:b.necessity_assessment})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-2",children:["Upotevane alternative ",e.jsx("span",{className:"text-red-500",children:"*"}),Q("Katere alternative so bile presojane in zakaj niso primerne")]}),e.jsx("textarea",{value:v.alternatives_considered,onChange:K=>_(T=>({...T,alternatives_considered:K.target.value})),rows:4,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg focus:ring-2 focus:ring-accent-primary focus:border-accent-primary text-text-primary",placeholder:"Opis alternativnih reitev..."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-2",children:["Ukrepi minimizacije podatkov ",e.jsx("span",{className:"text-red-500",children:"*"}),Q("Katere ukrepe izvajate za zmanjanje koliine obdelovanih podatkov")]}),e.jsx("textarea",{value:v.data_minimization_measures,onChange:K=>_(T=>({...T,data_minimization_measures:K.target.value})),rows:4,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${b.data_minimization_measures?"border-red-500":"border-gray-300"}`,placeholder:"Ukrepi za zmanjanje koliine podatkov..."}),b.data_minimization_measures&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:b.data_minimization_measures})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-2",children:["Omejitev hranjenja",Q("Roki hrambe in razlogi za te roke")]}),e.jsx("textarea",{value:v.storage_limitation,onChange:K=>_(T=>({...T,storage_limitation:K.target.value})),rows:3,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg focus:ring-2 focus:ring-accent-primary focus:border-accent-primary text-text-primary",placeholder:"Roki hrambe in politika brisanja..."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-2",children:["Vpliv na pravice posameznikov",Q("Kako obdelava vpliva na pravice posameznikov")]}),e.jsx("textarea",{value:v.impact_on_rights,onChange:K=>_(T=>({...T,impact_on_rights:K.target.value})),rows:3,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg focus:ring-2 focus:ring-accent-primary focus:border-accent-primary text-text-primary",placeholder:"Vpliv na pravice posameznikov..."})]})]})]}),he=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(pt,{className:"w-6 h-6 text-status-warning"}),e.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"4. Ocena tveganj"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Identificirajte vsa mona tveganja in jih ocenite glede na verjetnost in resnost. Uporabite matriko tveganj za doloanje ravni tveganja."}),e.jsxs("div",{className:"bg-bg-surface p-4 rounded-lg mb-6 border border-border-subtle",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Matrica tveganj (55)"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsx("div",{className:"inline-block min-w-full",children:e.jsxs("div",{className:"grid grid-cols-6 gap-1 text-xs",children:[e.jsx("div",{className:"font-medium text-center",children:"Verjetnost\\Resnost"}),e.jsx("div",{className:"font-medium text-center",children:"1"}),e.jsx("div",{className:"font-medium text-center",children:"2"}),e.jsx("div",{className:"font-medium text-center",children:"3"}),e.jsx("div",{className:"font-medium text-center",children:"4"}),e.jsx("div",{className:"font-medium text-center",children:"5"}),k.map((K,T)=>e.jsxs(lt.Fragment,{children:[e.jsx("div",{className:"font-medium text-center py-2",children:T+1}),K.map((ee,_e)=>e.jsx("div",{className:`${ee.color} text-white text-center py-2 rounded text-xs font-medium`,children:ee.level==="low"?"N":ee.level==="medium"?"S":ee.level==="high"?"V":"K"},`${T}-${_e}`))]},T))]})})}),e.jsxs("div",{className:"flex gap-4 text-xs mt-3",children:[e.jsxs("span",{children:[e.jsx("span",{className:"w-3 h-3 inline-block bg-green-500 rounded mr-1"}),"Nizko (N)"]}),e.jsxs("span",{children:[e.jsx("span",{className:"w-3 h-3 inline-block bg-yellow-500 rounded mr-1"}),"Srednje (S)"]}),e.jsxs("span",{children:[e.jsx("span",{className:"w-3 h-3 inline-block bg-orange-500 rounded mr-1"}),"Visoko (V)"]}),e.jsxs("span",{children:[e.jsx("span",{className:"w-3 h-3 inline-block bg-red-500 rounded mr-1"}),"Kritino (K)"]})]})]})]}),v.risk_scenarios.map((K,T)=>e.jsxs("div",{className:"border border-border-subtle rounded-lg p-4 space-y-4 bg-bg-surface",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"font-medium text-text-primary",children:["Tveganje ",T+1]}),v.risk_scenarios.length>1&&e.jsx("button",{type:"button",onClick:()=>X(T),className:"text-status-error hover:text-status-error/80 text-sm",children:"Odstrani"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Scenarij tveganja"}),e.jsxs("select",{value:K,onChange:ee=>{const _e=[...v.risk_scenarios];_e[T]=ee.target.value,_(ke=>({...ke,risk_scenarios:_e}))},className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg focus:ring-2 focus:ring-accent-primary focus:border-accent-primary text-text-primary",children:[e.jsx("option",{value:"",children:"Izberite scenarij tveganja"}),O.map(ee=>e.jsx("option",{value:ee,children:ee},ee))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Verjetnost (1-5)"}),e.jsx("input",{type:"range",min:"1",max:"5",value:v.risk_probability[T],onChange:ee=>{const _e=[...v.risk_probability];_e[T]=parseInt(ee.target.value),_(ke=>({...ke,risk_probability:_e}))},className:"w-full"}),e.jsx("div",{className:"text-sm text-gray-600 text-center mt-1",children:v.risk_probability[T]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Resnost (1-5)"}),e.jsx("input",{type:"range",min:"1",max:"5",value:v.risk_severity[T],onChange:ee=>{const _e=[...v.risk_severity];_e[T]=parseInt(ee.target.value),_(ke=>({...ke,risk_severity:_e}))},className:"w-full"}),e.jsx("div",{className:"text-sm text-gray-600 text-center mt-1",children:v.risk_severity[T]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`px-3 py-1 rounded text-white text-sm font-medium ${ce(v.risk_probability[T],v.risk_severity[T]).color}`,children:ce(v.risk_probability[T],v.risk_severity[T]).level.toUpperCase()}),e.jsx("span",{className:"text-sm text-gray-600",children:"Raven tveganja"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Ukrepi za zmanjanje tveganja"}),e.jsx("textarea",{value:v.risk_mitigation_measures[T],onChange:ee=>{const _e=[...v.risk_mitigation_measures];_e[T]=ee.target.value,_(ke=>({...ke,risk_mitigation_measures:_e}))},rows:2,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg focus:ring-2 focus:ring-accent-primary focus:border-accent-primary text-text-primary",placeholder:"Opis ukrepov za zmanjanje tveganja..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Preostalo tveganje"}),e.jsxs("select",{value:v.residual_risk_levels[T],onChange:ee=>{const _e=[...v.residual_risk_levels];_e[T]=ee.target.value,_(ke=>({...ke,residual_risk_levels:_e}))},className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg focus:ring-2 focus:ring-accent-primary focus:border-accent-primary text-text-primary",children:[e.jsx("option",{value:"low",children:"Nizko"}),e.jsx("option",{value:"medium",children:"Srednje"}),e.jsx("option",{value:"high",children:"Visoko"}),e.jsx("option",{value:"critical",children:"Kritino"})]})]})]},T)),e.jsx("button",{type:"button",onClick:re,className:"w-full py-3 border-2 border-dashed border-border-subtle rounded-lg text-text-secondary hover:border-accent-primary hover:text-accent-primary transition-colors",children:"+ Dodaj novo tveganje"})]}),ge=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(Mt,{className:"w-6 h-6 text-accent-primary"}),e.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"5. Skladnost in spremljanje"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:["Tehnini ukrepi ",e.jsx("span",{className:"text-red-500",children:"*"}),Q("Izberite vse tehnine ukrepe, ki jih implementirate")]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:A.map(K=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:v.technical_measures.includes(K),onChange:T=>{T.target.checked?_(ee=>({...ee,technical_measures:[...ee.technical_measures,K]})):_(ee=>({...ee,technical_measures:ee.technical_measures.filter(_e=>_e!==K)}))},className:"rounded border-border-subtle text-accent-primary focus:ring-accent-primary bg-bg-near-black"}),e.jsx("span",{className:"text-sm",children:K})]},K))}),b.technical_measures&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:b.technical_measures})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:["Organizacijski ukrepi ",e.jsx("span",{className:"text-red-500",children:"*"}),Q("Izberite vse organizacijske ukrepe, ki jih implementirate")]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:S.map(K=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:v.organizational_measures.includes(K),onChange:T=>{T.target.checked?_(ee=>({...ee,organizational_measures:[...ee.organizational_measures,K]})):_(ee=>({...ee,organizational_measures:ee.organizational_measures.filter(_e=>_e!==K)}))},className:"rounded border-border-subtle text-accent-primary focus:ring-accent-primary bg-bg-near-black"}),e.jsx("span",{className:"text-sm",children:K})]},K))}),b.organizational_measures&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:b.organizational_measures})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[e.jsx("input",{type:"checkbox",checked:v.privacy_by_design,onChange:K=>_(T=>({...T,privacy_by_design:K.target.checked})),className:"rounded border-border-subtle text-status-success focus:ring-status-success bg-bg-near-black"}),"Privacy by Design (len 25 GDPR)",Q("Vkljuitev varstva podatkov e v fazi zasnove sistema")]})}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[e.jsx("input",{type:"checkbox",checked:v.privacy_by_default,onChange:K=>_(T=>({...T,privacy_by_default:K.target.checked})),className:"rounded border-border-subtle text-status-success focus:ring-status-success bg-bg-near-black"}),"Privacy by Default",Q("Privzete nastavitve varstva podatkov")]})})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:["Mehanizmi za uveljavljanje pravic",Q("Kako posamezniki lahko uveljavljajo svoje pravice")]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:C.map(K=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:v.rights_mechanisms.includes(K),onChange:T=>{T.target.checked?_(ee=>({...ee,rights_mechanisms:[...ee.rights_mechanisms,K]})):_(ee=>({...ee,rights_mechanisms:ee.rights_mechanisms.filter(_e=>_e!==K)}))},className:"rounded border-border-subtle text-accent-primary focus:ring-accent-primary bg-bg-near-black"}),e.jsx("span",{className:"text-sm",children:K})]},K))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Nart spremljanja"}),e.jsx("textarea",{value:v.monitoring_plan,onChange:K=>_(T=>({...T,monitoring_plan:K.target.value})),rows:3,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg focus:ring-2 focus:ring-accent-primary focus:border-accent-primary text-text-primary",placeholder:"Kako boste spremljali uinkovitost ukrepov..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Nart pregledov"}),e.jsx("textarea",{value:v.review_schedule,onChange:K=>_(T=>({...T,review_schedule:K.target.value})),rows:3,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg focus:ring-2 focus:ring-accent-primary focus:border-accent-primary text-text-primary",placeholder:"Kdaj in kako boste pregledovali to DPIA..."})]}),e.jsxs("div",{className:"border-t border-border-subtle pt-6",children:[e.jsx("h4",{className:"font-medium text-text-primary mb-4",children:"ZVOP-2 posebne zahteve"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[e.jsx("input",{type:"checkbox",checked:v.zvop2_research_purposes,onChange:K=>_(T=>({...T,zvop2_research_purposes:K.target.checked})),className:"rounded border-border-subtle text-accent-primary focus:ring-accent-primary bg-bg-near-black"}),"Raziskovalni nameni (len 69 ZVOP-2)",Q("Obdelava za raziskovalne namene znotraj zavezanca")]}),v.zvop2_research_purposes&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-2",children:["Elaborat za raziskavo ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:v.zvop2_research_elaborate,onChange:K=>_(T=>({...T,zvop2_research_elaborate:K.target.value})),rows:3,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${j.zvop2_research_elaborate?"border-red-500":"border-gray-300"}`,placeholder:"Opis raziskave in DPIA, kadar je obvezna..."}),j.zvop2_research_elaborate&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:j.zvop2_research_elaborate})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[e.jsx("input",{type:"checkbox",checked:v.zvop2_video_surveillance,onChange:K=>_(T=>({...T,zvop2_video_surveillance:K.target.checked})),className:"rounded border-border-subtle text-status-error focus:ring-status-error bg-bg-near-black"}),"Videonadzor cestnih odsekov (len 80 ZVOP-2)",Q("Obvezno mnenje IP pred uvedbo")]}),v.zvop2_video_surveillance&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-2",children:["Podrobnosti videonadzora ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:v.zvop2_surveillance_details,onChange:K=>_(T=>({...T,zvop2_surveillance_details:K.target.value})),rows:3,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${j.zvop2_surveillance_details?"border-red-500":"border-gray-300"}`,placeholder:"Tehnini in organizacijski elementi videonadzora..."}),j.zvop2_surveillance_details&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:j.zvop2_surveillance_details})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[e.jsx("input",{type:"checkbox",checked:v.zvop2_data_pooling,onChange:K=>_(T=>({...T,zvop2_data_pooling:K.target.checked})),className:"rounded border-border-subtle text-status-warning focus:ring-status-warning bg-bg-near-black"}),"Povezovanje zbirk (len 87 ZVOP-2)",Q("Obvezno predhodno posvetovanje z IP")]}),v.zvop2_data_pooling&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-2",children:["Podrobnosti povezovanja ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:v.zvop2_pooling_details,onChange:K=>_(T=>({...T,zvop2_pooling_details:K.target.value})),rows:3,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${j.zvop2_pooling_details?"border-red-500":"border-gray-300"}`,placeholder:"Analiza povezljivosti, namenov in tveganj..."}),j.zvop2_pooling_details&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:j.zvop2_pooling_details})]})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[e.jsx("input",{type:"checkbox",checked:v.processing_logs_required,onChange:K=>_(T=>({...T,processing_logs_required:K.target.checked})),className:"rounded border-border-subtle text-accent-primary focus:ring-accent-primary bg-bg-near-black"}),"Potrebni dnevniki obdelave (len 22 ZVOP-2)",Q("Vodenje dnevnikov obdelave je obvezno")]})}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[e.jsx("input",{type:"checkbox",checked:v.special_security_measures,onChange:K=>_(T=>({...T,special_security_measures:K.target.checked})),className:"rounded border-border-subtle text-status-error focus:ring-status-error bg-bg-near-black"}),"Posebne varnostne zahteve (len 23 ZVOP-2)",Q("Sistemi, ki ustrezajo kriterijem posebnih obdelav")]}),v.special_security_measures&&e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Podrobnosti posebnih ukrepov"}),e.jsx("textarea",{value:v.special_security_details,onChange:K=>_(T=>({...T,special_security_details:K.target.value})),rows:3,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg focus:ring-2 focus:ring-accent-primary focus:border-accent-primary text-text-primary",placeholder:"Omejitve hrambe, lokacije, varnostni standardi..."})]})]})]})]}),e.jsxs("div",{className:"border-t border-border-subtle pt-6",children:[e.jsx("h4",{className:"font-medium text-text-primary mb-4",children:"Priloge"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Dodaj datoteko (PDF, DOC, XLS, CSV - max 10MB)"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"file",onChange:U,className:"hidden",id:"file-upload",accept:".pdf,.doc,.docx,.xls,.xlsx,.csv"}),e.jsx("label",{htmlFor:"file-upload",className:"px-4 py-2 bg-bg-surface border border-border-subtle rounded-lg cursor-pointer hover:bg-bg-surface-hover transition-colors text-text-primary",children:"Izberi datoteko"}),d&&e.jsx("span",{className:"text-sm text-text-secondary",children:d.name})]})]})]}),e.jsxs("div",{className:"border-t border-border-subtle pt-6",children:[e.jsx("h4",{className:"font-medium text-text-primary mb-4",children:"Odobritev"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Status"}),e.jsxs("select",{value:v.status,onChange:K=>_(T=>({...T,status:K.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg focus:ring-2 focus:ring-accent-primary focus:border-accent-primary text-text-primary",children:[e.jsx("option",{value:"draft",children:"Osnutek"}),e.jsx("option",{value:"in_review",children:"V pregledu"}),e.jsx("option",{value:"approved",children:"Odobreno"}),e.jsx("option",{value:"rejected",children:"Zavrnjeno"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Datum zakljuka"}),e.jsx("input",{type:"date",value:v.completion_date,onChange:K=>_(T=>({...T,completion_date:K.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg focus:ring-2 focus:ring-accent-primary focus:border-accent-primary text-text-primary"})]}),v.status==="approved"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Odobril"}),e.jsx("input",{type:"text",value:v.approval_authority,onChange:K=>_(T=>({...T,approval_authority:K.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg focus:ring-2 focus:ring-accent-primary focus:border-accent-primary text-text-primary",placeholder:"Ime in priimek odgovorne osebe"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Datum odobritve"}),e.jsx("input",{type:"date",value:v.approval_date,onChange:K=>_(T=>({...T,approval_date:K.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg focus:ring-2 focus:ring-accent-primary focus:border-accent-primary text-text-primary"})]})]})]})]}),e.jsxs("div",{className:"border-t border-border-subtle pt-6",children:[e.jsx("h4",{className:"font-medium text-text-primary mb-4",children:"Posvetovanje z Informacijskim pooblaencem"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[e.jsx("input",{type:"checkbox",checked:v.ip_consultation_required,onChange:K=>_(T=>({...T,ip_consultation_required:K.target.checked})),className:"rounded border-border-subtle text-status-error focus:ring-status-error bg-bg-near-black"}),"Obvezno predhodno posvetovanje z IP",Q("Ker preostala tveganja ostajajo visoka")]})}),v.ip_consultation_required&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Datum poiljanja zahteve IP"}),e.jsx("input",{type:"date",value:v.ip_consultation_date,onChange:K=>_(T=>({...T,ip_consultation_date:K.target.value})),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg focus:ring-2 focus:ring-accent-primary focus:border-accent-primary text-text-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Odgovor IP"}),e.jsx("textarea",{value:v.ip_response,onChange:K=>_(T=>({...T,ip_response:K.target.value})),rows:3,className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg focus:ring-2 focus:ring-accent-primary focus:border-accent-primary text-text-primary",placeholder:"Odziv Informacijskega pooblaenca..."})]})]})]})]})]})]});return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-bg-pure-black rounded-lg shadow-xl max-w-6xl w-full max-h-[90vh] overflow-hidden border border-border-subtle",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-border-subtle",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Mt,{className:"w-8 h-8 text-accent-primary"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"GDPR DPIA - Napredna ocena"}),e.jsx("p",{className:"text-sm text-text-secondary",children:"Ocena uinka na varstvo podatkov"})]})]}),e.jsx("button",{onClick:t,className:"text-text-secondary hover:text-text-primary transition-colors",children:e.jsx(Ar,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"px-6 pt-4",children:q()}),e.jsx("div",{className:"px-6 pb-6 overflow-y-auto max-h-[calc(90vh-200px)]",children:e.jsxs("form",{onSubmit:xe,children:[n===1&&I(),n===2&&Y(),n===3&&H(),n===4&&he(),n===5&&ge(),e.jsxs("div",{className:"flex items-center justify-between mt-8 pt-6 border-t border-border-subtle",children:[e.jsxs("button",{type:"button",onClick:$,disabled:n===1,className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${n===1?"bg-bg-near-black text-text-muted cursor-not-allowed":"bg-bg-surface text-text-primary hover:bg-bg-surface-hover"}`,children:[e.jsx(rx,{className:"w-4 h-4"}),"Nazaj"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex items-center gap-2",children:Object.keys(j).length===0?e.jsxs("div",{className:"flex items-center gap-1 text-status-success",children:[e.jsx(Rt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Skladno"})]}):e.jsxs("div",{className:"flex items-center gap-1 text-status-warning",children:[e.jsx(er,{className:"w-4 h-4"}),e.jsxs("span",{className:"text-sm",children:[Object.keys(j).length," opozoril"]})]})}),n<5?e.jsxs("button",{type:"button",onClick:J,className:"flex items-center gap-2 px-6 py-2 bg-accent-primary text-white rounded-lg hover:bg-accent-primary-hover transition-colors",children:["Naprej",e.jsx(lg,{className:"w-4 h-4"})]}):e.jsx("button",{type:"submit",disabled:o||m,className:"flex items-center gap-2 px-6 py-2 bg-status-success text-white rounded-lg hover:bg-status-success/90 transition-colors disabled:opacity-50",children:o||m?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Shranjevanje..."]}):e.jsxs(e.Fragment,{children:[e.jsx(xi,{className:"w-4 h-4"}),"Zakljui DPIA"]})})]})]})]})})]})})},BD=({isOpen:s,onClose:t,onSuccess:r})=>{const{t:a}=et(),{user:n}=cr(),[i,o]=z.useState({entity_name:"",entity_type:"controller",contact_person:"",contact_email:"",contact_phone:"",headquarters_address:"",legal_basis:"",processing_type:"",data_categories:"",recipients:"",retention_period:"",security_measures:"",international_transfers:!1,sub_processors:"",dpo_contact:"",role_description:"",agreement_signed:!1,agreement_date:"",data_processing_activities:"",organization_id:""}),[c,d]=z.useState(!1),[p,m]=z.useState(null),[x,b]=z.useState(!1),[h,j]=z.useState(null);if(z.useEffect(()=>{if(!s)return;let k=!0;return(async()=>{if(n)try{const{data:L,error:F}=await Ne.from("profiles").select("*, organization_id").eq("id",n.id).single();if(F)throw F;k&&(j(L),o(W=>({...W,organization_id:L.organization_id||""})))}catch(L){console.error("Error fetching user profile:",L)}})(),()=>{k=!1}},[n,s]),!s)return null;const g=k=>{var L;const P=(L=k.target.files)==null?void 0:L[0];if(P){if(P.size>10*1024*1024){alert(a("validation.fileTooLarge"));return}if(!["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/csv"].includes(P.type)){alert("Dovoljeni so samo PDF, DOC, DOCX, XLS, XLSX, CSV fajli.");return}m(P)}},v=async()=>{if(!p)return null;b(!0);try{const k=p.name.split(".").pop(),P=`${Date.now()}-${Math.random().toString(36).substring(2)}.${k}`,{data:L,error:F}=await Ne.storage.from("gdpr-attachments").upload(P,p);if(F)throw F;const{data:W}=Ne.storage.from("gdpr-attachments").getPublicUrl(P);return{url:W.publicUrl,name:p.name,size:p.size}}catch(k){return console.error("File upload error:",k),alert(a("validation.fileUploadFailed")),null}finally{b(!1)}},_=async k=>{k.preventDefault(),d(!0);try{let P=null;if(p&&(P=await v(),!P)){d(!1);return}if(!(h!=null&&h.organization_id))throw new Error("Organizacijski kontekst ni na voljo");const L={...i,user_id:n==null?void 0:n.id,organization_id:h.organization_id,...P&&{file_url:P.url,file_name:P.name,file_size:P.size}};console.log("Submitting data:",L);const{data:F,error:W}=await Ne.from("gdpr_controller_processor").insert([L]);if(W)throw console.error("Database insert error:",W),new Error(`Supabase error: ${W.message}`);console.log("Data successfully inserted:",F),r(),t(),o({entity_name:"",entity_type:"controller",contact_person:"",contact_email:"",contact_phone:"",headquarters_address:"",legal_basis:"",processing_type:"",data_categories:"",recipients:"",retention_period:"",security_measures:"",international_transfers:!1,sub_processors:"",dpo_contact:"",role_description:"",agreement_signed:!1,agreement_date:"",data_processing_activities:"",organization_id:(h==null?void 0:h.organization_id)||""}),m(null)}catch(P){console.error("Error saving controller/processor:",P);const L=P instanceof Error?P.message:"Neznana napaka pri shranjevanju";alert("Napaka pri shranjevanju upravljavca/obdelovalca: "+L)}finally{d(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700/50 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-700/50",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Fa,{className:"w-5 h-5 text-indigo-400"}),e.jsx("h2",{className:"text-xl font-semibold text-white",children:a("gdprController.title_new")})]}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-white",children:e.jsx(Ar,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:_,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:[a("gdprController.fields.company_name")," *"]}),e.jsx("input",{type:"text",value:i.entity_name,onChange:k=>o({...i,entity_name:k.target.value}),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-blue-500 focus:outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:[a("gdprController.typeColumnName")," *"]}),e.jsxs("select",{value:i.entity_type,onChange:k=>o({...i,entity_type:k.target.value}),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-blue-500 focus:outline-none",required:!0,children:[e.jsx("option",{value:"controller",children:a("gdprController.options.controller")}),e.jsx("option",{value:"processor",children:a("gdprController.options.processor")}),e.jsx("option",{value:"joint_controller",children:"Skupni upravljavec"}),e.jsx("option",{value:"sub_processor",children:"Pod-obdelovalec"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:a("modals.add.common.contactPerson")}),e.jsx("input",{type:"text",value:i.contact_person,onChange:k=>o({...i,contact_person:k.target.value}),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-blue-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:a("modals.add.common.contactEmail")}),e.jsx("input",{type:"email",value:i.contact_email,onChange:k=>o({...i,contact_email:k.target.value}),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-blue-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:a("modals.add.common.contactPhone")}),e.jsx("input",{type:"tel",value:i.contact_phone,onChange:k=>o({...i,contact_phone:k.target.value}),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-blue-500 focus:outline-none"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:[a("gdprController.fields.headquarters_address")," *"]}),e.jsx("textarea",{value:i.headquarters_address,onChange:k=>o({...i,headquarters_address:k.target.value}),rows:2,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-blue-500 focus:outline-none",placeholder:a("gdprController.fields.headquarters_address_placeholder"),required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:[a("gdprController.fields.legal_basis")," *"]}),e.jsxs("select",{value:i.legal_basis,onChange:k=>o({...i,legal_basis:k.target.value}),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-blue-500 focus:outline-none",required:!0,children:[e.jsx("option",{value:"",children:a("gdprController.fields.legal_basis_placeholder")}),e.jsx("option",{value:"consent",children:a("gdprController.legal_basis_options.consent")}),e.jsx("option",{value:"contract",children:a("gdprController.legal_basis_options.contract")}),e.jsx("option",{value:"legal_obligation",children:a("gdprController.legal_basis_options.legal_obligation")}),e.jsx("option",{value:"vital_interests",children:a("gdprController.legal_basis_options.vital_interests")}),e.jsx("option",{value:"public_task",children:a("gdprController.legal_basis_options.public_task")}),e.jsx("option",{value:"legitimate_interests",children:a("gdprController.legal_basis_options.legitimate_interests")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:a("gdprController.fields.processing_type")}),e.jsx("textarea",{value:i.processing_type,onChange:k=>o({...i,processing_type:k.target.value}),rows:2,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-blue-500 focus:outline-none",placeholder:a("gdprController.fields.processing_type_placeholder")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:a("gdprController.fields.data_categories")}),e.jsx("textarea",{value:i.data_categories,onChange:k=>o({...i,data_categories:k.target.value}),rows:2,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-blue-500 focus:outline-none",placeholder:a("gdprController.fields.data_categories_placeholder")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:a("gdprController.fields.recipients")}),e.jsx("textarea",{value:i.recipients,onChange:k=>o({...i,recipients:k.target.value}),rows:2,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-blue-500 focus:outline-none",placeholder:a("gdprController.fields.recipients_placeholder")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:a("gdprController.fields.retention_period")}),e.jsx("input",{type:"text",value:i.retention_period,onChange:k=>o({...i,retention_period:k.target.value}),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-blue-500 focus:outline-none",placeholder:a("gdprController.fields.retention_period_placeholder")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:a("gdprController.fields.security_measures")}),e.jsx("textarea",{value:i.security_measures,onChange:k=>o({...i,security_measures:k.target.value}),rows:3,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-blue-500 focus:outline-none",placeholder:a("gdprController.fields.security_measures_placeholder")})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",id:"international_transfers",checked:i.international_transfers,onChange:k=>o({...i,international_transfers:k.target.checked}),className:"w-4 h-4 text-blue-600 bg-gray-700 border-gray-600 rounded focus:ring-blue-500 focus:ring-2"}),e.jsx("label",{htmlFor:"international_transfers",className:"text-sm font-medium text-gray-300",children:a("gdprController.fields.international_transfers")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:a("gdprController.fields.sub_processors")}),e.jsx("textarea",{value:i.sub_processors,onChange:k=>o({...i,sub_processors:k.target.value}),rows:2,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-blue-500 focus:outline-none",placeholder:a("gdprController.fields.sub_processors_placeholder")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:a("gdprController.fields.dpo_contact")}),e.jsx("input",{type:"text",value:i.dpo_contact,onChange:k=>o({...i,dpo_contact:k.target.value}),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-blue-500 focus:outline-none",placeholder:a("gdprController.fields.dpo_contact_placeholder")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:a("gdprController.roleDescription")}),e.jsx("textarea",{value:i.role_description,onChange:k=>o({...i,role_description:k.target.value}),rows:3,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-blue-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:a("gdprController.dataProcessingActivities")}),e.jsx("textarea",{value:i.data_processing_activities,onChange:k=>o({...i,data_processing_activities:k.target.value}),rows:3,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-blue-500 focus:outline-none"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",id:"agreement_signed",checked:i.agreement_signed,onChange:k=>o({...i,agreement_signed:k.target.checked}),className:"w-4 h-4 text-blue-600 bg-gray-700 border-gray-600 rounded focus:ring-blue-500 focus:ring-2"}),e.jsx("label",{htmlFor:"agreement_signed",className:"text-sm font-medium text-gray-300",children:a("gdprController.agreementSigned")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:a("forms.agreementDate")}),e.jsx("input",{type:"date",value:i.agreement_date,onChange:k=>o({...i,agreement_date:k.target.value}),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-blue-500 focus:outline-none"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:a("forms.attachFile")}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("label",{className:"flex items-center px-4 py-2 bg-blue-600/20 text-blue-400 border border-blue-600/30 rounded-lg cursor-pointer hover:bg-blue-600/30 transition-colors",children:[e.jsx(Xa,{className:"w-4 h-4 mr-2"}),"Izberi datoteko",e.jsx("input",{type:"file",onChange:g,accept:".pdf,.doc,.docx,.xls,.xlsx,.csv",className:"hidden"})]}),p&&e.jsxs("span",{className:"text-gray-300 text-sm",children:[p.name," (",Math.round(p.size/1024)," KB)"]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Dovoljeni formati: PDF, DOC, DOCX, XLS, XLSX, CSV (max 10MB)"})]}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-700/50",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-400 hover:text-white transition-colors",children:a("forms.cancel")}),e.jsx("button",{type:"submit",disabled:c||x,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:a(c||x?"forms.submitting":"forms.submit")})]})]})]})})},VD=[{key:"setting_key",label:"Klju nastavitve",type:"text",required:!0},{key:"setting_value",label:"Vrednost",type:"textarea",required:!0},{key:"setting_category",label:"Kategorija",type:"select",required:!0,options:["security","privacy","compliance","backup","audit","integration","notification","user_management","system","performance"]},{key:"data_type",label:"Tip podatkov",type:"select",required:!0,options:["string","number","boolean","json","encrypted"]},{key:"description",label:"Opis",type:"textarea"},{key:"is_sensitive",label:"Obutljivi podatki",type:"select",options:["true","false"]},{key:"requires_restart",label:"Zahteva ponovni zagon",type:"select",options:["true","false"]},{key:"validation_rule",label:"Pravilo validacije",type:"text"}];function HD({isOpen:s,onClose:t,onSave:r}){return e.jsx(ha,{isOpen:s,onClose:t,onSave:r,title:"Dodaj novo sistemsko nastavitev",table:"settings_advanced_config",fields:VD})}function ZD(){const{t:s}=et(),[t,r]=z.useState([]),[a,n]=z.useState(!0),[i,o]=z.useState(!1),c=async()=>{try{const{data:p,error:m}=await Ne.from("gdpr_privacy_policies").select("*").order("created_at",{ascending:!1});if(m)throw m;!p||p.length===0?r([{id:"demo-1",policy_name:"Politika obdelave osebnih podatkov zaposlenih",version:"2.1",effective_date:"2024-01-15",status:"active",approved_by:"Janez Novak",last_updated:"2024-11-01",description:"Celovita politika za obdelavo osebnih podatkov zaposlenih v skladu z GDPR in ZVOP-2, vkljuuje pravice do dostopa, popravka in izbrisa.",created_at:"2024-01-15T08:00:00Z",file_url:"/demo/politika_zaposlenih.pdf",file_name:"Politika_obdelave_podatkov_zaposlenih_v2.1.pdf",file_size:245760},{id:"demo-2",policy_name:"Politika hranjenja podatkov strank",version:"1.5",effective_date:"2024-03-01",status:"active",approved_by:"Marjeta Kova",last_updated:"2024-10-15",description:"Politika doloa roke hrambe in naine varnega hranjenja osebnih podatkov strank ter postopke za brisanje podatkov po poteku roka.",created_at:"2024-03-01T09:00:00Z",file_url:"/demo/politika_hranjenja_strank.pdf",file_name:"Politika_hranjenja_podatkov_strank_v1.5.pdf",file_size:189432},{id:"demo-3",policy_name:"Politika dostopa do osebnih podatkov",version:"3.0",effective_date:"2024-05-20",status:"active",approved_by:"Toma Bergant",last_updated:"2024-11-05",description:"Podrobna navodila za dostop do osebnih podatkov, vkljuuje naela najmanjih pravic, avtentikacijo in avtorizacijo uporabnikov.",created_at:"2024-05-20T10:00:00Z",file_url:"/demo/politika_dostopa.pdf",file_name:"Politika_dostopa_osebni_podatki_v3.0.pdf",file_size:312847},{id:"demo-4",policy_name:"Politika varstva podatkov otrok",version:"1.2",effective_date:"2024-07-10",status:"in_preparation",approved_by:"",last_updated:"2024-11-08",description:"Specifina politika za zaito otrok do 16. let v skladu s lenom 8 GDPR, vkljuuje dodatne varovalne ukrepe in overitve starevske privolitve.",created_at:"2024-07-10T11:00:00Z",file_url:"",file_name:"",file_size:0},{id:"demo-5",policy_name:"Politika mednarodnega prenosa podatkov",version:"2.3",effective_date:"2024-09-01",status:"expired",approved_by:"Petra Horvat",last_updated:"2024-09-01",description:"Politika za varen prenos osebnih podatkov v tretje drave in mednarodne organizacije z ustreznimi zaitnimi ukrepi in standardnimi pogodbenimi klavzulami.",created_at:"2024-09-01T12:00:00Z",file_url:"/demo/politika_mednarodni_prenos.pdf",file_name:"Politika_mednarodnega_prenosa_v2.3.pdf",file_size:156234}]):r(p)}catch(p){console.error("Error fetching data:",p),r([{id:"demo-1",policy_name:"Politika obdelave osebnih podatkov zaposlenih",version:"2.1",effective_date:"2024-01-15",status:"active",approved_by:"Janez Novak",last_updated:"2024-11-01",description:"Celovita politika za obdelavo osebnih podatkov zaposlenih v skladu z GDPR in ZVOP-2, vkljuuje pravice do dostopa, popravka in izbrisa.",created_at:"2024-01-15T08:00:00Z",file_url:"/demo/politika_zaposlenih.pdf",file_name:"Politika_obdelave_podatkov_zaposlenih_v2.1.pdf",file_size:245760},{id:"demo-2",policy_name:"Politika hranjenja podatkov strank",version:"1.5",effective_date:"2024-03-01",status:"active",approved_by:"Marjeta Kova",last_updated:"2024-10-15",description:"Politika doloa roke hrambe in naine varnega hranjenja osebnih podatkov strank ter postopke za brisanje podatkov po poteku roka.",created_at:"2024-03-01T09:00:00Z",file_url:"/demo/politika_hranjenja_strank.pdf",file_name:"Politika_hranjenja_podatkov_strank_v1.5.pdf",file_size:189432}])}finally{n(!1)}},d=()=>{c(),o(!1)};return z.useEffect(()=>{c()},[]),a?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-accent-primary/10 flex items-center justify-center",children:e.jsx(ut,{className:"w-5 h-5 text-accent-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:s("gdpr.privacyPolicy.title")}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:s("gdpr.privacyPolicy.subtitle")})]})]}),e.jsxs("button",{onClick:()=>o(!0),className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Dt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:s("gdpr.privacyPolicy.addPolicy")})]})]}),e.jsx("div",{className:"bg-bg-surface rounded-sm border border-border-subtle overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-pure-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("gdpr.privacyPolicy.policyName")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("common.version")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("gdpr.privacyPolicy.effectiveDate")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("common.lastUpdated")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("common.status")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("gdpr.privacyPolicy.approvedBy")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("tables.attachedFile")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("common.actions")})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:t.map(p=>e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-body text-text-primary font-medium",children:p.policy_name}),p.description&&e.jsx("div",{className:"text-caption text-text-tertiary mt-1 max-w-[300px] truncate",title:p.description,children:p.description})]})}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:p.version}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:new Date(p.effective_date).toLocaleDateString("sl-SI")}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:p.last_updated?new Date(p.last_updated).toLocaleDateString("sl-SI"):"-"}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium ${p.status==="active"?"bg-status-success/10 text-status-success":p.status==="in_preparation"?"bg-status-warning/10 text-status-warning":p.status==="expired"?"bg-status-error/10 text-status-error":"bg-bg-near-black/50 text-text-tertiary"}`,children:p.status==="active"?"Aktiven":p.status==="in_preparation"?"V pripravi":p.status==="expired"?"Potekel":s(`common.${p.status}`)})}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:p.approved_by||"-"}),e.jsx("td",{className:"px-6 py-4",children:p.file_url?e.jsxs("a",{href:p.file_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-accent-primary hover:text-accent-primary-hover transition-colors",title:p.file_name,children:[e.jsx(ut,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm truncate max-w-[150px]",children:p.file_name||"Datoteka"}),e.jsx(Ir,{className:"w-3 h-3"})]}):e.jsx("span",{className:"text-text-muted text-sm",children:"-"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",children:e.jsx(ar,{className:"w-4 h-4 text-text-secondary"})}),e.jsx("button",{className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",children:e.jsx(pr,{className:"w-4 h-4 text-status-error"})})]})})]},p.id))})]})})}),e.jsx(qD,{isOpen:i,onClose:()=>o(!1),onSave:d})]})}function WD(){const{t:s}=et(),[t,r]=z.useState([]),[a,n]=z.useState(!0),[i,o]=z.useState(!1),c=async()=>{try{const{data:p,error:m}=await Ne.from("gdpr_consent_management").select("*").order("created_at",{ascending:!1});if(m)throw m;r(p||[])}catch(p){console.error("Error:",p)}finally{n(!1)}},d=()=>{c(),o(!1)};return z.useEffect(()=>{c()},[]),a?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:s("gdpr.consent.title")}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:s("gdpr.consent.subtitle")})]}),e.jsxs("button",{onClick:()=>o(!0),className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Dt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:s("gdpr.consent.addConsent")})]})]}),e.jsx("div",{className:"bg-bg-surface rounded-sm border border-border-subtle overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-pure-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("gdpr.consent.userName")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("gdpr.consent.userEmail")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("gdpr.consent.consentType")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("gdpr.consent.consentStatus")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("common.date")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("tables.attachedFile")})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:t.map(p=>e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 text-body text-text-primary",children:p.subject_name}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:p.subject_email}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:p.consent_type}),e.jsx("td",{className:"px-6 py-4",children:p.consent_given?e.jsxs("span",{className:"flex items-center gap-2 text-status-success",children:[e.jsx(oS,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:s("gdpr.consent.consentGiven")})]}):e.jsxs("span",{className:"flex items-center gap-2 text-status-error",children:[e.jsx(Ss,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:s("gdpr.consent.consentDenied")})]})}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:p.consent_date?new Date(p.consent_date).toLocaleDateString("sl-SI"):"-"}),e.jsx("td",{className:"px-6 py-4",children:p.file_url?e.jsxs("a",{href:p.file_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-accent-primary hover:text-accent-primary-hover transition-colors",title:p.file_name,children:[e.jsx(ut,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm truncate max-w-[150px]",children:p.file_name||"Datoteka"}),e.jsx(Ir,{className:"w-3 h-3"})]}):e.jsx("span",{className:"text-text-muted text-sm",children:"-"})})]},p.id))})]})}),e.jsx(UD,{isOpen:i,onClose:()=>o(!1),onSave:d})]})}function KD(){var Y;const{t:s}=et(),[t,r]=z.useState([]),[a,n]=z.useState([]),[i,o]=z.useState(!0),[c,d]=z.useState(!1),[p,m]=z.useState(""),[x,b]=z.useState("all"),[h,j]=z.useState("all"),[g,v]=z.useState(1),[_]=z.useState(10),[k,P]=z.useState(null),[L,F]=z.useState(!1),[W,R]=z.useState(null),[B,A]=z.useState(!1),[S,C]=z.useState(!1),O=[{id:"1",request_id:"ZVOP-2024-001",subject_name:"Ana Novak",subject_email:"ana.novak@email.com",subject_phone:"+386 41 123 456",subject_address:"Dunajska cesta 15, 1000 Ljubljana",subject_type:"individual",request_date:"2025-10-15T08:30:00Z",request_type:"pravica do pozabe",status:"received",response_deadline:"2025-11-14T23:59:59Z",legal_basis_17_a:!0,legal_basis_17_b:!1,legal_basis_17_c:!1,legal_basis_17_d:!1,legal_basis_17_e:!1,legal_basis_17_f:!1,legal_basis_description:"Zahteva za izbris osebnih podatkov zaradi preklica soglasja",data_categories:["Kontaktni podatki","Demografski podatki"],data_description:"Ime, priimek, elektronski naslov, telefonska tevilka",data_system_location:"CRM sistem, e-potna baza",data_processing_period_from:"2020-03-01",data_processing_period_to:"2025-10-15",identity_verification_status:"verificirano",identity_document_type:"Osebna izkaznica",identity_document_number:"SI1234567",file_name:"zahteva_ana_novak.pdf",file_url:"/files/zahteva_ana_novak.pdf",organization_type:"javni sektor",notes:"Prosilka zahteva izbris vseh svojih podatkov iz naih evidenc"},{id:"2",request_id:"ZVOP-2024-002",subject_name:"Marko Kova",subject_email:"marko.kovac@podjetje.si",subject_phone:"+386 51 987 654",subject_address:"Celovka cesta 200, 2000 Maribor",subject_type:"individual",request_date:"2025-10-20T14:15:00Z",request_type:"dostop do podatkov",status:"processing",response_deadline:"2025-11-19T23:59:59Z",legal_basis_17_a:!1,legal_basis_17_b:!0,legal_basis_17_c:!1,legal_basis_17_d:!1,legal_basis_17_e:!1,legal_basis_17_f:!1,legal_basis_description:"Zahteva za dostop do osebnih podatkov po 15. lenu GDPR",data_categories:["Kadrovski podatki","Plailni podatki"],data_description:"Mesene plae, boniteti, davne informacije",data_system_location:"HR sistem, raunovodski sistem",data_processing_period_from:"2019-01-01",data_processing_period_to:"2025-10-20",identity_verification_status:"verificirano",identity_document_type:"Osebna izkaznica",identity_document_number:"SI9876543",file_name:"zahteva_marko_kovac.pdf",file_url:"/files/zahteva_marko_kovac.pdf",organization_type:"zasebni sektor",notes:"Zaposleni zahteva vpogled v svoje osebne podatke"},{id:"3",request_id:"ZVOP-2024-003",subject_name:"Petra Horvat",subject_email:"petra.horvat@gmail.com",subject_phone:"+386 40 555 777",subject_address:"Koroka cesta 45, 3000 Celje",subject_type:"individual",request_date:"2025-10-25T10:45:00Z",request_type:"popravek podatkov",status:"executed",response_deadline:"2025-11-24T23:59:59Z",legal_basis_17_a:!1,legal_basis_17_b:!1,legal_basis_17_c:!0,legal_basis_17_d:!1,legal_basis_17_e:!1,legal_basis_17_f:!1,legal_basis_description:"Poprava netonih osebnih podatkov po 16. lenu GDPR",data_categories:["Kontaktni podatki","Naslovni podatki"],data_description:"Naslov stalnega bivalia",data_system_location:"Spletna trgovina - uporabniki raun",data_processing_period_from:"2022-06-15",data_processing_period_to:"2025-10-25",identity_verification_status:"verificirano",identity_document_type:"Potni list",identity_document_number:"SL1111111",file_name:"zahteva_petra_horvat.pdf",file_url:"/files/zahteva_petra_horvat.pdf",organization_type:"zasebni sektor",notes:"Popravljen naslov stalnega bivalia v uporabnikem raunu"},{id:"4",request_id:"ZVOP-2024-004",subject_name:"Toma Bergant",subject_email:"t.bergant@podjetje-doo.si",subject_phone:"+386 30 123 789",subject_address:"Gosposka ulica 12, 9000 Murska Sobota",subject_type:"individual",request_date:"2025-11-01T16:20:00Z",request_type:"prenos podatkov",status:"additional_info_required",response_deadline:"2025-12-01T23:59:59Z",legal_basis_17_a:!1,legal_basis_17_b:!1,legal_basis_17_c:!1,legal_basis_17_d:!0,legal_basis_17_e:!1,legal_basis_17_f:!1,legal_basis_description:"Prenos podatkov k drugemu upravljavcu po 20. lenu GDPR",data_categories:["Raunovodski podatki","Projektni podatki"],data_description:"Fakture, pogodbe, projekti",data_system_location:"ERP sistem",data_processing_period_from:"2021-01-01",data_processing_period_to:"2025-11-01",identity_verification_status:"v postopku",identity_document_type:"Osebna izkaznica",identity_document_number:"SI2222222",file_name:"zahteva_tomaz_bergant.pdf",file_url:"/files/zahteva_tomaz_bergant.pdf",organization_type:"zasebni sektor",notes:"Zahtevan je prenos podatkov k novemu izvajalcu raunovodskih storitev"},{id:"5",request_id:"ZVOP-2024-005",subject_name:"Marija Zorman",subject_email:"marija.zorman@drustvo.org",subject_phone:"+386 70 333 444",subject_address:"Trubarjeva cesta 78, 2000 Koper",subject_type:"individual",request_date:"2025-11-05T09:10:00Z",request_type:"pravica do pozabe",status:"rejected",response_deadline:"2025-12-05T23:59:59Z",legal_basis_17_a:!1,legal_basis_17_b:!1,legal_basis_17_c:!1,legal_basis_17_d:!1,legal_basis_17_e:!0,legal_basis_17_f:!1,legal_basis_description:"Odmik zahteve za izbris zaradi zakonske obveznosti hranjenja",data_categories:["Pravni podatki","Dokumentacija"],data_description:"Pogodbe, potrdila o izobraevanju",data_system_location:"Arhiv drutva",data_processing_period_from:"2018-09-01",data_processing_period_to:"2025-11-05",identity_verification_status:"verificirano",identity_document_type:"Osebna izkaznica",identity_document_number:"SI3333333",file_name:"zahteva_marija_zorman.pdf",file_url:"/files/zahteva_marija_zorman.pdf",organization_type:"nevladna organizacija",notes:"Zahteva zavrnjena - podatki so potrebni za izpolnitev zakonskih obveznosti (5 let hranjenja)"},{id:"6",request_id:"ZVOP-2024-006",subject_name:"Janez Potonik",subject_email:"janez.potocnik@freelancer.com",subject_phone:"+386 41 666 888",subject_address:"Ulica heroja Maribora 1, 2000 Maribor",subject_type:"individual",request_date:"2025-11-08T13:30:00Z",request_type:"dostop do podatkov",status:"processing",response_deadline:"2025-12-08T23:59:59Z",legal_basis_17_a:!1,legal_basis_17_b:!0,legal_basis_17_c:!1,legal_basis_17_d:!1,legal_basis_17_e:!1,legal_basis_17_f:!1,legal_basis_description:"Pregled in dostop do osebnih podatkov po 15. lenu GDPR",data_categories:["Pogodbeni podatki","Kontaktni podatki","Projektni podatki"],data_description:"Samostojni podjetnik, podatki o projektih in strankah",data_system_location:"CRM sistem, upravljanje projektov",data_processing_period_from:"2023-03-01",data_processing_period_to:"2025-11-08",identity_verification_status:"verificirano",identity_document_type:"Osebna izkaznica",identity_document_number:"SI4444444",file_name:"zahteva_janez_potocnik.pdf",file_url:"/files/zahteva_janez_potocnik.pdf",organization_type:"samozaposlen",notes:"Samostojni podjetnik zahteva vpogled v podatke, ki se obdelujejo v naem sistemu"},{id:"7",request_id:"ZVOP-2024-007",subject_name:"Nua Kralj",subject_email:"nusa.kralj@student.uni-lj.si",subject_phone:"+386 51 777 999",subject_address:"Kardeljeva pload 1, 1000 Ljubljana",subject_type:"individual",request_date:"2025-11-09T11:00:00Z",request_type:"pravica do pozabe",status:"received",response_deadline:"2025-12-09T23:59:59Z",legal_basis_17_a:!0,legal_basis_17_b:!1,legal_basis_17_c:!1,legal_basis_17_d:!1,legal_basis_17_e:!1,legal_basis_17_f:!1,legal_basis_description:"Izbris podatkov tudenta po zakljuku tudija",data_categories:["tudentski podatki","Akademski podatki"],data_description:"Vpisni listi, ocene, diplomirane naloge",data_system_location:"tudentski informacijski sistem",data_processing_period_from:"2020-10-01",data_processing_period_to:"2025-11-09",identity_verification_status:"verificirano",identity_document_type:"tudentska izkaznica",identity_document_number:"SI5555555",file_name:"zahteva_nusa_kralj.pdf",file_url:"/files/zahteva_nusa_kralj.pdf",organization_type:"izobraevalna ustanova",notes:"tudentka zakljuuje tudij in zahteva izbris podatkov po izteku tudijskih obveznosti"}],Z=async()=>{try{const{data:H,error:he}=await Ne.from("gdpr_right_forgotten").select("*").order("request_date",{ascending:!1});if(he)throw he;!H||H.length===0?(C(!0),r(O),n(O)):(C(!1),r(H),n(H))}catch(H){console.error("Error loading records from database:",H),C(!0),r(O),n(O)}finally{o(!1)}};z.useEffect(()=>{let H=t;if(p&&(H=H.filter(he=>{var ge,K,T;return((ge=he.subject_name)==null?void 0:ge.toLowerCase().includes(p.toLowerCase()))||((K=he.subject_email)==null?void 0:K.toLowerCase().includes(p.toLowerCase()))||((T=he.request_id)==null?void 0:T.toLowerCase().includes(p.toLowerCase()))})),x!=="all"&&(H=H.filter(he=>he.status===x)),h!=="all"){const he=new Date;H=H.filter(ge=>{if(!ge.response_deadline)return!1;const K=new Date(ge.response_deadline),T=Math.ceil((K.getTime()-he.getTime())/(1e3*3600*24));switch(h){case"overdue":return T<0;case"urgent":return T>=0&&T<=3;case"normal":return T>3;default:return!0}})}n(H),v(1)},[t,p,x,h]);const te=Math.ceil(a.length/_),ce=(g-1)*_,re=ce+_,X=a.slice(ce,re),U=H=>{if(!H)return null;const he=new Date(H),ge=new Date;return Math.ceil((he.getTime()-ge.getTime())/(1e3*3600*24))},oe=H=>H===null?"text-text-secondary":H<0?"text-status-error":H<=3?"text-status-warning":"text-text-secondary",xe=()=>{Z(),d(!1)},J=H=>{P(H),F(!0)},$=H=>{R(H),A(!0)};if(z.useEffect(()=>{Z()},[]),i)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})});const Q=H=>{switch(H){case"completed":case"executed":return"bg-status-success/10 text-status-success";case"in_progress":case"processing":return"bg-status-warning/10 text-status-warning";case"pending":case"received":return"bg-blue-500/10 text-blue-400";case"rejected":return"bg-status-error/10 text-status-error";case"additional_info_required":return"bg-purple-500/10 text-purple-400";default:return"bg-bg-surface text-text-secondary"}},q=H=>{switch(H){case"completed":case"executed":return e.jsx(Rt,{className:"w-4 h-4"});case"in_progress":case"processing":return e.jsx(cs,{className:"w-4 h-4"});case"rejected":return e.jsx(pt,{className:"w-4 h-4"});default:return e.jsx(cs,{className:"w-4 h-4"})}},I=H=>{const he=[];return H.legal_basis_17_a&&he.push("a"),H.legal_basis_17_b&&he.push("b"),H.legal_basis_17_c&&he.push("c"),H.legal_basis_17_d&&he.push("d"),H.legal_basis_17_e&&he.push("e"),H.legal_basis_17_f&&he.push("f"),he.length>0?`17(1)${he.join(",")}`:"-"};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-accent-primary/10 flex items-center justify-center",children:e.jsx(pr,{className:"w-5 h-5 text-accent-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Evidence zahtevkov - pravica do pozabe"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Upravljanje zahtevkov za izbris osebnih podatkov"})]})]}),e.jsxs("button",{onClick:()=>d(!0),className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Dt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:"Nova zahteva"})]})]}),S&&e.jsx("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pt,{className:"w-5 h-5 text-blue-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-400",children:"Prikazani so demo podatki"}),e.jsx("p",{className:"text-xs text-blue-300",children:'Ker baza podatkov trenutno ne vsebuje zapisov ali je prilo do napake pri povezavi, so prikazani testni podatki. Dodajte nove zahtevke z gumbom "Nova zahteva".'})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-text-secondary",children:"Skupaj zahtevkov"}),e.jsx("p",{className:"text-2xl font-semibold text-text-primary",children:t.length})]}),e.jsx("div",{className:"w-8 h-8 bg-blue-500/10 rounded-lg flex items-center justify-center",children:e.jsx(ut,{className:"w-4 h-4 text-blue-400"})})]})}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-text-secondary",children:"V obdelavi"}),e.jsx("p",{className:"text-2xl font-semibold text-text-primary",children:t.filter(H=>["received","processing"].includes(H.status)).length})]}),e.jsx("div",{className:"w-8 h-8 bg-status-warning/10 rounded-lg flex items-center justify-center",children:e.jsx(cs,{className:"w-4 h-4 text-status-warning"})})]})}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-text-secondary",children:"Izvreno"}),e.jsx("p",{className:"text-2xl font-semibold text-text-primary",children:t.filter(H=>["completed","executed"].includes(H.status)).length})]}),e.jsx("div",{className:"w-8 h-8 bg-status-success/10 rounded-lg flex items-center justify-center",children:e.jsx(Rt,{className:"w-4 h-4 text-status-success"})})]})}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-text-secondary",children:"Prekoraen rok"}),e.jsx("p",{className:"text-2xl font-semibold text-text-primary",children:t.filter(H=>H.response_deadline&&U(H.response_deadline)<0).length})]}),e.jsx("div",{className:"w-8 h-8 bg-status-error/10 rounded-lg flex items-center justify-center",children:e.jsx(pt,{className:"w-4 h-4 text-status-error"})})]})})]}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ss,{className:"absolute left-3 top-3 w-4 h-4 text-text-secondary"}),e.jsx("input",{type:"text",placeholder:"Iskanje po imenu, emailu ali ID...",value:p,onChange:H=>m(H.target.value),className:"w-full pl-10 pr-3 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"})]}),e.jsxs("select",{value:x,onChange:H=>b(H.target.value),className:"px-3 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"all",children:"Vsi statusi"}),e.jsx("option",{value:"received",children:"Prejeto"}),e.jsx("option",{value:"processing",children:"V obdelavi"}),e.jsx("option",{value:"additional_info_required",children:"Potrebne dodatne info"}),e.jsx("option",{value:"executed",children:"Izvreno"}),e.jsx("option",{value:"rejected",children:"Zavrnjeno"})]}),e.jsxs("select",{value:h,onChange:H=>j(H.target.value),className:"px-3 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"all",children:"Vsi rokovniki"}),e.jsx("option",{value:"overdue",children:"Prekoraen rok"}),e.jsx("option",{value:"urgent",children:"Nujno (3 dni ali manj)"}),e.jsx("option",{value:"normal",children:"Normalno (ve kot 3 dni)"})]}),e.jsxs("div",{className:"flex items-center text-sm text-text-secondary",children:[e.jsx(Wp,{className:"w-4 h-4 mr-2"}),"Prikazano: ",a.length," od ",t.length]})]})}),e.jsxs("div",{className:"bg-bg-surface rounded-lg border border-border-subtle overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-pure-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-3 text-xs text-text-secondary uppercase tracking-wide",children:"ID Zahteve"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs text-text-secondary uppercase tracking-wide",children:"Ime"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs text-text-secondary uppercase tracking-wide",children:"Email"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs text-text-secondary uppercase tracking-wide",children:"Datum"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs text-text-secondary uppercase tracking-wide",children:"Status"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs text-text-secondary uppercase tracking-wide",children:"Pravna podlaga"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs text-text-secondary uppercase tracking-wide",children:"Rok"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs text-text-secondary uppercase tracking-wide",children:"Kategorije"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs text-text-secondary uppercase tracking-wide",children:"Dokumenti"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs text-text-secondary uppercase tracking-wide",children:"Akcije"})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:X.map(H=>{var ge,K;const he=U(H.response_deadline);return e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-text-primary font-mono",children:H.request_id}),e.jsx("td",{className:"px-4 py-3 text-sm text-text-primary",children:H.subject_name}),e.jsx("td",{className:"px-4 py-3 text-sm text-text-secondary",children:H.subject_email}),e.jsx("td",{className:"px-4 py-3 text-sm text-text-secondary",children:new Date(H.request_date).toLocaleDateString("sl-SI")}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${Q(H.status)}`,children:[q(H.status),e.jsxs("span",{className:"capitalize",children:[H.status==="received"&&"Prejeto",H.status==="processing"&&"V obdelavi",H.status==="executed"&&"Izvreno",H.status==="rejected"&&"Zavrnjeno",H.status==="additional_info_required"&&"Dodatne info"]})]})}),e.jsx("td",{className:"px-4 py-3 text-sm text-text-secondary",children:I(H)}),e.jsx("td",{className:"px-4 py-3 text-sm",children:H.response_deadline?e.jsxs("div",{className:`flex items-center gap-1 ${oe(he)}`,children:[e.jsx(_a,{className:"w-3 h-3"}),e.jsx("span",{children:he!==null&&he<0?`${Math.abs(he)} dni zamude`:he!==null&&he<=3?`${he} dni`:he!==null?`${he} dni`:"-"})]}):e.jsx("span",{className:"text-text-muted",children:"-"})}),e.jsx("td",{className:"px-4 py-3 text-sm text-text-secondary",children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[(ge=H.data_categories)==null?void 0:ge.slice(0,2).map((T,ee)=>e.jsx("span",{className:"px-1.5 py-0.5 bg-bg-near-black rounded text-xs",children:T},ee)),((K=H.data_categories)==null?void 0:K.length)>2&&e.jsxs("span",{className:"text-xs text-text-muted",children:["+",H.data_categories.length-2]})]})}),e.jsx("td",{className:"px-4 py-3",children:H.file_url?e.jsxs("a",{href:H.file_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-accent-primary hover:text-accent-primary-hover transition-colors",title:H.file_name,children:[e.jsx(ut,{className:"w-4 h-4"}),e.jsx(Ir,{className:"w-3 h-3"})]}):e.jsx("span",{className:"text-text-muted text-sm",children:"-"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>J(H),className:"p-1 text-text-secondary hover:text-accent-primary transition-colors",title:"Poglej podrobnosti",children:e.jsx(lr,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>$(H),className:"p-1 text-text-secondary hover:text-accent-primary transition-colors",title:"Uredi",children:e.jsx(ar,{className:"w-4 h-4"})})]})})]},H.id)})})]})}),te>1&&e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-t border-border-subtle",children:[e.jsxs("div",{className:"text-sm text-text-secondary",children:["Prikazano ",ce+1,"-",Math.min(re,a.length)," od ",a.length," zahtevkov"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>v(H=>Math.max(H-1,1)),disabled:g===1,className:"p-2 text-text-secondary hover:text-text-primary disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:e.jsx(ug,{className:"w-4 h-4"})}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,te)},(H,he)=>{let ge;return te<=5||g<=3?ge=he+1:g>=te-2?ge=te-4+he:ge=g-2+he,e.jsx("button",{onClick:()=>v(ge),className:`w-8 h-8 text-sm rounded transition-colors ${g===ge?"bg-accent-primary text-white":"text-text-secondary hover:text-text-primary hover:bg-bg-near-black"}`,children:ge},ge)})}),e.jsx("button",{onClick:()=>v(H=>Math.min(H+1,te)),disabled:g===te,className:"p-2 text-text-secondary hover:text-text-primary disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:e.jsx(ax,{className:"w-4 h-4"})})]})]})]}),e.jsx(S_,{isOpen:c,onClose:()=>d(!1),onSave:xe}),e.jsx(S_,{isOpen:B,onClose:()=>A(!1),onSave:()=>{Z(),A(!1),R(null)},editMode:!0,editRecord:W}),L&&k&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:()=>F(!1)}),e.jsxs("div",{className:"relative bg-bg-surface border border-border-subtle rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-border-subtle",children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary",children:["Podrobnosti zahtevka ",k.request_id]}),e.jsx("button",{onClick:()=>F(!1),className:"p-2 hover:bg-bg-near-black rounded transition-colors",children:e.jsx(Ar,{className:"w-5 h-5 text-text-secondary"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary mb-3",children:"Identifikacija"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Ime:"})," ",k.subject_name]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Email:"})," ",k.subject_email]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Telefon:"})," ",k.subject_phone||"-"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Naslov:"})," ",k.subject_address||"-"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Tip:"})," ",k.subject_type==="individual"?"Fizina oseba":"Predstavnik pravne osebe"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary mb-3",children:"Status in rokovnik"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Status:"})," ",k.status]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Datum zahteve:"})," ",new Date(k.request_date).toLocaleDateString("sl-SI")]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Rok za odgovor:"})," ",k.response_deadline?new Date(k.response_deadline).toLocaleDateString("sl-SI"):"-"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Tip organizacije:"})," ",k.organization_type||"-"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Dni do roka:"})," ",U(k.response_deadline)||"-"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary mb-3",children:"Pravna podlaga (GDPR len 17)"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Podlaga:"})," ",I(k)]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Opis:"})," ",k.legal_basis_description||"-"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary mb-3",children:"Podatki za izbris"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Kategorije:"})," ",((Y=k.data_categories)==null?void 0:Y.join(", "))||"-"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Opis:"})," ",k.data_description||"-"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Sistem:"})," ",k.data_system_location||"-"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Obdobje obdelave:"}),k.data_processing_period_from||k.data_processing_period_to?`${k.data_processing_period_from||"?"} - ${k.data_processing_period_to||"?"}`:"-"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary mb-3",children:"Verifikacija identitete"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Status verifikacije:"})," ",k.identity_verification_status||"-"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Tip dokumenta:"})," ",k.identity_document_type||"-"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"tevilka dokumenta:"})," ",k.identity_document_number||"-"]}),k.file_url&&e.jsxs("div",{children:[e.jsx("strong",{children:"Priloeni dokument:"}),e.jsx("a",{href:k.file_url,target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-accent-primary hover:text-accent-primary-hover",children:k.file_name||"Prenesi"})]})]})]}),k.notes&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary mb-3",children:"Dodatne opombe"}),e.jsx("p",{className:"text-sm text-text-secondary",children:k.notes})]})]})]})]})]})}const ho=[{id:"A1",title:"Identifikacija incidenta",description:"Osnovni podatki incidenta",icon:pt},{id:"A2",title:"Prizadeti sistemi",description:"Informacijski sistemi in podatki",icon:Mt},{id:"B",title:"Narava kritve",description:"Opis dogodka in obseg",icon:ut},{id:"C",title:"Kontakt",description:"DPO in kontaktne osebe",icon:Fa},{id:"D",title:"Ocena tveganja",description:"Analiza vpliva na posameznike",icon:pt},{id:"E",title:"Ukrepi",description:"Zajezitev in korekcije",icon:Rt},{id:"F",title:"ZVOP-2 zahteve",description:"Nacionalne specifike",icon:Mt},{id:"G",title:"Posredovanja",description:"Sledljivost prenosov",icon:ut},{id:"H",title:"Dokumentacija",description:"Priloge in dokazila",icon:ut}];function GD({isOpen:s,onClose:t,onSave:r}){const{t:a}=et(),[n,i]=z.useState(!1),[o,c]=z.useState(0),[d,p]=z.useState({breach_id:"",breach_start_datetime:"",detection_method:"",breach_type:[],affected_systems:[],data_categories:[],breach_description:"",root_cause:"",internal_external:"",estimated_individuals_affected:0,affected_records:0,time_span_start:"",time_span_end:"",dpo_name:"",dpo_email:"",dpo_phone:"",dpo_organization:"",risk_probability:"",risk_severity:"",likely_risk:!1,high_risk:!1,consequences:[],affected_areas:[],containment_measures:[],containment_datetime:"",corrective_measures:"",corrective_deadline:"",corrective_owner:"",processing_log_references:[],legal_hold:!1,legal_hold_type:"",special_processing:!1,special_processing_categories:[],data_location:"",csirt_notified:!1,csirt_notification_datetime:"",csirt_reference:"",transfers_made:!1,evidence_attachments:[],severity:"medium",status:"investigating"});z.useEffect(()=>{if(!d.breach_id){const _=new Date().getFullYear(),k=String(new Date().getMonth()+1).padStart(2,"0"),P=Math.random().toString(36).substring(2,6).toUpperCase(),L=`GDPR-${_}${k}-${P}`;p(F=>({...F,breach_id:L}))}},[d.breach_id]),z.useEffect(()=>{if(!d.breach_start_datetime){const _=new Date().toISOString().slice(0,16);p(k=>({...k,breach_start_datetime:_,time_span_start:_,time_span_end:_}))}},[d.breach_start_datetime]);const m=async _=>{try{if(_.size>10485760)return alert("Datoteka je prevelika (maksimalno 10MB)"),null;const k=_.name.split(".").pop(),L=`gdpr-incidents/${`${Date.now()}-${Math.random().toString(36).substring(7)}.${k}`}`,{data:F,error:W}=await Ne.storage.from("gdpr-attachments").upload(L,_);if(W)throw W;const{data:{publicUrl:R}}=Ne.storage.from("gdpr-attachments").getPublicUrl(L);return{url:R,name:_.name,size:_.size}}catch(k){return console.error("File upload error:",k),alert("Napaka pri nalaganju datoteke"),null}},x=async _=>{_.preventDefault(),i(!0);try{let k=null;if(d.evidence_attachments.length>0&&(k=await m(d.evidence_attachments[0]),!k)){i(!1);return}const P={...d,breach_date:d.breach_start_datetime,discovery_date:d.breach_start_datetime,data_subjects_categories:d.data_categories,affected_records:parseInt(d.affected_records.toString())||0,estimated_individuals_affected:parseInt(d.estimated_individuals_affected.toString())||0,reported_to_authority:d.likely_risk,...k&&{file_url:k.url,file_name:k.name,file_size:k.size}},{error:L}=await Ne.from("gdpr_data_breach_log").insert([P]);if(L)throw L;r(),t(),b()}catch(k){console.error("Error:",k),alert("Napaka pri shranjevanju")}finally{i(!1)}},b=()=>{p({breach_id:"",breach_start_datetime:"",detection_method:"",breach_type:[],affected_systems:[],data_categories:[],breach_description:"",root_cause:"",internal_external:"",estimated_individuals_affected:0,affected_records:0,time_span_start:"",time_span_end:"",dpo_name:"",dpo_email:"",dpo_phone:"",dpo_organization:"",risk_probability:"",risk_severity:"",likely_risk:!1,high_risk:!1,consequences:[],affected_areas:[],containment_measures:[],containment_datetime:"",corrective_measures:"",corrective_deadline:"",corrective_owner:"",processing_log_references:[],legal_hold:!1,legal_hold_type:"",special_processing:!1,special_processing_categories:[],data_location:"",csirt_notified:!1,csirt_notification_datetime:"",csirt_reference:"",transfers_made:!1,evidence_attachments:[],severity:"medium",status:"investigating"}),c(0)},h=(_,k)=>{p(P=>({...P,[_]:k}))},j=(_,k,P)=>{p(L=>{const F=L[_];return P?{...L,[_]:[...F,k]}:{...L,[_]:F.filter(W=>W!==k)}})},g=()=>{switch(ho[o].id){case"A1":return d.breach_id&&d.breach_start_datetime&&d.detection_method;case"A2":return d.breach_type.length>0&&d.data_categories.length>0;case"B":return d.breach_description&&d.root_cause&&d.internal_external;case"C":return d.dpo_name&&d.dpo_email;case"D":return d.risk_probability&&d.risk_severity;case"E":return d.containment_measures.length>0;default:return!0}};if(!s)return null;const v=()=>{switch(ho[o].id){case"A1":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:["ID incidenta ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"text",required:!0,value:d.breach_id,onChange:k=>h("breach_id",k.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",placeholder:"Avtomatsko generiran"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:["Datum in as nastanka ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"datetime-local",required:!0,value:d.breach_start_datetime,onChange:k=>h("breach_start_datetime",k.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:["Kako je bil incident odkrit? ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsxs("select",{required:!0,value:d.detection_method,onChange:k=>h("detection_method",k.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"",children:"Izberite nain odkritja"}),e.jsx("option",{value:"automatic",children:"Avtomatski (SIEM, antivirus)"}),e.jsx("option",{value:"manual",children:"Rono (uporabnik, zaposlen)"}),e.jsx("option",{value:"third_party",children:"Tretja oseba (partner, nadzorni organ)"}),e.jsx("option",{value:"other",children:"Drugo"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:["Tip kritve ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:["confidentiality","integrity","availability"].map(k=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:d.breach_type.includes(k),onChange:P=>j("breach_type",k,P.target.checked),className:"rounded border-border-subtle"}),e.jsxs("span",{className:"text-sm text-text-primary",children:[k==="confidentiality"&&"Razkritje (zaupnost)",k==="integrity"&&"Izguba integritete",k==="availability"&&"Izguba dostopnosti"]})]},k))})]})]});case"A2":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:["Kategorije podatkov (GDPR len 33(3)(a)) ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[{value:"identifiers",label:"Osebni identifikatorji (ime, EMO, davna tevilka)"},{value:"contact",label:"Kontaktni podatki (e-naslov, telefon, naslov)"},{value:"demographic",label:"Demografski podatki (starost, spol, dravljanstvo)"},{value:"financial",label:"Finanni podatki (banni raun, plaila)"},{value:"health",label:"Zdravstveni podatki (diagnoze, zdravljenje)"},{value:"biometric",label:"Biometrini podatki (prstni odtisi, prepoznavanje obraza)"},{value:"location",label:"Lokacijski podatki (GPS, IP naslovi)"}].map(k=>e.jsxs("label",{className:"flex items-start gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:d.data_categories.includes(k.value),onChange:P=>j("data_categories",k.value,P.target.checked),className:"rounded border-border-subtle mt-1"}),e.jsx("span",{className:"text-sm text-text-primary",children:k.label})]},k.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Informacijski sistem"}),e.jsx("input",{type:"text",value:d.affected_systems.join(", "),onChange:k=>h("affected_systems",k.target.value.split(", ").filter(P=>P)),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",placeholder:"ERP sistem, CRM, spletna aplikacija..."})]})]});case"B":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:["Opis kritve ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("textarea",{rows:4,required:!0,value:d.breach_description,onChange:k=>h("breach_description",k.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none resize-vertical",placeholder:"Opisnite natanno, kaj se je zgodilo, kdaj in kako..."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:["Vzrok kritve ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsxs("select",{required:!0,value:d.root_cause,onChange:k=>h("root_cause",k.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"",children:"Izberite vzrok"}),e.jsx("option",{value:"human_error",children:"loveka napaka"}),e.jsx("option",{value:"technical_error",children:"Tehnina napaka"}),e.jsx("option",{value:"cyber_attack",children:"Kibernetski napad"}),e.jsx("option",{value:"natural_disaster",children:"Naravna nesrea"}),e.jsx("option",{value:"malicious_internal",children:"Notranja zlonamerna dejanja"}),e.jsx("option",{value:"external_events",children:"Zunanji dogodki"}),e.jsx("option",{value:"unknown",children:"Neznan"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:["Notranja ali zunanja kritev? ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsxs("select",{required:!0,value:d.internal_external,onChange:k=>h("internal_external",k.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"",children:"Izberite vrsto"}),e.jsx("option",{value:"internal",children:"Notranja (zaposleni, pogodbeniki)"}),e.jsx("option",{value:"external",children:"Zunanja (partnerji, stranke, neznanci)"}),e.jsx("option",{value:"mixed",children:"Meana (kombinacija obeh)"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"tevilo prizadetih posameznikov"}),e.jsx("input",{type:"number",min:"0",value:d.estimated_individuals_affected,onChange:k=>h("estimated_individuals_affected",parseInt(k.target.value)||0),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",placeholder:"e neznano, ocenite"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"tevilo evidenc/zapisov"}),e.jsx("input",{type:"number",min:"0",value:d.affected_records,onChange:k=>h("affected_records",parseInt(k.target.value)||0),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",placeholder:"Skupno tevilo prizadetenih podatkovnih enot"})]})]})]});case"C":return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{children:e.jsx("h3",{className:"text-h5 text-text-primary mb-4",children:"DPO ali kontaktna oseba (GDPR len 33(3)(b))"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:["Ime in priimek ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"text",required:!0,value:d.dpo_name,onChange:k=>h("dpo_name",k.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",placeholder:"Ime Priimek"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Funkcija/vloga"}),e.jsx("input",{type:"text",value:d.dpo_organization,onChange:k=>h("dpo_organization",k.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",placeholder:"DPO, IT Manager, Security Officer..."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:["E-naslov ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"email",required:!0,value:d.dpo_email,onChange:k=>h("dpo_email",k.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",placeholder:"dpo@podjetje.si"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Telefon"}),e.jsx("input",{type:"tel",value:d.dpo_phone,onChange:k=>h("dpo_phone",k.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",placeholder:"+386 1 234 5678"})]})]})]});case"D":return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{children:e.jsx("h3",{className:"text-h5 text-text-primary mb-4",children:"Ocena tveganja in posledice (GDPR len 33(3)(c))"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:["Verjetnost zlorabe podatkov ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsxs("select",{required:!0,value:d.risk_probability,onChange:k=>h("risk_probability",k.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"",children:"Izberite verjetnost"}),e.jsx("option",{value:"very_low",children:"Zelo nizka (0-10%)"}),e.jsx("option",{value:"low",children:"Nizka (11-30%)"}),e.jsx("option",{value:"medium",children:"Srednja (31-60%)"}),e.jsx("option",{value:"high",children:"Visoka (61-90%)"}),e.jsx("option",{value:"very_high",children:"Zelo visoka (91-100%)"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:["Resnost posledic ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsxs("select",{required:!0,value:d.risk_severity,onChange:k=>h("risk_severity",k.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"",children:"Izberite resnost"}),e.jsx("option",{value:"minimal",children:"Minimalna (brez opaznih posledic)"}),e.jsx("option",{value:"low",children:"Nizka (manje neprijetnosti)"}),e.jsx("option",{value:"medium",children:"Srednja (opazne motnje, nekaj neprijetnosti)"}),e.jsx("option",{value:"high",children:"Visoka (resne motnje, znatne neprijetnosti)"}),e.jsx("option",{value:"critical",children:"Kritina (hude posledice, trajna koda)"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:["Ali gre za verjetno tveganje? ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsxs("select",{required:!0,value:d.likely_risk?"true":"false",onChange:k=>h("likely_risk",k.target.value==="true"),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"false",children:"Ne"}),e.jsx("option",{value:"true",children:"Da"})]}),d.likely_risk&&e.jsx("p",{className:"text-xs text-status-warning mt-1",children:" e Da = prijava IP obvezna"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:["Ali gre za veliko tiskanje? ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsxs("select",{required:!0,value:d.high_risk?"true":"false",onChange:k=>h("high_risk",k.target.value==="true"),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"false",children:"Ne"}),e.jsx("option",{value:"true",children:"Da"}),e.jsx("option",{value:"unknown",children:"Ni znano"})]}),d.high_risk&&e.jsx("p",{className:"text-xs text-status-warning mt-1",children:" e Da = obvestilo posameznikom obvezno"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Posledice za posameznike"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[{value:"identity_theft",label:"Identitetna zloraba"},{value:"financial_damage",label:"Finanna koda"},{value:"discrimination",label:"Diskriminacija"},{value:"privacy_loss",label:"Izguba zasebnosti"},{value:"reputation_damage",label:"Reputacijska koda"},{value:"psychological_harm",label:"Psiholoke motnje"},{value:"physical_safety",label:"Fizina varnost ogroena"},{value:"social_impact",label:"Drubeni vpliv"}].map(k=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:d.consequences.includes(k.value),onChange:P=>j("consequences",k.value,P.target.checked),className:"rounded border-border-subtle"}),e.jsx("span",{className:"text-sm text-text-primary",children:k.label})]},k.value))})]})]});case"E":return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{children:e.jsx("h3",{className:"text-h5 text-text-primary mb-4",children:"Ukrepi (GDPR len 33(3)(d))"})}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:["Ukrepi zajezitve (e sprejeti) ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[{value:"system_isolation",label:"Izolacija prizadetenega sistema"},{value:"password_change",label:"Sprememba gesel/dostopov"},{value:"account_deactivation",label:"Deaktivacija raunov"},{value:"ip_blocking",label:"Blokiranje IP naslovov"},{value:"security_patches",label:"Posodobitev varnostnih popravkov"},{value:"data_removal",label:"Umik podatkov iz spleta"}].map(k=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:d.containment_measures.includes(k.value),onChange:P=>j("containment_measures",k.value,P.target.checked),className:"rounded border-border-subtle"}),e.jsx("span",{className:"text-sm text-text-primary",children:k.label})]},k.value))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"as izvedbe ukrepov zajezitve"}),e.jsx("input",{type:"datetime-local",value:d.containment_datetime,onChange:k=>h("containment_datetime",k.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Rok izvedbe korektivnih ukrepov"}),e.jsx("input",{type:"date",value:d.corrective_deadline,onChange:k=>h("corrective_deadline",k.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Nartovani korektivni ukrepi"}),e.jsx("textarea",{rows:4,value:d.corrective_measures,onChange:k=>h("corrective_measures",k.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none resize-vertical",placeholder:"Opisnite ukrepe za prepreevanje ponovitve..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Odgovorna oseba za izvedbo"}),e.jsx("input",{type:"text",value:d.corrective_owner,onChange:k=>h("corrective_owner",k.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",placeholder:"Ime in priimek odgovorne osebe"})]})]});case"F":return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{children:e.jsx("h3",{className:"text-h5 text-text-primary mb-4",children:"ZVOP-2 nacionalne zahteve"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Ali sistem obdeluje posebne podatke? (ZVOP-2 len 23)"}),e.jsxs("select",{value:d.special_processing?"yes":"no",onChange:k=>h("special_processing",k.target.value==="yes"),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"no",children:"Ne"}),e.jsx("option",{value:"yes",children:"Da"}),e.jsx("option",{value:"partial",children:"Delno"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Lokacija hrambe podatkov"}),e.jsxs("select",{value:d.data_location,onChange:k=>h("data_location",k.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"",children:"Izberite lokacijo"}),e.jsx("option",{value:"slovenia_only",children:"Samo v RS (obvezno za zbirke iz 23. lena)"}),e.jsx("option",{value:"slovenia_eu",children:"V RS in EU/EEA"}),e.jsx("option",{value:"outside_eu",children:"Izven EU/EEA (s primernimi zaitnimi ukrepi)"}),e.jsx("option",{value:"unknown",children:"Ni znano"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Ali je potrebna priglasitev CSIRT? (ZInfV-1)"}),e.jsxs("select",{value:d.csirt_notified?"yes":"no",onChange:k=>{const P=k.target.value==="yes";if(h("csirt_notified",P),P){const L=new Date().toISOString().slice(0,16);h("csirt_notification_datetime",L)}},className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"no",children:"Ne"}),e.jsx("option",{value:"yes",children:"Da"}),e.jsx("option",{value:"unknown",children:"Ni znano"})]})]}),d.csirt_notified&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Datum priglasitve CSIRT"}),e.jsx("input",{type:"datetime-local",value:d.csirt_notification_datetime,onChange:k=>h("csirt_notification_datetime",k.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"})]})]});case"G":return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{children:e.jsx("h3",{className:"text-h5 text-text-primary mb-4",children:"Sledljivost posredovanj (ZVOP-2 len 41)"})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Ali so bili podatki posredovani tretjim osebam?"}),e.jsxs("select",{value:d.transfers_made?"yes":"no",onChange:k=>h("transfers_made",k.target.value==="yes"),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"no",children:"Ne"}),e.jsx("option",{value:"yes",children:"Da"}),e.jsx("option",{value:"partial",children:"Delno"})]}),e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Rok hrambe evidence posredovanj: 2 leti od datuma posredovanja (ZVOP-2 len 41)"})]})]});case"H":return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{children:e.jsx("h3",{className:"text-h5 text-text-primary mb-4",children:"Dokumentacija in dokazila"})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Priloena dokumentacija"}),e.jsx("input",{type:"file",accept:".pdf,.doc,.docx,.jpg,.png",multiple:!0,onChange:k=>{const P=Array.from(k.target.files||[]);h("evidence_attachments",P)},className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary file:mr-4 file:py-1 file:px-2 file:rounded file:border-0 file:text-sm file:font-medium file:bg-accent-primary file:text-white hover:file:bg-accent-primary-hover"}),e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Dovoljene vrste: PDF, DOC, JPG, PNG | Max velikost: 10MB na datoteko"}),d.evidence_attachments.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm text-text-secondary mb-2",children:"Izbrane datoteke:"}),d.evidence_attachments.map((k,P)=>e.jsxs("div",{className:"text-sm text-text-primary bg-bg-near-black px-3 py-2 rounded mb-2",children:[k.name," (",Math.round(k.size/1024)," KB)"]},P))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Dodatne opombe"}),e.jsx("textarea",{rows:3,className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none resize-vertical",placeholder:"Dodatne informacije, ki niso zajete v zgornjih poljih..."})]})]});default:return null}};return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:t}),e.jsxs("div",{className:"relative bg-bg-surface border border-border-subtle rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-border-subtle",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(pt,{className:"w-6 h-6 text-accent-primary"}),e.jsx("h2",{className:"text-h3 text-text-primary",children:"Evidenca incidenta - GDPR len 33-34"})]}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",children:e.jsx(Ar,{className:"w-5 h-5 text-text-secondary"})})]}),e.jsxs("form",{onSubmit:x,className:"p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm text-text-secondary",children:["Korak ",o+1," od ",ho.length]}),e.jsxs("span",{className:"text-sm text-text-secondary",children:[Math.round((o+1)/ho.length*100),"%"]})]}),e.jsx("div",{className:"w-full bg-bg-near-black rounded-full h-2",children:e.jsx("div",{className:"bg-accent-primary h-2 rounded-full transition-all duration-300",style:{width:`${(o+1)/ho.length*100}%`}})})]}),e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsx("div",{className:"flex items-center gap-2 overflow-x-auto",children:ho.map((_,k)=>{const P=_.icon;return e.jsxs("button",{type:"button",onClick:()=>c(k),className:`flex items-center gap-2 px-3 py-2 rounded text-sm transition-colors whitespace-nowrap ${o===k?"bg-accent-primary text-white":k<o?"bg-status-success/10 text-status-success":"bg-bg-near-black text-text-secondary hover:text-text-primary"}`,children:[e.jsx(P,{className:"w-4 h-4"}),e.jsxs("span",{className:"hidden md:inline",children:[_.id,": ",_.title]}),e.jsx("span",{className:"md:hidden",children:_.id})]},_.id)})})}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-accent-primary/10 flex items-center justify-center",children:e.jsx(pt,{className:"w-5 h-5 text-accent-primary"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-h5 text-text-primary",children:[ho[o].id,": ",ho[o].title]}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:ho[o].description})]})]}),v()]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-border-subtle",children:[e.jsx("div",{children:o>0&&e.jsxs("button",{type:"button",onClick:()=>c(o-1),className:"flex items-center gap-2 px-4 py-2 bg-bg-near-black text-text-primary border border-border-subtle rounded hover:bg-bg-surface transition-colors duration-150",children:[e.jsx(rx,{className:"w-4 h-4"}),"Prejnji korak"]})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 bg-bg-near-black text-text-primary border border-border-subtle rounded hover:bg-bg-surface transition-colors duration-150",children:"Preklii"}),o<ho.length-1?e.jsxs("button",{type:"button",onClick:()=>{g()?c(o+1):alert("Prosim izpolnite vsa obvezna polja pred nadaljevanjem.")},disabled:!g(),className:"flex items-center gap-2 px-4 py-2 bg-accent-primary text-white rounded hover:bg-accent-primary-hover transition-colors duration-150 disabled:opacity-50",children:["Naslednji korak",e.jsx(lg,{className:"w-4 h-4"})]}):e.jsxs("button",{type:"submit",disabled:n,className:"flex items-center gap-2 px-4 py-2 bg-status-success text-white rounded hover:bg-status-success-hover transition-colors duration-150 disabled:opacity-50",children:[e.jsx(Kp,{className:"w-4 h-4"}),n?"Shranjevanje...":"Shrani incident"]})]})]})]})]})]})}function YD({isOpen:s,onClose:t,incident:r,onSave:a}){const{t:n}=et(),[i,o]=z.useState(!1),[c,d]=z.useState(!1),[p,m]=z.useState(r||{}),x=async()=>{d(!0);try{const{error:v}=await Ne.from("gdpr_data_breach_log").update(p).eq("id",r.id);if(v)throw v;a(),o(!1)}catch(v){console.error("Error:",v),alert("Napaka pri shranjevanju")}finally{d(!1)}},b=v=>{switch(v==null?void 0:v.toLowerCase()){case"critical":return"bg-risk-critical/20 text-risk-critical border-risk-critical/30";case"high":return"bg-risk-high/20 text-risk-high border-risk-high/30";case"medium":return"bg-risk-medium/20 text-risk-medium border-risk-medium/30";default:return"bg-risk-low/20 text-risk-low border-risk-low/30"}},h=v=>{switch(v==null?void 0:v.toLowerCase()){case"resolved":return"bg-status-success/10 text-status-success border-status-success/20";case"contained":return"bg-accent-primary/10 text-accent-primary border-accent-primary/20";case"investigating":return"bg-status-warning/10 text-status-warning border-status-warning/20";default:return"bg-text-muted/10 text-text-muted border-text-muted/20"}},j=v=>v?new Date(v).toLocaleString("sl-SI",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-",g=v=>{const _=new Date(v),P=Math.floor((new Date().getTime()-_.getTime())/(1e3*60*60));return P<1?"Pravkar":P<24?`Pred ${P} urami`:`Pred ${Math.floor(P/24)} dnevi`};return s?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:t}),e.jsxs("div",{className:"relative bg-bg-surface border border-border-subtle rounded-lg shadow-xl max-w-5xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-border-subtle",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-accent-primary/10 flex items-center justify-center",children:e.jsx(pt,{className:"w-5 h-5 text-accent-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-h3 text-text-primary",children:r==null?void 0:r.breach_id}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Podrobnosti incidenta po GDPR lenih 33-34"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>o(!i),className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",title:"Uredi",children:e.jsx(ar,{className:"w-5 h-5 text-accent-primary"})}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",children:e.jsx(Ar,{className:"w-5 h-5 text-text-secondary"})})]})]}),e.jsxs("div",{className:"p-6 space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-bg-near-black rounded-sm border border-border-subtle p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded flex items-center justify-center ${b(r==null?void 0:r.severity)}`,children:e.jsx(pt,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Resnost"}),e.jsx("p",{className:"text-h5 text-text-primary capitalize",children:r==null?void 0:r.severity})]})]})}),e.jsx("div",{className:"bg-bg-near-black rounded-sm border border-border-subtle p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded flex items-center justify-center ${h(r==null?void 0:r.status)}`,children:e.jsx(cs,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Status"}),e.jsx("p",{className:"text-h5 text-text-primary capitalize",children:r==null?void 0:r.status})]})]})}),e.jsx("div",{className:"bg-bg-near-black rounded-sm border border-border-subtle p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded flex items-center justify-center ${r!=null&&r.ip_notification_sent?"bg-status-success/10 text-status-success":"bg-text-muted/10 text-text-muted"}`,children:r!=null&&r.ip_notification_sent?e.jsx(Rt,{className:"w-4 h-4"}):e.jsx(bu,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Prijava IP"}),e.jsx("p",{className:"text-h5 text-text-primary",children:r!=null&&r.ip_notification_sent?"Da":"Ne"})]})]})}),e.jsx("div",{className:"bg-bg-near-black rounded-sm border border-border-subtle p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded flex items-center justify-center ${r!=null&&r.data_subjects_notified?"bg-status-success/10 text-status-success":"bg-text-muted/10 text-text-muted"}`,children:r!=null&&r.data_subjects_notified?e.jsx(Rt,{className:"w-4 h-4"}):e.jsx(Fa,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Obveeni"}),e.jsx("p",{className:"text-h5 text-text-primary",children:r!=null&&r.data_subjects_notified?"Da":"Ne"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[e.jsxs("div",{className:"bg-bg-near-black rounded-sm border border-border-subtle p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(pt,{className:"w-5 h-5 text-accent-primary"}),e.jsx("h3",{className:"text-h5 text-text-primary",children:"A1: Identifikacija incidenta"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"ID incidenta"}),e.jsx("p",{className:"text-body text-text-primary font-mono",children:r==null?void 0:r.breach_id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Nastanek kritve"}),e.jsxs("p",{className:"text-body text-text-primary",children:[j(r==null?void 0:r.breach_start_datetime),e.jsxs("span",{className:"text-xs text-text-muted ml-2",children:["(",g(r==null?void 0:r.breach_start_datetime),")"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Nain odkritja"}),e.jsx("p",{className:"text-body text-text-primary",children:r==null?void 0:r.detection_method})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"asovni razpon"}),e.jsxs("p",{className:"text-body text-text-primary",children:[j(r==null?void 0:r.time_span_start)," - ",j(r==null?void 0:r.time_span_end)]})]})]})]}),e.jsxs("div",{className:"bg-bg-near-black rounded-sm border border-border-subtle p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(ut,{className:"w-5 h-5 text-accent-primary"}),e.jsx("h3",{className:"text-h5 text-text-primary",children:"A2: Narava kritve"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Tip kritve"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r!=null&&r.breach_type&&Array.isArray(r.breach_type)?r.breach_type.map(v=>e.jsx("span",{className:"px-2 py-1 bg-accent-primary/10 text-accent-primary rounded text-sm",children:v},v)):e.jsx("span",{className:"px-2 py-1 bg-accent-primary/10 text-accent-primary rounded text-sm",children:(r==null?void 0:r.breach_type)||"Ni doloen"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Opis kritve"}),e.jsx("p",{className:"text-body text-text-primary",children:r==null?void 0:r.breach_description})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Vzrok"}),e.jsx("p",{className:"text-body text-text-primary",children:r==null?void 0:r.root_cause})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Notranja/Zunanja"}),e.jsx("p",{className:"text-body text-text-primary",children:r==null?void 0:r.internal_external})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Prizadeti sistemi"}),e.jsx("p",{className:"text-body text-text-primary",children:r!=null&&r.affected_systems&&Array.isArray(r.affected_systems)?r.affected_systems.join(", "):(r==null?void 0:r.affected_systems)||"Ni doloeno"})]})]})]})]}),e.jsxs("div",{className:"bg-bg-near-black rounded-sm border border-border-subtle p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(Fa,{className:"w-5 h-5 text-accent-primary"}),e.jsx("h3",{className:"text-h5 text-text-primary",children:"B: Obseg kritve"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Prizadeti posamezniki"}),e.jsx("p",{className:"text-h4 text-text-primary",children:(r==null?void 0:r.estimated_individuals_affected)||0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Prizadeti zapisi"}),e.jsx("p",{className:"text-h4 text-text-primary",children:(r==null?void 0:r.affected_records)||0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Kategorije podatkov"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r!=null&&r.data_categories&&Array.isArray(r.data_categories)?r.data_categories.map(v=>e.jsx("span",{className:"px-2 py-1 bg-bg-surface text-text-primary rounded text-sm border border-border-subtle",children:v},v)):e.jsx("span",{className:"px-2 py-1 bg-bg-surface text-text-primary rounded text-sm border border-border-subtle",children:(r==null?void 0:r.data_categories)||"Ni doloeno"})})]})]})]}),e.jsxs("div",{className:"bg-bg-near-black rounded-sm border border-border-subtle p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(Mt,{className:"w-5 h-5 text-accent-primary"}),e.jsx("h3",{className:"text-h5 text-text-primary",children:"E: Ukrepi in ukrepanje"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Ukrepi zajezitve"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r!=null&&r.containment_measures&&Array.isArray(r.containment_measures)?r.containment_measures.map(v=>e.jsx("span",{className:"px-2 py-1 bg-status-success/10 text-status-success rounded text-sm",children:v},v)):e.jsx("span",{className:"px-2 py-1 bg-status-success/10 text-status-success rounded text-sm",children:(r==null?void 0:r.containment_measures)||"Ni doloeno"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Korektivni ukrepi"}),e.jsx("p",{className:"text-body text-text-primary",children:r==null?void 0:r.corrective_measures})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Rok korektivnih ukrepov"}),e.jsx("p",{className:"text-body text-text-primary",children:j(r==null?void 0:r.corrective_deadline)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Odgovorna oseba"}),e.jsx("p",{className:"text-body text-text-primary",children:r==null?void 0:r.corrective_owner})]})]})]})]})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-bg-near-black rounded-sm border border-border-subtle p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(bu,{className:"w-5 h-5 text-accent-primary"}),e.jsx("h3",{className:"text-h5 text-text-primary",children:"C: Kontakt (GDPR 33(3)(b))"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"DPO ime"}),e.jsx("p",{className:"text-body text-text-primary",children:r==null?void 0:r.dpo_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"E-pota"}),e.jsx("p",{className:"text-body text-text-primary",children:r==null?void 0:r.dpo_email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Telefon"}),e.jsx("p",{className:"text-body text-text-primary",children:r==null?void 0:r.dpo_phone})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Organizacija"}),e.jsx("p",{className:"text-body text-text-primary",children:r==null?void 0:r.dpo_organization})]})]})]}),e.jsxs("div",{className:"bg-bg-near-black rounded-sm border border-border-subtle p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(pt,{className:"w-5 h-5 text-accent-primary"}),e.jsx("h3",{className:"text-h5 text-text-primary",children:"D: Ocena tveganja (GDPR 33(3)(c))"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Verjetnost zlorabe"}),e.jsx("p",{className:"text-body text-text-primary",children:r==null?void 0:r.risk_probability})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Resnost posledic"}),e.jsx("p",{className:"text-body text-text-primary",children:r==null?void 0:r.risk_severity})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-text-secondary",children:"Verjetno tveganje"}),e.jsx("span",{className:`text-sm ${r!=null&&r.likely_risk?"text-status-warning":"text-text-muted"}`,children:r!=null&&r.likely_risk?"Da":"Ne"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-text-secondary",children:"Veliko tiskanje"}),e.jsx("span",{className:`text-sm ${r!=null&&r.high_risk?"text-status-warning":"text-text-muted"}`,children:r!=null&&r.high_risk?"Da":"Ne"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Mone posledice"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:r!=null&&r.consequences&&Array.isArray(r.consequences)?r.consequences.map(v=>e.jsx("span",{className:"px-2 py-1 bg-status-warning/10 text-status-warning rounded text-xs",children:v},v)):e.jsx("span",{className:"px-2 py-1 bg-status-warning/10 text-status-warning rounded text-xs",children:(r==null?void 0:r.consequences)||"Ni doloeno"})})]})]})]}),e.jsxs("div",{className:"bg-bg-near-black rounded-sm border border-border-subtle p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(_a,{className:"w-5 h-5 text-accent-primary"}),e.jsx("h3",{className:"text-h5 text-text-primary",children:"Poroanja in obvestila"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-text-secondary",children:"Prijava IP"}),e.jsxs("div",{className:"flex items-center gap-2",children:[r!=null&&r.ip_notification_sent?e.jsx(Rt,{className:"w-4 h-4 text-status-success"}):e.jsx("div",{className:"w-4 h-4 border-2 border-text-muted rounded-full"}),e.jsx("span",{className:`text-sm ${r!=null&&r.ip_notification_sent?"text-status-success":"text-text-muted"}`,children:r!=null&&r.ip_notification_sent?"Prijavljeno":"Ni prijavljeno"})]})]}),(r==null?void 0:r.ip_notification_sent)&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Datum prijave IP"}),e.jsx("p",{className:"text-body text-text-primary",children:j(r==null?void 0:r.ip_notification_datetime)}),(r==null?void 0:r.ip_reference)&&e.jsxs(e.Fragment,{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Referenca IP"}),e.jsx("p",{className:"text-body text-text-primary font-mono",children:r==null?void 0:r.ip_reference})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-text-secondary",children:"Obveanje posameznikov"}),e.jsxs("div",{className:"flex items-center gap-2",children:[r!=null&&r.data_subjects_notified?e.jsx(Rt,{className:"w-4 h-4 text-status-success"}):e.jsx("div",{className:"w-4 h-4 border-2 border-text-muted rounded-full"}),e.jsx("span",{className:`text-sm ${r!=null&&r.data_subjects_notified?"text-status-success":"text-text-muted"}`,children:r!=null&&r.data_subjects_notified?"Obveeno":"Ni obveeno"})]})]})]})]}),e.jsxs("div",{className:"bg-bg-near-black rounded-sm border border-border-subtle p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(Mt,{className:"w-5 h-5 text-accent-primary"}),e.jsx("h3",{className:"text-h5 text-text-primary",children:"ZVOP-2 zahteve"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-text-secondary",children:"Posebne obdelave"}),e.jsx("span",{className:`text-sm ${r!=null&&r.special_processing?"text-status-warning":"text-text-muted"}`,children:r!=null&&r.special_processing?"Da":"Ne"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Lokacija hrambe"}),e.jsx("p",{className:"text-body text-text-primary",children:r==null?void 0:r.data_location})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-text-secondary",children:"CSIRT obveen"}),e.jsx("span",{className:`text-sm ${r!=null&&r.csirt_notified?"text-status-success":"text-text-muted"}`,children:r!=null&&r.csirt_notified?"Da":"Ne"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-text-secondary",children:"Prenosi podatkov"}),e.jsx("span",{className:`text-sm ${r!=null&&r.transfers_made?"text-status-warning":"text-text-muted"}`,children:r!=null&&r.transfers_made?"Da":"Ne"})]})]})]}),(r==null?void 0:r.file_url)&&e.jsxs("div",{className:"bg-bg-near-black rounded-sm border border-border-subtle p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(ut,{className:"w-5 h-5 text-accent-primary"}),e.jsx("h3",{className:"text-h5 text-text-primary",children:"Priloge"})]}),e.jsxs("a",{href:r.file_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 p-3 bg-bg-surface rounded border border-border-subtle hover:border-accent-primary transition-colors",children:[e.jsx(ut,{className:"w-4 h-4 text-accent-primary"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-body text-text-primary",children:r==null?void 0:r.file_name}),(r==null?void 0:r.file_size)&&e.jsxs("p",{className:"text-xs text-text-muted",children:[Math.round(r.file_size/1024)," KB"]})]}),e.jsx(lS,{className:"w-4 h-4 text-accent-primary"})]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-6 border-t border-border-subtle",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-sm text-text-muted",children:["Ustvarjeno: ",j(r==null?void 0:r.created_at)]}),(r==null?void 0:r.updated_at)!==(r==null?void 0:r.created_at)&&e.jsxs("span",{className:"text-sm text-text-muted",children:["Posodobljeno: ",j(r==null?void 0:r.updated_at)]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>{alert("PDF generiranje bo implementirano v naslednjem koraku")},className:"flex items-center gap-2 px-4 py-2 bg-accent-primary text-white rounded hover:bg-accent-primary-hover transition-colors",children:[e.jsx(Ir,{className:"w-4 h-4"}),"Generiraj PDF poroilo"]}),i&&e.jsx("button",{onClick:x,disabled:c,className:"px-4 py-2 bg-status-success text-white rounded hover:bg-status-success-hover transition-colors disabled:opacity-50",children:c?"Shranjevanje...":"Shrani spremembe"})]})]})]})]})]}):null}function JD(){const{t:s}=et(),[t,r]=z.useState([]),[a,n]=z.useState(!0),[i,o]=z.useState("full"),[c,d]=z.useState(""),[p,m]=z.useState("all"),[x,b]=z.useState("all"),[h,j]=z.useState("all"),[g,v]=z.useState(null),[_,k]=z.useState(!1),[P,L]=z.useState(!1),[F,W]=z.useState(null),R=async()=>{try{n(!0);const{data:J,error:$}=await Ne.from("gdpr_data_breach_log").select("*").order("breach_date",{ascending:!1});if($)throw $;!J||J.length===0?r([{id:1,breach_id:"INC-2024-001",breach_type:"Ransomware napad na datoteni strenik",breach_date:"2024-11-01T10:30:00Z",severity:"critical",status:"resolved",dpo_name:"Marko Novak",data_controller:"Standario d.o.o.",description:"Ransomware napad na glavni datoteni strenik je prizadel kritine poslovne podatke. Strenik je bil izoliran in obnovljen iz varnostnih kopij.",affected_records:15e3,ip_notification_sent:!0,ip_notification_date:"2024-11-02T14:00:00Z",data_subjects_notified:!0,subjects_notification_date:"2024-11-03T09:00:00Z",file_url:null,created_at:"2024-11-01T10:30:00Z",updated_at:"2024-11-05T16:00:00Z"},{id:2,breach_id:"INC-2024-002",breach_type:"Napano poiljanje osebnih podatkov",breach_date:"2024-10-28T14:20:00Z",severity:"high",status:"investigating",dpo_name:"Ana Kovai",data_controller:"Standario d.o.o.",description:"E-potno sporoilo z osebnimi podatki strank je bilo napano naslovljeno in poslano nepooblaeni osebi. Preklic sporoila ni bil mogo.",affected_records:45,ip_notification_sent:!0,ip_notification_date:"2024-10-29T10:00:00Z",data_subjects_notified:!0,subjects_notification_date:"2024-10-30T12:00:00Z",file_url:null,created_at:"2024-10-28T14:20:00Z",updated_at:"2024-11-07T11:30:00Z"},{id:3,breach_id:"INC-2024-003",breach_type:"Neavtoriziran dostop do sistema",breach_date:"2024-10-25T08:15:00Z",severity:"high",status:"resolved",dpo_name:"Marko Novak",data_controller:"Standario d.o.o.",description:"Bivi zaposleni je e vedno imel veljaven dostop do sistema po prenehanju delovnega razmerja. Dostop je takoj preklican in izvedena varnostna preiskava.",affected_records:2300,ip_notification_sent:!1,ip_notification_date:null,data_subjects_notified:!1,subjects_notification_date:null,file_url:null,created_at:"2024-10-25T08:15:00Z",updated_at:"2024-11-01T17:45:00Z"},{id:4,breach_id:"INC-2024-004",breach_type:"Kompromitacija gesla",breach_date:"2024-10-20T16:45:00Z",severity:"medium",status:"contained",dpo_name:"Ana Kovai",data_controller:"Standario d.o.o.",description:"Administratorjev raun je bil kompromitiran zaradi slabega gesla. Geslo je bilo spremenjeno in izvedena dvofaktorska avtentikacija.",affected_records:0,ip_notification_sent:!1,ip_notification_date:null,data_subjects_notified:!1,subjects_notification_date:null,file_url:null,created_at:"2024-10-20T16:45:00Z",updated_at:"2024-10-21T10:00:00Z"},{id:5,breach_id:"INC-2024-005",breach_type:"Izguba prenosne naprave",breach_date:"2024-10-15T12:00:00Z",severity:"medium",status:"resolved",dpo_name:"Peter Pavlin",data_controller:"Standario d.o.o.",description:"Prenosni raunalnik z neifriranimi podatki strank je bil izgubljen na javnem prevozu. Naprava je bila takoj oddaljeno onemogoena.",affected_records:1200,ip_notification_sent:!0,ip_notification_date:"2024-10-16T14:30:00Z",data_subjects_notified:!0,subjects_notification_date:"2024-10-17T11:00:00Z",file_url:null,created_at:"2024-10-15T12:00:00Z",updated_at:"2024-10-25T09:15:00Z"},{id:6,breach_id:"INC-2024-006",breach_type:"SQL injection napad",breach_date:"2024-10-10T09:30:00Z",severity:"critical",status:"resolved",dpo_name:"Marko Novak",data_controller:"Standario d.o.o.",description:"Web aplikacija je bila tara SQL injection napada. Napadalec je pridobil dostop do delovne baze podatkov. Sistem je bil popravljen in zaiten.",affected_records:5e3,ip_notification_sent:!0,ip_notification_date:"2024-10-11T08:00:00Z",data_subjects_notified:!0,subjects_notification_date:"2024-10-12T14:00:00Z",file_url:null,created_at:"2024-10-10T09:30:00Z",updated_at:"2024-10-30T16:20:00Z"},{id:7,breach_id:"INC-2024-007",breach_type:"Nepooblaen dostop do e-pote",breach_date:"2024-10-05T11:20:00Z",severity:"high",status:"investigating",dpo_name:"Ana Kovai",data_controller:"Standario d.o.o.",description:"E-potni raun zaposlenega je bil dostopen prek ukradenih prijavnih podatkov. Preiskava e poteka, preverja se obseg dostopa.",affected_records:500,ip_notification_sent:!1,ip_notification_date:null,data_subjects_notified:!1,subjects_notification_date:null,file_url:null,created_at:"2024-10-05T11:20:00Z",updated_at:"2024-11-08T14:45:00Z"}]):r(J)}catch(J){console.error("Error:",J),r([{id:1,breach_id:"INC-2024-001",breach_type:"Ransomware napad na datoteni strenik",breach_date:"2024-11-01T10:30:00Z",severity:"critical",status:"resolved",dpo_name:"Marko Novak",data_controller:"Standario d.o.o.",description:"Ransomware napad na glavni datoteni strenik je prizadel kritine poslovne podatke. Strenik je bil izoliran in obnovljen iz varnostnih kopij.",affected_records:15e3,ip_notification_sent:!0,ip_notification_date:"2024-11-02T14:00:00Z",data_subjects_notified:!0,subjects_notification_date:"2024-11-03T09:00:00Z",file_url:null,created_at:"2024-11-01T10:30:00Z",updated_at:"2024-11-05T16:00:00Z"},{id:2,breach_id:"INC-2024-002",breach_type:"Napano poiljanje osebnih podatkov",breach_date:"2024-10-28T14:20:00Z",severity:"high",status:"investigating",dpo_name:"Ana Kovai",data_controller:"Standario d.o.o.",description:"E-potno sporoilo z osebnimi podatki strank je bilo napano naslovljeno in poslano nepooblaeni osebi. Preklic sporoila ni bil mogo.",affected_records:45,ip_notification_sent:!0,ip_notification_date:"2024-10-29T10:00:00Z",data_subjects_notified:!0,subjects_notification_date:"2024-10-30T12:00:00Z",file_url:null,created_at:"2024-10-28T14:20:00Z",updated_at:"2024-11-07T11:30:00Z"},{id:3,breach_id:"INC-2024-003",breach_type:"Neavtoriziran dostop do sistema",breach_date:"2024-10-25T08:15:00Z",severity:"high",status:"resolved",dpo_name:"Marko Novak",data_controller:"Standario d.o.o.",description:"Bivi zaposleni je e vedno imel veljaven dostop do sistema po prenehanju delovnega razmerja. Dostop je takoj preklican in izvedena varnostna preiskava.",affected_records:2300,ip_notification_sent:!1,ip_notification_date:null,data_subjects_notified:!1,subjects_notification_date:null,file_url:null,created_at:"2024-10-25T08:15:00Z",updated_at:"2024-11-01T17:45:00Z"},{id:4,breach_id:"INC-2024-004",breach_type:"Kompromitacija gesla",breach_date:"2024-10-20T16:45:00Z",severity:"medium",status:"contained",dpo_name:"Ana Kovai",data_controller:"Standario d.o.o.",description:"Administratorjev raun je bil kompromitiran zaradi slabega gesla. Geslo je bilo spremenjeno in izvedena dvofaktorska avtentikacija.",affected_records:0,ip_notification_sent:!1,ip_notification_date:null,data_subjects_notified:!1,subjects_notification_date:null,file_url:null,created_at:"2024-10-20T16:45:00Z",updated_at:"2024-10-21T10:00:00Z"},{id:5,breach_id:"INC-2024-005",breach_type:"Izguba prenosne naprave",breach_date:"2024-10-15T12:00:00Z",severity:"medium",status:"resolved",dpo_name:"Peter Pavlin",data_controller:"Standario d.o.o.",description:"Prenosni raunalnik z neifriranimi podatki strank je bil izgubljen na javnem prevozu. Naprava je bila takoj oddaljeno onemogoena.",affected_records:1200,ip_notification_sent:!0,ip_notification_date:"2024-10-16T14:30:00Z",data_subjects_notified:!0,subjects_notification_date:"2024-10-17T11:00:00Z",file_url:null,created_at:"2024-10-15T12:00:00Z",updated_at:"2024-10-25T09:15:00Z"},{id:6,breach_id:"INC-2024-006",breach_type:"SQL injection napad",breach_date:"2024-10-10T09:30:00Z",severity:"critical",status:"resolved",dpo_name:"Marko Novak",data_controller:"Standario d.o.o.",description:"Web aplikacija je bila tara SQL injection napada. Napadalec je pridobil dostop do delovne baze podatkov. Sistem je bil popravljen in zaiten.",affected_records:5e3,ip_notification_sent:!0,ip_notification_date:"2024-10-11T08:00:00Z",data_subjects_notified:!0,subjects_notification_date:"2024-10-12T14:00:00Z",file_url:null,created_at:"2024-10-10T09:30:00Z",updated_at:"2024-10-30T16:20:00Z"},{id:7,breach_id:"INC-2024-007",breach_type:"Nepooblaen dostop do e-pote",breach_date:"2024-10-05T11:20:00Z",severity:"high",status:"investigating",dpo_name:"Ana Kovai",data_controller:"Standario d.o.o.",description:"E-potni raun zaposlenega je bil dostopen prek ukradenih prijavnih podatkov. Preiskava e poteka, preverja se obseg dostopa.",affected_records:500,ip_notification_sent:!1,ip_notification_date:null,data_subjects_notified:!1,subjects_notification_date:null,file_url:null,created_at:"2024-10-05T11:20:00Z",updated_at:"2024-11-08T14:45:00Z"}])}finally{n(!1)}};z.useEffect(()=>{R()},[]);const B=z.useMemo(()=>{const J=t.filter($=>{const Q=!c||$.breach_id.toLowerCase().includes(c.toLowerCase())||$.breach_type.toLowerCase().includes(c.toLowerCase())||$.dpo_name&&$.dpo_name.toLowerCase().includes(c.toLowerCase()),q=p==="all"||$.severity===p,I=x==="all"||$.status===x;let Y=!0;if(h!=="all"){const H=new Date($.breach_date),ge=Math.floor((new Date().getTime()-H.getTime())/(1e3*60*60*24));switch(h){case"7days":Y=ge<=7;break;case"30days":Y=ge<=30;break;case"90days":Y=ge<=90;break;case"1year":Y=ge<=365;break}}return Q&&q&&I&&Y});if(g){const $=[...J];return $.sort((Q,q)=>{let I=Q[g.key],Y=q[g.key];return g.key.includes("date")&&(I=new Date(I),Y=new Date(Y)),Array.isArray(I)&&(I=I.length),Array.isArray(Y)&&(Y=Y.length),I<Y?g.direction==="asc"?-1:1:I>Y?g.direction==="asc"?1:-1:0}),$}return J},[t,c,p,x,h,g]),A=z.useMemo(()=>{const J=B.length,$=B.filter(K=>K.severity==="critical").length,Q=B.filter(K=>K.severity==="high").length,q=B.filter(K=>K.severity==="medium").length,I=B.filter(K=>K.severity==="low").length,Y=B.filter(K=>K.status==="investigating"||K.status==="contained").length,H=B.filter(K=>K.status==="resolved").length,he=B.filter(K=>K.ip_notification_sent).length,ge=B.filter(K=>K.data_subjects_notified).length;return{total:J,critical:$,high:Q,medium:q,low:I,active:Y,resolved:H,reportedToAuthority:he,notifiedIndividuals:ge}},[B]),S=J=>{v($=>($==null?void 0:$.key)===J?{key:J,direction:$.direction==="asc"?"desc":"asc"}:{key:J,direction:"asc"})},C=J=>{switch(J==null?void 0:J.toLowerCase()){case"critical":return"bg-risk-critical/20 text-risk-critical border-risk-critical/30";case"high":return"bg-risk-high/20 text-risk-high border-risk-high/30";case"medium":return"bg-risk-medium/20 text-risk-medium border-risk-medium/30";default:return"bg-risk-low/20 text-risk-low border-risk-low/30"}},O=J=>{switch(J==null?void 0:J.toLowerCase()){case"resolved":return"bg-status-success/10 text-status-success border-status-success/20";case"contained":return"bg-accent-primary/10 text-accent-primary border-accent-primary/20";case"investigating":return"bg-status-warning/10 text-status-warning border-status-warning/20";default:return"bg-text-muted/10 text-text-muted border-text-muted/20"}},Z=J=>{const $=new Date(J),q=Math.floor((new Date().getTime()-$.getTime())/(1e3*60*60));return q<1?"Pravkar":q<24?`${q}h`:`${Math.floor(q/24)} dni`},te=J=>{W(J),L(!0)},ce=async J=>{try{const{generateSignedIPRSReport:$,downloadSignedPDF:Q}=await gp(async()=>{const{generateSignedIPRSReport:Y,downloadSignedPDF:H}=await import("./pdfGenerator-D5bQsAQ0.js");return{generateSignedIPRSReport:Y,downloadSignedPDF:H}},[]),q=await $(J),I=await Q(q,`incident-${J.breach_id}-iprs-report-signed.pdf`);alert(I.message)}catch($){console.error("Error generating signed PDF:",$),alert("Napaka pri generiranju podpisanega PDF poroila")}};if(a)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})});const re=()=>e.jsxs("div",{className:"flex items-center gap-1 bg-bg-near-black rounded-sm p-1",children:[e.jsxs("button",{onClick:()=>o("full"),className:`flex items-center gap-2 px-3 py-2 rounded text-body-sm transition-colors ${i==="full"?"bg-accent-primary text-white":"text-text-secondary hover:text-text-primary"}`,title:"Polna evidenca",children:[e.jsx(uS,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden md:inline",children:"Polna"})]}),e.jsxs("button",{onClick:()=>o("basic"),className:`flex items-center gap-2 px-3 py-2 rounded text-body-sm transition-colors ${i==="basic"?"bg-accent-primary text-white":"text-text-secondary hover:text-text-primary"}`,title:"Osnovni pregled",children:[e.jsx(lr,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden md:inline",children:"Pregled"})]}),e.jsxs("button",{onClick:()=>o("catalog"),className:`flex items-center gap-2 px-3 py-2 rounded text-body-sm transition-colors ${i==="catalog"?"bg-accent-primary text-white":"text-text-secondary hover:text-text-primary"}`,title:"Kazalo",children:[e.jsx(hS,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden md:inline",children:"Kazalo"})]}),e.jsxs("button",{onClick:()=>o("statistics"),className:`flex items-center gap-2 px-3 py-2 rounded text-body-sm transition-colors ${i==="statistics"?"bg-accent-primary text-white":"text-text-secondary hover:text-text-primary"}`,title:"Statistike",children:[e.jsx(Bi,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden md:inline",children:"Statistike"})]})]}),X=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[e.jsx("div",{className:"bg-bg-surface rounded-sm border border-border-subtle p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded bg-accent-primary/10 flex items-center justify-center",children:e.jsx(pt,{className:"w-4 h-4 text-accent-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Skupno"}),e.jsx("p",{className:"text-h4 text-text-primary",children:A.total})]})]})}),e.jsx("div",{className:"bg-bg-surface rounded-sm border border-border-subtle p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded bg-risk-critical/10 flex items-center justify-center",children:e.jsx(Fp,{className:"w-4 h-4 text-risk-critical"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Kritini"}),e.jsx("p",{className:"text-h4 text-text-primary",children:A.critical})]})]})}),e.jsx("div",{className:"bg-bg-surface rounded-sm border border-border-subtle p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded bg-status-warning/10 flex items-center justify-center",children:e.jsx(cs,{className:"w-4 h-4 text-status-warning"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Aktivni"}),e.jsx("p",{className:"text-h4 text-text-primary",children:A.active})]})]})}),e.jsx("div",{className:"bg-bg-surface rounded-sm border border-border-subtle p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded bg-accent-primary/10 flex items-center justify-center",children:e.jsx(Mt,{className:"w-4 h-4 text-accent-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-body-sm text-text-secondary",children:"IP prijavljeno"}),e.jsx("p",{className:"text-h4 text-text-primary",children:A.reportedToAuthority})]})]})}),e.jsx("div",{className:"bg-bg-surface rounded-sm border border-border-subtle p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded bg-status-success/10 flex items-center justify-center",children:e.jsx(Fa,{className:"w-4 h-4 text-status-success"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Obveeni"}),e.jsx("p",{className:"text-h4 text-text-primary",children:A.notifiedIndividuals})]})]})}),e.jsx("div",{className:"bg-bg-surface rounded-sm border border-border-subtle p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded bg-status-success/10 flex items-center justify-center",children:e.jsx(Rt,{className:"w-4 h-4 text-status-success"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Reeni"}),e.jsx("p",{className:"text-h4 text-text-primary",children:A.resolved})]})]})})]}),e.jsx("div",{className:"bg-bg-surface rounded-sm border border-border-subtle overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-pure-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:e.jsxs("button",{onClick:()=>S("breach_id"),className:"flex items-center gap-1 hover:text-text-primary",children:["ID",e.jsx(aS,{className:"w-3 h-3"})]})}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Tip kritve"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Datum"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Resnost"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Status"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"IP prijava"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Posamezniki"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Akcije"})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:B.map(J=>{var $;return e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 text-body text-text-primary font-mono",children:e.jsx("button",{onClick:()=>te(J),className:"hover:text-accent-primary transition-colors",children:J.breach_id})}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:J.breach_type}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:e.jsxs("div",{children:[e.jsx("div",{children:new Date(J.breach_date).toLocaleDateString("sl-SI")}),e.jsxs("div",{className:"text-xs text-text-muted",children:["PRED ",Z(J.breach_date)]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium border ${C(J.severity)}`,children:s(`gdpr.breach.severityOptions.${($=J.severity)==null?void 0:$.toLowerCase()}`)})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium border ${O(J.status)}`,children:s(`gdpr.breach.statusOptions.${J.status}`)})}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:J.ip_notification_sent?e.jsx(Rt,{className:"w-4 h-4 text-status-success"}):e.jsx("div",{className:"w-4 h-4 border-2 border-text-muted rounded-full"})}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:J.data_subjects_notified?e.jsx(Rt,{className:"w-4 h-4 text-status-success"}):e.jsx("div",{className:"w-4 h-4 border-2 border-text-muted rounded-full"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>te(J),className:"p-1 hover:bg-bg-near-black rounded transition-colors",title:"Podrobnosti",children:e.jsx(lr,{className:"w-4 h-4 text-accent-primary"})}),e.jsx("button",{onClick:()=>ce(J),className:"p-1 hover:bg-bg-near-black rounded transition-colors",title:"PDF poroilo",children:e.jsx(ut,{className:"w-4 h-4 text-accent-primary"})}),J.file_url&&e.jsx("a",{href:J.file_url,target:"_blank",rel:"noopener noreferrer",className:"p-1 hover:bg-bg-near-black rounded transition-colors",title:"Prenos priloge",children:e.jsx(Ir,{className:"w-4 h-4 text-accent-primary"})})]})})]},J.id)})})]})})]}),U=()=>e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:B.map(J=>e.jsxs("div",{className:"bg-bg-surface rounded-sm border border-border-subtle p-4 hover:bg-bg-surface-hover transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${J.severity==="critical"?"bg-risk-critical":J.severity==="high"?"bg-risk-high":J.severity==="medium"?"bg-risk-medium":"bg-risk-low"}`}),e.jsx("span",{className:"text-body-sm font-mono text-text-primary",children:J.breach_id})]}),e.jsx("button",{onClick:()=>te(J),className:"text-accent-primary hover:text-accent-primary-hover",children:e.jsx(lr,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-body-sm text-text-secondary",children:J.breach_type}),e.jsx("span",{className:"text-body-xs text-text-muted",children:Z(J.breach_date)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded text-caption ${C(J.severity)}`,children:J.severity}),e.jsx("span",{className:`px-2 py-1 rounded text-caption ${O(J.status)}`,children:J.status})]}),e.jsxs("div",{className:"flex items-center gap-4 text-body-xs text-text-muted",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[J.ip_notification_sent?e.jsx(Rt,{className:"w-3 h-3 text-status-success"}):e.jsx("div",{className:"w-3 h-3 border border-text-muted rounded-full"}),"IP"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[J.data_subjects_notified?e.jsx(Rt,{className:"w-3 h-3 text-status-success"}):e.jsx("div",{className:"w-3 h-3 border border-text-muted rounded-full"}),"Posamezniki"]})]})]})]},J.id))})}),oe=()=>{const J=B.reduce(($,Q)=>{const q=Q.breach_type||"Neznan";return $[q]||($[q]=[]),$[q].push(Q),$},{});return e.jsx("div",{className:"space-y-6",children:Object.entries(J).map(([$,Q])=>{const q=Q.reduce((Y,H)=>(Y[H.severity]=(Y[H.severity]||0)+1,Y),{}),I=Q.filter(Y=>Y.status==="resolved").length/Q.length*100;return e.jsxs("div",{className:"bg-bg-surface rounded-sm border border-border-subtle overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 bg-bg-near-black border-b border-border-subtle",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-h5 text-text-primary capitalize",children:$}),e.jsxs("div",{className:"flex items-center gap-4 text-body-sm text-text-secondary",children:[e.jsxs("span",{children:[Q.length," primerov"]}),e.jsxs("span",{children:[Math.round(I),"% reenih"]})]})]})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-h5 text-risk-critical",children:q.critical||0}),e.jsx("p",{className:"text-body-xs text-text-muted",children:"Kritini"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-h5 text-risk-high",children:q.high||0}),e.jsx("p",{className:"text-body-xs text-text-muted",children:"Visoki"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-h5 text-risk-medium",children:q.medium||0}),e.jsx("p",{className:"text-body-xs text-text-muted",children:"Srednji"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-h5 text-risk-low",children:q.low||0}),e.jsx("p",{className:"text-body-xs text-text-muted",children:"Nizki"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:Q.slice(0,6).map(Y=>e.jsxs("div",{className:"bg-bg-near-black rounded p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-body-sm font-mono text-text-primary",children:Y.breach_id}),e.jsx("span",{className:`px-1 py-0.5 rounded text-caption ${C(Y.severity)}`,children:Y.severity})]}),e.jsx("p",{className:"text-body-xs text-text-secondary mb-2",children:new Date(Y.breach_date).toLocaleDateString("sl-SI")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>te(Y),className:"text-accent-primary hover:text-accent-primary-hover",children:e.jsx(lr,{className:"w-3 h-3"})}),e.jsx("span",{className:`px-1 py-0.5 rounded text-caption ${O(Y.status)}`,children:Y.status})]})]},Y.id))})]})]},$)})})},xe=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-bg-surface rounded-sm border border-border-subtle p-6",children:[e.jsx("h3",{className:"text-h5 text-text-primary mb-4",children:"Porazdelitev po resnosti"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-body-sm text-text-secondary",children:"Kritini"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-32 h-2 bg-bg-near-black rounded",children:e.jsx("div",{className:"w-full h-full bg-risk-critical rounded",style:{width:`${A.critical/A.total*100}%`}})}),e.jsx("span",{className:"text-body-sm text-text-primary w-8 text-right",children:A.critical})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-body-sm text-text-secondary",children:"Visoki"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-32 h-2 bg-bg-near-black rounded",children:e.jsx("div",{className:"w-full h-full bg-risk-high rounded",style:{width:`${A.high/A.total*100}%`}})}),e.jsx("span",{className:"text-body-sm text-text-primary w-8 text-right",children:A.high})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-body-sm text-text-secondary",children:"Srednji"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-32 h-2 bg-bg-near-black rounded",children:e.jsx("div",{className:"w-full h-full bg-risk-medium rounded",style:{width:`${A.medium/A.total*100}%`}})}),e.jsx("span",{className:"text-body-sm text-text-primary w-8 text-right",children:A.medium})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-body-sm text-text-secondary",children:"Nizki"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-32 h-2 bg-bg-near-black rounded",children:e.jsx("div",{className:"w-full h-full bg-risk-low rounded",style:{width:`${A.low/A.total*100}%`}})}),e.jsx("span",{className:"text-body-sm text-text-primary w-8 text-right",children:A.low})]})]})]})]}),e.jsxs("div",{className:"bg-bg-surface rounded-sm border border-border-subtle p-6",children:[e.jsx("h3",{className:"text-h5 text-text-primary mb-4",children:"Status incidentov"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-body-sm text-text-secondary",children:"Aktivni"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-32 h-2 bg-bg-near-black rounded",children:e.jsx("div",{className:"w-full h-full bg-status-warning rounded",style:{width:`${A.active/A.total*100}%`}})}),e.jsx("span",{className:"text-body-sm text-text-primary w-8 text-right",children:A.active})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-body-sm text-text-secondary",children:"Reeni"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-32 h-2 bg-bg-near-black rounded",children:e.jsx("div",{className:"w-full h-full bg-status-success rounded",style:{width:`${A.resolved/A.total*100}%`}})}),e.jsx("span",{className:"text-body-sm text-text-primary w-8 text-right",children:A.resolved})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-bg-surface rounded-sm border border-border-subtle p-6",children:[e.jsx("h3",{className:"text-h5 text-text-primary mb-4",children:"Poroanja"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-body-sm text-text-secondary",children:"Prijava IP"}),e.jsxs("span",{className:"text-body-sm text-text-primary",children:[A.reportedToAuthority,"/",A.total]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-body-sm text-text-secondary",children:"Obveanje posameznikov"}),e.jsxs("span",{className:"text-body-sm text-text-primary",children:[A.notifiedIndividuals,"/",A.total]})]})]})]}),e.jsxs("div",{className:"bg-bg-surface rounded-sm border border-border-subtle p-6",children:[e.jsx("h3",{className:"text-h5 text-text-primary mb-4",children:"Hitrost odziva"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-h3 text-accent-primary",children:[Math.round(A.reportedToAuthority/A.total*100),"%"]}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Prijavljeno IP"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-h3 text-status-success",children:[Math.round(A.resolved/A.total*100),"%"]}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Uspeno reeno"})]})]})]})]})]});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-risk-critical/10 flex items-center justify-center",children:e.jsx(pt,{className:"w-5 h-5 text-risk-critical"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Evidenca incidentov in kritev"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Sledenje incidentov po GDPR in ZVOP-2"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[re(),e.jsxs("button",{onClick:()=>k(!0),className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Dt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:"Nov incident"})]})]})]}),e.jsx("div",{className:"bg-bg-surface rounded-sm border border-border-subtle p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:[e.jsx(ss,{className:"w-4 h-4 inline mr-1"}),"Iskanje"]}),e.jsx("input",{type:"text",placeholder:"ID, tip, DPO...",value:c,onChange:J=>d(J.target.value),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Resnost"}),e.jsxs("select",{value:p,onChange:J=>m(J.target.value),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"all",children:"Vse"}),e.jsx("option",{value:"critical",children:"Kritini"}),e.jsx("option",{value:"high",children:"Visoki"}),e.jsx("option",{value:"medium",children:"Srednji"}),e.jsx("option",{value:"low",children:"Nizki"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Status"}),e.jsxs("select",{value:x,onChange:J=>b(J.target.value),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"all",children:"Vsi"}),e.jsx("option",{value:"investigating",children:"V preiskavi"}),e.jsx("option",{value:"contained",children:"Zajezen"}),e.jsx("option",{value:"resolved",children:"Reen"}),e.jsx("option",{value:"escalated",children:"Eskaliran"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"asovni razpon"}),e.jsxs("select",{value:h,onChange:J=>j(J.target.value),className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"all",children:"Vsi"}),e.jsx("option",{value:"7days",children:"Zadnjih 7 dni"}),e.jsx("option",{value:"30days",children:"Zadnjih 30 dni"}),e.jsx("option",{value:"90days",children:"Zadnjih 90 dni"}),e.jsx("option",{value:"1year",children:"Zadnjih 1 leto"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{onClick:()=>{d(""),m("all"),b("all"),j("all")},className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary hover:bg-bg-surface transition-colors",children:"Poisti"})})]})}),i==="full"&&X(),i==="basic"&&U(),i==="catalog"&&oe(),i==="statistics"&&xe(),e.jsx(GD,{isOpen:_,onClose:()=>k(!1),onSave:R}),F&&e.jsx(e.Fragment,{children:e.jsx(YD,{isOpen:P,onClose:()=>{L(!1),W(null)},incident:F,onSave:R})})]})}function XD(){const{t:s}=et(),{organizationId:t,loading:r,error:a}=ju(),[n,i]=z.useState([]),[o,c]=z.useState(!0),[d,p]=z.useState(null),[m,x]=z.useState(""),[b,h]=z.useState(""),[j,g]=z.useState(""),[v,_]=z.useState(""),[k,P]=z.useState(""),[L,F]=z.useState(!1),[W,R]=z.useState(!1),[B,A]=z.useState(null),S=[{id:"1",complianceArea:"Obdelava posebnih kategorij podatkov",requirementCategory:"len 17 ZVOP-2",requirementDescription:"Obdelava osebnih podatkov o verskem ali filozofskem preprianju, politinem mnenju ali lanstvu v sindikatu, genetskih podatkih, biometrinih podatkih, zdravstvenih podatkih ali podatkih o spolnem ivljenju ali spolni usmerjenosti",legalBasis:"len 17 ZVOP-2",implementationStatus:"implemented",responsiblePerson:"Janez Novak",responsiblePersonEmail:"janez.novak@company.com",department:"IT & Varnost",deadline:"2024-12-15",lastReviewDate:"2024-11-01",nextReviewDate:"2025-11-01",riskLevel:"critical",impact:"individual",gdprAlignment:"full",zvokRequired:!0,documentationRequired:!0,trainingRequired:!0,fileUrl:"/documents/special-categories-policy.pdf",fileName:"special-categories-policy.pdf",complianceScore:95,notes:"Vsi procesi ustrezajo zahtevam, redno usposabljanje osebja",digitalSystemRequired:!0,covid19Related:!1},{id:"2",complianceArea:"Obvestila o kritvah varnosti",requirementCategory:"len 32 ZVOP-2",requirementDescription:"Obvezno obveanje ZVOK in posameznikov o kritvah varnosti osebnih podatkov v 72 urah",legalBasis:"len 32 ZVOP-2",implementationStatus:"in_progress",responsiblePerson:"Maria Kova",responsiblePersonEmail:"maria.kovac@company.com",department:"Pravna sluba",deadline:"2024-12-20",lastReviewDate:"2024-10-15",nextReviewDate:"2025-01-15",riskLevel:"high",impact:"both",gdprAlignment:"full",zvokRequired:!0,documentationRequired:!0,trainingRequired:!0,fileUrl:"/documents/breach-procedure.pdf",fileName:"breach-procedure.pdf",complianceScore:78,notes:"Postopki definirani, potrebno testiranje sistema za samodejno obveanje",digitalSystemRequired:!0,covid19Related:!1},{id:"3",complianceArea:"Pravice posameznikov",requirementCategory:"len 20 ZVOP-2",requirementDescription:"Izvajanje pravic posameznikov: dostop do podatkov, popravek, izbris, prenos, ugovor",legalBasis:"len 20 ZVOP-2",implementationStatus:"implemented",responsiblePerson:"Ana Popovi",responsiblePersonEmail:"ana.popovic@company.com",department:"GDPR skrbniki",deadline:"2024-11-30",lastReviewDate:"2024-11-20",nextReviewDate:"2025-05-20",riskLevel:"high",impact:"individual",gdprAlignment:"full",zvokRequired:!0,documentationRequired:!0,trainingRequired:!0,complianceScore:92,notes:"Vsi procesi za pravice posameznikov ustrezno implementirani",digitalSystemRequired:!0,covid19Related:!1},{id:"4",complianceArea:"Skladnost za male organizacije",requirementCategory:"Posebne dolobe za MPS",requirementDescription:"Prilagojene obveznosti za mikro, majhne in srednje organizacije skladno z velikostjo in obsegom obdelave",legalBasis:"len 55 ZVOP-2",implementationStatus:"not_started",responsiblePerson:"Marko Stergar",responsiblePersonEmail:"marko.stergar@company.com",department:"Uprava",deadline:"2025-01-31",riskLevel:"medium",impact:"organization",gdprAlignment:"partial",zvokRequired:!1,documentationRequired:!0,trainingRequired:!1,complianceScore:25,notes:"Potrebna analiza velikosti organizacije in prilagoditev obveznosti",digitalSystemRequired:!1,covid19Related:!1},{id:"5",complianceArea:"Digitalni sistem ZVOP-2",requirementCategory:"len 48 ZVOP-2",requirementDescription:"Uporaba digitalnega sistema za vodenje evidenc in obveznosti po ZVOP-2",legalBasis:"len 48 ZVOP-2",implementationStatus:"implemented",responsiblePerson:"Peter Horvat",responsiblePersonEmail:"peter.horvat@company.com",department:"IT oddelek",deadline:"2024-12-10",lastReviewDate:"2024-11-25",nextReviewDate:"2025-06-25",riskLevel:"medium",impact:"both",gdprAlignment:"full",zvokRequired:!0,documentationRequired:!0,trainingRequired:!0,fileUrl:"/documents/digital-system-guide.pdf",fileName:"digital-system-guide.pdf",complianceScore:88,notes:"Digitalni sistem ustrezno implementiran in v uporabi",digitalSystemRequired:!0,covid19Related:!1},{id:"6",complianceArea:"Podatki o zdravju",requirementCategory:"len 18 ZVOP-2",requirementDescription:"Posebne zahteve za obdelavo zdravstvenih podatkov in medicinskih evidenc",legalBasis:"len 18 ZVOP-2",implementationStatus:"implemented",responsiblePerson:"Dr. Eva agar",responsiblePersonEmail:"eva.zagar@company.com",department:"Medicinski oddelek",deadline:"2024-11-20",lastReviewDate:"2024-11-10",nextReviewDate:"2025-02-10",riskLevel:"critical",impact:"individual",gdprAlignment:"full",zvokRequired:!0,documentationRequired:!0,trainingRequired:!0,fileUrl:"/documents/health-data-procedure.pdf",fileName:"health-data-procedure.pdf",complianceScore:90,notes:"Strogi ukrepi varovanja zdravstvenih podatkov",digitalSystemRequired:!0,covid19Related:!0},{id:"7",complianceArea:"Kazenske dolobe",requirementCategory:"len 62 ZVOP-2",requirementDescription:"Ozaveanje o kazenskih dolobah in upravnih ukrepih za neskladnost",legalBasis:"len 62 ZVOP-2",implementationStatus:"implemented",responsiblePerson:"Alja Kavi",responsiblePersonEmail:"aljaz.kavcic@company.com",department:"Pravna sluba",deadline:"2024-12-01",lastReviewDate:"2024-11-15",nextReviewDate:"2025-03-15",riskLevel:"high",impact:"organization",gdprAlignment:"partial",zvokRequired:!0,documentationRequired:!0,trainingRequired:!0,fileUrl:"/documents/legal-awareness.pdf",fileName:"legal-awareness.pdf",complianceScore:85,notes:"Redno usposabljanje o kaznih in sankcijah",digitalSystemRequired:!1,covid19Related:!1},{id:"8",complianceArea:"Prenos podatkov",requirementCategory:"len 23 ZVOP-2",requirementDescription:"Pravila za prenos osebnih podatkov v tretje drave ali mednarodne organizacije",legalBasis:"len 23 ZVOP-2",implementationStatus:"in_progress",responsiblePerson:"Nina Kralj",responsiblePersonEmail:"nina.kralj@company.com",department:"Mednarodni odnosi",deadline:"2025-01-15",lastReviewDate:"2024-10-30",nextReviewDate:"2025-04-30",riskLevel:"high",impact:"individual",gdprAlignment:"full",zvokRequired:!0,documentationRequired:!0,trainingRequired:!0,complianceScore:70,notes:"Potrebno posodobitev sporazumov s tretjimi dravami",digitalSystemRequired:!1,covid19Related:!1}];z.useEffect(()=>{const I=setTimeout(()=>{i(S),c(!1)},1e3);return()=>clearTimeout(I)},[]);const C=n.filter(I=>{const Y=I.requirementDescription.toLowerCase().includes(m.toLowerCase())||I.responsiblePerson.toLowerCase().includes(m.toLowerCase())||I.complianceArea.toLowerCase().includes(m.toLowerCase()),H=!b||I.implementationStatus===b,he=!j||I.complianceArea===j,ge=!v||I.riskLevel===v,K=!k||I.gdprAlignment===k;return Y&&H&&he&&ge&&K}),O=I=>{switch(I){case"implemented":return"text-green-500 bg-green-500/10";case"in_progress":return"text-yellow-500 bg-yellow-500/10";case"not_started":return"text-red-500 bg-red-500/10";case"non_compliant":return"text-red-600 bg-red-600/10";default:return"text-gray-500 bg-gray-500/10"}},Z=I=>{switch(I){case"implemented":return e.jsx(Rt,{className:"w-4 h-4"});case"in_progress":return e.jsx(cs,{className:"w-4 h-4"});case"not_started":return e.jsx(Ss,{className:"w-4 h-4"});case"non_compliant":return e.jsx(pt,{className:"w-4 h-4"});default:return e.jsx(er,{className:"w-4 h-4"})}},te=I=>{switch(I){case"low":return"text-green-500 bg-green-500/10";case"medium":return"text-yellow-500 bg-yellow-500/10";case"high":return"text-orange-500 bg-orange-500/10";case"critical":return"text-red-500 bg-red-500/10";default:return"text-gray-500 bg-gray-500/10"}},ce=I=>{switch(I){case"full":return"text-green-500 bg-green-500/10";case"partial":return"text-yellow-500 bg-yellow-500/10";case"none":return"text-red-500 bg-red-500/10";default:return"text-gray-500 bg-gray-500/10"}},re=I=>I.includes("zdravje")?e.jsx(en,{className:"w-4 h-4"}):I.includes("digitalni")?e.jsx(_u,{className:"w-4 h-4"}):I.includes("kritve")?e.jsx(pt,{className:"w-4 h-4"}):I.includes("pravice")?e.jsx(Ob,{className:"w-4 h-4"}):I.includes("mal")?e.jsx(iS,{className:"w-4 h-4"}):I.includes("prenos")?e.jsx(nx,{className:"w-4 h-4"}):I.includes("kazenske")?e.jsx(hi,{className:"w-4 h-4"}):e.jsx(Mt,{className:"w-4 h-4"}),U=(()=>{const I=n.length,Y=n.filter(ee=>ee.implementationStatus==="implemented").length,H=n.filter(ee=>ee.implementationStatus==="in_progress").length,he=n.filter(ee=>ee.implementationStatus==="not_started").length,ge=n.filter(ee=>ee.riskLevel==="critical").length,K=n.filter(ee=>ee.gdprAlignment==="full").length,T=n.reduce((ee,_e)=>ee+_e.complianceScore,0)/I;return{total:I,implemented:Y,inProgress:H,notStarted:he,critical:ge,gdprFull:K,avgScore:T}})(),oe=I=>I?new Date(I)<new Date:!1,xe=I=>{if(!I)return!1;const Y=new Date(I),H=new Date,he=Math.ceil((Y.getTime()-H.getTime())/(1e3*60*60*24));return he<=30&&he>0},J=()=>{F(!0)},$=I=>{A(I),R(!0)},Q=I=>{A(I),F(!0)},q=I=>{window.confirm(`Ali ste prepriani, da elite izbrisati zahtevo "${I.complianceArea}"?`)&&i(Y=>Y.filter(H=>H.id!==I.id))};return r||o?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})}):a||!t?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(er,{className:"w-12 h-12 text-status-error mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"Dostop zavrnjen"}),e.jsx("p",{className:"text-body text-text-secondary",children:a||"Organizacija ni najdena"})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-bg-surface rounded-lg p-6 border border-border-subtle",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-accent-primary/10 flex items-center justify-center",children:e.jsx(Mt,{className:"w-5 h-5 text-accent-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"ZVOP-2 Skladnost"}),e.jsx("p",{className:"text-text-secondary",children:"Sledenje zahtevam Zakona o varstvu osebnih podatkov 2 (ZVOP-2) in digitalni sistem"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{className:"px-4 py-2 bg-bg-pure-black text-text-secondary rounded-lg hover:bg-bg-surface-hover transition-colors duration-200",children:[e.jsx(Ir,{className:"w-4 h-4 inline-block mr-2"}),"Izvozi poroilo"]}),e.jsxs("button",{onClick:J,className:"px-4 py-2 bg-accent-primary text-white rounded-lg hover:bg-accent-primary/90 transition-colors duration-200",children:[e.jsx(Dt,{className:"w-4 h-4 inline-block mr-2"}),"Nova zahteva"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-bg-surface rounded-lg p-4 border border-border-subtle",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Bi,{className:"w-8 h-8 text-accent-primary"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-text-primary",children:U.total}),e.jsx("div",{className:"text-sm text-text-secondary",children:"Skupaj zahtev"})]})]})}),e.jsx("div",{className:"bg-bg-surface rounded-lg p-4 border border-border-subtle",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Rt,{className:"w-8 h-8 text-green-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-text-primary",children:U.implemented}),e.jsx("div",{className:"text-sm text-text-secondary",children:"Implementirano"})]})]})}),e.jsx("div",{className:"bg-bg-surface rounded-lg p-4 border border-border-subtle",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Mp,{className:"w-8 h-8 text-blue-500"}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-2xl font-bold text-text-primary",children:[Math.round(U.avgScore),"%"]}),e.jsx("div",{className:"text-sm text-text-secondary",children:"Povprena ocena"})]})]})}),e.jsx("div",{className:"bg-bg-surface rounded-lg p-4 border border-border-subtle",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(pt,{className:"w-8 h-8 text-red-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-text-primary",children:U.critical}),e.jsx("div",{className:"text-sm text-text-secondary",children:"Kritina tveganja"})]})]})})]}),e.jsx("div",{className:"bg-bg-surface rounded-lg p-6 border border-border-subtle",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-4",children:[e.jsxs("div",{className:"flex-1 min-w-[300px] relative",children:[e.jsx(ss,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-text-tertiary"}),e.jsx("input",{type:"text",placeholder:"Ii po opisu, odgovorni osebi ali podroju...",value:m,onChange:I=>x(I.target.value),className:"w-full pl-10 pr-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("select",{value:b,onChange:I=>h(I.target.value),className:"px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"",children:"Vsi statusi"}),e.jsx("option",{value:"implemented",children:"Implementirano"}),e.jsx("option",{value:"in_progress",children:"V teku"}),e.jsx("option",{value:"not_started",children:"Ni zaeto"}),e.jsx("option",{value:"non_compliant",children:"Neskladno"})]}),e.jsxs("select",{value:j,onChange:I=>g(I.target.value),className:"px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"",children:"Vsa podroja"}),e.jsx("option",{value:"Obdelava posebnih kategorij podatkov",children:"Posebne kategorije"}),e.jsx("option",{value:"Obvestila o kritvah varnosti",children:"Kritve varnosti"}),e.jsx("option",{value:"Pravice posameznikov",children:"Pravice posameznikov"}),e.jsx("option",{value:"Skladnost za male organizacije",children:"Male organizacije"}),e.jsx("option",{value:"Digitalni sistem ZVOP-2",children:"Digitalni sistem"}),e.jsx("option",{value:"Podatki o zdravju",children:"Zdravstveni podatki"}),e.jsx("option",{value:"Kazenske dolobe",children:"Kazenske dolobe"}),e.jsx("option",{value:"Prenos podatkov",children:"Prenos podatkov"})]}),e.jsxs("select",{value:v,onChange:I=>_(I.target.value),className:"px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"",children:"Vsa tveganja"}),e.jsx("option",{value:"low",children:"Nizko"}),e.jsx("option",{value:"medium",children:"Srednje"}),e.jsx("option",{value:"high",children:"Visoko"}),e.jsx("option",{value:"critical",children:"Kritino"})]}),e.jsxs("select",{value:k,onChange:I=>P(I.target.value),className:"px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"",children:"Vsi GDPR alignmenti"}),e.jsx("option",{value:"full",children:"Polno usklajeno"}),e.jsx("option",{value:"partial",children:"Delno usklajeno"}),e.jsx("option",{value:"none",children:"Ni usklajeno"})]})]})}),e.jsx("div",{className:"bg-bg-surface rounded-lg border border-border-subtle",children:C.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-pure-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-text-secondary uppercase tracking-wide",children:"Podroje"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-text-secondary uppercase tracking-wide",children:"Zahteva"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-text-secondary uppercase tracking-wide",children:"Status"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-text-secondary uppercase tracking-wide",children:"Odgovorna oseba"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-text-secondary uppercase tracking-wide",children:"Rok"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-text-secondary uppercase tracking-wide",children:"Tveganje"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-text-secondary uppercase tracking-wide",children:"GDPR"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-text-secondary uppercase tracking-wide",children:"Ocena"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-text-secondary uppercase tracking-wide",children:"Dokumenti"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-text-secondary uppercase tracking-wide",children:"Akcije"})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:C.map(I=>e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[re(I.complianceArea),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-text-primary text-sm max-w-[200px]",children:I.complianceArea}),e.jsx("div",{className:"text-xs text-text-secondary",children:I.requirementCategory})]})]})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm text-text-primary max-w-[300px]",children:I.requirementDescription}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[I.zvokRequired&&e.jsx("span",{className:"text-xs bg-blue-500/10 text-blue-500 px-2 py-0.5 rounded",children:"ZVOK"}),I.documentationRequired&&e.jsx("span",{className:"text-xs bg-green-500/10 text-green-500 px-2 py-0.5 rounded",children:"Dok."}),I.trainingRequired&&e.jsx("span",{className:"text-xs bg-purple-500/10 text-purple-500 px-2 py-0.5 rounded",children:"Uspos."}),I.digitalSystemRequired&&e.jsx("span",{className:"text-xs bg-accent-primary/10 text-accent-primary px-2 py-0.5 rounded",children:"Digital"}),I.covid19Related&&e.jsx("span",{className:"text-xs bg-orange-500/10 text-orange-500 px-2 py-0.5 rounded",children:"COVID-19"})]})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:`flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${O(I.implementationStatus)}`,children:[Z(I.implementationStatus),I.implementationStatus==="implemented"?"Implementirano":I.implementationStatus==="in_progress"?"V teku":I.implementationStatus==="not_started"?"Ni zaeto":"Neskladno"]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(en,{className:"w-4 h-4 text-text-secondary"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-text-primary",children:I.responsiblePerson}),e.jsx("div",{className:"text-xs text-text-secondary",children:I.responsiblePersonEmail}),e.jsx("div",{className:"text-xs text-text-tertiary",children:I.department})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_a,{className:"w-4 h-4"}),e.jsxs("div",{children:[e.jsx("div",{className:`text-sm ${oe(I.deadline)?"text-red-500 font-medium":xe(I.deadline)?"text-yellow-500 font-medium":"text-text-secondary"}`,children:I.deadline?new Date(I.deadline).toLocaleDateString("sl-SI"):"-"}),oe(I.deadline)&&e.jsx("div",{className:"text-xs text-red-500",children:"ZAMUJENO"}),xe(I.deadline)&&!oe(I.deadline)&&e.jsx("div",{className:"text-xs text-yellow-500",children:"KMALU"}),I.lastReviewDate&&e.jsxs("div",{className:"text-xs text-text-tertiary",children:["Zadnji pregled: ",new Date(I.lastReviewDate).toLocaleDateString("sl-SI")]})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${te(I.riskLevel)}`,children:I.riskLevel==="low"?"Nizko":I.riskLevel==="medium"?"Srednje":I.riskLevel==="high"?"Visoko":"Kritino"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ce(I.gdprAlignment)}`,children:I.gdprAlignment==="full"?"Polno":I.gdprAlignment==="partial"?"Delno":"Ni"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:`text-sm font-medium ${I.complianceScore>=80?"text-green-500":I.complianceScore>=60?"text-yellow-500":"text-red-500"}`,children:[I.complianceScore,"%"]}),e.jsx("div",{className:"w-16 bg-bg-near-black rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${I.complianceScore>=80?"bg-green-500":I.complianceScore>=60?"bg-yellow-500":"bg-red-500"}`,style:{width:`${I.complianceScore}%`}})})]})}),e.jsx("td",{className:"px-6 py-4",children:I.fileUrl?e.jsxs("a",{href:I.fileUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-accent-primary hover:text-accent-primary-hover transition-colors",children:[e.jsx(ut,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm truncate max-w-[100px]",children:I.fileName||"Dokument"}),e.jsx(Ir,{className:"w-3 h-3"})]}):e.jsx("span",{className:"text-text-muted text-sm",children:"-"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>$(I),className:"p-2 text-text-secondary hover:text-accent-primary hover:bg-accent-primary/10 rounded-lg transition-colors",title:"Pregledaj",children:e.jsx(lr,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Q(I),className:"p-2 text-text-secondary hover:text-accent-primary hover:bg-accent-primary/10 rounded-lg transition-colors",title:"Uredi",children:e.jsx(ar,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>q(I),className:"p-2 text-text-secondary hover:text-red-500 hover:bg-red-500/10 rounded-lg transition-colors",title:"Izbrii",children:e.jsx(pr,{className:"w-4 h-4"})})]})})]},I.id))})]})}):e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(Mt,{className:"w-12 h-12 text-text-tertiary mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:m||b||j||v||k?"Ni rezultatov iskanja":"Ni zahtev ZVOP-2"}),e.jsx("p",{className:"text-text-secondary mb-6",children:m||b||j||v||k?"Poskusite z drugimi iskalnimi pogoji":"Zanite s sledenjem zahtevam ZVOP-2"}),!m&&!b&&!j&&!v&&!k&&e.jsxs("button",{onClick:J,className:"px-6 py-3 bg-accent-primary text-white rounded-lg hover:bg-accent-primary/90 transition-colors duration-200",children:[e.jsx(Dt,{className:"w-4 h-4 inline-block mr-2"}),"Dodaj prvo zahtevo"]})]})}),C.length>0&&e.jsxs("div",{className:"bg-bg-surface rounded-lg border border-border-subtle",children:[e.jsx("div",{className:"px-6 py-4 border-b border-border-subtle",children:e.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Povzetek ZVOP-2 skladnosti"})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-bg-near-black rounded-lg p-4 border border-border-subtle",children:[e.jsxs("h4",{className:"font-medium text-text-primary mb-3 flex items-center gap-2",children:[e.jsx(Mp,{className:"w-5 h-5 text-accent-primary"}),"Napredek implementacije"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-text-secondary",children:"Implementirano:"}),e.jsxs("span",{className:"text-green-500 font-medium",children:[U.implemented,"/",U.total]})]}),e.jsx("div",{className:"w-full bg-bg-surface rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${U.implemented/U.total*100}%`}})}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-text-secondary",children:"V teku:"}),e.jsxs("span",{className:"text-yellow-500 font-medium",children:[U.inProgress,"/",U.total]})]})]})]}),e.jsxs("div",{className:"bg-bg-near-black rounded-lg p-4 border border-border-subtle",children:[e.jsxs("h4",{className:"font-medium text-text-primary mb-3 flex items-center gap-2",children:[e.jsx(Ob,{className:"w-5 h-5 text-blue-500"}),"GDPR uskladitev"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-text-secondary",children:"Polno usklajeno:"}),e.jsxs("span",{className:"text-blue-500 font-medium",children:[U.gdprFull,"/",U.total]})]}),e.jsx("div",{className:"w-full bg-bg-surface rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${U.gdprFull/U.total*100}%`}})})]})]})]}),n.filter(I=>I.riskLevel==="critical").length>0&&e.jsxs("div",{className:"mt-6 p-4 bg-red-500/10 border border-red-500/20 rounded-lg",children:[e.jsxs("h4",{className:"font-medium text-red-600 mb-2 flex items-center gap-2",children:[e.jsx(pt,{className:"w-5 h-5"}),"Kritina tveganja"]}),e.jsx("div",{className:"space-y-1 text-sm text-text-secondary",children:n.filter(I=>I.riskLevel==="critical").slice(0,3).map((I,Y)=>e.jsxs("div",{children:[" ",I.complianceArea," - ",I.requirementCategory]},Y))})]}),n.filter(I=>I.deadline&&xe(I.deadline)).length>0&&e.jsxs("div",{className:"mt-6 p-4 bg-yellow-500/10 border border-yellow-500/20 rounded-lg",children:[e.jsxs("h4",{className:"font-medium text-yellow-600 mb-2 flex items-center gap-2",children:[e.jsx(cg,{className:"w-5 h-5"}),"Blinji roki"]}),e.jsx("div",{className:"space-y-1 text-sm text-text-secondary",children:n.filter(I=>I.deadline&&xe(I.deadline)).slice(0,3).map((I,Y)=>e.jsxs("div",{children:[" ",I.complianceArea," - Rok: ",new Date(I.deadline).toLocaleDateString("sl-SI")]},Y))})]})]})]})]})}function QD(){const{t:s}=et(),{organizationId:t,loading:r,error:a}=ju(),[n,i]=z.useState([]),[o,c]=z.useState(!0),[d,p]=z.useState(null),[m,x]=z.useState(""),[b,h]=z.useState(""),[j,g]=z.useState(""),[v,_]=z.useState(""),[k,P]=z.useState(""),L=[{id:"1",timestamp:"2024-12-05T10:30:15Z",actionType:"Data Access Request",actionCategory:"Data Subject Rights",table:"user_data_requests",description:"Dostop do osebnih podatkov za uporabnika ID: 12345",userId:"admin_001",userName:"Janez Novak",userEmail:"janez.novak@company.com",ipAddress:"192.168.1.100",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",affectedRecords:15,legalBasis:"Article 15 GDPR",dataCategory:"Personal Data",retentionPeriod:"2 years",zvop2Compliance:!0,gdprCompliance:!0,fileUrl:"/documents/access-request-12345.pdf",fileName:"access-request-12345.pdf",riskLevel:"low",complianceStatus:"compliant",reviewRequired:!1},{id:"2",timestamp:"2024-12-05T09:15:22Z",actionType:"Data Deletion",actionCategory:"Data Subject Rights",table:"user_accounts",description:"Brisanje rauna in vseh povezanih podatkov",userId:"admin_002",userName:"Maria Kova",userEmail:"maria.kovac@company.com",ipAddress:"192.168.1.105",userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36",affectedRecords:25,legalBasis:"Article 17 GDPR",dataCategory:"Personal Data",retentionPeriod:"Immediately",zvop2Compliance:!0,gdprCompliance:!0,fileUrl:"/documents/deletion-log-12346.pdf",fileName:"deletion-log-12346.pdf",riskLevel:"high",complianceStatus:"compliant",reviewRequired:!0,reviewDate:"2024-12-12"},{id:"3",timestamp:"2024-12-05T08:45:33Z",actionType:"Consent Withdrawal",actionCategory:"Legal Basis Management",table:"consent_records",description:"Preklic soglasja za marketing komunikacijo",userId:"user_789",userName:"Peter Horvat",userEmail:"peter.horvat@gmail.com",ipAddress:"192.168.1.200",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15",affectedRecords:8,legalBasis:"Article 6(1)(a) GDPR",dataCategory:"Contact Data",consentRecord:"consent_20241115_001",retentionPeriod:"3 years after withdrawal",zvop2Compliance:!0,gdprCompliance:!0,riskLevel:"low",complianceStatus:"compliant",reviewRequired:!1},{id:"4",timestamp:"2024-12-05T07:20:11Z",actionType:"Data Processing",actionCategory:"Processing Activities",table:"customer_database",description:"Obdelava podatkov za analizo prodaje",userId:"data_analyst_001",userName:"Ana Popovi",userEmail:"ana.popovic@company.com",ipAddress:"192.168.1.150",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",affectedRecords:1200,legalBasis:"Article 6(1)(f) GDPR - Legitimate Interest",dataCategory:"Commercial Data",retentionPeriod:"5 years",zvop2Compliance:!0,gdprCompliance:!0,riskLevel:"medium",complianceStatus:"partial",reviewRequired:!0,reviewDate:"2024-12-15"},{id:"5",timestamp:"2024-12-05T06:55:44Z",actionType:"Third-Party Transfer",actionCategory:"International Transfers",table:"data_transfers",description:"Prenos podatkov v ZDA (Adequacy Decision)",userId:"compliance_officer",userName:"Marko Stergar",userEmail:"marko.stergar@company.com",ipAddress:"192.168.1.80",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",affectedRecords:500,legalBasis:"Article 45 GDPR - Adequacy Decision",dataCategory:"Customer Data",retentionPeriod:"As per third-party policy",zvop2Compliance:!1,gdprCompliance:!0,fileUrl:"/documents/transfer-agreement-2024.pdf",fileName:"transfer-agreement-2024.pdf",riskLevel:"high",complianceStatus:"partial",reviewRequired:!0,reviewDate:"2024-12-10"},{id:"6",timestamp:"2024-12-05T06:30:18Z",actionType:"Security Breach",actionCategory:"Security Incidents",table:"security_incidents",description:"Odkritje neavtoriziranega dostopa do podatkov",userId:"security_team",userName:"Security System",userEmail:"security@company.com",ipAddress:"192.168.1.1",userAgent:"Security Monitor v2.1",affectedRecords:2,legalBasis:"Article 34 GDPR - Breach Notification",dataCategory:"Authentication Data",zvop2Compliance:!0,gdprCompliance:!0,fileUrl:"/documents/incident-report-2024-12-05.pdf",fileName:"incident-report-2024-12-05.pdf",riskLevel:"high",complianceStatus:"non-compliant",reviewRequired:!0,reviewDate:"2024-12-08"}];z.useEffect(()=>{const O=setTimeout(()=>{i(L),c(!1)},1e3);return()=>clearTimeout(O)},[]);const F=n.filter(O=>{const Z=O.description.toLowerCase().includes(m.toLowerCase())||O.userName.toLowerCase().includes(m.toLowerCase())||O.actionType.toLowerCase().includes(m.toLowerCase()),te=!b||O.actionType===b,ce=!j||O.complianceStatus===j,re=!v||O.actionCategory===v;return Z&&te&&ce&&re}),W=O=>{switch(O){case"compliant":return"text-green-500 bg-green-500/10";case"partial":return"text-yellow-500 bg-yellow-500/10";case"non-compliant":return"text-red-500 bg-red-500/10";default:return"text-gray-500 bg-gray-500/10"}},R=O=>{switch(O){case"low":return"text-green-500 bg-green-500/10";case"medium":return"text-yellow-500 bg-yellow-500/10";case"high":return"text-red-500 bg-red-500/10";default:return"text-gray-500 bg-gray-500/10"}},B=O=>{switch(O){case"compliant":return e.jsx(Rt,{className:"w-4 h-4"});case"partial":return e.jsx(cs,{className:"w-4 h-4"});case"non-compliant":return e.jsx(Ss,{className:"w-4 h-4"});default:return e.jsx(er,{className:"w-4 h-4"})}},A=O=>{switch(O){case"Data Subject Rights":return e.jsx(en,{className:"w-4 h-4"});case"Processing Activities":return e.jsx(_u,{className:"w-4 h-4"});case"Legal Basis Management":return e.jsx(Mt,{className:"w-4 h-4"});case"Security Incidents":return e.jsx(er,{className:"w-4 h-4"});case"International Transfers":return e.jsx(Mp,{className:"w-4 h-4"});default:return e.jsx(ut,{className:"w-4 h-4"})}},C=(()=>{const O=n.length,Z=n.filter(oe=>oe.complianceStatus==="compliant").length,te=n.filter(oe=>oe.complianceStatus==="partial").length,ce=n.filter(oe=>oe.complianceStatus==="non-compliant").length,re=n.filter(oe=>oe.riskLevel==="high").length,X=n.filter(oe=>oe.gdprCompliance).length,U=n.filter(oe=>oe.zvop2Compliance).length;return{total:O,compliant:Z,partial:te,nonCompliant:ce,highRisk:re,gdprCompliant:X,zvop2Compliant:U}})();return r||o?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})}):a||!t?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(er,{className:"w-12 h-12 text-status-error mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"Dostop zavrnjen"}),e.jsx("p",{className:"text-body text-text-secondary",children:a||"Organizacija ni najdena"})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-bg-surface rounded-lg p-6 border border-border-subtle",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-accent-primary/10 flex items-center justify-center",children:e.jsx(Mt,{className:"w-5 h-5 text-accent-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"GDPR & ZVOP-2 Audit Trail"}),e.jsx("p",{className:"text-text-secondary",children:"Celoten pregled aktivnosti obdelave podatkov in skladnosti z GDPR ter ZVOP-2"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{className:"px-4 py-2 bg-bg-pure-black text-text-secondary rounded-lg hover:bg-bg-surface-hover transition-colors duration-200",children:[e.jsx(Ir,{className:"w-4 h-4 inline-block mr-2"}),"Izvozi poroilo"]}),e.jsxs("button",{className:"px-4 py-2 bg-accent-primary text-white rounded-lg hover:bg-accent-primary/90 transition-colors duration-200",children:[e.jsx(Dt,{className:"w-4 h-4 inline-block mr-2"}),"Nov vnos"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-bg-surface rounded-lg p-4 border border-border-subtle",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Bi,{className:"w-8 h-8 text-accent-primary"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-text-primary",children:C.total}),e.jsx("div",{className:"text-sm text-text-secondary",children:"Skupaj zapisov"})]})]})}),e.jsx("div",{className:"bg-bg-surface rounded-lg p-4 border border-border-subtle",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Rt,{className:"w-8 h-8 text-green-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-text-primary",children:C.compliant}),e.jsx("div",{className:"text-sm text-text-secondary",children:"Skladni"})]})]})}),e.jsx("div",{className:"bg-bg-surface rounded-lg p-4 border border-border-subtle",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Mt,{className:"w-8 h-8 text-blue-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-text-primary",children:C.gdprCompliant}),e.jsx("div",{className:"text-sm text-text-secondary",children:"GDPR skladni"})]})]})}),e.jsx("div",{className:"bg-bg-surface rounded-lg p-4 border border-border-subtle",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(er,{className:"w-8 h-8 text-red-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-text-primary",children:C.highRisk}),e.jsx("div",{className:"text-sm text-text-secondary",children:"Visoko tveganje"})]})]})})]}),e.jsx("div",{className:"bg-bg-surface rounded-lg p-6 border border-border-subtle",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-4",children:[e.jsxs("div",{className:"flex-1 min-w-[300px] relative",children:[e.jsx(ss,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-text-tertiary"}),e.jsx("input",{type:"text",placeholder:"Ii po opisu, uporabniku ali tipu dejanja...",value:m,onChange:O=>x(O.target.value),className:"w-full pl-10 pr-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("select",{value:b,onChange:O=>h(O.target.value),className:"px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"",children:"Vsi tipi dejanj"}),e.jsx("option",{value:"Data Access Request",children:"Dostop do podatkov"}),e.jsx("option",{value:"Data Deletion",children:"Brisanje podatkov"}),e.jsx("option",{value:"Consent Withdrawal",children:"Preklic soglasja"}),e.jsx("option",{value:"Data Processing",children:"Obdelava podatkov"}),e.jsx("option",{value:"Third-Party Transfer",children:"Prenos podatkov"}),e.jsx("option",{value:"Security Breach",children:"Varnostni incident"})]}),e.jsxs("select",{value:v,onChange:O=>_(O.target.value),className:"px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"",children:"Vse kategorije"}),e.jsx("option",{value:"Data Subject Rights",children:"Pravice posameznikov"}),e.jsx("option",{value:"Processing Activities",children:"Dejavnosti obdelave"}),e.jsx("option",{value:"Legal Basis Management",children:"Pravne podlage"}),e.jsx("option",{value:"Security Incidents",children:"Varnostni incidenti"}),e.jsx("option",{value:"International Transfers",children:"Mednarodni prenosi"})]}),e.jsxs("select",{value:j,onChange:O=>g(O.target.value),className:"px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"",children:"Vsi statusi"}),e.jsx("option",{value:"compliant",children:"Skladno"}),e.jsx("option",{value:"partial",children:"Delno skladno"}),e.jsx("option",{value:"non-compliant",children:"Neskladno"})]})]})}),e.jsx("div",{className:"bg-bg-surface rounded-lg border border-border-subtle",children:F.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-pure-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-text-secondary uppercase tracking-wide",children:"as"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-text-secondary uppercase tracking-wide",children:"Dejanje"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-text-secondary uppercase tracking-wide",children:"Opis"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-text-secondary uppercase tracking-wide",children:"Uporabnik"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-text-secondary uppercase tracking-wide",children:"Pravna podlaga"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-text-secondary uppercase tracking-wide",children:"GDPR"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-text-secondary uppercase tracking-wide",children:"ZVOP-2"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-text-secondary uppercase tracking-wide",children:"Tveganje"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-text-secondary uppercase tracking-wide",children:"Status"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-text-secondary uppercase tracking-wide",children:"Dokumenti"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-text-secondary uppercase tracking-wide",children:"Akcije"})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:F.map(O=>e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 text-sm text-text-secondary",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_a,{className:"w-4 h-4"}),new Date(O.timestamp).toLocaleString("sl-SI")]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[A(O.actionCategory),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-text-primary text-sm",children:O.actionType}),e.jsx("div",{className:"text-xs text-text-secondary",children:O.actionCategory})]})]})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm text-text-primary max-w-md",children:O.description}),e.jsxs("div",{className:"text-xs text-text-secondary mt-1",children:["Vpliva: ",O.affectedRecords," zapisov"]})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(en,{className:"w-4 h-4 text-text-secondary"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-text-primary",children:O.userName}),e.jsx("div",{className:"text-xs text-text-secondary",children:O.userEmail})]})]})}),e.jsx("td",{className:"px-6 py-4 text-xs text-text-secondary max-w-[150px]",children:O.legalBasis}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"flex items-center gap-1",children:O.gdprCompliance?e.jsx(Rt,{className:"w-4 h-4 text-green-500"}):e.jsx(Ss,{className:"w-4 h-4 text-red-500"})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"flex items-center gap-1",children:O.zvop2Compliance?e.jsx(Rt,{className:"w-4 h-4 text-green-500"}):e.jsx(Ss,{className:"w-4 h-4 text-red-500"})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${R(O.riskLevel)}`,children:O.riskLevel==="low"?"Nizko":O.riskLevel==="medium"?"Srednje":"Visoko"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:`flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${W(O.complianceStatus)}`,children:[B(O.complianceStatus),O.complianceStatus==="compliant"?"Skladno":O.complianceStatus==="partial"?"Delno":"Neskladno"]})}),e.jsx("td",{className:"px-6 py-4",children:O.fileUrl?e.jsxs("a",{href:O.fileUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-accent-primary hover:text-accent-primary-hover transition-colors",children:[e.jsx(ut,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm truncate max-w-[100px]",children:O.fileName||"Dokument"}),e.jsx(Ir,{className:"w-3 h-3"})]}):e.jsx("span",{className:"text-text-muted text-sm",children:"-"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{className:"p-2 text-text-secondary hover:text-accent-primary hover:bg-accent-primary/10 rounded-lg transition-colors",children:e.jsx(lr,{className:"w-4 h-4"})}),e.jsx("button",{className:"p-2 text-text-secondary hover:text-accent-primary hover:bg-accent-primary/10 rounded-lg transition-colors",children:e.jsx(ar,{className:"w-4 h-4"})})]})})]},O.id))})]})}):e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(Mt,{className:"w-12 h-12 text-text-tertiary mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:m||b||v||j?"Ni rezultatov iskanja":"Ni zapisov audit trail"}),e.jsx("p",{className:"text-text-secondary mb-6",children:m||b||v||j?"Poskusite z drugimi iskalnimi pogoji":"Audit trail e ni ustanovljen"}),!m&&!b&&!v&&!j&&e.jsxs("button",{className:"px-6 py-3 bg-accent-primary text-white rounded-lg hover:bg-accent-primary/90 transition-colors duration-200",children:[e.jsx(Dt,{className:"w-4 h-4 inline-block mr-2"}),"Dodaj prvi zapis"]})]})}),F.length>0&&e.jsxs("div",{className:"bg-bg-surface rounded-lg border border-border-subtle",children:[e.jsx("div",{className:"px-6 py-4 border-b border-border-subtle",children:e.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Povzetek skladnosti"})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-bg-near-black rounded-lg p-4 border border-border-subtle",children:[e.jsxs("h4",{className:"font-medium text-text-primary mb-3 flex items-center gap-2",children:[e.jsx(Mt,{className:"w-5 h-5 text-blue-500"}),"GDPR skladnost"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-text-secondary",children:"Skladni zapisi:"}),e.jsxs("span",{className:"text-green-500 font-medium",children:[C.gdprCompliant,"/",C.total]})]}),e.jsx("div",{className:"w-full bg-bg-surface rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${C.gdprCompliant/C.total*100}%`}})})]})]}),e.jsxs("div",{className:"bg-bg-near-black rounded-lg p-4 border border-border-subtle",children:[e.jsxs("h4",{className:"font-medium text-text-primary mb-3 flex items-center gap-2",children:[e.jsx(Mt,{className:"w-5 h-5 text-accent-primary"}),"ZVOP-2 skladnost"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-text-secondary",children:"Skladni zapisi:"}),e.jsxs("span",{className:"text-accent-primary font-medium",children:[C.zvop2Compliant,"/",C.total]})]}),e.jsx("div",{className:"w-full bg-bg-surface rounded-full h-2",children:e.jsx("div",{className:"bg-accent-primary h-2 rounded-full",style:{width:`${C.zvop2Compliant/C.total*100}%`}})})]})]})]}),n.filter(O=>O.reviewRequired&&O.reviewDate).length>0&&e.jsxs("div",{className:"mt-6 p-4 bg-yellow-500/10 border border-yellow-500/20 rounded-lg",children:[e.jsxs("h4",{className:"font-medium text-yellow-600 mb-2 flex items-center gap-2",children:[e.jsx(cs,{className:"w-5 h-5"}),"Potrebni pregledi"]}),e.jsx("div",{className:"space-y-1 text-sm text-text-secondary",children:n.filter(O=>O.reviewRequired&&O.reviewDate).slice(0,3).map((O,Z)=>e.jsxs("div",{children:["Pregled za: ",O.actionType," - ",O.reviewDate]},Z))})]})]})]})]})}const z_=[{id:"1",assessment_id:"DPIA-2024-001",project_name:"DPIA - Implementacija CRM sistema",project_description:"Implementacija novega CRM sistema za upravljanje odnosov s strankami, ki vkljuuje zbiranje, obdelavo in analizo osebnih podatkov strank.",lawful_basis:"Pogodba (len 6(1)(b)) - izvajanje pogodbe s strankami",assessment_date:"2024-01-15",completion_date:"2024-02-01",status:"approved",approval_authority:"Janez Novak",approval_date:"2024-02-05",privacy_by_design:!0,risk_level:"medium",data_types:["Osebni identifikatorji","Kontaktni podatki","Zgodovina nakupov"],data_subjects:["Stranke","Potencialne stranke"],technical_measures:["ifriranje podatkov","Dostopna kontrola","Varnostno kopiranje"],organizational_measures:["Politika varstva podatkov","Usposabljanje zaposlenih","Dodelitev vlog"],risk_scenarios:["Neavtoriziran dostop","Izguba podatkov"],data_processing_description:"Sistem bo obdeloval osnovne kontaktne podatke in zgodovino strank za namen izboljanja storitev.",necessity_assessment:"CRM sistem je nujen za uinkovito upravljanje strank in izvajanje pogodbenih obveznosti.",risks_identified:"Monost neavtoriziranega dostopa do osebnih podatkov strank.",mitigation_measures:"Implementacija monih tehninih in organizacijskih ukrepov za varstvo podatkov.",approved_by:"Janez Novak",file_name:"DPIA_CRM_2024.pdf",file_size:2048e3},{id:"2",assessment_id:"DPIA-2024-002",project_name:"DPIA - Uporaba video nadzora",project_description:"Postavitev video nadzornega sistema v poslovnih prostorih za zagotavljanje varnosti in prepreevanje kaznivih dejanj.",lawful_basis:"Zakoniti interes (len 6(1)(f)) - varovanje premoenja in varnost",assessment_date:"2024-02-10",completion_date:"2024-02-25",status:"approved",approval_authority:"Marija Kova",approval_date:"2024-03-01",privacy_by_design:!0,risk_level:"high",zvop2_video_surveillance:!0,data_types:["Video posnetki","Biometrini podatki"],data_subjects:["Zaposleni","Obiskovalci","Dostavljavci"],technical_measures:["Varnostno shranjevanje","Dostopna kontrola","Samodejno brisanje"],organizational_measures:["Politika video nadzora","Obveanje posameznikov","Pravilnik o hrambi"],risk_scenarios:["Zloraba video posnetkov","Neupravien dostop","Prekoraitev namena"],data_processing_description:"Video nadzor za zagotavljanje varnosti v poslovnih prostorih 24/7.",necessity_assessment:"Video nadzor je potreben za zaito premoenja in zagotavljanje varnosti zaposlenih.",risks_identified:"Visoko tveganje zaradi obutljivih biometrinih podatkov in potencialne zlorabe.",mitigation_measures:"Strogi dostopni ukrepi, asovno omejena hramba, redne kontrole dostopa.",approved_by:"Marija Kova",file_name:"DPIA_Video_2024.pdf",file_size:1536e3},{id:"3",assessment_id:"DPIA-2024-003",project_name:"DPIA - Analiza podatkov strank",project_description:"Izvedba napredne analize podatkov strank za razumevanje vedenjskih vzorcev in izboljanje storitev.",lawful_basis:"Zakoniti interes (len 6(1)(f)) - izboljanje storitev",assessment_date:"2024-03-05",completion_date:"2024-03-20",status:"approved",risk_level:"medium",data_types:["Osebni identifikatorji","Podatki o vedenju","Podatki o preferencah"],data_subjects:["Stranke","Uporabniki spletne strani"],technical_measures:["Pseudonimizacija","ifriranje","Varnostna analiza"],organizational_measures:["Smernice za analitiko","Usposabljanje analitikov","Redne kontrole"],risk_scenarios:["Reidentifikacija","Diskriminacija","Napane odloitve"],data_processing_description:"Analiza podatkov za razumevanje potreb strank in prilagoditev storitev.",necessity_assessment:"Analitika je kljuna za razumevanje potreb strank in prilagoditev ponudbe.",risks_identified:"Tveganje reidentifikacije in potencialne diskriminacije pri odloanju.",mitigation_measures:"Uporaba pseudonimizacije in etinih smernic pri analizi.",approved_by:"Peter Horvat",file_name:null,file_size:null},{id:"4",assessment_id:"DPIA-2024-004",project_name:"DPIA - Avtomatizirano odloanje",project_description:"Implementacija sistema za avtomatizirano odloanje pri odobritvi kreditov in drugih finannih storitev.",lawful_basis:"Pogodba (len 6(1)(b)) - izvajanje finanne pogodbe",assessment_date:"2024-04-10",completion_date:"2024-04-30",status:"in_progress",risk_level:"high",data_types:["Finanni podatki","Kreditna zgodovina","Osebni identifikatorji"],data_subjects:["Prosilci za kredite","Kreditojemalci"],technical_measures:["Algoritemske kontrole","Transparentnost","Varnostno testiranje"],organizational_measures:["Politika avtomatiziranega odloanja","Usposabljanje","Redne presoje"],risk_scenarios:["Diskriminacija","Napane odloitve","Pravne posledice"],data_processing_description:"Avtomatizirano odloanje na podlagi algoritma za oceno kreditne sposobnosti.",necessity_assessment:"Avtomatizacija je potrebna za hitro in uinkovito obdelavo velikega tevila zahtevkov.",risks_identified:"Visoko tveganje diskriminacije in napanih odloitev, ki lahko vplivajo na lovekove pravice.",mitigation_measures:"Transparentni algoritmi, monost lovekovega posredovanja, redne presoje.",approved_by:null,file_name:"DPIA_Avtomatizirano_2024.pdf",file_size:256e4},{id:"5",assessment_id:"DPIA-2024-005",project_name:"DPIA - Profiliranje uporabnikov",project_description:"Sistem za profiliranje uporabnikov spletne trgovine za prikaz prilagojenih ponudb in priporoil.",lawful_basis:"Privolitev (len 6(1)(a)) - jasna privolitev uporabnika",assessment_date:"2024-05-15",completion_date:"2024-06-01",status:"approved",approval_authority:"Ana Smolik",approval_date:"2024-06-05",privacy_by_design:!0,risk_level:"low",data_types:["Podatki o vedenju","Preference","Zgodovina nakupov"],data_subjects:["Uporabniki spletne trgovine"],technical_measures:["Anonimizacija","Opt-out monosti","Varnostno shranjevanje"],organizational_measures:["Politika profiliranja","Obveanje uporabnikov","Kontrola dostopa"],risk_scenarios:["Zloraba podatkov","Nadzor nad uporabniki"],data_processing_description:"Profiliranje za prikaz prilagojenih ponudb in izboljanje nakupovalne izkunje.",necessity_assessment:"Profiliranje izbolja uporabniko izkunjo in povea zadovoljstvo strank.",risks_identified:"Nizko tveganje zaradi anonimizacije in monosti opt-out.",mitigation_measures:"Jasno obveanje, monost zavrnitve, redne kontrole sistema",approved_by:"Ana Smolik",file_name:"DPIA_Profiliranje_2024.pdf",file_size:12e5}];function eE(){var te,ce,re,X;const{t:s}=et(),[t,r]=z.useState([]),[a,n]=z.useState(!0),[i,o]=z.useState(!1),[c,d]=z.useState(!1),[p,m]=z.useState(null),[x,b]=z.useState(""),[h,j]=z.useState("all"),[g,v]=z.useState("all"),_=async()=>{try{const{data:U,error:oe}=await Ne.from("gdpr_dpia_assessments").select("*").order("assessment_date",{ascending:!1});if(oe)throw oe;if(!U||U.length===0){const xe=z_.map(J=>({...J,risk_level:k(J)}));r(xe)}else{const xe=U.map(J=>({...J,risk_level:k(J)}));r(xe)}}catch(U){console.error("Error:",U);const oe=z_.map(xe=>({...xe,risk_level:k(xe)}));r(oe)}finally{n(!1)}},k=U=>{var J,$,Q,q,I,Y;return U.risk_level?U.risk_level:((J=U.data_types)==null?void 0:J.includes("Zdravstveni podatki"))||(($=U.data_types)==null?void 0:$.includes("Biometrini podatki"))||((Q=U.data_types)==null?void 0:Q.includes("Genetski podatki"))||U.special_categories||U.third_country_transfers||U.ip_consultation_required?"high":((q=U.data_types)==null?void 0:q.includes("Finanni podatki"))||((I=U.data_types)==null?void 0:I.includes("Osebni identifikatorji"))||U.zvop2_video_surveillance||((Y=U.data_subjects)==null?void 0:Y.includes("Otroci (mlaji od 16 let)"))?"medium":"low"},P=()=>{_(),o(!1)},L=U=>{m(U),d(!0)},F=U=>{m(U),o(!0)},W=U=>{try{const oe=`
        <html>
          <head>
            <title>DPIA ${U.assessment_id}</title>
            <style>
              body { font-family: Arial, sans-serif; margin: 20px; }
              .header { text-align: center; margin-bottom: 30px; }
              .section { margin-bottom: 20px; }
              .label { font-weight: bold; color: #333; }
              .value { margin-bottom: 10px; }
              .risk-high { color: #ef4444; }
              .risk-medium { color: #f59e0b; }
              .risk-low { color: #22c55e; }
            </style>
          </head>
          <body>
            <div class="header">
              <h1 class="text-2xl font-bold">DPIA Poroilo</h1>
              <p>${U.assessment_id}</p>
              <p>Generirano: ${new Date().toLocaleDateString("sl-SI")}</p>
            </div>
            
            <div class="section">
              <h2>Osnovne informacije</h2>
              <p class="label">Ime projekta:</p>
              <p class="value">${U.project_name}</p>
              
              <p class="label">Datum ocene:</p>
              <p class="value">${new Date(U.assessment_date).toLocaleDateString("sl-SI")}</p>
              
              <p class="label">Status:</p>
              <p class="value">${A(U.status)}</p>
              
              <p class="label">Tveganje:</p>
              <p class="value risk-${U.risk_level||"medium"}">${S(U.risk_level||"medium")}</p>
            </div>
            
            <div class="section">
              <h2>Opis projekta</h2>
              <p class="value">${U.project_description||U.data_processing_description||"-"}</p>
            </div>
            
            <div class="section">
              <h2>Pravna podlaga</h2>
              <p class="value">${U.lawful_basis||"-"}</p>
            </div>
            
            ${U.necessity_assessment?`
            <div class="section">
              <h2>Ocena potrebnosti</h2>
              <p class="value">${U.necessity_assessment}</p>
            </div>
            `:""}
            
            ${U.risks_identified?`
            <div class="section">
              <h2>Prepoznana tveganja</h2>
              <p class="value">${U.risks_identified}</p>
            </div>
            `:""}
            
            ${U.mitigation_measures?`
            <div class="section">
              <h2>Ukrei za zmanjanje tveganja</h2>
              <p class="value">${U.mitigation_measures}</p>
            </div>
            `:""}
          </body>
        </html>
      `,xe=window.open("","_blank");xe&&(xe.document.write(oe),xe.document.close(),xe.print())}catch(oe){console.error("PDF export error:",oe),alert("Napaka pri generiranju PDF.")}},R=()=>{const U=["Assessment ID","Project Name","Assessment Date","Status","Risk Level","Approved By","Approval Date","Data Processing Description","Necessity Assessment","Risks Identified","Mitigation Measures"],oe=Z.map(q=>[q.assessment_id,q.project_name,new Date(q.assessment_date).toLocaleDateString("sl-SI"),A(q.status),S(q.risk_level||"medium"),q.approved_by||"",q.approval_date?new Date(q.approval_date).toLocaleDateString("sl-SI"):"",q.data_processing_description||"",q.necessity_assessment||"",q.risks_identified||"",q.mitigation_measures||""]),xe=[U,...oe].map(q=>q.map(I=>`"${I}"`).join(",")).join(`
`),J=new Blob([xe],{type:"text/csv;charset=utf-8;"}),$=document.createElement("a"),Q=URL.createObjectURL(J);$.setAttribute("href",Q),$.setAttribute("download",`gdpr_dpia_${new Date().toISOString().split("T")[0]}.csv`),$.style.visibility="hidden",document.body.appendChild($),$.click(),document.body.removeChild($)},B=async()=>{try{const U=`
        <html>
          <head>
            <title>DPIA Report</title>
            <style>
              body { font-family: Arial, sans-serif; margin: 20px; }
              .header { text-align: center; margin-bottom: 30px; }
              table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
              th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
              th { background-color: #f2f2f2; }
              .risk-high { color: #ef4444; }
              .risk-medium { color: #f59e0b; }
              .risk-low { color: #22c55e; }
            </style>
          </head>
          <body>
            <div class="header">
              <h1 className="text-2xl font-bold text-text-primary">GDPR DPIA Poroilo</h1>
              <p>Generirano: ${new Date().toLocaleDateString("sl-SI")}</p>
            </div>
            <table>
              <thead>
                <tr>
                  <th>Assessment ID</th>
                  <th>Project Name</th>
                  <th>Datum</th>
                  <th>Status</th>
                  <th>Tveganje</th>
                  <th>Odobril</th>
                </tr>
              </thead>
              <tbody>
                ${Z.map(xe=>`
                  <tr>
                    <td>${xe.assessment_id}</td>
                    <td>${xe.project_name}</td>
                    <td>${new Date(xe.assessment_date).toLocaleDateString("sl-SI")}</td>
                    <td>${A(xe.status)}</td>
                    <td class="risk-${xe.risk_level||"medium"}">${S(xe.risk_level||"medium")}</td>
                    <td>${xe.approved_by||"-"}</td>
                  </tr>
                `).join("")}
              </tbody>
            </table>
          </body>
        </html>
      `,oe=window.open("","_blank");oe&&(oe.document.write(U),oe.document.close(),oe.print())}catch(U){console.error("PDF export error:",U),alert("Napaka pri generiranju PDF.")}},A=U=>({in_progress:"V izdelavi",completed:"Dokonano",approved:"Odobreno",rejected:"Zavrnjeno"})[U]||U,S=U=>({low:"Nizko",medium:"Srednje",high:"Visoko",critical:"Kritino"})[U]||"Srednje",C=U=>{const oe={low:"bg-risk-low/10 text-risk-low border-risk-low/20",medium:"bg-risk-medium/10 text-risk-medium border-risk-medium/20",high:"bg-risk-high/10 text-risk-high border-risk-high/20",critical:"bg-red-100 text-red-800 border-red-200"};return oe[U]||oe.medium},O=U=>{const oe={in_progress:"bg-status-warning/10 text-status-warning border-status-warning/20",completed:"bg-accent-primary/10 text-accent-primary border-accent-primary/20",approved:"bg-status-success/10 text-status-success border-status-success/20",rejected:"bg-status-error/10 text-status-error border-status-error/20"};return oe[U]||oe.in_progress},Z=z.useMemo(()=>t.filter(U=>{var $,Q,q;const oe=U.assessment_id.toLowerCase().includes(x.toLowerCase())||U.project_name.toLowerCase().includes(x.toLowerCase())||(($=U.data_processing_description)==null?void 0:$.toLowerCase().includes(x.toLowerCase()))||((Q=U.necessity_assessment)==null?void 0:Q.toLowerCase().includes(x.toLowerCase()))||((q=U.risks_identified)==null?void 0:q.toLowerCase().includes(x.toLowerCase())),xe=h==="all"||U.status===h,J=g==="all"||U.risk_level===g;return oe&&xe&&J}),[t,x,h,g]);return z.useEffect(()=>{_()},[]),a?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-accent-primary/10 flex items-center justify-center",children:e.jsx(Jy,{className:"w-5 h-5 text-accent-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:s("gdpr.dpia.title")}),e.jsxs("p",{className:"text-body-sm text-text-secondary",children:["Ocena vpliva na varstvo podatkov - GDPR len 35 (",Z.length," zapisov)"]}),e.jsx("p",{className:"text-caption text-text-muted",children:"Prikazujejo se demonstracijski podatki"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:R,className:"h-10 px-4 bg-bg-surface border border-border-subtle hover:bg-bg-surface-hover text-text-primary rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Ir,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium hidden sm:inline",children:"CSV"})]}),e.jsxs("button",{onClick:B,className:"h-10 px-4 bg-bg-surface border border-border-subtle hover:bg-bg-surface-hover text-text-primary rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Ir,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium hidden sm:inline",children:"PDF"})]}),e.jsxs("button",{onClick:()=>o(!0),className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Dt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:s("gdpr.dpia.addDpia")})]})]})]}),e.jsx("div",{className:"bg-bg-surface rounded-sm border border-border-subtle p-4 space-y-4",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ss,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-text-secondary"}),e.jsx("input",{type:"text",placeholder:"Ii po ID, projektu, opisu...",value:x,onChange:U=>b(U.target.value),className:"w-full pl-10 pr-4 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary placeholder-text-secondary focus:border-accent-primary focus:outline-none transition-colors"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Wp,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-text-secondary"}),e.jsxs("select",{value:h,onChange:U=>j(U.target.value),className:"pl-10 pr-8 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:border-accent-primary focus:outline-none transition-colors appearance-none cursor-pointer min-w-[140px]",children:[e.jsx("option",{value:"all",children:"Vsi statusi"}),e.jsx("option",{value:"in_progress",children:"V izdelavi"}),e.jsx("option",{value:"completed",children:"Dokonano"}),e.jsx("option",{value:"approved",children:"Odobreno"}),e.jsx("option",{value:"rejected",children:"Zavrnjeno"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(pt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-text-secondary"}),e.jsxs("select",{value:g,onChange:U=>v(U.target.value),className:"pl-10 pr-8 py-2 bg-bg-near-black border border-border-subtle rounded-sm text-text-primary focus:border-accent-primary focus:outline-none transition-colors appearance-none cursor-pointer min-w-[140px]",children:[e.jsx("option",{value:"all",children:"Vsa tveganja"}),e.jsx("option",{value:"low",children:"Nizko"}),e.jsx("option",{value:"medium",children:"Srednje"}),e.jsx("option",{value:"high",children:"Visoko"}),e.jsx("option",{value:"critical",children:"Kritino"})]})]})]})}),e.jsxs("div",{className:"bg-bg-surface rounded-sm border border-border-subtle overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-pure-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 lg:px-6 py-4 text-caption text-text-secondary uppercase tracking-wide min-w-[120px]",children:s("gdpr.dpia.assessmentId")}),e.jsx("th",{className:"text-left px-4 lg:px-6 py-4 text-caption text-text-secondary uppercase tracking-wide min-w-[180px]",children:s("gdpr.dpia.projectName")}),e.jsx("th",{className:"text-left px-4 lg:px-6 py-4 text-caption text-text-secondary uppercase tracking-wide min-w-[150px] hidden md:table-cell",children:"Pravna podlaga"}),e.jsx("th",{className:"text-left px-4 lg:px-6 py-4 text-caption text-text-secondary uppercase tracking-wide min-w-[100px]",children:"Status"}),e.jsx("th",{className:"text-left px-4 lg:px-6 py-4 text-caption text-text-secondary uppercase tracking-wide min-w-[100px]",children:"Tveganje"}),e.jsx("th",{className:"text-left px-4 lg:px-6 py-4 text-caption text-text-secondary uppercase tracking-wide min-w-[100px] hidden lg:table-cell",children:"Odobril"}),e.jsx("th",{className:"text-left px-4 lg:px-6 py-4 text-caption text-text-secondary uppercase tracking-wide min-w-[80px] hidden lg:table-cell",children:"Datoteka"}),e.jsx("th",{className:"text-left px-4 lg:px-6 py-4 text-caption text-text-secondary uppercase tracking-wide min-w-[80px]",children:"Akcije"})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:Z.map(U=>e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-4 lg:px-6 py-4 text-body text-text-primary font-mono",children:U.assessment_id}),e.jsx("td",{className:"px-4 lg:px-6 py-4 text-body text-text-primary font-medium max-w-[200px] truncate",title:U.project_name,children:U.project_name}),e.jsx("td",{className:"px-4 lg:px-6 py-4 text-body text-text-secondary hidden md:table-cell",children:e.jsx("div",{className:"max-w-[140px] truncate",title:U.lawful_basis,children:U.lawful_basis?U.lawful_basis.split("(")[0].trim():"-"})}),e.jsx("td",{className:"px-4 lg:px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium border ${O(U.status)}`,children:A(U.status)})}),e.jsx("td",{className:"px-4 lg:px-6 py-4",children:e.jsxs("span",{className:`px-2 py-1 rounded-full text-caption font-medium border flex items-center gap-1 w-fit ${C(U.risk_level||"medium")}`,children:[e.jsx(pt,{className:"w-3 h-3"}),S(U.risk_level||"medium")]})}),e.jsx("td",{className:"px-4 lg:px-6 py-4 text-body text-text-secondary hidden lg:table-cell",children:U.approval_authority||U.approved_by||"-"}),e.jsx("td",{className:"px-4 lg:px-6 py-4 hidden lg:table-cell",children:U.file_url?e.jsxs("a",{href:U.file_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-accent-primary hover:text-accent-primary-hover transition-colors",title:U.file_name,children:[e.jsx(ut,{className:"w-4 h-4"}),e.jsx(Ir,{className:"w-3 h-3"})]}):e.jsx("span",{className:"text-text-muted text-sm",children:"-"})}),e.jsx("td",{className:"px-4 lg:px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>L(U),className:"p-2 text-accent-primary hover:bg-accent-primary/10 rounded transition-colors",title:"Poglej podrobnosti",children:e.jsx(lr,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>F(U),className:"p-2 text-status-warning hover:bg-status-warning/10 rounded transition-colors",title:"Uredi zapis",children:e.jsx(ar,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>W(U),className:"p-2 text-accent-secondary hover:bg-accent-secondary/10 rounded transition-colors",title:"Izvozi v PDF",children:e.jsx(bS,{className:"w-4 h-4"})})]})})]},U.id))})]})}),Z.length===0&&e.jsxs("div",{className:"text-center py-12 text-text-secondary",children:[e.jsx(Jy,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-body",children:x||h!=="all"||g!=="all"?"Ni zapisov, ki ustrezajo filtrom.":"Nobenih DPIA zapisov ni bilo najdenih."}),e.jsx("p",{className:"text-caption text-text-muted mt-2",children:"Prikazujejo se demonstracijski podatki"})]})]}),e.jsx(Yp,{isOpen:c,onClose:()=>d(!1),title:`DPIA Podrobnosti - ${p==null?void 0:p.project_name}`,children:p&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-body-sm font-medium text-text-primary mb-2",children:"Osnovne informacije"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-caption text-text-secondary",children:"Assessment ID:"}),e.jsx("p",{className:"text-body text-text-primary font-mono",children:p.assessment_id})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-caption text-text-secondary",children:"Ime projekta:"}),e.jsx("p",{className:"text-body text-text-primary",children:p.project_name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-caption text-text-secondary",children:"Datum ocene:"}),e.jsx("p",{className:"text-body text-text-primary",children:new Date(p.assessment_date).toLocaleDateString("sl-SI")})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-caption text-text-secondary",children:"Status:"}),e.jsx("span",{className:`ml-2 px-2 py-1 rounded-full text-caption font-medium border ${O(p.status)}`,children:A(p.status)})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-body-sm font-medium text-text-primary mb-2",children:"Tveganje in odobritev"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-caption text-text-secondary",children:"Nivo tveganja:"}),e.jsxs("span",{className:`ml-2 px-2 py-1 rounded-full text-caption font-medium border flex items-center gap-1 w-fit ${C(p.risk_level||"medium")}`,children:[e.jsx(pt,{className:"w-3 h-3"}),S(p.risk_level||"medium")]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-caption text-text-secondary",children:"Odobril:"}),e.jsx("p",{className:"text-body text-text-primary",children:p.approval_authority||p.approved_by||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-caption text-text-secondary",children:"Datum odobritve:"}),e.jsx("p",{className:"text-body text-text-primary",children:p.approval_date?new Date(p.approval_date).toLocaleDateString("sl-SI"):p.approval_date_legacy?new Date(p.approval_date_legacy).toLocaleDateString("sl-SI"):"-"})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-body-sm font-medium text-text-primary mb-2",children:"Opis projekta"}),e.jsx("p",{className:"text-body text-text-secondary p-3 bg-bg-near-black rounded border border-border-subtle",children:p.project_description||p.data_processing_description||"-"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-body-sm font-medium text-text-primary mb-2",children:"Pravna podlaga"}),e.jsx("p",{className:"text-body text-text-secondary p-3 bg-bg-near-black rounded border border-border-subtle",children:p.lawful_basis||"-"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-body-sm font-medium text-text-primary mb-2",children:"Vrste podatkov"}),e.jsx("div",{className:"flex flex-wrap gap-2 p-3 bg-bg-near-black rounded border border-border-subtle",children:(te=p.data_types)!=null&&te.length?p.data_types.map((U,oe)=>e.jsx("span",{className:"px-2 py-1 bg-accent-primary/10 text-accent-primary rounded-full text-caption",children:U},oe)):e.jsx("span",{className:"text-body text-text-secondary",children:"-"})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-body-sm font-medium text-text-primary mb-2",children:"Kategorije posameznikov"}),e.jsx("div",{className:"flex flex-wrap gap-2 p-3 bg-bg-near-black rounded border border-border-subtle",children:(ce=p.data_subjects)!=null&&ce.length?p.data_subjects.map((U,oe)=>e.jsx("span",{className:"px-2 py-1 bg-status-success/10 text-status-success rounded-full text-caption",children:U},oe)):e.jsx("span",{className:"text-body text-text-secondary",children:"-"})})]}),p.necessity_assessment&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-body-sm font-medium text-text-primary mb-2",children:"Ocena potrebnosti"}),e.jsx("p",{className:"text-body text-text-secondary p-3 bg-bg-near-black rounded border border-border-subtle",children:p.necessity_assessment})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-body-sm font-medium text-text-primary mb-2",children:"Tehnini ukrepi"}),e.jsx("div",{className:"flex flex-wrap gap-2 p-3 bg-bg-near-black rounded border border-border-subtle",children:(re=p.technical_measures)!=null&&re.length?p.technical_measures.map((U,oe)=>e.jsx("span",{className:"px-2 py-1 bg-status-warning/10 text-status-warning rounded-full text-caption",children:U},oe)):e.jsx("span",{className:"text-body text-text-secondary",children:"-"})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-body-sm font-medium text-text-primary mb-2",children:"Organizacijski ukrepi"}),e.jsx("div",{className:"flex flex-wrap gap-2 p-3 bg-bg-near-black rounded border border-border-subtle",children:(X=p.organizational_measures)!=null&&X.length?p.organizational_measures.map((U,oe)=>e.jsx("span",{className:"px-2 py-1 bg-status-error/10 text-status-error rounded-full text-caption",children:U},oe)):e.jsx("span",{className:"text-body text-text-secondary",children:"-"})})]})]}),p.file_url&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-body-sm font-medium text-text-primary mb-2",children:"Priloena datoteka"}),e.jsxs("a",{href:p.file_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 p-3 bg-bg-near-black border border-border-subtle rounded hover:border-accent-primary transition-colors",children:[e.jsx(ut,{className:"w-5 h-5 text-accent-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-body text-text-primary",children:p.file_name||"Datoteka"}),p.file_size&&e.jsxs("p",{className:"text-caption text-text-secondary",children:[Math.round(p.file_size/1024)," KB"]})]}),e.jsx(Ir,{className:"w-4 h-4 text-accent-primary ml-auto"})]})]})]})}),e.jsx($D,{isOpen:i,onClose:()=>{o(!1),m(null)},onSuccess:P,editData:p})]})}function C_(){const{t:s}=et(),{organizationId:t,loading:r,error:a}=ju(),[n,i]=z.useState([]),[o,c]=z.useState(!0),[d,p]=z.useState(!1),[m,x]=z.useState(null),b=async()=>{if(!t){c(!1);return}try{x(null),console.log("Fetching records for organization:",t);const{data:j,error:g}=await Ne.from("gdpr_controller_processor").select("*").eq("organization_id",t).order("created_at",{ascending:!1});if(g)throw console.error("Supabase error:",g),g;console.log("Successfully fetched records:",j),i(j||[])}catch(j){console.error("Error:",j),x(j.message),i([])}finally{c(!1)}},h=()=>{b(),p(!1)};return z.useEffect(()=>{t&&b()},[t]),r?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})}):a||!t?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(er,{className:"w-12 h-12 text-status-error mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:s("common.accessDenied")}),e.jsx("p",{className:"text-body text-text-secondary",children:a||s("gdpr.controller.noOrganization")})]})}):o?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})}):m?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(er,{className:"w-12 h-12 text-status-error mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:s("common.error")}),e.jsx("p",{className:"text-body text-text-secondary mb-4",children:m}),e.jsx("button",{onClick:()=>b(),className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150",children:s("common.retry")})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-accent-primary/10 flex items-center justify-center",children:e.jsx(dg,{className:"w-5 h-5 text-accent-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:s("gdprController.title_new")}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:s("gdprController.subtitle")})]})]}),e.jsxs("button",{onClick:()=>p(!0),className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Dt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:s("gdprController.addEntity")})]})]}),m&&e.jsx("div",{className:"bg-status-error/10 border border-status-error/20 rounded-sm p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(er,{className:"w-5 h-5 text-status-error"}),e.jsx("span",{className:"text-body text-status-error",children:m})]})}),e.jsx("div",{className:"bg-bg-surface rounded-sm border border-border-subtle overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-pure-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("gdprController.fields.company_name")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("gdprController.fields.headquarters_address")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("gdprController.fields.legal_basis")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("gdprController.fields.processing_type")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("gdprController.agreementColumnName")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("gdprController.fields.retention_period")})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:n.map(j=>e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 text-body text-text-primary font-medium",children:j.entity_name}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:j.headquarters_address||"-"}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:j.legal_basis?e.jsx("span",{className:"text-body-sm",children:s(`gdprController.legal_basis_options.${j.legal_basis}`)}):"-"}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:j.processing_type||"-"}),e.jsx("td",{className:"px-6 py-4",children:j.agreement_signed?e.jsx("span",{className:"px-2 py-1 rounded-full text-caption font-medium bg-status-success/10 text-status-success",children:s("gdprController.yes_no.yes")}):e.jsx("span",{className:"px-2 py-1 rounded-full text-caption font-medium bg-status-error/10 text-status-error",children:s("gdprController.yes_no.no")})}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:j.retention_period||"-"})]},j.id))})]})}),e.jsx(BD,{isOpen:d,onClose:()=>p(!1),onSuccess:h})]})}function P_({isOpen:s,onClose:t,onSave:r,editMode:a=!1,editRecord:n=null}){const{t:i}=et(),{user:o}=cr(),[c,d]=z.useState(!1),[p,m]=z.useState(1),[x,b]=z.useState({}),[h,j]=z.useState(null),[g,v]=z.useState(()=>a&&n?{participant_name:n.participant_name||"",participant_email:n.participant_email||"",participant_department:n.participant_department||"",training_title:n.training_title||"",training_type:n.training_type||"gdpr_basic",training_date:n.training_date||"",training_duration:n.training_duration||0,training_location:n.training_location||"",training_format:n.training_format||"online",training_provider:n.training_provider||"",training_cost:n.training_cost||0,instructor_name:n.instructor_name||"",instructor_email:n.instructor_email||"",completion_status:n.completion_status||"planned",completion_date:n.completion_date||"",certificate_issued:n.certificate_issued||!1,certificate_number:n.certificate_number||"",certificate_date:n.certificate_date||"",certificate_expiry_date:n.certificate_expiry_date||"",assessment_type:n.assessment_type||"none",assessment_score:n.assessment_score||0,passed:n.passed||!1,training_goals:n.training_goals||"",key_topics_covered:n.key_topics_covered||"",practical_applications:n.practical_applications||"",follow_up_required:n.follow_up_required||!1,follow_up_date:n.follow_up_date||"",follow_up_description:n.follow_up_description||"",dpo_specific_training:n.dpo_specific_training||!1,dpo_training_content:n.dpo_training_content||"",supervisory_authority_contact:n.supervisory_authority_contact||"",compliance_category:n.compliance_category||"",legal_requirement:n.legal_requirement||"",training_frequency:n.training_frequency||"",last_training_date:n.last_training_date||"",next_training_due:n.next_training_due||"",training_materials_url:n.training_materials_url||"",attendance_sheet_url:n.attendance_sheet_url||"",certificate_url:n.certificate_url||"",additional_documents:n.additional_documents||"",status:n.status||"active",verification_status:n.verification_status||"pending",verified_by:n.verified_by||"",verification_date:n.verification_date||"",notes:n.notes||"",organization_id:n.organization_id||""}:{participant_name:"",participant_email:"",participant_department:"",training_title:"",training_type:"gdpr_basic",training_date:"",training_duration:0,training_location:"",training_format:"online",training_provider:"",training_cost:0,instructor_name:"",instructor_email:"",completion_status:"planned",completion_date:"",certificate_issued:!1,certificate_number:"",certificate_date:"",certificate_expiry_date:"",assessment_type:"none",assessment_score:0,passed:!1,training_goals:"",key_topics_covered:"",practical_applications:"",follow_up_required:!1,follow_up_date:"",follow_up_description:"",dpo_specific_training:!1,dpo_training_content:"",supervisory_authority_contact:"",compliance_category:"",legal_requirement:"",training_frequency:"",last_training_date:"",next_training_due:"",training_materials_url:"",attendance_sheet_url:"",certificate_url:"",additional_documents:"",status:"active",verification_status:"pending",verified_by:"",verification_date:"",notes:"",organization_id:""});z.useEffect(()=>{(async()=>{if(!(!o||!s))try{const{data:C,error:O}=await Ne.from("profiles").select("*, organization_id").eq("id",o.id).single();if(O)throw O;j(C),!a&&C.organization_id&&v(Z=>({...Z,organization_id:C.organization_id}))}catch(C){console.error("Error fetching user profile:",C)}})()},[o,s,a]);const _=S=>{const{name:C,value:O,type:Z}=S.target;v(te=>({...te,[C]:Z==="checkbox"?S.target.checked:Z==="number"?Number(O):O})),x[C]&&b(te=>({...te,[C]:""}))},k=()=>{const S={};return p===1&&(g.participant_name.trim()||(S.participant_name="Ime udeleenca je obvezno"),g.training_title.trim()||(S.training_title="Naslov usposabljanja je obvezen"),g.training_date||(S.training_date="Datum usposabljanja je obvezen"),g.training_duration<=0&&(S.training_duration="Trajanje mora biti veje od 0")),b(S),Object.keys(S).length===0},P=()=>{k()&&m(S=>Math.min(4,S+1))},L=()=>{m(S=>Math.max(1,S-1))},F=async S=>{if(S.preventDefault(),!!k()){d(!0);try{let C;if(!a&&!(h!=null&&h.organization_id))throw new Error("Organizacijski kontekst ni na voljo");if(a&&n){const O={...g,...(h==null?void 0:h.organization_id)&&!n.organization_id&&{organization_id:h.organization_id}};C=(await Ne.from("gdpr_training_evidence").update(O).eq("id",n.id)).error}else{const O={...g,organization_id:h.organization_id};C=(await Ne.from("gdpr_training_evidence").insert([O])).error}if(C)throw C;r()}catch(C){console.error("Error saving training evidence:",C),C instanceof Error&&C.message.includes("Organizacijski kontekst")?alert("Napaka: "+C.message):alert("Napaka pri shranjevanju evidence usposabljanja")}finally{d(!1)}}},W=[{value:"gdpr_basic",label:"GDPR Osnovno"},{value:"gdpr_advanced",label:"GDPR Napredno"},{value:"zvop2",label:"ZVOP-2"},{value:"security_awareness",label:"Varnostna ozaveenost"},{value:"data_breach_response",label:"Odziv na kritve podatkov"},{value:"privacy_by_design",label:"Varstvo podatkov po zasnovi"},{value:"other",label:"Drugo"}],R=[{value:"planned",label:"Nartovano"},{value:"in_progress",label:"V teku"},{value:"completed",label:"Zakljueno"},{value:"failed",label:"Neuspeno"},{value:"cancelled",label:"Preklicano"}],B=[{value:"none",label:"Brez ocenjevanja"},{value:"quiz",label:"Kviz"},{value:"practical",label:"Praktina naloga"},{value:"exam",label:"Izpit"},{value:"project",label:"Projekt"}],A=[{value:"online",label:"Spletno"},{value:"in_person",label:"V ivo"},{value:"hybrid",label:"Hibridno"},{value:"self_study",label:"Samostojno uenje"}];return s?e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsxs("div",{className:"relative top-20 mx-auto p-5 border w-11/12 max-w-4xl shadow-lg rounded-md bg-white",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:a?"Uredi evidenco usposabljanja":"Dodaj novo usposabljanje"}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:e.jsx(Ar,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"flex items-center",children:[1,2,3,4].map(S=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`flex items-center justify-center w-8 h-8 rounded-full text-sm font-medium ${S<=p?"bg-blue-600 text-white":"bg-gray-200 text-gray-600"}`,children:S<p?e.jsx(Rt,{className:"w-5 h-5"}):S}),S<4&&e.jsx("div",{className:`flex-1 h-0.5 mx-2 ${S<p?"bg-blue-600":"bg-gray-200"}`})]},S))}),e.jsxs("div",{className:"flex justify-between mt-2 text-sm text-gray-600",children:[e.jsx("span",{children:"Osnovni podatki"}),e.jsx("span",{children:"Usposabljanje"}),e.jsx("span",{children:"Certifikat"}),e.jsx("span",{children:"Skladnost"})]})]}),e.jsxs("form",{onSubmit:F,children:[p===1&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(en,{className:"h-6 w-6 text-blue-600 mr-2"}),e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Osnovni podatki"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ime udeleenca *"}),e.jsx("input",{type:"text",name:"participant_name",value:g.participant_name,onChange:_,className:`w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent ${x.participant_name?"border-red-500":"border-gray-300"}`,placeholder:"Janez Novak"}),x.participant_name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:x.participant_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"E-pota udeleenca"}),e.jsx("input",{type:"email",name:"participant_email",value:g.participant_email,onChange:_,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"janez.novak@podjetje.si"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Oddelek"}),e.jsx("input",{type:"text",name:"participant_department",value:g.participant_department,onChange:_,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"IT oddelek"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tip usposabljanja *"}),e.jsx("select",{name:"training_type",value:g.training_type,onChange:_,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:W.map(S=>e.jsx("option",{value:S.value,children:S.label},S.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naslov usposabljanja *"}),e.jsx("input",{type:"text",name:"training_title",value:g.training_title,onChange:_,className:`w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent ${x.training_title?"border-red-500":"border-gray-300"}`,placeholder:"GDPR osnove za zaposlene"}),x.training_title&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:x.training_title})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Datum usposabljanja *"}),e.jsx("input",{type:"date",name:"training_date",value:g.training_date,onChange:_,className:`w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent ${x.training_date?"border-red-500":"border-gray-300"}`}),x.training_date&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:x.training_date})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trajanje (minute) *"}),e.jsx("input",{type:"number",name:"training_duration",value:g.training_duration,onChange:_,min:"1",className:`w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent ${x.training_duration?"border-red-500":"border-gray-300"}`,placeholder:"120"}),x.training_duration&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:x.training_duration})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Format usposabljanja"}),e.jsx("select",{name:"training_format",value:g.training_format,onChange:_,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:A.map(S=>e.jsx("option",{value:S.value,children:S.label},S.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lokacija usposabljanja"}),e.jsx("input",{type:"text",name:"training_location",value:g.training_location,onChange:_,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Konferenna dvorana A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ponudnik usposabljanja"}),e.jsx("input",{type:"text",name:"training_provider",value:g.training_provider,onChange:_,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Zunanje podjetje ABC"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ime intruktorja"}),e.jsx("input",{type:"text",name:"instructor_name",value:g.instructor_name,onChange:_,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Dr. Marija Kranjc"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"E-pota intruktorja"}),e.jsx("input",{type:"email",name:"instructor_email",value:g.instructor_email,onChange:_,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"marija.kranjc@abc.si"})]})]})]}),p===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(Rt,{className:"h-6 w-6 text-blue-600 mr-2"}),e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Status in ocena"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status dokonanja"}),e.jsx("select",{name:"completion_status",value:g.completion_status,onChange:_,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:R.map(S=>e.jsx("option",{value:S.value,children:S.label},S.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Datum dokonanja"}),e.jsx("input",{type:"date",name:"completion_date",value:g.completion_date,onChange:_,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tip ocenjevanja"}),e.jsx("select",{name:"assessment_type",value:g.assessment_type,onChange:_,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:B.map(S=>e.jsx("option",{value:S.value,children:S.label},S.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ocena (%)"}),e.jsx("input",{type:"number",name:"assessment_score",value:g.assessment_score,onChange:_,min:"0",max:"100",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"85"})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",name:"passed",checked:g.passed,onChange:_,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{className:"ml-2 block text-sm text-gray-900",children:"Uspeno opravljeno"})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cilji usposabljanja"}),e.jsx("textarea",{name:"training_goals",value:g.training_goals,onChange:_,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Opis ciljev, ki naj bi jih udeleenec dosegel..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kljune teme"}),e.jsx("textarea",{name:"key_topics_covered",value:g.key_topics_covered,onChange:_,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Seznam kljunih tem, ki so bile obravnavane..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Praktina uporaba"}),e.jsx("textarea",{name:"practical_applications",value:g.practical_applications,onChange:_,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Opis praktinih primerov in aplikacij..."})]})]})]}),p===3&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(pl,{className:"h-6 w-6 text-blue-600 mr-2"}),e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Certifikat in sledenje"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",name:"certificate_issued",checked:g.certificate_issued,onChange:_,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{className:"ml-2 block text-sm text-gray-900",children:"Certifikat je bil izdan"})]}),g.certificate_issued&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"tevilka certifikata"}),e.jsx("input",{type:"text",name:"certificate_number",value:g.certificate_number,onChange:_,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"CERT-2024-001"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Datum izdaje"}),e.jsx("input",{type:"date",name:"certificate_date",value:g.certificate_date,onChange:_,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Datum poteka"}),e.jsx("input",{type:"date",name:"certificate_expiry_date",value:g.certificate_expiry_date,onChange:_,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",name:"follow_up_required",checked:g.follow_up_required,onChange:_,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{className:"ml-2 block text-sm text-gray-900",children:"Zahtevano je nadaljnje usposabljanje"})]}),g.follow_up_required&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Datum nadaljnjega usposabljanja"}),e.jsx("input",{type:"date",name:"follow_up_date",value:g.follow_up_date,onChange:_,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Opis nadaljnjega usposabljanja"}),e.jsx("input",{type:"text",name:"follow_up_description",value:g.follow_up_description,onChange:_,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Letno osveitveno usposabljanje"})]})]})]})]}),p===4&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(hi,{className:"h-6 w-6 text-blue-600 mr-2"}),e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"GDPR skladnost in dodatne informacije"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",name:"dpo_specific_training",checked:g.dpo_specific_training,onChange:_,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{className:"ml-2 block text-sm text-gray-900",children:"DPO-specifino usposabljanje (GDPR len 39)"})]}),g.dpo_specific_training&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vsebina DPO usposabljanja"}),e.jsx("textarea",{name:"dpo_training_content",value:g.dpo_training_content,onChange:_,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Specifine teme za DPO usposabljanje..."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kategorija skladnosti"}),e.jsx("input",{type:"text",name:"compliance_category",value:g.compliance_category,onChange:_,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"GDPR len 39, len 47..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pravna zahteva"}),e.jsx("input",{type:"text",name:"legal_requirement",value:g.legal_requirement,onChange:_,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"GDPR len 47 - Prenos podatkov"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pogostost usposabljanja"}),e.jsx("input",{type:"text",name:"training_frequency",value:g.training_frequency,onChange:_,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Letno, na 2 leti..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naslednje usposabljanje"}),e.jsx("input",{type:"date",name:"next_training_due",value:g.next_training_due,onChange:_,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Opombe"}),e.jsx("textarea",{name:"notes",value:g.notes,onChange:_,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Dodatne opombe ali komentarji..."})]})]})]}),e.jsxs("div",{className:"flex justify-between mt-8",children:[e.jsxs("button",{type:"button",onClick:L,disabled:p===1,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:[e.jsx(ug,{className:"h-4 w-4 mr-1"}),"Prejnja"]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Preklii"}),p<4?e.jsxs("button",{type:"button",onClick:P,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center",children:["Naslednja",e.jsx(ax,{className:"h-4 w-4 ml-1"})]}):e.jsx("button",{type:"submit",disabled:c,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:c?"Shranjujem...":a?"Posodobi":"Shrani"})]})]})]})]})}):null}function tE(){const{t:s}=et(),[t,r]=z.useState([]),[a,n]=z.useState([]),[i,o]=z.useState(!0),[c,d]=z.useState(!1),[p,m]=z.useState(""),[x,b]=z.useState("all"),[h,j]=z.useState("all"),[g,v]=z.useState("all"),[_,k]=z.useState(1),[P]=z.useState(10),[L,F]=z.useState(null),[W,R]=z.useState(!1),[B,A]=z.useState(null),[S,C]=z.useState(!1),O=async()=>{try{const{data:Y,error:H}=await Ne.from("gdpr_training_evidence").select("*").order("training_date",{ascending:!1});if(H)throw H;r(Y||[]),n(Y||[])}catch(Y){console.error("Error:",Y)}finally{o(!1)}};z.useEffect(()=>{let Y=t;p&&(Y=Y.filter(H=>{var he,ge,K;return((he=H.participant_name)==null?void 0:he.toLowerCase().includes(p.toLowerCase()))||((ge=H.participant_email)==null?void 0:ge.toLowerCase().includes(p.toLowerCase()))||((K=H.training_title)==null?void 0:K.toLowerCase().includes(p.toLowerCase()))})),x!=="all"&&(Y=Y.filter(H=>H.status===x)),h!=="all"&&(Y=Y.filter(H=>H.training_type===h)),g!=="all"&&(Y=Y.filter(H=>H.completion_status===g)),n(Y),k(1)},[t,p,x,h,g]),z.useEffect(()=>{O()},[]);const Z=async Y=>{try{const{error:H}=await Ne.from("gdpr_training_evidence").delete().eq("id",Y);if(H)throw H;await O()}catch(H){console.error("Error deleting record:",H)}},te=Y=>{A(Y),C(!0)},ce=Y=>{F(Y),R(!0)},re=()=>{d(!1),A(null),C(!1),F(null),R(!1)},X=()=>{O(),re()},U=_*P,oe=U-P,xe=a.slice(oe,U),J=Math.ceil(a.length/P),$=Y=>{switch(Y){case"completed":return e.jsx(Rt,{className:"h-4 w-4 text-green-500"});case"in_progress":return e.jsx(cs,{className:"h-4 w-4 text-yellow-500"});case"failed":return e.jsx(Ss,{className:"h-4 w-4 text-red-500"});case"planned":return e.jsx(_a,{className:"h-4 w-4 text-blue-500"});default:return e.jsx(pt,{className:"h-4 w-4 text-gray-500"})}},Q=Y=>{switch(Y){case"completed":return"bg-bg-surface-elevated text-status-success border border-border-subtle";case"in_progress":return"bg-bg-surface-elevated text-status-warning border border-border-subtle";case"failed":return"bg-bg-surface-elevated text-status-error border border-border-subtle";case"planned":return"bg-bg-surface-elevated text-accent-primary border border-border-subtle";default:return"bg-bg-surface-elevated text-text-secondary border border-border-subtle"}},q=Y=>({gdpr_basic:"GDPR Osnovno",gdpr_advanced:"GDPR Napredno",zvop2:"ZVOP-2",security_awareness:"Varnostna ozaveenost",data_breach_response:"Odziv na kritve",privacy_by_design:"Varstvo podatkov po zasnovi",other:"Drugo"})[Y]||Y,I=Y=>new Date(Y).toLocaleDateString("sl-SI");return i?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:s("gdpr.usposabljanja.title","Evidence usposabljanj")}),e.jsx("p",{className:"text-text-secondary",children:s("gdpr.usposabljanja.subtitle","GDPR in ZVOP-2 - Evidenca usposabljanj in certifikatov")})]}),e.jsx("div",{className:"bg-bg-surface rounded-lg shadow-sm border border-border-subtle p-4 mb-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(ss,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-text-muted"}),e.jsx("input",{type:"text",placeholder:s("gdpr.usposabljanja.searchPlaceholder","Ii po udeleencu, emailu ali naslovu..."),value:p,onChange:Y=>m(Y.target.value),className:"pl-10 pr-4 py-2 w-full border border-border-subtle bg-bg-surface-hover rounded-lg focus:ring-2 focus:ring-accent-primary focus:border-accent-primary"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("select",{value:x,onChange:Y=>b(Y.target.value),className:"px-3 py-2 border border-border-subtle bg-bg-surface-hover rounded-lg focus:ring-2 focus:ring-accent-primary focus:border-accent-primary",children:[e.jsx("option",{value:"all",children:s("common.all","Vsi")}),e.jsx("option",{value:"active",children:s("common.active","Aktiven")}),e.jsx("option",{value:"inactive",children:s("common.inactive","Neaktiven")}),e.jsx("option",{value:"expired",children:s("common.expired","Poteklo")})]}),e.jsxs("select",{value:h,onChange:Y=>j(Y.target.value),className:"px-3 py-2 border border-border-subtle bg-bg-surface-hover rounded-lg focus:ring-2 focus:ring-accent-primary focus:border-accent-primary",children:[e.jsx("option",{value:"all",children:s("gdpr.usposabljanja.allTrainingTypes","Vsi tipi usposabljanj")}),e.jsx("option",{value:"gdpr_basic",children:"GDPR Osnovno"}),e.jsx("option",{value:"gdpr_advanced",children:"GDPR Napredno"}),e.jsx("option",{value:"zvop2",children:"ZVOP-2"}),e.jsx("option",{value:"security_awareness",children:"Varnostna ozaveenost"}),e.jsx("option",{value:"data_breach_response",children:"Odziv na kritve"}),e.jsx("option",{value:"privacy_by_design",children:"Varstvo podatkov po zasnovi"}),e.jsx("option",{value:"other",children:"Drugo"})]}),e.jsxs("select",{value:g,onChange:Y=>v(Y.target.value),className:"px-3 py-2 border border-border-subtle bg-bg-surface-hover rounded-lg focus:ring-2 focus:ring-accent-primary focus:border-accent-primary",children:[e.jsx("option",{value:"all",children:s("gdpr.usposabljanja.allCompletionStatuses","Vsi statusi")}),e.jsx("option",{value:"planned",children:s("gdpr.usposabljanja.planned","Nartovano")}),e.jsx("option",{value:"in_progress",children:s("gdpr.usposabljanja.inProgress","V teku")}),e.jsx("option",{value:"completed",children:s("gdpr.usposabljanja.completed","Zakljueno")}),e.jsx("option",{value:"failed",children:s("gdpr.usposabljanja.failed","Neuspeno")}),e.jsx("option",{value:"cancelled",children:s("gdpr.usposabljanja.cancelled","Preklicano")})]}),e.jsxs("button",{onClick:()=>d(!0),className:"bg-accent-primary text-white px-4 py-2 rounded-lg hover:bg-accent-primary-hover transition-colors flex items-center gap-2",children:[e.jsx(Dt,{className:"h-4 w-4"}),s("gdpr.usposabljanja.addTraining","Dodaj usposabljanje")]})]})]})}),e.jsxs("div",{className:"bg-bg-surface rounded-lg shadow-sm border border-border-subtle overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-border-subtle",children:[e.jsx("thead",{className:"bg-bg-surface-hover",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:s("gdpr.usposabljanja.participant","Udeleenec")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:s("gdpr.usposabljanja.trainingTitle","Naslov usposabljanja")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:s("gdpr.usposabljanja.trainingType","Tip usposabljanja")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:s("gdpr.usposabljanja.trainingDate","Datum usposabljanja")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:s("gdpr.usposabljanja.completionStatus","Status dokonanja")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:s("gdpr.usposabljanja.certificate","Certifikat")}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-text-secondary uppercase tracking-wider",children:s("common.actions","Akcije")})]})}),e.jsx("tbody",{className:"bg-bg-surface divide-y divide-border-subtle",children:xe.map(Y=>e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(en,{className:"h-8 w-8 text-text-muted mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-text-primary",children:Y.participant_name}),Y.participant_email&&e.jsx("div",{className:"text-sm text-text-secondary",children:Y.participant_email}),Y.participant_department&&e.jsx("div",{className:"text-xs text-text-muted",children:Y.participant_department})]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-text-primary",children:Y.training_title}),Y.instructor_name&&e.jsxs("div",{className:"text-sm text-text-secondary",children:[s("gdpr.usposabljanja.instructor","Intruktor"),": ",Y.instructor_name]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[e.jsx(hi,{className:"h-3 w-3 mr-1"}),q(Y.training_type)]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-text-primary",children:[I(Y.training_date),Y.training_duration&&e.jsxs("div",{className:"text-sm text-text-secondary",children:[e.jsx(cs,{className:"h-3 w-3 inline mr-1"}),Y.training_duration," min"]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${Q(Y.completion_status)}`,children:[$(Y.completion_status),e.jsxs("span",{className:"ml-1",children:[Y.completion_status==="planned"&&s("gdpr.usposabljanja.planned","Nartovano"),Y.completion_status==="in_progress"&&s("gdpr.usposabljanja.inProgress","V teku"),Y.completion_status==="completed"&&s("gdpr.usposabljanja.completed","Zakljueno"),Y.completion_status==="failed"&&s("gdpr.usposabljanja.failed","Neuspeno"),Y.completion_status==="cancelled"&&s("gdpr.usposabljanja.cancelled","Preklicano")]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Y.certificate_issued?e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[e.jsx(pl,{className:"h-3 w-3 mr-1"}),s("gdpr.usposabljanja.issued","Izdan")]}):e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:s("gdpr.usposabljanja.notIssued","Ni izdan")})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>ce(Y),className:"text-blue-600 hover:text-blue-900",title:s("common.view","Poglej"),children:e.jsx(lr,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>te(Y),className:"text-indigo-600 hover:text-indigo-900",title:s("common.edit","Uredi"),children:e.jsx(ar,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>Z(Y.id),className:"text-red-600 hover:text-red-900",title:s("common.delete","Izbrii"),children:e.jsx(pr,{className:"h-4 w-4"})})]})})]},Y.id))})]})}),J>1&&e.jsxs("div",{className:"bg-bg-surface px-4 py-3 flex items-center justify-between border-t border-border-subtle sm:px-6",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>k(Math.max(1,_-1)),disabled:_===1,className:"relative inline-flex items-center px-4 py-2 border border-border-subtle text-sm font-medium rounded-md text-text-primary bg-bg-surface hover:bg-bg-surface-hover disabled:opacity-50",children:s("common.previous","Prejnja")}),e.jsx("button",{onClick:()=>k(Math.min(J,_+1)),disabled:_===J,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:s("common.next","Naslednja")})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-text-secondary",children:[s("common.showing","Prikazano")," ",e.jsx("span",{className:"font-medium text-text-primary",children:oe+1})," ",s("common.to","do")," ",e.jsx("span",{className:"font-medium text-text-primary",children:Math.min(U,a.length)})," ",s("common.of","od")," ",e.jsx("span",{className:"font-medium text-text-primary",children:a.length})," ",s("common.results","rezultatov")]})}),e.jsx("div",{children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[e.jsxs("button",{onClick:()=>k(Math.max(1,_-1)),disabled:_===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-border-subtle bg-bg-surface text-sm font-medium text-text-secondary hover:bg-bg-surface-hover disabled:opacity-50",children:[e.jsx("span",{className:"sr-only",children:s("common.previous","Prejnja")}),e.jsx("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})})]}),[...Array(J)].map((Y,H)=>e.jsx("button",{onClick:()=>k(H+1),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${_===H+1?"z-10 bg-accent-primary border-accent-primary text-white":"bg-bg-surface border-border-subtle text-text-secondary hover:bg-bg-surface-hover"}`,children:H+1},H+1)),e.jsxs("button",{onClick:()=>k(Math.min(J,_+1)),disabled:_===J,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-border-subtle bg-bg-surface text-sm font-medium text-text-secondary hover:bg-bg-surface-hover disabled:opacity-50",children:[e.jsx("span",{className:"sr-only",children:s("common.next","Naslednja")}),e.jsx("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})})]})]})})]})]})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-bg-surface rounded-lg shadow-sm border border-border-subtle p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(en,{className:"h-8 w-8 text-accent-primary"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-text-secondary",children:s("gdpr.usposabljanja.totalParticipants","Skupaj udeleencev")}),e.jsx("div",{className:"text-2xl font-semibold text-text-primary",children:new Set(t.map(Y=>Y.participant_name)).size})]})]})}),e.jsx("div",{className:"bg-bg-surface rounded-lg shadow-sm border border-border-subtle p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Rt,{className:"h-8 w-8 text-status-success"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-text-secondary",children:s("gdpr.usposabljanja.completedTrainings","Zakljuena usposabljanja")}),e.jsx("div",{className:"text-2xl font-semibold text-text-primary",children:t.filter(Y=>Y.completion_status==="completed").length})]})]})}),e.jsx("div",{className:"bg-bg-surface rounded-lg shadow-sm border border-border-subtle p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(pl,{className:"h-8 w-8 text-status-warning"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-text-secondary",children:s("gdpr.usposabljanja.certificatesIssued","Izdanih certifikatov")}),e.jsx("div",{className:"text-2xl font-semibold text-text-primary",children:t.filter(Y=>Y.certificate_issued).length})]})]})}),e.jsx("div",{className:"bg-bg-surface rounded-lg shadow-sm border border-border-subtle p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(pt,{className:"h-8 w-8 text-status-error"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-text-secondary",children:s("gdpr.usposabljanja.expiringCertificates","Kmalu potekli certifikati")}),e.jsx("div",{className:"text-2xl font-semibold text-text-primary",children:t.filter(Y=>{if(!Y.certificate_expiry_date)return!1;const H=new Date(Y.certificate_expiry_date),he=new Date;return he.setMonth(he.getMonth()+3),H<=he&&H>=new Date}).length})]})]})})]}),c&&e.jsx(P_,{isOpen:c,onClose:re,onSave:X}),S&&B&&e.jsx(P_,{isOpen:S,onClose:re,onSave:X,editMode:!0,editRecord:B}),W&&L&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsx("div",{className:"relative top-20 mx-auto p-5 border w-11/12 max-w-4xl shadow-lg rounded-md bg-bg-surface border-border-subtle",children:e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-text-primary",children:s("gdpr.usposabljanja.trainingDetails","Podrobnosti usposabljanja")}),e.jsx("button",{onClick:re,className:"text-text-muted hover:text-text-secondary",children:e.jsx(Ss,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary",children:s("gdpr.usposabljanja.participant","Udeleenec")}),e.jsx("p",{className:"mt-1 text-sm text-text-primary",children:L.participant_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary",children:s("gdpr.usposabljanja.trainingTitle","Naslov usposabljanja")}),e.jsx("p",{className:"mt-1 text-sm text-text-primary",children:L.training_title})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary",children:s("gdpr.usposabljanja.trainingType","Tip usposabljanja")}),e.jsx("p",{className:"mt-1 text-sm text-text-primary",children:q(L.training_type)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary",children:s("gdpr.usposabljanja.trainingDate","Datum usposabljanja")}),e.jsx("p",{className:"mt-1 text-sm text-text-primary",children:I(L.training_date)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary",children:s("gdpr.usposabljanja.completionStatus","Status dokonanja")}),e.jsxs("span",{className:`mt-1 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${Q(L.completion_status)}`,children:[$(L.completion_status),e.jsxs("span",{className:"ml-1",children:[L.completion_status==="planned"&&s("gdpr.usposabljanja.planned","Nartovano"),L.completion_status==="in_progress"&&s("gdpr.usposabljanja.inProgress","V teku"),L.completion_status==="completed"&&s("gdpr.usposabljanja.completed","Zakljueno"),L.completion_status==="failed"&&s("gdpr.usposabljanja.failed","Neuspeno"),L.completion_status==="cancelled"&&s("gdpr.usposabljanja.cancelled","Preklicano")]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary",children:s("gdpr.usposabljanja.certificateIssued","Certifikat izdan")}),e.jsx("p",{className:"mt-1 text-sm text-text-primary",children:L.certificate_issued?s("common.yes","Da"):s("common.no","Ne")})]}),L.certificate_number&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary",children:s("gdpr.usposabljanja.certificateNumber","tevilka certifikata")}),e.jsx("p",{className:"mt-1 text-sm text-text-primary",children:L.certificate_number})]}),L.training_duration&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary",children:s("gdpr.usposabljanja.duration","Trajanje")}),e.jsxs("p",{className:"mt-1 text-sm text-text-primary",children:[L.training_duration," ",s("gdpr.usposabljanja.minutes","minut")]})]}),L.assessment_score&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary",children:s("gdpr.usposabljanja.assessmentScore","Ocena ocenjevanja")}),e.jsxs("p",{className:"mt-1 text-sm text-text-primary",children:[L.assessment_score,"%"]})]}),L.notes&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary",children:s("common.notes","Opombe")}),e.jsx("p",{className:"mt-1 text-sm text-text-primary",children:L.notes})]})]})]})]})})})]})}function rE(){const{t:s}=et(),{user:t}=cr(),{organizationId:r}=Sn(),[a,n]=z.useState([]),[i,o]=z.useState(!0),[c,d]=z.useState(!1),[p,m]=z.useState(!1),[x,b]=z.useState(!1),[h,j]=z.useState(!1),[g,v]=z.useState(null),[_,k]=z.useState(null);z.useEffect(()=>{(async()=>{if(t)try{const{data:C,error:O}=await Ne.from("profiles").select("*, organization_id").eq("id",t.id).single();if(O)throw O;k(C)}catch(C){console.error("Error fetching user profile:",C)}})()},[t]);const P=async()=>{if(!r){o(!1);return}try{o(!0);const{data:S,error:C}=await Ne.from("isms_scope").select("*").eq("organization_id",r).order("created_at",{ascending:!1});if(C)throw C;n(S||[])}catch(S){console.error("Error:",S)}finally{o(!1)}},L=()=>{P(),d(!1),m(!1),b(!1),j(!1),v(null)},F=S=>{v(S),m(!0)},W=S=>{v(S),b(!0)},R=S=>{v(S),j(!0)};if(z.useEffect(()=>{r&&P()},[r]),i)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:s("common.loading")})]})});if(!r)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(er,{className:"w-12 h-12 text-text-secondary mx-auto mb-3"}),e.jsx("h3",{className:"text-heading-md font-semibold text-text-primary mb-2",children:s("common.organizationRequired")}),e.jsx("p",{className:"text-body text-text-secondary",children:s("common.organizationRequiredDescription")})]})});const B=S=>{switch(S){case"active":return"bg-status-success/20 text-status-success shadow-[0_0_10px_rgba(34,197,94,0.3)]";case"approved":return"bg-blue-500/20 text-blue-400";case"under_review":return"bg-status-warning/20 text-status-warning";default:return"bg-gray-500/20 text-gray-400"}},A=S=>{switch(S){case"active":return"Aktiven";case"approved":return"Odobren";case"under_review":return"V pregledu";case"draft":return"Osnutek";default:return S}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-teal-500/10 flex items-center justify-center",children:e.jsx(Rp,{className:"w-5 h-5 text-teal-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Obseg ISMS"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Doloitev mej in podroja uporabe sistema upravljanja informacijske varnosti"})]})]}),e.jsxs("button",{onClick:()=>d(!0),className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Dt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:"Dodaj obseg"})]})]}),e.jsx("div",{className:"bg-bg-surface rounded-sm border border-border-subtle overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-pure-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Naziv obsega"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Opis"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Organizacijske enote"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Status"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Odgovorna oseba"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Datum veljavnosti"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Dejanja"})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:a.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-8 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx(er,{className:"w-8 h-8 text-text-secondary"}),e.jsx("p",{className:"text-body text-text-secondary",children:"Nobeni zapis ni najden"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:r?`Za organizacijo ${r} ni najdenih zapisov v tabeli isms_scope`:"Organizacijski kontekst ni na voljo"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Poizkusite dodati nov obseg ISMS"}),e.jsxs("details",{className:"mt-2",children:[e.jsx("summary",{className:"text-body-sm text-text-secondary cursor-pointer hover:text-text-primary",children:"Tehnine informacije"}),e.jsxs("div",{className:"mt-2 text-caption text-text-secondary bg-bg-pure-black p-3 rounded border",children:[e.jsxs("p",{children:["Organization ID: ",r||"Ni na voljo"]}),e.jsxs("p",{children:["Records count: ",a.length]})]})]})]})})}):a.map(S=>e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 text-body text-text-primary font-medium",children:S.scope_name}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary max-w-xs truncate",children:S.scope_description}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary max-w-xs truncate",children:S.organizational_units}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium ${B(S.status)}`,children:A(S.status)})}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:S.responsible_person}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:S.effective_date?new Date(S.effective_date).toLocaleDateString("sl-SI"):"-"}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>R(S),className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",title:s("common.view"),children:e.jsx(lr,{className:"w-4 h-4 text-text-secondary"})}),e.jsx("button",{onClick:()=>F(S),className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",title:s("common.edit"),children:e.jsx(ar,{className:"w-4 h-4 text-text-secondary"})}),e.jsx("button",{onClick:()=>W(S),className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",title:s("common.delete"),children:e.jsx(pr,{className:"w-4 h-4 text-status-error"})})]})})]},S.id))})]})}),e.jsx(yD,{isOpen:c,onClose:()=>d(!1),onSave:L}),e.jsx(Qa,{isOpen:p,onClose:()=>{m(!1),v(null)},onSave:L,mode:"edit",record:g,title:"Uredi obseg ISMS",table:"isms_scope",fields:[{key:"scope_name",label:"Naziv obsega",type:"text",required:!0},{key:"scope_description",label:"Opis obsega",type:"textarea",required:!0},{key:"scope_boundaries",label:"Mejne opredelitve",type:"textarea",required:!0},{key:"organizational_units",label:"Organizacijske enote",type:"textarea",required:!0},{key:"business_processes",label:"Poslovni procesi",type:"textarea"},{key:"information_types",label:"Tipi informacij",type:"textarea"},{key:"systems_applications",label:"Sistemi in aplikacije",type:"textarea"},{key:"third_party_interfaces",label:"Vmesniki do tretjih oseb",type:"textarea"},{key:"regulatory_requirements",label:"Regulatorne zahteve",type:"textarea"},{key:"exclusions",label:"Izkljuitve",type:"textarea"},{key:"exclusion_justification",label:"Utemeljitev izkljuitve",type:"textarea"},{key:"connection_risk_assessment",label:"Povezana ocena tveganj",type:"select",required:!1,dataSource:{table:"iso_risk_assessment",idField:"id",labelField:"risk_name"}},{key:"connection_soa",label:"Povezana izjava o uporabnosti",type:"select",required:!1,dataSource:{table:"iso_statement_applicability",idField:"id",labelField:"control_name"}},{key:"status",label:"Status",type:"select",required:!0,options:["draft","under_review","approved","active"]},{key:"status",label:"Status",type:"select",required:!0,options:["draft","under_review","approved","active"]},{key:"responsible_person",label:"Odgovorna oseba",type:"text",required:!0},{key:"effective_date",label:"Datum veljavnosti",type:"date",required:!0},{key:"review_date",label:"Datum pregleda",type:"date",required:!0},{key:"connection_risk_assessment",label:"Povezava z RA",type:"text"},{key:"connection_soa",label:"Povezava s SoA",type:"text"},{key:"connection_policies",label:"Povezava s politikami",type:"text"}],defaultValues:{organization_id:r}}),e.jsx(Qa,{isOpen:x,onClose:()=>{b(!1),v(null)},onSave:L,mode:"delete",record:g,title:"Izbrii obseg ISMS",table:"isms_scope",fields:[],defaultValues:{}}),e.jsx(Qa,{isOpen:h,onClose:()=>{j(!1),v(null)},onSave:L,mode:"view",record:g,title:"Podrobnosti obsega ISMS",table:"isms_scope",fields:[{key:"scope_name",label:"Naziv obsega",type:"text"},{key:"scope_description",label:"Opis obsega",type:"textarea"},{key:"scope_boundaries",label:"Mejne opredelitve",type:"textarea"},{key:"organizational_units",label:"Organizacijske enote",type:"textarea"},{key:"business_processes",label:"Poslovni procesi",type:"textarea"},{key:"information_types",label:"Tipi informacij",type:"textarea"},{key:"systems_applications",label:"Sistemi in aplikacije",type:"textarea"},{key:"third_party_interfaces",label:"Vmesniki do tretjih oseb",type:"textarea"},{key:"regulatory_requirements",label:"Regulatorne zahteve",type:"textarea"},{key:"exclusions",label:"Izkljuitve",type:"textarea"},{key:"exclusion_justification",label:"Utemeljitev izkljuitve",type:"textarea"},{key:"status",label:"Status",type:"select",options:["draft","under_review","approved","active"]},{key:"responsible_person",label:"Odgovorna oseba",type:"text"},{key:"effective_date",label:"Datum veljavnosti",type:"date"},{key:"review_date",label:"Datum pregleda",type:"date"},{key:"connection_risk_assessment",label:"Povezava z RA",type:"text"},{key:"connection_soa",label:"Povezava s SoA",type:"text"},{key:"connection_policies",label:"Povezava s politikami",type:"text"}],defaultValues:{organization_id:r}})]})}function sE(){const{t:s}=et(),{user:t}=cr(),{organizationId:r}=Sn(),[a,n]=z.useState([]),[i,o]=z.useState(!0),[c,d]=z.useState(!1),[p,m]=z.useState(!1),[x,b]=z.useState(!1),[h,j]=z.useState(!1),[g,v]=z.useState(null),[_,k]=z.useState(null);z.useEffect(()=>{(async()=>{if(t)try{const{data:O,error:Z}=await Ne.from("profiles").select("*, organization_id").eq("id",t.id).single();if(Z)throw Z;k(O)}catch(O){console.error("Error fetching user profile:",O)}})()},[t]);const P=async()=>{if(!r){o(!1);return}try{o(!0);const{data:C,error:O}=await Ne.from("information_security_policy").select("*").eq("organization_id",r).order("created_at",{ascending:!1});if(O)throw O;n(C||[])}catch(C){console.error("Error:",C)}finally{o(!1)}},L=()=>{P(),d(!1),m(!1),b(!1),j(!1),v(null)},F=C=>{v(C),m(!0)},W=C=>{v(C),b(!0)},R=C=>{v(C),j(!0)};z.useEffect(()=>{r&&P()},[r]);const B=[{id:"demo-1",policy_name:"Politika kibernetske varnosti",policy_type:"information_security_general",scope_of_application:"Vsi zaposleni, pogodbeniki in zunanji sodelavci organizacije",policy_description:"Celovita politika za zaito informacijskih sistemov pred kibernetskimi gronjami",policy_objectives:"Zagotavljanje celovite zaite pred kibernetskimi napadi, vzpostavitev varnostnih kontrol in incidentov odziva",roles_and_responsibilities:"IT varnostni manager, sistemski administratorji, vsi zaposleni",status:"active",version:"1.0",effective_date:"2024-01-15",approval_authority:"Janez Novak, direktor IT"},{id:"demo-2",policy_name:"Politika dostopa do sistemov",policy_type:"access_control",scope_of_application:"Vsi informacijski sistemi, aplikacije in podatkovne baze organizacije",policy_description:"Ureja upravljanje dostopov do sistemov z naelom najmanjih pravic",policy_objectives:"Prepreevanje neavtoriziranega dostopa, zagotavljanje sledljivosti dostopov",roles_and_responsibilities:"IT administratorji, varnostni officer, uporabniki sistemov",status:"approved",version:"2.1",effective_date:"2024-03-01",approval_authority:"Ana Kova, varnostna direktorica"},{id:"demo-3",policy_name:"Politika varnosti podatkov",policy_type:"data_protection",scope_of_application:"Vsi osebni podatki, poslovni podatki in zaupne informacije organizacije",policy_description:"Zagotavljanje varstva podatkov skladno z GDPR in notranjimi zahtevami",policy_objectives:"Zaita zaupnosti, celovitosti in razpololjivosti podatkov",roles_and_responsibilities:"DPO, IT varnostni tim, vodje oddelkov",status:"active",version:"1.3",effective_date:"2024-02-10",approval_authority:"Marko Peternel, DPO"},{id:"demo-4",policy_name:"Politika uporabe interneta",policy_type:"compliance",scope_of_application:"Vsi zaposleni pri uporabi interneta in spletnih storitev v slubene namene",policy_description:"Ureja primerno uporabo interneta in spletnih storitev med delovnim asom",policy_objectives:"Zagotavljanje produktivne in varne uporabe interneta, prepreevanje zlorab",roles_and_responsibilities:"IT oddelek, HR, vsi zaposleni",status:"under_review",version:"1.2",effective_date:"2024-04-01",approval_authority:"Maja Horvat, HR direktorica"},{id:"demo-5",policy_name:"Politika varnosti mobilnih naprav",policy_type:"information_security_general",scope_of_application:"Vsi mobilni telefoni, tablice, prenosniki in druge prenosne naprave",policy_description:"Zagotavljanje varnosti mobilnih naprav, ki dostopajo do poslovnih podatkov",policy_objectives:"Prepreevanje izgube podatkov preko mobilnih naprav, zagotavljanje ifriranja",roles_and_responsibilities:"IT podpora, zaposleni z mobilnimi napravami, varnostni tim",status:"draft",version:"0.9",effective_date:"2024-05-01",approval_authority:"Toma Leskovar, mobilni IT manager"}];if(i)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:s("common.loading")})]})});if(!r)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(er,{className:"w-12 h-12 text-text-secondary mx-auto mb-3"}),e.jsx("h3",{className:"text-heading-md font-semibold text-text-primary mb-2",children:s("common.organizationRequired")}),e.jsx("p",{className:"text-body text-text-secondary",children:s("common.organizationRequiredDescription")})]})});const A=C=>{switch(C){case"active":return"bg-status-success/20 text-status-success shadow-[0_0_10px_rgba(34,197,94,0.3)]";case"approved":return"bg-blue-500/20 text-blue-400";case"under_review":return"bg-status-warning/20 text-status-warning";default:return"bg-gray-500/20 text-gray-400"}},S=C=>{switch(C){case"active":return"Aktiven";case"approved":return"Odobren";case"under_review":return"V pregledu";case"draft":return"Osnutek";case"retired":return"Povleen";default:return C}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-500/10 flex items-center justify-center",children:e.jsx(Mt,{className:"w-5 h-5 text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"IT-varnostne politike"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Upravljanje IT-varnostnih politik znotraj organizacije"})]})]}),e.jsxs("button",{onClick:()=>d(!0),className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Dt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:"Dodaj politiko"})]})]}),e.jsx("div",{className:"bg-bg-surface rounded-sm border border-border-subtle overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-pure-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Naziv politike"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Tip politike"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Podroje uporabe"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Status"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Verzija"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Datum veljavnosti"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Dejanja"})]})}),e.jsxs("tbody",{className:"divide-y divide-border-subtle",children:[(a.length===0?B:a).map((C,O)=>e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 text-body text-text-primary font-medium",children:C.policy_name}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:C.policy_type==="information_security_general"?"Splona informacijska varnost":C.policy_type==="access_control"?"Kontrola dostopa":C.policy_type==="data_protection"?"Varstvo podatkov":C.policy_type==="incident_response"?"Odziv na incidente":C.policy_type==="business_continuity"?"Poslovna kontinuiteta":C.policy_type==="supplier_security"?"Varnost dobaviteljev":C.policy_type==="physical_security"?"Fizina varnost":C.policy_type==="human_resources"?"loveki viri":C.policy_type==="risk_management"?"Upravljanje tveganj":C.policy_type==="compliance"?"Skladnost":C.policy_type}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary max-w-xs truncate",children:C.scope_of_application}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium ${A(C.status)}`,children:S(C.status)})}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:C.version}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:C.effective_date?new Date(C.effective_date).toLocaleDateString("sl-SI"):"-"}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>R(C),className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",title:s("common.view"),children:e.jsx(lr,{className:"w-4 h-4 text-text-secondary"})}),a.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>F(C),className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",title:s("common.edit"),children:e.jsx(ar,{className:"w-4 h-4 text-text-secondary"})}),e.jsx("button",{onClick:()=>W(C),className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",title:s("common.delete"),children:e.jsx(pr,{className:"w-4 h-4 text-status-error"})})]})]})})]},C.id||O)),a.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-4 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(er,{className:"w-6 h-6 text-status-warning"}),e.jsx("p",{className:"text-body-sm text-text-secondary font-medium",children:"Prikazani so testni (demo) podatki"}),e.jsx("p",{className:"text-caption text-text-secondary",children:'V bazi ni najdenih zapisov. Kliknite "Dodaj politiko" za vnos resninih IT-varnostnih politik.'})]})})})]})]})}),e.jsx(jD,{isOpen:c,onClose:()=>d(!1),onSave:L}),e.jsx(Qa,{isOpen:p,onClose:()=>{m(!1),v(null)},onSave:L,mode:"edit",record:g,title:"Uredi politiko informacijske varnosti",table:"information_security_policy",fields:[{key:"policy_name",label:"Naziv politike",type:"text",required:!0},{key:"policy_type",label:"Tip politike",type:"select",required:!0,options:["information_security_general","access_control","data_protection","incident_response","business_continuity","supplier_security","physical_security","human_resources","risk_management","compliance"]},{key:"policy_description",label:"Opis politike",type:"textarea",required:!0},{key:"scope_of_application",label:"Podroje uporabe",type:"textarea",required:!0},{key:"policy_objectives",label:"Cilji politike",type:"textarea",required:!0},{key:"policy_requirements",label:"Zahteve politike",type:"textarea",required:!0},{key:"roles_and_responsibilities",label:"Vloge in odgovornosti",type:"textarea",required:!0},{key:"compliance_requirements",label:"Zahteve skladnosti",type:"textarea"},{key:"implementation_guidelines",label:"Navodila za izvajanje",type:"textarea"},{key:"monitoring_requirements",label:"Zahteve spremljanja",type:"textarea"},{key:"review_procedures",label:"Postopki pregleda",type:"textarea"},{key:"version",label:"Verzija",type:"text",required:!0},{key:"status",label:"Status",type:"select",required:!0,options:["draft","under_review","approved","active","retired"]},{key:"effective_date",label:"Datum veljavnosti",type:"date",required:!0},{key:"review_date",label:"Datum pregleda",type:"date",required:!0},{key:"approval_authority",label:"Avtor odobritve",type:"text",required:!0},{key:"connection_policies",label:"Povezane politike",type:"text"},{key:"connection_procedures",label:"Povezani postopki",type:"text"},{key:"connection_risk_assessment",label:"Povezana ocena tveganj",type:"text"},{key:"connection_soa",label:"Povezana izjava o uporabnosti",type:"text"}],defaultValues:{organization_id:r}}),e.jsx(Qa,{isOpen:x,onClose:()=>{b(!1),v(null)},onSave:L,mode:"delete",record:g,title:"Izbrii politiko informacijske varnosti",table:"information_security_policy",fields:[],defaultValues:{}}),e.jsx(Qa,{isOpen:h,onClose:()=>{j(!1),v(null)},onSave:L,mode:"view",record:g,title:"Podrobnosti politike informacijske varnosti",table:"information_security_policy",fields:[{key:"policy_name",label:"Naziv politike",type:"text"},{key:"policy_type",label:"Tip politike",type:"select",options:["information_security_general","access_control","data_protection","incident_response","business_continuity","supplier_security","physical_security","human_resources","risk_management","compliance"]},{key:"policy_description",label:"Opis politike",type:"textarea"},{key:"scope_of_application",label:"Podroje uporabe",type:"textarea"},{key:"policy_objectives",label:"Cilji politike",type:"textarea"},{key:"policy_requirements",label:"Zahteve politike",type:"textarea"},{key:"roles_and_responsibilities",label:"Vloge in odgovornosti",type:"textarea"},{key:"compliance_requirements",label:"Zahteve skladnosti",type:"textarea"},{key:"implementation_guidelines",label:"Navodila za izvajanje",type:"textarea"},{key:"monitoring_requirements",label:"Zahteve spremljanja",type:"textarea"},{key:"review_procedures",label:"Postopki pregleda",type:"textarea"},{key:"version",label:"Verzija",type:"text"},{key:"status",label:"Status",type:"select",options:["draft","under_review","approved","active","retired"]},{key:"effective_date",label:"Datum veljavnosti",type:"date"},{key:"review_date",label:"Datum pregleda",type:"date"},{key:"approval_authority",label:"Avtor odobritve",type:"text"},{key:"connection_policies",label:"Povezane politike",type:"text"},{key:"connection_procedures",label:"Povezani postopki",type:"text"},{key:"connection_risk_assessment",label:"Povezana ocena tveganj",type:"text"},{key:"connection_soa",label:"Povezana izjava o uporabnosti",type:"text"}],defaultValues:{organization_id:r}})]})}function aE(){const{t:s}=et(),{user:t}=cr(),[r,a]=z.useState([]),[n,i]=z.useState(!0),[o,c]=z.useState(!1),[d,p]=z.useState(null),[m,x]=z.useState(!1);z.useEffect(()=>{(async()=>{if(t)try{const{data:v,error:_}=await Ne.from("profiles").select("*, organization_id").eq("id",t.id).single();if(_)throw _;p(v)}catch(v){console.error("Error fetching user profile:",v)}})()},[t]);const b=()=>[{id:"demo-1",audit_id:"ISO-2024-001",audit_type:"internal",audit_date:"2024-11-05T09:00:00.000Z",auditor_name:"admin@podjetje.si",scope:"Pregled upravljanja dostopov do sistemov in podatkov",findings:"Ugotovljene nepravilnosti pri upravljanju uporabnikih pravic. Nekateri uporabniki imajo preve privilegijev.",recommendations:"Izvesti periodien pregled uporabnikih raunov in implementirati princip najmanjih privilegijev.",severity:"medium",status:"in_progress",remediation_plan:"Izvesti revizijo vseh uporabnikih raunov do 20.11.2024 in odstraniti nepotrebne privilegije.",due_date:"2024-11-20T00:00:00.000Z",organization_id:d==null?void 0:d.organization_id},{id:"demo-2",audit_id:"ISO-2024-002",audit_type:"security",audit_date:"2024-11-02T14:30:00.000Z",auditor_name:"uporabnik1@podjetje.si",scope:"Pregled varnostnih incidentov in odzivnih postopkov",findings:"Zabeleeni varnostni incidenti so ustrezno dokumentirani. Potrebne izboljave pri asu odziva.",recommendations:"Optimizirati postopke odziva na varnostne incidente in izvesti dodatno usposabljanje.",severity:"low",status:"closed",remediation_plan:"Usposabljanje ekipe za incident response nartovano za december 2024.",due_date:"2024-12-15T00:00:00.000Z",organization_id:d==null?void 0:d.organization_id},{id:"demo-3",audit_id:"ISO-2024-003",audit_type:"compliance",audit_date:"2024-10-28T10:15:00.000Z",auditor_name:"varnost@podjetje.si",scope:"Skladnost z ISO 27001 standardom - upravljanje sredstev",findings:"Inventar sredstev ni popolnoma posodobljen. Manjkajo nekateri informacijski sistemi.",recommendations:"Aurirati inventar sredstev in dodeliti odgovorne osebe za posamezna sredstva.",severity:"high",status:"open",remediation_plan:"Popolna revizija inventarja sredstev v sodelovanju z IT oddelkom.",due_date:"2024-11-30T00:00:00.000Z",organization_id:d==null?void 0:d.organization_id},{id:"demo-4",audit_id:"ISO-2024-004",audit_type:"quality",audit_date:"2024-10-25T16:45:00.000Z",auditor_name:"kakovost@podjetje.si",scope:"Pregled postopkov upravljanja z dokumentacijo",findings:"Dokumentacija je ustrezno verzionirana in dostopna. Potrebne manje izboljave.",recommendations:"Standardizirati format dokumentov in uvesti avtomatsko preverjanje verzij.",severity:"low",status:"resolved",remediation_plan:"Implementacija novih standardov dokumentacije.",due_date:"2024-11-10T00:00:00.000Z",organization_id:d==null?void 0:d.organization_id},{id:"demo-5",audit_id:"ISO-2024-005",audit_type:"business_continuity",audit_date:"2024-10-20T11:20:00.000Z",auditor_name:"admin@podjetje.si",scope:"Pregled nartov kontinuitete poslovanja",findings:"Narti kontinuitete potrebujejo posodobitev glede novih sistemov in procesov.",recommendations:"Aurirati narte kontinuitete in izvesti testiranje postopkov.",severity:"critical",status:"in_progress",remediation_plan:"Popolna posodobitev BCP dokumentacije in testiranje do konca leta.",due_date:"2024-12-31T00:00:00.000Z",organization_id:d==null?void 0:d.organization_id}],h=async()=>{if(!(d!=null&&d.organization_id)){i(!1);return}try{i(!0);const{data:g,error:v}=await Ne.from("iso_audit_log").select("*").eq("organization_id",d.organization_id).order("audit_date",{ascending:!1});if(v)throw v;const _=g||[];_.length===0?(a(b()),x(!0)):(a(_),x(!1))}catch(g){console.error("Error:",g),a(b()),x(!0)}finally{i(!1)}},j=()=>{h(),c(!1),x(!1)};return z.useEffect(()=>{d!=null&&d.organization_id&&h()},[d]),n?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:s("common.loading")})]})}):d!=null&&d.organization_id?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-accent-primary/10 flex items-center justify-center",children:e.jsx(jp,{className:"w-5 h-5 text-accent-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:s("iso.audit.title")}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:s("iso.audit.subtitle")})]})]}),e.jsxs("button",{onClick:()=>c(!0),className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Dt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:s("iso.audit.addAudit")})]})]}),m&&e.jsx("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-5 h-5 rounded-full bg-blue-500/20 flex items-center justify-center",children:e.jsx(jp,{className:"w-3 h-3 text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-body-sm font-medium text-blue-400",children:"Prikazani so demo podatki"}),e.jsx("p",{className:"text-body-xs text-blue-300 mt-1",children:"Trenutno ni na voljo povezava z bazo podatkov. Prikazani so testni zapisi za demonstracijo funkcionalnosti."})]})]})}),e.jsx("div",{className:"bg-bg-surface rounded-sm border border-border-subtle overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-pure-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.audit.auditId")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.audit.auditType")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.audit.auditDate")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.audit.auditorName")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("dashboard.severity")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("common.status")})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:r.map(g=>e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 text-body text-text-primary font-mono",children:g.audit_id}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:s(`iso.audit.auditTypeOptions.${g.audit_type}`)}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:new Date(g.audit_date).toLocaleDateString("sl-SI")}),e.jsx("td",{className:"px-6 py-4 text-body text-text-primary",children:g.auditor_name}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium ${g.severity==="critical"?"bg-red-500/20 text-red-400":g.severity==="high"?"bg-risk-high/20 text-risk-high":g.severity==="medium"?"bg-risk-medium/20 text-risk-medium":"bg-risk-low/20 text-risk-low"}`,children:s(`iso.audit.severityOptions.${g.severity}`)})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium ${g.status==="closed"?"bg-status-success/10 text-status-success":g.status==="resolved"?"bg-accent-primary/10 text-accent-primary":g.status==="in_progress"?"bg-blue-500/10 text-blue-400":"bg-status-warning/10 text-status-warning"}`,children:s(`iso.audit.statusOptions.${g.status}`)})})]},g.id))})]})}),e.jsx(AD,{isOpen:o,onClose:()=>c(!1),onSave:j})]}):e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(jp,{className:"w-12 h-12 text-text-secondary mx-auto mb-3"}),e.jsx("h3",{className:"text-heading-md font-semibold text-text-primary mb-2",children:s("common.organizationRequired")}),e.jsx("p",{className:"text-body text-text-secondary",children:s("common.organizationRequiredDescription")})]})})}function nE(){const{t:s}=et(),{user:t}=cr(),{organizationId:r}=Sn(),[a,n]=z.useState([]),[i,o]=z.useState(!0),[c,d]=z.useState(!1),[p,m]=z.useState(!1),[x,b]=z.useState(!1),[h,j]=z.useState(!1),[g,v]=z.useState(null),[_,k]=z.useState(null);z.useEffect(()=>{(async()=>{if(t)try{const{data:O,error:Z}=await Ne.from("profiles").select("*, organization_id").eq("id",t.id).single();if(Z)throw Z;k(O)}catch(O){console.error("Error fetching user profile:",O)}})()},[t]);const P=async()=>{if(!r){o(!1);return}try{o(!0);const{data:C,error:O}=await Ne.from("iso_risk_assessment").select("*").eq("organization_id",r).order("created_at",{ascending:!1});if(O)throw O;n(C||[])}catch(C){console.error("Error:",C)}finally{o(!1)}},L=[{id:"demo-1",risk_id:"R-001",asset_name:"Streniki in sistemska infrastruktura",threat_description:"Kibernetski napad na strenike",vulnerability_description:"Nezadostna konfiguracija varnostnih nastavitev",likelihood:"high",impact:"critical",risk_level:"critical",mitigation_strategy:"Implementacija naprednih zaitnih sistemov in redno posodabljanje",residual_risk:"medium",owner:"Sistemski administrator",review_date:"2024-03-15",organization_id:r,created_at:new Date().toISOString(),status:"identified"},{id:"demo-2",risk_id:"R-002",asset_name:"Baze podatkov s strankami",threat_description:"Izguba osebnih podatkov",vulnerability_description:"Pomanjkanje rednih varnostnih kopij",likelihood:"medium",impact:"high",risk_level:"high",mitigation_strategy:"Dnevno varnostno kopiranje in testiranje obnovitve",residual_risk:"low",owner:"Administrator baz podatkov",review_date:"2024-03-20",organization_id:r,created_at:new Date().toISOString(),status:"in_progress"},{id:"demo-3",risk_id:"R-003",asset_name:"Sistemski dostopi in pooblastila",threat_description:"Prekoraitev pooblastil",vulnerability_description:"Nedostatek nadzora dostopa",likelihood:"low",impact:"high",risk_level:"medium",mitigation_strategy:"Implementacija principa najmanjih pooblastil in redna revizija",residual_risk:"low",owner:"Varnostni manager",review_date:"2024-03-25",organization_id:r,created_at:new Date().toISOString(),status:"resolved"},{id:"demo-4",risk_id:"R-004",asset_name:"Omrena infrastruktura",threat_description:"Okvara kritine infrastrukture",vulnerability_description:"Staranje strojne opreme",likelihood:"medium",impact:"critical",risk_level:"high",mitigation_strategy:"Preventivno vzdrevanje in redundantni sistemi",residual_risk:"medium",owner:"IT manager",review_date:"2024-03-30",organization_id:r,created_at:new Date().toISOString(),status:"in_progress"},{id:"demo-5",risk_id:"R-005",asset_name:"loveki viri in usposabljanje",threat_description:"Neusposobljeni zaposleni",vulnerability_description:"Pomanjkanje rednega usposabljanja",likelihood:"high",impact:"medium",risk_level:"high",mitigation_strategy:"Redno usposabljanje in izobraevalni programi",residual_risk:"low",owner:"loveki viri",review_date:"2024-04-05",organization_id:r,created_at:new Date().toISOString(),status:"identified"}],F=async()=>{try{for(const C of L){const{error:O}=await Ne.from("iso_risk_assessment").insert([C]);O&&!O.message.includes("duplicate")&&console.error("Error inserting demo record:",O)}await P()}catch(C){console.error("Error adding demo data:",C)}},W=()=>{P(),d(!1),m(!1),b(!1),j(!1),v(null)},R=C=>{v(C),m(!0)},B=C=>{v(C),b(!0)},A=C=>{v(C),j(!0)};if(z.useEffect(()=>{r&&P()},[r]),i)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:s("common.loading")})]})});if(!r)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(er,{className:"w-12 h-12 text-text-secondary mx-auto mb-3"}),e.jsx("h3",{className:"text-heading-md font-semibold text-text-primary mb-2",children:s("common.organizationRequired")}),e.jsx("p",{className:"text-body text-text-secondary",children:s("common.organizationRequiredDescription")})]})});const S=C=>{switch(C.toLowerCase()){case"critical":case"high":return"text-red-500 bg-red-500/10";case"medium":return"text-yellow-500 bg-yellow-500/10";default:return"text-green-500 bg-green-500/10"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-risk-high/10 flex items-center justify-center",children:e.jsx(er,{className:"w-5 h-5 text-risk-high"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:s("iso.risk.title")}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:s("iso.risk.subtitle")})]})]}),e.jsxs("button",{onClick:()=>d(!0),className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Dt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:s("iso.risk.addRisk")})]})]}),e.jsx("div",{className:"bg-bg-surface rounded-sm border border-border-subtle overflow-hidden",children:a.length===0?e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-4 p-3 bg-blue-500/10 border border-blue-500/20 rounded-sm",children:e.jsx("p",{className:"text-body-sm text-blue-400",children:s("iso.risk.noRisks")})}),e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-pure-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.risk.riskId")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.risk.assetName")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.risk.threatDescription")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.risk.likelihood")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.risk.impact")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.risk.riskLevel")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.risk.status")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.risk.owner")})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:L.map(C=>e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150 opacity-75",children:[e.jsx("td",{className:"px-6 py-4 text-body text-text-primary font-mono",children:C.risk_id}),e.jsx("td",{className:"px-6 py-4 text-body text-text-primary font-medium",children:C.asset_name}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary max-w-xs truncate",children:C.threat_description}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium ${S(C.likelihood)}`,children:C.likelihood==="very_low"?"Zelo nizka":C.likelihood==="low"?"Nizka":C.likelihood==="medium"?"Srednja":C.likelihood==="high"?"Visoka":C.likelihood==="very_high"?"Zelo visoka":C.likelihood})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium ${S(C.impact)}`,children:C.impact==="very_low"?"Zelo nizka":C.impact==="low"?"Nizka":C.impact==="medium"?"Srednja":C.impact==="high"?"Visoka":C.impact==="very_high"?"Zelo visoka":C.impact})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium ${S(C.risk_level)}`,children:C.risk_level==="critical"?"Kritino":C.risk_level==="high"?"Visoko":C.risk_level==="medium"?"Srednje":C.risk_level==="low"?"Nizko":C.risk_level})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"px-2 py-1 rounded-full text-caption font-medium bg-blue-500/10 text-blue-500",children:C.status==="identified"?"Identificirano":C.status==="in_progress"?"V obravnavi":C.status==="resolved"?"Reeno":C.status})}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:C.owner})]},C.id))})]}),e.jsx("div",{className:"p-4 border-t border-border-subtle text-center",children:e.jsxs("button",{onClick:F,className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 flex items-center gap-2 mx-auto",children:[e.jsx(Dt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:"Dodaj demo podatke v bazo"})]})})]}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-pure-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.risk.riskId")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.risk.assetName")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.risk.threatDescription")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.risk.likelihood")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.risk.impact")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.risk.riskLevel")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.risk.status")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.risk.owner")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("common.actions")})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:a.map(C=>e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 text-body text-text-primary font-mono",children:C.risk_id}),e.jsx("td",{className:"px-6 py-4 text-body text-text-primary font-medium",children:C.asset_name}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary max-w-xs truncate",children:C.threat_description}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium ${S(C.likelihood)}`,children:s(`iso.risk.riskLevelOptions.${C.likelihood.toLowerCase()}`)})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium ${S(C.impact)}`,children:s(`iso.risk.riskLevelOptions.${C.impact.toLowerCase()}`)})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium ${S(C.risk_level)}`,children:s(`iso.risk.riskLevelOptions.${C.risk_level.toLowerCase()}`)})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"px-2 py-1 rounded-full text-caption font-medium bg-blue-500/10 text-blue-500",children:C.status==="identified"?"Identificirano":C.status==="in_progress"?"V obravnavi":C.status==="resolved"?"Reeno":C.status})}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:C.owner}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>A(C),className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",title:s("common.view"),children:e.jsx(lr,{className:"w-4 h-4 text-text-secondary"})}),e.jsx("button",{onClick:()=>R(C),className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",title:s("common.edit"),children:e.jsx(ar,{className:"w-4 h-4 text-text-secondary"})}),e.jsx("button",{onClick:()=>B(C),className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",title:s("common.delete"),children:e.jsx(pr,{className:"w-4 h-4 text-status-error"})})]})})]},C.id))})]})}),e.jsx(wD,{isOpen:c,onClose:()=>d(!1),onSave:W}),e.jsx(Qa,{isOpen:p,onClose:()=>{m(!1),v(null)},onSave:W,mode:"edit",record:g,title:"Uredi oceno tveganja",table:"iso_risk_assessment",fields:[{key:"risk_id",label:"ID tveganja",type:"text",required:!0},{key:"asset_name",label:"Naziv sredstva",type:"text",required:!0},{key:"threat_description",label:"Opis gronje",type:"textarea",required:!0},{key:"vulnerability_description",label:"Opis ranljivosti",type:"textarea"},{key:"likelihood",label:"Verjetnost",type:"select",required:!0,options:["very_low","low","medium","high","very_high"]},{key:"impact",label:"Vpliv",type:"select",required:!0,options:["very_low","low","medium","high","very_high"]},{key:"risk_level",label:"Nivo tveganja",type:"select",required:!0,options:["low","medium","high","critical"]},{key:"mitigation_strategy",label:"Strategija za zmanjanje",type:"textarea"},{key:"residual_risk",label:"Preostalo tveganje",type:"select",options:["low","medium","high","critical"]},{key:"owner",label:"Lastnik",type:"text"},{key:"review_date",label:"Datum pregleda",type:"date"}],defaultValues:{organization_id:r}}),e.jsx(Qa,{isOpen:x,onClose:()=>{b(!1),v(null)},onSave:W,mode:"delete",record:g,title:"Izbrii oceno tveganja",table:"iso_risk_assessment",fields:[],defaultValues:{}}),e.jsx(Qa,{isOpen:h,onClose:()=>{j(!1),v(null)},onSave:W,mode:"view",record:g,title:"Podrobnosti ocene tveganja",table:"iso_risk_assessment",fields:[{key:"risk_id",label:"ID tveganja",type:"text"},{key:"asset_name",label:"Naziv sredstva",type:"text"},{key:"threat_description",label:"Opis gronje",type:"textarea"},{key:"vulnerability_description",label:"Opis ranljivosti",type:"textarea"},{key:"likelihood",label:"Verjetnost",type:"select",options:["very_low","low","medium","high","very_high"]},{key:"impact",label:"Vpliv",type:"select",options:["very_low","low","medium","high","very_high"]},{key:"risk_level",label:"Nivo tveganja",type:"select",options:["low","medium","high","critical"]},{key:"mitigation_strategy",label:"Strategija za zmanjanje",type:"textarea"},{key:"residual_risk",label:"Preostalo tveganje",type:"select",options:["low","medium","high","critical"]},{key:"owner",label:"Lastnik",type:"text"},{key:"review_date",label:"Datum pregleda",type:"date"}],defaultValues:{organization_id:r}})]})}function iE(){const{t:s}=et(),{user:t}=cr(),[r,a]=z.useState([]),[n,i]=z.useState(!0),[o,c]=z.useState(!1),[d,p]=z.useState(!1),[m,x]=z.useState(!1),[b,h]=z.useState(!1),[j,g]=z.useState(null),[v,_]=z.useState(null);z.useEffect(()=>{(async()=>{if(t)try{const{data:A,error:S}=await Ne.from("profiles").select("*, organization_id").eq("id",t.id).single();if(S)throw S;_(A)}catch(A){console.error("Error fetching user profile:",A)}})()},[t]);const k=[{id:"demo-1",control_id:"A.5.1.1",control_name:"Varnostna politika informacijske varnosti",control_category:"Varnostna politika",implementation_status:"implemented",description:"Politika informacijske varnosti je doloena, odobrena s strani vodstva, objavljena, komunicirana in priznana s strani relevantnih zainteresiranih strani ter se pregleduje redno.",responsible_person:"Janez Novak",effectiveness:"high",implementation_date:"2024-01-15",review_date:"2024-12-15",organization_id:v==null?void 0:v.organization_id},{id:"demo-2",control_id:"A.6.1.1",control_name:"Vloge in odgovornosti za informacijsko varnost",control_category:"Organizacija informacijske varnosti",implementation_status:"implemented",description:"Vloge in odgovornosti za informacijsko varnost so doloene in komunicirane v skladu z varnostno politiko informacijske varnosti.",responsible_person:"Ana Kovai",effectiveness:"high",implementation_date:"2024-01-20",review_date:"2024-12-20",organization_id:v==null?void 0:v.organization_id},{id:"demo-3",control_id:"A.7.1.1",control_name:"Preverjanje ozadja",control_category:"loveki viri",implementation_status:"partially_implemented",description:"Preverjanje ozadja vseh kandidatov za zaposlitev, pogodbenikov in uporabnikov tretjih strani se izvaja skladno z ustreznimi zakoni, predpisi in etinimi naeli ter sorazmerno z zahtevami dostopa do informacij.",responsible_person:"Marko Zupan",effectiveness:"medium",implementation_date:"2024-02-01",review_date:"2025-02-01",organization_id:v==null?void 0:v.organization_id},{id:"demo-4",control_id:"A.8.1.1",control_name:"Inventar sredstev",control_category:"Upravljanje sredstev",implementation_status:"implemented",description:"Sredstva, povezana z informacijskimi sistemi, identifikacijom, posodabljanjem in zaitnimi sredstvi se evidentirajo in vzdrujejo.",responsible_person:"Petra Pavlin",effectiveness:"high",implementation_date:"2024-01-10",review_date:"2024-07-10",organization_id:v==null?void 0:v.organization_id},{id:"demo-5",control_id:"A.9.1.1",control_name:"Politika nadzora dostopa",control_category:"Nadzor dostopa",implementation_status:"not_implemented",description:"Politika nadzora dostopa se vzpostavi, dokumentira in pregleduje na podlagi poslovnih in zahtev informacijske varnosti.",responsible_person:"Toma Bergant",effectiveness:"low",implementation_date:null,review_date:"2025-01-30",organization_id:v==null?void 0:v.organization_id},{id:"demo-6",control_id:"A.10.1.1",control_name:"Politika kriptografije",control_category:"Kriptografija",implementation_status:"partially_implemented",description:"Politika in standardi uporabe kriptografskih kontrol se razvijejo in implementirajo za zaito zaupnosti, avtentinosti in celovitosti informacij.",responsible_person:"Maja Kosec",effectiveness:"medium",implementation_date:"2024-02-15",review_date:"2025-02-15",organization_id:v==null?void 0:v.organization_id},{id:"demo-7",control_id:"A.11.1.1",control_name:"Fizini vhod in varnost",control_category:"Fizina varnost",implementation_status:"implemented",description:"Ogledalie in naprave za fizini vhod so vzpostavljeni in upravljani za zaito prostorov, kjer se nahajajo informacijski sistemi.",responsible_person:"Robert Dolenec",effectiveness:"high",implementation_date:"2024-01-05",review_date:"2024-12-05",organization_id:v==null?void 0:v.organization_id}],P=async()=>{if(!(v!=null&&v.organization_id)){i(!1);return}try{i(!0);const{data:B,error:A}=await Ne.from("iso_controls_management").select("*").eq("organization_id",v.organization_id).order("created_at",{ascending:!1});if(A)throw A;!B||B.length===0?(a(k),console.log(" Prikazani demo podatki - baza je prazna ali ni podatkov")):a(B)}catch(B){console.error("Error:",B),a(k),console.log(" Prikazani demo podatki - prilo je do napake pri pridobivanju podatkov iz baze")}finally{i(!1)}},L=()=>{P(),c(!1),p(!1),x(!1),h(!1),g(null)},F=B=>{g(B),p(!0)},W=B=>{g(B),x(!0)},R=B=>{g(B),h(!0)};return z.useEffect(()=>{v!=null&&v.organization_id&&P()},[v]),n?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:s("common.loading")})]})}):v!=null&&v.organization_id?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-accent-primary/10 flex items-center justify-center",children:e.jsx(Mt,{className:"w-5 h-5 text-accent-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:s("iso.controls.title")}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:s("iso.controls.subtitle")})]})]}),e.jsxs("button",{onClick:()=>c(!0),className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Dt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:s("iso.controls.addControl")})]})]}),e.jsx("div",{className:"bg-bg-surface rounded-sm border border-border-subtle overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-pure-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.controls.controlId")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.controls.controlName")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.controls.controlCategory")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("common.status")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.controls.responsiblePerson")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.controls.effectiveness")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("common.actions")})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:r.map(B=>e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 text-body text-text-primary font-mono",children:B.control_id}),e.jsx("td",{className:"px-6 py-4 text-body text-text-primary font-medium",children:B.control_name}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:B.control_category}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium ${B.implementation_status==="implemented"?"bg-status-success/10 text-status-success":B.implementation_status==="partially_implemented"?"bg-status-warning/10 text-status-warning":"bg-status-error/10 text-status-error"}`,children:s(`iso.controls.implementationStatusOptions.${B.implementation_status}`)})}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:B.responsible_person}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium ${B.effectiveness==="high"?"bg-status-success/10 text-status-success":B.effectiveness==="medium"?"bg-status-warning/10 text-status-warning":"bg-status-error/10 text-status-error"}`,children:s(`iso.controls.effectivenessOptions.${B.effectiveness}`)||"-"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>R(B),className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",title:s("common.view"),children:e.jsx(lr,{className:"w-4 h-4 text-text-secondary"})}),e.jsx("button",{onClick:()=>F(B),className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",title:s("common.edit"),children:e.jsx(ar,{className:"w-4 h-4 text-text-secondary"})}),e.jsx("button",{onClick:()=>W(B),className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",title:s("common.delete"),children:e.jsx(pr,{className:"w-4 h-4 text-status-error"})})]})})]},B.id))})]})}),e.jsx(kD,{isOpen:o,onClose:()=>c(!1),onSave:L}),e.jsx(Qa,{isOpen:d,onClose:()=>{p(!1),g(null)},onSave:L,mode:"edit",record:j,title:"Uredi kontrolni ukrep",table:"iso_controls_management",fields:[{key:"control_id",label:"ID kontrole",type:"text",required:!0},{key:"control_name",label:"Naziv kontrole",type:"text",required:!0},{key:"control_category",label:"Kategorija kontrole",type:"text"},{key:"implementation_status",label:"Status implementacije",type:"select",required:!0,options:["not_implemented","partially_implemented","implemented"]},{key:"description",label:"Opis",type:"textarea"},{key:"responsible_person",label:"Odgovorna oseba",type:"text"},{key:"effectiveness",label:"Uinkovitost",type:"select",options:["low","medium","high"]},{key:"implementation_date",label:"Datum implementacije",type:"date"},{key:"review_date",label:"Datum pregleda",type:"date"}],defaultValues:{organization_id:v==null?void 0:v.organization_id}}),e.jsx(Qa,{isOpen:m,onClose:()=>{x(!1),g(null)},onSave:L,mode:"delete",record:j,title:"Izbrii kontrolni ukrep",table:"iso_controls_management",fields:[],defaultValues:{}}),e.jsx(Qa,{isOpen:b,onClose:()=>{h(!1),g(null)},onSave:L,mode:"view",record:j,title:"Podrobnosti kontrolnega ukrepa",table:"iso_controls_management",fields:[{key:"control_id",label:"ID kontrole",type:"text"},{key:"control_name",label:"Naziv kontrole",type:"text"},{key:"control_category",label:"Kategorija kontrole",type:"text"},{key:"implementation_status",label:"Status implementacije",type:"select",options:["not_implemented","partially_implemented","implemented"]},{key:"description",label:"Opis",type:"textarea"},{key:"responsible_person",label:"Odgovorna oseba",type:"text"},{key:"effectiveness",label:"Uinkovitost",type:"select",options:["low","medium","high"]},{key:"implementation_date",label:"Datum implementacije",type:"date"},{key:"review_date",label:"Datum pregleda",type:"date"}],defaultValues:{organization_id:v==null?void 0:v.organization_id}})]}):e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Mt,{className:"w-12 h-12 text-text-secondary mx-auto mb-3"}),e.jsx("h3",{className:"text-heading-md font-semibold text-text-primary mb-2",children:s("common.organizationRequired")}),e.jsx("p",{className:"text-body text-text-secondary",children:s("common.organizationRequiredDescription")})]})})}function oE(){const{t:s}=et(),{user:t}=cr(),{organizationId:r}=Sn(),[a,n]=z.useState([]),[i,o]=z.useState([]),[c,d]=z.useState(!0),[p,m]=z.useState(!1),[x,b]=z.useState(!1),[h,j]=z.useState(!1),[g,v]=z.useState(!1),[_,k]=z.useState(null),[P,L]=z.useState(null),[F,W]=z.useState(""),[R,B]=z.useState("all");z.useEffect(()=>{(async()=>{if(t)try{const{data:X,error:U}=await Ne.from("profiles").select("*, organization_id").eq("id",t.id).single();if(U)throw U;L(X)}catch(X){console.error("Error fetching user profile:",X)}})()},[t]);const A=async()=>{if(!r){d(!1);return}try{d(!0);const{data:re,error:X}=await Ne.from("iso_roles_responsibilities").select("*").eq("organization_id",r).order("created_at",{ascending:!1});if(X)throw X;n(re||[])}catch(re){console.error("Error:",re)}finally{d(!1)}};z.useEffect(()=>{let re=a;F&&(re=re.filter(X=>{var U,oe,xe;return((U=X.role_name)==null?void 0:U.toLowerCase().includes(F.toLowerCase()))||((oe=X.person_assigned)==null?void 0:oe.toLowerCase().includes(F.toLowerCase()))||((xe=X.role_purpose)==null?void 0:xe.toLowerCase().includes(F.toLowerCase()))})),R!=="all"&&(re=re.filter(X=>X.status===R)),o(re)},[a,F,R]);const S=()=>{A(),m(!1),b(!1),j(!1),v(!1),k(null)},C=re=>{k(re),b(!0)},O=re=>{k(re),j(!0)},Z=re=>{k(re),v(!0)};if(z.useEffect(()=>{r&&A()},[r]),c)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:s("common.loading")})]})});if(!r)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(er,{className:"w-12 h-12 text-text-secondary mx-auto mb-3"}),e.jsx("h3",{className:"text-heading-md font-semibold text-text-primary mb-2",children:s("common.organizationRequired")}),e.jsx("p",{className:"text-body text-text-secondary",children:s("common.organizationRequiredDescription")})]})});const te=re=>{switch(re){case"active":return"bg-status-success/20 text-status-success shadow-[0_0_10px_rgba(34,197,94,0.3)]";case"inactive":return"bg-status-error/20 text-status-error";case"pending":return"bg-status-warning/20 text-status-warning";default:return"bg-gray-500/20 text-gray-400"}},ce=re=>{switch(re){case"active":return"Aktiven";case"inactive":return"Neaktiven";case"pending":return"V akanju";default:return re}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-indigo-500/10 flex items-center justify-center",children:e.jsx(ox,{className:"w-5 h-5 text-indigo-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Vloge, odgovornosti in pooblastila"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Upravljanje vlog in odgovornosti po ISO 27001:2022"})]})]}),e.jsxs("button",{onClick:()=>m(!0),className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Dt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:"Dodaj vlogo"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Ii po nazivu vloge, osebi ali namenu...",value:F,onChange:re=>W(re.target.value),className:"w-full px-4 py-2 bg-bg-surface border border-border-subtle rounded-sm text-body text-text-primary placeholder-text-secondary focus:border-accent-primary focus:outline-none"})}),e.jsx("div",{className:"sm:w-48",children:e.jsxs("select",{value:R,onChange:re=>B(re.target.value),className:"w-full px-4 py-2 bg-bg-surface border border-border-subtle rounded-sm text-body text-text-primary focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"all",children:"Vsi statusi"}),e.jsx("option",{value:"active",children:"Aktiven"}),e.jsx("option",{value:"inactive",children:"Neaktiven"}),e.jsx("option",{value:"pending",children:"V akanju"})]})})]}),e.jsx("div",{className:"bg-bg-surface rounded-sm border border-border-subtle overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-pure-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Naziv vloge"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Dodeljeno"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Namembnost"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Status"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Datum imenovanja"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Veljavnost"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Dejanja"})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:i.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-8 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx(er,{className:"w-8 h-8 text-text-secondary"}),e.jsx("p",{className:"text-body text-text-secondary",children:F||R!=="all"?"Nobena vloga ne ustreza iskalnim kriterijem":"Nobena vloga ni najdena"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:r?`Za organizacijo ${r} ni najdenih vlog v tabeli iso_roles_responsibilities`:"Organizacijski kontekst ni na voljo"}),!F&&R==="all"&&e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Poizkusite dodati novo vlogo"})]})})}):i.map(re=>e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 text-body text-text-primary font-medium",children:re.role_name}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:re.person_assigned||"-"}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary max-w-xs truncate",title:re.role_purpose,children:re.role_purpose||"-"}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium ${te(re.status)}`,children:ce(re.status)})}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:re.appointment_date?new Date(re.appointment_date).toLocaleDateString("sl-SI"):"-"}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:re.validity_start&&re.validity_end?`${new Date(re.validity_start).toLocaleDateString("sl-SI")} - ${new Date(re.validity_end).toLocaleDateString("sl-SI")}`:"-"}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>Z(re),className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",title:s("common.view"),children:e.jsx(lr,{className:"w-4 h-4 text-text-secondary"})}),e.jsx("button",{onClick:()=>C(re),className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",title:s("common.edit"),children:e.jsx(ar,{className:"w-4 h-4 text-text-secondary"})}),e.jsx("button",{onClick:()=>O(re),className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",title:s("common.delete"),children:e.jsx(pr,{className:"w-4 h-4 text-status-error"})})]})})]},re.id))})]})}),e.jsx(RD,{isOpen:p,onClose:()=>m(!1),onSave:S}),e.jsx(Qa,{isOpen:x,onClose:()=>{b(!1),k(null)},onSave:S,mode:"edit",record:_,title:"Uredi vlogo",table:"iso_roles_responsibilities",fields:[{key:"role_name",label:"Naziv vloge",type:"text",required:!0},{key:"role_purpose",label:"Namembnost vloge",type:"textarea",required:!0},{key:"key_responsibilities",label:"Kljune odgovornosti",type:"textarea",required:!0},{key:"authorities",label:"Pooblastila",type:"textarea",required:!0},{key:"reporting_lines",label:"Hierarhija poroanja",type:"textarea",required:!0},{key:"required_competencies",label:"Zahtevane kompetence",type:"textarea",required:!0},{key:"required_training",label:"Zahtevano usposabljanje",type:"textarea",required:!0},{key:"completed_training",label:"Opravljeno usposabljanje",type:"textarea"},{key:"relevant_processes",label:"Ustrezni procesi",type:"textarea",required:!0},{key:"related_controls",label:"Povezane kontrole",type:"textarea",required:!0},{key:"related_risks",label:"Povezana tveganja",type:"textarea"},{key:"performance_indicators",label:"Kazalniki uspenosti",type:"textarea",required:!0},{key:"kpi_targets",label:"Cilji KPI",type:"textarea"},{key:"person_assigned",label:"Dodeljena oseba",type:"text",required:!0},{key:"appointment_date",label:"Datum imenovanja",type:"date",required:!0},{key:"validity_start",label:"Zaetek veljavnosti",type:"date",required:!0},{key:"validity_end",label:"Konec veljavnosti",type:"date",required:!0},{key:"document_version",label:"Verzija dokumenta",type:"text"},{key:"document_owner",label:"Lastnik dokumenta",type:"text"},{key:"communication_plan",label:"Komunikacijski nart",type:"textarea"},{key:"stakeholder_notification",label:"Obveanje stakeholderjem",type:"textarea"},{key:"status",label:"Status",type:"select",required:!0,options:["active","inactive","pending"]},{key:"notes",label:"Opombe",type:"textarea"}],defaultValues:{organization_id:r}}),e.jsx(Qa,{isOpen:h,onClose:()=>{j(!1),k(null)},onSave:S,mode:"delete",record:_,title:"Izbrii vlogo",table:"iso_roles_responsibilities",fields:[],defaultValues:{}}),e.jsx(Qa,{isOpen:g,onClose:()=>{v(!1),k(null)},onSave:S,mode:"view",record:_,title:"Podrobnosti vloge",table:"iso_roles_responsibilities",fields:[{key:"role_name",label:"Naziv vloge",type:"text"},{key:"role_purpose",label:"Namembnost vloge",type:"textarea"},{key:"key_responsibilities",label:"Kljune odgovornosti",type:"textarea"},{key:"authorities",label:"Pooblastila",type:"textarea"},{key:"reporting_lines",label:"Hierarhija poroanja",type:"textarea"},{key:"required_competencies",label:"Zahtevane kompetence",type:"textarea"},{key:"required_training",label:"Zahtevano usposabljanje",type:"textarea"},{key:"completed_training",label:"Opravljeno usposabljanje",type:"textarea"},{key:"relevant_processes",label:"Ustrezni procesi",type:"textarea"},{key:"related_controls",label:"Povezane kontrole",type:"textarea"},{key:"related_risks",label:"Povezana tveganja",type:"textarea"},{key:"performance_indicators",label:"Kazalniki uspenosti",type:"textarea"},{key:"kpi_targets",label:"Cilji KPI",type:"textarea"},{key:"person_assigned",label:"Dodeljena oseba",type:"text"},{key:"appointment_date",label:"Datum imenovanja",type:"date"},{key:"validity_start",label:"Zaetek veljavnosti",type:"date"},{key:"validity_end",label:"Konec veljavnosti",type:"date"},{key:"document_version",label:"Verzija dokumenta",type:"text"},{key:"document_owner",label:"Lastnik dokumenta",type:"text"},{key:"communication_plan",label:"Komunikacijski nart",type:"textarea"},{key:"stakeholder_notification",label:"Obveanje stakeholderjem",type:"textarea"},{key:"status",label:"Status",type:"select",options:["active","inactive","pending"]},{key:"notes",label:"Opombe",type:"textarea"}],defaultValues:{organization_id:r}})]})}const lE=[{id:"demo-1",certification_id:"ISO-27001-2023-001",certification_body:"SIQ Ljubljana",certificate_number:"SIQ-2023-ISO27001-001",certification_date:"2023-06-15",expiry_date:"2026-06-15",status:"active"},{id:"demo-2",certification_id:"ISO-27001-2020-002",certification_body:"TV SD",certificate_number:"TUV-2020-ISO27001-002",certification_date:"2020-03-10",expiry_date:"2023-03-10",status:"expired"},{id:"demo-3",certification_id:"ISO-27701-2022-003",certification_body:"Bureau Veritas",certificate_number:"BV-2022-ISO27701-003",certification_date:"2022-09-20",expiry_date:"2025-09-20",status:"active"},{id:"demo-4",certification_id:"ISO-27017-2021-004",certification_body:"DNV",certificate_number:"DNV-2021-ISO27017-004",certification_date:"2021-12-05",expiry_date:"2024-12-05",status:"active"},{id:"demo-5",certification_id:"ISO-27018-2024-005",certification_body:"LRQA",certificate_number:"LRQA-2024-ISO27018-005",certification_date:"2024-01-30",expiry_date:"2027-01-30",status:"active"}];function cE(){const{t:s}=et(),{user:t}=cr(),[r,a]=z.useState([]),[n,i]=z.useState(!0),[o,c]=z.useState(!1),[d,p]=z.useState(null);z.useEffect(()=>{(async()=>{if(t)try{const{data:h,error:j}=await Ne.from("profiles").select("*, organization_id").eq("id",t.id).single();if(j)throw j;p(h)}catch(h){console.error("Error fetching user profile:",h)}})()},[t]);const m=async()=>{if(!(d!=null&&d.organization_id)){i(!1);return}try{i(!0);const{data:b,error:h}=await Ne.from("iso_certification_status").select("*").eq("organization_id",d.organization_id).order("certification_date",{ascending:!1});if(h)throw h;a(b||[])}catch(b){console.error("Error:",b)}finally{i(!1)}},x=()=>{m(),c(!1)};return z.useEffect(()=>{d!=null&&d.organization_id&&m()},[d]),n?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:s("common.loading")})]})}):d!=null&&d.organization_id?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-accent-primary/10 flex items-center justify-center",children:e.jsx(pl,{className:"w-5 h-5 text-accent-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:s("iso.certification.title")}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:s("iso.certification.subtitle")})]})]}),e.jsxs("button",{onClick:()=>c(!0),className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Dt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:s("iso.certification.addCertificate")})]})]}),e.jsx("div",{className:"bg-bg-surface rounded-sm border border-border-subtle overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-pure-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.certification.certificationId")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.certification.certificationBody")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.certification.certificateNumber")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.certification.certificationDate")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.certification.expiryDate")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("common.status")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("common.actions")})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:(r.length>0?r:lE).map(b=>e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 text-body text-text-primary font-mono",children:b.certification_id}),e.jsx("td",{className:"px-6 py-4 text-body text-text-primary font-medium",children:b.certification_body}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:b.certificate_number}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:new Date(b.certification_date).toLocaleDateString("sl-SI")}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:new Date(b.expiry_date).toLocaleDateString("sl-SI")}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium ${b.status==="active"?"bg-status-success/10 text-status-success":"bg-status-warning/10 text-status-warning"}`,children:s(`iso.certification.statusOptions.${b.status}`)})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",children:e.jsx(ar,{className:"w-4 h-4 text-text-secondary"})}),e.jsx("button",{className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",children:e.jsx(pr,{className:"w-4 h-4 text-status-error"})})]})})]},b.id))})]})}),e.jsx(DD,{isOpen:o,onClose:()=>c(!1),onSave:x})]}):e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(pl,{className:"w-12 h-12 text-text-secondary mx-auto mb-3"}),e.jsx("h3",{className:"text-heading-md font-semibold text-text-primary mb-2",children:s("common.organizationRequired")}),e.jsx("p",{className:"text-body text-text-secondary",children:s("common.organizationRequiredDescription")})]})})}function dE(){const{t:s}=et(),{user:t}=cr(),[r,a]=z.useState([]),[n,i]=z.useState(!0),[o,c]=z.useState(!1),[d,p]=z.useState(null);z.useEffect(()=>{(async()=>{if(t)try{const{data:g,error:v}=await Ne.from("profiles").select("*, organization_id").eq("id",t.id).single();if(v)throw v;p(g)}catch(g){console.error("Error fetching user profile:",g)}})()},[t]);const m=async()=>{if(!(d!=null&&d.organization_id)){i(!1);return}try{i(!0);const{data:j,error:g}=await Ne.from("iso_asset_management").select("*").eq("organization_id",d.organization_id).order("created_at",{ascending:!1});if(g)throw g;if(!j||j.length===0){const v=[{id:"demo-1",asset_id:"SRV-001",asset_name:"Glavni strenik",asset_type:"hardware",owner:"Janez Novak",location:"Klet - Rack 01",value_rating:"very_high",classification:"confidential",risk_level:"high",last_assessment_date:"2024-11-01",organization_id:d.organization_id},{id:"demo-2",asset_id:"SW-001",asset_name:"SAP ERP sistem",asset_type:"software",owner:"IT oddelek",location:"Glavni podatkovni center",value_rating:"very_high",classification:"confidential",risk_level:"critical",last_assessment_date:"2024-10-15",organization_id:d.organization_id},{id:"demo-3",asset_id:"LAP-001",asset_name:"Prenosni raunalnik direktorja",asset_type:"hardware",owner:"Dr. Marija Kova",location:"Pisarna 205",value_rating:"high",classification:"restricted",risk_level:"medium",last_assessment_date:"2024-11-05",organization_id:d.organization_id},{id:"demo-4",asset_id:"DATA-001",asset_name:"Baza strank",asset_type:"data",owner:"Vodja prodaje",location:"Podatkovni center - DB Cluster",value_rating:"very_high",classification:"confidential",risk_level:"high",last_assessment_date:"2024-11-08",organization_id:d.organization_id},{id:"demo-5",asset_id:"SVC-001",asset_name:"Email sistem",asset_type:"service",owner:"IT oddelek",location:"Cloud (Microsoft 365)",value_rating:"medium",classification:"internal",risk_level:"medium",last_assessment_date:"2024-11-07",organization_id:d.organization_id}];a(v)}else a(j)}catch(j){console.error("Error:",j),a([])}finally{i(!1)}},x=()=>{m(),c(!1)};if(z.useEffect(()=>{d!=null&&d.organization_id&&m()},[d]),n)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:s("common.loading")})]})});if(!(d!=null&&d.organization_id))return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(sd,{className:"w-12 h-12 text-text-secondary mx-auto mb-3"}),e.jsx("h3",{className:"text-heading-md font-semibold text-text-primary mb-2",children:s("common.organizationRequired")}),e.jsx("p",{className:"text-body text-text-secondary",children:s("common.organizationRequiredDescription")})]})});const b=j=>{switch(j==null?void 0:j.toLowerCase()){case"high":return"bg-risk-high/20 text-risk-high";case"medium":return"bg-risk-medium/20 text-risk-medium";case"low":return"bg-risk-low/20 text-risk-low";case"critical":return"bg-risk-high/20 text-risk-high";default:return"bg-bg-surface text-text-secondary"}},h=j=>{switch(j==null?void 0:j.toLowerCase()){case"very_low":return"Zelo nizka";case"low":return"Nizka";case"medium":return"Srednja";case"high":return"Visoka";case"very_high":return"Zelo visoka";default:return"-"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-accent-primary/10 flex items-center justify-center",children:e.jsx(sd,{className:"w-5 h-5 text-accent-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:s("iso.assets.title")}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:s("iso.assets.subtitle")})]})]}),e.jsxs("button",{onClick:()=>c(!0),className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Dt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:s("iso.assets.addAsset")})]})]}),e.jsx("div",{className:"bg-bg-surface rounded-sm border border-border-subtle overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-pure-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.assets.assetId")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.assets.assetName")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.assets.assetType")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.assets.owner")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Lokacija"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Vrednost"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.assets.classification")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.risk.riskLevel")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("common.actions")})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:r.map(j=>e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 text-body text-text-primary font-mono",children:j.asset_id}),e.jsx("td",{className:"px-6 py-4 text-body text-text-primary font-medium",children:j.asset_name}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:j.asset_type}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:j.owner}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:j.location||"-"}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:h(j.value_rating)}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"px-2 py-1 rounded-full text-caption font-medium bg-accent-primary/10 text-accent-primary",children:j.classification})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium ${b(j.risk_level)}`,children:s(`iso.assets.riskLevelOptions.${j.risk_level.toLowerCase()}`)})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",children:e.jsx(ar,{className:"w-4 h-4 text-text-secondary"})}),e.jsx("button",{className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",children:e.jsx(pr,{className:"w-4 h-4 text-status-error"})})]})})]},j.id))})]})}),e.jsx(CD,{isOpen:o,onClose:()=>c(!1),onSave:x})]})}function uE(){const{t:s}=et(),{user:t}=cr(),[r,a]=z.useState([]),[n,i]=z.useState(!0),[o,c]=z.useState(!1),[d,p]=z.useState(null);z.useEffect(()=>{(async()=>{if(t)try{const{data:j,error:g}=await Ne.from("profiles").select("*, organization_id").eq("id",t.id).single();if(g)throw g;p(j)}catch(j){console.error("Error fetching user profile:",j)}})()},[t]);const m=async()=>{if(!(d!=null&&d.organization_id)){i(!1);return}try{i(!0);const{data:h,error:j}=await Ne.from("iso_incident_response").select("*").eq("organization_id",d.organization_id).order("detection_date",{ascending:!1});if(j)throw j;a(h||[])}catch(h){console.error("Error:",h)}finally{i(!1)}},x=()=>{m(),c(!1)};if(z.useEffect(()=>{d!=null&&d.organization_id&&m()},[d]),n)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:s("common.loading")})]})});if(!(d!=null&&d.organization_id))return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(e0,{className:"w-12 h-12 text-text-secondary mx-auto mb-3"}),e.jsx("h3",{className:"text-heading-md font-semibold text-text-primary mb-2",children:s("common.organizationRequired")}),e.jsx("p",{className:"text-body text-text-secondary",children:s("common.organizationRequiredDescription")})]})});const b=h=>{switch(h==null?void 0:h.toLowerCase()){case"critical":return"bg-risk-critical/20 text-risk-critical shadow-[0_0_10px_rgba(239,68,68,0.3)]";case"high":return"bg-risk-high/20 text-risk-high shadow-[0_0_8px_rgba(251,146,60,0.3)]";case"medium":return"bg-risk-medium/20 text-risk-medium";case"low":return"bg-risk-low/20 text-risk-low";default:return"bg-bg-surface text-text-secondary"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-risk-high/10 flex items-center justify-center",children:e.jsx(e0,{className:"w-5 h-5 text-risk-high"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:s("iso.incident.title")}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:s("iso.incident.subtitle")})]})]}),e.jsxs("button",{onClick:()=>c(!0),className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Dt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:s("iso.incident.addIncident")})]})]}),e.jsx("div",{className:"bg-bg-surface rounded-sm border border-border-subtle overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-pure-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.incident.incidentId")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.incident.incidentType")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.incident.detectionDate")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("dashboard.severity")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("common.status")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("common.actions")})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:r.map(h=>e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 text-body text-text-primary font-mono",children:h.incident_id}),e.jsx("td",{className:"px-6 py-4 text-body text-text-primary font-medium",children:h.incident_type}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:new Date(h.detection_date).toLocaleString("sl-SI")}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium ${b(h.severity)}`,children:s(`iso.incident.severityOptions.${h.severity.toLowerCase()}`)})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium ${h.status==="closed"?"bg-status-success/10 text-status-success":"bg-status-error/10 text-status-error"}`,children:s(`iso.incident.statusOptions.${h.status}`)})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",children:e.jsx(ar,{className:"w-4 h-4 text-text-secondary"})}),e.jsx("button",{className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",children:e.jsx(pr,{className:"w-4 h-4 text-status-error"})})]})})]},h.id))})]})}),e.jsx(zD,{isOpen:o,onClose:()=>c(!1),onSave:x})]})}function pE(){const{t:s}=et(),{user:t}=cr(),[r,a]=z.useState([]),[n,i]=z.useState(!0),[o,c]=z.useState(!1),[d,p]=z.useState(null);z.useEffect(()=>{(async()=>{if(t)try{const{data:h,error:j}=await Ne.from("profiles").select("*, organization_id").eq("id",t.id).single();if(j)throw j;p(h)}catch(h){console.error("Error fetching user profile:",h)}})()},[t]);const m=async()=>{if(!(d!=null&&d.organization_id)){i(!1);return}try{i(!0);const{data:b,error:h}=await Ne.from("iso_compliance_tracking").select("*").eq("organization_id",d.organization_id).order("created_at",{ascending:!1});if(h)throw h;a(b||[])}catch(b){console.error("Error:",b)}finally{i(!1)}},x=()=>{m(),c(!1)};return z.useEffect(()=>{d!=null&&d.organization_id&&m()},[d]),n?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:s("common.loading")})]})}):d!=null&&d.organization_id?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-accent-primary/10 flex items-center justify-center",children:e.jsx(Db,{className:"w-5 h-5 text-accent-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:s("iso.compliance.title")}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:s("iso.compliance.subtitle")})]})]}),e.jsxs("button",{onClick:()=>c(!0),className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Dt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:s("iso.compliance.addRequirement")})]})]}),e.jsx("div",{className:"bg-bg-surface rounded-sm border border-border-subtle overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-pure-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.compliance.complianceId")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.compliance.requirementName")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.compliance.standardReference")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("common.status")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.compliance.lastAssessmentDate")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("iso.compliance.nextReviewDate")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("common.actions")})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:r.map(b=>e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 text-body text-text-primary font-mono",children:b.compliance_id}),e.jsx("td",{className:"px-6 py-4 text-body text-text-primary font-medium max-w-xs truncate",children:b.requirement_name}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:b.standard_reference}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium ${b.compliance_status==="compliant"?"bg-status-success/10 text-status-success":b.compliance_status==="partially_compliant"?"bg-status-warning/10 text-status-warning":"bg-status-error/10 text-status-error"}`,children:s(`iso.compliance.statusOptions.${b.compliance_status}`)})}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:b.last_assessment_date?new Date(b.last_assessment_date).toLocaleDateString("sl-SI"):"-"}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:b.next_review_date?new Date(b.next_review_date).toLocaleDateString("sl-SI"):"-"}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",children:e.jsx(ar,{className:"w-4 h-4 text-text-secondary"})}),e.jsx("button",{className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",children:e.jsx(pr,{className:"w-4 h-4 text-status-error"})})]})})]},b.id))})]})}),e.jsx(ID,{isOpen:o,onClose:()=>c(!1),onSave:x})]}):e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Db,{className:"w-12 h-12 text-text-secondary mx-auto mb-3"}),e.jsx("h3",{className:"text-heading-md font-semibold text-text-primary mb-2",children:s("common.organizationRequired")}),e.jsx("p",{className:"text-body text-text-secondary",children:s("common.organizationRequiredDescription")})]})})}function mE(){const{t:s}=et(),{user:t}=cr(),[r,a]=z.useState([]),[n,i]=z.useState(!0),[o,c]=z.useState(!1),[d,p]=z.useState(null),[m,x]=z.useState("edit"),[b,h]=z.useState(null),[j,g]=z.useState(""),[v,_]=z.useState(""),[k,P]=z.useState("");z.useEffect(()=>{(async()=>{if(t)try{const{data:Z,error:te}=await Ne.from("profiles").select("*, organization_id").eq("id",t.id).single();if(te)throw te;h(Z)}catch(Z){console.error("Error fetching user profile:",Z)}})()},[t]);const L=async()=>{if(!(b!=null&&b.organization_id)){i(!1);return}try{i(!0);const{data:O,error:Z}=await Ne.from("soa_controls").select("*").eq("organization_id",b.organization_id).order("control_id",{ascending:!0});if(Z)throw Z;a(O||[])}catch(O){console.error("Error:",O)}finally{i(!1)}},F=()=>{L(),c(!1),p(null)},W=O=>{p(O),x("edit"),c(!0)},R=O=>{p(O),x("view"),c(!0)};z.useEffect(()=>{b!=null&&b.organization_id&&L()},[b]);const B=r.filter(O=>{const Z=!j||O.control_id.toLowerCase().includes(j.toLowerCase())||O.control_name.toLowerCase().includes(j.toLowerCase()),te=!v||O.control_category===v,ce=!k||O.status===k;return Z&&te&&ce}),A={total:r.length,implemented:r.filter(O=>O.status==="implemented").length,partiallyImplemented:r.filter(O=>O.status==="partially_implemented").length,notImplemented:r.filter(O=>O.status==="not_implemented").length,planned:r.filter(O=>O.status==="planned").length},S=O=>{switch(O){case"implemented":return"bg-green-100 text-green-800";case"partially_implemented":return"bg-yellow-100 text-yellow-800";case"planned":return"bg-blue-100 text-blue-800";case"not_implemented":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},C=O=>{switch(O){case"implemented":return"Implementirano";case"partially_implemented":return"Delno implementirano";case"planned":return"Nartovano";case"not_implemented":return"Ni implementirano";default:return O}};return n?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Nalagam kontrole..."})]})}):b!=null&&b.organization_id?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-indigo-500/10 flex items-center justify-center",children:e.jsx(ul,{className:"w-5 h-5 text-indigo-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"ISO 27001:2022 Statement of Applicability"}),e.jsx("p",{className:"text-body text-text-secondary",children:"Upravljanje vseh 93 kontrolnih ukrepov iz Annex A standarda"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"bg-bg-surface p-4 rounded-lg border border-border-subtle",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Bi,{className:"w-4 h-4 text-text-secondary"}),e.jsx("span",{className:"text-body-sm text-text-secondary",children:"Skupaj"})]}),e.jsx("p",{className:"text-heading-lg font-semibold text-text-primary mt-1",children:A.total})]}),e.jsxs("div",{className:"bg-bg-surface p-4 rounded-lg border border-border-subtle",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),e.jsx("span",{className:"text-body-sm text-text-secondary",children:"Implementirano"})]}),e.jsx("p",{className:"text-heading-lg font-semibold text-green-600 mt-1",children:A.implemented})]}),e.jsxs("div",{className:"bg-bg-surface p-4 rounded-lg border border-border-subtle",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-500"}),e.jsx("span",{className:"text-body-sm text-text-secondary",children:"Delno"})]}),e.jsx("p",{className:"text-heading-lg font-semibold text-yellow-600 mt-1",children:A.partiallyImplemented})]}),e.jsxs("div",{className:"bg-bg-surface p-4 rounded-lg border border-border-subtle",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),e.jsx("span",{className:"text-body-sm text-text-secondary",children:"Nartovano"})]}),e.jsx("p",{className:"text-heading-lg font-semibold text-blue-600 mt-1",children:A.planned})]}),e.jsxs("div",{className:"bg-bg-surface p-4 rounded-lg border border-border-subtle",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),e.jsx("span",{className:"text-body-sm text-text-secondary",children:"Ni implementirano"})]}),e.jsx("p",{className:"text-heading-lg font-semibold text-red-600 mt-1",children:A.notImplemented})]})]}),e.jsx("div",{className:"bg-bg-surface p-4 rounded-lg border border-border-subtle",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(ss,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-text-secondary"}),e.jsx("input",{type:"text",placeholder:"Iskanje po ID kontrole ali imenu...",value:j,onChange:O=>g(O.target.value),className:"w-full pl-10 pr-4 py-2 text-body bg-bg-pure-black border border-border-subtle rounded-md focus:ring-2 focus:ring-accent-primary focus:border-transparent"})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:v,onChange:O=>_(O.target.value),className:"px-3 py-2 text-body bg-bg-pure-black border border-border-subtle rounded-md focus:ring-2 focus:ring-accent-primary",children:[e.jsx("option",{value:"",children:"Vsi kategoriji"}),e.jsx("option",{value:"Organizacijske",children:"Organizacijske"}),e.jsx("option",{value:"Ljudi",children:"Ljudi"}),e.jsx("option",{value:"Fizine",children:"Fizine"}),e.jsx("option",{value:"Tehnoloke",children:"Tehnoloke"})]}),e.jsxs("select",{value:k,onChange:O=>P(O.target.value),className:"px-3 py-2 text-body bg-bg-pure-black border border-border-subtle rounded-md focus:ring-2 focus:ring-accent-primary",children:[e.jsx("option",{value:"",children:"Vsi statusi"}),e.jsx("option",{value:"implemented",children:"Implementirano"}),e.jsx("option",{value:"partially_implemented",children:"Delno implementirano"}),e.jsx("option",{value:"planned",children:"Nartovano"}),e.jsx("option",{value:"not_implemented",children:"Ni implementirano"})]})]})]})}),e.jsx("div",{className:"bg-bg-surface rounded-lg border border-border-subtle overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-pure-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-3 text-caption text-text-secondary uppercase tracking-wide",children:"ID"}),e.jsx("th",{className:"text-left px-4 py-3 text-caption text-text-secondary uppercase tracking-wide",children:"Kontrola"}),e.jsx("th",{className:"text-left px-4 py-3 text-caption text-text-secondary uppercase tracking-wide",children:"Kategorija"}),e.jsx("th",{className:"text-left px-4 py-3 text-caption text-text-secondary uppercase tracking-wide",children:"Status"}),e.jsx("th",{className:"text-left px-4 py-3 text-caption text-text-secondary uppercase tracking-wide",children:"Lastnik"}),e.jsx("th",{className:"text-left px-4 py-3 text-caption text-text-secondary uppercase tracking-wide",children:"Zadnji pregled"}),e.jsx("th",{className:"text-left px-4 py-3 text-caption text-text-secondary uppercase tracking-wide",children:"Dejanja"})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:B.map(O=>e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-4 py-3 text-body text-text-primary font-mono text-sm",children:O.control_id}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"max-w-md",children:[e.jsx("p",{className:"text-body text-text-primary font-medium",children:O.control_name}),O.justification&&e.jsx("p",{className:"text-caption text-text-secondary mt-1 truncate",children:O.justification})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"px-2 py-1 text-caption font-medium bg-gray-100 text-gray-800 rounded-full",children:O.control_category})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-caption font-medium rounded-full ${S(O.status)}`,children:C(O.status)})}),e.jsx("td",{className:"px-4 py-3 text-body text-text-secondary",children:O.control_owner||"-"}),e.jsx("td",{className:"px-4 py-3 text-body text-text-secondary",children:new Date(O.last_review_date).toLocaleDateString("sl-SI")}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>R(O),className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",title:"Poglej podrobnosti",children:e.jsx(lr,{className:"w-4 h-4 text-text-secondary"})}),e.jsx("button",{onClick:()=>W(O),className:"p-2 hover:bg-bg-near-black rounded transition-colors duration-150",title:"Uredi kontrolo",children:e.jsx(ar,{className:"w-4 h-4 text-text-secondary"})})]})})]},O.id))})]})})}),B.length===0&&!n&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Wp,{className:"w-12 h-12 text-text-secondary mx-auto mb-3"}),e.jsx("h3",{className:"text-heading-md font-semibold text-text-primary mb-2",children:"Ni najdenih kontrol"}),e.jsx("p",{className:"text-body text-text-secondary",children:"Poskusite z druganimi iskalnimi kriteriji ali filtri."})]}),e.jsx(LD,{isOpen:o,onClose:()=>{c(!1),p(null)},onSave:F,control:d,organizationId:b==null?void 0:b.organization_id,mode:m})]}):e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ul,{className:"w-12 h-12 text-text-secondary mx-auto mb-3"}),e.jsx("h3",{className:"text-heading-md font-semibold text-text-primary mb-2",children:"Organizacija je potrebna"}),e.jsx("p",{className:"text-body text-text-secondary",children:"Za dostop do ISO 27001 SoA funkcionalnosti potrebujete organizacijski raun."})]})})}function hE({isOpen:s,onClose:t,onSave:r}){const{user:a}=cr(),{t:n}=et(),[i,o]=z.useState(!1),[c,d]=z.useState({name:"",system_type:"",risk_level:"",status:"active",description:"",organization_id:""}),[p,m]=z.useState({}),[x,b]=z.useState(null);z.useEffect(()=>{s&&(d({name:"",system_type:"",risk_level:"",status:"active",description:"",organization_id:(x==null?void 0:x.organization_id)||""}),m({}))},[s,x==null?void 0:x.organization_id]),z.useEffect(()=>{(async()=>{if(!(!a||!s))try{const{data:_,error:k}=await Ne.from("profiles").select("*, organization_id").eq("id",a.id).single();if(k)throw k;b(_)}catch(_){console.error("Error fetching user profile:",_)}})()},[a,s]);const h=()=>{const v={};return c.name.trim()||(v.name=`${n("aiSystems.systemName")} ${n("forms.required")}`),c.system_type.trim()||(v.system_type=`${n("aiSystems.systemType")} ${n("forms.required")}`),c.risk_level.trim()||(v.risk_level=`${n("aiSystems.riskLevel")} ${n("forms.required")}`),(c.organization_id||(x==null?void 0:x.organization_id)||"").trim()||(v.organization_id="ID organizacije je obvezno polje"),m(v),Object.keys(v).length===0},j=async v=>{if(v.preventDefault(),!!h()){o(!0);try{if(!(x!=null&&x.organization_id))throw new Error("Organizacijski kontekst ni na voljo");const _={...c,organization_id:x.organization_id,created_date:new Date().toISOString().split("T")[0],last_updated:new Date().toISOString().split("T")[0]},{error:k}=await Ne.from("ai_systems").insert([_]);if(k)throw k.code==="23502"?new Error("Manjkajo obvezna polja"):k.code==="23505"?new Error("Zapis s tem ID-jem e obstaja"):k;r(),t(),d({name:"",system_type:"",risk_level:"",status:"active",description:"",organization_id:x.organization_id}),m({})}catch(_){console.error("Napaka pri shranjevanju:",_);const k=_.message||"Napaka pri shranjevanju podatkov";k.includes("Organizacijski kontekst")?alert("Napaka: "+k):alert(k)}finally{o(!1)}}},g=(v,_)=>{d(k=>({...k,[v]:_})),p[v]&&m(k=>({...k,[v]:""}))};return s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-bg-surface rounded-lg border border-border-subtle w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-border-subtle",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Lh,{className:"w-5 h-5 text-accent-primary"}),e.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:n("aiSystems.addSystem")})]}),e.jsx("button",{onClick:t,className:"text-text-tertiary hover:text-text-primary transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:j,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:[n("aiSystems.systemName")," *"]}),e.jsx("input",{type:"text",value:c.name,onChange:v=>g("name",v.target.value),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary",placeholder:"Vnesite ime AI sistema",required:!0}),p.name&&e.jsx("p",{className:"text-status-error text-xs mt-1",children:p.name})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:[n("aiSystems.systemType")," *"]}),e.jsxs("select",{value:c.system_type,onChange:v=>g("system_type",v.target.value),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary",required:!0,children:[e.jsx("option",{value:"",children:n("common.selectOption")}),e.jsx("option",{value:"conversational",children:n("aiSystems.systemTypeOptions.conversational")}),e.jsx("option",{value:"biometric",children:n("aiSystems.systemTypeOptions.biometric")}),e.jsx("option",{value:"recommendation",children:n("aiSystems.systemTypeOptions.recommendation")}),e.jsx("option",{value:"image_recognition",children:n("aiSystems.systemTypeOptions.image_recognition")}),e.jsx("option",{value:"nlp",children:n("aiSystems.systemTypeOptions.nlp")}),e.jsx("option",{value:"fraud_detection",children:n("aiSystems.systemTypeOptions.fraud_detection")}),e.jsx("option",{value:"autonomous",children:n("aiSystems.systemTypeOptions.autonomous")}),e.jsx("option",{value:"other",children:n("aiSystems.systemTypeOptions.other")})]}),p.system_type&&e.jsx("p",{className:"text-status-error text-xs mt-1",children:p.system_type})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:[n("aiSystems.riskLevel")," *"]}),e.jsxs("select",{value:c.risk_level,onChange:v=>g("risk_level",v.target.value),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary",required:!0,children:[e.jsx("option",{value:"",children:n("common.selectOption")}),e.jsx("option",{value:"low",children:n("aiSystems.riskLevelOptions.low")}),e.jsx("option",{value:"medium",children:n("aiSystems.riskLevelOptions.medium")}),e.jsx("option",{value:"high",children:n("aiSystems.riskLevelOptions.high")})]}),p.risk_level&&e.jsx("p",{className:"text-status-error text-xs mt-1",children:p.risk_level})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:n("aiSystems.status")}),e.jsxs("select",{value:c.status,onChange:v=>g("status",v.target.value),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"active",children:n("aiSystems.statusOptions.active")}),e.jsx("option",{value:"under_review",children:n("aiSystems.statusOptions.under_review")}),e.jsx("option",{value:"inactive",children:n("aiSystems.statusOptions.inactive")}),e.jsx("option",{value:"deprecated",children:n("aiSystems.statusOptions.deprecated")})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:n("aiSystems.description")}),e.jsx("textarea",{value:c.description,onChange:v=>g("description",v.target.value),rows:4,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary resize-none",placeholder:"Opis funkcionalnosti in namena AI sistema..."})]}),p.organization_id&&e.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg",children:e.jsx("p",{className:"text-status-error text-sm",children:p.organization_id})}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-border-subtle",children:[e.jsx("button",{type:"button",onClick:t,className:"px-6 py-2 bg-bg-near-black text-text-primary border border-border-subtle rounded hover:bg-bg-surface-hover transition-colors duration-150",children:n("common.cancel")}),e.jsx("button",{type:"submit",disabled:i,className:"px-6 py-2 bg-accent-primary hover:bg-accent-primary/90 text-white rounded transition-colors duration-150 disabled:opacity-50",children:n(i?"common.saving":"common.save")})]})]})]})}):null}function xE({onNavigate:s}){const{t}=et(),[r,a]=z.useState(""),[n,i]=z.useState(!1),[o,c]=z.useState(!1),p=[{id:1,name:"Chatbot za podporo strankam",type:"Conversational AI",riskLevel:"Medium Risk",status:"Active",lastUpdated:"2024-12-01"},{id:2,name:"Sistem za razpoznavanje obrazov",type:"Biometric Recognition",riskLevel:"High Risk",status:"Under Review",lastUpdated:"2024-11-28"}].filter(g=>g.name.toLowerCase().includes(r.toLowerCase())||g.type.toLowerCase().includes(r.toLowerCase())),m=()=>{console.log("AI system saved successfully")},x=()=>{c(!0)},b=g=>{switch(g){case"Low Risk":return"text-green-500 bg-green-500/10";case"Medium Risk":return"text-yellow-500 bg-yellow-500/10";case"High Risk":return"text-red-500 bg-red-500/10";default:return"text-gray-500 bg-gray-500/10"}},h=g=>{switch(g){case"Low Risk":return t("common.lowRisk");case"Medium Risk":return t("common.mediumRisk");case"High Risk":return t("common.highRisk");default:return g}},j=g=>{switch(g){case"Active":return"text-green-500 bg-green-500/10";case"Under Review":return"text-yellow-500 bg-yellow-500/10";case"Inactive":return"text-red-500 bg-red-500/10";default:return"text-gray-500 bg-gray-500/10"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-bg-surface rounded-lg p-6 border border-border-subtle",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:t("aiSystems.title")}),e.jsx("p",{className:"text-text-secondary",children:t("aiSystems.description","Upravljanje AI sistemov v skladu z AI Act EU")})]}),e.jsx("div",{className:"flex gap-3",children:e.jsxs("button",{onClick:x,className:"px-4 py-2 bg-bg-pure-black text-text-secondary rounded-lg hover:bg-bg-surface-hover transition-colors duration-200",children:[e.jsx(Dt,{className:"w-4 h-4 inline-block mr-2"}),t("aiSystems.addSystem")]})})]})}),e.jsxs("div",{className:"bg-bg-surface rounded-lg p-6 border border-border-subtle",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ss,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-text-tertiary"}),e.jsx("input",{type:"text",placeholder:t("common.search","Ii AI sisteme..."),value:r,onChange:g=>a(g.target.value),className:"w-full pl-10 pr-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("button",{onClick:()=>i(!n),className:"px-4 py-2 bg-accent-primary text-white rounded-lg hover:bg-accent-primary/90 transition-colors duration-200",children:[e.jsx(Wp,{className:"w-4 h-4 inline-block mr-2"}),"Filter"]})]}),n&&e.jsx("div",{className:"border-t border-border-subtle pt-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:t("aiSystems.systemType")}),e.jsxs("select",{className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"",children:t("common.all","Vsi tipi")}),e.jsx("option",{value:"conversational",children:t("aiSystems.systemTypeOptions.conversational")}),e.jsx("option",{value:"biometric",children:t("aiSystems.systemTypeOptions.biometric")}),e.jsx("option",{value:"recommendation",children:t("aiSystems.systemTypeOptions.recommendation")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:t("aiSystems.riskLevel")}),e.jsxs("select",{className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"",children:t("common.all","Vse ravni")}),e.jsx("option",{value:"low",children:t("aiSystems.riskLevelOptions.low")}),e.jsx("option",{value:"medium",children:t("aiSystems.riskLevelOptions.medium")}),e.jsx("option",{value:"high",children:t("aiSystems.riskLevelOptions.high")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:t("aiSystems.status")}),e.jsxs("select",{className:"w-full px-3 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"",children:t("common.all","Vsi statusi")}),e.jsx("option",{value:"active",children:t("aiSystems.statusOptions.active")}),e.jsx("option",{value:"review",children:t("aiSystems.statusOptions.under_review")}),e.jsx("option",{value:"inactive",children:t("aiSystems.statusOptions.inactive")})]})]})]})})]}),e.jsx("div",{className:"bg-bg-surface rounded-lg border border-border-subtle",children:p.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"border-b border-border-subtle",children:e.jsxs("tr",{className:"text-left",children:[e.jsx("th",{className:"px-6 py-4 text-sm font-medium text-text-primary",children:t("aiSystems.systemName")}),e.jsx("th",{className:"px-6 py-4 text-sm font-medium text-text-primary",children:t("aiSystems.systemType")}),e.jsx("th",{className:"px-6 py-4 text-sm font-medium text-text-primary",children:t("aiSystems.riskLevel")}),e.jsx("th",{className:"px-6 py-4 text-sm font-medium text-text-primary",children:t("aiSystems.status")}),e.jsx("th",{className:"px-6 py-4 text-sm font-medium text-text-primary",children:t("common.updatedAt","Zadnja posodobitev")}),e.jsx("th",{className:"px-6 py-4 text-sm font-medium text-text-primary",children:t("common.actions")})]})}),e.jsx("tbody",{children:p.map(g=>e.jsxs("tr",{className:"border-b border-border-subtle hover:bg-bg-near-black/50",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Lh,{className:"w-5 h-5 text-accent-primary"}),e.jsx("span",{className:"font-medium text-text-primary",children:g.name})]})}),e.jsx("td",{className:"px-6 py-4 text-text-secondary",children:g.type}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${b(g.riskLevel)}`,children:h(g.riskLevel)})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${j(g.status)}`,children:g.status})}),e.jsx("td",{className:"px-6 py-4 text-text-secondary",children:g.lastUpdated}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"p-2 text-text-secondary hover:text-accent-primary hover:bg-accent-primary/10 rounded-lg transition-colors",children:e.jsx(lr,{className:"w-4 h-4"})}),e.jsx("button",{className:"p-2 text-text-secondary hover:text-accent-primary hover:bg-accent-primary/10 rounded-lg transition-colors",children:e.jsx(ar,{className:"w-4 h-4"})}),e.jsx("button",{className:"p-2 text-text-secondary hover:text-red-500 hover:bg-red-500/10 rounded-lg transition-colors",children:e.jsx(pr,{className:"w-4 h-4"})})]})})]},g.id))})]})}):e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(Lh,{className:"w-12 h-12 text-text-tertiary mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:r?t("common.noData","Ni rezultatov iskanja"):t("aiSystems.emptyTitle","e ni AI sistemov")}),e.jsx("p",{className:"text-text-secondary mb-6",children:r?t("aiSystems.searchEmpty","Poskusite z drugimi iskalnimi pogoji"):t("aiSystems.emptyDescription","Dodajte svoj prvi AI sistem in zanite upravljati skladnost z AI Act EU")}),!r&&e.jsxs("button",{onClick:x,className:"px-6 py-3 bg-accent-primary text-white rounded-lg hover:bg-accent-primary/90 transition-colors duration-200",children:[e.jsx(Dt,{className:"w-4 h-4 inline-block mr-2"}),t("aiSystems.addSystem")]})]})}),e.jsx(hE,{isOpen:o,onClose:()=>c(!1),onSave:m})]})}function fE({isOpen:s,onClose:t,onSave:r}){const{user:a}=cr(),[n,i]=z.useState(!1),[o,c]=z.useState({title:"",description:"",document_type:"",ai_system:"",status:"draft",version:"v1.0",expiry_date:"",created_date:new Date().toISOString().split("T")[0],organization_id:""}),[d,p]=z.useState({}),[m,x]=z.useState(null),[b,h]=z.useState([]);z.useEffect(()=>{s&&(c({title:"",description:"",document_type:"",ai_system:"",status:"draft",version:"v1.0",expiry_date:"",created_date:new Date().toISOString().split("T")[0],organization_id:(m==null?void 0:m.organization_id)||""}),p({}))},[s,m==null?void 0:m.organization_id]),z.useEffect(()=>{(async()=>{if(!(!a||!s))try{const{data:k,error:P}=await Ne.from("profiles").select("*, organization_id").eq("id",a.id).single();if(P)throw P;x(k)}catch(k){console.error("Error fetching user profile:",k)}})()},[a,s]),z.useEffect(()=>{(async()=>{if(m!=null&&m.organization_id)try{h([{id:1,name:"Chatbot za podporo strankam"},{id:2,name:"Sistem za razpoznavanje obrazov"},{id:3,name:"Priporoilni sistem"},{id:4,name:"Sistem za ocenjevanje tveganj"}])}catch(k){console.error("Error loading AI systems:",k)}})()},[m==null?void 0:m.organization_id]);const j=()=>{const _={};return o.title.trim()||(_.title="Naslov dokumenta je obvezno polje"),o.document_type.trim()||(_.document_type="Tip dokumenta je obvezno polje"),o.ai_system.trim()||(_.ai_system="AI sistem je obvezno polje"),o.expiry_date.trim()||(_.expiry_date="Datum poteka je obvezno polje"),o.expiry_date&&new Date(o.expiry_date)<=new Date&&(_.expiry_date="Datum poteka mora biti v prihodnosti"),(o.organization_id||(m==null?void 0:m.organization_id)||"").trim()||(_.organization_id="ID organizacije je obvezno polje"),p(_),Object.keys(_).length===0},g=async _=>{if(_.preventDefault(),!!j()){i(!0);try{if(!(m!=null&&m.organization_id))throw new Error("Organizacijski kontekst ni na voljo");const k={...o,organization_id:m.organization_id,last_updated:new Date().toISOString().split("T")[0]};console.log("AI Compliance Document data:",k),r(),t()}catch(k){console.error("Napaka pri shranjevanju:",k);const P=k.message||"Napaka pri shranjevanju podatkov";P.includes("Organizacijski kontekst")?alert("Napaka: "+P):alert(P)}finally{i(!1)}}},v=(_,k)=>{c(P=>({...P,[_]:k})),d[_]&&p(P=>({...P,[_]:""}))};return s?e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[70] flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-bg-surface rounded-lg border border-border-subtle w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-border-subtle",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ut,{className:"w-5 h-5 text-accent-primary"}),e.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Dodaj nov dokument skladnosti"})]}),e.jsx("button",{onClick:t,className:"text-text-tertiary hover:text-text-primary transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:g,className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center gap-2",children:[e.jsx(ut,{className:"w-5 h-5"}),"Osnovne informacije"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Naslov dokumenta *"}),e.jsx("input",{type:"text",value:o.title,onChange:_=>v("title",_.target.value),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary",placeholder:"Vnesite naslov dokumenta",required:!0}),d.title&&e.jsx("p",{className:"text-status-error text-xs mt-1",children:d.title})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Tip dokumenta *"}),e.jsxs("select",{value:o.document_type,onChange:_=>v("document_type",_.target.value),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary",required:!0,children:[e.jsx("option",{value:"",children:"Izberite tip dokumenta"}),e.jsx("option",{value:"Technical Documentation",children:"Tehnina dokumentacija"}),e.jsx("option",{value:"Risk Assessment",children:"Ocena tveganja"}),e.jsx("option",{value:"Legal Compliance",children:"Pravna skladnost"}),e.jsx("option",{value:"Compliance Certificate",children:"Skladnostni certifikat"}),e.jsx("option",{value:"GDPR Impact Assessment",children:"GDPR ocena vpliva"}),e.jsx("option",{value:"AI Risk Assessment",children:"AI ocena tveganja"}),e.jsx("option",{value:"Data Protection Impact",children:"Vpliv na varstvo podatkov"}),e.jsx("option",{value:"Ethics Assessment",children:"Etika ocena"})]}),d.document_type&&e.jsx("p",{className:"text-status-error text-xs mt-1",children:d.document_type})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"AI sistem *"}),e.jsxs("select",{value:o.ai_system,onChange:_=>v("ai_system",_.target.value),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary",required:!0,children:[e.jsx("option",{value:"",children:"Izberite AI sistem"}),b.map(_=>e.jsx("option",{value:_.name,children:_.name},_.id))]}),d.ai_system&&e.jsx("p",{className:"text-status-error text-xs mt-1",children:d.ai_system})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center gap-2",children:[e.jsx(er,{className:"w-5 h-5"}),"Podrobnosti dokumenta"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Status"}),e.jsxs("select",{value:o.status,onChange:_=>v("status",_.target.value),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"draft",children:"Osnutek"}),e.jsx("option",{value:"under_review",children:"V pregledu"}),e.jsx("option",{value:"compliant",children:"Skladen"}),e.jsx("option",{value:"needs_update",children:"Potrebuje posodobitev"}),e.jsx("option",{value:"expired",children:"Poteen"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Verzija"}),e.jsx("input",{type:"text",value:o.version,onChange:_=>v("version",_.target.value),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary",placeholder:"v1.0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Datum objave"}),e.jsx("input",{type:"date",value:o.created_date,onChange:_=>v("created_date",_.target.value),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Datum poteka *"}),e.jsx("input",{type:"date",value:o.expiry_date,onChange:_=>v("expiry_date",_.target.value),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary",required:!0}),d.expiry_date&&e.jsx("p",{className:"text-status-error text-xs mt-1",children:d.expiry_date})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Opis dokumenta"}),e.jsx("textarea",{value:o.description,onChange:_=>v("description",_.target.value),rows:4,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary resize-none",placeholder:"Podroben opis vsebine in namena dokumenta skladnosti..."})]}),d.organization_id&&e.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg",children:e.jsx("p",{className:"text-status-error text-sm",children:d.organization_id})}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-border-subtle",children:[e.jsx("button",{type:"button",onClick:t,className:"px-6 py-2 bg-bg-near-black text-text-primary border border-border-subtle rounded hover:bg-bg-surface-hover transition-colors duration-150",children:"Preklii"}),e.jsx("button",{type:"submit",disabled:n,className:"px-6 py-2 bg-accent-primary hover:bg-accent-primary/90 text-white rounded transition-colors duration-150 disabled:opacity-50 flex items-center gap-2",children:n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/20 border-t-white rounded-full animate-spin"}),"Shranjujem..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ut,{className:"w-4 h-4"}),"Shrani dokument"]})})]})]})]})}):null}function bE({isOpen:s,onClose:t,onSave:r}){const{user:a}=cr(),[n,i]=z.useState(!1),[o,c]=z.useState(!1),[d,p]=z.useState({title:"",description:"",document_type:"",ai_system:"",status:"draft",version:"v1.0",expiry_date:"",file_name:"",file_size:0,file_url:"",created_date:new Date().toISOString().split("T")[0],organization_id:""}),[m,x]=z.useState({}),[b,h]=z.useState(null),[j,g]=z.useState([]),[v,_]=z.useState(null),[k,P]=z.useState(!1);z.useEffect(()=>{s&&(p({title:"",description:"",document_type:"",ai_system:"",status:"draft",version:"v1.0",expiry_date:"",file_name:"",file_size:0,file_url:"",created_date:new Date().toISOString().split("T")[0],organization_id:(b==null?void 0:b.organization_id)||""}),x({}),_(null))},[s,b==null?void 0:b.organization_id]),z.useEffect(()=>{(async()=>{if(!(!a||!s))try{const{data:O,error:Z}=await Ne.from("profiles").select("*, organization_id").eq("id",a.id).single();if(Z)throw Z;h(O)}catch(O){console.error("Error fetching user profile:",O)}})()},[a,s]),z.useEffect(()=>{(async()=>{if(b!=null&&b.organization_id)try{g([{id:1,name:"Chatbot za podporo strankam"},{id:2,name:"Sistem za razpoznavanje obrazov"},{id:3,name:"Priporoilni sistem"},{id:4,name:"Sistem za ocenjevanje tveganj"}])}catch(O){console.error("Error loading AI systems:",O)}})()},[b==null?void 0:b.organization_id]);const L=()=>{const C={};return d.title.trim()||(C.title="Naslov dokumenta je obvezno polje"),d.document_type.trim()||(C.document_type="Tip dokumenta je obvezno polje"),d.ai_system.trim()||(C.ai_system="AI sistem je obvezno polje"),d.expiry_date.trim()||(C.expiry_date="Datum poteka je obvezno polje"),v||(C.file="Datoteka je obvezna"),d.expiry_date&&new Date(d.expiry_date)<=new Date&&(C.expiry_date="Datum poteka mora biti v prihodnosti"),v&&v.size>10*1024*1024&&(C.file="Datoteka je prevelika (maksimalno 10MB)"),(d.organization_id||(b==null?void 0:b.organization_id)||"").trim()||(C.organization_id="ID organizacije je obvezno polje"),x(C),Object.keys(C).length===0},F=C=>{if(_(C),p(O=>({...O,file_name:C.name,file_size:C.size})),m.file&&x(O=>({...O,file:""})),!d.title){const O=C.name.replace(/\.[^/.]+$/,"");p(Z=>({...Z,title:O}))}},W=C=>{C.preventDefault(),P(!1);const O=Array.from(C.dataTransfer.files);if(O.length>0){const Z=O[0];Z.type.startsWith("application/")||Z.type.startsWith("text/")||Z.type==="application/pdf"?F(Z):x(te=>({...te,file:"Nepodprt tip datoteke. Podprti formati: PDF, DOC, DOCX, TXT"}))}},R=C=>{const O=C.target.files;O&&O.length>0&&F(O[0])},B=async C=>{if(C.preventDefault(),!!L()){i(!0),c(!0);try{if(!(b!=null&&b.organization_id))throw new Error("Organizacijski kontekst ni na voljo");let O="";v&&(await new Promise(te=>setTimeout(te,2e3)),O=`documents/${v.name}`);const Z={...d,organization_id:b.organization_id,file_url:O,last_updated:new Date().toISOString().split("T")[0]};console.log("AI Compliance Document uploaded:",Z),r(),t()}catch(O){console.error("Napaka pri nalaganju:",O);const Z=O.message||"Napaka pri nalaganju podatkov";Z.includes("Organizacijski kontekst")?alert("Napaka: "+Z):alert(Z)}finally{i(!1),c(!1)}}},A=(C,O)=>{p(Z=>({...Z,[C]:O})),m[C]&&x(Z=>({...Z,[C]:""}))},S=C=>{if(C===0)return"0 Bytes";const O=1024,Z=["Bytes","KB","MB","GB"],te=Math.floor(Math.log(C)/Math.log(O));return parseFloat((C/Math.pow(O,te)).toFixed(2))+" "+Z[te]};return s?e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[70] flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-bg-surface rounded-lg border border-border-subtle w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-border-subtle",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Xa,{className:"w-5 h-5 text-accent-primary"}),e.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Naloi dokument skladnosti"})]}),e.jsx("button",{onClick:t,className:"text-text-tertiary hover:text-text-primary transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:B,className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center gap-2",children:[e.jsx(Xa,{className:"w-5 h-5"}),"Izbor datoteke"]}),v?e.jsx("div",{className:"border border-border-subtle rounded-lg p-4 bg-bg-near-black",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ut,{className:"w-8 h-8 text-accent-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-text-primary font-medium",children:v.name}),e.jsx("p",{className:"text-text-secondary text-sm",children:S(v.size)})]})]}),e.jsx("button",{type:"button",onClick:()=>{_(null),p(C=>({...C,file_name:"",file_size:0}))},className:"text-text-tertiary hover:text-status-error transition-colors",children:e.jsx(Ar,{className:"w-5 h-5"})})]})}):e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${k?"border-accent-primary bg-accent-primary/5":"border-border-subtle hover:border-accent-primary/50"}`,onDrop:W,onDragOver:C=>{C.preventDefault(),P(!0)},onDragLeave:()=>P(!1),children:[e.jsx(Xa,{className:"w-12 h-12 text-text-tertiary mx-auto mb-4"}),e.jsx("p",{className:"text-text-primary mb-2",children:"Povlecite datoteko sem ali kliknite za izbiro"}),e.jsx("p",{className:"text-text-secondary text-sm mb-4",children:"Podprti formati: PDF, DOC, DOCX, TXT (maksimalno 10MB)"}),e.jsx("input",{type:"file",onChange:R,accept:".pdf,.doc,.docx,.txt",className:"hidden",id:"file-upload"}),e.jsx("label",{htmlFor:"file-upload",className:"px-6 py-2 bg-accent-primary text-white rounded-lg hover:bg-accent-primary/90 cursor-pointer transition-colors duration-150 inline-block",children:"Izberite datoteko"})]}),m.file&&e.jsx("p",{className:"text-status-error text-xs mt-2",children:m.file})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center gap-2",children:[e.jsx(ut,{className:"w-5 h-5"}),"Osnovne informacije"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Naslov dokumenta *"}),e.jsx("input",{type:"text",value:d.title,onChange:C=>A("title",C.target.value),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary",placeholder:"Vnesite naslov dokumenta",required:!0}),m.title&&e.jsx("p",{className:"text-status-error text-xs mt-1",children:m.title})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Tip dokumenta *"}),e.jsxs("select",{value:d.document_type,onChange:C=>A("document_type",C.target.value),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary",required:!0,children:[e.jsx("option",{value:"",children:"Izberite tip dokumenta"}),e.jsx("option",{value:"Technical Documentation",children:"Tehnina dokumentacija"}),e.jsx("option",{value:"Risk Assessment",children:"Ocena tveganja"}),e.jsx("option",{value:"Legal Compliance",children:"Pravna skladnost"}),e.jsx("option",{value:"Compliance Certificate",children:"Skladnostni certifikat"}),e.jsx("option",{value:"GDPR Impact Assessment",children:"GDPR ocena vpliva"}),e.jsx("option",{value:"AI Risk Assessment",children:"AI ocena tveganja"}),e.jsx("option",{value:"Data Protection Impact",children:"Vpliv na varstvo podatkov"}),e.jsx("option",{value:"Ethics Assessment",children:"Etika ocena"})]}),m.document_type&&e.jsx("p",{className:"text-status-error text-xs mt-1",children:m.document_type})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"AI sistem *"}),e.jsxs("select",{value:d.ai_system,onChange:C=>A("ai_system",C.target.value),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary",required:!0,children:[e.jsx("option",{value:"",children:"Izberite AI sistem"}),j.map(C=>e.jsx("option",{value:C.name,children:C.name},C.id))]}),m.ai_system&&e.jsx("p",{className:"text-status-error text-xs mt-1",children:m.ai_system})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center gap-2",children:[e.jsx(er,{className:"w-5 h-5"}),"Podrobnosti dokumenta"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Status"}),e.jsxs("select",{value:d.status,onChange:C=>A("status",C.target.value),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"draft",children:"Osnutek"}),e.jsx("option",{value:"under_review",children:"V pregledu"}),e.jsx("option",{value:"compliant",children:"Skladen"}),e.jsx("option",{value:"needs_update",children:"Potrebuje posodobitev"}),e.jsx("option",{value:"expired",children:"Poteen"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Verzija"}),e.jsx("input",{type:"text",value:d.version,onChange:C=>A("version",C.target.value),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary",placeholder:"v1.0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Datum objave"}),e.jsx("input",{type:"date",value:d.created_date,onChange:C=>A("created_date",C.target.value),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Datum poteka *"}),e.jsx("input",{type:"date",value:d.expiry_date,onChange:C=>A("expiry_date",C.target.value),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary",required:!0}),m.expiry_date&&e.jsx("p",{className:"text-status-error text-xs mt-1",children:m.expiry_date})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Opis dokumenta"}),e.jsx("textarea",{value:d.description,onChange:C=>A("description",C.target.value),rows:4,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary resize-none",placeholder:"Podroben opis vsebine in namena dokumenta skladnosti..."})]}),m.organization_id&&e.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg",children:e.jsx("p",{className:"text-status-error text-sm",children:m.organization_id})}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-border-subtle",children:[e.jsx("button",{type:"button",onClick:t,disabled:n,className:"px-6 py-2 bg-bg-near-black text-text-primary border border-border-subtle rounded hover:bg-bg-surface-hover transition-colors duration-150 disabled:opacity-50",children:"Preklii"}),e.jsx("button",{type:"submit",disabled:n||!v,className:"px-6 py-2 bg-accent-primary hover:bg-accent-primary/90 text-white rounded transition-colors duration-150 disabled:opacity-50 flex items-center gap-2",children:n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/20 border-t-white rounded-full animate-spin"}),o?"Nalagam datoteko...":"Shranjujem..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Xa,{className:"w-4 h-4"}),"Naloi dokument"]})})]})]})]})}):null}function gE({onNavigate:s}){const{t}=et(),[r,a]=z.useState(""),[n,i]=z.useState(""),[o,c]=z.useState(!1),[d,p]=z.useState(!1),m=()=>{console.log("AI compliance document saved successfully")},x=[{id:1,title:"AI Act skladnost - Chatbot sistem",type:"Technical Documentation",aiSystem:"Chatbot za podporo strankam",status:"Compliant",uploadDate:"2024-12-01",expiryDate:"2025-12-01",version:"v1.2"},{id:2,title:"Risk Assessment - Prepoznavanje obrazov",type:"Risk Assessment",aiSystem:"Sistem za razpoznavanje obrazov",status:"Under Review",uploadDate:"2024-11-28",expiryDate:"2025-06-28",version:"v1.0"},{id:3,title:"GDPR Impact Assessment",type:"Legal Compliance",aiSystem:"Priporoilni sistem",status:"Needs Update",uploadDate:"2024-10-15",expiryDate:"2024-12-15",version:"v1.1"}],b=x.filter(_=>{const k=_.title.toLowerCase().includes(r.toLowerCase())||_.aiSystem.toLowerCase().includes(r.toLowerCase()),P=!n||_.type===n;return k&&P}),h=_=>{switch(_){case"Compliant":return"text-green-500 bg-green-500/10";case"Under Review":return"text-yellow-500 bg-yellow-500/10";case"Needs Update":return"text-red-500 bg-red-500/10";default:return"text-gray-500 bg-gray-500/10"}},j=_=>{switch(_){case"Compliant":return e.jsx(xi,{className:"w-4 h-4"});case"Under Review":return e.jsx(cs,{className:"w-4 h-4"});case"Needs Update":return e.jsx(er,{className:"w-4 h-4"});default:return e.jsx(ut,{className:"w-4 h-4"})}},g=_=>{const k=new Date(_),P=new Date,L=Math.ceil((k.getTime()-P.getTime())/(1e3*60*60*24));return L<=30&&L>0},v=_=>new Date(_)<new Date;return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-bg-surface rounded-lg p-6 border border-border-subtle",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:"Dokumenti skladnosti"}),e.jsx("p",{className:"text-text-secondary",children:"Upravljanje dokumentov skladnosti z AI Act EU"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>p(!0),className:"px-4 py-2 bg-bg-pure-black text-text-secondary rounded-lg hover:bg-bg-surface-hover transition-colors duration-200",children:[e.jsx(Xa,{className:"w-4 h-4 inline-block mr-2"}),"Naloi dokument"]}),e.jsxs("button",{onClick:()=>c(!0),className:"px-4 py-2 bg-accent-primary text-white rounded-lg hover:bg-accent-primary/90 transition-colors duration-200",children:[e.jsx(Dt,{className:"w-4 h-4 inline-block mr-2"}),"Dodaj dokument"]})]})]})}),e.jsxs("div",{className:"bg-bg-surface rounded-lg p-6 border border-border-subtle",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ss,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-text-tertiary"}),e.jsx("input",{type:"text",placeholder:"Ii dokumente skladnosti...",value:r,onChange:_=>a(_.target.value),className:"w-full pl-10 pr-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("select",{value:n,onChange:_=>i(_.target.value),className:"px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"",children:"Vsi tipi"}),e.jsx("option",{value:"Technical Documentation",children:"Tehnina dokumentacija"}),e.jsx("option",{value:"Risk Assessment",children:"Ocena tveganja"}),e.jsx("option",{value:"Legal Compliance",children:"Pravna skladnost"}),e.jsx("option",{value:"Compliance Certificate",children:"Skladnostni certifikat"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-bg-near-black rounded-lg p-4 border border-border-subtle",children:[e.jsx("div",{className:"text-2xl font-bold text-text-primary",children:x.length}),e.jsx("div",{className:"text-sm text-text-secondary",children:"Skupaj dokumentov"})]}),e.jsxs("div",{className:"bg-bg-near-black rounded-lg p-4 border border-border-subtle",children:[e.jsx("div",{className:"text-2xl font-bold text-green-500",children:x.filter(_=>_.status==="Compliant").length}),e.jsx("div",{className:"text-sm text-text-secondary",children:"Skladni"})]}),e.jsxs("div",{className:"bg-bg-near-black rounded-lg p-4 border border-border-subtle",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-500",children:x.filter(_=>_.status==="Under Review").length}),e.jsx("div",{className:"text-sm text-text-secondary",children:"V pregledu"})]}),e.jsxs("div",{className:"bg-bg-near-black rounded-lg p-4 border border-border-subtle",children:[e.jsx("div",{className:"text-2xl font-bold text-red-500",children:x.filter(_=>_.status==="Needs Update"||v(_.expiryDate)).length}),e.jsx("div",{className:"text-sm text-text-secondary",children:"Potrebna posodobitev"})]})]})]}),e.jsx("div",{className:"bg-bg-surface rounded-lg border border-border-subtle",children:b.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"border-b border-border-subtle",children:e.jsxs("tr",{className:"text-left",children:[e.jsx("th",{className:"px-6 py-4 text-sm font-medium text-text-primary",children:"Naslov"}),e.jsx("th",{className:"px-6 py-4 text-sm font-medium text-text-primary",children:"Tip"}),e.jsx("th",{className:"px-6 py-4 text-sm font-medium text-text-primary",children:"AI sistem"}),e.jsx("th",{className:"px-6 py-4 text-sm font-medium text-text-primary",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-sm font-medium text-text-primary",children:"Potee"}),e.jsx("th",{className:"px-6 py-4 text-sm font-medium text-text-primary",children:"Akcije"})]})}),e.jsx("tbody",{children:b.map(_=>e.jsxs("tr",{className:"border-b border-border-subtle hover:bg-bg-near-black/50",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ut,{className:"w-5 h-5 text-accent-primary"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-text-primary",children:_.title}),e.jsxs("div",{className:"text-sm text-text-secondary",children:["Verzija ",_.version]})]})]})}),e.jsx("td",{className:"px-6 py-4 text-text-secondary",children:_.type}),e.jsx("td",{className:"px-6 py-4 text-text-secondary",children:_.aiSystem}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:`flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${h(_.status)}`,children:[j(_.status),_.status]}),v(_.expiryDate)&&e.jsx("span",{className:"text-xs text-red-500 font-medium",children:"POTEKEL"}),g(_.expiryDate)&&!v(_.expiryDate)&&e.jsx("span",{className:"text-xs text-yellow-500 font-medium",children:"POTEKA"})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-text-secondary",children:_.expiryDate})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"p-2 text-text-secondary hover:text-accent-primary hover:bg-accent-primary/10 rounded-lg transition-colors",children:e.jsx(lr,{className:"w-4 h-4"})}),e.jsx("button",{className:"p-2 text-text-secondary hover:text-accent-primary hover:bg-accent-primary/10 rounded-lg transition-colors",children:e.jsx(Ir,{className:"w-4 h-4"})}),e.jsx("button",{className:"p-2 text-text-secondary hover:text-accent-primary hover:bg-accent-primary/10 rounded-lg transition-colors",children:e.jsx(ar,{className:"w-4 h-4"})}),e.jsx("button",{className:"p-2 text-text-secondary hover:text-red-500 hover:bg-red-500/10 rounded-lg transition-colors",children:e.jsx(pr,{className:"w-4 h-4"})})]})})]},_.id))})]})}):e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(ut,{className:"w-12 h-12 text-text-tertiary mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:r||n?"Ni rezultatov iskanja":"e ni dokumentov skladnosti"}),e.jsx("p",{className:"text-text-secondary mb-6",children:r||n?"Poskusite z drugimi iskalnimi pogoji":"Dodajte dokumente o skladnosti z AI Act EU"}),!r&&!n&&e.jsxs("button",{onClick:()=>c(!0),className:"px-6 py-3 bg-accent-primary text-white rounded-lg hover:bg-accent-primary/90 transition-colors duration-200",children:[e.jsx(Dt,{className:"w-4 h-4 inline-block mr-2"}),"Dodaj dokument"]})]})}),e.jsx(fE,{isOpen:o,onClose:()=>c(!1),onSave:m}),e.jsx(bE,{isOpen:d,onClose:()=>p(!1),onSave:m})]})}function vE({onNavigate:s}){const{t}=et(),[r,a]=z.useState(""),[n,i]=z.useState(""),[o,c]=z.useState(""),d=[{id:1,title:"Chatbot za podporo strankam - Risk Assessment",aiSystem:"Chatbot za podporo strankam",riskLevel:"Medium Risk",riskScore:6.5,status:"Approved",assessDate:"2024-12-01",nextReview:"2025-06-01",risks:[{category:"Data Protection",level:"Medium",score:7},{category:"User Safety",level:"Low",score:3},{category:"Fairness",level:"Medium",score:5}]},{id:2,title:"Razpoznavanje obrazov - Risk Assessment",aiSystem:"Sistem za razpoznavanje obrazov",riskLevel:"High Risk",riskScore:8.2,status:"Under Review",assessDate:"2024-11-28",nextReview:"2025-02-28",risks:[{category:"Fundamental Rights",level:"High",score:9},{category:"Bias & Discrimination",level:"High",score:8},{category:"Data Protection",level:"High",score:8}]},{id:3,title:"Priporoilni sistem - Risk Assessment",aiSystem:"Priporoilni sistem",riskLevel:"Low Risk",riskScore:3.2,status:"Needs Update",assessDate:"2024-10-15",nextReview:"2024-12-15",risks:[{category:"User Safety",level:"Low",score:2},{category:"Fairness",level:"Low",score:4},{category:"Transparency",level:"Medium",score:4}]}],p=d.filter(v=>{const _=v.title.toLowerCase().includes(r.toLowerCase())||v.aiSystem.toLowerCase().includes(r.toLowerCase()),k=!n||v.riskLevel===n,P=!o||v.status===o;return _&&k&&P}),m=(v,_)=>v==="High Risk"||_>=7?"text-red-500 bg-red-500/10":v==="Medium Risk"||_>=4?"text-yellow-500 bg-yellow-500/10":"text-green-500 bg-green-500/10",x=v=>{switch(v){case"Low Risk":return t("common.lowRisk");case"Medium Risk":return t("common.mediumRisk");case"High Risk":return t("common.highRisk");default:return v}},b=v=>{switch(v){case"Approved":return"text-green-500 bg-green-500/10";case"Under Review":return"text-yellow-500 bg-yellow-500/10";case"Needs Update":return"text-red-500 bg-red-500/10";default:return"text-gray-500 bg-gray-500/10"}},h=v=>{switch(v){case"Data Protection":return e.jsx(Mt,{className:"w-4 h-4"});case"Fundamental Rights":return e.jsx(Fa,{className:"w-4 h-4"});case"User Safety":return e.jsx(Rp,{className:"w-4 h-4"});case"Bias & Discrimination":return e.jsx(Fp,{className:"w-4 h-4"});case"Fairness":return e.jsx(Mp,{className:"w-4 h-4"});case"Transparency":return e.jsx(lr,{className:"w-4 h-4"});default:return e.jsx(nS,{className:"w-4 h-4"})}},j=v=>new Date(v)<new Date,g=v=>{const _=new Date(v),k=new Date,P=Math.ceil((_.getTime()-k.getTime())/(1e3*60*60*24));return P<=30&&P>0};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-bg-surface rounded-lg p-6 border border-border-subtle",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:"Ocenjevanje tveganj"}),e.jsx("p",{className:"text-text-secondary",children:"Upravljanje ocen tveganj za AI sisteme v skladu z AI Act EU"})]}),e.jsx("div",{className:"flex gap-3",children:e.jsxs("button",{className:"px-4 py-2 bg-accent-primary text-white rounded-lg hover:bg-accent-primary/90 transition-colors duration-200",children:[e.jsx(Dt,{className:"w-4 h-4 inline-block mr-2"}),"Nova ocena"]})})]})}),e.jsxs("div",{className:"bg-bg-surface rounded-lg p-6 border border-border-subtle",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ss,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-text-tertiary"}),e.jsx("input",{type:"text",placeholder:"Ii ocene tveganj...",value:r,onChange:v=>a(v.target.value),className:"w-full pl-10 pr-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("select",{value:n,onChange:v=>i(v.target.value),className:"px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"",children:"Vse ravni tveganja"}),e.jsx("option",{value:"Low Risk",children:"Nizko tveganje"}),e.jsx("option",{value:"Medium Risk",children:"Srednje tveganje"}),e.jsx("option",{value:"High Risk",children:"Visoko tveganje"})]}),e.jsxs("select",{value:o,onChange:v=>c(v.target.value),className:"px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"",children:"Vsi statusi"}),e.jsx("option",{value:"Approved",children:"Odobreno"}),e.jsx("option",{value:"Under Review",children:"V pregledu"}),e.jsx("option",{value:"Needs Update",children:"Potrebna posodobitev"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-bg-near-black rounded-lg p-4 border border-border-subtle",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(pt,{className:"w-8 h-8 text-red-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-text-primary",children:d.filter(v=>v.riskLevel==="High Risk").length}),e.jsx("div",{className:"text-sm text-text-secondary",children:"Visoko tveganje"})]})]})}),e.jsx("div",{className:"bg-bg-near-black rounded-lg p-4 border border-border-subtle",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(pt,{className:"w-8 h-8 text-yellow-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-text-primary",children:d.filter(v=>v.riskLevel==="Medium Risk").length}),e.jsx("div",{className:"text-sm text-text-secondary",children:"Srednje tveganje"})]})]})}),e.jsx("div",{className:"bg-bg-near-black rounded-lg p-4 border border-border-subtle",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(pt,{className:"w-8 h-8 text-green-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-text-primary",children:d.filter(v=>v.riskLevel==="Low Risk").length}),e.jsx("div",{className:"text-sm text-text-secondary",children:"Nizko tveganje"})]})]})}),e.jsx("div",{className:"bg-bg-near-black rounded-lg p-4 border border-border-subtle",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Mt,{className:"w-8 h-8 text-accent-primary"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-text-primary",children:d.filter(v=>v.status==="Approved").length}),e.jsx("div",{className:"text-sm text-text-secondary",children:"Odobreno"})]})]})})]})]}),e.jsx("div",{className:"bg-bg-surface rounded-lg border border-border-subtle",children:p.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"border-b border-border-subtle",children:e.jsxs("tr",{className:"text-left",children:[e.jsx("th",{className:"px-6 py-4 text-sm font-medium text-text-primary",children:"Ocenjevanje"}),e.jsx("th",{className:"px-6 py-4 text-sm font-medium text-text-primary",children:"AI sistem"}),e.jsx("th",{className:"px-6 py-4 text-sm font-medium text-text-primary",children:"Raven tveganja"}),e.jsx("th",{className:"px-6 py-4 text-sm font-medium text-text-primary",children:"Ocena"}),e.jsx("th",{className:"px-6 py-4 text-sm font-medium text-text-primary",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-sm font-medium text-text-primary",children:"Naslednji pregled"}),e.jsx("th",{className:"px-6 py-4 text-sm font-medium text-text-primary",children:"Akcije"})]})}),e.jsx("tbody",{children:p.map(v=>e.jsxs("tr",{className:"border-b border-border-subtle hover:bg-bg-near-black/50",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(pt,{className:"w-5 h-5 text-accent-primary"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-text-primary",children:v.title}),e.jsxs("div",{className:"text-sm text-text-secondary",children:["Ocena: ",v.assessDate]})]})]})}),e.jsx("td",{className:"px-6 py-4 text-text-secondary",children:v.aiSystem}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${m(v.riskLevel,v.riskScore)}`,children:x(v.riskLevel)})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"text-sm font-medium text-text-primary",children:[v.riskScore,"/10"]}),e.jsx("div",{className:"w-16 bg-bg-near-black rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${v.riskScore>=7?"bg-red-500":v.riskScore>=4?"bg-yellow-500":"bg-green-500"}`,style:{width:`${v.riskScore/10*100}%`}})})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${b(v.status)}`,children:v.status})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:`text-sm ${j(v.nextReview)?"text-red-500 font-medium":g(v.nextReview)?"text-yellow-500 font-medium":"text-text-secondary"}`,children:[v.nextReview,j(v.nextReview)&&e.jsx("div",{className:"text-xs",children:"ZAMUJENO"}),g(v.nextReview)&&!j(v.nextReview)&&e.jsx("div",{className:"text-xs",children:"KMALU"})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"p-2 text-text-secondary hover:text-accent-primary hover:bg-accent-primary/10 rounded-lg transition-colors",children:e.jsx(lr,{className:"w-4 h-4"})}),e.jsx("button",{className:"p-2 text-text-secondary hover:text-accent-primary hover:bg-accent-primary/10 rounded-lg transition-colors",children:e.jsx(ar,{className:"w-4 h-4"})}),e.jsx("button",{className:"p-2 text-text-secondary hover:text-red-500 hover:bg-red-500/10 rounded-lg transition-colors",children:e.jsx(pr,{className:"w-4 h-4"})})]})})]},v.id))})]})}):e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(pt,{className:"w-12 h-12 text-text-tertiary mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:r||n||o?"Ni rezultatov iskanja":"e ni ocen tveganj"}),e.jsx("p",{className:"text-text-secondary mb-6",children:r||n||o?"Poskusite z drugimi iskalnimi pogoji":"Ustvarite ocene tveganj za vae AI sisteme"}),!r&&!n&&!o&&e.jsxs("button",{className:"px-6 py-3 bg-accent-primary text-white rounded-lg hover:bg-accent-primary/90 transition-colors duration-200",children:[e.jsx(Dt,{className:"w-4 h-4 inline-block mr-2"}),"Nova ocena"]})]})}),p.length>0&&e.jsxs("div",{className:"bg-bg-surface rounded-lg border border-border-subtle",children:[e.jsx("div",{className:"px-6 py-4 border-b border-border-subtle",children:e.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Pregled kategorij tveganj"})}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:["Data Protection","Fundamental Rights","User Safety","Bias & Discrimination","Fairness","Transparency"].map(v=>e.jsxs("div",{className:"bg-bg-near-black rounded-lg p-4 border border-border-subtle",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[h(v),e.jsx("span",{className:"font-medium text-text-primary",children:v})]}),e.jsxs("div",{className:"text-sm text-text-secondary",children:[d.reduce((_,k)=>{const P=k.risks.find(L=>L.category===v);return _+(P?P.score:0)},0)/d.length," povprena ocena"]})]},v))})})]})]})}function yE({onNavigate:s}){const{t}=et(),[r,a]=z.useState(""),[n,i]=z.useState(""),[o,c]=z.useState("overview"),d=[{id:1,title:"Chatbot dokumentacija - Preglednost",aiSystem:"Chatbot za podporo strankam",type:"System Documentation",status:"Published",publishDate:"2024-12-01",lastUpdate:"2024-12-01",visibility:"Public",categories:["Data Sources","Algorithm Overview","Performance Metrics"]},{id:2,title:"Biometrini sistem - Transparentnost",aiSystem:"Sistem za razpoznavanje obrazov",type:"Risk Disclosure",status:"Draft",publishDate:null,lastUpdate:"2024-11-28",visibility:"Internal",categories:["Data Protection","Accuracy Rates","False Positive Rates"]},{id:3,title:"Priporoilni algoritem - Javna razkritja",aiSystem:"Priporoilni sistem",type:"Public Disclosure",status:"Under Review",publishDate:null,lastUpdate:"2024-11-15",visibility:"Public",categories:["User Data Usage","Algorithm Logic","Personalization Factors"]}],p=d.filter(g=>{const v=g.title.toLowerCase().includes(r.toLowerCase())||g.aiSystem.toLowerCase().includes(r.toLowerCase()),_=!n||g.type===n;return v&&_}),m=g=>{switch(g){case"Published":return"text-green-500 bg-green-500/10";case"Under Review":return"text-yellow-500 bg-yellow-500/10";case"Draft":return"text-gray-500 bg-gray-500/10";case"Archived":return"text-red-500 bg-red-500/10";default:return"text-gray-500 bg-gray-500/10"}},x=g=>{switch(g){case"Published":return e.jsx(Rt,{className:"w-4 h-4"});case"Under Review":return e.jsx(cs,{className:"w-4 h-4"});case"Draft":return e.jsx(ut,{className:"w-4 h-4"});case"Archived":return e.jsx(er,{className:"w-4 h-4"});default:return e.jsx(ut,{className:"w-4 h-4"})}},b=g=>{switch(g){case"Public":return"text-blue-500 bg-blue-500/10";case"Internal":return"text-orange-500 bg-orange-500/10";case"Restricted":return"text-red-500 bg-red-500/10";default:return"text-gray-500 bg-gray-500/10"}},h=g=>{switch(g){case"Data Sources":return e.jsx(_u,{className:"w-4 h-4"});case"Algorithm Overview":return e.jsx(Fp,{className:"w-4 h-4"});case"Performance Metrics":return e.jsx(Bi,{className:"w-4 h-4"});case"Data Protection":return e.jsx(Mt,{className:"w-4 h-4"});case"Accuracy Rates":return e.jsx(Bi,{className:"w-4 h-4"});case"False Positive Rates":return e.jsx(er,{className:"w-4 h-4"});case"User Data Usage":return e.jsx(Fa,{className:"w-4 h-4"});case"Algorithm Logic":return e.jsx(fi,{className:"w-4 h-4"});case"Personalization Factors":return e.jsx(Fp,{className:"w-4 h-4"});default:return e.jsx(Xy,{className:"w-4 h-4"})}},j={totalRecords:d.length,published:d.filter(g=>g.status==="Published").length,publicRecords:d.filter(g=>g.visibility==="Public").length,draftRecords:d.filter(g=>g.status==="Draft").length};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-bg-surface rounded-lg p-6 border border-border-subtle",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:"Preglednost AI sistemov"}),e.jsx("p",{className:"text-text-secondary",children:"Upravljanje preglednosti in javnih razkritij AI sistemov v skladu z AI Act EU"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{className:"px-4 py-2 bg-bg-pure-black text-text-secondary rounded-lg hover:bg-bg-surface-hover transition-colors duration-200",children:[e.jsx(Ir,{className:"w-4 h-4 inline-block mr-2"}),"Izvozi poroilo"]}),e.jsxs("button",{className:"px-4 py-2 bg-accent-primary text-white rounded-lg hover:bg-accent-primary/90 transition-colors duration-200",children:[e.jsx(Dt,{className:"w-4 h-4 inline-block mr-2"}),"Novo razkritje"]})]})]})}),e.jsxs("div",{className:"bg-bg-surface rounded-lg border border-border-subtle",children:[e.jsx("div",{className:"border-b border-border-subtle",children:e.jsx("nav",{className:"flex space-x-8 px-6",children:[{id:"overview",label:"Pregled",icon:Bi},{id:"records",label:"Zapisi preglednosti",icon:ut},{id:"compliance",label:"Skladnost",icon:Mt}].map(g=>{const v=g.icon;return e.jsxs("button",{onClick:()=>c(g.id),className:`
                    flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200
                    ${o===g.id?"border-accent-primary text-accent-primary":"border-transparent text-text-secondary hover:text-text-primary hover:border-text-tertiary"}
                  `,children:[e.jsx(v,{className:"w-4 h-4"}),g.label]},g.id)})})}),e.jsxs("div",{className:"p-6",children:[o==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-bg-near-black rounded-lg p-4 border border-border-subtle",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ut,{className:"w-8 h-8 text-accent-primary"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-text-primary",children:j.totalRecords}),e.jsx("div",{className:"text-sm text-text-secondary",children:"Skupaj zapisov"})]})]})}),e.jsx("div",{className:"bg-bg-near-black rounded-lg p-4 border border-border-subtle",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Rt,{className:"w-8 h-8 text-green-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-text-primary",children:j.published}),e.jsx("div",{className:"text-sm text-text-secondary",children:"Objavljeno"})]})]})}),e.jsx("div",{className:"bg-bg-near-black rounded-lg p-4 border border-border-subtle",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(lr,{className:"w-8 h-8 text-blue-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-text-primary",children:j.publicRecords}),e.jsx("div",{className:"text-sm text-text-secondary",children:"Javni zapisi"})]})]})}),e.jsx("div",{className:"bg-bg-near-black rounded-lg p-4 border border-border-subtle",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ut,{className:"w-8 h-8 text-gray-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-text-primary",children:j.draftRecords}),e.jsx("div",{className:"text-sm text-text-secondary",children:"Osnutki"})]})]})})]}),e.jsxs("div",{className:"bg-bg-near-black rounded-lg p-6 border border-border-subtle",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Pregled skladnosti z AI Act EU"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-bg-surface rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Mt,{className:"w-5 h-5 text-green-500"}),e.jsx("span",{className:"font-medium text-text-primary",children:"Obvezne informacije"})]}),e.jsx("span",{className:"text-green-500 text-sm font-medium",children:"Skladno"})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-bg-surface rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Fa,{className:"w-5 h-5 text-yellow-500"}),e.jsx("span",{className:"font-medium text-text-primary",children:"Obvestila uporabnikom"})]}),e.jsx("span",{className:"text-yellow-500 text-sm font-medium",children:"Delno skladno"})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-bg-surface rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Bi,{className:"w-5 h-5 text-green-500"}),e.jsx("span",{className:"font-medium text-text-primary",children:"Metrike uinkovitosti"})]}),e.jsx("span",{className:"text-green-500 text-sm font-medium",children:"Skladno"})]})]})]}),e.jsx("div",{className:"bg-accent-primary/10 border border-accent-primary/20 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Xy,{className:"w-5 h-5 text-accent-primary mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-accent-primary mb-2",children:"Zahteve AI Act EU za preglednost"}),e.jsx("p",{className:"text-text-secondary text-sm mb-3",children:"AI sistemi morajo zagotoviti ustrezno preglednost skladno z AI Act EU. To vkljuuje:"}),e.jsxs("ul",{className:"text-text-secondary text-sm space-y-1 ml-4",children:[e.jsx("li",{children:" Dokumentacijo algoritmov in procesov odloanja"}),e.jsx("li",{children:" Informacije o podatkih, ki se uporabljajo za usposabljanje"}),e.jsx("li",{children:" Metrike uinkovitosti in omejitve sistema"}),e.jsx("li",{children:" Obvestila uporabnikom o interakciji z AI sistemom"}),e.jsx("li",{children:" Dostop do dokumentacije za nadzorne organe"})]})]})]})})]}),o==="records"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ss,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-text-tertiary"}),e.jsx("input",{type:"text",placeholder:"Ii zapise preglednosti...",value:r,onChange:g=>a(g.target.value),className:"w-full pl-10 pr-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("select",{value:n,onChange:g=>i(g.target.value),className:"px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"",children:"Vsi tipi"}),e.jsx("option",{value:"System Documentation",children:"Sistemska dokumentacija"}),e.jsx("option",{value:"Risk Disclosure",children:"Razkritje tveganj"}),e.jsx("option",{value:"Public Disclosure",children:"Javno razkritje"}),e.jsx("option",{value:"User Notification",children:"Obvestilo uporabnikom"})]})]}),p.length>0?e.jsx("div",{className:"space-y-4",children:p.map(g=>e.jsx("div",{className:"bg-bg-near-black rounded-lg p-6 border border-border-subtle",children:e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(Mt,{className:"w-5 h-5 text-accent-primary"}),e.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:g.title}),e.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${m(g.status)}`,children:[x(g.status),e.jsx("span",{className:"ml-1",children:g.status})]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${b(g.visibility)}`,children:g.visibility})]}),e.jsxs("div",{className:"text-text-secondary mb-3",children:["AI sistem: ",e.jsx("span",{className:"text-text-primary",children:g.aiSystem}),"  Tip: ",e.jsx("span",{className:"text-text-primary",children:g.type})," ",g.publishDate?e.jsxs(e.Fragment,{children:["Objavljeno: ",e.jsx("span",{className:"text-text-primary",children:g.publishDate})]}):e.jsxs(e.Fragment,{children:["Zadnja posodobitev: ",e.jsx("span",{className:"text-text-primary",children:g.lastUpdate})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:g.categories.map((v,_)=>e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-bg-surface rounded text-xs text-text-secondary",children:[h(v),e.jsx("span",{children:v})]},_))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"p-2 text-text-secondary hover:text-accent-primary hover:bg-accent-primary/10 rounded-lg transition-colors",children:e.jsx(lr,{className:"w-4 h-4"})}),e.jsx("button",{className:"p-2 text-text-secondary hover:text-accent-primary hover:bg-accent-primary/10 rounded-lg transition-colors",children:e.jsx(Ir,{className:"w-4 h-4"})})]})]})},g.id))}):e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(Mt,{className:"w-12 h-12 text-text-tertiary mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:r||n?"Ni rezultatov iskanja":"e ni zapisov preglednosti"}),e.jsx("p",{className:"text-text-secondary mb-6",children:r||n?"Poskusite z drugimi iskalnimi pogoji":"Ustvarite prve zapise preglednosti za vae AI sisteme"}),!r&&!n&&e.jsxs("button",{className:"px-6 py-3 bg-accent-primary text-white rounded-lg hover:bg-accent-primary/90 transition-colors duration-200",children:[e.jsx(Dt,{className:"w-4 h-4 inline-block mr-2"}),"Novo razkritje"]})]})]}),o==="compliance"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-bg-near-black rounded-lg p-6 border border-border-subtle",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Skladnostna kontrolna lista"}),e.jsx("div",{className:"space-y-4",children:[{requirement:"Dokumentacija algoritmov",status:"completed",description:"Vsi AI sistemi imajo dokumentirane algoritme"},{requirement:"Informacije o podatkih",status:"completed",description:"Dokumentirani viri in uporaba podatkov"},{requirement:"Metrike uinkovitosti",status:"in-progress",description:"Metrike so definirane, vendar niso popolne"},{requirement:"Obvestila uporabnikom",status:"pending",description:"Potrebno implementirati obvestila v uporabniki vmesnik"},{requirement:"Dostop nadzornih organov",status:"completed",description:"Nadzorni organi imajo dostop do dokumentacije"}].map((g,v)=>e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-bg-surface rounded-lg",children:[e.jsxs("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${g.status==="completed"?"bg-green-500":g.status==="in-progress"?"bg-yellow-500":"bg-gray-500"}`,children:[g.status==="completed"&&e.jsx(Rt,{className:"w-4 h-4 text-white"}),g.status==="in-progress"&&e.jsx(cs,{className:"w-4 h-4 text-white"}),g.status==="pending"&&e.jsx(er,{className:"w-4 h-4 text-white"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-text-primary",children:g.requirement}),e.jsx("div",{className:"text-sm text-text-secondary",children:g.description})]}),e.jsx("div",{className:`px-3 py-1 rounded text-sm font-medium ${g.status==="completed"?"text-green-500 bg-green-500/10":g.status==="in-progress"?"text-yellow-500 bg-yellow-500/10":"text-gray-500 bg-gray-500/10"}`,children:g.status==="completed"?"Zakljueno":g.status==="in-progress"?"V teku":"Na akanju"})]},v))})]}),e.jsxs("div",{className:"bg-accent-primary/10 border border-accent-primary/20 rounded-lg p-6",children:[e.jsx("h3",{className:"font-medium text-accent-primary mb-4",children:"Priporoena dejanja"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-2 bg-yellow-500 rounded-full"}),e.jsx("span",{className:"text-sm text-text-secondary",children:"Dopolnite metrike uinkovitosti za vse AI sisteme"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),e.jsx("span",{className:"text-sm text-text-secondary",children:"Implementirajte obvestila uporabnikom v uporabniki vmesnik"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-sm text-text-secondary",children:"Preverite javno dostopne dokumente za skladnost"})]})]})]})]})]})]})]})}const A_={prejeta:{icon:cs,color:"text-blue-400",bg:"bg-blue-500/10",border:"border-blue-500/30",label:"Prejeta"},"v obravnavi":{icon:pt,color:"text-orange-400",bg:"bg-orange-500/10",border:"border-orange-500/30",label:"V obravnavi"},reena:{icon:xi,color:"text-green-400",bg:"bg-green-500/10",border:"border-green-500/30",label:"Reena"},zavrnjena:{icon:pt,color:"text-red-400",bg:"bg-red-500/10",border:"border-red-500/30",label:"Zavrnjena"}},O_={korupcija:{color:"text-red-400",bg:"bg-red-500/10",border:"border-red-500/30"},goljufija:{color:"text-orange-400",bg:"bg-orange-500/10",border:"border-orange-500/30"},"prekoraitev pooblastil":{color:"text-yellow-400",bg:"bg-yellow-500/10",border:"border-yellow-500/30"},diskriminacija:{color:"text-purple-400",bg:"bg-purple-500/10",border:"border-purple-500/30"},mobing:{color:"text-pink-400",bg:"bg-pink-500/10",border:"border-pink-500/30"},drugo:{color:"text-gray-400",bg:"bg-gray-500/10",border:"border-gray-500/30"}},D_=[{id:"demo-1",stevilo_prijave:"ZP-2025-001",datum_prijave:"2025-11-01T10:30:00Z",kratek_opis:"Sum korupcije pri dodeljevanju javnih naroil - neupravieno favorisiranje doloenega ponudnika",podrocje:"korupcija",narava_prijave:"anomalija v postopku javnega naroanja",anonimna:!1,status:"v obravnavi",datum_potrditev:"2025-11-11T10:30:00Z",datum_resitve:"2025-11-12T10:30:00Z",odgovorna_oseba:"Marko Novak",zaupnik_id:"zaupnik-1",zaupnik:{ime:"Ana",priimek:"Kova"}},{id:"demo-2",stevilo_prijave:"ZP-2025-002",datum_prijave:"2025-11-05T14:15:00Z",kratek_opis:"Sistemski mobing s strani neposredno nadrejenega - psihino nadlegovanje in izolacija",podrocje:"mobing",narava_prijave:"nesprejemljivo vedenje na delovnem mestu",anonimna:!0,status:"prejeta",datum_potrditev:"2025-11-11T14:15:00Z",datum_resitve:"2025-11-12T14:15:00Z",odgovorna_oseba:"Tanja Horvat",zaupnik_id:"zaupnik-2",zaupnik:{ime:"Petra",priimek:"Potonik"}},{id:"demo-3",stevilo_prijave:"ZP-2025-003",datum_prijave:"2025-11-06T09:45:00Z",kratek_opis:"Prekoraitev pooblastil pri zaposlovanju - neupravieno favorisiranje sorodnikov",podrocje:"prekoraitev pooblastil",narava_prijave:"nepravilnosti v lovekih virih",anonimna:!1,status:"prejeta",datum_potrditev:"2025-11-11T09:45:00Z",datum_resitve:"2025-11-12T09:45:00Z",odgovorna_oseba:"Janez Krnc",zaupnik_id:"zaupnik-1",zaupnik:{ime:"Ana",priimek:"Kova"}}];function tu({onNavigate:s}){const{t}=et(),[r,a]=z.useState([]),[n,i]=z.useState(!0);z.useEffect(()=>{o()},[]);const o=async()=>{try{i(!0);const{data:h,error:j}=await Ne.from("zzzpri_prijave").select(`
          *,
          zaupnik:zzzpri_zaupniki(ime, priimek)
        `).order("datum_prijave",{ascending:!1});if(j)throw j;!h||h.length===0?a(D_):a(h)}catch(h){console.error("Error loading prijave:",h),a(D_)}finally{i(!1)}},c=h=>{if(!h)return"-";try{const j=new Date(h);return isNaN(j.getTime())?"-":j.toLocaleDateString("sl-SI",{year:"numeric",month:"2-digit",day:"2-digit"})}catch{return"-"}},d=h=>A_[h]||A_.prejeta,p=h=>O_[h]||O_.drugo,m=h=>new Date(h)<new Date,x=h=>{const j=new Date(h),g=new Date,v=j.getTime()-g.getTime();return Math.ceil(v/(1e3*60*60*24))},b=r.filter(h=>{if(h.datum_potrditev&&x(h.datum_potrditev)<3)return!0;if(h.datum_resitve){const j=x(h.datum_resitve);if(j<3&&j>=0)return!0}return!1});return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:"Zakon o zaiti prijaviteljev (ZZPri)"}),e.jsx("p",{className:"text-body text-text-secondary",children:"Upravljanje prijav in zagotavljanje skladnosti z ZZPri zakonom. Evidence prijav, zaupnikov, postopkov in letna poroila KPK."})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("div",{className:"w-20 h-20 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center shadow-lg",children:e.jsx(Mt,{className:"w-10 h-10 text-white"})})})]}),e.jsxs("div",{className:"bg-red-500/5 border-2 border-red-500/30 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-red-500/20 border border-red-500/40 flex items-center justify-center",children:e.jsx(pt,{className:"w-6 h-6 text-red-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-heading-lg font-semibold text-red-400",children:"Opozorilo o kritinih rokih"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Prijave, ki potrebujejo takojnjo pozornost zaradi bliajoih se rokov"})]})]}),n?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-red-400"}),e.jsx("span",{className:"ml-2 text-body-sm text-text-secondary",children:"Nalaganje..."})]}):b.length>0?e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-red-500/10 border-b border-red-500/20",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-semibold text-red-400",children:"ID"}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-semibold text-red-400",children:"Naslov"}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-semibold text-red-400",children:"Tip prijave"}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-semibold text-red-400",children:"Rok"}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-semibold text-red-400",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-semibold text-red-400",children:"Akcije"})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:b.map(h=>{const j=d(h.status),g=p(h.podrocje),v=j.icon;let _="",k="",P="";if(h.datum_potrditev)try{const L=new Date(h.datum_potrditev);if(!isNaN(L.getTime())){const F=x(h.datum_potrditev);F>=0&&(_=`${F} dni`,k=h.datum_potrditev,P="Potrditev")}}catch{console.warn("Invalid date for potrditev:",h.datum_potrditev)}if(h.datum_resitve)try{const L=new Date(h.datum_resitve);if(!isNaN(L.getTime())){const F=x(h.datum_resitve);F>=0&&(F<parseInt(_)||!_)&&(_=`${F} dni`,k=h.datum_resitve,P="Reitev")}}catch{console.warn("Invalid date for resitve:",h.datum_resitve)}return e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"font-mono text-body-sm text-text-primary",children:h.stevilo_prijave})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("p",{className:"text-body-sm text-text-primary line-clamp-2 max-w-xs",children:h.kratek_opis})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-lg text-body-sm font-medium ${g.bg} ${g.border} ${g.color} border`,children:h.podrocje})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:`text-body-xs font-medium ${m(k)?"text-red-400":"text-orange-400"}`,children:_}),e.jsxs("div",{className:"text-body-xs text-text-tertiary",children:[P,": ",c(k)]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1 rounded-lg ${j.bg} ${j.border} border`,children:[e.jsx(v,{className:`w-4 h-4 ${j.color}`}),e.jsx("span",{className:`text-body-sm font-medium ${j.color}`,children:j.label})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("button",{onClick:()=>s==null?void 0:s("zzzpri-prijave"),className:"inline-flex items-center gap-1 px-3 py-1 text-body-xs font-medium text-red-400 hover:text-red-300 hover:bg-red-500/10 rounded-lg transition-colors duration-200",children:[e.jsx(lr,{className:"w-4 h-4"}),"Pregled"]})})]},h.id)})})]})})}):e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-8 text-center",children:[e.jsx(_a,{className:"w-12 h-12 text-green-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-heading-md font-medium text-text-primary mb-2",children:"Ni opozoril za bliajoe roke"}),e.jsx("p",{className:"text-body text-text-secondary",children:"Vsi roki so ustrezno razporejeni. Odlino delo!"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-bg-surface p-4 rounded-lg border border-border-subtle",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-500/10 border border-blue-500/30 flex items-center justify-center",children:e.jsx(ut,{className:"w-5 h-5 text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Skupaj prijav"}),e.jsx("p",{className:"text-heading-lg font-semibold text-text-primary",children:r.length})]})]})}),e.jsx("div",{className:"bg-bg-surface p-4 rounded-lg border border-border-subtle",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-green-500/10 border border-green-500/30 flex items-center justify-center",children:e.jsx(Mt,{className:"w-5 h-5 text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Aktivni zaupniki"}),e.jsx("p",{className:"text-heading-lg font-semibold text-text-primary",children:"3"})]})]})}),e.jsx("div",{className:"bg-bg-surface p-4 rounded-lg border border-border-subtle",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-orange-500/10 border border-orange-500/30 flex items-center justify-center",children:e.jsx(Sf,{className:"w-5 h-5 text-orange-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-body-sm text-text-secondary",children:"V obravnavi"}),e.jsx("p",{className:"text-heading-lg font-semibold text-text-primary",children:r.filter(h=>h.status==="v obravnavi").length})]})]})}),e.jsx("div",{className:"bg-bg-surface p-4 rounded-lg border border-border-subtle",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-red-500/10 border border-red-500/30 flex items-center justify-center",children:e.jsx(pt,{className:"w-5 h-5 text-red-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Kritini roki"}),e.jsx("p",{className:"text-heading-lg font-semibold text-red-400",children:b.length})]})]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[{id:"zzzpri-prijave",title:"Evidence prijav",description:"Pregled, vnos in upravljanje prijav po ZZPri zakonu",icon:ut,iconColor:"text-blue-400",bgColor:"bg-blue-500/10",borderColor:"border-blue-500/30"},{id:"zzzpri-zaupniki",title:"Upravljanje zaupnikov",description:"Evidence zaupnikov in njihovih podatkov",icon:Fa,iconColor:"text-green-400",bgColor:"bg-green-500/10",borderColor:"border-green-500/30"},{id:"zzzpri-obrazci",title:"Nova prijava",description:"Generiranje in upravljanje obrazcev za prijave",icon:ul,iconColor:"text-purple-400",bgColor:"bg-purple-500/10",borderColor:"border-purple-500/30"},{id:"zzzpri-postopki",title:"Sledenje postopkom",description:"Pregled izvajanja postopkov in rokov",icon:Sf,iconColor:"text-orange-400",bgColor:"bg-orange-500/10",borderColor:"border-orange-500/30"},{id:"zzzpri-porocila",title:"Letna poroila KPK",description:"Priprava in poiljanje letnih poroil na KPK",icon:xi,iconColor:"text-red-400",bgColor:"bg-red-500/10",borderColor:"border-red-500/30"},{id:"zzzpri-statistike",title:"Statistike",description:"Analiza podatkov o prijavah in postopkih",icon:Bi,iconColor:"text-cyan-400",bgColor:"bg-cyan-500/10",borderColor:"border-cyan-500/30"},{id:"zzzpri-dokumentacija",title:"Dokumentacija",description:"Upravljanje dokumentacije v zvezi z ZZPri zakonom",icon:hi,iconColor:"text-indigo-400",bgColor:"bg-indigo-500/10",borderColor:"border-indigo-500/30"},{id:"zzzpri-navodila",title:"Navodila in prironiki",description:"Detajlna navodila za uporabo ZZPri sistema in prironiki",icon:ut,iconColor:"text-teal-400",bgColor:"bg-teal-500/10",borderColor:"border-teal-500/30"},{id:"zzzpri-nastavitve",title:"Nastavitve",description:"Konfiguracija ZZPri modula in notifikacij",icon:fi,iconColor:"text-yellow-400",bgColor:"bg-yellow-500/10",borderColor:"border-yellow-500/30"}].map(h=>{const j=h.icon;return e.jsxs("button",{onClick:()=>s==null?void 0:s(h.id),className:"bg-bg-surface p-6 rounded-lg border border-border-subtle hover:border-accent-primary/50 transition-all duration-200 text-left group hover:bg-bg-surface-hover",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg ${h.bgColor} border ${h.borderColor} flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-200`,children:e.jsx(j,{className:`w-6 h-6 ${h.iconColor}`})}),e.jsx("h3",{className:"text-heading-md font-semibold text-text-primary mb-2",children:h.title}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:h.description})]},h.id)})}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-500/10 to-purple-500/10 border border-blue-500/20 rounded-lg p-6",children:[e.jsx("h3",{className:"text-heading-lg font-semibold text-text-primary mb-4",children:"Hitre akcije"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("button",{onClick:()=>s==null?void 0:s("zzzpri-obrazci"),className:"bg-bg-surface/50 backdrop-blur-sm p-4 rounded-lg border border-border-subtle hover:border-accent-primary/50 transition-all duration-200 text-left",children:[e.jsx(ul,{className:"w-8 h-8 text-blue-400 mb-2"}),e.jsx("h4",{className:"font-semibold text-text-primary mb-1",children:"Nova prijava"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Vnesi novo prijavo po ZZPri"})]}),e.jsxs("button",{onClick:()=>s==null?void 0:s("zzzpri-postopki"),className:"bg-bg-surface/50 backdrop-blur-sm p-4 rounded-lg border border-border-subtle hover:border-accent-primary/50 transition-all duration-200 text-left",children:[e.jsx(Sf,{className:"w-8 h-8 text-orange-400 mb-2"}),e.jsx("h4",{className:"font-semibold text-text-primary mb-1",children:"Preveri roke"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Pregled rokov in opomnikov"})]}),e.jsxs("button",{onClick:()=>s==null?void 0:s("zzzpri-porocila"),className:"bg-bg-surface/50 backdrop-blur-sm p-4 rounded-lg border border-border-subtle hover:border-accent-primary/50 transition-all duration-200 text-left",children:[e.jsx(xi,{className:"w-8 h-8 text-green-400 mb-2"}),e.jsx("h4",{className:"font-semibold text-text-primary mb-1",children:"Letno poroilo"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Generiraj poroilo za KPK"})]})]})]})]})}const E_={prejeta:{icon:cs,color:"text-blue-400",bg:"bg-blue-500/10",border:"border-blue-500/30",label:"Prejeta"},"v obravnavi":{icon:er,color:"text-orange-400",bg:"bg-orange-500/10",border:"border-orange-500/30",label:"V obravnavi"},reena:{icon:Rt,color:"text-green-400",bg:"bg-green-500/10",border:"border-green-500/30",label:"Reena"},zavrnjena:{icon:Ss,color:"text-red-400",bg:"bg-red-500/10",border:"border-red-500/30",label:"Zavrnjena"}},I_={korupcija:{color:"text-red-400",bg:"bg-red-500/10",border:"border-red-500/30"},goljufija:{color:"text-orange-400",bg:"bg-orange-500/10",border:"border-orange-500/30"},"prekoraitev pooblastil":{color:"text-yellow-400",bg:"bg-yellow-500/10",border:"border-yellow-500/30"},diskriminacija:{color:"text-purple-400",bg:"bg-purple-500/10",border:"border-purple-500/30"},mobing:{color:"text-pink-400",bg:"bg-pink-500/10",border:"border-pink-500/30"},drugo:{color:"text-gray-400",bg:"bg-gray-500/10",border:"border-gray-500/30"}},L_=[{id:"demo-1",stevilo_prijave:"ZZPRI-2025-001",datum_prijave:"2025-11-01T10:30:00Z",kratek_opis:"Sum korupcije pri dodeljevanju javnih naroil - neupravieno favorisiranje doloenega ponudnika",podrocje:"korupcija",narava_prijave:"anomalija v postopku javnega naroanja",anonimna:!1,status:"v obravnavi",datum_potrditev:"2025-11-11T10:30:00Z",datum_resitve:"2025-11-12T10:30:00Z",odgovorna_oseba:"Marko Novak",zaupnik_id:"zaupnik-1",zaupnik:{ime:"Ana",priimek:"Kova"}},{id:"demo-2",stevilo_prijave:"ZZPRI-2025-002",datum_prijave:"2025-11-05T14:15:00Z",kratek_opis:"Sistemski mobing s strani neposredno nadrejenega - psihino nadlegovanje in izolacija",podrocje:"mobing",narava_prijave:"nesprejemljivo vedenje na delovnem mestu",anonimna:!0,status:"prejeta",datum_potrditev:"2025-11-11T14:15:00Z",datum_resitve:"2025-11-12T14:15:00Z",odgovorna_oseba:"Tanja Horvat",zaupnik_id:"zaupnik-2",zaupnik:{ime:"Petra",priimek:"Potonik"}},{id:"demo-3",stevilo_prijave:"ZZPRI-2025-003",datum_prijave:"2025-11-06T09:45:00Z",kratek_opis:"Prekoraitev pooblastil pri zaposlovanju - neupravieno favorisiranje sorodnikov",podrocje:"prekoraitev pooblastil",narava_prijave:"nepravilnosti v lovekih virih",anonimna:!1,status:"reena",datum_potrditev:"2025-11-11T09:45:00Z",datum_resitve:"2025-11-12T09:45:00Z",odgovorna_oseba:"Janez Krnc",zaupnik_id:"zaupnik-1",zaupnik:{ime:"Ana",priimek:"Kova"}},{id:"demo-4",stevilo_prijave:"ZZPRI-2025-004",datum_prijave:"2025-11-07T16:20:00Z",kratek_opis:"Diskriminacija pri napredovanju - spolna diskriminacija in neenako obravnavanje",podrocje:"diskriminacija",narava_prijave:"kritev naela enakosti",anonimna:!0,status:"v obravnavi",datum_potrditev:"2025-11-11T16:20:00Z",datum_resitve:"2025-11-12T16:20:00Z",odgovorna_oseba:"Maja Kralj",zaupnik_id:"zaupnik-3",zaupnik:{ime:"Luka",priimek:"trak"}},{id:"demo-5",stevilo_prijave:"ZZPRI-2025-005",datum_prijave:"2025-11-08T11:00:00Z",kratek_opis:"Sum goljufije pri obraunu strokov - neupravieno zaraunavanje storitev",podrocje:"goljufija",narava_prijave:"finanne nepravilnosti",anonimna:!1,status:"zavrnjena",datum_potrditev:"2025-11-11T11:00:00Z",datum_resitve:"2025-11-12T11:00:00Z",odgovorna_oseba:"Alenka Kranjc",zaupnik_id:"zaupnik-2",zaupnik:{ime:"Petra",priimek:"Potonik"}},{id:"demo-6",stevilo_prijave:"ZZPRI-2025-006",datum_prijave:"2025-11-09T13:30:00Z",kratek_opis:"Odkrivanje zaupnih podatkov nepooblaenim osebam - kritev varnostnih ukrepov",podrocje:"drugo",narava_prijave:"kritev varnostnih protokolov",anonimna:!1,status:"v obravnavi",datum_potrditev:"2025-11-11T13:30:00Z",datum_resitve:"2025-11-12T13:30:00Z",odgovorna_oseba:"Peter Pavlin",zaupnik_id:"zaupnik-1",zaupnik:{ime:"Ana",priimek:"Kova"}}];function jE(){const[s,t]=z.useState([]),[r,a]=z.useState(!0),[n,i]=z.useState(null),[o,c]=z.useState(""),[d,p]=z.useState("all"),[m,x]=z.useState("all"),[b,h]=z.useState(null),[j,g]=z.useState(!1),[v,_]=z.useState(!1),[k,P]=z.useState(!1),[L,F]=z.useState(!1),[W,R]=z.useState(null);z.useEffect(()=>{B()},[]);const B=async()=>{try{a(!0);const{data:ce,error:re}=await Ne.from("zzzpri_prijave").select(`
          *,
          zaupnik:zzzpri_zaupniki(ime, priimek)
        `).order("datum_prijave",{ascending:!1});if(re)throw re;!ce||ce.length===0?(t(L_),i(null)):t(ce)}catch(ce){console.error("Error loading prijave:",ce),i("Napaka pri nalaganju prijav - prikazujemo demo podatke"),t(L_)}finally{a(!1)}},A=ce=>new Date(ce).toLocaleDateString("sl-SI",{year:"numeric",month:"2-digit",day:"2-digit"}),S=ce=>E_[ce]||E_.prejeta,C=ce=>I_[ce]||I_.drugo,O=(ce,re)=>{const X=new Date(ce),U=new Date,oe=X.getTime()-U.getTime(),xe=Math.ceil(oe/(1e3*60*60*24));return xe<=re&&xe>=0},Z=ce=>new Date(ce)<new Date,te=s.filter(ce=>{const re=ce.stevilo_prijave.toLowerCase().includes(o.toLowerCase())||ce.kratek_opis.toLowerCase().includes(o.toLowerCase()),X=d==="all"||ce.status===d,U=m==="all"||ce.podrocje===m;return re&&X&&U});return r?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-accent-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:"Evidence prijav ZZPri"}),e.jsx("p",{className:"text-body text-text-secondary",children:"Pregled vseh prijav po Zakonu o zaiti prijaviteljev"})]}),e.jsxs("button",{onClick:()=>_(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-accent-primary text-white rounded-lg hover:bg-accent-primary/90 transition-colors duration-200",children:[e.jsx(Dt,{className:"w-4 h-4"}),"Nova prijava"]})]}),n&&e.jsx("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(er,{className:"w-5 h-5 text-red-400"}),e.jsx("span",{className:"text-red-400",children:n})]})}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ss,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-text-tertiary"}),e.jsx("input",{type:"text",placeholder:"Ii po tevilki ali opisu...",value:o,onChange:ce=>c(ce.target.value),className:"w-full pl-10 pr-4 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary"})]}),e.jsxs("select",{value:d,onChange:ce=>p(ce.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary text-text-primary",children:[e.jsx("option",{value:"all",children:"Vsi statusi"}),e.jsx("option",{value:"prejeta",children:"Prejeta"}),e.jsx("option",{value:"v obravnavi",children:"V obravnavi"}),e.jsx("option",{value:"reena",children:"Reena"}),e.jsx("option",{value:"zavrnjena",children:"Zavrnjena"})]}),e.jsxs("select",{value:m,onChange:ce=>x(ce.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary text-text-primary",children:[e.jsx("option",{value:"all",children:"Vsa podroja"}),e.jsx("option",{value:"korupcija",children:"Korupcija"}),e.jsx("option",{value:"goljufija",children:"Goljufija"}),e.jsx("option",{value:"prekoraitev pooblastil",children:"Prekoraitev pooblastil"}),e.jsx("option",{value:"diskriminacija",children:"Diskriminacija"}),e.jsx("option",{value:"mobing",children:"Mobing"}),e.jsx("option",{value:"drugo",children:"Drugo"})]}),e.jsxs("button",{className:"inline-flex items-center gap-2 px-4 py-2 bg-bg-surface-hover border border-border-subtle rounded-lg hover:bg-bg-surface-active transition-colors duration-200 text-text-secondary",children:[e.jsx(Ir,{className:"w-4 h-4"}),"Izvozi"]})]})}),e.jsxs("div",{className:"text-body-sm text-text-secondary",children:["Prikazano ",te.length," od ",s.length," prijav"]}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-surface-hover border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-body-sm font-semibold text-text-secondary",children:"tevilka"}),e.jsx("th",{className:"px-6 py-3 text-left text-body-sm font-semibold text-text-secondary",children:"Datum"}),e.jsx("th",{className:"px-6 py-3 text-left text-body-sm font-semibold text-text-secondary",children:"Opis"}),e.jsx("th",{className:"px-6 py-3 text-left text-body-sm font-semibold text-text-secondary",children:"Podroje"}),e.jsx("th",{className:"px-6 py-3 text-left text-body-sm font-semibold text-text-secondary",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-body-sm font-semibold text-text-secondary",children:"Zaupnik"}),e.jsx("th",{className:"px-6 py-3 text-left text-body-sm font-semibold text-text-secondary",children:"Roki"}),e.jsx("th",{className:"px-6 py-3 text-left text-body-sm font-semibold text-text-secondary",children:"Akcije"})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:te.map(ce=>{const re=S(ce.status),X=C(ce.podrocje),U=re.icon;return e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-body-sm text-text-primary",children:ce.stevilo_prijave}),ce.anonimna&&e.jsx("div",{className:"w-5 h-5 rounded-full bg-purple-500/10 border border-purple-500/30 flex items-center justify-center",children:e.jsx(Mt,{className:"w-3 h-3 text-purple-400"})})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(_a,{className:"w-4 h-4 text-text-tertiary"}),e.jsx("span",{className:"text-body-sm text-text-secondary",children:A(ce.datum_prijave)})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("p",{className:"text-body-sm text-text-primary line-clamp-2",children:ce.kratek_opis})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-lg text-body-xs font-medium ${X.bg} ${X.border} ${X.color} border`,children:ce.podrocje})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1 rounded-lg ${re.bg} ${re.border} border`,children:[e.jsx(U,{className:`w-4 h-4 ${re.color}`}),e.jsx("span",{className:`text-body-sm font-medium ${re.color}`,children:re.label})]})}),e.jsx("td",{className:"px-6 py-4",children:ce.zaupnik&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(en,{className:"w-4 h-4 text-text-tertiary"}),e.jsxs("span",{className:"text-body-sm text-text-secondary",children:[ce.zaupnik.ime," ",ce.zaupnik.priimek]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"space-y-1",children:[ce.datum_potrditev&&e.jsxs("div",{className:`text-body-xs ${Z(ce.datum_potrditev)?"text-red-400":O(ce.datum_potrditev,3)?"text-orange-400":"text-text-tertiary"}`,children:["Potrditev: ",A(ce.datum_potrditev)]}),ce.datum_resitve&&e.jsxs("div",{className:`text-body-xs ${Z(ce.datum_resitve)?"text-red-400":O(ce.datum_resitve,14)?"text-orange-400":"text-text-tertiary"}`,children:["Reitev: ",A(ce.datum_resitve)]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{h(ce),g(!0)},className:"p-2 text-text-tertiary hover:text-accent-primary hover:bg-accent-primary/10 rounded-lg transition-colors duration-200",children:e.jsx(lr,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{h(ce),P(!0)},className:"p-2 text-text-tertiary hover:text-blue-400 hover:bg-blue-500/10 rounded-lg transition-colors duration-200",children:e.jsx(ar,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{R(ce),F(!0)},className:"p-2 text-text-tertiary hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors duration-200",children:e.jsx(pr,{className:"w-4 h-4"})})]})})]},ce.id)})})]})})}),te.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ut,{className:"w-12 h-12 text-text-tertiary mx-auto mb-4"}),e.jsx("h3",{className:"text-heading-md font-medium text-text-primary mb-2",children:"Ni prijav"}),e.jsx("p",{className:"text-body text-text-secondary mb-6",children:o||d!=="all"||m!=="all"?"Ni prijav, ki bi ustrezale filtrom.":"e ni bilo vnesenih prijav."})]}),j&&b&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-heading-xl font-semibold text-text-primary",children:"Podrobnosti prijave"}),e.jsx("button",{onClick:()=>g(!1),className:"p-2 text-text-tertiary hover:text-text-primary rounded-lg hover:bg-bg-surface-hover transition-colors duration-200",children:e.jsx(Ss,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-body-sm font-medium text-text-secondary",children:"tevilka prijave"}),e.jsx("p",{className:"text-body text-text-primary font-mono",children:b.stevilo_prijave})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-body-sm font-medium text-text-secondary",children:"Kratek opis"}),e.jsx("p",{className:"text-body text-text-primary",children:b.kratek_opis})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-body-sm font-medium text-text-secondary",children:"Podroje"}),e.jsx("p",{className:"text-body text-text-primary",children:b.podrocje})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-body-sm font-medium text-text-secondary",children:"Narava"}),e.jsx("p",{className:"text-body text-text-primary",children:b.narava_prijave})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-body-sm font-medium text-text-secondary",children:"Status"}),e.jsx("p",{className:"text-body text-text-primary",children:b.status})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-body-sm font-medium text-text-secondary",children:"Anonimna prijava"}),e.jsx("p",{className:"text-body text-text-primary",children:b.anonimna?"Da":"Ne"})]})]})]})})}),v&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-heading-xl font-semibold text-text-primary",children:"Nova prijava"}),e.jsx("button",{onClick:()=>_(!1),className:"p-2 text-text-tertiary hover:text-text-primary rounded-lg hover:bg-bg-surface-hover transition-colors duration-200",children:e.jsx(Ss,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-body-sm font-medium text-text-secondary",children:"Kratek opis *"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary",placeholder:"Vnesite kratek opis prijave"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-body-sm font-medium text-text-secondary",children:"Podroje *"}),e.jsxs("select",{className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary",children:[e.jsx("option",{value:"",children:"Izberite podroje"}),e.jsx("option",{value:"korupcija",children:"Korupcija"}),e.jsx("option",{value:"goljufija",children:"Goljufija"}),e.jsx("option",{value:"prekoraitev pooblastil",children:"Prekoraitev pooblastil"}),e.jsx("option",{value:"diskriminacija",children:"Diskriminacija"}),e.jsx("option",{value:"mobing",children:"Mobing"}),e.jsx("option",{value:"drugo",children:"Drugo"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-body-sm font-medium text-text-secondary",children:"Status"}),e.jsxs("select",{className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary",children:[e.jsx("option",{value:"prejeta",children:"Prejeta"}),e.jsx("option",{value:"v obravnavi",children:"V obravnavi"}),e.jsx("option",{value:"reena",children:"Reena"}),e.jsx("option",{value:"zavrnjena",children:"Zavrnjena"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-body-sm font-medium text-text-secondary",children:"Narava prijave"}),e.jsx("textarea",{rows:3,className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary",placeholder:"Podrobneji opis narave prijave"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",className:"w-4 h-4 text-accent-primary bg-bg-surface border-border-subtle rounded focus:ring-accent-primary/50"}),e.jsx("label",{className:"text-body-sm text-text-secondary",children:"Anonimna prijava"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-body-sm font-medium text-text-secondary",children:"Datum potrditve"}),e.jsx("input",{type:"date",className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-body-sm font-medium text-text-secondary",children:"Datum reitve"}),e.jsx("input",{type:"date",className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-body-sm font-medium text-text-secondary",children:"Odgovorna oseba"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary",placeholder:"Ime in priimek odgovorne osebe"})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 mt-6 pt-6 border-t border-border-subtle",children:[e.jsx("button",{onClick:()=>_(!1),className:"px-4 py-2 text-text-secondary hover:text-text-primary transition-colors duration-200",children:"Preklii"}),e.jsx("button",{className:"px-4 py-2 bg-accent-primary text-white rounded-lg hover:bg-accent-primary/90 transition-colors duration-200",children:"Shrani"})]})]})})}),k&&b&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-heading-xl font-semibold text-text-primary",children:"Uredi prijavo"}),e.jsx("button",{onClick:()=>P(!1),className:"p-2 text-text-tertiary hover:text-text-primary rounded-lg hover:bg-bg-surface-hover transition-colors duration-200",children:e.jsx(Ss,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-body-sm font-medium text-text-secondary",children:"tevilka prijave"}),e.jsx("input",{type:"text",value:b.stevilo_prijave,className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-body-sm font-medium text-text-secondary",children:"Kratek opis *"}),e.jsx("input",{type:"text",defaultValue:b.kratek_opis,className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-body-sm font-medium text-text-secondary",children:"Podroje *"}),e.jsxs("select",{defaultValue:b.podrocje,className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary",children:[e.jsx("option",{value:"korupcija",children:"Korupcija"}),e.jsx("option",{value:"goljufija",children:"Goljufija"}),e.jsx("option",{value:"prekoraitev pooblastil",children:"Prekoraitev pooblastil"}),e.jsx("option",{value:"diskriminacija",children:"Diskriminacija"}),e.jsx("option",{value:"mobing",children:"Mobing"}),e.jsx("option",{value:"drugo",children:"Drugo"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-body-sm font-medium text-text-secondary",children:"Status"}),e.jsxs("select",{defaultValue:b.status,className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary",children:[e.jsx("option",{value:"prejeta",children:"Prejeta"}),e.jsx("option",{value:"v obravnavi",children:"V obravnavi"}),e.jsx("option",{value:"reena",children:"Reena"}),e.jsx("option",{value:"zavrnjena",children:"Zavrnjena"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-body-sm font-medium text-text-secondary",children:"Narava prijave"}),e.jsx("textarea",{rows:3,defaultValue:b.narava_prijave,className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-body-sm font-medium text-text-secondary",children:"Datum potrditve"}),e.jsx("input",{type:"date",defaultValue:b.datum_potrditev?b.datum_potrditev.split("T")[0]:"",className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-body-sm font-medium text-text-secondary",children:"Datum reitve"}),e.jsx("input",{type:"date",defaultValue:b.datum_resitve?b.datum_resitve.split("T")[0]:"",className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-body-sm font-medium text-text-secondary",children:"Odgovorna oseba"}),e.jsx("input",{type:"text",defaultValue:b.odgovorna_oseba,className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary"})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 mt-6 pt-6 border-t border-border-subtle",children:[e.jsx("button",{onClick:()=>P(!1),className:"px-4 py-2 text-text-secondary hover:text-text-primary transition-colors duration-200",children:"Preklii"}),e.jsx("button",{className:"px-4 py-2 bg-accent-primary text-white rounded-lg hover:bg-accent-primary/90 transition-colors duration-200",children:"Shrani spremembe"})]})]})})}),L&&W&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg max-w-md w-full mx-4",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-red-500/20 border border-red-500/40 flex items-center justify-center",children:e.jsx(pt,{className:"w-6 h-6 text-red-400"})}),e.jsx("h2",{className:"text-heading-lg font-semibold text-text-primary",children:"Izbrii prijavo"})]}),e.jsxs("p",{className:"text-body text-text-secondary mb-6",children:["Ali ste prepriani, da elite izbrisati prijavo ",e.jsx("strong",{children:W.stevilo_prijave}),"? Ta dejanja ni mogoe razveljaviti."]}),e.jsxs("div",{className:"flex items-center justify-end gap-3",children:[e.jsx("button",{onClick:()=>{F(!1),R(null)},className:"px-4 py-2 text-text-secondary hover:text-text-primary transition-colors duration-200",children:"Preklii"}),e.jsx("button",{onClick:async()=>{if(W!=null&&W.id)try{const{error:ce}=await Ne.from("zvop2_prijave").delete().eq("id",W.id);if(ce)throw ce;toast.success("Prijava je bila uspeno izbrisana"),F(!1),R(null),B()}catch(ce){console.error("Error deleting prijava:",ce),toast.error(ce.message||"Napaka pri brisanju prijave")}},className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-500/90 transition-colors duration-200",children:"Izbrii"})]})]})})})]})}const ob=[{id:"demo-1",ime:"Ana",priimek:"Novak",email:"ana.novak@podjetje.si",telefon:"+386 41 123 456",delovno_mesto:"Vodja varnosti",oddelek:"IT oddelek",izbran_zaupnik:!0,dostopen_pri:"Ponedeljek-Petek 8:00-16:00",usposobljen:!0,created_at:"2024-01-15T10:30:00Z"},{id:"demo-2",ime:"Marko",priimek:"Kova",email:"marko.kovac@podjetje.si",telefon:"+386 41 234 567",delovno_mesto:"Strokovnjak za kibernetsko varnost",oddelek:"Varnostni oddelek",izbran_zaupnik:!0,dostopen_pri:"Ponedeljek-Petek 7:00-15:00",usposobljen:!0,created_at:"2024-02-20T14:15:00Z"},{id:"demo-3",ime:"Petra",priimek:"Zupan",email:"petra.zupan@podjetje.si",telefon:"+386 41 345 678",delovno_mesto:"Pravna svetovalka",oddelek:"Pravni oddelek",izbran_zaupnik:!1,dostopen_pri:"Ponedeljek-etrtek 9:00-17:00",usposobljen:!0,created_at:"2024-03-10T09:45:00Z"},{id:"demo-4",ime:"Toma",priimek:"Vidmar",email:"tomaz.vidmar@podjetje.si",telefon:"+386 41 456 789",delovno_mesto:"Sistem administrator",oddelek:"IT oddelek",izbran_zaupnik:!1,dostopen_pri:"Ponedeljek-Petek 6:00-14:00",usposobljen:!0,created_at:"2024-04-05T11:20:00Z"}];function _E(){const[s,t]=z.useState([]),[r,a]=z.useState(!0),[n,i]=z.useState(null),[o,c]=z.useState(""),[d,p]=z.useState(!1),[m,x]=z.useState(null),[b,h]=z.useState(!1),[j,g]=z.useState({ime:"",priimek:"",email:"",telefon:"",delovno_mesto:"",oddelek:"",izbran_zaupnik:!1,dostopen_pri:"",usposobljen:!1});z.useEffect(()=>{v()},[]);const v=async()=>{try{a(!0);const{data:W,error:R}=await Ne.from("zzzpri_zaupniki").select("*").order("created_at",{ascending:!1});R?(console.warn("Napaka pri nalaganju iz baze, uporabljam demo podatke:",R),t(ob),i(null)):!W||W.length===0?t(ob):t(W)}catch(W){console.warn("Napaka pri nalaganju zaupnikov, uporabljam demo podatke:",W),t(ob),i(null)}finally{a(!1)}},_=async W=>{W.preventDefault(),h(!0);try{if(m){const{error:R}=await Ne.from("zzzpri_zaupniki").update(j).eq("id",m.id);if(R)throw R}else{const{error:R}=await Ne.from("zzzpri_zaupniki").insert([j]);if(R)throw R}await v(),p(!1),x(null),g({ime:"",priimek:"",email:"",telefon:"",delovno_mesto:"",oddelek:"",izbran_zaupnik:!1,dostopen_pri:"",usposobljen:!1})}catch(R){console.error("Error saving zaupnik:",R),i("Napaka pri shranjevanju zaupnika")}finally{h(!1)}},k=async W=>{if(confirm("Ali ste prepriani, da elite izbrisati tega zaupnika?"))try{const{error:R}=await Ne.from("zzzpri_zaupniki").delete().eq("id",W);if(R)throw R;await v()}catch(R){console.error("Error deleting zaupnik:",R),i("Napaka pri brisanju zaupnika")}},P=W=>{x(W),g({ime:W.ime,priimek:W.priimek,email:W.email,telefon:W.telefon||"",delovno_mesto:W.delovno_mesto||"",oddelek:W.oddelek||"",izbran_zaupnik:W.izbran_zaupnik,dostopen_pri:W.dostopen_pri||"",usposobljen:W.usposobljen}),p(!0)},L=W=>new Date(W).toLocaleDateString("sl-SI",{year:"numeric",month:"2-digit",day:"2-digit"}),F=s.filter(W=>{var B,A;const R=o.toLowerCase();return W.ime.toLowerCase().includes(R)||W.priimek.toLowerCase().includes(R)||W.email.toLowerCase().includes(R)||((B=W.delovno_mesto)==null?void 0:B.toLowerCase().includes(R))||((A=W.oddelek)==null?void 0:A.toLowerCase().includes(R))});return r?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-accent-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:"Upravljanje zaupnikov"}),e.jsx("p",{className:"text-body text-text-secondary",children:"Evidence oseb, ki so pooblaene za sprejemanje prijav po ZZPri"})]}),e.jsxs("button",{onClick:()=>{x(null),g({ime:"",priimek:"",email:"",telefon:"",delovno_mesto:"",oddelek:"",izbran_zaupnik:!1,dostopen_pri:"",usposobljen:!1}),p(!0)},className:"inline-flex items-center gap-2 px-4 py-2 bg-accent-primary text-white rounded-lg hover:bg-accent-primary/90 transition-colors duration-200",children:[e.jsx(Dt,{className:"w-4 h-4"}),"Dodaj zaupnika"]})]}),n&&e.jsx("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(er,{className:"w-5 h-5 text-red-400"}),e.jsx("span",{className:"text-red-400",children:n})]})}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:e.jsxs("div",{className:"relative max-w-md",children:[e.jsx(ss,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-text-tertiary"}),e.jsx("input",{type:"text",placeholder:"Ii po imenu, e-poti ali delovnem mestu...",value:o,onChange:W=>c(W.target.value),className:"w-full pl-10 pr-4 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-bg-surface p-4 rounded-lg border border-border-subtle",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-500/10 border border-blue-500/30 flex items-center justify-center",children:e.jsx(Fa,{className:"w-5 h-5 text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Skupaj zaupnikov"}),e.jsx("p",{className:"text-heading-lg font-semibold text-text-primary",children:s.length})]})]})}),e.jsx("div",{className:"bg-bg-surface p-4 rounded-lg border border-border-subtle",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-green-500/10 border border-green-500/30 flex items-center justify-center",children:e.jsx(xg,{className:"w-5 h-5 text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Izbrani zaupniki"}),e.jsx("p",{className:"text-heading-lg font-semibold text-text-primary",children:s.filter(W=>W.izbran_zaupnik).length})]})]})}),e.jsx("div",{className:"bg-bg-surface p-4 rounded-lg border border-border-subtle",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-purple-500/10 border border-purple-500/30 flex items-center justify-center",children:e.jsx(Rt,{className:"w-5 h-5 text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Usposobljenih"}),e.jsx("p",{className:"text-heading-lg font-semibold text-text-primary",children:s.filter(W=>W.usposobljen).length})]})]})})]}),e.jsxs("div",{className:"text-body-sm text-text-secondary",children:["Prikazano ",F.length," od ",s.length," zaupnikov"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:F.map(W=>e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6 hover:border-accent-primary/50 transition-all duration-200",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${W.izbran_zaupnik?"bg-green-500/10 border border-green-500/30":"bg-gray-500/10 border border-gray-500/30"}`,children:e.jsx(Fa,{className:`w-6 h-6 ${W.izbran_zaupnik?"text-green-400":"text-gray-400"}`})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-heading-md font-semibold text-text-primary",children:[W.ime," ",W.priimek]}),W.delovno_mesto&&e.jsx("p",{className:"text-body-sm text-text-secondary",children:W.delovno_mesto})]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>P(W),className:"p-2 text-text-tertiary hover:text-blue-400 hover:bg-blue-500/10 rounded-lg transition-colors duration-200",children:e.jsx(ar,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>k(W.id),className:"p-2 text-text-tertiary hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors duration-200",children:e.jsx(pr,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(bu,{className:"w-4 h-4 text-text-tertiary"}),e.jsx("span",{className:"text-body-sm text-text-secondary",children:W.email})]}),W.telefon&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(hg,{className:"w-4 h-4 text-text-tertiary"}),e.jsx("span",{className:"text-body-sm text-text-secondary",children:W.telefon})]}),W.oddelek&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Th,{className:"w-4 h-4 text-text-tertiary"}),e.jsx("span",{className:"text-body-sm text-text-secondary",children:W.oddelek})]}),W.dostopen_pri&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(cs,{className:"w-4 h-4 text-text-tertiary"}),e.jsx("span",{className:"text-body-sm text-text-secondary",children:W.dostopen_pri})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[W.izbran_zaupnik&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-lg text-body-xs font-medium bg-green-500/10 border border-green-500/30 text-green-400",children:"Izbrani zaupnik"}),W.usposobljen&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-lg text-body-xs font-medium bg-blue-500/10 border border-blue-500/30 text-blue-400",children:"Usposobljen"})]}),e.jsxs("div",{className:"text-body-xs text-text-tertiary border-t border-border-subtle pt-3",children:["Dodano: ",L(W.created_at)]})]},W.id))}),F.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Fa,{className:"w-12 h-12 text-text-tertiary mx-auto mb-4"}),e.jsx("h3",{className:"text-heading-md font-medium text-text-primary mb-2",children:"Ni zaupnikov"}),e.jsx("p",{className:"text-body text-text-secondary mb-6",children:o?"Ni zaupnikov, ki bi ustrezali iskalnemu izrazu.":"e ni bilo dodanih zaupnikov."}),e.jsxs("button",{onClick:()=>{x(null),g({ime:"",priimek:"",email:"",telefon:"",delovno_mesto:"",oddelek:"",izbran_zaupnik:!1,dostopen_pri:"",usposobljen:!1}),p(!0)},className:"inline-flex items-center gap-2 px-4 py-2 bg-accent-primary text-white rounded-lg hover:bg-accent-primary/90 transition-colors duration-200",children:[e.jsx(Dt,{className:"w-4 h-4"}),"Dodaj prvega zaupnika"]})]}),d&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:e.jsxs("form",{onSubmit:_,className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-heading-xl font-semibold text-text-primary",children:m?"Uredi zaupnika":"Dodaj zaupnika"}),e.jsx("button",{type:"button",onClick:()=>p(!1),className:"p-2 text-text-tertiary hover:text-text-primary rounded-lg hover:bg-bg-surface-hover transition-colors duration-200",children:e.jsx(Ar,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-secondary mb-2",children:"Ime *"}),e.jsx("input",{type:"text",required:!0,value:j.ime,onChange:W=>g({...j,ime:W.target.value}),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary text-text-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-secondary mb-2",children:"Priimek *"}),e.jsx("input",{type:"text",required:!0,value:j.priimek,onChange:W=>g({...j,priimek:W.target.value}),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary text-text-primary"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-secondary mb-2",children:"E-pota *"}),e.jsx("input",{type:"email",required:!0,value:j.email,onChange:W=>g({...j,email:W.target.value}),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary text-text-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-secondary mb-2",children:"Telefon"}),e.jsx("input",{type:"tel",value:j.telefon,onChange:W=>g({...j,telefon:W.target.value}),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary text-text-primary"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-secondary mb-2",children:"Delovno mesto"}),e.jsx("input",{type:"text",value:j.delovno_mesto,onChange:W=>g({...j,delovno_mesto:W.target.value}),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary text-text-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-secondary mb-2",children:"Oddelek"}),e.jsx("input",{type:"text",value:j.oddelek,onChange:W=>g({...j,oddelek:W.target.value}),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary text-text-primary"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-secondary mb-2",children:"Dostopen"}),e.jsx("input",{type:"text",placeholder:"npr. Ponedeljek-Petek 8:00-16:00",value:j.dostopen_pri,onChange:W=>g({...j,dostopen_pri:W.target.value}),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary text-text-primary"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:j.izbran_zaupnik,onChange:W=>g({...j,izbran_zaupnik:W.target.checked}),className:"w-4 h-4 text-accent-primary border-border-subtle rounded focus:ring-accent-primary/50"}),e.jsx("span",{className:"ml-2 text-body text-text-primary",children:"Izbrani zaupnik"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:j.usposobljen,onChange:W=>g({...j,usposobljen:W.target.checked}),className:"w-4 h-4 text-accent-primary border-border-subtle rounded focus:ring-accent-primary/50"}),e.jsx("span",{className:"ml-2 text-body text-text-primary",children:"Usposobljen za ZZPri"})]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6 pt-6 border-t border-border-subtle",children:[e.jsx("button",{type:"button",onClick:()=>p(!1),className:"flex-1 px-4 py-2 border border-border-subtle rounded-lg text-text-secondary hover:bg-bg-surface-hover transition-colors duration-200",children:"Preklii"}),e.jsx("button",{type:"submit",disabled:b,className:"flex-1 px-4 py-2 bg-accent-primary text-white rounded-lg hover:bg-accent-primary/90 transition-colors duration-200 disabled:opacity-50",children:b?"Shranjevanje...":m?"Posodobi":"Dodaj"})]})]})})})]})}const T_={kratek_opis:"",podroben_opis:"",podrocje:"",narava_prijave:"",anonimna:!1,prijavitelj_ime:"",prijavitelj_priimek:"",prijavitelj_email:"",prijavitelj_telefon:"",prijavitelj_delovno_mesto:"",odgovorna_oseba:"",zaupnik_id:""};function kE(){const[s,t]=z.useState(T_),[r,a]=z.useState([]),[n,i]=z.useState(!1),[o,c]=z.useState(null),[d,p]=z.useState(!1),[m,x]=z.useState(!0);z.useEffect(()=>{b()},[]);const b=async()=>{try{x(!0);const{data:g,error:v}=await Ne.from("zzzpri_zaupniki").select("*").eq("izbran_zaupnik",!0).order("ime");if(v)throw v;a(g||[])}catch(g){console.error("Error loading zaupniki:",g),c("Napaka pri nalaganju zaupnikov")}finally{x(!1)}},h=(g,v)=>{t(_=>({..._,[g]:v}))},j=async(g,v=!1)=>{if(g.preventDefault(),c(null),i(!0),!s.kratek_opis.trim()){c("Kratek opis je obvezen"),i(!1);return}if(!s.podrocje){c("Izbira podroja je obvezna"),i(!1);return}if(!s.narava_prijave){c("Izbira narave prijave je obvezna"),i(!1);return}if(!s.anonimna&&(!s.prijavitelj_ime.trim()||!s.prijavitelj_priimek.trim()||!s.prijavitelj_email.trim())){c("Podatki prijavitelja so obvezni za neaononimno prijavo"),i(!1);return}try{const _={kratek_opis:s.kratek_opis,podroben_opis:s.podroben_opis||null,podrocje:s.podrocje,narava_prijave:s.narava_prijave,anonimna:s.anonimna,odgovorna_oseba:s.odgovorna_oseba||null,zaupnik_id:s.zaupnik_id||null,status:v?"osnutek":"prejeta",podatki_prijavitelja_encrypted:s.anonimna?{anonimen:!0}:{ime:s.prijavitelj_ime,priimek:s.prijavitelj_priimek,email:s.prijavitelj_email,telefon:s.prijavitelj_telefon,delovno_mesto:s.prijavitelj_delovno_mesto}},{error:k}=await Ne.from("zzzpri_prijave").insert([_]);if(k)throw k;p(!0),t(T_),setTimeout(()=>p(!1),5e3)}catch(_){console.error("Error submitting prijava:",_),c("Napaka pri poiljanju prijave")}finally{i(!1)}};return m?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-accent-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:"Nova prijava ZZPri"}),e.jsx("p",{className:"text-body text-text-secondary",children:"Obrazec za vloitev prijave po Zakonu o zaiti prijaviteljev"})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("div",{className:"w-16 h-16 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center shadow-lg",children:e.jsx(ul,{className:"w-8 h-8 text-white"})})})]}),d&&e.jsx("div",{className:"bg-green-500/10 border border-green-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Rt,{className:"w-5 h-5 text-green-400"}),e.jsx("span",{className:"text-green-400",children:"Prijava je bila uspeno poslana!"})]})}),o&&e.jsx("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(er,{className:"w-5 h-5 text-red-400"}),e.jsx("span",{className:"text-red-400",children:o})]})}),e.jsxs("form",{onSubmit:g=>j(g,!1),className:"space-y-8",children:[e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:[e.jsxs("h2",{className:"text-heading-lg font-semibold text-text-primary mb-6 flex items-center gap-2",children:[e.jsx(ut,{className:"w-5 h-5 text-accent-primary"}),"Osnovni podatki prijave"]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-body-sm font-medium text-text-secondary mb-2",children:["Kratek opis ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",required:!0,value:s.kratek_opis,onChange:g=>h("kratek_opis",g.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary text-text-primary",placeholder:"Kratko opiite vsebino prijave..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-secondary mb-2",children:"Podroben opis"}),e.jsx("textarea",{rows:4,value:s.podroben_opis,onChange:g=>h("podroben_opis",g.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary text-text-primary",placeholder:"Podrobno opiite dogodek, okoliine, dokaze..."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-body-sm font-medium text-text-secondary mb-2",children:["Podroje ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("select",{required:!0,value:s.podrocje,onChange:g=>h("podrocje",g.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary text-text-primary",children:[e.jsx("option",{value:"",children:"Izberi podroje..."}),e.jsx("option",{value:"korupcija",children:"Korupcija"}),e.jsx("option",{value:"goljufija",children:"Goljufija"}),e.jsx("option",{value:"prekoraitev pooblastil",children:"Prekoraitev pooblastil"}),e.jsx("option",{value:"diskriminacija",children:"Diskriminacija"}),e.jsx("option",{value:"mobing",children:"Mobing"}),e.jsx("option",{value:"drugo",children:"Drugo"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-body-sm font-medium text-text-secondary mb-2",children:["Narava prijave ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("select",{required:!0,value:s.narava_prijave,onChange:g=>h("narava_prijave",g.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary text-text-primary",children:[e.jsx("option",{value:"",children:"Izberi naravo..."}),e.jsx("option",{value:"interna",children:"Interna"}),e.jsx("option",{value:"kaznivo dejanje",children:"Kaznivo dejanje"}),e.jsx("option",{value:"drugi prekrki",children:"Drugi prekrki"})]})]})]}),e.jsx("div",{className:"bg-blue-500/5 border border-blue-500/20 rounded-lg p-4",children:e.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.anonimna,onChange:g=>h("anonimna",g.target.checked),className:"w-5 h-5 text-accent-primary border-border-subtle rounded focus:ring-accent-primary/50 mt-1"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Mt,{className:"w-4 h-4 text-blue-400"}),e.jsx("span",{className:"text-body font-medium text-text-primary",children:"Anonimna prijava"})]}),e.jsx("p",{className:"text-body-sm text-text-secondary mt-1",children:"Oznaite, e elite, da ostanejo vai podatki anonimni. Prijava bo e vedno obravnavana, vendar vaa identiteta ne bo razkrita."})]})]})})]})]}),!s.anonimna&&e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:[e.jsxs("h2",{className:"text-heading-lg font-semibold text-text-primary mb-6 flex items-center gap-2",children:[e.jsx(en,{className:"w-5 h-5 text-accent-primary"}),"Podatki prijavitelja"]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-body-sm font-medium text-text-secondary mb-2",children:["Ime ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",required:!s.anonimna,value:s.prijavitelj_ime,onChange:g=>h("prijavitelj_ime",g.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary text-text-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-body-sm font-medium text-text-secondary mb-2",children:["Priimek ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",required:!s.anonimna,value:s.prijavitelj_priimek,onChange:g=>h("prijavitelj_priimek",g.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary text-text-primary"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-body-sm font-medium text-text-secondary mb-2",children:["E-pota ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"email",required:!s.anonimna,value:s.prijavitelj_email,onChange:g=>h("prijavitelj_email",g.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary text-text-primary"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-secondary mb-2",children:"Telefon"}),e.jsx("input",{type:"tel",value:s.prijavitelj_telefon,onChange:g=>h("prijavitelj_telefon",g.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary text-text-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-secondary mb-2",children:"Delovno mesto"}),e.jsx("input",{type:"text",value:s.prijavitelj_delovno_mesto,onChange:g=>h("prijavitelj_delovno_mesto",g.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary text-text-primary"})]})]})]})]}),e.jsxs("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:[e.jsxs("h2",{className:"text-heading-lg font-semibold text-text-primary mb-6 flex items-center gap-2",children:[e.jsx(_a,{className:"w-5 h-5 text-accent-primary"}),"Podatki o obravnavi"]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-secondary mb-2",children:"Odgovorna oseba"}),e.jsx("input",{type:"text",value:s.odgovorna_oseba,onChange:g=>h("odgovorna_oseba",g.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary text-text-primary",placeholder:"Ime osebe, ki bo odgovorna za obravnavo..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-secondary mb-2",children:"Zaupnik"}),e.jsxs("select",{value:s.zaupnik_id,onChange:g=>h("zaupnik_id",g.target.value),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary text-text-primary",children:[e.jsx("option",{value:"",children:"Izberi zaupnika..."}),r.map(g=>e.jsxs("option",{value:g.id,children:[g.ime," ",g.priimek," - ",g.delovno_mesto]},g.id))]}),r.length===0&&e.jsx("p",{className:"text-body-sm text-orange-400 mt-1",children:'Ni na voljo zaupnikov. Dodajte zaupnike v zavihku "Upravljanje zaupnikov".'})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 pt-6",children:[e.jsxs("button",{type:"button",onClick:g=>j(g,!0),disabled:n,className:"flex-1 inline-flex items-center justify-center gap-2 px-6 py-3 bg-bg-surface-hover border border-border-subtle rounded-lg text-text-secondary hover:bg-bg-surface-active transition-colors duration-200 disabled:opacity-50",children:[e.jsx(Kp,{className:"w-4 h-4"}),n?"Shranjujem...":"Shrani kot osnutek"]}),e.jsxs("button",{type:"submit",disabled:n,className:"flex-1 inline-flex items-center justify-center gap-2 px-6 py-3 bg-accent-primary text-white rounded-lg hover:bg-accent-primary/90 transition-colors duration-200 disabled:opacity-50",children:[e.jsx(ku,{className:"w-4 h-4"}),n?"Poiljam...":"Polji prijavo"]})]})]}),e.jsxs("div",{className:"bg-blue-500/5 border border-blue-500/20 rounded-lg p-6",children:[e.jsxs("h3",{className:"text-heading-md font-semibold text-text-primary mb-3 flex items-center gap-2",children:[e.jsx(er,{className:"w-5 h-5 text-blue-400"}),"Pomembne informacije"]}),e.jsxs("ul",{className:"space-y-2 text-body-sm text-text-secondary",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-blue-400 rounded-full mt-2 flex-shrink-0"}),"Po poiljanju prijave boste prejeli potrdilo na vao e-poto (e ni anonimna)"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-blue-400 rounded-full mt-2 flex-shrink-0"}),"Prijava bo obravnavana v zakonskem roku 7 dni za potrditev in 3 mesece za reitev"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-blue-400 rounded-full mt-2 flex-shrink-0"}),"Vai podatki so zaiteni v skladu z ZZPri in GDPR zakonodajo"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-blue-400 rounded-full mt-2 flex-shrink-0"}),"Za dodatna vpraanja se obrnite na izbrane zaupnike"]})]})]})]})}function R_(){const{t:s}=et(),[t,r]=z.useState([]),[a,n]=z.useState(!0),[i,o]=z.useState(null),[c,d]=z.useState(""),[p,m]=z.useState(!1),[x,b]=z.useState(!1),[h,j]=z.useState(null),[g,v]=z.useState(!1),[_,k]=z.useState(null),[P,L]=z.useState({naziv_dokumentacije:"",datum_dokumenta:"",datum_veljavnosti:"",opis_dokumentacije:""}),[F,W]=z.useState({naziv_dokumentacije:"",datum_dokumenta:""});z.useEffect(()=>{R()},[]);const R=async()=>{try{n(!0);const{data:X,error:U}=await Ne.from("zzzpri_dokumenti_splosni").select("*").order("datum_dokumenta",{ascending:!1});if(U)throw U;r(X||[])}catch(X){console.error("Napaka pri nalaganju dokumentacije:",X),o("Napaka pri nalaganju dokumentacije")}finally{n(!1)}},B=X=>X?new Date(X).toLocaleDateString("sl-SI",{year:"numeric",month:"2-digit",day:"2-digit"}):"-",A=()=>{const X={naziv_dokumentacije:"",datum_dokumenta:""};let U=!0;return P.naziv_dokumentacije.trim()||(X.naziv_dokumentacije="Naziv dokumentacije je obvezen",U=!1),P.datum_dokumenta||(X.datum_dokumenta="Datum dokumenta je obvezen",U=!1),W(X),U},S=async X=>{if(X.preventDefault(),!!A())try{n(!0);let U=null;if(_){const xe=_.name.split(".").pop();U=`zzzpri-dokumenti/${`${Date.now()}_${Math.random().toString(36).substring(7)}.${xe}`}`;const{error:$}=await Ne.storage.from("documents").upload(U,_);if($){console.error("Napaka pri nalaganju datoteke:",$),o("Napaka pri nalaganju datoteke");return}}const oe={naziv_dokumentacije:P.naziv_dokumentacije,datum_dokumenta:P.datum_dokumenta,datum_veljavnosti:P.datum_veljavnosti||null,opis_dokumentacije:P.opis_dokumentacije||null,pot_do_dokumenta:U};if(g&&h){const{error:xe}=await Ne.from("zzzpri_dokumenti_splosni").update(oe).eq("id",h.id);if(xe)throw xe}else{const{error:xe}=await Ne.from("zzzpri_dokumenti_splosni").insert([oe]);if(xe)throw xe}await R(),O(),m(!1)}catch(U){console.error("Napaka pri shranjevanju:",U),o("Napaka pri shranjevanju dokumentacije")}finally{n(!1)}},C=async X=>{if(confirm("Ali ste prepriani, da elite izbrisati ta dokument?"))try{n(!0);const{error:U}=await Ne.from("zzzpri_dokumenti_splosni").delete().eq("id",X);if(U)throw U;await R()}catch(U){console.error("Napaka pri brisanju:",U),o("Napaka pri brisanju dokumentacije")}finally{n(!1)}},O=()=>{L({naziv_dokumentacije:"",datum_dokumenta:"",datum_veljavnosti:"",opis_dokumentacije:""}),W({naziv_dokumentacije:"",datum_dokumenta:""}),k(null),v(!1),j(null)},Z=X=>{j(X),L({naziv_dokumentacije:X.naziv_dokumentacije,datum_dokumenta:X.datum_dokumenta,datum_veljavnosti:X.datum_veljavnosti||"",opis_dokumentacije:X.opis_dokumentacije||""}),v(!0),m(!0)},te=X=>{j(X),b(!0)},ce=X=>{X.target.files&&X.target.files[0]&&k(X.target.files[0])},re=t.filter(X=>X.naziv_dokumentacije.toLowerCase().includes(c.toLowerCase())||X.opis_dokumentacije&&X.opis_dokumentacije.toLowerCase().includes(c.toLowerCase()));return a&&t.length===0?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-accent-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:"Dokumentacija ZZPri"}),e.jsx("p",{className:"text-body text-text-secondary",children:"Upravljanje dokumentacije v zvezi z ZZPri zakonom"})]}),e.jsxs("button",{onClick:()=>{O(),m(!0)},className:"inline-flex items-center gap-2 px-4 py-2 bg-accent-primary text-white rounded-lg hover:bg-accent-primary/90 transition-colors duration-200",children:[e.jsx(Dt,{className:"w-4 h-4"}),"Dodaj dokument"]})]}),i&&e.jsx("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(er,{className:"w-5 h-5 text-red-400"}),e.jsx("span",{className:"text-red-400",children:i})]})}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-6",children:e.jsxs("div",{className:"relative",children:[e.jsx(ss,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-text-tertiary"}),e.jsx("input",{type:"text",placeholder:"Ii po nazivu ali opisu...",value:c,onChange:X=>d(X.target.value),className:"w-full pl-10 pr-4 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary text-text-primary"})]})}),e.jsxs("div",{className:"text-body-sm text-text-secondary",children:["Prikazano ",re.length," od ",t.length," dokumentov"]}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-surface-hover border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-body-sm font-semibold text-text-secondary",children:"Naziv"}),e.jsx("th",{className:"px-6 py-3 text-left text-body-sm font-semibold text-text-secondary",children:"Datum dokumenta"}),e.jsx("th",{className:"px-6 py-3 text-left text-body-sm font-semibold text-text-secondary",children:"Datum veljavnosti"}),e.jsx("th",{className:"px-6 py-3 text-left text-body-sm font-semibold text-text-secondary",children:"Opis"}),e.jsx("th",{className:"px-6 py-3 text-left text-body-sm font-semibold text-text-secondary",children:"Datoteka"}),e.jsx("th",{className:"px-6 py-3 text-left text-body-sm font-semibold text-text-secondary",children:"Akcije"})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:re.map(X=>e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ut,{className:"w-4 h-4 text-accent-primary"}),e.jsx("span",{className:"text-body-sm text-text-primary font-medium",children:X.naziv_dokumentacije})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(_a,{className:"w-4 h-4 text-text-tertiary"}),e.jsx("span",{className:"text-body-sm text-text-secondary",children:B(X.datum_dokumenta)})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"text-body-sm text-text-secondary",children:B(X.datum_veljavnosti)})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("p",{className:"text-body-sm text-text-secondary line-clamp-2",children:X.opis_dokumentacije||"-"})}),e.jsx("td",{className:"px-6 py-4",children:X.pot_do_dokumenta?e.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-lg bg-green-500/10 border border-green-500/30",children:[e.jsx(Pb,{className:"w-3 h-3 text-green-400"}),e.jsx("span",{className:"text-body-xs text-green-400",children:"Naloeno"})]}):e.jsx("span",{className:"text-body-xs text-text-tertiary",children:"-"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>te(X),className:"p-2 text-text-tertiary hover:text-accent-primary hover:bg-accent-primary/10 rounded-lg transition-colors duration-200",children:e.jsx(lr,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Z(X),className:"p-2 text-text-tertiary hover:text-blue-400 hover:bg-blue-500/10 rounded-lg transition-colors duration-200",children:e.jsx(ar,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>C(X.id),className:"p-2 text-text-tertiary hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors duration-200",children:e.jsx(pr,{className:"w-4 h-4"})})]})})]},X.id))})]})})}),re.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ut,{className:"w-12 h-12 text-text-tertiary mx-auto mb-4"}),e.jsx("h3",{className:"text-heading-md font-medium text-text-primary mb-2",children:"Ni dokumentov"}),e.jsx("p",{className:"text-body text-text-secondary mb-6",children:c?"Ni dokumentov, ki bi ustrezali iskalnemu nizu.":"e ni bilo dodanih dokumentov."})]}),p&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-heading-xl font-semibold text-text-primary",children:g?"Uredi dokument":"Dodaj dokument"}),e.jsx("button",{onClick:()=>{m(!1),O()},className:"p-2 text-text-tertiary hover:text-text-primary rounded-lg hover:bg-bg-surface-hover transition-colors duration-200",children:e.jsx(Ss,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-body-sm font-medium text-text-secondary mb-2",children:["Naziv dokumentacije ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",value:P.naziv_dokumentacije,onChange:X=>L({...P,naziv_dokumentacije:X.target.value}),className:`w-full px-3 py-2 bg-bg-surface border ${F.naziv_dokumentacije?"border-red-500":"border-border-subtle"} rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary text-text-primary`,placeholder:"Vnesite naziv dokumentacije"}),F.naziv_dokumentacije&&e.jsx("p",{className:"mt-1 text-body-xs text-red-400",children:F.naziv_dokumentacije})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-body-sm font-medium text-text-secondary mb-2",children:["Datum dokumenta ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"date",value:P.datum_dokumenta,onChange:X=>L({...P,datum_dokumenta:X.target.value}),className:`w-full px-3 py-2 bg-bg-surface border ${F.datum_dokumenta?"border-red-500":"border-border-subtle"} rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary text-text-primary`}),F.datum_dokumenta&&e.jsx("p",{className:"mt-1 text-body-xs text-red-400",children:F.datum_dokumenta})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-secondary mb-2",children:"Datum veljavnosti"}),e.jsx("input",{type:"date",value:P.datum_veljavnosti,onChange:X=>L({...P,datum_veljavnosti:X.target.value}),className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary text-text-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-secondary mb-2",children:"Opis dokumentacije"}),e.jsx("textarea",{value:P.opis_dokumentacije,onChange:X=>L({...P,opis_dokumentacije:X.target.value}),rows:4,className:"w-full px-3 py-2 bg-bg-surface border border-border-subtle rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-primary/50 focus:border-accent-primary text-text-primary",placeholder:"Vnesite podrobneji opis dokumentacije"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-body-sm font-medium text-text-secondary mb-2",children:"Naloi dokument"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"inline-flex items-center gap-2 px-4 py-2 bg-bg-surface-hover border border-border-subtle rounded-lg hover:bg-bg-surface-active transition-colors duration-200 cursor-pointer text-text-secondary",children:[e.jsx(Xa,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm",children:"Izberi datoteko"}),e.jsx("input",{type:"file",onChange:ce,className:"hidden",accept:".pdf,.doc,.docx,.txt"})]}),_&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Rt,{className:"w-4 h-4 text-green-400"}),e.jsx("span",{className:"text-body-sm text-text-secondary",children:_.name})]})]}),e.jsx("p",{className:"mt-1 text-body-xs text-text-tertiary",children:"Podprte vrste datotek: PDF, DOC, DOCX, TXT"})]}),e.jsxs("div",{className:"flex items-center gap-3 pt-4",children:[e.jsx("button",{type:"submit",disabled:a,className:"flex-1 inline-flex items-center justify-center gap-2 px-4 py-2 bg-accent-primary text-white rounded-lg hover:bg-accent-primary/90 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:a?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Shranjujem..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Rt,{className:"w-4 h-4"}),g?"Posodobi":"Shrani"]})}),e.jsx("button",{type:"button",onClick:()=>{m(!1),O()},className:"px-4 py-2 bg-bg-surface-hover border border-border-subtle rounded-lg hover:bg-bg-surface-active transition-colors duration-200 text-text-secondary",children:"Preklii"})]})]})]})})}),x&&h&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-heading-xl font-semibold text-text-primary",children:"Podrobnosti dokumenta"}),e.jsx("button",{onClick:()=>b(!1),className:"p-2 text-text-tertiary hover:text-text-primary rounded-lg hover:bg-bg-surface-hover transition-colors duration-200",children:e.jsx(Ss,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-body-sm font-medium text-text-secondary",children:"Naziv dokumentacije"}),e.jsx("p",{className:"text-body text-text-primary mt-1",children:h.naziv_dokumentacije})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-body-sm font-medium text-text-secondary",children:"Datum dokumenta"}),e.jsx("p",{className:"text-body text-text-primary mt-1",children:B(h.datum_dokumenta)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-body-sm font-medium text-text-secondary",children:"Datum veljavnosti"}),e.jsx("p",{className:"text-body text-text-primary mt-1",children:B(h.datum_veljavnosti)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-body-sm font-medium text-text-secondary",children:"Opis dokumentacije"}),e.jsx("p",{className:"text-body text-text-primary mt-1",children:h.opis_dokumentacije||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-body-sm font-medium text-text-secondary",children:"Status datoteke"}),e.jsx("div",{className:"mt-1",children:h.pot_do_dokumenta?e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-2 rounded-lg bg-green-500/10 border border-green-500/30",children:[e.jsx(Pb,{className:"w-4 h-4 text-green-400"}),e.jsx("span",{className:"text-body-sm text-green-400",children:"Datoteka naloena"})]}):e.jsx("span",{className:"text-body text-text-tertiary",children:"Datoteka ni naloena"})})]})]})]})})})]})}const hh=[{id:"gdpr-1",request_id:"ZVOP-2025-001",subject_name:"Ana Novak",subject_email:"ana.novak@email.com",request_date:"2025-10-15T08:30:00Z",request_type:"pravica do pozabe",status:"processing",response_deadline:"2025-11-08T23:59:59Z",legal_basis_description:"Zahteva za izbris osebnih podatkov zaradi preklica soglasja",data_categories:["Kontaktni podatki","Demografski podatki"],data_description:"Ime, priimek, elektronski naslov, telefonska tevilka"},{id:"gdpr-2",request_id:"ZVOP-2025-002",subject_name:"Marko Kova",subject_email:"marko.kovac@podjetje.si",request_date:"2025-10-20T14:15:00Z",request_type:"dostop do podatkov",status:"received",response_deadline:"2025-11-09T23:59:59Z",legal_basis_description:"Zahteva za dostop do osebnih podatkov po 15. lenu GDPR",data_categories:["Kadrovski podatki","Plailni podatki"],data_description:"Mesene plae, boniteti, davne informacije"},{id:"gdpr-3",request_id:"ZVOP-2025-003",subject_name:"Petra Horvat",subject_email:"petra.horvat@gmail.com",request_date:"2025-10-25T10:45:00Z",request_type:"pravica do pozabe",status:"additional_info_required",response_deadline:"2025-11-07T23:59:59Z",legal_basis_description:"Izbris podatkov po zakljuku sodelovanja",data_categories:["Kontaktni podatki","Naslovni podatki"],data_description:"Naslov stalnega bivalia, kontaktni podatki"}],xh=[{id:"demo-1",stevilo_prijave:"ZP-2025-001",datum_prijave:"2025-11-01T10:30:00Z",kratek_opis:"Sum korupcije pri dodeljevanju javnih naroil - neupravieno favorisiranje doloenega ponudnika",podrocje:"korupcija",narava_prijave:"anomalija v postopku javnega naroanja",anonimna:!1,status:"v obravnavi",datum_potrditev:"2025-11-10T10:30:00Z",datum_resitve:"2025-11-12T10:30:00Z",odgovorna_oseba:"Marko Novak",zaupnik_id:"zaupnik-1",zaupnik:{ime:"Ana",priimek:"Kova"}},{id:"demo-2",stevilo_prijave:"ZP-2025-002",datum_prijave:"2025-11-05T14:15:00Z",kratek_opis:"Sistemski mobing s strani neposredno nadrejenega - psihino nadlegovanje in izolacija",podrocje:"mobing",narava_prijave:"nesprejemljivo vedenje na delovnem mestu",anonimna:!0,status:"prejeta",datum_potrditev:"2025-11-11T14:15:00Z",datum_resitve:"2025-11-13T14:15:00Z",odgovorna_oseba:"Tanja Horvat",zaupnik_id:"zaupnik-2",zaupnik:{ime:"Petra",priimek:"Potonik"}},{id:"demo-3",stevilo_prijave:"ZP-2025-003",datum_prijave:"2025-11-06T09:45:00Z",kratek_opis:"Prekoraitev pooblastil pri zaposlovanju - neupravieno favorisiranje sorodnikov",podrocje:"prekoraitev pooblastil",narava_prijave:"nepravilnosti v lovekih virih",anonimna:!1,status:"prejeta",datum_potrditev:"2025-11-11T09:45:00Z",datum_resitve:"2025-11-15T09:45:00Z",odgovorna_oseba:"Janez Kranjc",zaupnik_id:"zaupnik-3",zaupnik:{ime:"Luka",priimek:"Bergant"}}];function NE({onNavigate:s}){const{t}=et(),{user:r}=cr(),[a,n]=z.useState([]),[i,o]=z.useState([]),[c,d]=z.useState([]),[p,m]=z.useState([]),[x,b]=z.useState(!0),[h,j]=z.useState(null),[g,v]=z.useState(null),[_,k]=z.useState(!1),[P,L]=z.useState(null);z.useEffect(()=>{(async()=>{if(r)try{const{data:I,error:Y}=await Ne.from("profiles").select("*, organization_id").eq("id",r.id).single();if(Y)throw Y;j(I)}catch(I){console.error("Error fetching user profile:",I)}})()},[r]),z.useEffect(()=>{if(h!=null&&h.organization_id){F(),W(),re(),R();const q=Ne.channel("incidents-changes").on("postgres_changes",{event:"*",schema:"public",table:"incidents"},()=>{F()}).subscribe(),I=Ne.channel("prijave-changes").on("postgres_changes",{event:"*",schema:"public",table:"prijave"},()=>{W()}).subscribe(),Y=Ne.channel("gdpr-zahtevki-changes").on("postgres_changes",{event:"*",schema:"public",table:"gdpr_right_forgotten"},()=>{re()}).subscribe();return()=>{Ne.removeChannel(q),Ne.removeChannel(I),Ne.removeChannel(Y)}}},[h]);async function F(){if(!(h!=null&&h.organization_id)){b(!1);return}b(!0);try{const{data:q}=await Ne.from("incidents").select("*").eq("organization_id",h.organization_id).order("created_at",{ascending:!1});n(q||[])}catch(q){console.error("Error loading incidents:",q)}finally{b(!1)}}async function W(){if(!(h!=null&&h.organization_id)){o(xh);return}try{const{data:q,error:I}=await Ne.from("prijave").select(`
          *,
          zaupnik:zaupniki(ime, priimek)
        `).eq("organization_id",h.organization_id).order("created_at",{ascending:!1});I?(console.error("Supabase error:",I),o(xh)):!q||q.length===0?o(xh):o(q)}catch(q){console.error("Error loading prijave:",q),o(xh)}}async function R(){if(!(h!=null&&h.organization_id)){m([]);return}try{const{data:q,error:I}=await Ne.from("inventory_licenses").select("*").eq("organization_id",h.organization_id).order("expiry_date",{ascending:!0});I?(console.error("Supabase error:",I),m([])):(console.log("Loaded licenses:",q),m(q||[]))}catch(q){console.error("Error loading licenses:",q),m([])}}const B=q=>q?q.length<=4?q:`${"*".repeat(q.length-4)}${q.slice(-4)}`:"-",A=async(q,I)=>{try{await navigator.clipboard.writeText(q),v(I),setTimeout(()=>v(null),2e3)}catch(Y){console.error("Copy failed:",Y)}},S=q=>{const I={perpetual:"bg-blue-500/20 text-blue-400 border-blue-500/30",subscription:"bg-green-500/20 text-green-400 border-green-500/30",trial:"bg-orange-500/20 text-orange-400 border-orange-500/30"};return I[q]||I.subscription},C=q=>{if(!q)return!1;const I=new Date(q),Y=new Date,H=Math.floor((I.getTime()-Y.getTime())/(1e3*60*60*24));return H<=30&&H>=0},O=q=>q?new Date(q)<new Date:!1,Z=p.filter(q=>C(q.expiry_date)&&q.status==="active"),te=p.filter(q=>O(q.expiry_date)&&q.status==="active"),ce=p.filter(q=>!q.seats||q.seats===0?!1:q.seats_used/q.seats*100>=90&&q.status==="active");async function re(){if(!(h!=null&&h.organization_id)){d(hh);return}try{const{data:q,error:I}=await Ne.from("gdpr_right_forgotten").select("*").eq("organization_id",h.organization_id).order("request_date",{ascending:!1});I?(console.error("Supabase error:",I),d(hh)):!q||q.length===0?d(hh):d(q)}catch(q){console.error("Error loading GDPR zahtevki:",q),d(hh)}}const X=q=>{const I=new Date(q),H=new Date().getTime()-I.getTime();return Math.floor(H/(1e3*60*60*24))},U=q=>{const I=new Date(q),Y=new Date,H=I.getTime()-Y.getTime();return Math.ceil(H/(1e3*60*60*24))},oe=a.filter(q=>X(q.detected_at)>1&&q.status!=="resolved"),xe=i.filter(q=>{if(q.status==="reena")return!1;if(q.datum_potrditev&&U(q.datum_potrditev)<3)return!0;if(q.datum_resitve){const I=U(q.datum_resitve);if(I<3&&I>=0)return!0}return!1}),J=c.filter(q=>q.status==="executed"?!1:!!(q.response_deadline&&U(q.response_deadline)<0)),$=q=>{const I={prejeta:{color:"text-blue-400",bg:"bg-blue-500/10",border:"border-blue-500/30",label:"Prejeta"},"v obravnavi":{color:"text-orange-400",bg:"bg-orange-500/10",border:"border-orange-500/30",label:"V obravnavi"},reena:{color:"text-green-400",bg:"bg-green-500/10",border:"border-green-500/30",label:"Reena"},zavrnjena:{color:"text-red-400",bg:"bg-red-500/10",border:"border-red-500/30",label:"Zavrnjena"}};return I[q]||I.prejeta},Q=q=>{L(q),k(!0),console.log("Opening incident modal for:",q)};return x?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})}):h!=null&&h.organization_id?e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:"Opozorila"}),e.jsx("p",{className:"text-body text-text-secondary",children:"Pregled vseh opozoril in kritinih situacij, ki zahtevajo takojnjo pozornost"})]}),e.jsx("div",{className:"w-20 h-20 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center shadow-lg",children:e.jsx(er,{className:"w-10 h-10 text-white"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6",children:[e.jsxs("div",{className:"bg-bg-surface p-6 rounded-lg border border-border-subtle",children:[e.jsx("div",{className:"text-caption text-text-secondary mb-2",children:"Skupaj opozoril"}),e.jsx("div",{className:"text-display-lg font-bold text-text-primary",children:oe.length+xe.length+J.length+Z.length+te.length+ce.length})]}),e.jsxs("div",{className:"bg-red-500/10 p-6 rounded-lg border border-red-500/30",children:[e.jsx("div",{className:"text-caption text-red-400 mb-2",children:"NIS 2 in ZInfV-1"}),e.jsx("div",{className:"text-display-lg font-bold text-red-400",children:oe.length})]}),e.jsxs("div",{className:"bg-orange-500/10 p-6 rounded-lg border border-orange-500/30",children:[e.jsx("div",{className:"text-caption text-orange-400 mb-2",children:"ZZPri"}),e.jsx("div",{className:"text-display-lg font-bold text-orange-400",children:xe.length})]}),e.jsxs("div",{className:"bg-purple-500/10 p-6 rounded-lg border border-purple-500/30",children:[e.jsx("div",{className:"text-caption text-purple-400 mb-2",children:"GDPR in ZVOP-2"}),e.jsx("div",{className:"text-display-lg font-bold text-purple-400",children:J.length})]}),e.jsxs("div",{className:"bg-purple-500/10 p-6 rounded-lg border border-purple-500/30",children:[e.jsx("div",{className:"text-caption text-purple-400 mb-2",children:"Potek licenc"}),e.jsx("div",{className:"text-display-lg font-bold text-purple-400",children:Z.length+te.length})]})]}),oe.length>0&&e.jsxs("div",{className:"bg-red-500/5 border-2 border-red-500/30 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-red-500/20 border border-red-500/40 flex items-center justify-center",children:e.jsx(pt,{className:"w-6 h-6 text-red-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-heading-lg font-semibold text-red-400",children:"Opozorila za poroanje po NIS 2 in ZInfV-1"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Incidenti, ki so bili zaznani pred ve kot 1 dnem in zahtevajo takojnjo pozornost"})]})]}),e.jsx("div",{className:"mb-3",children:e.jsx("h3",{className:"text-body-lg font-semibold text-text-primary",children:"NIS 2 in ZInfV-1"})}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-red-500/10 border-b border-red-500/20",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-semibold text-red-400",children:"ID incidenta"}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-semibold text-red-400",children:"Tip incidenta"}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-semibold text-red-400",children:"Datum zaznave"}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-semibold text-red-400",children:"Dni od zaznave"}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-semibold text-red-400",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-semibold text-red-400",children:"Akcije"})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:oe.map(q=>{const I=X(q.detected_at);return e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"font-mono text-body-sm text-text-primary",children:q.incident_id})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"text-body-sm text-text-primary",children:q.type})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"text-body-sm text-text-primary",children:new Date(q.detected_at).toLocaleDateString("sl-SI")})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:"text-body-sm font-medium text-red-400",children:[I," dni"]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(vr,{type:"status",value:q.status})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("button",{onClick:()=>Q(q),className:"inline-flex items-center gap-1 px-3 py-1 text-body-xs font-medium text-red-400 hover:text-red-300 hover:bg-red-500/10 rounded-lg transition-colors duration-200",children:[e.jsx(ut,{className:"w-4 h-4"}),"Pregled"]})})]},q.id)})})]})})})]}),J.length>0&&e.jsxs("div",{className:"bg-red-500/5 border-2 border-red-500/30 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-red-500/20 border border-red-500/40 flex items-center justify-center",children:e.jsx(pr,{className:"w-6 h-6 text-red-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-heading-lg font-semibold text-red-400",children:"Opozorila o preteku zahtevkov za izbris"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Zahtevki, kjer je potekel rok odgovora in zahtevajo takojnjo pozornost"})]})]}),e.jsx("div",{className:"mb-3",children:e.jsx("h3",{className:"text-body-lg font-semibold text-text-primary",children:"GDPR in ZVOP-2"})}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-red-500/10 border-b border-red-500/20",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-semibold text-red-400",children:"ID zahtevka"}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-semibold text-red-400",children:"Ime"}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-semibold text-red-400",children:"Email"}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-semibold text-red-400",children:"Tip"}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-semibold text-red-400",children:"Rok"}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-semibold text-red-400",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-semibold text-red-400",children:"Akcije"})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:J.map(q=>{const I=Math.abs(U(q.response_deadline)),Y={received:{color:"text-blue-400",label:"Prejeto"},processing:{color:"text-orange-400",label:"V obdelavi"},executed:{color:"text-green-400",label:"Izvreno"},rejected:{color:"text-red-400",label:"Zavrnjeno"},additional_info_required:{color:"text-purple-400",label:"Dodatne info"}},H=Y[q.status]||Y.received;return e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"font-mono text-body-sm text-text-primary",children:q.request_id})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"text-body-sm text-text-primary",children:q.subject_name})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"text-body-sm text-text-secondary",children:q.subject_email})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"text-body-sm text-text-primary capitalize",children:q.request_type})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"text-body-sm font-medium text-red-400",children:[I," dni zamude"]}),e.jsxs("span",{className:"text-body-xs text-text-secondary",children:["Rok: ",new Date(q.response_deadline).toLocaleDateString("sl-SI")]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pt,{className:`w-4 h-4 ${H.color}`}),e.jsx("span",{className:"text-body-sm text-text-primary",children:H.label})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("button",{className:"inline-flex items-center gap-1 px-3 py-1 text-body-xs font-medium text-red-400 hover:text-red-300 hover:bg-red-500/10 rounded-lg transition-colors duration-200",children:[e.jsx(ut,{className:"w-4 h-4"}),"Pregled"]})})]},q.id)})})]})})})]}),oe.length===0&&e.jsxs("div",{className:"bg-green-500/5 border-2 border-green-500/30 rounded-lg p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-green-500/20 border border-green-500/40 flex items-center justify-center mx-auto mb-4",children:e.jsx(pt,{className:"w-8 h-8 text-green-400"})}),e.jsx("h3",{className:"text-heading-md font-medium text-text-primary mb-2",children:"Ni opozoril"}),e.jsx("p",{className:"text-body text-text-secondary",children:"Vsi incidenti so ustrezno obravnavani. Odlino delo!"})]}),xe.length>0&&e.jsxs("div",{className:"bg-red-500/5 border-2 border-red-500/30 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-red-500/20 border border-red-500/40 flex items-center justify-center",children:e.jsx(Mt,{className:"w-6 h-6 text-red-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-heading-lg font-semibold text-red-400",children:"Opozorila o kritinih rokih za ZZPri"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Prijave, ki potrebujejo takojnjo pozornost zaradi bliajoih se rokov"})]})]}),e.jsx("div",{className:"mb-3",children:e.jsx("h3",{className:"text-body-lg font-semibold text-text-primary",children:"ZZPri"})}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-red-500/10 border-b border-red-500/20",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-semibold text-red-400",children:"ID"}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-semibold text-red-400",children:"Naslov"}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-semibold text-red-400",children:"Tip prijave"}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-semibold text-red-400",children:"Rok"}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-semibold text-red-400",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-semibold text-red-400",children:"Akcije"})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:xe.map(q=>{const I=$(q.status),Y=pt;let H="",he="",ge="";if(q.datum_potrditev)try{const K=new Date(q.datum_potrditev);if(!isNaN(K.getTime())){const T=U(q.datum_potrditev);T>=0&&(H=`${T} dni`,he=q.datum_potrditev,ge="Potrditev")}}catch{console.warn("Invalid date for potrditev:",q.datum_potrditev)}if(q.datum_resitve)try{const K=new Date(q.datum_resitve);if(!isNaN(K.getTime())){const T=U(q.datum_resitve);T>=0&&(T<parseInt(H)||!H)&&(H=`${T} dni`,he=q.datum_resitve,ge="Reitev")}}catch{console.warn("Invalid date for resitve:",q.datum_resitve)}return e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"font-mono text-body-sm text-text-primary",children:q.stevilo_prijave})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("p",{className:"text-body-sm text-text-primary line-clamp-2 max-w-xs",children:q.kratek_opis})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"text-body-sm text-text-primary capitalize",children:q.podrocje})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-body-sm font-medium text-red-400",children:H}),e.jsx("span",{className:"text-body-xs text-text-secondary",children:ge})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:`w-4 h-4 ${I.color}`}),e.jsx("span",{className:"text-body-sm text-text-primary",children:I.label})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("button",{className:"inline-flex items-center gap-1 px-3 py-1 text-body-xs font-medium text-red-400 hover:text-red-300 hover:bg-red-500/10 rounded-lg transition-colors duration-200",children:[e.jsx(ut,{className:"w-4 h-4"}),"Pregled"]})})]},q.id)})})]})})})]}),p.length>0&&e.jsxs("div",{className:"bg-red-500/5 border-2 border-red-500/30 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-red-500/20 border border-red-500/40 flex items-center justify-center",children:e.jsx(ix,{className:"w-6 h-6 text-red-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-heading-lg font-semibold text-text-primary",children:"Veljavnost programske opreme in licenc"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Pregled vseh licenc in programske opreme v organizaciji"})]})]}),e.jsx("div",{className:"mb-3",children:e.jsx("h3",{className:"text-body-lg font-semibold text-text-primary",children:"Veljavnost programske opreme in licenc"})}),e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-surface-hover border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-semibold text-text-primary",children:"Licenni klju"}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-semibold text-text-primary",children:"Program"}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-semibold text-text-primary",children:"Tip"}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-semibold text-text-primary",children:"Uporaba sedeev"}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-semibold text-text-primary",children:"Dodeljeno"}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-semibold text-text-primary",children:"Potee"}),e.jsx("th",{className:"px-4 py-3 text-left text-body-sm font-semibold text-text-primary",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:p.map(q=>{const I=q.seats?Math.round(q.seats_used/q.seats*100):0,Y=q.expiry_date?Math.floor((new Date(q.expiry_date).getTime()-new Date().getTime())/(1e3*60*60*24)):null,H=C(q.expiry_date),he=O(q.expiry_date),ge=I>=90;return e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-body-sm text-text-primary font-mono",children:B(q.license_key)}),e.jsx("button",{onClick:()=>A(q.license_key,q.id),className:"p-1 rounded hover:bg-gray-700/50 text-gray-400 hover:text-white transition-colors",title:"Kopiraj celoten klju",children:g===q.id?e.jsx(Cb,{className:"w-3 h-3 text-green-400"}):e.jsx(Tp,{className:"w-3 h-3"})})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"text-body-sm text-text-primary font-medium",children:q.software_name})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium border ${S(q.license_type)}`,children:q.license_type})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:`text-body-sm ${ge?"text-red-400":"text-text-secondary"}`,children:[q.seats_used||0,"/",q.seats||0]}),q.seats&&e.jsxs("span",{className:`text-caption font-medium ${ge?"text-red-400":"text-blue-400"}`,children:["(",I,"%)"]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"text-body-sm text-text-secondary",children:q.assigned_to||"-"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:`text-body-sm ${H?"text-yellow-400":he?"text-red-400":"text-text-primary"}`,children:[q.expiry_date?new Date(q.expiry_date).toLocaleDateString("sl-SI"):"-",H&&q.expiry_date&&` (${Y} dni)`,he&&q.expiry_date&&" (potekla)"]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`text-body-sm ${$(q.status).color}`,children:$(q.status).label})})]},q.id)})})]})})})]}),e.jsx(Ag,{isOpen:_,onClose:()=>{k(!1),L(null)},incident:P})]}):e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center shadow-lg mx-auto mb-3",children:e.jsx(er,{className:"w-8 h-8 text-white"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-300 mb-2",children:t("common.organizationRequired")}),e.jsx("p",{className:"text-gray-400",children:t("common.organizationRequiredDescription")})]})})}const wE=({isOpen:s,onClose:t,onSave:r})=>{const{t:a}=et(),n=[{key:"procedure_id",label:a("modals.add.common.procedureId"),type:"text",required:!0},{key:"procedure_name",label:a("modals.add.common.procedureName"),type:"text",required:!0},{key:"category",label:a("modals.add.common.category"),type:"text",required:!0},{key:"version",label:a("modals.add.common.version"),type:"text",required:!0},{key:"content",label:a("modals.add.common.content"),type:"textarea",required:!1},{key:"status",label:a("modals.add.common.status"),type:"select",options:["draft","under_review","approved","active","superseded","expired"]},{key:"approved_by",label:a("modals.add.common.approvedBy"),type:"text"},{key:"approval_date",label:a("modals.add.common.approvalDate"),type:"date"},{key:"review_date",label:a("modals.add.common.reviewDate"),type:"date"}];return e.jsx(ha,{isOpen:s,onClose:t,onSave:r,title:a("modals.add.procedure.title"),table:"procedures",fields:n})};function SE(){const{t:s}=et(),[t,r]=z.useState([]),[a,n]=z.useState([]),[i,o]=z.useState(!0),[c,d]=z.useState(!1),[p,m]=z.useState(!1),[x,b]=z.useState(null),[h,j]=z.useState(!1),[g,v]=z.useState(!1),[_,k]=z.useState(!1),[P,L]=z.useState(null),[F,W]=z.useState({procedure_name:"",category:"",version:"",content:"",status:"draft",approved_by:"",approval_date:"",review_date:""}),[R,B]=z.useState(!1),[A,S]=z.useState(!1),[C,O]=z.useState(!1),[Z,te]=z.useState(""),[ce,re]=z.useState("all"),[X,U]=z.useState("all");z.useEffect(()=>{oe()},[]),z.useEffect(()=>{xe()},[t,Z,ce,X]);const oe=async()=>{try{const{data:T,error:ee}=await Ne.from("procedures").select("*").order("created_at",{ascending:!1});if(ee)throw ee;r(T||[])}catch(T){console.error("Error:",T)}finally{o(!1)}},xe=()=>{let T=[...t];if(Z.trim()){const ee=Z.toLowerCase();T=T.filter(_e=>{var ke,ue,je;return((ke=_e.procedure_name)==null?void 0:ke.toLowerCase().includes(ee))||((ue=_e.category)==null?void 0:ue.toLowerCase().includes(ee))||((je=_e.procedure_id)==null?void 0:je.toLowerCase().includes(ee))})}ce!=="all"&&(T=T.filter(ee=>ee.status===ce)),X!=="all"&&(T=T.filter(ee=>ee.category===X)),n(T)},J=async()=>{await oe()},$=T=>{b(T),j(!0)},Q=()=>{j(!1),b(null)},q=T=>{L(T),W({procedure_name:T.procedure_name||"",category:T.category||"",version:T.version||"",content:T.content||"",status:T.status||"draft",approved_by:T.approved_by||"",approval_date:T.approval_date?new Date(T.approval_date).toISOString().split("T")[0]:"",review_date:T.review_date?new Date(T.review_date).toISOString().split("T")[0]:""}),v(!0)},I=async T=>{if(T.preventDefault(),!!P){B(!0);try{const ee={procedure_name:F.procedure_name,category:F.category,version:F.version,content:F.content,status:F.status};F.approved_by&&(ee.approved_by=F.approved_by),F.approval_date&&(ee.approval_date=F.approval_date),F.review_date&&(ee.review_date=F.review_date);const{error:_e}=await Ne.from("procedures").update(ee).eq("id",P.id);if(_e)throw _e;await J(),v(!1),L(null)}catch(ee){console.error("Error updating document:",ee),alert(s("procedures.errors.update"))}finally{B(!1)}}},Y=T=>{L(T),k(!0)},H=async()=>{if(P){S(!0);try{const{error:T}=await Ne.from("procedures").delete().eq("id",P.id);if(T)throw T;await J(),k(!1),L(null)}catch(T){console.error("Error deleting document:",T),alert(s("procedures.errors.delete"))}finally{S(!1)}}},he=()=>{O(!0);try{const T=[s("procedures.table.procedureId"),s("procedures.table.procedureName"),s("procedures.table.type"),s("procedures.table.category"),s("procedures.table.version"),s("procedures.table.status"),s("procedures.table.content"),s("procedures.table.approvedBy"),s("procedures.table.approvalDate"),s("procedures.table.reviewDate"),s("common.createdAt"),s("common.updatedAt")],ee=a.map(je=>[je.procedure_id||"-",je.procedure_name||"-",je.category||"-",je.category||"-",je.version||"-",je.status||"-",je.content?je.content.replace(/[\r\n]+/g," ").replace(/;/g,","):"-",je.approved_by||"-",je.approval_date?new Date(je.approval_date).toLocaleDateString("sl-SI"):"-",je.review_date?new Date(je.review_date).toLocaleDateString("sl-SI"):"-",new Date(je.created_at).toLocaleString("sl-SI"),je.updated_at?new Date(je.updated_at).toLocaleString("sl-SI"):"-"]),_e=[T,...ee].map(je=>je.join(";")).join(`
`),ke=new Blob(["\uFEFF"+_e],{type:"text/csv;charset=utf-8;"}),ue=document.createElement("a");ue.href=URL.createObjectURL(ke),ue.download=`${s("procedures.exportFilename")}_${new Date().toISOString().split("T")[0]}.csv`,ue.click(),URL.revokeObjectURL(ue.href)}catch(T){console.error("Export error:",T),alert(s("procedures.errors.export"))}finally{O(!1)}},ge=T=>{if(!T)return!1;const ee=new Date("2025-11-01"),_e=new Date(T),ke=Math.floor((_e.getTime()-ee.getTime())/(1e3*60*60*24));return ke>0&&ke<=30},K=T=>{const ee={active:"bg-green-500/20 text-green-400 border-green-500/30",approved:"bg-blue-500/20 text-blue-400 border-blue-500/30",under_review:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",draft:"bg-gray-500/20 text-gray-400 border-gray-500/30",superseded:"bg-orange-500/20 text-orange-400 border-orange-500/30",expired:"bg-red-500/20 text-red-400 border-red-500/30"};return ee[T]||ee.draft};return i?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-accent-primary/10 flex items-center justify-center",children:e.jsx(ut,{className:"w-5 h-5 text-accent-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:s("procedures.title")}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:s("procedures.subtitle")})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>m(!0),className:"h-10 px-4 bg-green-600 hover:bg-green-700 text-white rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Xa,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:s("procedures.importCSV")})]}),e.jsxs("button",{onClick:()=>d(!0),className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Dt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:s("procedures.addProcedure")})]})]})]}),e.jsx("div",{className:"bg-bg-surface rounded-sm border border-border-subtle p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ss,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-text-secondary"}),e.jsx("input",{type:"text",placeholder:s("procedures.searchPlaceholder"),value:Z,onChange:T=>te(T.target.value),className:"w-full pl-10 pr-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary placeholder-text-tertiary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("select",{value:ce,onChange:T=>re(T.target.value),className:"px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"all",children:s("procedures.filters.statusAll")}),e.jsx("option",{value:"draft",children:s("common.statusOptions.draft")}),e.jsx("option",{value:"under_review",children:s("common.statusOptions.under_review")}),e.jsx("option",{value:"approved",children:s("common.statusOptions.approved")}),e.jsx("option",{value:"active",children:s("common.statusOptions.active")}),e.jsx("option",{value:"superseded",children:s("common.statusOptions.superseded")}),e.jsx("option",{value:"expired",children:s("common.statusOptions.expired")})]}),e.jsxs("select",{value:X,onChange:T=>U(T.target.value),className:"px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"all",children:s("procedures.filters.categoryAll")}),e.jsx("option",{value:"Security",children:s("common.categoryOptions.Security")}),e.jsx("option",{value:"IT Operations",children:s("common.categoryOptions.IT Operations")}),e.jsx("option",{value:"HR",children:s("common.categoryOptions.HR")}),e.jsx("option",{value:"Compliance",children:s("common.categoryOptions.Compliance")}),e.jsx("option",{value:"Data Governance",children:s("common.categoryOptions.Data Governance")}),e.jsx("option",{value:"Legal",children:s("common.categoryOptions.Legal")})]}),e.jsxs("button",{onClick:he,disabled:a.length===0||C,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded transition-colors duration-150 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap",children:[e.jsx(Ir,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:s(C?"procedures.exporting":"procedures.exportCSV")})]})]})}),e.jsxs("div",{className:"bg-bg-surface rounded-sm border border-border-subtle overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-pure-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("procedures.table.document")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("procedures.table.type")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("procedures.table.category")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("procedures.table.version")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("procedures.table.status")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("procedures.table.approvedBy")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("procedures.table.review")}),e.jsx("th",{className:"text-center px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("common.actions")})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:a.map(T=>{const ee=ge(T.review_date);return e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 text-body text-text-primary font-medium",children:T.procedure_name}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:T.category}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:s(`common.categoryOptions.${T.category}`)||T.category}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:T.version}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium border ${K(T.status)}`,children:s(`common.statusOptions.${T.status}`)||T.status})}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:T.approved_by||"-"}),e.jsx("td",{className:"px-6 py-4",children:T.review_date?e.jsxs("div",{className:"flex items-center gap-2",children:[ee&&e.jsx(pt,{className:"w-4 h-4 text-yellow-400",title:s("procedures.reviewSoon")}),e.jsx("span",{className:`text-body ${ee?"text-yellow-400 font-medium":"text-text-secondary"}`,children:new Date(T.review_date).toLocaleDateString("sl-SI")})]}):e.jsx("span",{className:"text-body text-text-tertiary",children:"-"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("button",{onClick:()=>$(T),className:"p-2 rounded-lg bg-blue-600/20 hover:bg-blue-600/30 text-blue-400 transition-colors",title:s("procedures.viewDetails"),children:e.jsx(lr,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>q(T),className:"p-2 rounded-lg bg-yellow-600/20 hover:bg-yellow-600/30 text-yellow-400 transition-colors",title:s("procedures.editProcedure"),children:e.jsx(ar,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Y(T),className:"p-2 rounded-lg bg-red-600/20 hover:bg-red-600/30 text-red-400 transition-colors",title:s("procedures.deleteProcedure"),children:e.jsx(pr,{className:"w-4 h-4"})})]})})]},T.id)})})]})}),a.length===0&&e.jsx("div",{className:"text-center py-12 text-text-secondary",children:s("procedures.noDocuments")})]}),e.jsx(wE,{isOpen:c,onClose:()=>d(!1),onSave:J}),e.jsx(mx,{isOpen:p,onClose:()=>m(!1),tableName:"procedures",title:s("procedures.importTitle"),columns:["procedure_name","category","category","version","status","content","approved_by","approval_date","review_date"],sampleData:"procedure_name;category;category;version;status;content;approved_by;approval_date;review_date\\nPrimer dokumenta;policy;IT Security;1.0;draft;Vsebina dokumenta;Ime Priimek;2025-01-01;2025-12-01",onSuccess:J}),h&&x&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm",onClick:T=>{T.target===T.currentTarget&&Q()},children:e.jsxs("div",{className:"bg-gray-800 border border-gray-700/50 rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto shadow-2xl",children:[e.jsxs("div",{className:"sticky top-0 bg-gray-800 border-b border-gray-700/50 px-6 py-4 flex items-center justify-between z-10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ut,{className:"w-6 h-6 text-blue-400"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:x.procedure_name}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:s("procedures.detailsSubtitle")})]})]}),e.jsx("button",{onClick:Q,className:"p-2 rounded-lg hover:bg-gray-700/50 transition-colors",children:e.jsx(Ar,{className:"w-5 h-5 text-gray-400"})})]}),e.jsxs("div",{className:"px-6 py-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-3",children:[x.status&&e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium border ${K(x.status)}`,children:s(`common.statusOptions.${x.status}`)||x.status}),x.category&&e.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-medium bg-purple-500/20 text-purple-400 border border-purple-500/30",children:s(`common.categoryOptions.${x.category}`)||x.category}),ge(x.review_date)&&e.jsxs("span",{className:"px-3 py-1 rounded-full text-xs font-medium border bg-yellow-500/20 text-yellow-400 border-yellow-500/30 flex items-center gap-1",children:[e.jsx(pt,{className:"w-3 h-3"}),s("procedures.reviewSoon")]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:s("procedures.details.documentId")}),e.jsx("div",{className:"text-sm text-white font-mono",children:x.procedure_id||"-"})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:s("procedures.details.name")}),e.jsx("div",{className:"text-sm text-white font-medium",children:x.procedure_name})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:s("procedures.details.documentType")}),e.jsx("div",{className:"text-sm text-white",children:x.category||"-"})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:s("procedures.details.category")}),e.jsx("div",{className:"text-sm text-white",children:x.category||"-"})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:s("procedures.details.version")}),e.jsx("div",{className:"text-sm text-white font-medium",children:x.version})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:s("procedures.details.status")}),e.jsx("div",{className:"text-sm text-white",children:s(`common.statusOptions.${x.status}`)||x.status})]})]}),x.content&&e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:s("procedures.details.content")}),e.jsx("div",{className:"text-sm text-white whitespace-pre-wrap",children:x.content})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[x.approved_by&&e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:s("procedures.details.approvedBy")}),e.jsx("div",{className:"text-sm text-white",children:x.approved_by})]}),x.approval_date&&e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:s("procedures.details.approvalDate")}),e.jsx("div",{className:"text-sm text-white",children:new Date(x.approval_date).toLocaleDateString("sl-SI")})]}),x.review_date&&e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:s("procedures.details.reviewDate")}),e.jsx("div",{className:`text-sm font-medium ${ge(x.review_date)?"text-yellow-400":"text-white"}`,children:new Date(x.review_date).toLocaleDateString("sl-SI")})]})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-3",children:s("common.metadata")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:s("common.id")}),e.jsx("div",{className:"text-sm text-white font-mono break-all",children:x.id})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:s("common.createdAt")}),e.jsx("div",{className:"text-sm text-white",children:new Date(x.created_at).toLocaleString("sl-SI")})]}),x.updated_at&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:s("common.updatedAt")}),e.jsx("div",{className:"text-sm text-white",children:new Date(x.updated_at).toLocaleString("sl-SI")})]})]})]})]}),e.jsx("div",{className:"sticky bottom-0 bg-gray-800 border-t border-gray-700/50 px-6 py-4 flex justify-end",children:e.jsx("button",{onClick:Q,className:"px-6 py-2 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-lg transition-all duration-200",children:s("common.close")})})]})}),g&&P&&e.jsx(zs,{isOpen:g,onClose:()=>v(!1),title:s("procedures.editTitle"),children:e.jsxs("form",{onSubmit:I,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{htmlFor:"procedure_name",className:"block text-sm font-medium text-text-secondary mb-2",children:[s("procedures.form.procedureName")," ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"text",id:"procedure_name",value:F.procedure_name,onChange:T=>W(ee=>({...ee,procedure_name:T.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"category",className:"block text-sm font-medium text-text-secondary mb-2",children:[s("procedures.form.documentType")," ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsxs("select",{id:"category",value:F.category,onChange:T=>W(ee=>({...ee,category:T.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"policy",children:s("common.documentTypeOptions.policy")}),e.jsx("option",{value:"procedure",children:s("common.documentTypeOptions.procedure")}),e.jsx("option",{value:"guideline",children:s("common.documentTypeOptions.guideline")}),e.jsx("option",{value:"standard",children:s("common.documentTypeOptions.standard")}),e.jsx("option",{value:"form",children:s("common.documentTypeOptions.form")}),e.jsx("option",{value:"template",children:s("common.documentTypeOptions.template")}),e.jsx("option",{value:"other",children:s("common.documentTypeOptions.other")})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"category",className:"block text-sm font-medium text-text-secondary mb-2",children:[s("procedures.form.category")," ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"text",id:"category",value:F.category,onChange:T=>W(ee=>({...ee,category:T.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"version",className:"block text-sm font-medium text-text-secondary mb-2",children:[s("procedures.form.version")," ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"text",id:"version",value:F.version,onChange:T=>W(ee=>({...ee,version:T.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"status",className:"block text-sm font-medium text-text-secondary mb-2",children:[s("procedures.form.status")," ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsxs("select",{id:"status",value:F.status,onChange:T=>W(ee=>({...ee,status:T.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"draft",children:s("common.statusOptions.draft")}),e.jsx("option",{value:"under_review",children:s("common.statusOptions.under_review")}),e.jsx("option",{value:"approved",children:s("common.statusOptions.approved")}),e.jsx("option",{value:"active",children:s("common.statusOptions.active")}),e.jsx("option",{value:"superseded",children:s("common.statusOptions.superseded")}),e.jsx("option",{value:"expired",children:s("common.statusOptions.expired")})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"content",className:"block text-sm font-medium text-text-secondary mb-2",children:s("procedures.form.content")}),e.jsx("textarea",{id:"content",value:F.content,onChange:T=>W(ee=>({...ee,content:T.target.value})),rows:6,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary resize-none"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"approved_by",className:"block text-sm font-medium text-text-secondary mb-2",children:s("procedures.form.approvedBy")}),e.jsx("input",{type:"text",id:"approved_by",value:F.approved_by,onChange:T=>W(ee=>({...ee,approved_by:T.target.value})),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"approval_date",className:"block text-sm font-medium text-text-secondary mb-2",children:s("procedures.form.approvalDate")}),e.jsx("input",{type:"date",id:"approval_date",value:F.approval_date,onChange:T=>W(ee=>({...ee,approval_date:T.target.value})),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"review_date",className:"block text-sm font-medium text-text-secondary mb-2",children:s("procedures.form.reviewDate")}),e.jsx("input",{type:"date",id:"review_date",value:F.review_date,onChange:T=>W(ee=>({...ee,review_date:T.target.value})),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-border-subtle",children:[e.jsx("button",{type:"button",onClick:()=>v(!1),className:"px-6 py-2 bg-bg-near-black text-text-primary border border-border-subtle rounded hover:bg-bg-surface transition-colors duration-150",children:s("common.cancel")}),e.jsx("button",{type:"submit",disabled:R,className:"px-6 py-2 bg-accent-primary hover:bg-accent-primary-hover text-white rounded transition-colors duration-150 disabled:opacity-50",children:s(R?"common.saving":"common.save")})]})]})}),e.jsx(gi,{isOpen:_,onClose:()=>k(!1),onConfirm:H,title:s("procedures.deleteTitle"),message:s("procedures.deleteMessage",{name:P==null?void 0:P.procedure_name}),isDeleting:A})]})}const zE=({isOpen:s,onClose:t,onSave:r})=>{const{t:a}=et(),n=[{key:"policy_id",label:a("modals.add.common.policyId"),type:"text",required:!0},{key:"policy_name",label:a("modals.add.common.policyName"),type:"text",required:!0},{key:"category",label:a("modals.add.common.category"),type:"text",required:!0},{key:"version",label:a("modals.add.common.version"),type:"text",required:!0},{key:"content",label:a("modals.add.common.content"),type:"textarea",required:!1},{key:"status",label:a("modals.add.common.status"),type:"select",options:["draft","under_review","approved","active","superseded","expired"]},{key:"approved_by",label:a("modals.add.common.approvedBy"),type:"text"},{key:"approval_date",label:a("modals.add.common.approvalDate"),type:"date"},{key:"review_date",label:a("modals.add.common.reviewDate"),type:"date"}];return e.jsx(ha,{isOpen:s,onClose:t,onSave:r,title:a("modals.add.policy.title"),table:"policies",fields:n})};function CE(){const{t:s}=et(),[t,r]=z.useState([]),[a,n]=z.useState([]),[i,o]=z.useState(!0),[c,d]=z.useState(!1),[p,m]=z.useState(!1),[x,b]=z.useState(null),[h,j]=z.useState(!1),[g,v]=z.useState(!1),[_,k]=z.useState(!1),[P,L]=z.useState(null),[F,W]=z.useState({policy_name:"",category:"",version:"",content:"",status:"draft",approved_by:"",approval_date:"",review_date:""}),[R,B]=z.useState(!1),[A,S]=z.useState(!1),[C,O]=z.useState(!1),[Z,te]=z.useState(""),[ce,re]=z.useState("all"),[X,U]=z.useState("all");z.useEffect(()=>{oe()},[]),z.useEffect(()=>{xe()},[t,Z,ce,X]);const oe=async()=>{try{const{data:T,error:ee}=await Ne.from("policies").select("*").order("created_at",{ascending:!1});if(ee)throw ee;r(T||[])}catch(T){console.error("Error:",T)}finally{o(!1)}},xe=()=>{let T=[...t];if(Z.trim()){const ee=Z.toLowerCase();T=T.filter(_e=>{var ke,ue,je;return((ke=_e.policy_name)==null?void 0:ke.toLowerCase().includes(ee))||((ue=_e.category)==null?void 0:ue.toLowerCase().includes(ee))||((je=_e.policy_id)==null?void 0:je.toLowerCase().includes(ee))})}ce!=="all"&&(T=T.filter(ee=>ee.status===ce)),X!=="all"&&(T=T.filter(ee=>ee.category===X)),n(T)},J=async()=>{await oe()},$=T=>{b(T),j(!0)},Q=()=>{j(!1),b(null)},q=T=>{L(T),W({policy_name:T.policy_name||"",category:T.category||"",version:T.version||"",content:T.content||"",status:T.status||"draft",approved_by:T.approved_by||"",approval_date:T.approval_date?new Date(T.approval_date).toISOString().split("T")[0]:"",review_date:T.review_date?new Date(T.review_date).toISOString().split("T")[0]:""}),v(!0)},I=async T=>{if(T.preventDefault(),!!P){B(!0);try{const ee={policy_name:F.policy_name,category:F.category,version:F.version,content:F.content,status:F.status};F.approved_by&&(ee.approved_by=F.approved_by),F.approval_date&&(ee.approval_date=F.approval_date),F.review_date&&(ee.review_date=F.review_date);const{error:_e}=await Ne.from("policies").update(ee).eq("id",P.id);if(_e)throw _e;await J(),v(!1),L(null)}catch(ee){console.error("Error updating document:",ee),alert(s("policies.errors.update"))}finally{B(!1)}}},Y=T=>{L(T),k(!0)},H=async()=>{if(P){S(!0);try{const{error:T}=await Ne.from("policies").delete().eq("id",P.id);if(T)throw T;await J(),k(!1),L(null)}catch(T){console.error("Error deleting document:",T),alert(s("policies.errors.delete"))}finally{S(!1)}}},he=()=>{O(!0);try{const T=[s("policies.table.policyId"),s("policies.table.policyName"),s("policies.table.type"),s("policies.table.category"),s("policies.table.version"),s("policies.table.status"),s("policies.table.content"),s("policies.table.approvedBy"),s("policies.table.approvalDate"),s("policies.table.reviewDate"),s("common.createdAt"),s("common.updatedAt")],ee=a.map(je=>[je.policy_id||"-",je.policy_name||"-",je.category||"-",je.category||"-",je.version||"-",je.status||"-",je.content?je.content.replace(/[\r\n]+/g," ").replace(/;/g,","):"-",je.approved_by||"-",je.approval_date?new Date(je.approval_date).toLocaleDateString("sl-SI"):"-",je.review_date?new Date(je.review_date).toLocaleDateString("sl-SI"):"-",new Date(je.created_at).toLocaleString("sl-SI"),je.updated_at?new Date(je.updated_at).toLocaleString("sl-SI"):"-"]),_e=[T,...ee].map(je=>je.join(";")).join(`
`),ke=new Blob(["\uFEFF"+_e],{type:"text/csv;charset=utf-8;"}),ue=document.createElement("a");ue.href=URL.createObjectURL(ke),ue.download=`${s("policies.exportFilename")}_${new Date().toISOString().split("T")[0]}.csv`,ue.click(),URL.revokeObjectURL(ue.href)}catch(T){console.error("Export error:",T),alert(s("policies.errors.export"))}finally{O(!1)}},ge=T=>{if(!T)return!1;const ee=new Date("2025-11-01"),_e=new Date(T),ke=Math.floor((_e.getTime()-ee.getTime())/(1e3*60*60*24));return ke>0&&ke<=30},K=T=>{const ee={active:"bg-green-500/20 text-green-400 border-green-500/30",approved:"bg-blue-500/20 text-blue-400 border-blue-500/30",under_review:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",draft:"bg-gray-500/20 text-gray-400 border-gray-500/30",superseded:"bg-orange-500/20 text-orange-400 border-orange-500/30",expired:"bg-red-500/20 text-red-400 border-red-500/30"};return ee[T]||ee.draft};return i?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-accent-primary/10 flex items-center justify-center",children:e.jsx(ut,{className:"w-5 h-5 text-accent-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:s("policies.title")}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:s("policies.subtitle")})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>m(!0),className:"h-10 px-4 bg-green-600 hover:bg-green-700 text-white rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Xa,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:s("policies.importCSV")})]}),e.jsxs("button",{onClick:()=>d(!0),className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Dt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:s("policies.addPolicy")})]})]})]}),e.jsx("div",{className:"bg-bg-surface rounded-sm border border-border-subtle p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ss,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-text-secondary"}),e.jsx("input",{type:"text",placeholder:s("policies.searchPlaceholder"),value:Z,onChange:T=>te(T.target.value),className:"w-full pl-10 pr-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary placeholder-text-tertiary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("select",{value:ce,onChange:T=>re(T.target.value),className:"px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"all",children:s("policies.filters.statusAll")}),e.jsx("option",{value:"draft",children:s("common.statusOptions.draft")}),e.jsx("option",{value:"under_review",children:s("common.statusOptions.under_review")}),e.jsx("option",{value:"approved",children:s("common.statusOptions.approved")}),e.jsx("option",{value:"active",children:s("common.statusOptions.active")}),e.jsx("option",{value:"superseded",children:s("common.statusOptions.superseded")}),e.jsx("option",{value:"expired",children:s("common.statusOptions.expired")})]}),e.jsxs("select",{value:X,onChange:T=>U(T.target.value),className:"px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"all",children:s("policies.filters.categoryAll")}),e.jsx("option",{value:"Security",children:s("policies.categories.security")}),e.jsx("option",{value:"IT Operations",children:s("policies.categories.itOperations")}),e.jsx("option",{value:"HR",children:s("policies.categories.hr")}),e.jsx("option",{value:"Compliance",children:s("policies.categories.compliance")}),e.jsx("option",{value:"Data Governance",children:s("policies.categories.dataGovernance")}),e.jsx("option",{value:"Legal",children:s("policies.categories.legal")})]}),e.jsxs("button",{onClick:he,disabled:a.length===0||C,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded transition-colors duration-150 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap",children:[e.jsx(Ir,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:s(C?"policies.exporting":"policies.exportCSV")})]})]})}),e.jsxs("div",{className:"bg-bg-surface rounded-sm border border-border-subtle overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-pure-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("policies.table.document")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("policies.table.type")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("policies.table.category")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("policies.table.version")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("policies.table.status")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("policies.table.approvedBy")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("policies.table.review")}),e.jsx("th",{className:"text-center px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("common.actions")})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:a.map(T=>{const ee=ge(T.review_date);return e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 text-body text-text-primary font-medium",children:T.policy_name}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:T.category}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:T.category}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:T.version}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium border ${K(T.status)}`,children:T.status})}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:T.approved_by||"-"}),e.jsx("td",{className:"px-6 py-4",children:T.review_date?e.jsxs("div",{className:"flex items-center gap-2",children:[ee&&e.jsx(pt,{className:"w-4 h-4 text-yellow-400",title:s("policies.reviewSoon")}),e.jsx("span",{className:`text-body ${ee?"text-yellow-400 font-medium":"text-text-secondary"}`,children:new Date(T.review_date).toLocaleDateString("sl-SI")})]}):e.jsx("span",{className:"text-body text-text-tertiary",children:"-"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("button",{onClick:()=>$(T),className:"p-2 rounded-lg bg-blue-600/20 hover:bg-blue-600/30 text-blue-400 transition-colors",title:s("policies.viewDetails"),children:e.jsx(lr,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>q(T),className:"p-2 rounded-lg bg-yellow-600/20 hover:bg-yellow-600/30 text-yellow-400 transition-colors",title:s("policies.editPolicy"),children:e.jsx(ar,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Y(T),className:"p-2 rounded-lg bg-red-600/20 hover:bg-red-600/30 text-red-400 transition-colors",title:s("policies.deletePolicy"),children:e.jsx(pr,{className:"w-4 h-4"})})]})})]},T.id)})})]})}),a.length===0&&e.jsx("div",{className:"text-center py-12 text-text-secondary",children:s("policies.noDocuments")})]}),e.jsx(zE,{isOpen:c,onClose:()=>d(!1),onSave:J}),e.jsx(mx,{isOpen:p,onClose:()=>m(!1),tableName:"policies",title:s("policies.importTitle"),columns:["policy_name","category","category","version","status","content","approved_by","approval_date","review_date"],sampleData:"policy_name;category;category;version;status;content;approved_by;approval_date;review_date\\nPrimer dokumenta;policy;IT Security;1.0;draft;Vsebina dokumenta;Ime Priimek;2025-01-01;2025-12-01",onSuccess:J}),h&&x&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm",onClick:T=>{T.target===T.currentTarget&&Q()},children:e.jsxs("div",{className:"bg-gray-800 border border-gray-700/50 rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto shadow-2xl",children:[e.jsxs("div",{className:"sticky top-0 bg-gray-800 border-b border-gray-700/50 px-6 py-4 flex items-center justify-between z-10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ut,{className:"w-6 h-6 text-blue-400"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:x.policy_name}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:s("policies.detailsSubtitle")})]})]}),e.jsx("button",{onClick:Q,className:"p-2 rounded-lg hover:bg-gray-700/50 transition-colors",children:e.jsx(Ar,{className:"w-5 h-5 text-gray-400"})})]}),e.jsxs("div",{className:"px-6 py-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-3",children:[x.status&&e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium border ${K(x.status)}`,children:x.status}),x.category&&e.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-medium bg-purple-500/20 text-purple-400 border border-purple-500/30",children:x.category}),ge(x.review_date)&&e.jsxs("span",{className:"px-3 py-1 rounded-full text-xs font-medium border bg-yellow-500/20 text-yellow-400 border-yellow-500/30 flex items-center gap-1",children:[e.jsx(pt,{className:"w-3 h-3"}),s("policies.reviewSoon")]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:s("policies.details.documentId")}),e.jsx("div",{className:"text-sm text-white font-mono",children:x.policy_id||"-"})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:s("policies.details.name")}),e.jsx("div",{className:"text-sm text-white font-medium",children:x.policy_name})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:s("policies.details.documentType")}),e.jsx("div",{className:"text-sm text-white",children:x.category||"-"})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:s("policies.details.category")}),e.jsx("div",{className:"text-sm text-white",children:x.category||"-"})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:s("policies.details.version")}),e.jsx("div",{className:"text-sm text-white font-medium",children:x.version})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:s("policies.details.status")}),e.jsx("div",{className:"text-sm text-white",children:x.status})]})]}),x.content&&e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:s("policies.details.content")}),e.jsx("div",{className:"text-sm text-white whitespace-pre-wrap",children:x.content})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[x.approved_by&&e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:s("policies.details.approvedBy")}),e.jsx("div",{className:"text-sm text-white",children:x.approved_by})]}),x.approval_date&&e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:s("policies.details.approvalDate")}),e.jsx("div",{className:"text-sm text-white",children:new Date(x.approval_date).toLocaleDateString("sl-SI")})]}),x.review_date&&e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:s("policies.details.reviewDate")}),e.jsx("div",{className:`text-sm font-medium ${ge(x.review_date)?"text-yellow-400":"text-white"}`,children:new Date(x.review_date).toLocaleDateString("sl-SI")})]})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-3",children:s("common.metadata")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:s("common.id")}),e.jsx("div",{className:"text-sm text-white font-mono break-all",children:x.id})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:s("common.createdAt")}),e.jsx("div",{className:"text-sm text-white",children:new Date(x.created_at).toLocaleString("sl-SI")})]}),x.updated_at&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:s("common.updatedAt")}),e.jsx("div",{className:"text-sm text-white",children:new Date(x.updated_at).toLocaleString("sl-SI")})]})]})]})]}),e.jsx("div",{className:"sticky bottom-0 bg-gray-800 border-t border-gray-700/50 px-6 py-4 flex justify-end",children:e.jsx("button",{onClick:Q,className:"px-6 py-2 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-lg transition-all duration-200",children:s("common.close")})})]})}),g&&P&&e.jsx(zs,{isOpen:g,onClose:()=>v(!1),title:s("policies.editTitle"),children:e.jsxs("form",{onSubmit:I,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{htmlFor:"policy_name",className:"block text-sm font-medium text-text-secondary mb-2",children:[s("policies.form.policyName")," ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"text",id:"policy_name",value:F.policy_name,onChange:T=>W(ee=>({...ee,policy_name:T.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"category",className:"block text-sm font-medium text-text-secondary mb-2",children:[s("policies.form.documentType")," ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsxs("select",{id:"category",value:F.category,onChange:T=>W(ee=>({...ee,category:T.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"policy",children:"policy"}),e.jsx("option",{value:"procedure",children:"procedure"}),e.jsx("option",{value:"guideline",children:"guideline"}),e.jsx("option",{value:"standard",children:"standard"}),e.jsx("option",{value:"form",children:"form"}),e.jsx("option",{value:"template",children:"template"}),e.jsx("option",{value:"other",children:"other"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"category",className:"block text-sm font-medium text-text-secondary mb-2",children:[s("policies.form.category")," ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"text",id:"category",value:F.category,onChange:T=>W(ee=>({...ee,category:T.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"version",className:"block text-sm font-medium text-text-secondary mb-2",children:[s("policies.form.version")," ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"text",id:"version",value:F.version,onChange:T=>W(ee=>({...ee,version:T.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"status",className:"block text-sm font-medium text-text-secondary mb-2",children:[s("policies.form.status")," ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsxs("select",{id:"status",value:F.status,onChange:T=>W(ee=>({...ee,status:T.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"draft",children:"draft"}),e.jsx("option",{value:"under_review",children:"under_review"}),e.jsx("option",{value:"approved",children:"approved"}),e.jsx("option",{value:"active",children:"active"}),e.jsx("option",{value:"superseded",children:"superseded"}),e.jsx("option",{value:"expired",children:"expired"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"content",className:"block text-sm font-medium text-text-secondary mb-2",children:s("policies.form.content")}),e.jsx("textarea",{id:"content",value:F.content,onChange:T=>W(ee=>({...ee,content:T.target.value})),rows:6,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary resize-none"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"approved_by",className:"block text-sm font-medium text-text-secondary mb-2",children:s("policies.form.approvedBy")}),e.jsx("input",{type:"text",id:"approved_by",value:F.approved_by,onChange:T=>W(ee=>({...ee,approved_by:T.target.value})),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"approval_date",className:"block text-sm font-medium text-text-secondary mb-2",children:s("policies.form.approvalDate")}),e.jsx("input",{type:"date",id:"approval_date",value:F.approval_date,onChange:T=>W(ee=>({...ee,approval_date:T.target.value})),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"review_date",className:"block text-sm font-medium text-text-secondary mb-2",children:s("policies.form.reviewDate")}),e.jsx("input",{type:"date",id:"review_date",value:F.review_date,onChange:T=>W(ee=>({...ee,review_date:T.target.value})),className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-border-subtle",children:[e.jsx("button",{type:"button",onClick:()=>v(!1),className:"px-6 py-2 bg-bg-near-black text-text-primary border border-border-subtle rounded hover:bg-bg-surface transition-colors duration-150",children:s("common.cancel")}),e.jsx("button",{type:"submit",disabled:R,className:"px-6 py-2 bg-accent-primary hover:bg-accent-primary-hover text-white rounded transition-colors duration-150 disabled:opacity-50",children:s(R?"common.saving":"common.save")})]})]})}),e.jsx(gi,{isOpen:_,onClose:()=>k(!1),onConfirm:H,title:s("policies.deleteTitle"),message:s("policies.deleteMessage",{name:P==null?void 0:P.policy_name}),isDeleting:A})]})}const PE=({isOpen:s,onClose:t,onSave:r})=>{const{t:a}=et(),n=[{key:"template_id",label:a("modals.add.common.templateId"),type:"text",required:!0},{key:"template_name",label:a("modals.add.common.templateName"),type:"text",required:!0},{key:"template_type",label:a("modals.add.common.templateType"),type:"select",required:!0,options:["form","report","checklist","contract","other"]},{key:"category",label:a("modals.add.common.category"),type:"text",required:!0},{key:"version",label:a("modals.add.common.version"),type:"text",required:!0},{key:"content",label:a("modals.add.common.content"),type:"textarea",required:!1},{key:"status",label:a("modals.add.common.status"),type:"select",options:["draft","approved","active","archived"]}];return e.jsx(ha,{isOpen:s,onClose:t,onSave:r,title:a("modals.add.template.title"),table:"templates",fields:n})};function AE(){const{t:s}=et(),[t,r]=z.useState([]),[a,n]=z.useState([]),[i,o]=z.useState(!0),[c,d]=z.useState(!1),[p,m]=z.useState(!1),[x,b]=z.useState(null),[h,j]=z.useState(!1),[g,v]=z.useState(!1),[_,k]=z.useState(!1),[P,L]=z.useState(null),[F,W]=z.useState({template_name:"",template_type:"form",category:"",version:"",content:"",status:"draft"}),[R,B]=z.useState(!1),[A,S]=z.useState(!1),[C,O]=z.useState(!1),[Z,te]=z.useState(""),[ce,re]=z.useState("all"),[X,U]=z.useState("all");z.useEffect(()=>{oe()},[]),z.useEffect(()=>{xe()},[t,Z,ce,X]);const oe=async()=>{try{const{data:ee,error:_e}=await Ne.from("templates").select("*").order("created_at",{ascending:!1});if(_e)throw _e;r(ee||[])}catch(ee){console.error("Error:",ee)}finally{o(!1)}},xe=()=>{let ee=[...t];if(Z.trim()){const _e=Z.toLowerCase();ee=ee.filter(ke=>{var ue,je,ne;return((ue=ke.template_name)==null?void 0:ue.toLowerCase().includes(_e))||((je=ke.category)==null?void 0:je.toLowerCase().includes(_e))||((ne=ke.template_id)==null?void 0:ne.toLowerCase().includes(_e))})}ce!=="all"&&(ee=ee.filter(_e=>_e.status===ce)),X!=="all"&&(ee=ee.filter(_e=>_e.template_type===X)),n(ee)},J=async()=>{await oe()},$=ee=>{b(ee),j(!0)},Q=()=>{j(!1),b(null)},q=ee=>{L(ee),W({template_name:ee.template_name||"",template_type:ee.template_type||"form",category:ee.category||"",version:ee.version||"",content:ee.content||"",status:ee.status||"draft"}),v(!0)},I=async ee=>{if(ee.preventDefault(),!!P){B(!0);try{const _e={template_name:F.template_name,template_type:F.template_type,category:F.category,version:F.version,content:F.content,status:F.status},{error:ke}=await Ne.from("templates").update(_e).eq("id",P.id);if(ke)throw ke;await J(),v(!1),L(null)}catch(_e){console.error("Error updating document:",_e),alert(s("templates.errors.update"))}finally{B(!1)}}},Y=ee=>{L(ee),k(!0)},H=async()=>{if(P){S(!0);try{const{error:ee}=await Ne.from("templates").delete().eq("id",P.id);if(ee)throw ee;await J(),k(!1),L(null)}catch(ee){console.error("Error deleting document:",ee),alert(s("templates.errors.delete"))}finally{S(!1)}}},he=()=>{O(!0);try{const ee=[s("templates.table.templateId"),s("templates.table.templateName"),s("templates.table.templateType"),s("templates.table.category"),s("templates.table.version"),s("templates.table.status"),s("templates.table.content"),s("common.createdAt"),s("common.updatedAt")],_e=a.map(ne=>[ne.template_id||"-",ne.template_name||"-",ne.template_type?ge(ne.template_type):"-",ne.category||"-",ne.version||"-",ne.status?K(ne.status):"-",ne.content?ne.content.replace(/[\r\n]+/g," ").replace(/;/g,","):"-",new Date(ne.created_at).toLocaleString("sl-SI"),ne.updated_at?new Date(ne.updated_at).toLocaleString("sl-SI"):"-"]),ke=[ee,..._e].map(ne=>ne.join(";")).join(`
`),ue=new Blob(["\uFEFF"+ke],{type:"text/csv;charset=utf-8;"}),je=document.createElement("a");je.href=URL.createObjectURL(ue),je.download=`${s("templates.exportFilename")}_${new Date().toISOString().split("T")[0]}.csv`,je.click(),URL.revokeObjectURL(je.href)}catch(ee){console.error("Export error:",ee),alert(s("templates.errors.export"))}finally{O(!1)}},ge=ee=>({form:"Obrazec",report:"Poroilo",checklist:"Kontrolni seznam",contract:"Pogodba",other:"Drugo"})[ee]||ee,K=ee=>({draft:"Osnutek",under_review:"V pregledu",approved:"Odobreno",active:"Aktivno",superseded:"Zamenjano",expired:"Poteklo"})[ee]||ee,T=ee=>{const _e={active:"bg-green-500/20 text-green-400 border-green-500/30",approved:"bg-blue-500/20 text-blue-400 border-blue-500/30",under_review:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",draft:"bg-gray-500/20 text-gray-400 border-gray-500/30",superseded:"bg-orange-500/20 text-orange-400 border-orange-500/30",expired:"bg-red-500/20 text-red-400 border-red-500/30"};return _e[ee]||_e.draft};return i?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-accent-primary/10 flex items-center justify-center",children:e.jsx(ut,{className:"w-5 h-5 text-accent-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:s("templates.title")}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:s("templates.subtitle")})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>m(!0),className:"h-10 px-4 bg-green-600 hover:bg-green-700 text-white rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Xa,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:s("templates.importCSV")})]}),e.jsxs("button",{onClick:()=>d(!0),className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Dt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:s("templates.addTemplate")})]})]})]}),e.jsx("div",{className:"bg-bg-surface rounded-sm border border-border-subtle p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ss,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-text-secondary"}),e.jsx("input",{type:"text",placeholder:s("templates.searchPlaceholder"),value:Z,onChange:ee=>te(ee.target.value),className:"w-full pl-10 pr-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary placeholder-text-tertiary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("select",{value:ce,onChange:ee=>re(ee.target.value),className:"px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"all",children:s("templates.filters.statusAll")}),e.jsx("option",{value:"draft",children:s("common.statusOptions.draft")}),e.jsx("option",{value:"approved",children:s("common.statusOptions.approved")}),e.jsx("option",{value:"active",children:s("common.statusOptions.active")}),e.jsx("option",{value:"archived",children:s("common.statusOptions.archived")})]}),e.jsxs("select",{value:X,onChange:ee=>U(ee.target.value),className:"px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"all",children:s("templates.filters.typeAll")}),e.jsx("option",{value:"form",children:s("templates.types.form")}),e.jsx("option",{value:"report",children:s("templates.types.report")}),e.jsx("option",{value:"checklist",children:s("templates.types.checklist")}),e.jsx("option",{value:"contract",children:s("templates.types.contract")}),e.jsx("option",{value:"other",children:s("templates.types.other")})]}),e.jsxs("button",{onClick:he,disabled:a.length===0||C,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded transition-colors duration-150 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap",children:[e.jsx(Ir,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:s(C?"templates.exporting":"templates.exportCSV")})]})]})}),e.jsxs("div",{className:"bg-bg-surface rounded-sm border border-border-subtle overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-pure-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("templates.table.template")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("templates.table.type")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("templates.table.category")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("templates.table.version")}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("templates.table.status")}),e.jsx("th",{className:"text-center px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:s("common.actions")})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:a.map(ee=>e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 text-body text-text-primary font-medium",children:ee.template_name}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:ge(ee.template_type)}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:ee.category}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:ee.version}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium border ${T(ee.status)}`,children:K(ee.status)})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("button",{onClick:()=>$(ee),className:"p-2 rounded-lg bg-blue-600/20 hover:bg-blue-600/30 text-blue-400 transition-colors",title:"Podrobnosti predloge",children:e.jsx(lr,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>q(ee),className:"p-2 rounded-lg bg-yellow-600/20 hover:bg-yellow-600/30 text-yellow-400 transition-colors",title:"Uredi predlogo",children:e.jsx(ar,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Y(ee),className:"p-2 rounded-lg bg-red-600/20 hover:bg-red-600/30 text-red-400 transition-colors",title:s("templates.deleteTitle"),children:e.jsx(pr,{className:"w-4 h-4"})})]})})]},ee.id))})]})}),a.length===0&&e.jsx("div",{className:"text-center py-12 text-text-secondary",children:"Ni najdenih dokumentov"})]}),e.jsx(PE,{isOpen:c,onClose:()=>d(!1),onSave:J}),e.jsx(mx,{isOpen:p,onClose:()=>m(!1),tableName:"templates",title:s("templates.importTitle"),columns:["template_name","template_type","category","version","status","content"],onSuccess:J}),h&&x&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm",onClick:ee=>{ee.target===ee.currentTarget&&Q()},children:e.jsxs("div",{className:"bg-gray-800 border border-gray-700/50 rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto shadow-2xl",children:[e.jsxs("div",{className:"sticky top-0 bg-gray-800 border-b border-gray-700/50 px-6 py-4 flex items-center justify-between z-10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ut,{className:"w-6 h-6 text-blue-400"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:x.template_name}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Podrobnosti predloge"})]})]}),e.jsx("button",{onClick:Q,className:"p-2 rounded-lg hover:bg-gray-700/50 transition-colors",children:e.jsx(Ar,{className:"w-5 h-5 text-gray-400"})})]}),e.jsxs("div",{className:"px-6 py-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-3",children:[x.status&&e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium border ${T(x.status)}`,children:K(x.status)}),x.category&&e.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-medium bg-purple-500/20 text-purple-400 border border-purple-500/30",children:x.category})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:s("templates.details.documentId")}),e.jsx("div",{className:"text-sm text-white font-mono",children:x.template_id||"-"})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:s("templates.details.name")}),e.jsx("div",{className:"text-sm text-white font-medium",children:x.template_name})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:s("templates.details.templateType")}),e.jsx("div",{className:"text-sm text-white",children:x.template_type?ge(x.template_type):"-"})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:s("templates.details.category")}),e.jsx("div",{className:"text-sm text-white",children:x.category||"-"})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:s("templates.details.version")}),e.jsx("div",{className:"text-sm text-white font-medium",children:x.version})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:s("templates.details.status")}),e.jsx("div",{className:"text-sm text-white",children:x.status?K(x.status):"-"})]})]}),x.content&&e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:s("templates.details.content")}),e.jsx("div",{className:"text-sm text-white whitespace-pre-wrap",children:x.content})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-3",children:s("common.metadata")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"ID"}),e.jsx("div",{className:"text-sm text-white font-mono break-all",children:x.id})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Ustvarjeno"}),e.jsx("div",{className:"text-sm text-white",children:new Date(x.created_at).toLocaleString("sl-SI")})]}),x.updated_at&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Posodobljeno"}),e.jsx("div",{className:"text-sm text-white",children:new Date(x.updated_at).toLocaleString("sl-SI")})]})]})]})]}),e.jsx("div",{className:"sticky bottom-0 bg-gray-800 border-t border-gray-700/50 px-6 py-4 flex justify-end",children:e.jsx("button",{onClick:Q,className:"px-6 py-2 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-lg transition-all duration-200",children:s("common.close")})})]})}),g&&P&&e.jsx(zs,{isOpen:g,onClose:()=>v(!1),title:"Uredi predlogo",children:e.jsxs("form",{onSubmit:I,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{htmlFor:"template_name",className:"block text-sm font-medium text-text-secondary mb-2",children:["Naziv dokumenta ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"text",id:"template_name",value:F.template_name,onChange:ee=>W(_e=>({..._e,template_name:ee.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"template_type",className:"block text-sm font-medium text-text-secondary mb-2",children:["Tip predloge ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsxs("select",{id:"template_type",value:F.template_type,onChange:ee=>W(_e=>({..._e,template_type:ee.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"form",children:"Obrazec"}),e.jsx("option",{value:"report",children:"Poroilo"}),e.jsx("option",{value:"checklist",children:"Kontrolni seznam"}),e.jsx("option",{value:"contract",children:"Pogodba"}),e.jsx("option",{value:"other",children:"Drugo"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"category",className:"block text-sm font-medium text-text-secondary mb-2",children:["Kategorija ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"text",id:"category",value:F.category,onChange:ee=>W(_e=>({..._e,category:ee.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"version",className:"block text-sm font-medium text-text-secondary mb-2",children:["Verzija ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsx("input",{type:"text",id:"version",value:F.version,onChange:ee=>W(_e=>({..._e,version:ee.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"status",className:"block text-sm font-medium text-text-secondary mb-2",children:["Status ",e.jsx("span",{className:"text-status-error",children:"*"})]}),e.jsxs("select",{id:"status",value:F.status,onChange:ee=>W(_e=>({..._e,status:ee.target.value})),required:!0,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary",children:[e.jsx("option",{value:"draft",children:"Osnutek"}),e.jsx("option",{value:"under_review",children:"V pregledu"}),e.jsx("option",{value:"approved",children:"Odobreno"}),e.jsx("option",{value:"active",children:"Aktivno"}),e.jsx("option",{value:"superseded",children:"Zamenjano"}),e.jsx("option",{value:"expired",children:"Poteklo"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"content",className:"block text-sm font-medium text-text-secondary mb-2",children:"Vsebina"}),e.jsx("textarea",{id:"content",value:F.content,onChange:ee=>W(_e=>({..._e,content:ee.target.value})),rows:6,className:"w-full px-4 py-2 bg-bg-near-black border border-border-subtle rounded text-text-primary focus:outline-none focus:border-accent-primary resize-none"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-border-subtle",children:[e.jsx("button",{type:"button",onClick:()=>v(!1),className:"px-6 py-2 bg-bg-near-black text-text-primary border border-border-subtle rounded hover:bg-bg-surface transition-colors duration-150",children:"Preklii"}),e.jsx("button",{type:"submit",disabled:R,className:"px-6 py-2 bg-accent-primary hover:bg-accent-primary-hover text-white rounded transition-colors duration-150 disabled:opacity-50",children:R?"Shranjujem...":"Shrani"})]})]})}),e.jsx(gi,{isOpen:_,onClose:()=>k(!1),onConfirm:H,title:s("templates.deleteTitle"),message:s("templates.deleteMessage",{name:P==null?void 0:P.template_name}),isDeleting:A})]})}function OE(){const[s,t]=z.useState([]),[r,a]=z.useState(!0),[n,i]=z.useState(!1),o=[{id:1,ticket_id:"ZD-2024-001",subject:"Teava z dostopom do sistema",description:"Uporabnik ne more dostopati do aplikacije po zadnji posodobitvi.",priority:"high",status:"in_progress",category:"technical_issue",assigned_to:"Janez Novak",requester_name:"Marija Kova",requester_email:"marija.kovac@podjetje.si",created_date:"2024-11-08T10:30:00Z",resolved_date:null,resolution_notes:null,satisfaction_rating:null},{id:2,ticket_id:"ZD-2024-002",subject:"Pozabljeno geslo",description:"Potrebujem ponastavitev gesla za spletno aplikacijo.",priority:"medium",status:"resolved",category:"password_reset",assigned_to:"Ana Lipar",requester_name:"Peter Horvat",requester_email:"peter.horvat@podjetje.si",created_date:"2024-11-07T14:15:00Z",resolved_date:"2024-11-07T15:20:00Z",resolution_notes:"Geslo je bilo uspeno ponastavljeno. Uporabnik je prejel nova navodila.",satisfaction_rating:5},{id:3,ticket_id:"ZD-2024-003",subject:"Varnostni incident - sum vdora",description:"Opaen sumljiv dostop do sistema iz neznane lokacije.",priority:"critical",status:"open",category:"security_incident",assigned_to:"Toma Bergant",requester_name:"Security Team",requester_email:"security@podjetje.si",created_date:"2024-11-09T08:00:00Z",resolved_date:null,resolution_notes:null,satisfaction_rating:null},{id:4,ticket_id:"ZD-2024-004",subject:"Zahteva za usposabljanje",description:"Potrebujemo usposabljanje za novo programsko opremo.",priority:"low",status:"waiting_for_customer",category:"training_request",assigned_to:"Maja Virti",requester_name:"Oddelek prodaje",requester_email:"prodaja@podjetje.si",created_date:"2024-11-06T16:45:00Z",resolved_date:null,resolution_notes:"akamo na potrditev terminov za usposabljanje.",satisfaction_rating:null},{id:5,ticket_id:"ZD-2024-005",subject:"Teava s tiskalnikom",description:"Tiskalnik v pisarni 205 ne deluje pravilno.",priority:"medium",status:"closed",category:"hardware_issue",assigned_to:"Robert Kosec",requester_name:"Finance Oddelek",requester_email:"finance@podjetje.si",created_date:"2024-11-05T09:20:00Z",resolved_date:"2024-11-05T11:30:00Z",resolution_notes:"Zamenjana je bila kartua. Tiskalnik deluje normalno.",satisfaction_rating:4}];z.useEffect(()=>{(async()=>{try{const{data:b,error:h}=await Ne.from("support_ticket_management").select("*").order("created_date",{ascending:!1});if(h)throw h;t(b&&b.length>0?b:o)}catch(b){console.error("Error:",b),t(o)}finally{a(!1)}})()},[]);const c=async()=>{const{data:x,error:b}=await Ne.from("support_ticket_management").select("*").order("created_date",{ascending:!1});if(b){console.error("Error:",b);return}t(x||[])},d=x=>({open:"Odprto",in_progress:"V teku",waiting_for_customer:"akanje na stranko",resolved:"Reeno",closed:"Zaprto"})[x]||x,p=x=>({low:"Nizka",medium:"Srednja",high:"Visoka",urgent:"Nujna",critical:"Kritina"})[x]||x,m=x=>({technical_issue:"Tehnina teava",access_request:"Zahteva za dostop",password_reset:"Ponastavitev gesla",software_install:"Namestitev programske opreme",hardware_issue:"Teava s strojno opremo",network_problem:"Teava z omrejem",security_incident:"Varnostni incident",compliance_question:"Vpraanje o skladnosti",training_request:"Zahteva za usposabljanje",other:"Drugo"})[x]||x;return r?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-accent-primary/10 flex items-center justify-center",children:e.jsx(pS,{className:"w-5 h-5 text-accent-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Zahtevki za podporo"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Napredno upravljanje podpornih zahtevkov"})]})]}),e.jsxs("button",{onClick:()=>i(!0),className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary/90 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200 flex items-center gap-2",children:[e.jsx(Dt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:"Oddaj nov zahtevek"})]})]}),e.jsx("div",{className:"bg-bg-surface rounded-sm border border-border-subtle overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-pure-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Zahtevek za podporo"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Zadeva"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Uporabnik"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Prioriteta"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Kategorija"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Status"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Dodeljen"})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:s.map(x=>e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 text-body text-text-primary font-mono",children:x.ticket_id}),e.jsx("td",{className:"px-6 py-4 text-body text-text-primary font-medium max-w-xs truncate",children:x.subject}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:x.requester_name}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium ${x.priority==="critical"?"bg-risk-critical/20 text-risk-critical":x.priority==="high"||x.priority==="urgent"?"bg-risk-high/20 text-risk-high":"bg-risk-low/20 text-risk-low"}`,children:p(x.priority)})}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:m(x.category)}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-caption font-medium ${x.status==="closed"||x.status==="resolved"?"bg-status-success/10 text-status-success":x.status==="in_progress"?"bg-status-warning/10 text-status-warning":"bg-status-error/10 text-status-error"}`,children:d(x.status)})}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:x.assigned_to||"-"})]},x.id))})]})}),e.jsx(FD,{isOpen:n,onClose:()=>i(!1),onSave:c})]})}function DE(){const[s,t]=z.useState([]),[r,a]=z.useState(!0),[n,i]=z.useState(!1);z.useEffect(()=>{(async()=>{try{const{data:d,error:p}=await Ne.from("settings_advanced_config").select("*").order("setting_category",{ascending:!0});if(p)throw p;t(d||[])}catch(d){console.error("Error:",d)}finally{a(!1)}})()},[]);const o=async()=>{const{data:c,error:d}=await Ne.from("settings_advanced_config").select("*").order("setting_category",{ascending:!0});if(d){console.error("Error:",d);return}t(c||[])};return r?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-accent-primary/10 flex items-center justify-center",children:e.jsx(fi,{className:"w-5 h-5 text-accent-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Advanced Settings"}),e.jsx("p",{className:"text-body-sm text-text-secondary",children:"Sistemske konfiguracije"})]})]}),e.jsxs("button",{onClick:()=>i(!0),className:"h-10 px-4 bg-accent-primary hover:bg-accent-primary-hover text-white rounded-sm transition-colors duration-150 flex items-center gap-2",children:[e.jsx(Dt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:"Nova nastavitev"})]})]}),e.jsx("div",{className:"bg-bg-surface rounded-sm border border-border-subtle overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-bg-pure-black border-b border-border-subtle",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Klju"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Vrednost"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Kategorija"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Tip podatkov"}),e.jsx("th",{className:"text-left px-6 py-4 text-caption text-text-secondary uppercase tracking-wide",children:"Obutljivo"})]})}),e.jsx("tbody",{className:"divide-y divide-border-subtle",children:s.map(c=>e.jsxs("tr",{className:"hover:bg-bg-surface-hover transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 text-body text-text-primary font-mono",children:c.setting_key}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:c.is_sensitive?"********":c.setting_value}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"px-2 py-1 rounded-full text-caption font-medium bg-accent-primary/10 text-accent-primary",children:c.setting_category})}),e.jsx("td",{className:"px-6 py-4 text-body text-text-secondary",children:c.data_type}),e.jsx("td",{className:"px-6 py-4",children:c.is_sensitive?e.jsx("span",{className:"px-2 py-1 rounded-full text-caption font-medium bg-status-error/10 text-status-error",children:"Da"}):e.jsx("span",{className:"px-2 py-1 rounded-full text-caption font-medium bg-status-success/10 text-status-success",children:"Ne"})})]},c.id))})]})}),e.jsx(HD,{isOpen:n,onClose:()=>i(!1),onSave:o})]})}const EE="https://api.emsisoft.com",IE="9A87433105664647B3BB35C7187A2B0A";class LE{constructor(t,r=EE){ft(this,"apiKey");ft(this,"baseUrl");this.apiKey=t,this.baseUrl=r}async makeRequest(t,r={}){var i;const a=`${this.baseUrl}${t}`,n={"Api-Key":this.apiKey,Accept:"application/json","Content-Type":"application/json",...r.headers};try{const o=await fetch(a,{...r,headers:n});if(!o.ok){const c=await o.json().catch(()=>null);throw new Error(((i=c==null?void 0:c.error)==null?void 0:i.message)||`HTTP ${o.status}: ${o.statusText}`)}return await o.json()}catch(o){throw console.error("Emsisoft API Error:",o),o}}async getWorkstations(t){try{const r=await this.makeRequest(`/v1/workspaces/${t}/endpoints`);return this.transformWorkstations(r)}catch(r){return console.error("Failed to fetch workstations:",r),[]}}async getEvents(t,r=100){try{const a=await this.makeRequest(`/v1/workspaces/${t}/events?limit=${r}&sort=desc&order=timestamp`);return this.transformEvents(a)}catch(a){return console.error("Failed to fetch events:",a),[]}}async startScan(t,r){try{const a={type:r,parameters:r==="custom"?{scanPaths:["C:\\","D:\\"],excludePaths:["C:\\Windows\\Temp"],scanArchives:!0,scanMemory:!0}:void 0},n=await this.makeRequest(`/v1/endpoints/${t}/scan`,{method:"POST",body:JSON.stringify(a)});return this.transformScanTask(n)}catch(a){throw console.error("Failed to start scan:",a),a}}async getScanStatus(t){try{const r=await this.makeRequest(`/v1/scans/${t}`);return this.transformScanTask(r)}catch(r){throw console.error("Failed to get scan status:",r),r}}async getLicenseInfo(){try{const t=await this.makeRequest("/v1/licenses");return this.transformLicenses(t)}catch(t){return console.error("Failed to fetch license info:",t),[]}}async updateWorkstation(t,r){try{await this.makeRequest(`/v1/endpoints/${t}`,{method:"PATCH",body:JSON.stringify(r)})}catch(a){throw console.error("Failed to update workstation:",a),a}}async sendRemoteCommand(t,r){try{await this.makeRequest(`/v1/endpoints/${t}/command`,{method:"POST",body:JSON.stringify({command:r})})}catch(a){throw console.error("Failed to send remote command:",a),a}}transformWorkstations(t){return t.map(r=>({id:r.guid||r.id,name:r.computerName||r.name,ipAddress:r.ipAddress||"N/A",os:r.operatingSystem||"Unknown",status:this.mapWorkstationStatus(r.onlineStatus),lastSeen:r.lastSeen||r.lastCommunication,threatLevel:this.mapThreatLevel(r.riskLevel),agentVersion:r.agentVersion||"Unknown",lastScan:r.lastScan||"Never",location:r.location||"Unknown",workspaceId:r.workspaceId,groupName:r.groupName,lastUser:r.lastUser,loggedInUser:r.loggedInUser}))}transformEvents(t){return t.map(r=>({id:r.guid||r.id,workstationId:r.endpointId||r.workstationId,workstationName:r.computerName||"Unknown",timestamp:r.timestamp||r.dateTime,type:this.mapEventType(r.eventType),severity:this.mapEventSeverity(r.severity),title:r.title||this.getEventTitle(r),description:r.description||"",status:this.mapEventStatus(r.status),category:r.category,threatName:r.threatName,filePath:r.filePath,action:r.action}))}transformScanTask(t){return{id:t.guid||t.id,workstationId:t.endpointId||t.workstationId,workstationName:t.computerName||"Unknown",type:t.scanType,status:this.mapScanStatus(t.status),startedAt:t.startedAt||t.dateTime,completedAt:t.completedAt,threatsFound:t.threatsFound||0,filesScanned:t.filesScanned||0,scanProgress:t.progress,errors:t.errors}}transformLicenses(t){return t.map(r=>({id:r.id,product:r.product,license:r.license,seats:r.seats,used:r.used,expires:r.expires,status:r.status}))}mapWorkstationStatus(t){switch(t==null?void 0:t.toLowerCase()){case"online":case"connected":return"online";case"maintenance":return"maintenance";default:return"offline"}}mapThreatLevel(t){switch(t==null?void 0:t.toLowerCase()){case"low":return"low";case"medium":return"medium";case"high":return"high";case"critical":return"critical";default:return"low"}}mapEventType(t){switch(t==null?void 0:t.toLowerCase()){case"malware":case"threat":return"threat";case"scan":return"scan";case"update":return"update";case"connection":return"connection";case"behavior":return"behavior";default:return"update"}}mapEventSeverity(t){switch(t==null?void 0:t.toLowerCase()){case"low":return"low";case"medium":return"medium";case"high":return"high";case"critical":return"critical";default:return"low"}}mapEventStatus(t){switch(t==null?void 0:t.toLowerCase()){case"pending":return"pending";case"investigating":return"investigating";case"resolved":case"closed":return"resolved";case"false-positive":return"false-positive";default:return"pending"}}mapScanStatus(t){switch(t==null?void 0:t.toLowerCase()){case"pending":return"pending";case"running":return"running";case"completed":return"completed";case"failed":return"failed";default:return"pending"}}getEventTitle(t){if(t.eventType)switch(t.eventType.toLowerCase()){case"malware":return"Zaznana gronja";case"scan":return"Skeniranje";case"update":return"Posodobitev";case"connection":return"Omrena povezava";default:return"Varnostni dogodek"}return"Varnostni dogodek"}}function TE(){const[s,t]=z.useState(!1),[r,a]=z.useState(null),[n]=z.useState(()=>new LE(IE)),i=z.useCallback(()=>a(null),[]),o=z.useCallback(async b=>{t(!0),a(null);try{return await n.getWorkstations(b)}catch(h){const j=h instanceof Error?h.message:"Napaka pri pridobivanju delovnih postaj";return a(j),[]}finally{t(!1)}},[n]),c=z.useCallback(async(b,h)=>{t(!0),a(null);try{return await n.getEvents(b,h)}catch(j){const g=j instanceof Error?j.message:"Napaka pri pridobivanju dogodkov";return a(g),[]}finally{t(!1)}},[n]),d=z.useCallback(async(b,h)=>{t(!0),a(null);try{return await n.startScan(b,h)}catch(j){const g=j instanceof Error?j.message:"Napaka pri zagonu skeniranja";return a(g),null}finally{t(!1)}},[n]),p=z.useCallback(async b=>{t(!0),a(null);try{return await n.getScanStatus(b)}catch(h){const j=h instanceof Error?h.message:"Napaka pri pridobivanju statusa skeniranja";return a(j),null}finally{t(!1)}},[n]),m=z.useCallback(async(b,h)=>{t(!0),a(null);try{return await n.sendRemoteCommand(b,h),!0}catch(j){const g=j instanceof Error?j.message:"Napaka pri poiljanju ukaza";return a(g),!1}finally{t(!1)}},[n]),x=z.useCallback(async(b,h)=>{t(!0),a(null);try{return await n.updateWorkstation(b,h),!0}catch(j){const g=j instanceof Error?j.message:"Napaka pri posodabljanju delovne postaje";return a(g),!1}finally{t(!1)}},[n]);return{isLoading:s,error:r,clearError:i,fetchWorkstations:o,fetchEvents:c,startScan:d,getScanStatus:p,sendRemoteCommand:m,updateWorkstation:x}}function RE(){const[s,t]=z.useState(!1),[r,a]=z.useState(null),n=[{id:"1",name:"WIN10-DESKTOP-001",ipAddress:"192.168.1.101",os:"Windows 10 Pro",status:"online",lastSeen:"2025-11-09T20:25:00Z",threatLevel:"low",agentVersion:"2025.1.0.1200",lastScan:"2025-11-09T18:30:00Z",location:"Urad Ljubljana"},{id:"2",name:"WIN10-LAPTOP-002",ipAddress:"192.168.1.102",os:"Windows 10 Enterprise",status:"online",lastSeen:"2025-11-09T20:24:00Z",threatLevel:"medium",agentVersion:"2025.1.0.1200",lastScan:"2025-11-09T19:15:00Z",location:"Mobilna enota"}],i=z.useCallback(()=>a(null),[]),o=z.useCallback(async b=>(t(!0),a(null),await new Promise(h=>setTimeout(h,1e3)),t(!1),n),[]),c=z.useCallback(async(b,h)=>(t(!0),a(null),await new Promise(j=>setTimeout(j,800)),t(!1),[]),[]),d=z.useCallback(async(b,h)=>{var j;return t(!0),a(null),await new Promise(g=>setTimeout(g,1500)),t(!1),{id:Date.now().toString(),workstationId:b,workstationName:((j=n.find(g=>g.id===b))==null?void 0:j.name)||"Unknown",type:h,status:"running",startedAt:new Date().toISOString(),threatsFound:0,filesScanned:0}},[]),p=z.useCallback(async b=>(await new Promise(h=>setTimeout(h,500)),null),[]),m=z.useCallback(async(b,h)=>(await new Promise(j=>setTimeout(j,1e3)),!0),[]),x=z.useCallback(async(b,h)=>(await new Promise(j=>setTimeout(j,1e3)),!0),[]);return{isLoading:s,error:r,clearError:i,fetchWorkstations:o,fetchEvents:c,startScan:d,getScanStatus:p,sendRemoteCommand:m,updateWorkstation:x}}function ME({onNavigate:s}){const{t}=et(),[r,a]=z.useState("overview"),[n,i]=z.useState(""),o=new URLSearchParams(window.location.search).get("demo")==="true",c=TE(),d=RE(),p=o?d:c,[m,x]=z.useState([]),[b,h]=z.useState([]),[j,g]=z.useState([]),[v]=z.useState("VIRTUAL IT d.o.o"),_=z.useCallback(async()=>{if(!p.isLoading)try{const[S,C]=await Promise.all([p.fetchWorkstations(v),p.fetchEvents(v,50)]);x(S),h(C);const O=localStorage.getItem("emsisoft-scan-tasks");O&&g(JSON.parse(O))}catch(S){console.error("Error loading SOC data:",S)}},[p,v]);z.useEffect(()=>{_()},[_]);const k=z.useCallback(S=>{g(C=>{const O=[S,...C];return localStorage.setItem("emsisoft-scan-tasks",JSON.stringify(O)),O})},[]);z.useCallback((S,C)=>{g(O=>{const Z=O.map(te=>te.id===S?{...te,...C}:te);return localStorage.setItem("emsisoft-scan-tasks",JSON.stringify(Z)),Z})},[]);const P=z.useCallback(async(S,C)=>{var O;try{const Z=await p.startScan(S,C);Z&&k(Z)}catch(Z){if(console.error("Failed to start scan:",Z),o){const te={id:Date.now().toString(),workstationId:S,workstationName:((O=m.find(ce=>ce.id===S))==null?void 0:O.name)||"Unknown",type:C,status:"running",startedAt:new Date().toISOString(),threatsFound:0,filesScanned:0};k(te)}}},[p,k,m,o]),L=z.useCallback(()=>{_()},[_]);z.useCallback(S=>{switch(S){case"online":return"text-green-400";case"offline":return"text-red-400";case"maintenance":return"text-yellow-400";default:return"text-gray-400"}},[]);const F=z.useCallback(S=>{switch(S){case"online":return e.jsx(Rt,{className:"w-4 h-4"});case"offline":return e.jsx(Ss,{className:"w-4 h-4"});case"maintenance":return e.jsx(cs,{className:"w-4 h-4"});default:return e.jsx(Ss,{className:"w-4 h-4"})}},[]),W=z.useCallback(S=>{switch(S){case"low":return"text-green-400";case"medium":return"text-yellow-400";case"high":return"text-orange-400";case"critical":return"text-red-400";default:return"text-gray-400"}},[]),R=z.useCallback(S=>{switch(S){case"low":return"bg-green-500";case"medium":return"bg-yellow-500";case"high":return"bg-orange-500";case"critical":return"bg-red-500";default:return"bg-gray-500"}},[]),B=S=>{const C=new Date,O=new Date(S),Z=Math.floor((C.getTime()-O.getTime())/(1e3*60));return Z<1?"Pravkar":Z<60?`pred ${Z} min`:Z<1440?`pred ${Math.floor(Z/60)} ur`:`pred ${Math.floor(Z/1440)} dnevi`},A={totalWorkstations:m.length,onlineWorkstations:m.filter(S=>S.status==="online").length,offlineWorkstations:m.filter(S=>S.status==="offline").length,totalThreats:b.filter(S=>S.type==="threat"&&S.status==="pending").length,activeScans:j.filter(S=>S.status==="running").length,criticalWorkstations:m.filter(S=>S.threatLevel==="critical").length};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-bg-surface rounded-lg p-6 border border-border-subtle",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-red-500 to-orange-600 flex items-center justify-center",children:e.jsx(Mt,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"SOC (Security Operations Center)"}),e.jsx("p",{className:"text-text-secondary",children:"Nadzorovanje in upravljanje varnosti delovnih postaj"})]})]}),e.jsx("div",{className:"flex space-x-3",children:e.jsxs("button",{onClick:L,disabled:p.isLoading,className:"flex items-center space-x-2 px-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg hover:bg-bg-surface-hover transition-colors duration-200 disabled:opacity-50",children:[e.jsx(Yc,{className:`w-4 h-4 ${p.isLoading?"animate-spin":""}`}),e.jsx("span",{className:"text-body-sm",children:"Osvei"})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[e.jsx("div",{className:"bg-bg-near-black rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(sc,{className:"w-8 h-8 text-blue-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-text-secondary text-body-sm",children:"Vse postaje"}),e.jsx("p",{className:"text-text-primary text-xl font-semibold",children:A.totalWorkstations})]})]})}),e.jsx("div",{className:"bg-bg-near-black rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Rt,{className:"w-8 h-8 text-green-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-text-secondary text-body-sm",children:"Online"}),e.jsx("p",{className:"text-text-primary text-xl font-semibold",children:A.onlineWorkstations})]})]})}),e.jsx("div",{className:"bg-bg-near-black rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ss,{className:"w-8 h-8 text-red-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-text-secondary text-body-sm",children:"Offline"}),e.jsx("p",{className:"text-text-primary text-xl font-semibold",children:A.offlineWorkstations})]})]})}),e.jsx("div",{className:"bg-bg-near-black rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(pt,{className:"w-8 h-8 text-red-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-text-secondary text-body-sm",children:"Gronje"}),e.jsx("p",{className:"text-text-primary text-xl font-semibold",children:A.totalThreats})]})]})}),e.jsx("div",{className:"bg-bg-near-black rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Yy,{className:"w-8 h-8 text-yellow-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-text-secondary text-body-sm",children:"Aktivna skeniranja"}),e.jsx("p",{className:"text-text-primary text-xl font-semibold",children:A.activeScans})]})]})}),e.jsx("div",{className:"bg-bg-near-black rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Fp,{className:"w-8 h-8 text-red-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-text-secondary text-body-sm",children:"Kritine"}),e.jsx("p",{className:"text-text-primary text-xl font-semibold",children:A.criticalWorkstations})]})]})})]})]}),e.jsx("div",{className:"bg-bg-surface rounded-lg border border-border-subtle",children:e.jsx("div",{className:"flex space-x-1 p-1",children:[{id:"overview",label:"Pregled",icon:Yy},{id:"workstations",label:"Delovne postaje",icon:sc},{id:"events",label:"Dogodki",icon:pt},{id:"scans",label:"Skeniranja",icon:ss}].map(S=>{const C=S.icon;return e.jsxs("button",{onClick:()=>a(S.id),className:`
                  flex items-center space-x-2 px-4 py-3 rounded-lg transition-colors duration-200
                  ${r===S.id?"bg-accent-primary text-white":"text-text-secondary hover:text-text-primary hover:bg-bg-surface-hover"}
                `,children:[e.jsx(C,{className:"w-4 h-4"}),e.jsx("span",{className:"text-body-sm font-medium",children:S.label})]},S.id)})})}),r==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-bg-surface rounded-lg p-6 border border-border-subtle",children:[e.jsx("h2",{className:"text-lg font-semibold text-text-primary mb-4",children:"Aktivne gronje"}),e.jsxs("div",{className:"space-y-3",children:[b.filter(S=>S.type==="threat"&&S.status==="pending").map(S=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-bg-near-black rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${R(S.severity)}`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-text-primary font-medium",children:S.title}),e.jsxs("p",{className:"text-text-secondary text-body-sm",children:[S.workstationName," - ",S.description]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-text-tertiary text-body-sm",children:B(S.timestamp)}),e.jsx("button",{className:"px-3 py-1 bg-red-500 text-white text-body-sm rounded hover:bg-red-600 transition-colors",children:"Obravnavaj"})]})]},S.id)),b.filter(S=>S.type==="threat"&&S.status==="pending").length===0&&e.jsx("p",{className:"text-text-tertiary text-center py-8",children:"Ni aktivnih groenj"})]})]}),e.jsxs("div",{className:"bg-bg-surface rounded-lg p-6 border border-border-subtle",children:[e.jsx("h2",{className:"text-lg font-semibold text-text-primary mb-4",children:"Aktivna skeniranja"}),e.jsxs("div",{className:"space-y-3",children:[j.filter(S=>S.status==="running").map(S=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-bg-near-black rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-accent-primary"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-text-primary font-medium",children:[S.type==="full"?"Polno":S.type==="quick"?"Hitro":"Po meri"," skeniranje"]}),e.jsx("p",{className:"text-text-secondary text-body-sm",children:S.workstationName})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-text-primary text-body-sm",children:[S.filesScanned.toLocaleString()," datotek"]}),e.jsxs("p",{className:"text-text-tertiary text-body-sm",children:[S.threatsFound," groenj"]})]})]},S.id)),j.filter(S=>S.status==="running").length===0&&e.jsx("p",{className:"text-text-tertiary text-center py-8",children:"Ni aktivnih skeniranj"})]})]})]}),r==="workstations"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-bg-surface rounded-lg p-4 border border-border-subtle",children:e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ss,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-text-tertiary w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Ii delovne postaje...",value:n,onChange:S=>i(S.target.value),className:"w-full pl-10 pr-4 py-2 bg-bg-near-black border border-border-subtle rounded-lg text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-accent-primary"})]})})}),e.jsxs("div",{className:"bg-bg-surface rounded-lg border border-border-subtle",children:[e.jsx("div",{className:"p-4 border-b border-border-subtle",children:e.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Delovne postaje"})}),e.jsx("div",{className:"divide-y divide-border-subtle",children:m.filter(S=>S.name.toLowerCase().includes(n.toLowerCase())||S.ipAddress.includes(n)).map(S=>e.jsx("div",{className:"p-4 hover:bg-bg-surface-hover transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[F(S.status),e.jsx(sc,{className:"w-5 h-5 text-text-tertiary"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-text-primary font-medium",children:S.name}),e.jsxs("p",{className:"text-text-secondary text-body-sm",children:[S.ipAddress,"  ",S.os,"  ",S.location]}),e.jsxs("p",{className:"text-text-tertiary text-body-sm",children:["Zadnji ogled: ",B(S.lastSeen)]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:`text-body-sm font-medium ${W(S.threatLevel)}`,children:S.threatLevel==="low"?"Nizko":S.threatLevel==="medium"?"Srednje":S.threatLevel==="high"?"Visoko":"Kritino"}),e.jsxs("p",{className:"text-text-tertiary text-body-sm",children:["Agent: ",S.agentVersion]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>P(S.id,"quick"),className:"px-3 py-1 bg-accent-primary text-white text-body-sm rounded hover:bg-accent-primary/80 transition-colors",children:"Hitro skeniranje"}),e.jsx("button",{onClick:()=>P(S.id,"full"),className:"px-3 py-1 bg-bg-near-black border border-border-subtle text-text-primary text-body-sm rounded hover:bg-bg-surface-hover transition-colors",children:"Polno skeniranje"})]})]})]})},S.id))})]})]}),r==="events"&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"bg-bg-surface rounded-lg border border-border-subtle",children:[e.jsx("div",{className:"p-4 border-b border-border-subtle",children:e.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Varnostni dogodki"})}),e.jsx("div",{className:"divide-y divide-border-subtle",children:b.map(S=>e.jsx("div",{className:"p-4 hover:bg-bg-surface-hover transition-colors",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:`w-3 h-3 rounded-full mt-2 ${R(S.severity)}`}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-text-primary font-medium",children:S.title}),e.jsx("span",{className:"text-text-tertiary text-body-sm",children:B(S.timestamp)})]}),e.jsx("p",{className:"text-text-secondary text-body-sm mt-1",children:S.description}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[e.jsx("p",{className:"text-text-tertiary text-body-sm",children:S.workstationName}),e.jsx("span",{className:`
                          px-2 py-1 text-body-xs rounded-full
                          ${S.status==="pending"?"bg-red-500/20 text-red-400":S.status==="investigating"?"bg-yellow-500/20 text-yellow-400":S.status==="resolved"?"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400"}
                        `,children:S.status==="pending"?"V akanju":S.status==="investigating"?"V preiskavi":S.status==="resolved"?"Reeno":"Lano opozorilo"})]})]})]})},S.id))})]})}),r==="scans"&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"bg-bg-surface rounded-lg border border-border-subtle",children:[e.jsx("div",{className:"p-4 border-b border-border-subtle",children:e.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Zgodovina skeniranj"})}),e.jsx("div",{className:"divide-y divide-border-subtle",children:j.map(S=>e.jsx("div",{className:"p-4 hover:bg-bg-surface-hover transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[S.status==="running"?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-accent-primary"}):S.status==="completed"?e.jsx(Rt,{className:"w-4 h-4 text-green-400"}):S.status==="failed"?e.jsx(Ss,{className:"w-4 h-4 text-red-400"}):e.jsx(cs,{className:"w-4 h-4 text-yellow-400"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-text-primary font-medium",children:[S.type==="full"?"Polno":S.type==="quick"?"Hitro":"Po meri"," skeniranje"]}),e.jsx("p",{className:"text-text-secondary text-body-sm",children:S.workstationName}),e.jsxs("p",{className:"text-text-tertiary text-body-sm",children:["Zaeto: ",B(S.startedAt),S.completedAt&&`  Konano: ${B(S.completedAt)}`]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-text-primary text-body-sm",children:[S.filesScanned.toLocaleString()," datotek"]}),e.jsxs("p",{className:`text-body-sm ${S.threatsFound>0?"text-red-400":"text-green-400"}`,children:[S.threatsFound," groenj"]}),e.jsx("span",{className:`
                        px-2 py-1 text-body-xs rounded-full
                        ${S.status==="pending"?"bg-yellow-500/20 text-yellow-400":S.status==="running"?"bg-blue-500/20 text-blue-400":S.status==="completed"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}
                      `,children:S.status==="pending"?"V akanju":S.status==="running"?"V teku":S.status==="completed"?"Konano":"Neuspeno"})]})]})},S.id))})]})}),p.error&&e.jsxs("div",{className:"bg-red-500/20 border border-red-500/40 rounded-lg p-4 flex items-center space-x-3",children:[e.jsx(er,{className:"w-5 h-5 text-red-400 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-red-400 font-medium",children:"Napaka pri povezavi z Emsisoft API"}),e.jsx("p",{className:"text-red-300 text-body-sm",children:p.error}),e.jsx("button",{onClick:p.clearError,className:"mt-2 text-red-400 hover:text-red-300 text-body-sm underline",children:"Zapri"})]})]}),o&&e.jsx("div",{className:"bg-blue-500/20 border border-blue-500/40 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Mt,{className:"w-5 h-5 text-blue-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-400 font-medium",children:"Demo nain"}),e.jsx("p",{className:"text-blue-300 text-body-sm",children:"Prikazani so demo podatki. Za pravo funkcionalnost potrebujete veljaven Emsisoft API klju."})]})]})})]})}function FE(){const{user:s,loading:t}=cr(),[r,a]=z.useState("dashboard"),[n,i]=z.useState(!1),o=new URLSearchParams(window.location.search).get("demo")==="true";console.log(" AppContent: user:",(s==null?void 0:s.id)||"null","loading:",t,"demoMode:",o);const c=()=>{if(document.querySelector('script[src="https://ai-stein.net/vendor/chatbot/js/external-chatbot.js"]'))return;const b=document.createElement("script");b.src="https://ai-stein.net/vendor/chatbot/js/external-chatbot.js",b.async=!0,b.defer=!0,b.setAttribute("data-chatbot-uuid","dad681fb-4d9e-4c7b-9949-b2b245bb6bb1"),b.setAttribute("data-iframe-width","420"),b.setAttribute("data-iframe-height","550"),b.setAttribute("data-language","en"),document.head.appendChild(b)};if(z.useEffect(()=>{s&&!t&&(console.log(" App: Loading chatbot for authenticated user"),c())},[s,t]),t&&!o)return console.log(" App: Prikazujem loading indikator"),e.jsx("div",{className:"min-h-screen bg-bg-near-black flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})});if(!s&&!o)return console.log(" App: Prikazujem Login komponento"),e.jsx(nP,{});console.log(" App: Prikazujem glavno aplikacijo (user:",(s==null?void 0:s.id)||"null",", demoMode:",o,")");const d=()=>{const{t:b}=et();return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:b("navigation.videoEducation")})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6",children:[1,2,3,4].map(h=>e.jsx("div",{className:"bg-bg-surface border border-border-subtle rounded-lg p-8 flex flex-col items-center justify-center min-h-[200px] hover:bg-bg-surface-hover transition-colors duration-200",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx("div",{className:"w-16 h-16 bg-bg-surface-hover rounded-full flex items-center justify-center",children:e.jsx(Qy,{className:"w-8 h-8 text-text-tertiary"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-body font-medium text-text-secondary",children:"Video v pripravi"}),e.jsxs("p",{className:"text-body-sm text-text-tertiary mt-1",children:["Video ",h]})]})]})},h))})]})},p=({onNavigate:b})=>{const{t:h}=et(),j=[{id:"ai-systems",title:"AI sistemi",description:"Upravljanje in nadzor AI sistemov v skladu z AI Act EU",icon:"Bot",color:"text-blue-400"},{id:"ai-compliance",title:"Dokumenti skladnosti",description:"Dokumentacija in dokazila o skladnosti z AI Act EU",icon:"FileText",color:"text-green-400"},{id:"ai-risk-assessment",title:"Ocenjevanje tveganj",description:"Ocenjevanje tveganj in upravljanje AI sistemov",icon:"AlertTriangle",color:"text-yellow-400"},{id:"ai-transparency",title:"Preglednost AI sistemov",description:"Sledljivost in transparentnost AI sistemov",icon:"Shield",color:"text-purple-400"}],g=v=>{switch(v){case"Bot":return e.jsx(Lh,{className:"w-8 h-8"});case"FileText":return e.jsx(ut,{className:"w-8 h-8"});case"AlertTriangle":return e.jsx(pt,{className:"w-8 h-8"});case"Shield":return e.jsx(Mt,{className:"w-8 h-8"});default:return e.jsx(xi,{className:"w-8 h-8"})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-bg-surface rounded-lg p-6 border border-border-subtle",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:"AI Act EU"}),e.jsx("p",{className:"text-text-secondary",children:"Upravljanje in nadzor skladnosti z Evropskim aktom o umetni inteligenci"})]}),e.jsx("div",{className:"w-20 h-20 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center shadow-lg",children:e.jsx(Mt,{className:"w-10 h-10 text-white"})})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:j.map(v=>e.jsx("div",{onClick:()=>b(v.id),className:"bg-bg-surface border border-border-subtle rounded-lg p-6 hover:bg-bg-surface-hover cursor-pointer transition-colors duration-200 group",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:`p-3 rounded-lg bg-bg-near-black ${v.color} group-hover:scale-110 transition-transform duration-200`,children:g(v.icon)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2 group-hover:text-accent-primary transition-colors duration-200",children:v.title}),e.jsx("p",{className:"text-text-secondary text-body-sm mb-4",children:v.description}),e.jsxs("div",{className:"flex items-center text-accent-primary text-body-sm font-medium group-hover:translate-x-1 transition-transform duration-200",children:["Pojdi na stran",e.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]})},v.id))})]})},m=({onNavigate:b})=>{const{t:h}=et(),j=[{id:"education-modules",title:"Izobraevalni moduli",description:"Upravljanje in dostop do izobraevalnih modulov",icon:"BookOpen",color:"text-blue-400"},{id:"video-education",title:"Video izobraevanje",description:"Video vsebine za uenje in usposabljanje",icon:"Play",color:"text-green-400"}],g=v=>{switch(v){case"BookOpen":return e.jsx(hi,{className:"w-8 h-8"});case"Play":return e.jsx(Qy,{className:"w-8 h-8"});default:return e.jsx(hi,{className:"w-8 h-8"})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-bg-surface rounded-lg p-6 border border-border-subtle",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:"Izobraevanje"}),e.jsx("p",{className:"text-text-secondary",children:"Upravljanje izobraevalnih vsebin in modulov"})]}),e.jsx("div",{className:"w-20 h-20 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center shadow-lg",children:e.jsx(hi,{className:"w-10 h-10 text-white"})})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:j.map(v=>e.jsx("div",{onClick:()=>b(v.id),className:"bg-bg-surface border border-border-subtle rounded-lg p-6 hover:bg-bg-surface-hover cursor-pointer transition-colors duration-200 group",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:`p-3 rounded-lg bg-bg-near-black ${v.color} group-hover:scale-110 transition-transform duration-200`,children:g(v.icon)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2 group-hover:text-accent-primary transition-colors duration-200",children:v.title}),e.jsx("p",{className:"text-text-secondary text-body-sm mb-4",children:v.description}),e.jsxs("div",{className:"flex items-center text-accent-primary text-body-sm font-medium group-hover:translate-x-1 transition-transform duration-200",children:["Pojdi na stran",e.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]})},v.id))})]})},x=()=>{switch(console.log(" App: renderPage called with currentPage:",r,"user:",(s==null?void 0:s.id)||"null","demoMode:",o),console.log(" App: Current page state debug - page type:",typeof r,"value:",r),r){case"dashboard":return e.jsx(Rf,{setCurrentPage:a});case"workspaces":return e.jsx(nC,{});case"alerts":return e.jsx(NE,{onNavigate:a});case"nis2":return e.jsx(iC,{setCurrentPage:a});case"nis2-documentation":return e.jsx(lC,{setCurrentPage:a});case"nis2-controls":return e.jsx(dC,{setCurrentPage:a});case"nis2-supply-chain":return e.jsx(pC,{setCurrentPage:a});case"nis2-non-conformities":return e.jsx(uC,{setCurrentPage:a});case"evidenca-odgovornih-oseb":return e.jsx(xC,{setCurrentPage:a});case"cyber-incident-report":return e.jsx(uP,{});case"nis2-risk-register":return e.jsx(rD,{});case"profile-edit":return e.jsx(sD,{onNavigate:a});case"change-password":return i(!0),a("dashboard"),e.jsx(Rf,{setCurrentPage:a});case"audit-trail":return e.jsx(aD,{onNavigate:a});case"aiact":return e.jsx(p,{onNavigate:a});case"ai-act-eu":return e.jsx(p,{onNavigate:a});case"ai-systems":return e.jsx(xE,{onNavigate:a});case"ai-compliance":return e.jsx(gE,{onNavigate:a});case"ai-risk-assessment":return e.jsx(vE,{onNavigate:a});case"ai-transparency":return e.jsx(yE,{onNavigate:a});case"gdpr":return e.jsx(yC,{onNavigate:a});case"iso27001":return e.jsx(jC,{onNavigate:a});case"zzzpri":return e.jsx(tu,{onNavigate:a});case"zzzpri-dashboard":return e.jsx(tu,{onNavigate:a});case"zzzpri-prijave":return e.jsx(jE,{});case"zzzpri-zaupniki":return e.jsx(_E,{});case"zzzpri-obrazci":return e.jsx(kE,{});case"zzzpri-postopki":return e.jsx(tu,{onNavigate:a});case"zzzpri-porocila":return e.jsx(tu,{onNavigate:a});case"zzzpri-statistike":return e.jsx(tu,{onNavigate:a});case"zzzpri-dokumentacija":return e.jsx(R_,{});case"zzzpri-navodila":return e.jsx(R_,{});case"zzzpri-nastavitve":return e.jsx(tu,{onNavigate:a});case"educations":return e.jsx(oj,{});case"education-modules":return e.jsx(oj,{});case"video-education":return e.jsx(d,{});case"education":return e.jsx(m,{onNavigate:a});case"inventory":return e.jsx(NC,{onNavigate:a});case"procedures":return e.jsx(wC,{onNavigate:a});case"support":return e.jsx(lj,{});case"settings":return e.jsx(cj,{});case"super-admin":return e.jsx(tP,{});case"processing-activities":return e.jsx(gD,{});case"gdpr-data-protection":return e.jsx(vD,{});case"gdpr-privacy-policy":return e.jsx(ZD,{});case"gdpr-consent":return e.jsx(WD,{});case"gdpr-forgotten":return e.jsx(KD,{});case"gdpr-breach":return e.jsx(JD,{});case"gdpr-usposabljanja":return e.jsx(tE,{});case"zvop-2":return e.jsx(XD,{});case"gdpr-audit":return e.jsx(QD,{});case"gdpr-dpia":return e.jsx(eE,{});case"gdpr-controller":return e.jsx(C_,{});case"gdpr-processors":return e.jsx(C_,{});case"iso-scope":return e.jsx(rE,{});case"iso-information-security-policy":return e.jsx(sE,{});case"iso-audit":return e.jsx(aE,{});case"iso-risk":return e.jsx(nE,{});case"iso-controls":return e.jsx(iE,{});case"iso-vloge-odgovornosti":return e.jsx(oE,{});case"iso-certification":return e.jsx(cE,{});case"iso-assets":return e.jsx(dE,{});case"iso-incident":return e.jsx(uE,{});case"iso-compliance":return e.jsx(pE,{});case"iso-soa":return e.jsx(mE,{});case"procedures-list":return e.jsx(SE,{});case"policies-list":return e.jsx(CE,{});case"templates-list":return e.jsx(AE,{});case"inventory-devices":return e.jsx(pD,{});case"inventory-software":return e.jsx(hD,{});case"inventory-licenses":return e.jsx(fD,{});case"it-security-tests-order":return e.jsx(iD,{});case"education-order":return e.jsx(oD,{});case"it-services-order":return e.jsx(lD,{});case"services-quote-order":return e.jsx(cD,{});case"additional-services":return e.jsx(dD,{onNavigate:a});case"support-basic":return e.jsx(lj,{});case"support-send-message":return e.jsx(pP,{});case"support-tickets":return e.jsx(OE,{});case"settings-basic":return e.jsx(cj,{});case"settings-advanced":return e.jsx(DE,{});case"misp":return e.jsx(aP,{setCurrentPage:a});case"organization-management":return e.jsx(jS,{setCurrentPage:a});case"organization-invite":return e.jsx(NS,{setCurrentPage:a});case"soc":return e.jsx(ME,{onNavigate:a});default:return e.jsx(Rf,{setCurrentPage:a})}};return e.jsxs("div",{className:"min-h-screen bg-bg-near-black",children:[e.jsx(wS,{activePage:r,onPageChange:a}),e.jsxs("div",{className:"md:ml-[280px] ml-0 pt-20",children:[e.jsx(zS,{onNavigate:a}),n&&e.jsx(nD,{onClose:()=>i(!1)}),e.jsxs("main",{className:"p-4 md:p-8",children:[o&&e.jsx("div",{className:"mb-4 p-4 bg-accent-primary/20 border border-accent-primary/40 rounded-lg",children:e.jsx("p",{className:"text-body-sm text-accent-primary font-medium",children:"Demo nain - Prikazani so demo podatki brez avtentikacije"})}),x()]})]})]})}function UE(){return e.jsx(J4,{children:e.jsx(X4,{children:e.jsx(eS,{children:e.jsx(FE,{})})})})}pN.createRoot(document.getElementById("root")).render(e.jsx(z.StrictMode,{children:e.jsx(hN,{children:e.jsx(UE,{})})}));export{It as E,Zr as _,$E as c,Xb as g};
